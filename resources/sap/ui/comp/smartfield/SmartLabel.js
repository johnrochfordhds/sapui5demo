/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
sap.ui.define(['jquery.sap.global','sap/m/Label','sap/m/LabelRenderer','sap/ui/comp/library','./BindingUtil',"./AnnotationHelper","./SmartField"],function(q,L,a,l,B,A,S){"use strict";var b=L.extend("sap.ui.comp.smartfield.SmartLabel",{metadata:{library:"sap.ui.comp"},renderer:a.render});b.prototype.init=function(){this._sSmartFieldId=null;};b.prototype.bindRequiredPropertyToSmartField=function(){var i=null,o=null;var s=this._getField();if(s&&s.getContextEditable()&&s.getEditable()){o=new B();i=s.getBindingInfo("mandatory");if(i){this.bindProperty("required",o.toBinding(i));}else{this.setRequired(s.getMandatory());}}else{this.unbindProperty("required");this.setRequired(false);}};b.prototype._bindProperties=function(){var s=this._getField();if(s){var o=new B();var i=s.getBindingInfo("visible");if(i){this.bindProperty("visible",o.toBinding(i));}else{this.setVisible(s.getVisible());}this.bindRequiredPropertyToSmartField();i=s.getBindingInfo("textLabel");if(i){this.bindProperty("text",o.toBinding(i));}else{if(!this.getBindingInfo("text")){this.setText(s.getTextLabel());}}i=s.getBindingInfo("tooltipLabel");if(i){this.bindProperty("tooltip",o.toBinding(i));}else{this.setTooltip(s.getTooltipLabel());}}};b.prototype.getLabelInfo=function(){var m,o;var s=this._getField();if(s){this._bindProperties();m=s.getDataProperty();if(m){o=this._getLabelInfo(m);if(o){if(o.text){this._setProperty(this,"text",o.text);}if(o.quickinfo){this._setProperty(this,"tooltip",o.quickinfo);}}}}};b.prototype._setProperty=function(o,p,v){var P;if(o&&p){if(v.match(/{@i18n>.+}/gi)){o.bindProperty(p,v.substring(1,v.length-1));}else{P=p.substring(0,1).toUpperCase()+p.substring(1);if(!o.getBindingInfo(p)&&!o["get"+P]()){o["set"+P](v);}}}};b.prototype.setLabelFor=function(s){if(s){if(typeof s==='string'){this._sSmartFieldId=s;}else{this._sSmartFieldId=s.getId();}this._setLabelFor();sap.m.Label.prototype.setLabelFor.apply(this,[s]);}};b.prototype._getField=function(){if(this._sSmartFieldId){return sap.ui.getCore().byId(this._sSmartFieldId);}return null;};b.prototype._setLabelFor=function(){var d;var s=this._getField();if(s){if(s&&!this._bMetaDataApplied){this._bMetaDataApplied=true;if(s.getDataProperty){d=s.getDataProperty();if(d){this.getLabelInfo();}else{s.attachInitialise(q.proxy(this.getLabelInfo,this));}}}}};b.prototype.updateLabelFor=function(c){if(c&&c.length>0){sap.m.Label.prototype.setLabelFor.apply(this,[c[0]]);c.splice(0,1);this.updateAriaLabeledBy(c);}};b.prototype.updateAriaLabeledBy=function(c){if(c){for(var i=0;i<c.length;i++){if(c[i].addAriaLabelledBy){c[i].addAriaLabelledBy(this);}}}};b.prototype.setText=function(v){this.setProperty("text",v);};b.prototype._getLabelInfo=function(p){var o=new A();if(p&&p.property){return{text:o.getLabel(p.property),quickinfo:o.getQuickInfo(p.property)};}};b.prototype.onBeforeRendering=function(){if(this._sSmartFieldId&&!this._bMetaDataApplied){this._setLabelFor();var s=this._getField();if((s&&s instanceof S)&&(s.getId()===this.getLabelFor())){this.updateLabelFor(s.getInnerControls());}}};b.prototype.destroy=function(s){this._sSmartFieldId=null;L.prototype.destroy.apply(this,[s]);};return b;},true);
