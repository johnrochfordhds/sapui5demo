jQuery.sap.declare('sap.ui.comp.library-all');if(!jQuery.sap.isDeclared('sap.ui.comp.config.condition.Type')){
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.ui.comp.config.condition.Type');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.EventProvider');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.m.Select');sap.ui.define("sap/ui/comp/config/condition/Type",['jquery.sap.global','sap/ui/base/EventProvider','sap/ui/model/json/JSONModel','sap/m/Select'],function(q,E,J,S){"use strict";var T=E.extend("sap.ui.comp.config.condition.Type",{constructor:function(f,F,o){E.call(this);this.oFilterProvider=F;var d={condition:{operation:"",value1:null,value2:null,key:f},operations:[],controls:[],currentoperation:{},pending:false};this.oModel=new J(d);this.oContext=this.oModel.getContext("/");this.oConditionContext=this.oModel.getContext("/condition");this.sFieldName=f;var O=this.oModel.bindProperty("operation",this.oConditionContext),t=this;O.attachChange(function(){var s=t.oModel.getProperty("operation",t.getConditionContext()),a=t.getOperation(s),c=t.getControls(a),D=t.getDefaultValues(a);t.setDefaultValues(D[0],D[1]);t.setControls(c);if(a){if(a.getValueList){a.valueList=a.getValueList();}t.oModel.setProperty("/currentoperation",a);}t.serialize();});var v=this.oModel.bindProperty("value1",this.oConditionContext);v.attachChange(function(){t.serialize();});var V=this.oModel.bindProperty("value2",this.oConditionContext);V.attachChange(function(){t.serialize();});var p=this.oModel.bindProperty("pending",this.oContext);p.attachChange(function(){if(t.bAsync){if(t._iPendingTimer){q.sap.clearDelayedCall(t._iPendingTimer);}t._iPendingTimer=q.sap.delayedCall(10,t,"fireEvent",["PendingChange",{oSource:t,pending:t.oModel.getProperty("/pending")}]);}});this.oOperationSelect=null;this.oFieldMetadata=o;this.oOperationFilter=null;this.bAsync=false;}});T.getTranslatedText=function(t,r){if(typeof t==="object"){r=t.bundle;t=t.key;}if(!r){r="sap.ui.comp";}return sap.ui.getCore().getLibraryResourceBundle(r).getText(t)||t;};T.prototype.getTranslatedText=T.getTranslatedText;T.prototype.applySettings=function(s){if(s&&s.operations&&s.operations.filter){this.oOperationFilter=s.operations.filter;}else{this.oOperationFilter=null;}};T.prototype.getParent=function(){return this.oFilterProvider._oSmartFilter;};T.prototype.getModel=function(){return this.oModel;};T.prototype.getConditionContext=function(){return this.oConditionContext;};T.prototype.setDefaultValues=function(v,V){this.oModel.setProperty("value1",v,this.getConditionContext(),true);this.oModel.setProperty("value2",V,this.getConditionContext(),true);};T.prototype.getContext=function(){return this.oContext;};T.prototype.getControls=function(o){return[];};T.prototype.getOperations=function(){return[];};T.prototype.isPending=function(){return this.getModel().getProperty("pending",this.getContext());};T.prototype.attachPendingChange=function(h){this.attachEvent("PendingChange",h);};T.prototype.detachPendingChange=function(h){this.detachEvent("PendingChange",h);};T.prototype.setPending=function(v){if(this.bAsync){this.getModel().setProperty("pending",v,this.getContext());}};T.prototype._filterOperation=function(o){if(!this.oOperationFilter){return true;}var f=this.oOperationFilter,v=o[f.path];if(f.path&&f.contains&&v){var e=f.exclude||false,F=(typeof f.contains==="string")?f.contains.split(","):f.contains,r=e;for(var j=0;j<F.length;j++){if(e&&v.indexOf(F[j])>-1){r=false;}else if(!e&&v.indexOf(F[j])>-1){r=true;}}}return r;};T.prototype._updateOperation=function(o){if(!o.textValue){o.textValue="";}if(!o.languageText&&o.textKey){o.languageText=this.getTranslatedText(o.textKey);}};T.prototype.updateOperations=function(){this.oModel.setProperty("operations",[],this.getContext());};T.prototype.getOperation=function(o){var O=this.oModel.getProperty("operations",this.getContext())||[];for(var i=0;i<O.length;i++){if(o===O[i].key){return O[i];}}return null;};T.prototype.getDefaultOperation=function(){var o=this.getOperations();if(!o||o.length===0){return null;}for(var i=0;i<o.length;i++){if(o[i].defaultOperation){return o[i];}}return o[0];};T.prototype.setLabel=function(l){this._oLabel=l;if(this.oLayout){this._assignLabelToControls(this.oLayout.getItems());}};T.prototype.setControls=function(c){var o=this.oModel.getProperty("controls",this.getContext());if(o){for(var i=0;i<o.length;i++){o[i].destroy();}}this.oModel.setProperty("controls",c,this.getContext());if(c){for(var i=0;i<c.length;i++){c[i].setBindingContext(this.getConditionContext(),"$smartEntityFilter");}}if(this.oLayout){this._assignLabelToControls(this.oLayout.getItems());}};T.prototype._assignLabelToControls=function(c){if(this._oLabel){for(var i=0;i<c.length;i++){if(i===0){this._oLabel.setLabelFor(c[i]);}if(c[i].addAriaLabelledBy){c[i].addAriaLabelledBy(this._oLabel);}}}};T.prototype.setOperation=function(o){var O=this.getOperation(o);if(O){this.setCondition({operation:O.key,key:this.sFieldName,value1:O.defaultValues[0]||null,value2:O.defaultValues[1]||null});this.getModel().checkUpdate(true);}else{}};T.prototype.isValidCondition=function(){return false;};T.prototype.setCondition=function(c){this.oModel.setProperty("key",c.key,this.oConditionContext);this.oModel.setProperty("operation",c.operation,this.oConditionContext);this.oModel.setProperty("value1",c.value1,this.oConditionContext);this.oModel.setProperty("value2",c.value2,this.oConditionContext);this.oModel.setProperty("tokenText",this.getTokenText(c),this.oConditionContext);return this;};T.prototype.setAsync=function(a){this.bAsync=a;};T.prototype.getAsync=function(a){return this.bAsync;};T.prototype.initialize=function(j){this.updateOperations();};T.prototype.serialize=function(){};T.prototype.validate=function(f){this._bForceError=f!==false;if(!this.isPending()&&this.oFieldMetadata&&this.oFieldMetadata.isMandatory&&!this.isValidCondition()&&this._bForceError){this.getModel().setProperty("inputstate","ERROR",this.getContext());return false;}this.getModel().setProperty("inputstate","NONE",this.getContext());return true;};T.prototype.getCondition=function(){var c=q.extend({},this.oModel.getProperty("",this.oConditionContext));return c;};T.prototype.providerDataUpdated=function(u,d){};T.prototype.getFilter=function(f){return null;};T.prototype.getFilterRanges=function(p){return null;};T.prototype.getTokenText=function(o){return"";};T.prototype.getName=function(){return this.getMetadata().getName();};T.prototype.getType=function(){return"Edm";};T.prototype.initializeFilterItem=function(w,l){var s=new sap.m.Select({width:w});this.oOperationSelect=s;this.sWidth=w;s.bindProperty("selectedKey",{path:"$smartEntityFilter>condition/operation"});s.bindAggregation("items",{path:"$smartEntityFilter>operations",template:new sap.ui.core.ListItem({text:{path:"$smartEntityFilter>languageText"},key:{path:"$smartEntityFilter>key"},additionalText:{path:"$smartEntityFilter>textValue"}})});if(s._oList&&s._oList.setShowSecondaryValues){s._oList.setShowSecondaryValues(true);}s.setBindingContext(this.getContext(),"$smartEntityFilter");var L=this.getModel().bindList("controls",this.getContext());L.attachChange(function(){var n=L.getModel().getProperty("controls",L.getContext());if(!n){return;}for(var i=0;i<n.length;i++){n[i].setLayoutData(new sap.m.FlexItemData({alignSelf:sap.m.FlexAlignSelf.Center}));l.addItem(n[i]);}});l.addItem(s);l.setModel(this.getModel(),"$smartEntityFilter");this.getModel().checkUpdate(true);this.oLayout=l;};return T;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.navpopover.NavigationPopover')){jQuery.sap.declare('sap.ui.comp.navpopover.NavigationPopover');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.m.CustomListItem');jQuery.sap.require('sap.m.Link');jQuery.sap.require('sap.m.Popover');jQuery.sap.require('sap.ui.core.Title');jQuery.sap.require('sap.ui.layout.form.SimpleForm');jQuery.sap.require('sap.m.VBox');jQuery.sap.require('sap.m.PopoverRenderer');sap.ui.define("sap/ui/comp/navpopover/NavigationPopover",['jquery.sap.global','sap/m/CustomListItem','sap/m/Link','sap/m/Popover','sap/ui/core/Title','sap/ui/layout/form/SimpleForm','sap/m/VBox','sap/m/PopoverRenderer'],function(q,C,L,P,T,S,V,a){"use strict";var N=P.extend("sap.ui.comp.navpopover.NavigationPopover",{metadata:{library:"sap.ui.comp",properties:{title:{type:"string",group:"Misc",defaultValue:null},semanticObjectName:{type:"string",group:"Misc",defaultValue:null},semanticAttributes:{type:"object",group:"Misc",defaultValue:null},appStateKey:{type:"string",group:"Misc",defaultValue:null},mainNavigationId:{type:"string",group:"Misc",defaultValue:null}},aggregations:{availableActions:{type:"sap.ui.comp.navpopover.LinkData",multiple:true,singularName:"availableAction"},mainNavigation:{type:"sap.ui.comp.navpopover.LinkData",multiple:false},ownNavigation:{type:"sap.ui.comp.navpopover.LinkData",multiple:false}},associations:{source:{type:"sap.ui.core.Control",multiple:false},extraContent:{type:"sap.ui.core.Control",multiple:false},component:{type:"sap.ui.core.Element",multiple:false}},events:{targetsObtained:{},navigate:{}}},renderer:a.render});N.prototype.init=function(){P.prototype.init.call(this);this.addStyleClass("navigationPopover");this.setContentWidth("380px");this.setHorizontalScrolling(false);this.setPlacement(sap.m.PlacementType.Auto);this._oHeaderForm=new S({maxContainerCols:1,visible:true});this._oMainNavigationText=new T();this._oMainNavigationLink=new L();this._oMainNavigationLink.attachPress(q.proxy(this._onLinkPress,this));this._oHeaderForm.addContent(this._oMainNavigationText);this._oHeaderForm.addContent(this._oMainNavigationLink);this._oForm=new S({maxContainerCols:1,visible:false});this._oNavigationLinkContainer=new V();this._oForm.addContent(new T({text:sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("POPOVER_LINKLIST_TEXT")}));this._oForm.addContent(this._oNavigationLinkContainer);this.addContent(this._oHeaderForm);this.addContent(this._oForm);};N.prototype.addAvailableAction=function(l){this.addAggregation("availableActions",l);};N.prototype._getSemanticObjectValue=function(){var s=this.getSemanticAttributes();if(s){var b=this.getSemanticObjectName();return s[b];}return null;};N.prototype._createLinks=function(){var i;var l;var v;var h;var o;var c=this._getComponent();var x=this._getNavigationService();this._oNavigationLinkContainer.removeAllItems();v=this.getMainNavigationId();if(!v){var s=this._getSourceControl();if(s){if(s.getSemanticObjectValue){v=s.getSemanticObjectValue();}else{v=this._getSemanticObjectValue();}}}this._oMainNavigationText.setText(v);var m=this.getMainNavigation();if(m){h=m.getHref();if(h){this._oHeaderForm.removeStyleClass("navpopoversmallheader");this._oMainNavigationLink.setText(m.getText());if(x){h=x.hrefForExternal({target:{shellHash:h}},c);}this._oMainNavigationLink.setHref(h);this._oMainNavigationLink.setTarget(m.getTarget());this._oMainNavigationLink.setVisible(true);}else{this._oHeaderForm.addStyleClass("navpopoversmallheader");this._oMainNavigationLink.setText("");this._oMainNavigationLink.setVisible(false);}}var A=this.getAvailableActions();if(A){for(i=0;i<A.length;i++){l=new L();o=A[i];if(o){l.setText(o.getText());l.attachPress(q.proxy(this._onLinkPress,this));h=o.getHref();if(x&&h){h=x.hrefForExternal({target:{shellHash:h}},c);}l.setHref(h);l.setTarget(o.getTarget());}this._oNavigationLinkContainer.addItem(l);}}this._setListVisibility();};N.prototype.insertAvailableAction=function(l,i){this.insertAggregation("availableActions",l,i);};N.prototype.removeAvailableAction=function(l){var i;if(typeof(l)==="number"){i=l;}else{i=this.getAvailableActions().indexOf(l);}if(i>=0){this._oNavigationLinkContainer.removeItem(i);}var r=this.removeAggregation("availableActions",l);this._setListVisibility();return r;};N.prototype.removeAllAvailableActions=function(){this._oNavigationLinkContainer.removeAllItems();this.removeAllAggregation("availableActions");this._setListVisibility();};N.prototype._setListVisibility=function(){var A=this.getAvailableActions().length;this._oForm.setVisible(A>0);};N.prototype._onLinkPress=function(e){var s=e.getSource();this.fireNavigate({text:s.getText(),href:s.getHref()});};N.prototype.setSemanticObjectName=function(s){this.setProperty("semanticObjectName",s);this.removeAllAvailableActions();this.setMainNavigation(null);};N.prototype._getNavigationService=function(){return sap.ushell&&sap.ushell.Container&&sap.ushell.Container.getService("CrossApplicationNavigation");};N.prototype._getUrlService=function(){return sap.ushell&&sap.ushell.Container&&sap.ushell.Container.getService("URLParsing");};N.prototype.retrieveNavTargets=function(){var s=this.getSemanticObjectName();var m=this.getSemanticAttributes();var A=this.getAppStateKey();this._retrieveNavTargets(s,m,A);};N.prototype._retrieveNavTargets=function(s,m,A){var t=this;this.setMainNavigation(null);this.removeAllAvailableActions();var x=this._getNavigationService();if(!x){q.sap.log.error("Service 'CrossApplicationNavigation' could not be obtained");this.fireTargetsObtained();return;}var I=false;var c=this._getComponent();var p=x.getSemanticObjectLinks(s,m,I,c,A);p.fail(q.proxy(function(){q.sap.log.error("'getSemanticObjectLinks' failed");},this));p.done(q.proxy(function(l){var i,b,d;var u,o;var e;var h=false;if(l&&l.length){u=t._getUrlService();var f=x.hrefForExternal();if(f&&f.indexOf("?")!==-1){f=f.split("?")[0];}for(i=0;i<l.length;i++){b=l[i].intent;d=l[i].text;e=new sap.ui.comp.navpopover.LinkData({text:d,href:b});if(b.indexOf(f)===0){this.setOwnNavigation(e);continue;}o=u.parseShellHash(b);if(o.action&&(o.action==='displayFactSheet')&&!h){e.setText(sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("POPOVER_FACTSHEET"));t.setMainNavigation(e);h=true;}else{t.addAvailableAction(e);}}}t.fireTargetsObtained();},this));};N.prototype._getComponent=function(){var c=this.getComponent();if(typeof c==="string"){c=sap.ui.getCore().getComponent(c);}return c;};N.prototype.show=function(){var s=this._getSourceControl();if(!s){q.sap.log.error("no source assigned");return;}var m=this.getMainNavigation();var A=this.getAvailableActions();if(!(m&&(m.getHref()))&&!(A&&(A.length>0))){q.sap.log.error("no navigation targets found");if(!this.getExtraContent()){q.sap.log.error("NavigationPopover is empty");q.sap.require("sap.m.MessageBox");var M=sap.ui.require("sap/m/MessageBox");M.show(sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("POPOVER_DETAILS_NAV_NOT_POSSIBLE"),{icon:M.Icon.ERROR,title:sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("POPOVER_MSG_NAV_NOT_POSSIBLE"),styleClass:(this.$()&&this.$().closest(".sapUiSizeCompact").length)?"sapUiSizeCompact":""});return;}}this._createLinks();this.openBy(s);};N.prototype._getSourceControl=function(){var s=null;var c=this.getSource();if(c){s=sap.ui.getCore().byId(c);}return s;};N.prototype.setExtraContent=function(c){var o=this.getExtraContent();if(o&&c&&o===c.getId()){return;}if(o){var O=sap.ui.getCore().byId(o);this.removeContent(O);}this.setAssociation("extraContent",c);if(c){this.insertContent(c,1);}};return N;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.odata.ChartMetadata')){jQuery.sap.declare('sap.ui.comp.odata.ChartMetadata');sap.ui.define("sap/ui/comp/odata/ChartMetadata",[],function(){"use strict";var u={"com.sap.vocabularies.UI.v1.ChartType/Waterfall":"column","com.sap.vocabularies.UI.v1.ChartType/Column":"column","com.sap.vocabularies.UI.v1.ChartType/AreaStacked":"stacked_column","com.sap.vocabularies.UI.v1.ChartType/ColumnStacked":"stacked_column","com.sap.vocabularies.UI.v1.ChartType/ColumnDual":"dual_column","com.sap.vocabularies.UI.v1.ChartType/ColumnStackedDual":"dual_stacked_column","com.sap.vocabularies.UI.v1.ChartType/AreaStacked100":"100_stacked_column","com.sap.vocabularies.UI.v1.ChartType/ColumnStacked100":"100_stacked_column","com.sap.vocabularies.UI.v1.ChartType/ColumnStackedDual100":"100_dual_stacked_column","com.sap.vocabularies.UI.v1.ChartType/HorizontalArea":"bar","com.sap.vocabularies.UI.v1.ChartType/Bar":"bar","com.sap.vocabularies.UI.v1.ChartType/HorizontalAreaStacked":"stacked_bar","com.sap.vocabularies.UI.v1.ChartType/BarStacked":"stacked_bar","com.sap.vocabularies.UI.v1.ChartType/BarDual":"dual_bar","com.sap.vocabularies.UI.v1.ChartType/BarStackedDual":"dual_stacked_bar","com.sap.vocabularies.UI.v1.ChartType/HorizontalAreaStacked100":"100_stacked_bar","com.sap.vocabularies.UI.v1.ChartType/BarStacked100":"100_stacked_bar","com.sap.vocabularies.UI.v1.ChartType/BarStackedDual100":"100_dual_stacked_bar","com.sap.vocabularies.UI.v1.ChartType/Radar":"line","com.sap.vocabularies.UI.v1.ChartType/Area":"line","com.sap.vocabularies.UI.v1.ChartType/Line":"line","com.sap.vocabularies.UI.v1.ChartType/LineDual":"dual_line","com.sap.vocabularies.UI.v1.ChartType/Combination":"combination","com.sap.vocabularies.UI.v1.ChartType/CombinationStacked":"stacked_combination","com.sap.vocabularies.UI.v1.ChartType/CombinationDual":"dual_combination","com.sap.vocabularies.UI.v1.ChartType/CombinationStackedDual":"dual_stacked_combination","com.sap.vocabularies.UI.v1.ChartType/HorizontalCombinationStacked":"horizontal_stacked_combination","com.sap.vocabularies.UI.v1.ChartType/Pie":"pie","com.sap.vocabularies.UI.v1.ChartType/Donut":"donut","com.sap.vocabularies.UI.v1.ChartType/Scatter":"scatter","com.sap.vocabularies.UI.v1.ChartType/Bubble":"bubble","com.sap.vocabularies.UI.v1.ChartType/HeatMap":"heatmap","com.sap.vocabularies.UI.v1.ChartType/TreeMap":"treemap","com.sap.vocabularies.UI.v1.ChartType/Bullet":"bullet","com.sap.vocabularies.UI.v1.ChartType/VerticalBullet":"vertical_bullet"};var m={"com.sap.vocabularies.UI.v1.ChartMeasureAttributeType/Axis1":"axis1","com.sap.vocabularies.UI.v1.ChartMeasureAttributeType/Axis2":"axis2","com.sap.vocabularies.UI.v1.ChartMeasureAttributeType/Axis3":"axis3"};var d={"com.sap.vocabularies.UI.v1.ChartDimensionAttributeType/Category":"category","com.sap.vocabularies.UI.v1.ChartDimensionAttributeType/Series":"series"};var C={getChartType:function(t){return u[t];},getMeasureRole:function(r){return m[r];},getDimensionRole:function(r){return d[r];}};return C;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.odata.FieldSelectorRenderer')){
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.ui.comp.odata.FieldSelectorRenderer');jQuery.sap.require('jquery.sap.global');sap.ui.define("sap/ui/comp/odata/FieldSelectorRenderer",['jquery.sap.global'],function(q){"use strict";var F={};F.render=function(r,c){r.write("<span");r.writeControlData(c);r.writeClasses();r.write(">");var C=c.getContent();r.renderControl(C);r.write("</span>");};return F;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.odata.MetadataAnalyser')){
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.ui.comp.odata.MetadataAnalyser');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.model.odata.ODataModel');jQuery.sap.require('sap.ui.model.odata.ODataAnnotations');sap.ui.define("sap/ui/comp/odata/MetadataAnalyser",['jquery.sap.global','sap/ui/model/odata/ODataModel','sap/ui/model/odata/ODataAnnotations'],function(q,O,a){"use strict";var M=function(r){if(typeof r==="object"){this.oModel=r;}else{this._sResourceRootUri=r;}this._oMetadata=null;if(!this.oModel&&this._sResourceRootUri){this.oModel=new O(this._sResourceRootUri);}if(this.oModel){this._oMetaModel=this.oModel.getMetaModel();}if(this._oMetaModel){this._oMetadata=this._oMetaModel.getProperty("/");}if(this._oMetadata&&this._oMetadata.dataServices){this._oSchemaDefinition=this._oMetadata.dataServices.schema[0];}};M.prototype.getNamespace=function(){if(this._oSchemaDefinition){return this._oSchemaDefinition.namespace;}};M.prototype.getSchemaDefinition=function(){return this._oSchemaDefinition;};M.prototype.getEntityContainerAttribute=function(A){var s=null,e;if(this._oMetaModel&&A){if(A.indexOf("sap:")<0){A="sap:"+A;}e=this._oMetaModel.getODataEntityContainer();s=e[A]||null;}return s;};M.prototype.getEntityLabelByEntityTypeName=function(e){var E=this._getEntityDefinition(e),r,R="";if(E){r=E["com.sap.vocabularies.Common.v1.Label"];if(r&&r.String){R=r.String;}}return R;};M.prototype._getEntityDefinition=function(e){var E=null;if(e){E=this._oMetaModel.getODataEntityType(this._getFullyQualifiedNameForEntity(e));}return E;};M.prototype._getComplexTypeDefinition=function(c){var C=null;if(c){C=this._oMetaModel.getODataComplexType(this._getFullyQualifiedNameForEntity(c));}return C;};M.prototype._getNameOfPropertyUsingComplexType=function(e,c){var C=this.getNamespace();if(e&&c&&C){var t=C+"."+c;var m=this._getEntityDefinition(e);if(m){var p=m.property;if(p&&p.length){var i=0;for(i=0;i<p.length;i++){var P=p[i];if(P&&P.type===t){return P.name;}}}}}return null;};M.prototype.removeNamespace=function(s){var i,r=s;if(s){i=s.lastIndexOf(".")+1;}if(i>0){r=s.substring(i);}return r;};M.prototype.getEntityTypeNameFromEntitySetName=function(e){var E=null,s=null;if(this._oMetaModel){E=this._oMetaModel.getODataEntitySet(e);if(E){s=E.entityType;}}return s;};M.prototype.getEntitySetNameFromEntityTypeName=function(e){var Q,E,b,i,l,o;if(this._oMetaModel&&e){Q=this._getFullyQualifiedNameForEntity(e);E=this._oMetaModel.getODataEntityContainer();if(E&&Q){b=E.entitySet;l=b.length;for(i=0;i<l;i++){o=b[i];if(o.entityType===Q){break;}o=null;}if(o){return o.name;}}}return null;};M.prototype.getKeysByEntitySetName=function(e){var k=null,E=null;if(!this._oMetaModel){return undefined;}E=this.getEntityTypeNameFromEntitySetName(e);if(E){k=this.getKeysByEntityTypeName(E);}return k;};M.prototype.getKeysByEntityTypeName=function(e){var k=null,p=null,i,l=0,E=null;if(!this._oMetaModel){return undefined;}E=this._getEntityDefinition(e);if(E){if(E.key){p=E.key.propertyRef;if(p){l=p.length;k=[];for(i=0;i<l;i++){k.push(p[i].name);}}}}return k;};M.prototype.getFieldsByEntitySetName=function(e){var f=null,E,s=null;if(!this._oMetaModel){return undefined;}E=this._oMetaModel.getODataEntitySet(e);if(E){s=E.entityType;}if(s){f=this.getFieldsByEntityTypeName(s);this._updateSortableOnFields(f,E);}return f;};M.prototype._updateSortableOnFields=function(f,e){var s,n,N=[],l,p,F;if(!e||!f){return;}s=e["Org.OData.Capabilities.V1.SortRestrictions"];if(s){n=s.NonSortableProperties;}if(n){l=n.length;while(l--){p=n[l].PropertyPath;if(p){N.push(p);}}}l=f.length;while(l--){F=f[l];if(N.indexOf(F.name)>-1){F.sortable=false;}else{F.sortable=true;}}};M.prototype.getFieldsByEntityTypeName=function(e){var E;if(!this._oMetaModel){return undefined;}E=this._getEntityDefinition(e);return this._getFieldsByEntityDefinition(E);};M.prototype.getFieldsByComplexTypeName=function(c,p){var C;if(!this._oMetaModel){return undefined;}C=this._getComplexTypeDefinition(c);return this._getFieldsByEntityDefinition(C,p);};M.prototype.getAllEntityTypeNames=function(){if(!this._oMetaModel){return undefined;}var s=this._oSchemaDefinition;if(s.entityType&&s.entityType.length>0){var i=0;var r=[];for(i=0;i<s.entityType.length;i++){r.push(s.entityType[i].name);}return r;}return null;};M.prototype.getFieldSemanticObjectMap=function(e){var m={};var o=this.getFieldsByEntitySetName(e);var i,l=o.length;for(i=0;i<l;i++){var f=o[i];var A=this.getSemanticObjectAnnotation(f.fullName);if(A&&A.semanticObject){m[f.name]=A.semanticObject;}}return m;};M.prototype._getFieldsByEntityDefinition=function(e,p){var f=null,P=null,i=0,l=0,o,F,r;if(e){P=e.property;}if(P){f=[];l=P.length;for(i=0;i<l;i++){o=P[i];if(o){F=q.extend({},o);r=o["com.sap.vocabularies.Common.v1.Label"];if(r){F.fieldLabel=r.String;}r=o["com.sap.vocabularies.Common.v1.QuickInfo"];if(r){F.quickInfo=r.String;}F.displayFormat=o["sap:display-format"];F.aggregationRole=o["sap:aggregation-role"];r=o["Org.OData.Measures.V1.ISOCurrency"];if(r){F.isCurrencyField=true;F.isMeasureField=true;F.unit=r.Path;}r=o["Org.OData.Measures.V1.Unit"];if(r){F.isMeasureField=true;F.unit=r.Path;}r=o["com.sap.vocabularies.Common.v1.Text"];if(r){F.description=r.Path;}F.displayBehaviour=this.getTextArrangementValue(o);F.filterRestriction=o["sap:filter-restriction"];r=o["sap:filterable"];F.filterable=r!=="false";r=o["sap:required-in-filter"];F.requiredField=r==="true";r=o["com.sap.vocabularies.Common.v1.FieldControl"];F.visible=!(r&&r.EnumMember==="com.sap.vocabularies.Common.v1.FieldControlType/Hidden");F.entityName=e.name;F.parentPropertyName=p;F.fullName=this._getFullyQualifiedNameForField(o.name,e);f.push(F);}}}return f;};M.prototype.getAllFilterableFieldsByEntitySetName=function(e){var f=[],E=null;if(!this._oMetaModel){return undefined;}E=this.getEntityTypeNameFromEntitySetName(e);if(E){f=this.getAllFilterableFieldsByEntityTypeName(E);}return f;};M.prototype.getAllFilterableFieldNamesByEntityTypeName=function(e){var g,i,b,j,f,r,G;r=[];g=this.getAllFilterableFieldsByEntityTypeName(e);if(g&&g.length){b=g.length;for(i=0;i<b;i++){G=g[i];if(G.fields&&G.fields.length){f=G.fields.length;for(j=0;j<f;j++){r.push(G.fields[j].name);}}}}return r;};M.prototype.getAllFilterableFieldsByEntityTypeName=function(e){var f=[],E=null,A=null,n=null,s=null;if(!this._oMetaModel){return undefined;}E=this._getEntityDefinition(e);if(E){f.push(this._getFilterableFieldsFromEntityDefinition(E));A=this._getFilterableAssociations(E);for(n in A){s=A[n];E=this._getEntityDefinition(s);if(E){f.push(this._getFilterableFieldsFromEntityDefinition(E,n));}}}return f;};M.prototype._getFilterableFieldsFromEntityDefinition=function(e,p){var f={},F=[],P=null,o,i,l,b=null;if(!this._oMetaModel||!e){return undefined;}o=e["com.sap.vocabularies.Common.v1.Label"];if(o){f.groupLabel=o.String;}f.groupEntityName=e.name;f.groupName=p;P=this._getFieldsByEntityDefinition(e,p);l=P.length;for(i=0;i<l;i++){b=P[i];if(b.visible&&b.filterable){F.push(b);}}f.fields=F;return f;};M.prototype._getFullyQualifiedNameForField=function(f,e){var n,E,r=f;if(e){n=e.namespace;E=e.name;}if(n&&E){r=n+"."+E+"/"+f;}return r;};M.prototype.getFieldNameByFullyQualifiedFieldName=function(f){var r,n;r=this.removeNamespace(f);n=r.indexOf("/");r=r.substring(n+1);return r;};M.prototype._getFilterableAssociations=function(e){var f={},n=null,N=null,i,l=0,E=null;if(!this._oMetaModel||!e){return undefined;}n=e.navigationProperty;if(n&&n.length){l=n.length;for(i=0;i<l;i++){N=n[i];if(N["sap:filterable"]==="false"){continue;}E=this._oMetaModel.getODataAssociationEnd(e,N.name);if(!E||E.type===(e.namespace+"."+e.name)){continue;}if(E.multiplicity==="1"||E.multiplicity==="0..1"){if(f[N.name]===undefined){f[N.name]=E.type;}}}}return f;};M.prototype.getValueListAnnotationLazy=function(p){var P,A={additionalAnnotations:[]},r,s,b,t,c,o,Q;P=new Promise(function(R,f){if(p&&this._oMetaModel){b=p.split("/");t=this._oMetaModel.getODataEntityType(b[0])||this._oMetaModel.getODataComplexType(b[0]);s=b[1];c=this._oMetaModel.getODataProperty(t,s,true);if(c){o=this._oMetaModel.createBindingContext(c);this._oMetaModel.getODataValueLists(o).then(function(v){for(Q in v){r={annotation:v[Q]};if(r.annotation){this._enrichValueHelpAnnotation(r,s);if(!Q){A.primaryValueListAnnotation=r;}else{r.qualifier=Q;A.additionalAnnotations.push(r);}}}R(A);}.bind(this),f);return;}}f();}.bind(this));return P;};M.prototype.getValueListAnnotation=function(p){var A={additionalAnnotations:[]},r,P,b,t,o,Q;if(p&&this._oMetaModel){b=p.split("/");t=this._oMetaModel.getODataEntityType(b[0])||this._oMetaModel.getODataComplexType(b[0]);o=this._oMetaModel.getODataProperty(t,b[1]);if(o){P=o.name;for(var s in o){if(s.indexOf("com.sap.vocabularies.Common.v1.ValueList")>-1){Q=null;r={annotation:o[s]};b=s.split("#");if(b.length===2){Q=b[1];}if(r.annotation){this._enrichValueHelpAnnotation(r,P);if(!Q){A.primaryValueListAnnotation=r;}else{r.qualifier=Q;A.additionalAnnotations.push(r);}}}}}}return A;};M.prototype._enrichValueHelpAnnotation=function(A,p){var r,R,e,k=[],K,I={},o={},b,c,f=[],v=[],d,P,V,l,g,L=0,i=0,F=0;if(A&&A.annotation){r=A.annotation;if(r){R=r["SearchSupported"];A.isSearchSupported=R?R.Bool==="true":false;R=r["CollectionPath"];if(R){A.valueListEntitySetName=R.String;if(this._oMetaModel){e=this._oMetaModel.getODataEntitySet(A.valueListEntitySetName);}if(e){A.valueListEntityName=e.entityType;A.semantics=e["sap:semantics"];k=this.getKeysByEntityTypeName(A.valueListEntityName);f=this.getFieldsByEntityTypeName(A.valueListEntityName);}}R=r["Label"];if(R){A.valueListTitle=R.String;}d=r["Parameters"];if(f&&d){L=d.length;}for(i=0;i<L;i++){g=d[i];V=undefined;l=undefined;P=g["ValueListProperty"];if(P){V=P.String;}P=g["LocalDataProperty"];if(P){l=P.PropertyPath;}b=false;if(g.RecordType==="com.sap.vocabularies.Common.v1.ValueListParameterInOut"||g.RecordType==="com.sap.vocabularies.Common.v1.ValueListParameterIn"){b=true;}c=false;if(g.RecordType==="com.sap.vocabularies.Common.v1.ValueListParameterInOut"||g.RecordType==="com.sap.vocabularies.Common.v1.ValueListParameterOut"){c=true;}if(b){I[l]=V;}if(c){o[l]=V;}if(c||g.RecordType==="com.sap.vocabularies.Common.v1.ValueListParameterDisplayOnly"){F=f.length;while(F--){if(f[F].name===V){v.push(f[F]);break;}}}if(!K&&c&&l===p){K=V;}}}A.inParams=I;A.outParams=o;A.fields=f;A.valueListFields=v;A.keys=k;A.keyField=K;A.descriptionField=this.getDescriptionFieldName(A.keyField,A.valueListEntitySetName);}};M.prototype.getDescriptionFieldName=function(k,e){var f,i=0,l,F,d;if(typeof k==="object"){F=k;}else{f=this.getFieldsByEntitySetName(e);if(f){l=f.length;for(i=0;i<l;i++){F=f[i];if(F.name===k){break;}F=null;}}}if(F&&F["com.sap.vocabularies.Common.v1.Text"]){d=F["com.sap.vocabularies.Common.v1.Text"].Path;}return d;};M.prototype.getIsSearchSupported=function(A){var i=false,p;if(A){p=A.SearchSupported;if(p&&p.Bool==="true"){i=true;}}return i;};M.prototype.getValueListSemantics=function(A){var e,E,s;if(A){e=A["CollectionPath"]?A["CollectionPath"].String:undefined;}if(e){E=this._oMetaModel.getODataEntitySet(e);if(E){s=E["sap:semantics"];}}return s;};M.prototype.getLineItemAnnotation=function(p){var e,A,r;if(p&&this._oMetaModel){e=this._oMetaModel.getODataEntityType(p);if(e){A=e["com.sap.vocabularies.UI.v1.LineItem"];if(A){r={annotation:A};this._enrichAnnotationWithUIDataField(r,A);}}}return r;};M.prototype.getPresentationVariantAnnotation=function(p){var e,A,l,i,r,L,c,I;if(p&&this._oMetaModel){e=this._oMetaModel.getODataEntityType(p);if(e){A=e["com.sap.vocabularies.UI.v1.PresentationVariant"];if(A){r={annotation:A,requestAtLeastFields:[],sortOrderFields:[]};if(A.Visualizations){l=A.Visualizations.length;for(i=0;i<l;i++){I=A.Visualizations[i].AnnotationPath;if(I.indexOf("com.sap.vocabularies.UI.v1.LineItem")>-1){L=e[I.substring(1)];r.lineItemAnnotation={annotation:L};this._enrichAnnotationWithUIDataField(r.lineItemAnnotation,L);break;}else if(I.indexOf("com.sap.vocabularies.UI.v1.Chart")>-1){c=e[I.substring(1)];r.chartAnnotation={annotation:c,semantics:e["sap:semantics"]};this._enrichChartAnnotation(r.chartAnnotation,c);break;}}}if(A.RequestAtLeast){l=A.RequestAtLeast.length;for(i=0;i<l;i++){r.requestAtLeastFields.push(A.RequestAtLeast[i].PropertyPath);}}if(A.SortOrder){l=A.SortOrder.length;for(i=0;i<l;i++){r.sortOrderFields.push({name:A.SortOrder[i].Property.PropertyPath,descending:A.SortOrder[i].Descending?A.SortOrder[i].Descending.Bool==="true":false});}}}}}return r;};M.prototype._enrichChartAnnotation=function(A,o){var i,l,b;if(A&&o){A.measureFields=[];A.dimensionFields=[];A.measureAttributes={};A.dimensionAttributes={};if(o.ChartType&&o.ChartType.EnumMember){A.chartType=o.ChartType.EnumMember;}if(o.Measures){l=o.Measures.length;for(i=0;i<l;i++){A.measureFields.push(o.Measures[i].PropertyPath);}}if(o.MeasureAttributes){l=o.MeasureAttributes.length;for(i=0;i<l;i++){b=o.MeasureAttributes[i];A.measureAttributes[b.Measure.PropertyPath]=b.Role.EnumMember;}}if(o.Dimensions){l=o.Dimensions.length;for(i=0;i<l;i++){A.dimensionFields.push(o.Dimensions[i].PropertyPath);}}if(o.DimensionAttributes){l=o.DimensionAttributes.length;for(i=0;i<l;i++){b=o.DimensionAttributes[i];A.dimensionAttributes[b.Dimension.PropertyPath]=b.Role.EnumMember;}}}};M.prototype.getChartAnnotation=function(p){var e,A,r;if(p&&this._oMetaModel){e=this._oMetaModel.getODataEntityType(p);if(e){A=e["com.sap.vocabularies.UI.v1.Chart"];if(A){r={annotation:A,semantics:e["sap:semantics"]};this._enrichChartAnnotation(r,A);}}}return r;};M.prototype.getFieldGroupAnnotation=function(p){var e,Q,P,r,A,R,b=[];if(p&&this._oMetaModel){e=this._oMetaModel.getODataEntityType(this._getFullyQualifiedNameForEntity(p));if(e){for(var s in e){if(s.indexOf("com.sap.vocabularies.UI.v1.FieldGroup")>-1){Q=null;A=e[s];P=s.split("#");if(P.length===2){Q=P[1];}if(A){R={annotation:A};if(Q){R.groupName=Q;}r=A["Label"];if(r){R.groupLabel=r.String;}r=A["Data"];if(r){this._enrichAnnotationWithUIDataField(R,r);}b.push(R);}}}}}return b;};M.prototype._enrichAnnotationWithUIDataField=function(A,r){var f=[],l={},I={},p,F,P,L=0,i=0;if(A&&r){L=r.length;f=[];l={};for(i=0;i<L;i++){P=r[i];if(P&&P.RecordType==="com.sap.vocabularies.UI.v1.DataField"){F=null;p=P["Value"];if(p){F=p.Path;f.push(F);}if(F){p=P["Label"];if(p&&p.String){l[F]=p.String;}I[F]=this._getImportanceAnnotation(P);}}}A.fields=f;A.labels=l;A.importance=I;}};M.prototype._getImportanceAnnotation=function(p){var i=null,r;r=p["com.sap.vocabularies.UI.v1.Importance"];if(r){i=r.EnumMember;}switch(i){case"com.sap.vocabularies.UI.v1.ImportanceType/Medium":return"Medium";case"com.sap.vocabularies.UI.v1.ImportanceType/Low":return"Low";default:return"High";}};M.prototype.getTextArrangementValue=function(p){var P,t,o,A,d;if(p&&this._oMetaModel){if(typeof(p)==="string"){p=this._getFullyQualifiedNameForEntity(p);P=p.split("/");if(P.length>1){t=this._oMetaModel.getODataEntityType(P[0])||this._oMetaModel.getODataComplexType(P[0]);o=this._oMetaModel.getODataProperty(t,P[1]);}else{o=this._oMetaModel.getODataEntityType(p)||this._oMetaModel.getODataComplexType(p);}}else{o=p;}if(o){A=o["com.sap.vocabularies.UI.v1.TextArrangement"];}if(A){switch(A.EnumMember){case"com.sap.vocabularies.UI.v1.TextArrangementType/TextFirst":d="descriptionAndId";break;case"com.sap.vocabularies.UI.v1.TextArrangementType/TextLast":d="idAndDescription";break;case"com.sap.vocabularies.UI.v1.TextArrangementType/TextSeparate":d="idOnly";break;}}}return d;};M.prototype.getSemanticObjectAnnotation=function(p){var P,t,o,A;if(p&&this._oMetaModel){P=p.split("/");t=this._oMetaModel.getODataEntityType(P[0])||this._oMetaModel.getODataComplexType(P[0]);o=this._oMetaModel.getODataProperty(t,P[1]);if(o){A=o["com.sap.vocabularies.Common.v1.SemanticObject"];}return this._prepareSemanticObjectAnnotationFromProperty(A);}return null;};M.prototype.getSemanticObjectAnnotationFromProperty=function(p){var A;if(p){A=p["com.sap.vocabularies.Common.v1.SemanticObject"];return this._prepareSemanticObjectAnnotationFromProperty(A);}return null;};M.prototype._prepareSemanticObjectAnnotationFromProperty=function(A){var r,R;if(A){r=A["String"];if(r){R={annotation:A};R.semanticObject=r;}}return R;};M.prototype._getFullyQualifiedNameForEntity=function(e){var n,r;if(!e){return undefined;}if(e.indexOf(".")>-1){return e;}n=this.getNamespace();if(n&&!(e.indexOf(n)>-1)){r=n+"."+e;}else{r=e;}return r;};M.prototype.destroy=function(){this.oModel=null;this._oMetaModel=null;this._oMetadata=null;this._oSchemaDefinition=null;this._sResourceRootUri=null;this.bIsDestroyed=true;};return M;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.odata.ODataModelUtil')){jQuery.sap.declare('sap.ui.comp.odata.ODataModelUtil');sap.ui.define("sap/ui/comp/odata/ODataModelUtil",[],function(){"use strict";var O={handleModelInit:function(s,m){var l=false,M;if(s&&!s._bMetaModelLoadAttached&&m){M=s.getModel();if(M){if(M.getMetadata()&&M.getMetadata().getName()==="sap.ui.model.odata.v2.ODataModel"){l=true;}else if(M.bLoadMetadataAsync||(M.getServiceMetadata&&!M.getServiceMetadata())){l=true;}s._bMetaModelLoadAttached=true;if(l&&M.getMetaModel()&&M.getMetaModel().loaded){M.getMetaModel().loaded().then(m.bind(s));}else{m.apply(s);}}}}};return O;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.odata.ODataType')){jQuery.sap.declare('sap.ui.comp.odata.ODataType');jQuery.sap.require('sap.ui.model.odata.type.Boolean');jQuery.sap.require('sap.ui.model.odata.type.Byte');jQuery.sap.require('sap.ui.model.odata.type.DateTime');jQuery.sap.require('sap.ui.model.odata.type.DateTimeOffset');jQuery.sap.require('sap.ui.model.odata.type.Decimal');jQuery.sap.require('sap.ui.model.odata.type.Double');jQuery.sap.require('sap.ui.model.odata.type.Single');jQuery.sap.require('sap.ui.model.odata.type.Guid');jQuery.sap.require('sap.ui.model.odata.type.Int16');jQuery.sap.require('sap.ui.model.odata.type.Int32');jQuery.sap.require('sap.ui.model.odata.type.Int64');jQuery.sap.require('sap.ui.model.odata.type.SByte');jQuery.sap.require('sap.ui.model.odata.type.String');jQuery.sap.require('sap.ui.model.odata.type.Time');sap.ui.define("sap/ui/comp/odata/ODataType",['sap/ui/model/odata/type/Boolean','sap/ui/model/odata/type/Byte','sap/ui/model/odata/type/DateTime','sap/ui/model/odata/type/DateTimeOffset','sap/ui/model/odata/type/Decimal','sap/ui/model/odata/type/Double','sap/ui/model/odata/type/Single','sap/ui/model/odata/type/Guid','sap/ui/model/odata/type/Int16','sap/ui/model/odata/type/Int32','sap/ui/model/odata/type/Int64','sap/ui/model/odata/type/SByte','sap/ui/model/odata/type/String','sap/ui/model/odata/type/Time'],function(B,a,D,b,c,d,S,G,I,e,f,g,h,T){"use strict";var u={"Edm.Boolean":B,"Edm.Byte":a,"Edm.DateTime":D,"Edm.DateTimeOffset":b,"Edm.Decimal":c,"Edm.Double":d,"Edm.Float":S,"Edm.Guid":G,"Edm.Int16":I,"Edm.Int32":e,"Edm.Int64":f,"Edm.SByte":g,"Edm.Single":S,"Edm.String":h,"Edm.Time":T};var n={"Edm.Decimal":true,"Edm.Double":true,"Edm.Float":true,"Edm.Int16":true,"Edm.Int32":true,"Edm.Int64":true,"Edm.Single":true};var m={"Edm.DateTime":true,"Edm.DateTimeOffset":true,"Edm.Time":true};var O={getType:function(t,F,C){var o=null,_;_=u[t];if(_){o=new _(F,C);}return o;},isNumeric:function(t){return n[t]?true:false;},isDateOrTime:function(t){return m[t]?true:false;}};return O;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.odata.SideEffects')){
/*
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.ui.comp.odata.SideEffects');jQuery.sap.require('jquery.sap.global');sap.ui.define("sap/ui/comp/odata/SideEffects",["jquery.sap.global"],function(q){"use strict";var S=function(){};S.prototype.getSideEffects=function(p,t,m){var r={};if(m){if(p){if(m.entitySet){r.entitySet=this._getForPath(m.entitySet,p);}if(m.entityType){r.entityType=this._getForPath(m.entityType,p);}}if(t&&m.complexType){r.complexType=this._getForPath(m.complexType,t);}}return r;};S.prototype._getForPath=function(e,p){var n,s,r={};for(n in e){if(n.indexOf&&n.indexOf("com.sap.vocabularies.Common.v1.SideEffects")===0){s=e[n];if(this._checkSourceProperties(s,p)){r[n]=s;}if(this._checkSourceEntities(s,p)){r[n]=s;}}}return r;};S.prototype._checkSourceProperties=function(s,p){var i,l;if(s.SourceProperties){l=s.SourceProperties.length;for(i=0;i<l;i++){if(s.SourceProperties[i].PropertyPath===p){return true;}}}return false;};S.prototype._checkSourceEntities=function(s,p){var i,l;if(s.SourceEntities&&s.SourceEntities.Collection){l=s.SourceEntities.Collection.length;for(i=0;i<l;i++){if(s.SourceEntities.Collection[i].NavigationPropertyPath===p){return true;}}}return false;};S.prototype.destroy=function(){};return S;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.personalization.ChartWrapper')){jQuery.sap.declare('sap.ui.comp.personalization.ChartWrapper');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.Element');sap.ui.define("sap/ui/comp/personalization/ChartWrapper",['jquery.sap.global','sap/ui/core/Element'],function(q,E){"use strict";var C=E.extend("sap.ui.comp.personalization.ChartWrapper",{constructor:function(i,s){E.apply(this,arguments);},metadata:{library:"sap.ui.comp",aggregations:{columns:{type:"sap.ui.comp.personalization.ColumnWrapper",multiple:true,singularName:"column"}},associations:{chart:{type:"sap.chart.Chart",multiple:false}}}});C.prototype.getChartObject=function(){var c=this.getAssociation("chart");if(typeof c==="string"){c=sap.ui.getCore().byId(c);}return c;};C.prototype.getDomRef=function(){var c=this.getChartObject();return c.getDomRef();};return C;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.personalization.ColumnWrapper')){jQuery.sap.declare('sap.ui.comp.personalization.ColumnWrapper');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.Element');sap.ui.define("sap/ui/comp/personalization/ColumnWrapper",['jquery.sap.global','sap/ui/core/Element'],function(q,E){"use strict";var C=E.extend("sap.ui.comp.personalization.ColumnWrapper",{constructor:function(i,s){E.apply(this,arguments);},metadata:{library:"sap.ui.comp",properties:{label:{type:"string"},tooltip:{type:"string"},selected:{type:"boolean",defaultValue:false},aggregationRole:{type:"sap.ui.comp.personalization.AggregationRole"},role:{type:"string"}}}});return C;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.smartfield.AnnotationHelper')){jQuery.sap.declare('sap.ui.comp.smartfield.AnnotationHelper');sap.ui.define("sap/ui/comp/smartfield/AnnotationHelper",[],function(){"use strict";var A=function(){};A.prototype.getText=function(p){return p["sap:text"]||this._getObject("com.sap.vocabularies.Common.v1.Text/Path",p);};A.prototype.getTextArrangement=function(p,e){var E=this._getObject("com.sap.vocabularies.UI.v1.TextArrangement",p);if(!E){E=this._getObject("com.sap.vocabularies.UI.v1.TextArrangement",e);}if(E&&E.EnumMember){if(E.EnumMember==="com.sap.vocabularies.UI.v1.TextArrangementType/TextFirst"){return"descriptionAndId";}else if(E.EnumMember==="com.sap.vocabularies.UI.v1.TextArrangementType/TextLast"){return"idAndDescription";}}return null;};A.prototype.getUnit=function(p){return p["sap:unit"]||this._getObject("Org.OData.Measures.V1.ISOCurrency/Path",p)||this._getObject("Org.OData.Measures.V1.Unit/Path",p);};A.prototype.getLabel=function(p){var l=this._getObject("com.sap.vocabularies.UI.v1.DataFieldWithUrl/Label/String",p);return l||p["sap:label"]||this._getObject("com.sap.vocabularies.Common.v1.Label/String",p);};A.prototype.isCurrency=function(p){return(p["sap:semantics"]==="currency-code")||!!this._getObject("Org.OData.Measures.V1.ISOCurrency/Path",p);};A.prototype.getQuickInfo=function(p){return p["sap:quickinfo"]||this._getObject("com.sap.vocabularies.Common.v1.QuickInfo/String",p);};A.prototype.isMasked=function(p){return(!!this._getObject("com.sap.vocabularies.Common.v1.Masked",p));};A.prototype.isMultiLineText=function(p){return(!!this._getObject("com.sap.vocabularies.UI.v1.MultiLineText",p));};A.prototype.isUpperCase=function(p){return(p["sap:display-format"]==="UpperCase")||(this._getObject("com.sap.vocabularies.Common.v1.IsUpperCase/Bool",p)==="true");};A.prototype.canCreateEntitySet=function(e){var n=(e["sap:creatable"]==="false")||(this._getObject("Org.OData.Capabilities.V1.InsertRestrictions/Insertable/Bool",e)==="false");return!n;};A.prototype.canCreateProperty=function(p){if(this._getObject("Org.OData.Core.V1.Computed/Bool",p)==="true"){return false;}if(p["sap:creatable"]==="false"){return false;}return true;};A.prototype.canUpdateEntitySet=function(e){var n=(e["sap:updatable"]==="false")||(this._getObject("Org.OData.Capabilities.V1.UpdateRestrictions/Updatable/Bool",e)==="false");return!n;};A.prototype.getUpdateEntitySetPath=function(e){return e["sap:updatable"]||this._getObject("Org.OData.Capabilities.V1.UpdateRestrictions/Updatable/Path",e);};A.prototype.canUpdateProperty=function(p){var n=(p["sap:updatable"]==="false")||(this._getObject("Org.OData.Core.V1.Immutable/Bool",p)==="true")||(this._getObject("com.sap.vocabularies.Common.v1.FieldControl/EnumMember",p)==="com.sap.vocabularies.Common.v1.FieldControlType/ReadOnly");return!n;};A.prototype.getFieldControlPath=function(p){return p["sap:field-control"]||this._getObject("com.sap.vocabularies.Common.v1.FieldControl/Path",p);};A.prototype.getVisible=function(p){var v;if(p["sap:visible"]){return p["sap:visible"];}v=this._getObject("com.sap.vocabularies.Common.v1.FieldControl/EnumMember",p);if(v==="com.sap.vocabularies.Common.v1.FieldControlType/Hidden"){return"false";}return"true";};A.prototype._getObject=function(p,o){var n=o,P=p.split("/"),i=0;while(n&&P[i]){n=n[P[i]];i++;}return n;};A.prototype.destroy=function(){};return A;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.smartfield.BindingUtil')){jQuery.sap.declare('sap.ui.comp.smartfield.BindingUtil');jQuery.sap.require('sap.ui.model.odata.AnnotationHelper');jQuery.sap.require('sap.ui.base.BindingParser');sap.ui.define("sap/ui/comp/smartfield/BindingUtil",["sap/ui/model/odata/AnnotationHelper","sap/ui/base/BindingParser"],function(A,B){"use strict";var a=function(){};a.prototype.correctPath=function(p){var r,m,e;r=/\((.+)\)/;m=r.exec(p);if(m){e=p.replace(m[0],"");}else{e=p;}return e.replace("/","");};a.prototype.getNavigationProperties=function(c){var o,b,r={};b=c.getBindingContext();if(b&&b.sPath){r.paths=b.sPath.split("/");}o=c.getObjectBinding();if(o&&o.sPath){r.objectBinding=o.sPath;if(r.paths){r.paths.push(o.sPath);}else{r.paths=[o.sPath];}}if(!r.paths){r.paths=[];}return r;};a.prototype.getBindingParts=function(b,p,I){var l=0,i,P,o;if(b&&b.parts){l=b.parts.length;}for(i=0;i<l;i++){o="";P=b.parts[i];if(P.model){o=o+P.model+">";}o=o+P.path;p.push(o);I.length++;}};a.prototype.toBinding=function(I){var o={},n,p,i,l,N={model:true,formatter:true,mode:true,path:true};if(I){if(I.parts&&I.parts.length){l=I.parts.length;o.parts=[];}for(i=0;i<l;i++){p=I.parts[i];o.parts.push(p);}for(n in N){if(I[n]){o[n]=I[n];}}return o;}return null;};a.prototype.toBindingPath=function(I){var o,O="",p,i,l;o=this.toBinding(I);if(o){if(o.model){O=o.model+">";}if(o.path){O=O+o.path;}else if(o.parts&&o.parts.length>0){l=o.parts.length;for(i=0;i<l;i++){p=o.parts[i];if(p.model){O=O+p.model+">";}O=O+p.path;}}}return O;};a.prototype.fromFormatter=function(m,f,p){var i,l,P,b={model:m,formatter:f.formatter};P=f.path();l=P.length;if(l>0){b.parts=P;if(p){for(i=0;i<l;i++){p.push(P[i]);}}}else{b.path="";}return b;};a.prototype.executeODataBindingExpression=function(b,o){var i,v,V,p,h,H="";if(b&&o){h=A.format(o,b);H=h;p=B.complexParser(h,o);V=[];if(p){if(p.formatter){for(i=0;i<p.parts.length;i++){v=o.getProperty(p.parts[i].path,"value");V.push(v);}H=p.formatter.apply(null,V);}else{H=o.getProperty(p.path,"value");}}}return H;};a.prototype.destroy=function(){};return a;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.smartfield.FieldControl')){jQuery.sap.declare('sap.ui.comp.smartfield.FieldControl');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.model.ParseException');sap.ui.define("sap/ui/comp/smartfield/FieldControl",["jquery.sap.global","sap/ui/comp/smartfield/BindingUtil","sap/ui/model/ParseException"],function(q,B,P){"use strict";var F=function(p,h){this._bIsDestroyed=false;this._oBinding=new B();this._oStoredProperties={};this._oParent=p;this._oHelper=h;this._oAnnotation=h.oAnnotation;};F.prototype.getBindableAttributes=function(n){var c=this._oParent.data("configdata");if(c&&(c.configdata&&!c.configdata.isUOM||!c.configdata)){return["editable"];}if(n){return["editable","visible"];}return["editable","visible","mandatory"];};F.prototype.getControlProperties=function(m,b){var M,l,n,r={};if(m&&b){l=b.length;while(l--){n=b[l];M="_get"+n.substring(0,1).toUpperCase()+n.substring(1);if(this[M]){r[n]=this[M](m,this._oParent.getBindingInfo(n));}}}return r;};F.prototype._getEditable=function(m,b,p){var a,i=-1,e=-1,c=-1,t=this,o={length:0};if(!b){if(p){a=this._oParent["get"+p.substring(0,1).toUpperCase()+p.substring(1)]();this._oStoredProperties[p]=a;}else{a=this._oParent.getEditable();this._oStoredProperties.editable=a;}}return{path:function(){var d=[],s,l=0;if(!m.property||!m.property.property){return[""];}s=t._oAnnotation.getFieldControlPath(m.property.property);if(s){d.push(t._toPath(m,s));i=l;l++;}if(m.entitySet["sap:updatable-path"]){d.push(m.entitySet["sap:updatable-path"]);e=l;l++;}if(b){c=l;t._oBinding.getBindingParts(b,d,o);l=l+o.length;}if(l>0){return d;}return[""];},formatter:function(v,d,f,g){var A=[],h,O;if(t._bIsDestroyed){return false;}h=t._oParent.getBindingContext();if(!h){return false;}if(h.getObject&&m&&m.property&&m.property.property){O=h.getObject();if(O&&O.__metadata&&O.__metadata.created){if(!t._getCreatableStatic(m)){return false;}}else if(!t._getUpdatableStatic(m)){return false;}}if(i>-1){A.push(arguments[i]!==1);}if(e>-1){A.push(!!arguments[e]);}if(c>-1){if(b.formatter){A.push(t._execFormatter(b.formatter,arguments,c,o.length));}else{A.push(!!arguments[c]);}}else{A.push(a);}return t._compare(A,false,true);}};};F.prototype._execFormatter=function(f,a,s,l){var A=[],i;if(s>-1&&l>-1){for(i=0;i<l;i++){A.push(a[s+i]);}}return f.apply(null,A);};F.prototype._getCreatableStatic=function(m){return(this._oAnnotation.canCreateEntitySet(m.entitySet)&&this._oAnnotation.canCreateProperty(m.property.property));};F.prototype._getUpdatableStatic=function(m){return(this._oAnnotation.canUpdateEntitySet(m.entitySet)&&this._oAnnotation.canUpdateProperty(m.property.property));};F.prototype._compare=function(a,p,d){var i,l=a.length;for(i=0;i<l;i++){if(a[i]===p){return p;}}return d;};F.prototype._getVisible=function(m,b){var p,i=-1,a=-1,t=this,o={length:0};if(!b){p=this._oParent.getVisible();this._oStoredProperties.visible=p;}return{path:function(){var c=[],s,l=0;if(!m.property||!m.property.property){return[""];}s=t._oAnnotation.getFieldControlPath(m.property.property);if(s){c.push(t._toPath(m,s));a=l;l++;}if(b){i=l;t._oBinding.getBindingParts(b,c,o);l=l+o.length;}if(l>0){return c;}return[""];},formatter:function(c,d){var A=[];if(t._bIsDestroyed){return false;}if(m.property&&m.property.property&&t._oAnnotation.getVisible(m.property.property)==="false"){return false;}if(a>-1){A.push(arguments[a]!==0);}if(i>-1){if(b.formatter){A.push(t._execFormatter(b.formatter,arguments,i,o.length));}else{A.push(!!arguments[i]);}}else{A.push(p);}return t._compare(A,false,true);}};};F.prototype._getMandatory=function(m,b){var p,i=-1,a=-1,t=this,o={length:0};if(!b){p=this._oParent.getMandatory();this._oStoredProperties.mandatory=p;}return{path:function(){var c=[],s,l=0;if(!m.property||!m.property.property){return[""];}s=t._oAnnotation.getFieldControlPath(m.property.property);if(s){c.push(t._toPath(m,s));a=l;l++;}if(b){i=l;t._oBinding.getBindingParts(b,c,o);l=l+o.length;}if(l>0){return c;}return[""];},formatter:function(c,d){var A=[];if(t._bIsDestroyed){return true;}if(m.property&&m.property.property&&m.property.property.nullable){A.push(m.property.property.nullable==="false");}if(a>-1){A.push(arguments[a]===7);}if(i>-1){if(b.formatter){A.push(t._execFormatter(b.formatter,arguments,i,o.length));}else{A.push(!!arguments[i]);}}else{A.push(p);}return t._compare(A,true,false);}};};F.prototype._toPath=function(m,p){if(m.property.complex){return m.path.replace(m.property.property.name,p);}if(m.navigationPath){return m.navigationPath+"/"+p;}return p;};F.prototype.getMandatoryCheck=function(p){var r,t=this;if(p){switch(p.property.type){case"Edm.DateTimeOffset":case"Edm.DateTime":case"Edm.Time":case"Edm.String":r=function(v){if(t._oParent.getMandatory()&&!v){throw new P(sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("VALUEHELPVALDLG_FIELDMESSAGE"));}};break;case"Edm.Decimal":case"Edm.Double":case"Edm.Float":case"Edm.Single":case"Edm.Int16":case"Edm.Int32":case"Edm.Int64":case"Edm.Byte":case"Edm.SByte":r=function(v){if(t._oParent.getMandatory()&&(v===null||v===undefined||v==="")){throw new P(sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("VALUEHELPVALDLG_FIELDMESSAGE"));}};break;default:break;}}return r;};F.prototype.getUOMEditState=function(m){var n,u,U,l=0,b;b=this._oParent.getBindingInfo("editable");n=this._getEditable(m,b);U={model:m.model,path:this._oHelper.getUOMPath(m),entitySet:m.entitySet,entityType:m.entityType,property:{property:m.annotations.uom.property,complex:m.property.complex,typePath:this._oHelper.getUOMTypePath(m)}};u=this._getEditable(U,this._oParent.getBindingInfo("uomEditable"),"uomEditable");return{path:function(){var N=n.path(),a=u.path();if(N[0]===""&&a===""){return[""];}l=N.length;return N.concat(a);},formatter:function(v,p,a,c){var A=[],i,N,d,e=arguments.length;for(i=0;i<l;i++){A.push(arguments[i]);}N=n.formatter.apply(null,A);A=[];for(i=0;i<e;i++){A.push(arguments[i]);}for(i=0;i<l;i++){A.shift();}d=u.formatter.apply(null,A);if(!d&&!N){return 0;}return 1;}};};F.prototype.hasUomEditState=function(m){var p;if(m&&m.annotations&&m.annotations.uom){p=this._oParent.getControlProposal();if(p){if(p.getControlType()==="ObjectNumber"){return true;}if(p.getObjectStatus()){return true;}}return this._oParent.getProposedControl()==="ObjectNumber";}return false;};F.prototype.destroy=function(){if(this._oBinding){this._oBinding.destroy();}this._oAnnotation=null;this._oBinding=null;if(this._oParent&&!this._oParent._bInDestroy){for(var p in this._oStoredProperties){this._oParent.unbindProperty(p,true);if(this._oParent["set"+p.substring(0,1).toUpperCase()+p.substring(1)]){this._oParent["set"+p.substring(0,1).toUpperCase()+p.substring(1)](this._oStoredProperties[p]);}}if(this._oStoredProperties){if(!this._oStoredProperties.editable){this._oParent.unbindProperty("editable");}if(!this._oStoredProperties.visible){this._oParent.unbindProperty("visible");}if(!this._oStoredProperties.mandatory){this._oParent.unbindProperty("mandatory");}if(!this._oStoredProperties.uomEditable){this._oParent.unbindProperty("uomEditable");}}}this._oStoredProperties=null;this._oParent=null;this._oHelper=null;this._bIsDestroyed=true;};return F;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.smartfield.JSONTypes')){jQuery.sap.declare('sap.ui.comp.smartfield.JSONTypes');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.model.type.Boolean');jQuery.sap.require('sap.ui.model.type.Date');jQuery.sap.require('sap.ui.model.type.Float');jQuery.sap.require('sap.ui.model.type.Integer');jQuery.sap.require('sap.ui.model.type.String');sap.ui.define("sap/ui/comp/smartfield/JSONTypes",["jquery.sap.global","sap/ui/model/type/Boolean","sap/ui/model/type/Date","sap/ui/model/type/Float","sap/ui/model/type/Integer","sap/ui/model/type/String"],function(q,B,D,F,I,S){"use strict";var J=function(){};J.prototype.getType=function(t){if(t){switch(t){case"Boolean":return new B();case"Date":return new D();case"Float":return new F();case"Integer":return new I();default:return new S();}}return null;};J.prototype.destroy=function(){};return J;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.smartfield.ODataControlSelector')){jQuery.sap.declare('sap.ui.comp.smartfield.ODataControlSelector');jQuery.sap.require('jquery.sap.global');sap.ui.define("sap/ui/comp/smartfield/ODataControlSelector",["jquery.sap.global"],function(q){"use strict";var O=function(m,p,t){this._oMetaData=m;this._oParent=p;this._oTypes=t;};O.prototype.checkComboBox=function(c){var r={};if(this._oMetaData.annotations.valuelist){r.valuelistType=this._oMetaData.annotations.valuelistType;r.annotation=this._oMetaData.annotations.valuelist;}if(!r.annotation){return r;}if(r.valuelistType==="fixed-values"&&!c){r.combobox=true;}if(!r.combobox){r.annotation=this._oMetaData.annotations.valuelist;r.combobox=this._checkConfig("dropDownList");}return r;};O.prototype.checkSelection=function(){var r={};if(this._oMetaData.annotations.valuelist){r.annotation=this._oMetaData.annotations.valuelist;r.selection=this._checkConfig("selection");}return r;};O.prototype.checkCheckBox=function(){var b,m;if(this._oMetaData.property&&this._oMetaData.property.property&&this._oMetaData.property.property.type==="Edm.String"){b=this._oParent.getBindingInfo("value");m=this._oTypes.getMaxLength(this._oMetaData.property,b);if(m===1){if(this._checkConfig("checkBox")){return true;}}}return false;};O.prototype.checkDatePicker=function(){if(this._oMetaData.property&&this._oMetaData.property.property&&this._oMetaData.property.property["sap:display-format"]==="Date"){return true;}return this._checkConfig("datePicker");};O.prototype._checkConfig=function(t){var c=this._oParent.getConfiguration();if(c){return c.getControlType()===t;}return false;};O.prototype.getCreator=function(b){var c=true,C,m={"Edm.Decimal":"_createEdmNumeric","Edm.Double":"_createEdmNumeric","Edm.Float":"_createEdmNumeric","Edm.Single":"_createEdmNumeric","Edm.Int16":"_createEdmNumeric","Edm.Int32":"_createEdmNumeric","Edm.Int64":"_createEdmNumeric","Edm.Byte":"_createEdmNumeric","Edm.DateTimeOffset":"_createEdmDateTimeOffset","Edm.DateTime":"_createEdmDateTime","Edm.Boolean":"_createEdmBoolean","Edm.String":"_createEdmString","Edm.Time":"_createEdmTime"};if(this._isUOMDisplayObjectStatus()){return"_createEdmUOMObjectStatus";}if(this._isUOMDisplay()){return"_createEdmUOMObjectNumber";}C=this._oParent.data("configdata");if(C&&C.configdata&&C.configdata.isUOM){if(C.configdata.getContextEditable){c=C.configdata.getContextEditable();}}if(!this._oParent.getEditable()||!this._oParent.getEnabled()||!this._oParent.getContextEditable()||!c){if(this._oMetaData.annotations){if(this._oMetaData.annotations.semantic&&!b){return"_createEdmSemantic";}if(this._oMetaData.annotations.uom){return"_createEdmUOMDisplay";}if(this._isObjectStatusProposed()){return"_createObjectStatus";}return(this._oMetaData.property&&this._oMetaData.property.property&&this._oMetaData.property.property.type==="Edm.Boolean")?"_createEdmBoolean":"_createEdmDisplay";}}if(this._oMetaData.annotations&&this._oMetaData.annotations.uom){return"_createEdmUOM";}if(this._oMetaData.property&&this._oMetaData.property.property){return m[this._oMetaData.property.property.type]||"_createEdmString";}return null;};O.prototype._isUOMDisplay=function(){if(this._oMetaData.annotations.uom){if(this._isObjectNumberProposed()){if(!this._oParent.getContextEditable()||(!this._oParent.getEditable()&&!this._oParent.getUomEditable())||(!this._oParent.getEnabled()&&!this._oParent.getUomEnabled())){return true;}if(this._oParent.getUomEditState()===0){return true;}}}return false;};O.prototype._isUOMDisplayObjectStatus=function(){if(this._oMetaData.annotations.uom){if(this._isObjectStatusProposed()){if(!this._oParent.getContextEditable()||(!this._oParent.getEditable()&&!this._oParent.getUomEditable())||(!this._oParent.getEnabled()&&!this._oParent.getUomEnabled())){return true;}if(this._oParent.getUomEditState()===0){return true;}}}return false;};O.prototype._isObjectStatusProposed=function(){var p=this._oParent.getControlProposal(),s;if(p){s=p.getObjectStatus();if(s){return true;}}return false;};O.prototype._isObjectNumberProposed=function(){var p;if(this._oParent.data("suppressUnit")!=="true"){p=this._oParent.getControlProposal();if(p&&p.getControlType()==="ObjectNumber"){return true;}if(this._oParent.getProposedControl()==="ObjectNumber"){return true;}}return false;};O.prototype.useObjectIdentifier=function(d,m){var p;if(this._oMetaData&&this._oMetaData.property&&this._oMetaData.property.property&&this._oMetaData.property.property.type==="Edm.String"){if(!d&&!m){p=this._oParent.getControlProposal();if(p&&p.getControlType()==="ObjectIdentifier"){return true;}if(this._oParent.getProposedControl()==="ObjectIdentifier"){return true;}}}return false;};O.prototype.destroy=function(){this._oParent=null;this._oMetaData=null;this._oTypes=null;};return O;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.smartfield.ODataHelper')){jQuery.sap.declare('sap.ui.comp.smartfield.ODataHelper');jQuery.sap.require('jquery.sap.global');sap.ui.define("sap/ui/comp/smartfield/ODataHelper",["jquery.sap.global","sap/ui/comp/odata/MetadataAnalyser","sap/ui/comp/smartfield/AnnotationHelper"],function(q,M,A){"use strict";var O=function(m,u,o){if(m){this.oMeta=m.getMetaModel();}if(o){this.oMeta=o;}this._oModel=m;this._oUtil=u;this.oAnnotation=new A();};O.prototype.getAnalyzer=function(m){if(!this._oAnalyzer){this._oAnalyzer=new M(this._oModel||m);}return this._oAnalyzer;};O.prototype.checkNavigationProperty=function(m,c){var p,P,l,r;if(c&&m){p=this._oUtil.getNavigationProperties(c);l=p.paths.length;while(l--){P=p.paths.shift();P=this._oUtil.correctPath(P);if(P===""||P===m.entitySet.name){continue;}r=this.getNavigationProperty(m.entityType,P);if(r.entitySet){m.entitySet=r.entitySet;m.entityType=r.entityType;}}}};O.prototype.getNavigationProperty=function(e,p){var n,t,r={};n=this._getNamedProperty(p,"navigationProperty",e);if(n){t=this.oMeta.getODataAssociationSetEnd(e,n.name);r.entitySet=this.oMeta.getODataEntitySet(t.entitySet);r.entityType=this.oMeta.getODataEntityType(r.entitySet.entityType);}return r;};O.prototype.startWithNavigationProperty=function(p,m){var P=p.split("/"),o;if(P&&P.length>1){o=this._getNamedProperty(P.shift(),"navigationProperty",m.entityType);}if(o){return o.name;}return null;};O.prototype.getProperty=function(m){var n=[],l,p,P,s,a,r={entityType:m.entityType,entitySet:m.entitySet};if(m){p=m.path.split("/");l=p.length;if(l>1){while(r.entityType){s=p[0];r=this.getNavigationProperty(r.entityType,s);if(r.entityType){m.entityType=r.entityType;m.entitySet=r.entitySet;n.push(p.shift());l--;}}}m.navigationPath=n.join("/");if(l>1){P=this.oMeta.getODataProperty(m.entityType,p[0]);if(P){m.property=this._getComplex(P,p,l);}return;}if(m.navigationPath){a=m.path.replace(m.navigationPath+"/","");}else{a=m.path;}P=this.oMeta.getODataProperty(m.entityType,a);m.property={property:P,typePath:m.path};}};O.prototype._getComplex=function(p,P,l){var o=p,t,c=[];while(l--){if(o){if(l===0){t=o.name;o=this._getNamedProperty(P[0],"property",o);return{typePath:t+"/"+P[0],property:o,complex:true,parents:c};}o=this.oMeta.getODataComplexType(o.type);if(o){c.push(o);}}P.shift();}};O.prototype._getNamedProperty=function(n,a,p){var r;q.each(p[a]||[],function(i,e){if(e.name===n){r=e;return false;}});return r;};O.prototype.getTextProperty2=function(m){var a,o;a=this.oAnnotation.getText(m.property.property);if(a){o=this._preprocAnnotation(a,m);this.getProperty(o);this._postprocAnnotation(o,m);}return o;};O.prototype.getUnitOfMeasure2=function(m){var a,o;a=this.oAnnotation.getUnit(m.property.property);if(a){o=this._preprocAnnotation(a,m);this.getProperty(o);this._postprocAnnotation(o,m);}return o;};O.prototype._preprocAnnotation=function(a,m){var p,o;o=this.traverseNavigationProperties(a,m.entityType);if(!o.navigationPath){o.entitySet=m.entitySet;}if(m.navigationPath){o.path=m.path.replace(m.navigationPath+"/","");}else{o.path=m.path;}if(o.navigationPath){p=a.replace(o.navigationPath+"/","");}else{p=a;}o.path=o.path.replace(m.property.property.name,p);if(o.navigationPath){o.navigationPathHelp=o.navigationPath;}return o;};O.prototype._postprocAnnotation=function(m,o){var p;if(m.navigationPathHelp){m.navigationPath=m.navigationPathHelp;}if(m.navigationPath){p=m.navigationPath;}else{p="";}if(o.navigationPath){if(p){p=o.navigationPath+"/"+p;}else{p=o.navigationPath;}}m.navigationPath=p;if(m.navigationPath){m.path=m.navigationPath+"/"+m.path;}};O.prototype.traverseNavigationProperties=function(p,e){var r={},R={},P,s,l;P=p.split("/");l=P.length;r.entityType=e;R.entityType=e;while(l--){s=P.shift();if(s===""){continue;}R=this.getNavigationProperty(r.entityType,s);if(!R.entitySet){break;}r.entityType=R.entityType;r.entitySet=R.entitySet;if(r.navigationPath){r.navigationPath=r.navigationPath+"/"+s;}else{r.navigationPath=s;}}return r;};O.prototype.getValueListAnnotationPath=function(m){var p,l;if(m.property.complex){l=m.property.parents.length-1;p=m.property.parents[l].namespace;p=p+"."+m.property.typePath;}else{p=m.entitySet.entityType+"/"+m.property.property.name;}return p;};O.prototype.getUOMValueListAnnotationPath=function(m){var p;if(m.annotations.uom){p=this.getValueListAnnotationPath(m.annotations.uom);}if(p){m.annotations.valuelistuom=p;}};O.prototype.getUOMTextAnnotation=function(m){if(m&&m.annotations&&m.annotations.uom){m.annotations.textuom=this.getTextProperty2(m.annotations.uom);}};O.prototype.geValueListEntitySet=function(m){if(m&&m.annotations&&m.annotations.valuelist){if(m.annotations.valuelist.primaryValueListAnnotation&&m.annotations.valuelist.primaryValueListAnnotation.valueListEntitySetName){m.annotations.valuelistentityset=this.oMeta.getODataEntitySet(m.annotations.valuelist.primaryValueListAnnotation.valueListEntitySetName);}}};O.prototype.getValueListData=function(m){if(m.property.property["sap:value-list"]||m.property.property["com.sap.vocabularies.Common.v1.ValueList"]){m.annotations.valuelist=this.getValueListAnnotationPath(m);if(m.property.property["sap:value-list"]){m.annotations.valuelistType=m.property.property["sap:value-list"];}else{m.annotations.valuelistType=this.getAnalyzer().getValueListSemantics(m.property.property["com.sap.vocabularies.Common.v1.ValueList"]);}}};O.prototype.getEdmDisplayPath=function(m){if(m.annotations.text){return m.annotations.text.path;}return m.path;};O.prototype.getUOMPath=function(m){if(m&&m.annotations&&m.annotations.uom){return m.annotations.uom.path;}return null;};O.prototype.getUOMTypePath=function(m){if(m.property.complex){return m.property.typePath.replace(m.property.property.name,m.annotations.uom.property.name);}return m.annotations.uom.property.name;};O.prototype.getUOMChangeHandler=function(c,u){return function(p){try{c.fireChange({value:p.mParameters.value,newValue:p.mParameters.value,unitChanged:u,validated:p.mParameters["validated"]});}catch(e){q.sap.log.warning(e);}};};O.prototype.getSelectionChangeHandler=function(c){return function(p){var k,i;try{i=p.getParameter("selectedItem");if(i&&i.getKey){k=i.getKey();}c.fireChange({value:k,newValue:k});}catch(e){q.sap.log.warning(e);}};};O.prototype.destroy=function(){if(this._oAnalyzer){this._oAnalyzer.destroy();}if(this.oAnnotation){this.oAnnotation.destroy();}this._oUtil=null;this.oMeta=null;this.oAnalyzer=null;this.oAnnotation=null;};return O;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.smartfield.SideEffectUtil')){jQuery.sap.declare('sap.ui.comp.smartfield.SideEffectUtil');jQuery.sap.require('jquery.sap.global');sap.ui.define("sap/ui/comp/smartfield/SideEffectUtil",["jquery.sap.global","sap/ui/comp/odata/SideEffects"],function(q,S){"use strict";var a=function(p){this._oParent=p;this._oSideEffects=new S();};a.prototype.getFieldGroupIDs=function(m,v){var M,c,t,s;if(m.property&&m.property.complex){c=m.property.parents[0];t=this._toTypePath(m.path,c);}M={entitySet:m.entitySet,entityType:m.entityType,complexType:c};s=this._oSideEffects.getSideEffects(m.path,t,M);return this._calcFieldGroups(s,m,v);};a.prototype._calcFieldGroups=function(s,m,v){var c,b,i,l,g=[];b=this._getSideEffects(s,m,v);l=b.length;c=this._oParent.getBindingContext().getPath();for(i=0;i<l;i++){this._calcFieldGroups2(b[i],g,v,c);}return g.length>0?g:null;};a.prototype._calcFieldGroups2=function(s,g,v,c){var u,i,I,t=this;s.sideEffects.forEach(function(o){I={name:o.name,originType:o.originType,originName:s.origin.name,originNamespace:s.origin.namespace,context:c};i=JSON.stringify(I);i=i.substring(1,i.length-2);u=v.data(i);if(!u){u=t.createUUID();v.data(u,I);v.data(i,u);}g.push(u);});};a.prototype._getSideEffects=function(s,m){var r,R=[];r={};r.sideEffects=this._getSideEffectsFromEntity("entitySet",s);if(r.sideEffects&&r.sideEffects.length){r.origin=m.entitySet;R.push(r);}r={};r.sideEffects=this._getSideEffectsFromEntity("entityType",s);if(r.sideEffects&&r.sideEffects.length){r.origin=m.entityType;R.push(r);}r={};r.sideEffects=this._getSideEffectsFromEntity("complexType",s);if(r.sideEffects&&r.sideEffects.length){r.origin=m.property.parents[0];R.push(r);}return R;};a.prototype._getSideEffectsFromEntity=function(N,s){var n,b=[];if(s[N]){for(n in s[N]){b.push({name:n,originType:N,sideEffect:s[N][n]});}}return b;};a.prototype._toTypePath=function(p,c){var P=p.split("/");return p.replace(P[0],c.name);};a.prototype.createUUID=function(){var d=new Date().getTime();var u="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx".replace(/[x]/g,function(c){var r=(d+Math.random()*16)%16|0;d=Math.floor(d/16);return(c==="x"?r:(r&0x7|0x8)).toString(16);});return u;};a.prototype.destroy=function(){if(this._oSideEffects){this._oSideEffects.destroy();}this._oSideEffects=null;};return a;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.smartfield.type.AbapBool')){jQuery.sap.declare('sap.ui.comp.smartfield.type.AbapBool');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.model.FormatException');jQuery.sap.require('sap.ui.model.ParseException');jQuery.sap.require('sap.ui.model.SimpleType');sap.ui.define("sap/ui/comp/smartfield/type/AbapBool",["jquery.sap.global","sap/ui/model/FormatException","sap/ui/model/ParseException","sap/ui/model/SimpleType"],function(q,F,P,S){"use strict";var A=S.extend("sap.ui.comp.smartfield.type.AbapBool",{constructor:function(){S.apply(this,arguments);this.sName="sap.ui.comp.smartfield.type.AbapBool";}});A.prototype.formatValue=function(v,t){if(v===undefined||v===null){return null;}switch(t){case"boolean":case"any":return v==="X";default:throw new F("Don't know how to format Boolean to "+t);}};A.prototype.parseValue=function(v,s){switch(s){case"boolean":return(v===true)?"X":"";default:throw new P("Don't know how to parse Boolean from "+s);}};A.prototype.validateValue=function(v){if(v!==null&&v!==undefined){if(v!=="X"&&v!==""){throw new P("Invalid Boolean "+v);}}};return A;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.smartfield.type.DateTime')){jQuery.sap.declare('sap.ui.comp.smartfield.type.DateTime');jQuery.sap.require('sap.ui.model.odata.type.DateTime');sap.ui.define("sap/ui/comp/smartfield/type/DateTime",["sap/ui/model/odata/type/DateTime"],function(D){"use strict";var a=D.extend("sap.ui.comp.smartfield.type.DateTime",{constructor:function(f,c){D.apply(this,[f,c]);this.oFieldControl=null;}});a.prototype.parseValue=function(v,s){var r=D.prototype.parseValue.apply(this,[v,s]);this.oFieldControl(v,s);return r;};a.prototype.getName=function(){return"sap.ui.comp.smartfield.type.DateTime";};return a;});};if(!jQuery.sap.isDeclared('sap.ui.comp.smartfield.type.DateTimeOffset')){jQuery.sap.declare('sap.ui.comp.smartfield.type.DateTimeOffset');jQuery.sap.require('sap.ui.model.odata.type.DateTimeOffset');sap.ui.define("sap/ui/comp/smartfield/type/DateTimeOffset",["sap/ui/model/odata/type/DateTimeOffset"],function(D){"use strict";var a=D.extend("sap.ui.comp.smartfield.type.DateTimeOffset",{constructor:function(f,c){D.apply(this,[f,c]);this.oFieldControl=null;}});a.prototype.parseValue=function(v,s){var r=D.prototype.parseValue.apply(this,[v,s]);this.oFieldControl(v,s);return r;};a.prototype.getName=function(){return"sap.ui.comp.smartfield.type.DateTimeOffset";};return a;});};if(!jQuery.sap.isDeclared('sap.ui.comp.smartfield.type.Decimal')){jQuery.sap.declare('sap.ui.comp.smartfield.type.Decimal');jQuery.sap.require('sap.ui.model.odata.type.Decimal');sap.ui.define("sap/ui/comp/smartfield/type/Decimal",["sap/ui/model/odata/type/Decimal"],function(D){"use strict";var a=D.extend("sap.ui.comp.smartfield.type.Decimal",{constructor:function(f,c){D.apply(this,[f,c]);this.oFieldControl=null;}});a.prototype.parseValue=function(v,s){var r=D.prototype.parseValue.apply(this,[v,s]);this.oFieldControl(v,s);return r;};a.prototype.getName=function(){return"sap.ui.comp.smartfield.type.Decimal";};return a;});};if(!jQuery.sap.isDeclared('sap.ui.comp.smartfield.type.Int16')){jQuery.sap.declare('sap.ui.comp.smartfield.type.Int16');jQuery.sap.require('sap.ui.model.odata.type.Int16');sap.ui.define("sap/ui/comp/smartfield/type/Int16",["sap/ui/model/odata/type/Int16"],function(I){"use strict";var a=I.extend("sap.ui.comp.smartfield.type.Int16",{constructor:function(f,c){I.apply(this,[f,c]);this.oFieldControl=null;}});a.prototype.parseValue=function(v,s){var r=I.prototype.parseValue.apply(this,[v,s]);this.oFieldControl(v,s);return r;};a.prototype.getName=function(){return"sap.ui.comp.smartfield.type.Int16";};return a;});};if(!jQuery.sap.isDeclared('sap.ui.comp.smartfield.type.Int32')){jQuery.sap.declare('sap.ui.comp.smartfield.type.Int32');jQuery.sap.require('sap.ui.model.odata.type.Int32');sap.ui.define("sap/ui/comp/smartfield/type/Int32",["sap/ui/model/odata/type/Int32"],function(I){"use strict";var a=I.extend("sap.ui.comp.smartfield.type.Int32",{constructor:function(f,c){I.apply(this,[f,c]);this.oFieldControl=null;}});a.prototype.parseValue=function(v,s){var r=I.prototype.parseValue.apply(this,[v,s]);this.oFieldControl(v,s);return r;};a.prototype.getName=function(){return"sap.ui.comp.smartfield.type.Int32";};return a;});};if(!jQuery.sap.isDeclared('sap.ui.comp.smartfield.type.Int64')){jQuery.sap.declare('sap.ui.comp.smartfield.type.Int64');jQuery.sap.require('sap.ui.model.odata.type.Int64');sap.ui.define("sap/ui/comp/smartfield/type/Int64",["sap/ui/model/odata/type/Int64"],function(I){"use strict";var a=I.extend("sap.ui.comp.smartfield.type.Int64",{constructor:function(f,c){I.apply(this,[f,c]);this.oFieldControl=null;}});a.prototype.parseValue=function(v,s){var r=I.prototype.parseValue.apply(this,[v,s]);this.oFieldControl(v,s);return r;};a.prototype.getName=function(){return"sap.ui.comp.smartfield.type.Int64";};return a;});};if(!jQuery.sap.isDeclared('sap.ui.comp.smartfield.type.SByte')){jQuery.sap.declare('sap.ui.comp.smartfield.type.SByte');jQuery.sap.require('sap.ui.model.odata.type.SByte');sap.ui.define("sap/ui/comp/smartfield/type/SByte",["sap/ui/model/odata/type/SByte"],function(S){"use strict";var a=S.extend("sap.ui.comp.smartfield.type.SByte",{constructor:function(f,c){S.apply(this,[f,c]);this.oFieldControl=null;}});a.prototype.parseValue=function(v,s){var r=S.prototype.parseValue.apply(this,[v,s]);this.oFieldControl(v,s);return r;};a.prototype.getName=function(){return"sap.ui.comp.smartfield.type.SByte";};return a;});};if(!jQuery.sap.isDeclared('sap.ui.comp.smartfield.type.String')){jQuery.sap.declare('sap.ui.comp.smartfield.type.String');jQuery.sap.require('sap.ui.model.odata.type.String');sap.ui.define("sap/ui/comp/smartfield/type/String",["sap/ui/model/odata/type/String"],function(S){"use strict";var a=S.extend("sap.ui.comp.smartfield.type.String",{constructor:function(f,c){S.apply(this,[f,c]);this.oFieldControl=null;}});a.prototype.parseValue=function(v,s){var r=S.prototype.parseValue.apply(this,[v,s]);this.oFieldControl(v,s);return r;};a.prototype.getName=function(){return"sap.ui.comp.smartfield.type.String";};return a;});};if(!jQuery.sap.isDeclared('sap.ui.comp.smartfield.type.Time')){jQuery.sap.declare('sap.ui.comp.smartfield.type.Time');jQuery.sap.require('sap.ui.model.odata.type.Time');sap.ui.define("sap/ui/comp/smartfield/type/Time",["sap/ui/model/odata/type/Time"],function(T){"use strict";var a=T.extend("sap.ui.comp.smartfield.type.Time",{constructor:function(f,c){T.apply(this,[f,c]);this.oFieldControl=null;}});a.prototype.parseValue=function(v,s){var r=T.prototype.parseValue.apply(this,[v,s]);this.oFieldControl(v,s);return r;};a.prototype.getName=function(){return"sap.ui.comp.smartfield.type.Time";};return a;});};if(!jQuery.sap.isDeclared('sap.ui.comp.smartfilterbar.AdditionalConfigurationHelper')){
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.ui.comp.smartfilterbar.AdditionalConfigurationHelper');jQuery.sap.require('jquery.sap.global');sap.ui.define("sap/ui/comp/smartfilterbar/AdditionalConfigurationHelper",['jquery.sap.global'],function(q){"use strict";var A=function(c,g){this.controlConfiguration=[];this.groupConfiguration=[];this._initialize(c,g);};A.prototype._initialize=function(c,g){var i,l,G,C,o,d,D,j,a,b;if(!c){c=[];}if(!g){g=[];}l=c.length;for(i=0;i<l;i++){C=c[i];o={};o.key=C.getKey();o.groupId=C.getGroupId();o.index=C.getIndex();o.label=C.getLabel();o.isVisible=C.getVisible();o.mandatory=C.getMandatory();o.width=C.getWidth();o.hasValueHelpDialog=C.getHasValueHelpDialog();o.hasTypeAhead=C.getHasTypeAhead();o.controlType=C.getControlType();o.filterType=C.getFilterType();o.customControl=C.getCustomControl();o.visibleInAdvancedArea=C.getVisibleInAdvancedArea();o.preventInitialDataFetchInValueHelpDialog=C.getPreventInitialDataFetchInValueHelpDialog();o.displayBehaviour=C.getDisplayBehaviour();o.defaultFilterValues=[];o.conditionType=C.getConditionType();d=C.getDefaultFilterValues();if(d&&d.length){a=d.length;for(j=0;j<a;j++){D=d[j];b={};b.sign=D.getSign();b.operator=D.getOperator();b.low=D.getLow();b.high=D.getHigh();o.defaultFilterValues.push(b);}}this.controlConfiguration.push(o);}l=g.length;for(i=0;i<l;i++){G=g[i];o={key:G.getKey(),index:G.getIndex(),label:G.getLabel()};this.groupConfiguration.push(o);}};A.prototype.getControlConfigurationByKey=function(k){var i,l;l=this.controlConfiguration.length;for(i=0;i<l;i++){if(this.controlConfiguration[i].key===k){return this.controlConfiguration[i];}}return undefined;};A.prototype.getControlConfiguration=function(){return this.controlConfiguration;};A.prototype.getGroupConfiguration=function(){return this.groupConfiguration;};A.prototype.getGroupConfigurationByKey=function(k){var i,l;l=this.groupConfiguration.length;for(i=0;i<l;i++){if(this.groupConfiguration[i].key===k){return this.groupConfiguration[i];}}return undefined;};return A;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.smartform.Group.designtime')){
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.ui.comp.smartform.Group.designtime');sap.ui.define("sap/ui/comp/smartform/Group.designtime",[],function(){"use strict";return{aggregations:{groupElements:{ignore:true},formElements:{domRef:":sap-domref"}},name:"{name}",description:"{description}"};},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.smartform.flexibility.DialogContentRenderer')){jQuery.sap.declare('sap.ui.comp.smartform.flexibility.DialogContentRenderer');jQuery.sap.require('jquery.sap.global');sap.ui.define("sap/ui/comp/smartform/flexibility/DialogContentRenderer",['jquery.sap.global'],function(q){"use strict";var D={};D.render=function(r,c){r.write("<div");r.writeControlData(c);r.writeClasses();r.write(">");var C=c.getContent();r.renderControl(C);r.write("</div>");};return D;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.smartform.flexibility.FieldListNodeRenderer')){jQuery.sap.declare('sap.ui.comp.smartform.flexibility.FieldListNodeRenderer');jQuery.sap.require('jquery.sap.global');sap.ui.define("sap/ui/comp/smartform/flexibility/FieldListNodeRenderer",['jquery.sap.global'],function(q){"use strict";var F={};F.render=function(r,c){r.write("<div");r.writeControlData(c);r.addClass("sapUiCompFieldListNode");if(!c.getIsVisible()){r.addClass("sapUiCompFieldListNodeIsHidden");}else{r.addClass("sapUiCompFieldListNodeIsVisible");}if(c.getIsSelected()){r.addClass("sapUiCompFieldListNodeIsSelected");}r.writeClasses();r.write(">");F.renderLayout(r,c);F.renderChildren(r,c);r.write("</div>");};F.renderLayout=function(r,c){r.renderControl(c._oLayout);};F.renderChildren=function(r,c){var l,i,C;C=c.getNodes();l=C.length;r.write('<div class="sapUiCompFieldListNodeBorder">');for(i=0;i<l;i++){r.renderControl(C[i]);}r.write("</div>");};return F;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.smartform.flexibility.FieldListRenderer')){jQuery.sap.declare('sap.ui.comp.smartform.flexibility.FieldListRenderer');jQuery.sap.require('jquery.sap.global');sap.ui.define("sap/ui/comp/smartform/flexibility/FieldListRenderer",['jquery.sap.global'],function(q){"use strict";var F={};F.render=function(r,c){r.write("<div");r.writeControlData(c);r.addClass("sapUiCompFieldList");r.writeClasses();r.write(">");F.renderNodes(r,c);r.write("</div>");};F.renderNodes=function(r,c){var n,l,i;n=c.getNodes();l=n.length;for(i=0;i<l;i++){r.renderControl(n[i]);}};return F;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.smartform.flexibility.InputRenderer')){jQuery.sap.declare('sap.ui.comp.smartform.flexibility.InputRenderer');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.m.InputRenderer');sap.ui.define("sap/ui/comp/smartform/flexibility/InputRenderer",['jquery.sap.global','sap/m/InputRenderer'],function(q,I){"use strict";var a={};a.render=function(r,c){I.render(r,c);};return a;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.smartform.flexibility.changes.AddField')){jQuery.sap.declare('sap.ui.comp.smartform.flexibility.changes.AddField');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.fl.Utils');jQuery.sap.require('sap.ui.fl.changeHandler.Base');sap.ui.define("sap/ui/comp/smartform/flexibility/changes/AddField",['jquery.sap.global','sap/ui/fl/Utils','sap/ui/fl/changeHandler/Base'],function(q,U,B){"use strict";var A=function(){};A.prototype=q.sap.newObject(B.prototype);A.prototype.applyChange=function(c,g){var C=c.getDefinition();if(C.texts&&C.texts.fieldLabel&&C.texts.fieldLabel.value&&C.content&&C.content.field&&C.content.field.id&&C.content.field.jsType&&C.content.field.value&&C.content.field.valueProperty){q.sap.require("sap.ui.comp.smartform.GroupElement");var G=new sap.ui.comp.smartform.GroupElement(C.content.field.id);if(G.setLabel){G.setLabel(C.texts.fieldLabel.value);}var V=this._getControlClass(C.content.field.jsType);var v=new V();if(v){if(C.content.field.entitySet&&v.setEntitySet){v.setEntitySet(C.content.field.entitySet);}G.addElement(v);v.bindProperty(C.content.field.valueProperty,C.content.field.value);}if(g&&g.insertGroupElement){g.insertGroupElement(G,C.content.field.index);}else{throw new Error("no parent group provided for adding the field");}}else{U.log.error("Change does not contain sufficient information to be applied: ["+C.layer+"]"+C.namespace+"/"+C.fileName+"."+C.fileType);}};A.prototype.completeChangeContent=function(c,s){var C=c.getDefinition();if(s.fieldLabel){this.setTextInChange(C,"fieldLabel",s.fieldLabel,"XFLD");}else{throw new Error("oSpecificChangeInfo.fieldLabel attribute required");}if(!C.content){C.content={};}if(!C.content.field){C.content.field={};}if(s.fieldValue){C.content.field.value=s.fieldValue;}else{throw new Error("oSpecificChangeInfo.fieldValue attribute required");}if(s.valueProperty){C.content.field.valueProperty=s.valueProperty;}else{throw new Error("oSpecificChangeInfo.valueProperty attribute required");}if(s.newControlId){C.content.field.id=s.newControlId;}else{throw new Error("oSpecificChangeInfo.newControlId attribute required");}if(s.jsType){C.content.field.jsType=s.jsType;}else{throw new Error("oSpecificChangeInfo.jsType attribute required");}if(s.index===undefined){throw new Error("oSpecificChangeInfo.index attribute required");}else{C.content.field.index=s.index;}if(s.entitySet){C.content.field.entitySet=s.entitySet;}};A.prototype._getControlClass=function(j){var r;q.sap.require(j);var s=j.split(".");var J=window;q.each(s,function(i,S){J=J[S];});if(typeof(J)=="function"){r=J;}return r;};A.prototype.getControlIdFromChangeContent=function(c){var C;if(c&&c._oDefinition){C=c._oDefinition.content.field.id;}return C;};return A;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.smartform.flexibility.changes.AddFields')){jQuery.sap.declare('sap.ui.comp.smartform.flexibility.changes.AddFields');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.fl.Utils');jQuery.sap.require('sap.ui.fl.changeHandler.Base');sap.ui.define("sap/ui/comp/smartform/flexibility/changes/AddFields",['jquery.sap.global','sap/ui/fl/Utils','sap/ui/fl/changeHandler/Base'],function(q,U,B){"use strict";var A=function(){};A.prototype=q.sap.newObject(B.prototype);A.prototype.applyChange=function(c,g){var C=c.getDefinition();if(C.texts&&C.content&&C.content.field&&C.content.field.id&&C.content.field.jsTypes&&C.content.field.value&&C.content.field.valueProperty){q.sap.require("sap.ui.comp.smartform.GroupElement");var G=new sap.ui.comp.smartform.GroupElement(C.content.field.id);if(G.setLabel){G.setLabel(C.texts["fieldLabel0"].value);}for(var i=0;i<C.content.field.jsTypes.length;i++){var v=C.content.field.value[i];var p=C.content.field.valueProperty[i];var e=C.content.field.entitySet;var V=this._getControlClass(C.content.field.jsTypes[i]);var o=new V();if(o){if(v&&p){o.bindProperty(p,v);}if(o.setTextLabel){o.setTextLabel(C.texts["fieldLabel"+i].value);}if(e&&o.setEntitySet){o.setEntitySet(e);}G.addElement(o);}}if(g&&g.insertGroupElement){g.insertGroupElement(G,C.content.field.index);}else{throw new Error("no parent group provided for adding the field");}}else{U.log.error("Change does not contain sufficient information to be applied: ["+C.layer+"]"+C.namespace+"/"+C.fileName+"."+C.fileType);}};A.prototype.completeChangeContent=function(c,s){var C=c.getDefinition();if(s.fieldLabels){for(var i=0;i<s.fieldLabels.length;i++){var f="fieldLabel"+i;this.setTextInChange(C,f,s.fieldLabels[i],"XFLD");}}else{throw new Error("oSpecificChangeInfo.fieldLabel attribute required");}if(!C.content){C.content={};}if(!C.content.field){C.content.field={};}if(s.fieldValues){C.content.field.value=s.fieldValues;}else{throw new Error("oSpecificChangeInfo.fieldValue attribute required");}if(s.valueProperty){C.content.field.valueProperty=s.valueProperty;}else{throw new Error("oSpecificChangeInfo.valueProperty attribute required");}if(s.newControlId){C.content.field.id=s.newControlId;}else{throw new Error("oSpecificChangeInfo.newControlId attribute required");}if(s.jsTypes){C.content.field.jsTypes=s.jsTypes;}else{throw new Error("oSpecificChangeInfo.jsType attribute required");}if(s.index===undefined){throw new Error("oSpecificChangeInfo.index attribute required");}else{C.content.field.index=s.index;}if(s.entitySet){C.content.field.entitySet=s.entitySet;}};A.prototype._getControlClass=function(j){var r;q.sap.require(j);var s=j.split(".");var J=window;q.each(s,function(i,S){J=J[S];});if(typeof(J)=="function"){r=J;}return r;};return A;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.smartform.flexibility.changes.AddGroup')){jQuery.sap.declare('sap.ui.comp.smartform.flexibility.changes.AddGroup');jQuery.sap.require('sap.ui.fl.Utils');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.fl.changeHandler.Base');sap.ui.define("sap/ui/comp/smartform/flexibility/changes/AddGroup",['sap/ui/fl/Utils','jquery.sap.global','sap/ui/fl/changeHandler/Base'],function(U,q,B){"use strict";var A=function(){};A.prototype=q.sap.newObject(B.prototype);A.prototype.applyChange=function(c,f){var C=c.getDefinition();if(C.texts&&C.texts.groupLabel&&C.texts.groupLabel.value&&C.content&&C.content.group&&C.content.group.id){q.sap.require("sap.ui.comp.smartform.Group");var g=new sap.ui.comp.smartform.Group(C.content.group.id);if(g.setLabel){g.setLabel(C.texts.groupLabel.value);}if(f&&f.insertGroup){f.insertGroup(g,C.content.group.index);}else{throw new Error("no parent form provided for adding the group");}}else{U.log.error("Change does not contain sufficient information to be applied: ["+C.layer+"]"+C.namespace+"/"+C.fileName+"."+C.fileType);}};A.prototype.completeChangeContent=function(c,s){var C=c.getDefinition();if(s.groupLabel){this.setTextInChange(C,"groupLabel",s.groupLabel,"XFLD");}else{throw new Error("oSpecificChangeInfo.groupLabel attribute required");}if(!C.content){C.content={};}if(!C.content.group){C.content.group={};}if(s.newControlId){C.content.group.id=s.newControlId;}else{throw new Error("oSpecificChangeInfo.newControlId attribute required");}if(s.index===undefined){throw new Error("oSpecificChangeInfo.index attribute required");}else{C.content.group.index=s.index;}};A.prototype.getControlIdFromChangeContent=function(c){var C;if(c&&c._oDefinition){C=c._oDefinition.content.group.id;}return C;};return A;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.smartform.flexibility.changes.MoveFields')){jQuery.sap.declare('sap.ui.comp.smartform.flexibility.changes.MoveFields');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.fl.changeHandler.Base');jQuery.sap.require('sap.ui.fl.Utils');sap.ui.define("sap/ui/comp/smartform/flexibility/changes/MoveFields",['jquery.sap.global','sap/ui/fl/changeHandler/Base','sap/ui/fl/Utils'],function(q,B,F){"use strict";var M=function(){};M.prototype=q.sap.newObject(B.prototype);M.prototype.applyChange=function(c,g){if(!c){throw new Error("No change instance");}var C=c.getDefinition();if(!C.selector||!C.content||!C.content.moveFields||C.content.moveFields.length===0||Object.keys(C.selector).length!==1){throw new Error("Change format invalid");}if(!g||!g.getGroupElements||!g.getId){throw new Error("No smart form group instance supplied");}var t=g;var T=false;if(C.content.targetId){var s=g.getId();if(s!==C.content.targetId){t=sap.ui.getCore().byId(C.content.targetId);T=true;}}var f=g.getGroupElements();if(!f){return;}var a=f.length;var o={},m={};var b=C.content.moveFields.length;var I,i,j;for(i=0;i<b;i++){m=C.content.moveFields[i];if(!m.id){throw new Error("Change format invalid - moveFields element has no id attribute");}if(typeof(m.index)!=="number"){throw new Error("Change format invalid - moveFields element index attribute is no number");}I=-1;for(j=0;j<a;j++){var d=f[j].getId();if(d===m.id){I=j;break;}}if(T===false&&I===m.index){continue;}if(I===-1){continue;}o=f[I];if(T===true){g.removeGroupElement(o);t.insertGroupElement(o,m.index);continue;}f.splice(I,1);if(T===false){f.splice(m.index,0,o);}}if(T===true){return;}g.removeAllGroupElements();for(i=0;i<a;i++){g.insertGroupElement(f[i],i);}};M.prototype.completeChangeContent=function(c,s){var C=c.getDefinition();if(s.moveFields){var m={};var i,l=s.moveFields.length;if(l===0){throw new Error("MoveFields array is empty");}for(i=0;i<l;i++){m=s.moveFields[i];if(!m.id){throw new Error("MoveFields element has no id attribute");}if(typeof(m.index)!=="number"){throw new Error("Index attribute at MoveFields element is no number");}}if(!C.content){C.content={};}if(!C.content.moveFields){C.content.moveFields=[];}C.content.moveFields=s.moveFields;if(s.targetId){C.content.targetId=s.targetId;}}else{throw new Error("oSpecificChangeInfo.moveFields attribute required");}};return M;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.smartform.flexibility.changes.MoveGroups')){jQuery.sap.declare('sap.ui.comp.smartform.flexibility.changes.MoveGroups');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.fl.changeHandler.Base');jQuery.sap.require('sap.ui.fl.Utils');sap.ui.define("sap/ui/comp/smartform/flexibility/changes/MoveGroups",['jquery.sap.global','sap/ui/fl/changeHandler/Base','sap/ui/fl/Utils'],function(q,B,F){"use strict";var M=function(){};M.prototype=q.sap.newObject(B.prototype);M.prototype.applyChange=function(c,s){if(!c){throw new Error("No change instance");}var C=c.getDefinition();if(!C.selector||!C.content||!C.content.moveGroups||C.content.moveGroups.length===0||Object.keys(C.selector).length!==1){throw new Error("Change format invalid");}if(!s||!s.getGroups){throw new Error("No smart form instance supplied");}var g=[];g=s.getGroups();if(g.length===0){return;}var G=g.length;var o={},m={};var a=C.content.moveGroups.length;var I;var i,j;for(i=0;i<a;i++){m=C.content.moveGroups[i];if(!m.id){throw new Error("Change format invalid - moveGroups element has no id attribute");}if(typeof(m.index)!=="number"){throw new Error("Change format invalid - moveGroups element index attribute is no number");}I=-1;for(j=0;j<G;j++){if(g[j].getId()===m.id){I=j;break;}}if(I===m.index||I===-1){continue;}o=g[I];g.splice(I,1);g.splice(m.index,0,o);}s.removeAllGroups();for(i=0;i<G;i++){s.insertGroup(g[i],i);}};M.prototype.completeChangeContent=function(c,s){var C=c.getDefinition();if(s.moveGroups){var m={};var i,l=s.moveGroups.length;if(l===0){throw new Error("MoveGroups array is empty");}for(i=0;i<l;i++){m=s.moveGroups[i];if(!m.id){throw new Error("MoveGroups element has no id attribute");}if(typeof(m.index)!=="number"){throw new Error("Index attribute at MoveGroups element is no number");}}if(!C.content){C.content={};}if(!C.content.moveGroups){C.content.moveGroups=[];}C.content.moveGroups=s.moveGroups;}else{throw new Error("oSpecificChangeInfo.moveGroups attribute required");}};return M;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.smartform.flexibility.changes.OrderFields')){jQuery.sap.declare('sap.ui.comp.smartform.flexibility.changes.OrderFields');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.fl.changeHandler.Base');jQuery.sap.require('sap.ui.fl.Utils');sap.ui.define("sap/ui/comp/smartform/flexibility/changes/OrderFields",['jquery.sap.global','sap/ui/fl/changeHandler/Base','sap/ui/fl/Utils'],function(q,B,F){"use strict";var O=function(){};O.prototype=q.sap.newObject(B.prototype);O.prototype.applyChange=function(c,C){if(!c){throw new Error("No change instance");}var o=c.getDefinition();if(!o.selector||!o.content||!o.content.orderFields||o.content.orderFields.length===0||Object.keys(o.selector).length!==1){throw new Error("Change format invalid");}if(!C||!C.getGroupElements){throw new Error("No control instance or wrong control instance supplied");}var g=C.getGroupElements();var G=g.length;var k=o.content.orderFields;var K=k.length;var a={},b={};var s;var i;for(i=0;i<G;i++){b=g[i];if(!b.getId()){return;}s=b.getId();a[s]=b;}C.removeAllGroupElements();for(i=0;i<G;i++){s=k[i];if(a[s]){C.insertGroupElement(a[s],i);a[s]=null;}}i=K;q.each(a,function(d,e){if(e!==null){i+=1;C.insertGroupElement(e,i);}});};O.prototype.completeChangeContent=function(c,s){var C=c.getDefinition();if(s.orderFields){if(!C.content){C.content={};}if(!C.content.orderFields){C.content.orderFields={};}C.content.orderFields=s.orderFields;}else{throw new Error("oSpecificChangeInfo.orderFields attribute required");}};return O;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.smartform.flexibility.changes.OrderGroups')){jQuery.sap.declare('sap.ui.comp.smartform.flexibility.changes.OrderGroups');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.fl.changeHandler.Base');jQuery.sap.require('sap.ui.fl.Utils');sap.ui.define("sap/ui/comp/smartform/flexibility/changes/OrderGroups",['jquery.sap.global','sap/ui/fl/changeHandler/Base','sap/ui/fl/Utils'],function(q,B,F){"use strict";var O=function(){};O.prototype=q.sap.newObject(B.prototype);O.prototype.applyChange=function(c,C){if(!c){throw new Error("No change instance");}var o=c.getDefinition();if(!o.selector||!o.content||!o.content.orderGroups||o.content.orderGroups.length===0||Object.keys(o.selector).length!==1){throw new Error("Change format invalid");}if(!C||!C.getGroups){throw new Error("No control instance or wrong control instance supplied");}var g=C.getGroups();var G=g.length;var k=o.content.orderGroups;var K=k.length;var a={},b={};var s;var i;for(i=0;i<G;i++){b=g[i];if(!b.getId()){return;}s=b.getId();a[s]=b;}if(G>0){C.removeAllGroups();}for(i=0;i<G;i++){s=k[i];if(a[s]){C.insertGroup(a[s],i);a[s]=null;}}i=K;q.each(a,function(d,e){if(e!==null){i+=1;C.insertGroup(e,i);}});};O.prototype.completeChangeContent=function(c,s){var C=c.getDefinition();if(s.orderGroups){if(!C.content){C.content={};}if(!C.content.orderGroups){C.content.orderGroups={};}C.content.orderGroups=s.orderGroups;}else{throw new Error("oSpecificChangeInfo.orderGroups attribute required");}};return O;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.smartform.flexibility.changes.RemoveField')){jQuery.sap.declare('sap.ui.comp.smartform.flexibility.changes.RemoveField');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.fl.changeHandler.Base');sap.ui.define("sap/ui/comp/smartform/flexibility/changes/RemoveField",['jquery.sap.global','sap/ui/fl/changeHandler/Base'],function(q,B){"use strict";var R=function(){};R.prototype=q.sap.newObject(B.prototype);R.prototype.applyChange=function(c,f){if(f.getParent){var g=f.getParent();if(g.removeGroupElement){g.removeGroupElement(f);}}else{throw new Error("no GroupElement control provided for removing the field");}};R.prototype.completeChangeContent=function(c,s){var C=c.getDefinition();if(!C.content){C.content={};}};return R;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.smartform.flexibility.changes.RemoveGroup')){
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.ui.comp.smartform.flexibility.changes.RemoveGroup');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.fl.changeHandler.Base');sap.ui.define("sap/ui/comp/smartform/flexibility/changes/RemoveGroup",['jquery.sap.global','sap/ui/fl/changeHandler/Base'],function(q,B){"use strict";var R=function(){};R.prototype=q.sap.newObject(B.prototype);R.prototype.applyChange=function(c,g){var i=null;if(g.getParent){i=g.getParent();if(i){if(i.removeFormContainer){i.removeFormContainer(g);}}}else{throw new Error("no Group control provided for removing the group");}};R.prototype.completeChangeContent=function(c,s){var C=c.getDefinition();if(!C.content){C.content={};}};return R;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.smartform.flexibility.changes.RenameField')){
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.ui.comp.smartform.flexibility.changes.RenameField');jQuery.sap.require('sap.ui.fl.Utils');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.fl.changeHandler.Base');sap.ui.define("sap/ui/comp/smartform/flexibility/changes/RenameField",['sap/ui/fl/Utils','jquery.sap.global','sap/ui/fl/changeHandler/Base'],function(U,q,B){"use strict";var R=function(){};R.prototype=q.sap.newObject(B.prototype);R.prototype.applyChange=function(c,C){var o=c.getDefinition();if(o.texts&&o.texts.fieldLabel&&this._isProvided(o.texts.fieldLabel.value)){if(!C){throw new Error("no Control provided for renaming");}if(typeof C.setLabel==='function'){C.unbindProperty("label");C.setLabel(o.texts.fieldLabel.value);}else if(typeof C.setTitle==='function'){C.unbindProperty("title");C.setTitle(o.texts.fieldLabel.value);}else{throw new Error('Control does not support "renameField" change');}}else{U.log.error("Change does not contain sufficient information to be applied: ["+o.layer+"]"+o.namespace+"/"+o.fileName+"."+o.fileType);}};R.prototype.completeChangeContent=function(c,s){var C=c.getDefinition();if(this._isProvided(s.fieldLabel)){this.setTextInChange(C,"fieldLabel",s.fieldLabel,"XFLD");}else{throw new Error("oSpecificChangeInfo.fieldLabel attribute required");}};R.prototype._isProvided=function(s){return typeof(s)==="string";};return R;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.smartform.flexibility.changes.RenameGroup')){jQuery.sap.declare('sap.ui.comp.smartform.flexibility.changes.RenameGroup');jQuery.sap.require('sap.ui.fl.Utils');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.fl.changeHandler.Base');sap.ui.define("sap/ui/comp/smartform/flexibility/changes/RenameGroup",['sap/ui/fl/Utils','jquery.sap.global','sap/ui/fl/changeHandler/Base'],function(U,q,B){"use strict";var R=function(){};R.prototype=q.sap.newObject(B.prototype);R.prototype.applyChange=function(c,g){var C=c.getDefinition();if(C.texts&&C.texts.groupLabel&&this._isProvided(C.texts.groupLabel.value)){if(g&&g.setLabel){g.unbindProperty("label");g.setLabel(C.texts.groupLabel.value);}else{throw new Error("no Group provided for renaming");}}else{U.log.error("Change does not contain sufficient information to be applied: ["+C.layer+"]"+C.namespace+"/"+C.fileName+"."+C.fileType);}};R.prototype.completeChangeContent=function(c,s){var C=c.getDefinition();if(this._isProvided(s.groupLabel)){this.setTextInChange(C,"groupLabel",s.groupLabel,"XFLD");}else{throw new Error("oSpecificChangeInfo.groupLabel attribute required");}};R.prototype._isProvided=function(s){return typeof(s)==="string";};return R;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.smartmicrochart.SmartAreaMicroChartRenderer')){jQuery.sap.declare("sap.ui.comp.smartmicrochart.SmartAreaMicroChartRenderer");jQuery.sap.require('sap.ui.core.Renderer');jQuery.sap.require('sap.suite.ui.microchart.AreaMicroChartRenderer');sap.ui.comp.smartmicrochart.SmartAreaMicroChartRenderer=sap.ui.core.Renderer.extend(sap.suite.ui.microchart.AreaMicroChartRenderer);};if(!jQuery.sap.isDeclared('sap.ui.comp.smartmicrochart.SmartBulletMicroChartRenderer')){jQuery.sap.declare("sap.ui.comp.smartmicrochart.SmartBulletMicroChartRenderer");jQuery.sap.require('sap.ui.core.Renderer');jQuery.sap.require('sap.suite.ui.microchart.BulletMicroChartRenderer');sap.ui.comp.smartmicrochart.SmartBulletMicroChartRenderer=sap.ui.core.Renderer.extend(sap.suite.ui.microchart.BulletMicroChartRenderer);};if(!jQuery.sap.isDeclared('sap.ui.comp.smarttable.SmartTable.designtime')){jQuery.sap.declare('sap.ui.comp.smarttable.SmartTable.designtime');sap.ui.define("sap/ui/comp/smarttable/SmartTable.designtime",[],function(){"use strict";return{aggregations:{customToolbar:{ignore:true},semanticObjectController:{ignore:true},noData:{ignore:true}}};},false);};if(!jQuery.sap.isDeclared('sap.ui.comp.util.FormatUtil')){
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.ui.comp.util.FormatUtil');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.model.FilterOperator');jQuery.sap.require('sap.ui.core.format.NumberFormat');sap.ui.define("sap/ui/comp/util/FormatUtil",["jquery.sap.global","sap/ui/model/FilterOperator","sap/ui/core/format/NumberFormat"],function(q,F,N){"use strict";var a={getFormattedExpressionFromDisplayBehaviour:function(d,i,D){var t=null;if(!i){return D?D:"";}switch(d){case"descriptionAndId":if(D&&i){t=D+" ("+i+")";}else if(!D){t=i;}break;case"idAndDescription":if(D&&i){t=i+" ("+D+")";}else if(!D){t=i;}break;case"descriptionOnly":t=D;if(!D){t=i;}break;default:t=i;break;}return t;},getFormattedBindingExpressionFromDisplayBehaviour:function(d,i,D){return a.getFormattedExpressionFromDisplayBehaviour(d,"{"+i+"}","{"+D+"}");},getFormattedRangeText:function(o,v,V,e){var t;if(v){switch(o){case F.EQ:t="="+v;break;case F.GT:t=">"+v;break;case F.GE:t=">="+v;break;case F.LT:t="<"+v;break;case F.LE:t="<="+v;break;case F.Contains:t="*"+v+"*";break;case F.StartsWith:t=v+"*";break;case F.EndsWith:t="*"+v;break;case F.BT:if(V){t=v+"..."+V;}break;default:t="";break;}}if(e&&t){t="!("+t+")";}return t;},_initialiseCurrencyFormatter:function(){if(!a._oCurrencyFormatter){a._oCurrencyFormatter=N.getCurrencyInstance({showMeasure:false});}if(!a._MAX_CURRENCY_DIGITS){a._MAX_CURRENCY_DIGITS=3;}a._initialiseSpaceChars();},_initialiseSpaceChars:function(){if(!a._FIGURE_SPACE||!a._PUNCTUATION_SPACE){a._FIGURE_SPACE='\u2007';a._PUNCTUATION_SPACE='\u2008';}},getAmountCurrencyFormatter:function(){a._initialiseCurrencyFormatter();if(!a._fAmountCurrencyFormatter){a._fAmountCurrencyFormatter=function(A,c){var v,C,p;if(A===undefined||A===null||c==="*"){return"";}v=a._oCurrencyFormatter.format(A,c);C=a._oCurrencyFormatter.oLocaleData.getCurrencyDigits(c);if(C===0){v+=a._PUNCTUATION_SPACE;}p=a._MAX_CURRENCY_DIGITS-C;if(p){v=q.sap.padRight(v,a._FIGURE_SPACE,v.length+p);}return v;};}return a._fAmountCurrencyFormatter;},getCurrencySymbolFormatter:function(){a._initialiseCurrencyFormatter();if(!a._fCurrencySymbolFormatter){a._fCurrencySymbolFormatter=function(c){if(!c||c==="*"){return"";}return a._oCurrencyFormatter.oLocaleData.getCurrencySymbol(c);};}return a._fCurrencySymbolFormatter;},getMeasureUnitFormatter:function(){a._initialiseSpaceChars();if(!a._fMeasureFormatter){a._fMeasureFormatter=function(v,u){if(v===undefined||v===null||u==="*"){return"";}return v+a._FIGURE_SPACE;};}return a._fMeasureFormatter;},getEdmTimeFromDate:function(d){if(!a._oTimeFormat){q.sap.require("sap.ui.core.format.DateFormat");a._oTimeFormat=sap.ui.core.format.DateFormat.getTimeInstance({pattern:"'PT'HH'H'mm'M'ss'S'"});}return a._oTimeFormat.format(d);},getWidth:function(f,m,M){var w=f.maxLength||f.precision,W;if(!m){m=30;}if(!M){M=3;}if(f.type==="Edm.DateTime"&&f.displayFormat==="Date"){w="9em";}else if(w){if(w==="Max"){w=m+"";}W=parseInt(w,10);if(!isNaN(W)){W+=0.75;if(W>m){W=m;}else if(W<M){W=M;}w=W+"em";}else{w=null;}}if(!w){if(f.type==="Edm.Boolean"){w=M+"em";}else{w=m+"em";}}return w;}};return a;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.valuehelpdialog.ItemsCollection')){
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.ui.comp.valuehelpdialog.ItemsCollection');jQuery.sap.require('jquery.sap.global');sap.ui.define("sap/ui/comp/valuehelpdialog/ItemsCollection",['jquery.sap.global','sap/ui/comp/util/FormatUtil'],function(q,F){"use strict";var I=function(){this.items={};};I.prototype.add=function(k,o){this.items[k]=o;};I.prototype.remove=function(k){delete this.items[k];};I.prototype.removeAll=function(){this.items={};};I.prototype.getItem=function(k){return this.items[k];};I.prototype.getItems=function(){var k=[];for(var i in this.items){k.push(i);}return k;};I.prototype.getSelectedItemsTokenArray=function(k,d,D){var t=[];for(var i in this.items){var o=this.items[i];var T,s;if(typeof o==="string"){s=i;T=o;}else{s=o[k];T=o[d];if(T===undefined){T=this.items[i];}else{if(!D){D="descriptionAndId";}T=F.getFormattedExpressionFromDisplayBehaviour(D,s,T);}}var a=new sap.m.Token({key:s,text:T,tooltip:T});if(typeof o!=="string"){a.data("row",o);a.data("longKey",i);}t.push(a);}return t;};I.prototype.getModelData=function(){var m=[];for(var i in this.items){var a=this.items[i];if(typeof a==="string"){a={missing:i};}m.push(a);}return m;};return I;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.config.condition.DateRangeType')){
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.ui.comp.config.condition.DateRangeType');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.m.Input');jQuery.sap.require('sap.m.DateRangeSelection');jQuery.sap.require('sap.m.DatePicker');jQuery.sap.require('sap.m.Text');jQuery.sap.require('sap.m.Select');jQuery.sap.require('sap.ui.core.date.UniversalDate');jQuery.sap.require('sap.ui.core.Locale');jQuery.sap.require('sap.ui.core.LocaleData');jQuery.sap.require('sap.ui.model.odata.Filter');sap.ui.define("sap/ui/comp/config/condition/DateRangeType",['jquery.sap.global','sap/ui/comp/config/condition/Type','sap/m/Input','sap/m/DateRangeSelection','sap/m/DatePicker','sap/m/Text','sap/m/Select','sap/ui/core/date/UniversalDate','sap/ui/core/Locale','sap/ui/core/LocaleData','sap/ui/model/odata/Filter'],function(q,T,I,D,a,b,S,U,L,c,F){"use strict";sap.ui.model.type.Integer.extend("sap.ui.model.type.NullableInteger",{parseValue:function(v,i){switch(this.getPrimitiveType(i)){case"string":if(v===""){return null;}}return sap.ui.model.type.Integer.prototype.parseValue.apply(this,arguments);}});var d=T.extend("sap.ui.comp.config.condition.DateRangeType",{constructor:function(f,o,e){T.apply(this,[f,o,e]);this.oDateFormat=o&&o._oDateFormatSettings?o._oDateFormatSettings:{UTC:true};this._bIgnoreTime=false;this.bMandatory=this.oFieldMetadata?this.oFieldMetadata.isMandatory:false;}});d.prototype.applySettings=function(s){T.prototype.applySettings.apply(this,arguments);if(s&&s.ignoreTime){this._bIgnoreTime=s.ignoreTime;}};d.setStartTime=function(o){if(o instanceof Date){o=new U(o);}if(!o){o=new U();}o.setHours(0);o.setMinutes(0);o.setSeconds(0);o.setMilliseconds(0);return o;};d.setEndTime=function(o){o=d.toUniversalDate(o);o.setHours(23);o.setMinutes(59);o.setSeconds(59);o.setMilliseconds(999);return o;};d.toUniversalDate=function(o){if(o instanceof Date){o=new U(o);}if(!o){o=new U();}return o;};d.getWeekStartDate=function(u){var l=new L(sap.ui.getCore().getConfiguration().getFormatSettings().getFormatLocale().toString()),o=c.getInstance(l),f=o.getFirstDayOfWeek();if(!u){u=new U();}u.setDate(u.getDate()-u.getDay()+f);return d.setStartTime(u);};d.getMonthStartDate=function(u){if(!u){u=new U();}u.setDate(1);return d.setStartTime(u);};d.getQuarterStartDate=function(u){if(!u){u=new U();}u.setMonth(3*Math.floor(u.getMonth()/3));u.setDate(1);return d.setStartTime(u);};d.getYearStartDate=function(u){if(!u){u=new U();}u.setMonth(0);u.setDate(1);return d.setStartTime(u);};d.getDateRange=function(v,t,u,C){if(u===true){C=true;u=null;}if(!u){u=new U();}var s=new U(),e;if(u){s.oDate.setTime(u.getTime());s=d.setStartTime(s);}if(v!==0){if(t==="DAY"){e=new U(s);e.setDate(s.getDate()+v);}else if(t==="WEEK"){if(C){s=d.getWeekStartDate(s);}e=new U(s);e.setDate(s.getDate()+(v*7));}else if(t==="MONTH"){if(C){s=d.getMonthStartDate(s);}e=new U(s);e.setMonth(s.getMonth()+v);}else if(t==="QUARTER"){if(C){s=d.getQuarterStartDate(s);}e=new U(s);e.setMonth(s.getMonth()+(v*3));}else if(t==="YEAR"){if(C){s=d.getYearStartDate(s);}e=new U(s);e.setFullYear(s.getFullYear()+v);}}if(!e){return[];}if(e.getTime()<s.getTime()){e=[s,s=e][0];}e.setDate(e.getDate()-1);return[d.setStartTime(s),d.setEndTime(e)];};d.getTextField=function(i,e){if(e){return new b({text:"{path: '$smartEntityFilter>value1', type:'sap.ui.model.type.Date', formatOptions:"+JSON.stringify({style:i.oDateFormat.style,pattern:i.oDateFormat.pattern})+"} - {path: '$smartEntityFilter>value2', type:'sap.ui.model.type.Date', formatOptions:"+JSON.stringify({style:i.oDateFormat.style,pattern:i.oDateFormat.pattern})+"}"});}return new b({text:{path:'$smartEntityFilter>value1',type:'sap.ui.model.type.Date',formatOptions:{style:i.oDateFormat.style,pattern:i.oDateFormat.pattern}}});};d.getIntField=function(i){return new I({width:"7rem",ariaLabelledBy:i.oOperationSelect||null,value:{path:"$smartEntityFilter>value1",type:"sap.ui.model.type.NullableInteger"},textAlign:"End",type:"Number",valueState:{path:"$smartEntityFilter>/inputstate",formatter:function(){if(this.getBinding("valueState").getValue()==="ERROR"){return sap.ui.core.ValueState.Error;}else{return sap.ui.core.ValueState.None;}}}});};d.getDescriptionText=function(t,s,r){return new b({wrapping:false,text:{path:"$smartEntityFilter>value1",type:"sap.ui.model.type.Integer",formatter:function(){if(this.getBinding("text").getValue()===1){return T.getTranslatedText(t,r);}else{return T.getTranslatedText(s||t,r);}}}});};d.ControlFactory=function(i,r,o){if(o.type==="range"){var C=d.getTextField(i,o.display!=="start");C.addStyleClass("sapUiCompFilterBarCTPaddingLeft");r.push(C);return;}if(o.type==="int"){var C=d.getIntField(i);C.addStyleClass("sapUiCompFilterBarCTPaddingLeft");r.push(C);C.setWidth(i.sWidth);if(o.descriptionTextKeys){C.setWidth("100%");var t=d.getDescriptionText(o.descriptionTextKeys[0],o.descriptionTextKeys[1]);t.addStyleClass("sapUiCompFilterBarCTPaddingLeft");r.push(t);t.setWidth("auto");C.addAriaLabelledBy(t);}}};d.getFixedRangeOperation=function(k,t,C,e){return{key:k,textKey:t,category:C,defaultValues:e||null,value1:null,value2:null,type:"range",display:"range",getControls:d.ControlFactory};};d.Operations={DATERANGE:{key:"DATERANGE",textKey:"CONDITION_DATERANGETYPE_DATERANGE",category:"DYNAMIC.DATERANGE",defaultOperation:true,defaultValues:[null,null],value1:null,value2:null,getControls:function(i,r){var C=new D({ariaLabelledBy:i.oOperationSelect||null,dateValue:{path:"$smartEntityFilter>value1"},secondDateValue:{path:"$smartEntityFilter>value2"},displayFormat:i.oDateFormat.style||"",valueState:{path:"$smartEntityFilter>/inputstate",formatter:function(){if(this.getBinding("valueState").getValue()==="ERROR"){return sap.ui.core.ValueState.Error;}else{return sap.ui.core.ValueState.None;}}},change:function(e){var v=e.getParameter("valid");if(v){this.fireValidationSuccess({element:this},false,true);}else{this.fireValidationError({element:this},false,true);}}});C.addStyleClass("sapUiCompFilterBarCTPaddingLeft");r.push(C);}},FROM:{key:"FROM",textKey:"CONDITION_DATERANGETYPE_FROM",category:"DYNAMIC.DATE",defaultValues:[null],value1:null,getControls:function(i,r){var C=new a({ariaLabelledBy:i.oOperationSelect||null,value:{path:"$smartEntityFilter>value1",type:"sap.ui.model.type.Date",formatOptions:{style:i.oDateFormat.style,pattern:i.oDateFormat.pattern}},valueState:{path:"$smartEntityFilter>/inputstate",formatter:function(){if(this.getBinding("valueState").getValue()==="ERROR"){return sap.ui.core.ValueState.Error;}else{return sap.ui.core.ValueState.None;}}}});C.addStyleClass("sapUiCompFilterBarCTPaddingLeft");r.push(C);}},TO:{key:"TO",textKey:"CONDITION_DATERANGETYPE_TO",category:"DYNAMIC.DATE",defaultValues:[null],value1:null,getControls:function(i,r,o){var C=new a({ariaLabelledBy:i.oOperationSelect||null,value:{path:"$smartEntityFilter>value1",type:"sap.ui.model.type.Date",formatOptions:{style:i.oDateFormat.style,pattern:i.oDateFormat.pattern}},valueState:{path:"$smartEntityFilter>/inputstate",formatter:function(){if(this.getBinding("valueState").getValue()==="ERROR"){return sap.ui.core.ValueState.Error;}else{return sap.ui.core.ValueState.None;}}}});C.addStyleClass("sapUiCompFilterBarCTPaddingLeft");r.push(C);}},LASTDAYS:{key:"LASTDAYS",textKey:"CONDITION_DATERANGETYPE_LASTDAYS",category:"DYNAMIC.DATE.INT",defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_DAY","CONDITION_DATERANGETYPE_MULTIPLE_DAYS"],getControls:d.ControlFactory},LASTWEEKS:{key:"LASTWEEKS",textKey:"CONDITION_DATERANGETYPE_LASTWEEKS",category:"DYNAMIC.WEEK.INT",defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_WEEK","CONDITION_DATERANGETYPE_MULTIPLE_WEEKS"],getControls:d.ControlFactory},LASTMONTHS:{key:"LASTMONTHS",textKey:"CONDITION_DATERANGETYPE_LASTMONTHS",category:"DYNAMIC.MONTH.INT",defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_MONTH","CONDITION_DATERANGETYPE_MULTIPLE_MONTHS"],getControls:d.ControlFactory},LASTQUARTERS:{key:"LASTQUARTERS",textKey:"CONDITION_DATERANGETYPE_LASTQUARTERS",category:"DYNAMIC.QUARTER.INT",defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_QUARTER","CONDITION_DATERANGETYPE_MULTIPLE_QUARTERS"],getControls:d.ControlFactory},LASTYEARS:{key:"LASTYEARS",textKey:"CONDITION_DATERANGETYPE_LASTYEARS",category:"DYNAMIC.YEAR.INT",defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_YEAR","CONDITION_DATERANGETYPE_MULTIPLE_YEARS"],getControls:d.ControlFactory},SPECIFICMONTH:{key:"SPECIFICMONTH",textKey:"CONDITION_DATERANGETYPE_SPECIFICMONTH",category:"DYNAMIC.MONTH",defaultValues:function(){var o=new U();return[o.getMonth()];},value1:null,getControls:function(i,r,o){var s=new S({ariaLabelledBy:i.oOperationSelect||null,width:"12rem",selectedKey:{path:"$smartEntityFilter>value1",type:"sap.ui.model.type.Integer"}});s.bindAggregation("items",{path:"$smartEntityFilter>/currentoperation/valueList",template:new sap.ui.core.ListItem({text:{path:"$smartEntityFilter>text"},key:{path:"$smartEntityFilter>key"}})});s.addStyleClass("sapUiCompFilterBarCTMarginLeft");r.push(s);},getValueList:function(){var o=new U(),m=[],f=sap.ui.core.format.DateFormat.getDateInstance({pattern:"MMMM"});o.setDate(15);o.setMonth(0);for(var i=0;i<12;i++){m.push({text:f.format(o),key:i});o.setMonth(o.getMonth()+1);}return m;}},TODAY:{key:"TODAY",textKey:"CONDITION_DATERANGETYPE_TODAY",category:"FIXED.DATE",defaultValues:function(){return d.getDateRange(1,"DAY",true);},type:"range",display:"start",getControls:d.ControlFactory},THISWEEK:d.getFixedRangeOperation("THISWEEK","CONDITION_DATERANGETYPE_THISWEEK","FIXED.WEEK",function(){return d.getDateRange(1,"WEEK",true);}),LASTWEEK:d.getFixedRangeOperation("LASTWEEK","CONDITION_DATERANGETYPE_LASTWEEK","FIXED.WEEK",function(){return d.getDateRange(-1,"WEEK",true);}),LAST2WEEKS:d.getFixedRangeOperation("LAST2WEEKS","CONDITION_DATERANGETYPE_LAST2WEEKS","FIXED.WEEK",function(){return d.getDateRange(-2,"WEEK",true);}),LAST3WEEKS:d.getFixedRangeOperation("LAST3WEEKS","CONDITION_DATERANGETYPE_LAST3WEEKS","FIXED.WEEK",function(){return d.getDateRange(-3,"WEEK",true);}),LAST4WEEKS:d.getFixedRangeOperation("LAST4WEEKS","CONDITION_DATERANGETYPE_LAST4WEEKS","FIXED.WEEK",function(){return d.getDateRange(-4,"WEEK",true);}),LAST5WEEKS:d.getFixedRangeOperation("LAST5WEEKS","CONDITION_DATERANGETYPE_LAST5WEEKS","FIXED.WEEK",function(){return d.getDateRange(-5,"WEEK",true);}),THISMONTH:d.getFixedRangeOperation("THISMONTH","CONDITION_DATERANGETYPE_THISMONTH","FIXED.MONTH",function(){return d.getDateRange(1,"MONTH",true);}),LASTMONTH:d.getFixedRangeOperation("LASTMONTH","CONDITION_DATERANGETYPE_LASTMONTH","FIXED.MONTH",function(){return d.getDateRange(-1,"MONTH",true);}),THISQUARTER:d.getFixedRangeOperation("THISQUARTER","CONDITION_DATERANGETYPE_THISQUARTER","FIXED.QUARTER",function(){return d.getDateRange(1,"QUARTER",true);}),LASTQUARTER:d.getFixedRangeOperation("LASTQUARTER","CONDITION_DATERANGETYPE_LASTQUARTER","FIXED.QUARTER",function(){return d.getDateRange(-1,"QUARTER",true);}),YEARTODATE:d.getFixedRangeOperation("YEARTODATE","CONDITION_DATERANGETYPE_YEARTODATE","FIXED.YEAR",function(){return[d.getYearStartDate(new U()),d.setEndTime()];}),THISYEAR:d.getFixedRangeOperation("THISYEAR","CONDITION_DATERANGETYPE_THISYEAR","FIXED.YEAR",function(){return d.getDateRange(1,"YEAR",true);}),LASTYEAR:d.getFixedRangeOperation("LASTYEAR","CONDITION_DATERANGETYPE_LASTYEAR","FIXED.YEAR",function(){return d.getDateRange(-1,"YEAR",true);}),QUARTER1:d.getFixedRangeOperation("QUARTER1","CONDITION_DATERANGETYPE_QUARTER1","FIXED.QUARTER",function(){var s=d.getYearStartDate();return d.getDateRange(1,"QUARTER",s);}),QUARTER2:d.getFixedRangeOperation("QUARTER2","CONDITION_DATERANGETYPE_QUARTER2","FIXED.QUARTER",function(){var s=d.getDateRange(1,"QUARTER",d.getYearStartDate())[1];s.setMilliseconds(1000);return d.getDateRange(1,"QUARTER",s);}),QUARTER3:d.getFixedRangeOperation("QUARTER3","CONDITION_DATERANGETYPE_QUARTER3","FIXED.QUARTER",function(){var s=d.getDateRange(2,"QUARTER",d.getYearStartDate())[1];s.setMilliseconds(1000);return d.getDateRange(1,"QUARTER",s);}),QUARTER4:d.getFixedRangeOperation("QUARTER4","CONDITION_DATERANGETYPE_QUARTER4","FIXED.QUARTER",function(){var s=d.getDateRange(3,"QUARTER",d.getYearStartDate())[1];s.setMilliseconds(1000);return d.getDateRange(1,"QUARTER",s);})};d.prototype.getControls=function(o){var C=[];if(!o){return;}o.getControls(this,C,o);return C;};d.prototype.setIgnoreTime=function(i){this._bIgnoreTime=i;};T.prototype.getIgnoreTime=function(i){return this._bIgnoreTime;};d.prototype.getDefaultValues=function(o){if(!o){return[];}var e=o.defaultValues||[];if(typeof e==="function"){e=o.defaultValues();}var C=this.getCondition(),v=e[0]||null,V=e[1]||null;if(o.key==="DATERANGE"&&C&&C.value1&&C.value2){v=C.value1.oDate;V=C.value2.oDate;}if(v instanceof Date){v=new U(v);}if(V instanceof Date){V=new U(V);}return[v,V];};d.prototype.getOperations=function(){var o=[];for(var n in d.Operations){var O=d.Operations[n];if(this._filterOperation(O)){o.push(O);}}return o;};d.prototype._updateOperation=function(o){T.prototype._updateOperation.apply(this,[o]);if(o.display){var e=this.getDefaultValues(o),f={style:this.oDateFormat.style,pattern:this.oDateFormat.pattern};if(o.display==="start"){o.textValue=sap.ui.core.format.DateFormat.getInstance(f).format(e[0].oDate);}else if(o.display==="range"){o.textValue=sap.ui.core.format.DateFormat.getInstance(f).format(e[0].oDate)+" - "+sap.ui.core.format.DateFormat.getInstance(f).format(e[1].oDate);}}};d.prototype.updateOperations=function(){var o=this.getOperations();for(var i=0;i<o.length;i++){this._updateOperation(o[i]);}return this.oModel.setProperty("operations",o,this.getContext(),true);};d.prototype.isValidCondition=function(){var C=this.getCondition(),o=this.getOperation(C.operation);if(o&&C&&C.key&&C.operation){if("value1"in o&&"value2"in o){return C.value1!==null&&C.value2!==null;}else if("value1"in o){return C.value1!==null;}else if("value2"in o){return C.value2!==null;}else if(!("value1"in o)&&!("value2"in o)){return true;}}return false;};d.prototype.providerDataUpdated=function(u,o){};d.prototype.initialize=function(j){T.prototype.initialize.apply(this,[j]);var o=q.extend({},j,true);var C=(new U()).getCalendarType();if(!j.conditionTypeInfo){if(j.ranges&&j.ranges.length==1){j.conditionTypeInfo={name:this.getName(),data:{key:this.sFieldName,operation:"DATERANGE",value1:j.ranges[0].value1,value2:j.ranges[0].value2,calendarType:C}};}else{var e=this.getDefaultOperation(),k=e?e.key:"";j.conditionTypeInfo={name:this.getName(),data:{key:this.sFieldName,operation:k,calendarType:C}};}}if(j.conditionTypeInfo){j=j.conditionTypeInfo;}if(j.name&&j.data){if(j.name!==this.getName()){q.sap.log.debug("ConditionType "+this.getName()+" tries to deserialize data from "+j.name);}j=j.data;}if(!j.operation){return;}var O=this.getOperation(j.operation);if(!O){if(this.getAsync()){this.setPending(true);var t=this,h=function(g){if(g===false){t.initialize(o);}};this.oFilterProvider.attachPendingChange(h);return;}}if(C!==j.calendarType&&(j.calendarType==="Islamic"||C==="Islamic")&&j.operation==="SPECIFICMONTH"){j.operation="DATERANGE";var v=parseInt(j.value1,10),f=U.getInstance(new Date(),j.calendarType);f.setMonth(v);f=d.getMonthStartDate(f);V=d.getDateRange(1,"MONTH",f,true);j.value1=V[0].oDate.toISOString();j.value2=V[1].oDate.toISOString();}this.oModel.setProperty("value1",null,this.getConditionContext());this.oModel.setProperty("value2",null,this.getConditionContext());this.oModel.setProperty("operation",j.operation,this.getConditionContext());this.oModel.setProperty("key",j.key,this.getConditionContext());if(j.operation==="DATERANGE"){if(typeof j.value1==="string"){j.value1=j.value1===""?null:(new U(j.value1)).oDate;}if(typeof j.value2==="string"){j.value2=j.value2===""?null:(new U(j.value2)).oDate;}this.oModel.setProperty("value1",j.value1,this.getConditionContext());this.oModel.setProperty("value2",j.value2,this.getConditionContext());}else if(j.operation==="FROM"){if(typeof j.value1==="string"){j.value1=j.value1===""?null:(new U(j.value1)).oDate;this.oModel.setProperty("value1",j.value1,this.getConditionContext());}}else if(j.operation==="TO"){if(typeof j.value1==="string"){j.value1=j.value1===""?null:(new U(j.value1)).oDate;this.oModel.setProperty("value1",j.value1,this.getConditionContext());}}else if(["LASTDAYS","LASTWEEKS","LASTMONTHS","LASTQUARTERS","LASTYEARS"].indexOf(j.operation)>-1){this.oModel.setProperty("value1",j.value1,this.getConditionContext());}else if(j.operation==="SPECIFICMONTH"){this.oModel.setProperty("value1",j.value1+"",this.getConditionContext());}else{var V=this.getDefaultValues(this.getOperation(j.operation));this.setDefaultValues(V[0],V[1]);}};d.prototype.serialize=function(){var j={},C=this.getCondition();if(!C.operation){return;}var o=this.getOperation(C.operation);if(!o||!("value1"in o)){C.value1=null;}if(!o||!("value2"in o)){C.value2=null;}C.calendarType=(new U()).getCalendarType();j.conditionTypeInfo={name:this.getName(),data:C};if(this.iChangeTimer){q.sap.clearDelayedCall(this.iChangeTimer);}this.iChangeTimer=q.sap.delayedCall(1,this,this._updateProvider,[j]);return j;};d.prototype._updateProvider=function(j){this.validate(false);j.ranges=this.getFilterRanges();j.items=[];if(this.oFilterProvider){this.oFilterProvider.oModel.setProperty("/"+this.sFieldName,j);this.oFilterProvider.setFilterData({},false,this.sFieldName);if(this.oFilterProvider._oSmartFilter){this.oFilterProvider._oSmartFilter.fireFilterChange();}}};d.prototype.getFilterRanges=function(){var C=this.getCondition(),v=[];if(C.operation==="LASTDAYS"){v=d.getDateRange(-C.value1,"DAY",true);C.value1=v[0];C.value2=v[1];}else if(C.operation==="LASTWEEKS"){v=d.getDateRange(-C.value1,"WEEK",true);C.value1=v[0];C.value2=v[1];}else if(C.operation==="LASTMONTHS"){v=d.getDateRange(-C.value1,"MONTH",true);C.value1=v[0];C.value2=v[1];}else if(C.operation==="LASTQUARTERS"){v=d.getDateRange(-C.value1,"QUARTER",true);C.value1=v[0];C.value2=v[1];}else if(C.operation==="LASTYEARS"){v=d.getDateRange(-C.value1,"YEAR",true);C.value1=v[0];C.value2=v[1];}else if(C.operation==="SPECIFICMONTH"){var V=parseInt(C.value1,10),o=new U();o.setMonth(V);o=d.getMonthStartDate(o);v=d.getDateRange(1,"MONTH",o,true);C.value1=v[0];C.value2=v[1];}if(C.value1 instanceof U){C.value1=C.value1.oDate;}if(C.value2 instanceof U){C.value2=C.value2.oDate;}if(C.operation==="FROM"){if(!(this.isValidCondition()&&C.value1)){return[];}C.operation="GE";delete C.value2;}else if(C.operation==="TO"){if(!(this.isValidCondition()&&C.value1)){return[];}C.operation="LE";delete C.value2;if(this._bIgnoreTime){C.value1=d.setStartTime(C.value1).oDate;}else{C.value1=d.setEndTime(C.value1).oDate;}}else{if(!(this.isValidCondition()&&C.value1&&C.value2)){return[];}C.operation="BT";if(this._bIgnoreTime){C.value2=d.setStartTime(C.value2).oDate;}else{C.value2=d.setEndTime(C.value2).oDate;}}C.exclude=false;C.keyField=C.key;delete C.key;return[C];};d.prototype.getTokenText=function(){return"";};d.prototype.getName=function(){return this.getMetadata().getName();};d.prototype.getType=function(){return"Edm.Date";};return d;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.odata.FieldSelectorModelConverter')){
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.ui.comp.odata.FieldSelectorModelConverter');jQuery.sap.require('jquery.sap.global');sap.ui.define("sap/ui/comp/odata/FieldSelectorModelConverter",['jquery.sap.global','./MetadataAnalyser'],function(q,M){"use strict";var F=function(d){this._oMetadataAnalyzer=new M(d);this._aEntityTypes=[];this.invisibleFields={};};F.prototype.getMetaDataAnalyzer=function(){return this._oMetadataAnalyzer;};F.prototype.getConvertedModel=function(E,i){var c={};this._aEntityTypes=this._getEntityTypes(E);for(var e=0;e<this._aEntityTypes.length;e++){var f=this._oMetadataAnalyzer.getFieldsByEntityTypeName(this._aEntityTypes[e].key);if(f){c[this._aEntityTypes[e].key]=this._updateAndFilterFields(f,i,false,this._aEntityTypes[e].key);}}return c;};F.prototype.getEntityTypes=function(){return this._aEntityTypes;};F.prototype.getAllEntityTypeNames=function(){if(this._oMetadataAnalyzer){return this._oMetadataAnalyzer.getAllEntityTypeNames();}return null;};F.prototype._updateAndFilterFields=function(a,i,I,k){var v=[];for(var f=0;f<a.length;f++){var c=a[f];if(c.visible===false){this.invisibleFields[k]=this.invisibleFields[k]||[];if(this.invisibleFields[k].indexOf(c)===-1){c.isComplexType=I;this.invisibleFields[k].push(c);}continue;}var b=this._isFieldOnIgnoreList(c,i,I);var d=this._isFieldBlacklisted(c);if(!b&&!d){if(this._isComplexType(c)===true){var V=this._resolveComplexTypeToFlatFieldList(c,i);if(V){v=v.concat(V);}}else{v.push(c);}}}return v;};F.prototype._isComplexType=function(f){if(f&&f.type){if(f.type.toLowerCase().indexOf("edm")!==0){return true;}}return false;};F.prototype._resolveComplexTypeToFlatFieldList=function(c,I){var r=[];var s=this._oMetadataAnalyzer.getSchemaDefinition();if(c&&c.type&&s){var t=this._getComplexTypeName(c);if(t){var C=s.complexType;var i=0;for(i=0;i<C.length;i++){var o=C[i];if(o.name===t){r=this._getFieldsFromComplexType(o,I);break;}}}}return r;};F.prototype._getFieldsFromComplexType=function(c,i){var f=this._oMetadataAnalyzer.getFieldsByComplexTypeName(c.name);if(f){return this._updateAndFilterFields(f,i,true,c.name);}return[];};F.prototype._getComplexTypeName=function(c){var t=c.type.split(".");if(t.length===2){return t[1];}return null;};F.prototype._isFieldOnIgnoreList=function(c,i,I){if(i){var n=this._aEntityTypes.length;var Q=c.entityName+"."+c.name;if(n===1&&!I){if(i.indexOf(c.name)!==-1||i.indexOf(Q)!==-1){return true;}}else if(i.indexOf(Q)!==-1){return true;}}return false;};F.prototype._isFieldBlacklisted=function(c){if(c){if(c.name.toLowerCase().indexOf("uxfc")===0){return true;}else if(c.type.toLowerCase()==="edm.time"){return true;}}return false;};F.prototype._getEntityTypes=function(E,a){var b=[];var l;var c;if(!this._oMetadataAnalyzer||!this._oMetadataAnalyzer._oSchemaDefinition){return[];}var A=this._oMetadataAnalyzer._oSchemaDefinition.entityType;if(!E){c=[];for(var t=0;t<A.length;t++){c.push(A[t].name);}}if(!c){c=this._convertEntityTypesToArray(E);}for(var e=0;e<c.length;e++){l=this._oMetadataAnalyzer.getEntityLabelByEntityTypeName(c[e]);b.push({key:c[e],label:l||c[e]});}return b;};F.prototype._convertEntityTypesToArray=function(e){if(typeof(e)==="string"){var r=e.replace(/ /g,'');return r.split(',');}if(q.isArray(e)){return e;}return undefined;};F.prototype.destroy=function(){if(this._oMetadataAnalyzer&&this._oMetadataAnalyzer.destroy){this._oMetadataAnalyzer.destroy();}this._oMetadataAnalyzer=null;this._aEntityTypes=null;};return F;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.smartfield.ODataTypes')){jQuery.sap.declare('sap.ui.comp.smartfield.ODataTypes');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.format.NumberFormat');jQuery.sap.require('sap.ui.model.odata.type.Boolean');jQuery.sap.require('sap.ui.model.type.Currency');sap.ui.define("sap/ui/comp/smartfield/ODataTypes",["jquery.sap.global","sap/ui/core/format/NumberFormat","sap/ui/model/odata/type/Boolean","sap/ui/comp/smartfield/type/DateTime","sap/ui/comp/smartfield/type/DateTimeOffset","sap/ui/comp/smartfield/type/Decimal","sap/ui/comp/smartfield/type/Int16","sap/ui/comp/smartfield/type/Int32","sap/ui/comp/smartfield/type/Int64","sap/ui/comp/smartfield/type/SByte","sap/ui/comp/smartfield/type/String","sap/ui/comp/smartfield/type/AbapBool","sap/ui/model/type/Currency","sap/ui/comp/smartfield/type/Time"],function(q,N,B,D,a,b,I,c,d,S,e,A,C,T){"use strict";var O=function(p){this._oParent=p;};O.prototype.getType=function(p,f,m){var o,i;i=this._oParent.getBindingInfo("value");if(i&&i.type){return i.type;}if(p&&p.property&&p.property.type){switch(p.property.type){case"Edm.Boolean":return new B();case"Edm.Decimal":case"Edm.Double":case"Edm.Float":case"Edm.Single":o=this._getDecimalConstraints(p);return new b(f,o);case"Edm.Int16":return new I();case"Edm.Int32":return new c();case"Edm.Int64":return new d();case"Edm.Byte":case"Edm.SByte":return new S();case"Edm.DateTimeOffset":return new a(f,o);case"Edm.DateTime":o=this._getDateTimeConstraints(p,m);return new D(f,o);case"Edm.String":o=this._getStringConstraints(p);return new e(f,o);case"Edm.Time":return new T(f,m);default:return null;}}return null;};O.prototype._getDateTimeConstraints=function(p,m){var o={},n;if(p.property["sap:display-format"]==="Date"){o={displayFormat:"Date"};}for(n in m){o[n]=m[n];}return o;};O.prototype.getMaxLength=function(p,o){var P,v=[],l,V,f,r=0;if(o&&o.constraints){if(o.constraints.maxLength&&o.constraints.maxLength>-1){v.push(o.constraints.maxLength);}}if(o&&o.type&&o.type.oConstraints){if(o.type.oConstraints.maxLength&&o.type.oConstraints.maxLength>-1){v.push(o.type.oConstraints.maxLength);}}if(p&&p.property&&p.property.maxLength){P=parseInt(p.property.maxLength,10);if(P>-1){v.push(P);}}f=this._oParent.getMaxLength();if(f>0){v.push(f);}l=v.length;while(l--){V=v[l];if(V>0){if(r>0){if(V<r){r=V;}}else{r=V;}}}return r;};O.prototype._getDecimalConstraints=function(p){var m=null;if(p.property.precision){m={};m.precision=parseInt(p.property.precision,10);}if(p.property.scale){if(!m){m={};}m.scale=parseInt(p.property.scale,10);}return m;};O.prototype._getStringConstraints=function(p){var m,E,o,f;o=this._oParent.getBindingInfo("value");m=this.getMaxLength(p,o);if(o&&o.type&&o.type.oConstraints){if(o.type.oConstraints.equals){E=o.type.oConstraints.equals;}}if(m>0||E){f={};if(m>0){f.maxLength=m;}if(E){f.equals=E;}}return f;};O.prototype.getDisplayFormatter=function(p,f){if(f){return this.getCurrencyDisplayFormatter(true);}else{return this.getUOMDisplayFormatter(p);}};O.prototype.getCurrencyDisplayFormatter=function(f){var F=N.getCurrencyInstance({showMeasure:false});return function(o,s){var v,i,p;if(!o||!s||s==="*"){return"";}if(!f){v=o+="\u2008";return v;}i=F.oLocaleData.getCurrencyDigits(s);v=F.format(o,s);if(i===0){v+="\u2008";}p=3-i;if(p){v=q.sap.padRight(v,"\u2007",v.length+p);}return v;};};O.prototype.getUOMDisplayFormatter=function(p){var f={};if(p.scale){f.maxFractionDigits=parseInt(p.scale,10);f.minFractionDigits=parseInt(p.scale,10);if(p.precision){f.maxIntegerDigits=parseInt(p.precision,10)-parseInt(p.scale,10);}}var F=N.getFloatInstance(f);return function(m,u){var v;if(!m||!u||u==="*"){return"";}if(isNaN(parseFloat(m))){return m.toString()+"\u2008";}v=F.format(m,u);v+="\u2008";return v;};};O.prototype.getCurrencyType=function(p){var o,f={showMeasure:false,parseAsString:true,emptyString:0};if(p){o=this._getDecimalConstraints(p);if(o){if(o.precision){f.maxIntegerDigits=o.precision;if(o.scale){f.maxIntegerDigits-=o.scale;}}if(o.precision&&o.scale){o.maximum=Math.pow(10,f.maxIntegerDigits)-(1/Math.pow(10,o.scale));o.minimum=-1*o.maximum;}}return new C(f,o);}return null;};O.prototype.getAbapBoolean=function(){return new A();};O.prototype.destroy=function(){this._oParent=null;};return O;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.smartform.flexibility.Registration')){jQuery.sap.declare('sap.ui.comp.smartform.flexibility.Registration');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.fl.registry.ChangeRegistry');jQuery.sap.require('sap.ui.fl.registry.SimpleChanges');sap.ui.define("sap/ui/comp/smartform/flexibility/Registration",['jquery.sap.global','sap/ui/fl/registry/ChangeRegistry','sap/ui/fl/registry/SimpleChanges','sap/ui/comp/smartform/flexibility/changes/RemoveField','sap/ui/comp/smartform/flexibility/changes/RemoveGroup','sap/ui/comp/smartform/flexibility/changes/RenameField','sap/ui/comp/smartform/flexibility/changes/RenameGroup','sap/ui/comp/smartform/flexibility/changes/AddField','sap/ui/comp/smartform/flexibility/changes/AddFields','sap/ui/comp/smartform/flexibility/changes/AddGroup','sap/ui/comp/smartform/flexibility/changes/MoveGroups','sap/ui/comp/smartform/flexibility/changes/MoveFields','sap/ui/comp/smartform/flexibility/changes/OrderGroups','sap/ui/comp/smartform/flexibility/changes/OrderFields'],function(q,C,S,R,a,b,c,A,d,e,M,f,O,g){"use strict";return{registerLibrary:function(){var h={orderFields:{changeType:"orderFields",changeHandler:g},orderGroups:{changeType:"orderGroups",changeHandler:O},removeField:{changeType:"removeField",changeHandler:R},removeGroup:{changeType:"removeGroup",changeHandler:a},renameField:{changeType:"renameField",changeHandler:b},renameGroup:{changeType:"renameGroup",changeHandler:c},addField:{changeType:"addField",changeHandler:A},addFields:{changeType:"addFields",changeHandler:d},addGroup:{changeType:"addGroup",changeHandler:e},moveGroups:{changeType:"moveGroups",changeHandler:M},moveFields:{changeType:"moveFields",changeHandler:f}};var o=C.getInstance();o.registerControlsForChanges({"sap.ui.comp.smartform.SmartForm":[h.removeGroup,h.addGroup,h.moveGroups,h.renameField,S.propertyChange],"sap.ui.comp.smartform.Group":[S.hideControl,S.unhideControl,h.renameGroup,h.addField,h.addFields,h.moveFields],"sap.ui.comp.smartform.GroupElement":[S.unhideControl,S.hideControl,h.renameField],"sap.ui.comp.smarttable.SmartTable":[S.propertyChange],"sap.ui.comp.smartfilterbar.SmartFilterBar":[S.propertyChange]});}};},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.library')){jQuery.sap.declare('sap.ui.comp.library');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.Core');jQuery.sap.require('sap.ui.core.library');jQuery.sap.require('sap.ui.fl.library');sap.ui.define("sap/ui/comp/library",['jquery.sap.global','sap/ui/core/Core','sap/ui/core/library','sap/ui/fl/library','sap/ui/comp/smartform/flexibility/Registration'],function(q,C,l,a,f){"use strict";sap.ui.getCore().initLibrary({name:"sap.ui.comp",version:"1.36.12",dependencies:["sap.ui.core","sap.ui.fl"],types:["sap.ui.comp.smartfield.ControlProposalType","sap.ui.comp.smartfield.ControlContextType","sap.ui.comp.smartfield.ControlType","sap.ui.comp.smartfield.DisplayBehaviour","sap.ui.comp.smartfield.JSONType","sap.ui.comp.smarttable.TableType","sap.ui.comp.personalization.AggregationRole","sap.ui.comp.personalization.ResetType","sap.ui.comp.personalization.ChangeType"],interfaces:[],controls:["sap.ui.comp.filterbar.FilterBar","sap.ui.comp.navpopover.NavigationPopover","sap.ui.comp.navpopover.SmartLink","sap.ui.comp.odata.FieldSelector","sap.ui.comp.smartchart.SmartChart","sap.ui.comp.smartfield.SmartField","sap.ui.comp.smartfield.SmartLabel","sap.ui.comp.smartfilterbar.SmartFilterBar","sap.ui.comp.smartform.Group","sap.ui.comp.smartform.GroupElement","sap.ui.comp.smartform.SmartForm","sap.ui.comp.smartform.flexibility.DialogContent","sap.ui.comp.smartform.flexibility.FieldList","sap.ui.comp.smartform.flexibility.FieldListNode","sap.ui.comp.smartform.flexibility.Input","sap.ui.comp.smartmicrochart.SmartAreaMicroChart","sap.ui.comp.smartmicrochart.SmartBulletMicroChart","sap.ui.comp.smarttable.SmartTable","sap.ui.comp.smartvariants.SmartVariantManagement","sap.ui.comp.smartvariants.SmartVariantManagementUi2","sap.ui.comp.transport.TransportDialog","sap.ui.comp.valuehelpdialog.ValueHelpDialog","sap.ui.comp.variants.EditableVariantItem","sap.ui.comp.variants.VariantManagement"],elements:["sap.ui.comp.filterbar.FilterGroupItem","sap.ui.comp.filterbar.FilterItem","sap.ui.comp.navpopover.LinkData","sap.ui.comp.navpopover.SemanticObjectController","sap.ui.comp.smartfield.Configuration","sap.ui.comp.smartfield.ControlProposal","sap.ui.comp.smartfield.ObjectStatus","sap.ui.comp.smartfilterbar.ControlConfiguration","sap.ui.comp.smartfilterbar.GroupConfiguration","sap.ui.comp.smartfilterbar.SelectOption","sap.ui.comp.smartform.Layout","sap.ui.comp.smartvariants.PersonalizableInfo","sap.ui.comp.variants.VariantItem"]});sap.ui.comp.smartfield.ControlType={auto:"auto",dropDownList:"dropDownList",input:"input",datePicker:"datePicker",checkBox:"checkBox",selection:"selection"};sap.ui.comp.smartfield.DisplayBehaviour={auto:"auto",descriptionOnly:"descriptionOnly",descriptionAndId:"descriptionAndId",idAndDescription:"idAndDescription",idOnly:"idOnly",TrueFalse:"TrueFalse",OnOff:"OnOff",YesNo:"YesNo"};sap.ui.comp.smartfield.JSONType={String:"String",Date:"Date",Float:"Float",Integer:"Integer",Boolean:"Boolean",DateTime:"DateTime"};sap.ui.comp.smartfield.ControlContextType={None:"",ResponsiveTable:"responsiveTable",Form:"form",Table:"table",SmartFormGrid:"smartFormGrid"};sap.ui.comp.smartfield.ControlProposalType={None:"",ObjectNumber:"ObjectNumber",ObjectIdentifier:"ObjectIdentifier"};sap.ui.comp.smarttable.TableType={Table:"Table",ResponsiveTable:"ResponsiveTable",AnalyticalTable:"AnalyticalTable",TreeTable:"TreeTable"};sap.ui.comp.personalization.ResetType={ResetFull:"ResetFull",ResetPartial:"ResetPartial"};sap.ui.comp.personalization.AggregationRole={Dimension:"Dimension",Measure:"Measure",NotDimeasure:"NotDimeasure"};sap.ui.comp.personalization.ChangeType={Unchanged:"Unchanged",ModelChanged:"ModelChanged",TableChanged:"TableChanged"};f.registerLibrary();return sap.ui.comp;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.navpopover.LinkData')){
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.ui.comp.navpopover.LinkData');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.Element');sap.ui.define("sap/ui/comp/navpopover/LinkData",['jquery.sap.global','sap/ui/comp/library','sap/ui/core/Element'],function(q,l,E){"use strict";var L=E.extend("sap.ui.comp.navpopover.LinkData",{metadata:{library:"sap.ui.comp",properties:{text:{type:"string",defaultValue:null},href:{type:"string",defaultValue:null},target:{type:"string",defaultValue:null}}}});return L;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.navpopover.NavigationPopoverHandler')){jQuery.sap.declare('sap.ui.comp.navpopover.NavigationPopoverHandler');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.ManagedObject');sap.ui.define("sap/ui/comp/navpopover/NavigationPopoverHandler",['jquery.sap.global',"sap/ui/base/ManagedObject",'sap/ui/comp/navpopover/LinkData'],function(q,M,L){"use strict";var N=M.extend("sap.ui.comp.navpopover.NavigationPopoverHandler",{metadata:{library:"sap.ui.comp",properties:{semanticObject:{type:"string",group:"Misc",defaultValue:null},semanticObjectController:{type:"any",group:"Misc",defaultValue:null},fieldName:{type:"string",group:"Misc",defaultValue:null},semanticObjectLabel:{type:"string",group:"Misc",defaultValue:null},mapFieldToSemanticObject:{type:"boolean",group:"Misc",defaultValue:true}},associations:{control:{type:"sap.ui.core.Control",multiple:false}},events:{beforePopoverOpens:{parameters:{semanticObject:{type:"string"},semanticAttributes:{type:"object"},originalId:{type:"string"},setSemanticAttributes:{type:"function"},setAppStateKey:{type:"function"},open:{type:"function"}}},navigationTargetsObtained:{parameters:{actions:{type:"sap.ui.comp.navpopover.LinkData[]"},mainNavigation:{type:"sap.ui.comp.navpopover.LinkData"},ownNavigation:{type:"sap.ui.comp.navpopover.LinkData"},semanticObject:{type:"string"},originalId:{type:"string"},show:{type:"function"}}},innerNavigate:{parameters:{text:{type:"string"},href:{type:"string"},semanticObject:{type:"string"},semanticAttributes:{type:"object"},originalId:{type:"string"}}}}}});N.prototype.init=function(){this._oSemanticAttributes=null;};N.prototype.setSemanticObjectLabel=function(l){this.setProperty("semanticObjectLabel",l);if(this._oPopover){this._oPopover.setTitle(l);}};N.prototype._handlePressed=function(e){if(this._processingPressed){window.console.warn("SmartLink is still processing last press event. This press event is omitted.");return;}this._processingPressed=true;var a;this._calculateSemanticAttributes();var t=this;var o=function(){t._createPopover();t._oPopover.setTitle(t.getSemanticObjectLabel());t._oPopover.setSemanticObjectName(t.getSemanticObject());if(t._oSemanticAttributes){t._oPopover.setSemanticAttributes(t._oSemanticAttributes);}if(a){t._oPopover.setAppStateKey(a);}t._oPopover.retrieveNavTargets();};if(this.hasListeners("beforePopoverOpens")){this.fireBeforePopoverOpens({semanticObject:this.getSemanticObject(),semanticAttributes:t._oSemanticAttributes,setSemanticAttributes:function(m){t._oSemanticAttributes=m;},setAppStateKey:function(k){a=k;},originalId:this.getId(),open:o});}else{o();}};N.prototype._onTargetsObtainedOpenDialog=function(){var t=this;if(!this._oPopover.getMainNavigation()){this._oPopover.setMainNavigation(new L({text:this.getSemanticObjectLabel()}));}this.fireNavigationTargetsObtained({actions:this._oPopover.getAvailableActions(),mainNavigation:this._oPopover.getMainNavigation(),ownNavigation:this._oPopover.getOwnNavigation(),semanticObject:this.getSemanticObject(),semanticAttributes:this.getSemanticAttributes(),originalId:this.getId(),show:function(m,o,a,e){if(m!=null&&typeof m==="string"){t._oPopover.setMainNavigationId(m);}else{e=a;a=o;o=m;}if(o){t._oPopover.setMainNavigation(o);}if(a){t._oPopover.removeAllAvailableActions();if(a&&a.length){var i,l=a.length;for(i=0;i<l;i++){t._oPopover.addAvailableAction(a[i]);}}}if(e){t._oPopover.setExtraContent(e);}t._oPopover.show();t._processingPressed=false;}});if(!this.hasListeners("navigationTargetsObtained")){this._oPopover.show();this._processingPressed=false;}};N.prototype._onInnerNavigate=function(e){var p=e.getParameters();this.fireInnerNavigate({text:p.text,href:p.href,originalId:this.getId(),semanticObject:this.getSemanticObject(),semanticAttributes:this.getSemanticAttributes()});};N.prototype._createPopover=function(){if(this._oPopover){this._oPopover.destroy();this._oPopover=null;}if(!this._oPopover){var c=this._getComponent();q.sap.require("sap.ui.comp.navpopover.NavigationPopover");var a=sap.ui.require("sap/ui/comp/navpopover/NavigationPopover");this._oPopover=new a({title:this.getSemanticObjectLabel(),semanticObjectName:this.getSemanticObject(),targetsObtained:q.proxy(this._onTargetsObtainedOpenDialog,this),navigate:q.proxy(this._onInnerNavigate,this),component:c});this._oPopover.setSource(this._getControl());}};N.prototype._getControl=function(){var h=this.getControl();if(h){return sap.ui.getCore().byId(h);}return null;};N.prototype._getComponent=function(){var h=this._getControl();if(h){var p=h.getParent();while(p){if(p instanceof sap.ui.core.Component){return p;}p=p.getParent();}}return null;};N.prototype._calculateSemanticAttributes=function(){var r=null;var c=this.getBindingContext();if(c){r={};var s=c.getObject(c.getPath());var k,v;var t=this;var m;if(this.getMapFieldToSemanticObject()){m=function(k){return t._mapFieldToSemanticObject(k);};}else{var S=this.getSemanticObject();m=function(k){var f=t._mapFieldToSemanticObject(k);if(f===S){return k;}return f;};}for(k in s){if(k!=="__metadata"){v=s[k];if(v){k=m(k);r[k]=v;}}}}this._oSemanticAttributes=r;};N.prototype.getSemanticAttributes=function(){if(this._oSemanticAttributes===null){this._calculateSemanticAttributes();}return this._oSemanticAttributes;};N.prototype._mapFieldToSemanticObject=function(f){var s=this.getSemanticObjectController();if(s){var m=s.getFieldSemanticObjectMap();if(m){var S=m[f];if(S){return S;}}}return f;};N.prototype.setFieldName=function(f){this.setProperty("fieldName",f);var s=this.getSemanticObjectController();if(s){s.setIgnoredState(this);}};N.prototype.setSemanticObjectController=function(c){var o=this.getProperty("semanticObjectController");if(o){o.unregisterControl(this);}this.setProperty("semanticObjectController",c,true);if(c){c.registerControl(this);}};N.prototype.getSemanticObjectController=function(){var c=this.getProperty("semanticObjectController");if(!c){var p=this.getParent();while(p){if(p.getSemanticObjectController){c=p.getSemanticObjectController();if(c){this.setSemanticObjectController(c);break;}}p=p.getParent();}}return c;};N.prototype.getSemanticObjectValue=function(){var s=this.getSemanticAttributes();if(s){var S=this.getSemanticObject();return s[S];}return null;};N.prototype.exit=function(){this.setSemanticObjectController(null);if(this._oPopover){this._oPopover.destroy();this._oPopover=null;}};return N;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.navpopover.SmartLink')){jQuery.sap.declare('sap.ui.comp.navpopover.SmartLink');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.m.Link');jQuery.sap.require('sap.m.LinkRenderer');sap.ui.define("sap/ui/comp/navpopover/SmartLink",['jquery.sap.global','sap/m/Link','sap/m/LinkRenderer','sap/ui/comp/navpopover/LinkData'],function(q,L,a,b){"use strict";var S=L.extend("sap.ui.comp.navpopover.SmartLink",{metadata:{library:"sap.ui.comp",properties:{semanticObject:{type:"string",defaultValue:null},semanticObjectController:{type:"any",defaultValue:null},fieldName:{type:"string",defaultValue:null},semanticObjectLabel:{type:"string",defaultValue:null},createControlCallback:{type:"object",defaultValue:null},mapFieldToSemanticObject:{type:"boolean",defaultValue:true},ignoreLinkRendering:{type:"boolean",defaultValue:false}},aggregations:{innerControl:{type:"sap.ui.core.Control",multiple:false}},events:{beforePopoverOpens:{parameters:{semanticObject:{type:"string"},semanticAttributes:{type:"object"},setSemanticAttributes:{type:"function"},setAppStateKey:{type:"function"},originalId:{type:"string"},open:{type:"function"}}},navigationTargetsObtained:{parameters:{mainNavigation:{type:"sap.ui.comp.navpopover.LinkData"},actions:{type:"sap.ui.comp.navpopover.LinkData[]"},ownNavigation:{type:"sap.ui.comp.navpopover.LinkData"},semanticObject:{type:"string"},originalId:{type:"string"},show:{type:"function"}}},innerNavigate:{parameters:{text:{type:"string"},href:{type:"string"},semanticObject:{type:"string"},semanticAttributes:{type:"object"},originalId:{type:"string"}}}}},renderer:function(r,c){var R=true;if(c.getIgnoreLinkRendering()){var o=c._getInnerControl();if(o){r.write("<div ");r.writeControlData(c);r.writeClasses();r.write(">");r.renderControl(o);r.write("</div>");R=false;}}if(R){a.render.call(a,r,c);}}});S.prototype.init=function(){this.attachPress(this._linkPressed);this.addStyleClass("sapUiCompSmartLink");this._oSemanticAttributes=null;};S.prototype._linkPressed=function(e){if(this._processingLinkPressed){window.console.warn("SmartLink is still processing last press event. This press event is omitted.");return;}if(this.getIgnoreLinkRendering()){window.console.warn("SmartLink should ignore link rendering. Press event is omitted.");return;}this._processingLinkPressed=true;var A;this._oSemanticAttributes=this._calculateSemanticAttributes();var t=this;var o=function(){t._createPopover();if(t._oSemanticAttributes){t._oPopover.setSemanticAttributes(t._oSemanticAttributes);}if(A){t._oPopover.setAppStateKey(A);}t._oPopover.retrieveNavTargets();};if(this.hasListeners("beforePopoverOpens")){this.fireBeforePopoverOpens({semanticObject:this.getSemanticObject(),semanticAttributes:t._oSemanticAttributes,setSemanticAttributes:function(m){t._oSemanticAttributes=m;},setAppStateKey:function(k){A=k;},originalId:this.getId(),open:o});}else{o();}};S.prototype._onTargetsObtainedOpenDialog=function(){var t=this;if(!this._oPopover.getMainNavigation()){this._oPopover.setMainNavigation(new b({text:this.getText()}));}this.fireNavigationTargetsObtained({actions:this._oPopover.getAvailableActions(),mainNavigation:this._oPopover.getMainNavigation(),ownNavigation:this._oPopover.getOwnNavigation(),semanticObject:this.getSemanticObject(),semanticAttributes:this.getSemanticAttributes(),originalId:this.getId(),show:function(m,M,A,e){if(m!=null&&typeof m==="string"){t._oPopover.setMainNavigationId(m);}else{e=A;A=M;M=m;}if(M){t._oPopover.setMainNavigation(M);}if(A){t._oPopover.removeAllAvailableActions();if(A&&A.length){var i,l=A.length;for(i=0;i<l;i++){t._oPopover.addAvailableAction(A[i]);}}}if(e){t._oPopover.setExtraContent(e);}t._oPopover.show();t._processingLinkPressed=false;}});if(!this.hasListeners("navigationTargetsObtained")){this._oPopover.show();this._processingLinkPressed=false;}};S.prototype._onInnerNavigate=function(e){var p=e.getParameters();this.fireInnerNavigate({text:p.text,href:p.href,originalId:this.getId(),semanticObject:this.getSemanticObject(),semanticAttributes:this.getSemanticAttributes()});};S.prototype._createPopover=function(){if(!this._oPopover){var c=this._getComponent();q.sap.require("sap.ui.comp.navpopover.NavigationPopover");var N=sap.ui.require("sap/ui/comp/navpopover/NavigationPopover");this._oPopover=new N({title:this.getSemanticObjectLabel(),semanticObjectName:this.getSemanticObject(),targetsObtained:q.proxy(this._onTargetsObtainedOpenDialog,this),navigate:q.proxy(this._onInnerNavigate,this),component:c});this._oPopover.setSource(this);}};S.prototype._getComponent=function(){var p=this.getParent();while(p){if(p instanceof sap.ui.core.Component){return p;}p=p.getParent();}return null;};S.prototype._calculateSemanticAttributes=function(){var c=this.getBindingContext();if(!c){return null;}var B=this.getBinding("text");var C=B.getPath();var r={};var c=c.getObject(c.getPath());for(var A in c){if(A==="__metadata"){continue;}if(!c[A]){continue;}var s=this._mapFieldToSemanticObject(A);if(A===C&&this.getSemanticObject()){s=this.getSemanticObject();}if(s===this.getSemanticObject()&&!this.getMapFieldToSemanticObject()){s=A;}var o=c[A];if(r[s]){if(c[C]){o=c[C];}}r[s]=o;}return r;};S.prototype.getSemanticAttributes=function(){if(this._oSemanticAttributes===null){this._oSemanticAttributes=this._calculateSemanticAttributes();}return this._oSemanticAttributes;};S.prototype._mapFieldToSemanticObject=function(f){var s=this.getSemanticObjectController();if(!s){return f;}var m=s.getFieldSemanticObjectMap();if(!m){return f;}return m[f]||f;};S.prototype.setFieldName=function(f){this.setProperty("fieldName",f);var s=this.getSemanticObjectController();if(s){s.setIgnoredState(this);}};S.prototype.setSemanticObject=function(s){this.setProperty("semanticObject",s,true);var o=this.getSemanticObjectController();if(o){o.setIgnoredState(this);}};S.prototype.setSemanticObjectController=function(c){var o=this.getProperty("semanticObjectController");if(o){o.unregisterControl(this);}this.setProperty("semanticObjectController",c,true);if(c){c.registerControl(this);}this._oSemanticAttributes=null;};S.prototype.getSemanticObjectController=function(){var c=this.getProperty("semanticObjectController");if(!c){var p=this.getParent();while(p){if(p.getSemanticObjectController){c=p.getSemanticObjectController();if(c){this.setSemanticObjectController(c);break;}}p=p.getParent();}}return c;};S.prototype.getSemanticObjectValue=function(){var s=this.getSemanticAttributes();if(s){var c=this.getSemanticObject();return s[c];}return null;};S.prototype.setText=function(t){if(this._isRenderingInnerControl()){this.setProperty("text",t,true);}else{L.prototype.setText.call(this,t);}};S.prototype._isRenderingInnerControl=function(){return this.getIgnoreLinkRendering()&&this._getInnerControl()!=null;};S.prototype._getInnerControl=function(){var i=this.getAggregation("innerControl");if(!i){var c=this.getCreateControlCallback();if(c){i=c();this.setAggregation("innerControl",i,true);}}return i;};S.prototype.getInnerControlValue=function(){if(this._isRenderingInnerControl()){var i=this._getInnerControl();if(i){if(i.getText){return i.getText();}if(i.getValue){return i.getValue();}}}return this.getText();};S.prototype.onBeforeRendering=function(){this.getSemanticObjectController();if(this.getIgnoreLinkRendering()&&this._getInnerControl()==null){this.setEnabled(false);}else{this.setEnabled(true);}};S.prototype.exit=function(){this.setSemanticObjectController(null);};return S;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.odata.FieldSelectorController')){
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.ui.comp.odata.FieldSelectorController');jQuery.sap.require('jquery.sap.global');sap.ui.define("sap/ui/comp/odata/FieldSelectorController",["jquery.sap.global","./FieldSelectorModelConverter"],function(q,M){"use strict";var F=function(){this._oModelConverter=null;this._oFields={};this._aIgnoredFields=[];};F.prototype.init=function(o,e,i,b,I){if(!o){q.sap.log.error("oModel has to be set otherwise nothing will be displayed");}this._oModelConverter=new M(o);if(!e){e=this._oModelConverter.getAllEntityTypeNames();}if(!i){i=[];}var c=this._oModelConverter.getConvertedModel(e,i);if(b&&I){var f=this._updateFieldLabelsAndDetermineFieldsNotBoundToODataService(c,b,I);this._addFieldsNotBoundToODataService(c,f);}this._sortFields(c);};F.prototype._updateFieldLabelsAndDetermineFieldsNotBoundToODataService=function(c,b,i){var t=this;q.each(c,function(k,d){q.each(d,function(a,D){if(D.entityName&&D.name){if(k!==D.entityName){var m=t.getMetaDataAnalyzer();var p=m._getNameOfPropertyUsingComplexType(k,D.entityName);if(p){var o=b[k+"/"+p+"/"+D.name];if(o){o.isBoundToODataService=true;var s=o.label;if(s&&(s!==D.fieldLabel)){D.fieldLabel=s;}if(i){delete i[o.id];}}}else{q.sap.log.error("FieldSelector: Property of complex type "+D.name+" not found on entityType "+k);}}else{var o=b[D.entityName+'/'+D.name];if(o){o.isBoundToODataService=true;var s=o.label;if(s&&(s!==D.fieldLabel)){D.fieldLabel=s;}if(i){delete i[o.id];}}}}});});this._removeFieldsFromList(i,b,this._oModelConverter.invisibleFields);var f=[];q.each(i,function(k,o){f.push(o);});return f;};F.prototype._removeFieldsFromList=function(f,b,m){var t=this;if(!f||!m){return;}q.each(m,function(k,o){q.each(o,function(i,a){if(a.entityName&&a.name){if(k!==a.entityName){var c=t.getMetaDataAnalyzer();var p=c._getNameOfPropertyUsingComplexType(k,a.entityName);if(p){var d=b[k+"/"+p+"/"+a.name];if(d){delete f[a.id];}}else{q.sap.log.error("FieldSelector: Property of complex type "+a.name+" not found on entityType "+k);}}else{var d=b[a.entityName+'/'+a.name];if(d){delete f[a.id];}}}});});};F.prototype._addFieldsNotBoundToODataService=function(c,f){var e=function(C,E){if(!c[E.key]){c[E.key]=[];}c[E.key].push(C);};var a=function(o){o.isBoundToODataService=false;var C={id:o.id,fieldLabel:o.label};var E=this._oModelConverter.getEntityTypes();E.forEach(e.bind(null,C));};f.forEach(a.bind(this));};F.prototype._sortFields=function(c){var t=this;q.each(c,function(k,v){t._oFields[k]=v;t.sortFieldsForEntity.call(t,k);});};F.prototype.sortFieldsForEntity=function(e){this._oFields[e]=this._oFields[e].sort(function(a,b){if(a.fieldLabel>b.fieldLabel){return 1;}if(a.fieldLabel<b.fieldLabel){return-1;}return 0;});};F.prototype.getFields=function(){return this._oFields;};F.prototype.getEntityTypes=function(){return this._oModelConverter.getEntityTypes();};F.prototype.getMetaDataAnalyzer=function(){return this._oModelConverter.getMetaDataAnalyzer();};F.prototype.getMaxEntitySetSize=function(){var m=0;if(this._oFields){q.each(this._oFields,function(k,v){if(v&&v.length){if(v.length>m){m=v.length;}}});}return m;};F.prototype.destroy=function(){if(this._oModelConverter){this._oModelConverter.destroy();}this._oModelConverter=null;this._oFields=null;};return F;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.personalization.Util')){
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.ui.comp.personalization.Util');jQuery.sap.require('sap.ui.base.Object');jQuery.sap.require('sap.ui.core.MessageType');sap.ui.define("sap/ui/comp/personalization/Util",['sap/ui/base/Object','sap/ui/core/MessageType','./ChartWrapper','./ColumnWrapper','sap/ui/comp/library'],function(B,M,C,c,d){"use strict";var U={splitDimeasures:function(D,i,a,m){D.forEach(function(o){var I=this.getArrayElementByKey("columnKey",o.columnKey,i);if(I.aggregationRole===sap.ui.comp.personalization.AggregationRole.Dimension){a.push(o);}else if(I.aggregationRole===sap.ui.comp.personalization.AggregationRole.Measure){m.push(o);}},this);},createChartWrapper:function(o,a){var r=sap.ui.getCore().getLibraryResourceBundle("sap.m");var b=[],e,p;o.getDimensions().forEach(function(D){p=D.data("p13nData");e=new c({label:D.getLabel(),tooltip:D.getTooltip(),selected:o.getVisibleDimensions().indexOf(D.getName())>-1,aggregationRole:sap.ui.comp.personalization.AggregationRole.Dimension,role:D.getRole()?D.getRole():r.getText('COLUMNSPANEL_CHARTROLE_CATEGORY')});e.data("p13nData",p);b.push(e);});o.getMeasures().forEach(function(m){p=m.data("p13nData");e=new c({label:m.getLabel(),tooltip:m.getTooltip(),selected:o.getVisibleMeasures().indexOf(m.getName())>-1,aggregationRole:sap.ui.comp.personalization.AggregationRole.Measure,role:m.getRole()?m.getRole():r.getText('COLUMNSPANEL_CHARTROLE_AXIS1')});e.data("p13nData",p);b.push(e);});if(a){a.forEach(function(p){e=new c({label:p.label,tooltip:p.tooltip,selected:false,aggregationRole:sap.ui.comp.personalization.AggregationRole.NotDimeasure});e.data("p13nData",p);b.push(e);});}return new C({chart:o,columns:b});},sortItemsByText:function(p){var l;try{var l=sap.ui.getCore().getConfiguration().getLocale().toString();if(typeof window.Intl!=='undefined'){var o=window.Intl.Collator(l,{numeric:true});p.sort(function(a,b){return o.compare(a.text,b.text);});}else{p.sort(function(a,b){return a.text.localeCompare(b.text,l,{numeric:true});});}}catch(e){}},recoverPersonalisationData:function(p,t,a){if(!t){return;}if(!a){a=this.getColumnKeysOfDateType(t);}if(a.length&&p&&p.filter){p.filter.filterItems.forEach(function(f){if(a.indexOf(f.columnKey)>-1){if(f.value1&&typeof(f.value1)==="string"){f.value1=new Date(f.value1);}if(f.value2&&typeof(f.value2)==="string"){f.value2=new Date(f.value2);}}},this);}},recoverPersonalisationTimeData:function(p,t,a){if(!t){return;}if(!a){a=this.getColumnKeysOfTimeType(t);}if(a.length&&p&&p.filter){p.filter.filterItems.forEach(function(f){if(a.indexOf(f.columnKey)>-1){if(f.value1&&typeof(f.value1)==="string"){f.value1=new Date(f.value1);}if(f.value2&&typeof(f.value2)==="string"){f.value2=new Date(f.value2);}}},this);}},recoverPersonalisationBooleanData:function(p,t,a){if(!t){return;}if(!a){a=this.getColumnKeysOfDateType(t);}if(a.length&&p&&p.filter){p.filter.filterItems.forEach(function(f){if(a.indexOf(f.columnKey)>-1){if(f.value1&&typeof(f.value1)==="string"){f.value1=f.value1==="true";}if(f.value2&&typeof(f.value2)==="string"){f.value2=f.value2==="true";}}},this);}},getColumnKeysOfType:function(t,T){if(!t){return[];}var a=[];t.getColumns().forEach(function(o){if(this.getColumnType(o)===T){a.push(this.getColumnKey(o));}},this);return a;},getColumnKeysOfDateType:function(t){return this.getColumnKeysOfType(t,"date");},getColumnKeysOfTimeType:function(t){return this.getColumnKeysOfType(t,"time");},getColumnKeysOfBooleanType:function(t){return this.getColumnKeysOfType(t,"boolean");},validate:function(s,p,t,P){var r=[];var R=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");if(t instanceof sap.ui.table.AnalyticalTable&&s.group&&s.columns){t.getColumns().forEach(function(o){if(o.getInResult()){return;}var a=this.getColumnKey(o);var b=s.columns.controller.isColumnSelected(p.columns,P.columns,a);var g=s.group.controller.isGroupSelected(p.group,P.group,a);if(g&&!b){r.push({columnKey:a,panelTypes:[sap.m.P13nPanelType.group,sap.m.P13nPanelType.columns],messageType:M.Warning,messageText:R.getText("PERSODIALOG_MSG_GROUPING_NOT_POSSIBLE_DESCRIPTION")});}},this);}return r;},getUnionOfAttribute:function(s,a){var u=[];var A=function(b){if(u.indexOf(b)<0){u.push(b);}};for(var n in s){var N=s[n];if(!N[a]){continue;}N[a].forEach(A);}return u;},getVisibleColumnKeys:function(t){var a=[];t.getColumns().forEach(function(o){if(o.getVisible()){a.push(this.getColumnKey(o));}},this);return a;},copy:function(o){if(o instanceof Array){return jQuery.extend(true,[],o);}return jQuery.extend(true,{},o);},sort:function(k,A){var r=this.copy(A);r.sort(function(a,b){var t=a[k].toLocaleLowerCase();var T=b[k].toLocaleLowerCase();if(t<T){return-1;}if(t>T){return 1;}return 0;});return r;},removeEmptyProperty:function(o){for(var t in o){if(o[t]===null||o[t]===undefined){delete o[t];}}return o;},semanticEqual:function(i,I){if(!i||!I){return false;}for(var p in i){if(I[p]===undefined||i[p]!==I[p]){return false;}}return true;},hasChangedType:function(o){for(var t in o){if(o[t]===sap.ui.comp.personalization.ChangeType.ModelChanged||o[t]===sap.ui.comp.personalization.ChangeType.TableChanged){return true;}}return false;},isNamespaceChanged:function(o,n){if(o[n]){return o[n]===sap.ui.comp.personalization.ChangeType.ModelChanged||o[n]===sap.ui.comp.personalization.ChangeType.TableChanged;}return false;},isTrueForAll:function(o){for(var t in o){if(o[t]===false){return false;}}return true;},createArrayFromString:function(e){if(!e){return[];}var E=[];var r=e.split(",");r.forEach(function(f){if(f!==""){E.push(f.trim());}});return E;},getColumn:function(s,a){var r=null;a.some(function(o){if(this.getColumnKey(o)===s){r=o;return true;}},this);return r;},getIndexByKey:function(m,s){var I=-1;m.some(function(o,i){if(o.columnKey===s){I=i;return true;}});return I;},getColumnKey:function(o){return this._getCustomProperty(o,"columnKey")||o.getId();},getColumnType:function(o){return this._getCustomProperty(o,"type");},isGroupable:function(o){if(o instanceof sap.ui.table.AnalyticalColumn){var t=o.getParent();var b=t&&t.getBinding("rows");var r=b&&b.getAnalyticalQueryResult();if(t&&r&&r.findDimensionByPropertyName(o.getLeadingProperty())&&jQuery.inArray(o.getLeadingProperty(),b.getSortablePropertyNames())>-1&&jQuery.inArray(o.getLeadingProperty(),b.getFilterablePropertyNames())>-1){return true;}}if(o instanceof sap.m.Column){return this.isSortable(o);}return false;},isSortable:function(o){if(o.getSortProperty){return!!o.getSortProperty();}if(this._getCustomProperty(o,"sortProperty")){return true;}return false;},isFilterable:function(o){if(o.getFilterProperty){return!!o.getFilterProperty();}if(this._getCustomProperty(o,"filterProperty")){return true;}return false;},isConsistent:function(a){if(!a||!a.length){return true;}var b=true;var h=!!this._getCustomProperty(a[0],"columnKey");a.some(function(o){var H=!!this._getCustomProperty(o,"columnKey");if(H!==h){b=false;return true;}},this);return b;},getArrayElementByKey:function(k,K,a){if(!a||!a.length){return null;}var e=null;a.some(function(E){if(E[k]!==undefined&&E[k]===K){e=E;return true;}});return e;},isColumnIgnored:function(o,i){if(!i){return false;}return i.indexOf(this.getColumnKey(o))>-1;},createSort2Json:function(t,D,i){if(t){if(t instanceof sap.ui.table.Table){t.getColumns().forEach(function(o){var s=this.getColumnKey(o);if(this.isColumnIgnored(o,i)){return;}if(o.getSorted()){D.push({columnKey:s,operation:o.getSortOrder()});}},this);}}},_getCustomProperty:function(o,p){var a=this._getCustomData(o);if(!a||!p){return null;}return a[p];},_getCustomData:function(o){if(!o){return null;}var a=o.data("p13nData");if(typeof a==="string"){try{a=JSON.parse(a);o.data("p13nData",a);}catch(e){}}return a;}};return U;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.smartfield.Configuration')){
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.ui.comp.smartfield.Configuration');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.Element');sap.ui.define("sap/ui/comp/smartfield/Configuration",["jquery.sap.global","sap/ui/comp/library","sap/ui/core/Element"],function(q,l,E){"use strict";var C=E.extend("sap.ui.comp.smartfield.Configuration",{metadata:{library:"sap.ui.comp",properties:{controlType:{type:"sap.ui.comp.smartfield.ControlType",group:"Misc",defaultValue:null},displayBehaviour:{type:"sap.ui.comp.smartfield.DisplayBehaviour",group:"Misc",defaultValue:null}}}});return C;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.smartfield.ControlProposal')){jQuery.sap.declare('sap.ui.comp.smartfield.ControlProposal');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.Element');sap.ui.define("sap/ui/comp/smartfield/ControlProposal",["jquery.sap.global","sap/ui/comp/library","sap/ui/core/Element"],function(q,l,E){"use strict";var C=E.extend("sap.ui.comp.smartfield.ControlProposal",{metadata:{library:"sap.ui.comp",properties:{controlType:{type:"sap.ui.comp.smartfield.ControlProposalType",group:"Misc",defaultValue:sap.ui.comp.smartfield.ControlProposalType.None}},aggregations:{objectStatus:{type:"sap.ui.comp.smartfield.ObjectStatus",multiple:false}}}});return C;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.smartfield.ObjectStatus')){
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.ui.comp.smartfield.ObjectStatus');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.Element');sap.ui.define("sap/ui/comp/smartfield/ObjectStatus",["jquery.sap.global","sap/ui/comp/library","sap/ui/core/Element"],function(q,l,E){"use strict";var O=E.extend("sap.ui.comp.smartfield.ObjectStatus",{metadata:{library:"sap.ui.comp",properties:{criticality:{type:"any",group:"Misc",defaultValue:null}}}});return O;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.smartfilterbar.ControlConfiguration')){jQuery.sap.declare('sap.ui.comp.smartfilterbar.ControlConfiguration');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.Element');sap.ui.define("sap/ui/comp/smartfilterbar/ControlConfiguration",['jquery.sap.global','sap/ui/comp/library','sap/ui/core/Element'],function(q,l,E){"use strict";var C=E.extend("sap.ui.comp.smartfilterbar.ControlConfiguration",{metadata:{library:"sap.ui.comp",properties:{key:{type:"string",group:"Misc",defaultValue:null},groupId:{type:"string",group:"Misc",defaultValue:null},label:{type:"string",group:"Misc",defaultValue:null},visible:{type:"boolean",group:"Misc",defaultValue:true},hasValueHelpDialog:{type:"boolean",group:"Misc",defaultValue:true},controlType:{type:"string",group:"Misc",defaultValue:'auto'},filterType:{type:"string",group:"Misc",defaultValue:'auto'},index:{type:"any",group:"Misc",defaultValue:undefined},hasTypeAhead:{type:"boolean",group:"Misc",defaultValue:true},mandatory:{type:"string",group:"Misc",defaultValue:'auto'},width:{type:"string",group:"Misc",defaultValue:null},visibleInAdvancedArea:{type:"boolean",group:"Misc",defaultValue:false},preventInitialDataFetchInValueHelpDialog:{type:"boolean",group:"Misc",defaultValue:true},displayBehaviour:{type:"string",group:"Misc",defaultValue:'auto'},conditionType:{type:"any",group:"Misc",defaultValue:null}},aggregations:{defaultFilterValues:{type:"sap.ui.comp.smartfilterbar.SelectOption",multiple:true,singularName:"defaultFilterValue"},customControl:{type:"sap.ui.core.Control",multiple:false}},events:{change:{parameters:{propertyName:{type:"string"}}}}}});C.prototype.setFilterType=function(f){if(!C.FILTERTYPE[f]){throw"FilterType "+f+" is invalid";}this.setProperty("filterType",f);};C.prototype.setControlType=function(c){if(!C.CONTROLTYPE[c]){throw"ControlType "+c+" is invalid";}this.setProperty("controlType",c);};C.prototype.setMandatory=function(m){if(!C.MANDATORY[m]){throw"Mandatory state "+m+" is invalid";}this.setProperty("mandatory",m);};C.prototype.setVisible=function(i){this.setProperty("visible",i);this.fireChange({propertyName:"visible"});};C.prototype.setLabel=function(L){this.setProperty("label",L);this.fireChange({propertyName:"label"});};C.prototype.setVisibleInAdvancedArea=function(v){this.setProperty("visibleInAdvancedArea",v);this.fireChange({propertyName:"visibleInAdvancedArea"});};C.prototype.setDisplayBehaviour=function(d){if(!C.DISPLAYBEHAVIOUR[d]){throw"DisplayBehaviour "+d+" is invalid";}this.setProperty("displayBehaviour",d);};C.FILTERTYPE={auto:"auto",single:"single",multiple:"multiple",interval:"interval"};C.CONTROLTYPE={auto:"auto",input:"input",dropDownList:"dropDownList",date:"date"};C.MANDATORY={auto:"auto",mandatory:"mandatory",notMandatory:"notMandatory"};C.DISPLAYBEHAVIOUR={auto:"auto",descriptionOnly:"descriptionOnly",descriptionAndId:"descriptionAndId",idOnly:"idOnly",idAndDescription:"idAndDescription"};return C;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.smartfilterbar.GroupConfiguration')){
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.ui.comp.smartfilterbar.GroupConfiguration');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.Element');sap.ui.define("sap/ui/comp/smartfilterbar/GroupConfiguration",['jquery.sap.global','sap/ui/comp/library','sap/ui/core/Element'],function(q,l,E){"use strict";var G=E.extend("sap.ui.comp.smartfilterbar.GroupConfiguration",{metadata:{library:"sap.ui.comp",properties:{key:{type:"string",group:"Misc",defaultValue:null},index:{type:"any",group:"Misc",defaultValue:undefined},label:{type:"any",group:"Misc",defaultValue:undefined}},events:{change:{parameters:{propertyName:{type:"string"}}}}}});G.prototype.setLabel=function(L){this.setProperty("label",L);this.fireChange({propertyName:"label"});};return G;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.smartfilterbar.SelectOption')){jQuery.sap.declare('sap.ui.comp.smartfilterbar.SelectOption');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.Element');sap.ui.define("sap/ui/comp/smartfilterbar/SelectOption",['jquery.sap.global','sap/ui/comp/library','sap/ui/core/Element'],function(q,l,E){"use strict";var S=E.extend("sap.ui.comp.smartfilterbar.SelectOption",{metadata:{library:"sap.ui.comp",properties:{sign:{type:"string",group:"Misc",defaultValue:'I'},operator:{type:"string",group:"Misc",defaultValue:'EQ'},low:{type:"string",group:"Misc",defaultValue:null},high:{type:"string",group:"Misc",defaultValue:null}}}});S.SIGN={I:"I",include:"I",E:"E",exclude:"E"};S.OPERATOR={EQ:"EQ",NE:"NE",CP:"CP",GT:"GT",GE:"GE",LT:"LT",LE:"LE",NP:"NP",BT:"BT",NB:"NB"};return S;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.smartform.Layout')){
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.ui.comp.smartform.Layout');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.Element');sap.ui.define("sap/ui/comp/smartform/Layout",['jquery.sap.global','sap/ui/comp/library','sap/ui/core/Element'],function(q,l,E){"use strict";var L=E.extend("sap.ui.comp.smartform.Layout",{metadata:{library:"sap.ui.comp",properties:{labelSpanL:{type:"int",group:"Misc",defaultValue:null},labelSpanM:{type:"int",group:"Misc",defaultValue:null},labelSpanS:{type:"int",group:"Misc",defaultValue:null},emptySpanL:{type:"int",group:"Misc",defaultValue:null},emptySpanM:{type:"int",group:"Misc",defaultValue:null},emptySpanS:{type:"int",group:"Misc",defaultValue:null},columnsL:{type:"int",group:"Misc",defaultValue:null},columnsM:{type:"int",group:"Misc",defaultValue:null},singleGroupFullSize:{type:"boolean",group:"Misc",defaultValue:true},breakpointL:{type:"int",group:"Misc",defaultValue:null},breakpointM:{type:"int",group:"Misc",defaultValue:null},gridDataSpan:{type:"sap.ui.layout.GridSpan",group:"Misc",defaultValue:""}}}});return L;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.smartform.SmartForm')){jQuery.sap.declare('sap.ui.comp.smartform.SmartForm');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.m.MessageBox');jQuery.sap.require('sap.ui.core.Control');jQuery.sap.require('sap.ui.layout.form.Form');jQuery.sap.require('sap.ui.layout.form.ResponsiveLayout');jQuery.sap.require('sap.ui.fl.Utils');jQuery.sap.require('sap.ui.fl.registry.Settings');jQuery.sap.require('sap.m.Label');jQuery.sap.require('sap.m.Title');jQuery.sap.require('sap.m.Button');jQuery.sap.require('sap.m.ButtonType');jQuery.sap.require('sap.m.Panel');jQuery.sap.require('sap.m.OverflowToolbar');jQuery.sap.require('sap.m.ToolbarSpacer');jQuery.sap.require('sap.m.ToolbarSeparator');sap.ui.define("sap/ui/comp/smartform/SmartForm",['jquery.sap.global','sap/ui/comp/library','sap/m/MessageBox','sap/ui/core/Control','sap/ui/layout/form/Form','sap/ui/layout/form/ResponsiveLayout','sap/ui/fl/Utils','sap/ui/fl/registry/Settings','sap/m/Label','sap/m/Title','sap/m/Button','sap/m/ButtonType','sap/m/Panel','sap/m/OverflowToolbar','sap/m/ToolbarSpacer','sap/m/ToolbarSeparator'],function(q,l,a,C,F,R,U,b,c,T,B,d,P,O,e,f){"use strict";var g=C.extend("sap.ui.comp.smartform.SmartForm",{metadata:{library:"sap.ui.comp",properties:{title:{type:"string",group:"Misc",defaultValue:null},useHorizontalLayout:{type:"boolean",group:"Misc",defaultValue:null},horizontalLayoutGroupElementMinWidth:{type:"int",group:"Misc",defaultValue:null},checkButton:{type:"boolean",group:"Misc",defaultValue:false},entityType:{type:"string",group:"Misc",defaultValue:null},expandable:{type:"boolean",group:"Misc",defaultValue:false},expanded:{type:"boolean",group:"Misc",defaultValue:null},editTogglable:{type:"boolean",group:"Misc",defaultValue:false},editable:{type:"boolean",group:"Misc",defaultValue:false},ignoredFields:{type:"string",group:"Misc",defaultValue:null},flexEnabled:{type:"boolean",group:"Misc",defaultValue:true}},defaultAggregation:"groups",aggregations:{groups:{type:"sap.ui.comp.smartform.Group",multiple:true,singularName:"group"},content:{type:"sap.ui.core.Control",multiple:false,visibility:"hidden"},layout:{type:"sap.ui.comp.smartform.Layout",multiple:false},semanticObjectController:{type:"sap.ui.comp.navpopover.SemanticObjectController",multiple:false},customToolbar:{type:"sap.m.Toolbar",multiple:false},toolbar:{type:"sap.m.Toolbar",multiple:false,visibility:"hidden"}},events:{editToggled:{},checked:{}}},renderer:function(r,o){var t=o._getCustomToolbar()||o._oToolbar;r.write("<div");r.writeControlData(o);r.addClass("sapUiCompSmartForm");r.writeClasses();r.write(">");if(o.mProperties["expandable"]){r.renderControl(o._oPanel);}else{if(t){r.renderControl(t);}r.renderControl(o._oForm);}r.write("</div>");}});g.prototype.init=function(){this._bisLayoutCreated=false;this._oForm=null;this._oPanel=null;this._oTitle=new T(this.getId()+"-title-sfmain").addStyleClass("title");this._bUpdateToolbar=true;this._sResizeListenerId="";this._oRb=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");};g.prototype._resizeHandlerRegId="";g.prototype.onBeforeRendering=function(){this._updateToolbar();this._createLayout();this._updatePanel();if(this.getUseHorizontalLayout()&&this.getLayout()&&this.getLayout().getGridDataSpan()){this._propagateGridDataSpan();this._registerResizeHandler();}};g.prototype.addGroup=function(G){this.addAggregation("groups",G,true);};g.prototype.addAggregation=function(A,o){if(A==="groups"){this._insertGroup(o);}else{C.prototype.addAggregation.apply(this,arguments);}};g.prototype.getGroups=function(){var G=this.getAggregation('groups');return((G===null)?[]:G);};g.prototype.getAggregation=function(A){var r=null;if(A==="groups"){r=this._oForm?this._oForm.getFormContainers():[];}else{r=C.prototype.getAggregation.apply(this,arguments);}return r;};g.prototype._getLayout=function(){var L=this.getLayout();var o=null;var G=this.getGroups();if(L){o=new sap.ui.layout.form.ResponsiveGridLayout({"labelSpanL":L.mProperties["labelSpanL"]?L.mProperties["labelSpanL"]:4,"labelSpanM":L.mProperties["labelSpanM"]?L.mProperties["labelSpanM"]:4,"emptySpanL":L.mProperties["emptySpanL"]?L.mProperties["emptySpanL"]:0,"emptySpanM":L.mProperties["emptySpanM"]?L.mProperties["emptySpanM"]:0,"columnsL":L.mProperties["columnsL"]?L.mProperties["columnsL"]:3,"columnsM":L.mProperties["columnsM"]?L.mProperties["columnsM"]:2,"singleContainerFullSize":L.mProperties["singleGroupFullSize"],"breakpointL":L.mProperties["breakpointL"]?L.mProperties["breakpointL"]:1024,"breakpointM":L.mProperties["breakpointL"]?L.mProperties["breakpointL"]:600});}else{o=new sap.ui.layout.form.ResponsiveGridLayout({"labelSpanL":4,"labelSpanM":4,"emptySpanL":0,"emptySpanM":0,"columnsL":3,"columnsM":2,"breakpointL":1024,"breakpointM":600});}if(G&&G.length<o.getColumnsL()&&o.mProperties["singleContainerFullSize"]){o.setColumnsL(G.length);}return o;};g.prototype._createToolbar=function(){if(this._oToolbar){var o=this._oToolbar.removeContent(this._oToolbar.getId()+"-button-sfmain-editToggle");if(o){o.destroy();this._oEditToggleButton=null;}o=this._oToolbar.removeContent(this.getId()+"-"+this._oToolbar.getId()+"-button-sfmain-check");if(o){o.destroy();}o=this._oToolbar.removeContent(this.getId()+"-"+this._oToolbar.getId()+"-AdaptationButton");if(o){o.destroy();}this._oToolbar.removeContent(this.getId()+"-title-sfmain");}this._oToolbar=new O({"height":"3rem","design":sap.m.ToolbarDesign.Transparent});this.setAggregation("toolbar",this._oToolbar);};g.prototype._updateToolbar=function(){var o=this._getCustomToolbar();if(this._bUpdateToolbar){if(o){this._cleanToolbar();this._addHeaderToToolbar();this._addSeparatorToToolbar();this._addEditTogglableToToolbar();this._addCheckToToolbar();this._addChangeModeToToolbar();this._removeSeparatorFromToolbar();}else{this._createToolbar();this._addHeaderToToolbar();this._addEditTogglableToToolbar();this._addCheckToToolbar();this._addChangeModeToToolbar();if(this._oToolbar.getContent().length===1&&!this.getExpandable()){this._oToolbar.destroyContent();this._oToolbar.destroy();this._oToolbar=null;this.setAggregation("toolbar",null);}}this._bUpdateToolbar=false;}};g.prototype._getToolbar=function(){var o=this._getCustomToolbar();return o||this._oToolbar;};g.prototype._updatePanel=function(){var t=this;var o=this._getToolbar();if(this.mProperties["expandable"]){if(!this._oPanel){this._oPanel=new P({"expanded":this.mProperties["expanded"],"expandable":true,"headerText":this.getTitle(),"headerToolbar":o});this._oPanel.attachExpand(function(E){t.setProperty("expanded",E.getParameters()["expand"],false);});this._oPanel.addContent(this._oForm);this.setAggregation("content",this._oPanel);}else{this._oPanel.setExpanded(this.mProperties["expanded"]);this._oPanel.setHeaderToolbar(o);}}else{this.setAggregation("content",this._oForm);}};g.prototype._cleanToolbar=function(){var o=this._getCustomToolbar();var h=o.removeContent(o.getId()+"-button-sfmain-editToggle");if(h){h.destroy();this._oEditToggleButton=null;}h=o.removeContent(this.getId()+"-"+o.getId()+"-button-sfmain-check");if(h){h.destroy();}h=o.removeContent(this.getId()+"-"+o.getId()+"-AdaptationButton");if(h){h.destroy();}o.removeContent(this.getId()+"-title-sfmain");};g.prototype._addHeaderToToolbar=function(){var o=this._getCustomToolbar();var t=o||this._oToolbar;var h=[];var i=0;var j=null;if(this.getTitle()||this.mBindingInfos['title']){t.insertContent(this._oTitle,0);}if(this._oToolbar){t.insertContent(new e(),1);}else{h=t.getContent();for(i;i<h.length;i++){if(h[i].getMetadata().getName()==="sap.m.ToolbarSpacer"){j=h[i];}}if(!j){t.addContent(new e());}}};g.prototype._addEditTogglableToToolbar=function(){var o=this._getCustomToolbar();var t=o||this._oToolbar;var h=this;var i=this.getEditable()?"sap-icon://display":"sap-icon://edit";var s=this._oRb.getText(this.getEditable()?"FORM_TOOLTIP_DISPLAY":"FORM_TOOLTIP_EDIT");if(this.getEditTogglable()){if(!this._oEditToggleButton){this._oEditToggleButton=new B(t.getId()+"-button-sfmain-editToggle",{type:d.Default,icon:i,tooltip:s,press:function(){h._toggleEditMode();}});}t.addContent(this._oEditToggleButton);}};g.prototype._propagateGridDataSpan=function(){var G,s="",L=this.getLayout();if(L){s=L.getGridDataSpan();}G=this.getGroups();G.forEach(function(o){var E=o.getGroupElements();E.forEach(function(h){var L=h.getFields()[0].getLayoutData();if(L){L.setSpan(s);}else{L=new sap.ui.layout.GridData({span:s});h.getFields()[0].setLayoutData(L);}if(h.getFields()[0]instanceof sap.m.VBox){var S=h.getFields()[0].getItems()[1];if(S&&S.setControlContext){S.setControlContext(sap.ui.comp.smartfield.ControlContextType.SmartFormGrid);}}});});};g.prototype.propagateGridDataSpan=function(){this._propagateGridDataSpan();return this;};g.prototype._registerResizeHandler=function(){if(this._resizeHandlerRegId){return;}var t=this;var r=function(){var G=t.getGroups();G.forEach(function(o){o._updateLineBreaks();});};this._resizeHandlerRegId=sap.ui.core.ResizeHandler.register(this._oForm,r);};g.prototype._getCurrentSpan=function(){var s=this.getLayout().getGridDataSpan();var i=0;var r=[];if(this.getDomRef()&&this._oForm){if(this.getDomRef().clientWidth>this._oForm.getLayout().getBreakpointL()){var L=/L([1-9]|1[0-2])/i;r=L.exec(s);i=r[1];}else if(this.getDomRef().clientWidth>this._oForm.getLayout().getBreakpointM()){var M=/M([1-9]|1[0-2])/i;r=M.exec(s);i=r[1];}else{var S=/S([1-9]|1[0-2])/i;r=S.exec(s);i=r[1];}}return i;};g.prototype._toggleEditMode=function(){var E=this.getEditable();this.setEditable(!E);};g.prototype._addChangeModeToToolbar=function(){if(b.isFlexChangeMode()&&b.isFlexibilityAdaptationButtonAllowed()){return this._getAddChangeModelToToolbarPromise();}return Promise.resolve();};g.prototype._getAddChangeModelToToolbarPromise=function(){var t=this;var s=U.getComponentClassName(this);var p={appDescriptor:U.getAppDescriptor(this),siteId:U.getSiteId(this)};var i=this.getFlexEnabled();if(i){return b.getInstance(s,p).then(function(S){if(S.isKeyUser()&&U.checkControlId(t)){t._setToolbarAndAddContent();}},function(E){});}else{return Promise.resolve();}};g.prototype._setToolbarAndAddContent=function(){var o=this._getCustomToolbar();var t=o||this._oToolbar;if(!t||t.bIsDestroyed){this._createToolbar();this._oToolbar.addStyleClass("titleBar");this._addHeaderToToolbar();t=this._oToolbar;this.invalidate();}t.addContent(new B(this.getId()+"-"+t.getId()+"-AdaptationButton",{type:d.Default,icon:"sap-icon://action-settings",tooltip:this._oRb.getText("FORM_TOOLTIP_SETTINGS"),press:this._handleAdaptationButtonPress.bind(this)}));};g.prototype._handleAdaptationButtonPress=function(){var t=this;var m=this.getModel().getMetaModel();m.loaded().then(t._openAdaptationDialog.bind(t));};g.prototype._openAdaptationDialog=function(){q.sap.require('sap.ui.comp.smartform.flexibility.FormP13nHandler');var h=new sap.ui.comp.smartform.flexibility.FormP13nHandler();h.init(this);h.show();};g.prototype._addCheckToToolbar=function(){if(!this.getEditable()){return;}var o=this._getCustomToolbar();var t=o||this._oToolbar;var h=this;if(this.getCheckButton()){t.addContent(new B(this.getId()+"-"+t.getId()+"-button-sfmain-check",{type:d.Default,text:this._oRb.getText("SMART_FORM_CHECK"),press:function(){var E=[];E=h.check();h.fireChecked({erroneousFields:E});}}));}};g.prototype.check=function(h){if(h===undefined){h=true;}var E=this._checkClientError(h);return E;};g.prototype._checkClientError=function(h){if(h===undefined){h=true;}var i=this.getSmartFields(h);var E=[];i.forEach(function(o){if(o.checkClientError()){if(h&&o.getVisible){if(!o.getVisible()){return;}}E.push(o.getId());}});return E;};g.prototype._addSeparatorToToolbar=function(){var o=this._getCustomToolbar();var t=o||this._oToolbar;t.addContent(new f());};g.prototype._removeSeparatorFromToolbar=function(){var o=this._getCustomToolbar();var t=o||this._oToolbar;var h=t.getContent();var L=null;var r=[];var i=0;L=h[h.length-1];if(L.getMetadata().getName()==="sap.m.ToolbarSeparator"){t.removeContent(L);}L=null;for(i;i<h.length;i++){if(h[i].getMetadata().getName()==="sap.m.ToolbarSeparator"&&L.getMetadata().getName()!="sap.m.Button"){r.push(h[i]);}L=h[i];}for(i=0;i<r.length;i++){t.removeContent(r[i]);}};g.prototype._displayError=function(E){var s,h;h=this._oRb.getText("FORM_CLIENT_CHECK_ERROR_TITLE");s=this._oRb.getText("FORM_CLIENT_CHECK_ERROR");a.show(s,{icon:a.Icon.ERROR,title:h,styleClass:(this.$()&&this.$().closest(".sapUiSizeCompact").length)?"sapUiSizeCompact":""});};g.prototype.setEditable=function(E){var t;var o=this.getEditable();if(o===E){return this;}if(!E&&this.hasListeners("editToggled")){var h=[];h=this.check(true);if(h&&h.length>0){this._displayError(h);return this;}}this.setProperty("editable",E);if(this._oForm){this._oForm.setEditable(E);}this.fireEditToggled({editable:E});if(this._oEditToggleButton){this._oEditToggleButton.setIcon(E?"sap-icon://display":"sap-icon://edit");t=this._oRb.getText(E?"FORM_TOOLTIP_DISPLAY":"FORM_TOOLTIP_EDIT");this._oEditToggleButton.setTooltip(t);}var G=this.getGroups();G.forEach(function(i){i.setEditMode(E);});this._bUpdateToolbar=true;return this;};g.prototype.setEditTogglable=function(t){this.setProperty("editTogglable",t);this._bUpdateToolbar=true;return this;};g.prototype.setTitle=function(t){C.prototype.setProperty.apply(this,["title",t]);this._oTitle.setText(t);return this;};g.prototype.setUseHorizontalLayout=function(u){var o=this.getProperty("useHorizontalLayout");if(o!==u){this.setProperty("useHorizontalLayout",u);if(u){this.addStyleClass("sapUiCompSmartFormHorizontalLayout");}else{this.removeStyleClass("sapUiCompSmartFormHorizontalLayout");}var G=this.getGroups();if(G){G.forEach(function(h){h.setUseHorizontalLayout(u);});}this._bisLayoutCreated=false;}return this;};g.prototype.setHorizontalLayoutGroupElementMinWidth=function(n){this.setProperty("horizontalLayoutGroupElementMinWidth",n);var G=this.getGroups();if(G){G.forEach(function(o){o.setHorizontalLayoutGroupElementMinWidth(n);});}return this;};g.prototype.getVisibleProperties=function(){var p=[];var G=this.getGroups();if(G){G.forEach(function(o){var h=o.getGroupElements();if(h){h.forEach(function(i){var j=i.getFields();if(j){j.forEach(function(k){if(k.getVisible()){var s=k.getBindingPath("value");if(s){p.push(s);}}});}});}});}return p;};g.prototype.setCustomToolbar=function(o){if(o){o.data('bIsSmartFormCustomToolbar',true);}this.setAggregation("customToolbar",o);if(o){this._bUpdateToolbar=true;}return this;};g.prototype.getCustomToolbar=function(){var o=this._getCustomToolbar();return o;};g.prototype._getCustomToolbar=function(){var o=this.getAggregation("customToolbar");if(!o&&this._oPanel){o=this._oPanel.getHeaderToolbar();if(!o.data('bIsSmartFormCustomToolbar')){o=null;}}return o;};g.prototype.insertGroup=function(G,i){this.insertAggregation("groups",G,i);return this;};g.prototype.insertAggregation=function(A,o,i){if(A==="groups"){this._insertGroup(o,i);}else{C.prototype.insertAggregation.apply(this,arguments);}};g.prototype.removeGroup=function(G){this.removeAggregation("groups",G);return this;};g.prototype.removeAggregation=function(A,o){if(A==="groups"){return this._oForm.removeFormContainer(o);}else{return C.prototype.removeAggregation.apply(this,arguments);}};g.prototype.removeAllAggregation=function(A){if(A==="groups"){return this.removeAllGroups();}else{return C.prototype.removeAllAggregation.apply(this,arguments);}};g.prototype.destroyGroups=function(){this.destroyAggregation("groups");return this;};g.prototype.destroyAggregation=function(A){if(A==="groups"){this._oForm.destroyFormContainers();}else{C.prototype.destroyAggregation.apply(this,arguments);}};g.prototype._createForm=function(){if(!this._oForm){this._oForm=new F({"editable":this.getEditable()});}};g.prototype._createLayout=function(){var L=null;this._createForm();if(!this._bisLayoutCreated&&this._oForm){L=this._oForm.getLayout();if(L){L.destroy();}if(this.mProperties["useHorizontalLayout"]){if(this.getLayout()&&this.getLayout().getGridDataSpan()){L=new sap.ui.layout.form.ResponsiveGridLayout({columnsL:1,columnsM:1});if(this.getLayout().getBreakpointM()>0){L.setBreakpointM(this.getLayout().getBreakpointM());}if(this.getLayout().getBreakpointL()>0){L.setBreakpointM(this.getLayout().getBreakpointL());}}else{L=new sap.ui.layout.form.ResponsiveLayout();}}else{L=this._getLayout();}this._oForm.setLayout(L);this._bisLayoutCreated=true;}};g.prototype._addCustomData=function(G){var h=null;if(G){h=this.getCustomData();if(h&&h.length>0){h.forEach(function(o){G.addCustomData(o.clone());});}}};g.prototype._delegateEditMode=function(G){if(G){G.setEditMode(this.mProperties["editable"]);}};g.prototype._insertGroup=function(G,i){this._createForm();if(i===undefined||i===null){i=this._oForm.getFormContainers().length;}else if(i===-1){i=0;}G.setHorizontalLayoutGroupElementMinWidth(this.getHorizontalLayoutGroupElementMinWidth());G.setUseHorizontalLayout(this.getUseHorizontalLayout());this._addCustomData(G);this._delegateEditMode(G);this._oForm.insertFormContainer(G,i);};g.prototype.removeAllGroups=function(){if(this._oForm){return this._oForm.removeAllFormContainers();}};g.prototype.updateAggregation=function(A){C.prototype.updateAggregation.apply(this,arguments);if(A==="groups"){this._updateClonedElements(this);}};g.prototype.getSmartFields=function(h){var G=[];var i=[];var E=[];var j=[];var s=[];if(h===undefined){h=true;}G=this.getGroups();G.forEach(function(o){if(!h||(h&&o.getVisible())){i=o.getGroupElements();i.forEach(function(k){j=[];E=k.getElements();j=k._extractFields(E,true);j=j.filter(function(m){return m instanceof sap.ui.comp.smartfield.SmartField;});s=s.concat(j);});}});return s;};g.prototype.setFocusOnEditableControl=function(){var h=[];this.getGroups().forEach(function(G){G.getGroupElements().forEach(function(o){h=h.concat(o.getElements());});});while(h.some(function(o){return o instanceof sap.m.FlexBox;})){for(var i=0;i<h.length;i++){if(h[i]instanceof sap.m.FlexBox){Array.prototype.splice.apply(h,[i,1].concat(h[i].getItems()));}}}h.some(function(o){if(o.getEditable&&o.getEditable()&&o.focus){o.focus();return true;}});};g.prototype.clone=function(I,L){var o=C.prototype.clone.apply(this,arguments);var A=this.getMetadata().getAggregations();var s;var h;for(s in A){h=this.getAggregation(s);if(this.getMetadata().hasAggregation(s)&&!this.isBound(s)&&((o.getAggregation(s)===null)||o.getAggregation(s).length===0)){if(h instanceof sap.ui.base.ManagedObject){o.addAggregation(s,h.clone(I,L));}else if(q.isArray(h)){for(var i=0;i<h.length;i++){o.addAggregation(s,h[i].clone(I,L));}if(s==="groups"){this._updateClonedElements(o);}}else if(h!=null){o.setAggregation(s,h.clone(I,L));}}}return o;};g.prototype._updateClonedElements=function(s){var o=null,L=null;var G=[];var E=[];var h=[];var i=s.getGroups();i.forEach(function(j){G=j.getGroupElements();G.forEach(function(k){o=k._getFieldRelevantForLabel();L=k._getLabel();if(o&&L){L.setLabelFor(o);}E=k.getElements();h=[];h=k._extractFields(E,true);h.forEach(function(o){if(o.getEditable){if(!o.getEditable()){o.data("editable",false);}}if(o.attachVisibleChanged){o.attachVisibleChanged(function(m){k._updateFormElementVisibility();});}if(o.attachContextEditableChanged){o.attachContextEditableChanged(function(m){k._updateFormElementEditable(m);});}if(o.attachInnerControlsCreated){o.attachInnerControlsCreated(function(m){k._updateFormElementLabel(m);});}});});});};g.prototype.exit=function(){if(this._oForm){this._oForm.destroy();}if(this._oPanel){this._oPanel.destroy();}if(this._oTitle){this._oTitle.destroy();}if(this._oToolbar){this._oToolbar.destroy();}if(this._oEditToggleButton){this._oEditToggleButton.destroy();}this._oForm=null;this._oPanel=null;this._oTitle=null;this._bUpdateToolbar=true;this._sResizeListenerId="";this._oRb=null;this._oToolbar=null;this._oEditToggleButton=null;if(this._resizeHandlerRegId){sap.ui.core.ResizeHandler.deregister(this._resizeHandlerRegId);this._resizeHandlerRegId="";}};return g;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.smartform.flexibility.FieldList')){
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.ui.comp.smartform.flexibility.FieldList');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.Control');sap.ui.define("sap/ui/comp/smartform/flexibility/FieldList",['jquery.sap.global','sap/ui/comp/library','sap/ui/core/Control'],function(q,l,C){"use strict";var F=C.extend("sap.ui.comp.smartform.flexibility.FieldList",{metadata:{library:"sap.ui.comp",aggregations:{nodes:{type:"sap.ui.comp.smartform.flexibility.FieldListNode",multiple:true,singularName:"node"}},events:{selectionChanged:{},labelChanged:{},nodeHidden:{}}}});F.prototype.init=function(){this._oSelectedNode=null;};F.prototype.getSelectedNode=function(){return this._oSelectedNode;};F.prototype._registerNodeSelectionChangedEvent=function(n){if(n){n.attachSelected(this._handleSelectionChanged.bind(this));}};F.prototype._registerNodeLabelChangedEvent=function(n){if(n){n.attachLabelChanged(this._handleLabelChanged.bind(this));}};F.prototype._registerNodeHiddenEvent=function(n){if(n){n.attachNodeHidden(this._handleNodeHidden.bind(this));}};F.prototype._deregisterNodeSelectionChangedEvent=function(n){if(n){n.detachSelected(this._handleSelectionChanged.bind(this));}};F.prototype._deregisterNodeLabelChangedEvent=function(n){if(n){n.detachLabelChanged(this._handleLabelChanged.bind(this));}};F.prototype._deregisterNodeHiddenEvent=function(n){if(n){n.detachNodeHidden(this._handleNodeHidden.bind(this));}};F.prototype._handleSelectionChanged=function(e){var n;n=e.getParameter("target");if(n){this.fireSelectionChanged({node:n});}};F.prototype._handleLabelChanged=function(e){var n;n=e.getParameter("target");if(n){this.fireLabelChanged({node:n});}};F.prototype._handleNodeHidden=function(e){var n;n=e.getParameter("target");if(n){this.fireNodeHidden({node:n});}};F.prototype._setSelectedNode=function(n){if(!n){return;}if(this._oSelectedNode){this._oSelectedNode.setIsSelected(false);}this._oSelectedNode=n;this._oSelectedNode.setIsSelected(true);};F.prototype.addNode=function(n){this.addAggregation("nodes",n,true);this._registerNodeSelectionChangedEvent(n);this._registerNodeLabelChangedEvent(n);this._registerNodeHiddenEvent(n);return this;};F.prototype.destroyNodes=function(n){var N,a,i;N=this.getNodes();a=N.length;for(i=0;i<a;i++){this._deregisterNodeSelectionChangedEvent(N[i]);this._deregisterNodeLabelChangedEvent(N[i]);this._deregisterNodeHiddenEvent(N[i]);}this.destroyAggregation("nodes");return this;};F.prototype.removeNode=function(n){this.removeAggregation("nodes",n);if(typeof n==='number'){n=this.getNodes([n]);}this._deregisterNodeSelectionChangedEvent(n);this._deregisterNodeLabelChangedEvent(n);this._deregisterNodeHiddenEvent(n);return this;};return F;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.smartform.flexibility.Input')){jQuery.sap.declare('sap.ui.comp.smartform.flexibility.Input');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.m.Input');sap.ui.define("sap/ui/comp/smartform/flexibility/Input",['jquery.sap.global','sap/m/Input','sap/ui/comp/library'],function(q,I,l){"use strict";var a=I.extend("sap.ui.comp.smartform.flexibility.Input",{metadata:{library:"sap.ui.comp",events:{selectedByKeyboard:{}}}});a.prototype.init=function(){I.prototype.init.call(this);};a.prototype.onAfterRendering=function(){var d;I.prototype.onAfterRendering.apply(this);d=this.getDomRef();if(d){d.tabIndex=0;}};a.prototype.onkeydown=function(e){var n;I.prototype.onkeydown.apply(this,arguments);n=e.keyCode;if(n===32){if(this.getEditable()===false){this.fireSelectedByKeyboard();}}};a.prototype.onsapescape=function(e){I.prototype.onsapescape.apply(this,arguments);e.stopPropagation();this.setEditable(false);};a.prototype.onsapenter=function(e){if(!this.getValue()){this.resetOnEmptyValue();}I.prototype.onsapenter.apply(this,arguments);this.setEditable(false);};a.prototype.resetOnEmptyValue=function(e){if(!this.getValue()){this.setValue(this._lastValue);this.onValueRevertedByEscape(this._lastValue);}};a.prototype.onsapfocusleave=function(e){this.resetOnEmptyValue();I.prototype.onsapfocusleave.apply(this,arguments);};return a;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.smartvariants.PersonalizableInfo')){jQuery.sap.declare('sap.ui.comp.smartvariants.PersonalizableInfo');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.Element');sap.ui.define("sap/ui/comp/smartvariants/PersonalizableInfo",['jquery.sap.global','sap/ui/comp/library','sap/ui/core/Element'],function(q,l,E){"use strict";var P=E.extend("sap.ui.comp.smartvariants.PersonalizableInfo",{metadata:{library:"sap.ui.comp",properties:{type:{type:"string",group:"Misc",defaultValue:null},dataSource:{type:"string",group:"Misc",defaultValue:null},keyName:{type:"string",group:"Misc",defaultValue:null}},associations:{control:{type:"sap.ui.core.Control",multiple:false}}}});P.prototype.addControl=function(c){this.addAssociation("control",c,true);};return P;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.transport.TransportDialog')){jQuery.sap.declare('sap.ui.comp.transport.TransportDialog');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.m.Button');jQuery.sap.require('sap.m.ComboBox');jQuery.sap.require('sap.m.Dialog');jQuery.sap.require('sap.m.DialogRenderer');jQuery.sap.require('sap.m.Input');jQuery.sap.require('sap.m.Label');jQuery.sap.require('sap.m.MessageToast');jQuery.sap.require('sap.ui.core.ListItem');jQuery.sap.require('sap.ui.fl.Transports');jQuery.sap.require('sap.ui.layout.Grid');jQuery.sap.require('sap.ui.layout.GridData');sap.ui.define("sap/ui/comp/transport/TransportDialog",['jquery.sap.global','sap/m/Button','sap/m/ComboBox','sap/m/Dialog','sap/m/DialogRenderer','sap/m/Input','sap/m/Label','sap/m/MessageToast','sap/ui/comp/library','sap/ui/core/ListItem','sap/ui/fl/Transports','sap/ui/layout/Grid','sap/ui/layout/GridData'],function(q,B,C,D,a,I,L,M,l,b,T,G,c){"use strict";var d=D.extend("sap.ui.comp.transport.TransportDialog",{metadata:{library:"sap.ui.comp",properties:{pkg:{type:"string",group:"Misc",defaultValue:null},transports:{type:"any",group:"Misc",defaultValue:null},lrepObject:{type:"any",group:"Misc",defaultValue:null},hidePackage:{type:"boolean",group:"Misc",defaultValue:null}},events:{ok:{},cancel:{}}},renderer:a.render});d.prototype.init=function(){D.prototype.init.apply(this);this._oResources=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");this.setTitle(this._oResources.getText("TRANSPORT_DIALOG_TITLE"));this.addStyleClass("sapUiCompTransportDialog");this._oPackageLabel=null;this._oPackage=this._createPackageField();this._oTransport=this._createTransportCombo();this.addContent(this._createContentGrid());this.setContentWidth("250px");this._createButtons();};d.prototype._createContentGrid=function(){var t;this._oPackageLabel=new L({text:this._oResources.getText("TRANSPORT_DIALOG_PACKAGE"),required:true,layoutData:new c({span:"L3 M3 S3"})}).addStyleClass("compFieldMargin");this._oPackageLabel.setLabelFor(this._oPackage);t=new L({text:this._oResources.getText("TRANSPORT_DIALOG_TRANSPORT"),required:true,layoutData:new c({span:"L3 M3 S3",linebreakL:true,linebreakM:true,linebreakS:true})}).addStyleClass("compFieldMargin");t.setLabelFor(this._oTransport);return new G({width:"100%",defaultSpan:"L9 M9 S9",vSpacing:0,hSpacing:0,content:[this._oPackageLabel,this._oPackage,t,this._oTransport]}).addStyleClass("compTransportPadding");};d.prototype._createButtons=function(){var t=this;this.addButton(new B({text:this._oResources.getText("TRANSPORT_DIALOG_LOCAL_OBJECT"),tooltip:this._oResources.getText("TRANSPORT_DIALOG_LOCAL_OBJECT"),press:function(){t._onLocal();}}));this.addButton(new B({text:this._oResources.getText("TRANSPORT_DIALOG_OK"),tooltip:this._oResources.getText("TRANSPORT_DIALOG_OK"),enabled:false,press:function(){t._onOkay();}}));this.addButton(new B({text:this._oResources.getText("TRANSPORT_DIALOG_CANCEL"),tooltip:this._oResources.getText("TRANSPORT_DIALOG_CANCEL"),press:function(){t.fireCancel();t.close();t.destroy();}}));};d.prototype._onLocal=function(){this.fireOk({selectedTransport:"",selectedPackage:this.getPkg()||"$TMP",dialog:true});this.close();this.destroy();};d.prototype._onOkay=function(){var t=this._oTransport.getSelectedKey();if(this._checkOkay(t)){this.fireOk({selectedTransport:t,selectedPackage:this.getPkg()||this._oPackage.getValue(),dialog:true});this.close();this.destroy();}else{this.getButtons()[1].setEnabled(false);this._oTransport.setValueState(sap.ui.core.ValueState.Error);this._oTransport.setValueStateText(this.getTitle());}};d.prototype._checkOkay=function(t){if(t){return true;}return false;};d.prototype._createTransportCombo=function(){var t=this;return new C({enabled:false,tooltip:this._oResources.getText("TRANSPORT_DIALOG_TRANSPORT_TT"),width:"100%",selectionChange:function(){if(t._oPackage.getEnabled()&&t._oPackage.getVisible()&&(!t._oPackage.getValue()||t._oPackage.getValue()==="")){return;}t.getButtons()[1].setEnabled(true);t._oTransport.setValueState(sap.ui.core.ValueState.None);},change:function(e){var f=function(i){if((i&&e.mParameters.newValue!==i.getText())||!i){return true;}return false;};if(e&&e.mParameters&&e.mParameters.newValue){if(f(t._oTransport.getSelectedItem())){t.getButtons()[1].setEnabled(false);t._oTransport.setValueState(sap.ui.core.ValueState.Error);t._oTransport.setValueStateText(t._oResources.getText("TRANSPORT_DIALOG_TRANSPORT_TT"));}}}});};d.prototype._createPackageField=function(){var t=this;return new I({tooltip:this._oResources.getText("TRANSPORT_DIALOG_PACKAGE_TT"),width:"100%",change:function(){var o,p,O;O=t._createObjectInfo();o=new sap.ui.fl.Transports();p=o.getTransports(O);p.then(function(r){t._onPackageChangeSuccess(r);},function(r){t._onPackageChangeError(r);});},liveChange:function(e){if(e.mParameters.liveValue&&e.mParameters.liveValue.length>3){t._oTransport.setEnabled(true);}}});};d.prototype._createObjectInfo=function(){var o,r={"package":this._oPackage.getValue()||""};o=this.getProperty("lrepObject");if(o){if(o.name){r.name=o.name;}if(o.type){r.type=o.type;}if(o.namespace){r.namespace=o.namespace;}}return r;};d.prototype._onPackageChangeSuccess=function(t){if(t){if(t.localonly){this._oTransport.setEnabled(false);this.getButtons()[1].setEnabled(true);}else if(t.transports&&t.transports.length>0){this._oTransport.setEnabled(true);this._setTransports(t);}else if(t.errorCode){this.getButtons()[1].setEnabled(false);this._oPackage.setValueState(sap.ui.core.ValueState.Error);this._oPackage.setValueStateText(this._oResources.getText("TRANSPORT_DIALOG_"+t.errorCode));this._setTransports(t);}else{M.show(this._oResources.getText("TRANSPORT_DIALOG_NO_TRANSPORTS"));}}};d.prototype._setTransports=function(t){var o,e;o=this._hasLock(t.transports);if(o){e=[o];}else{e=t.transports;}this.setTransports(e);if(e&&e.length===1){this._oTransport.setValue(e[0].description,true);this.getButtons()[1].setEnabled(true);}if(!e||e.length===0){this._oTransport.setSelectedKey(null);this._oTransport.setValueState(sap.ui.core.ValueState.None);this.getButtons()[1].setEnabled(false);}};d.prototype._onPackageChangeError=function(r){M.show(r);this.setTransports([]);};d.prototype._hasLock=function(t){var o,e=t.length;while(e--){o=t[e];if(o.locked){return o;}}return null;};d.prototype.setPkg=function(p){if(p&&!this.getProperty("pkg")){this.setProperty("pkg",p);this._oPackage.setValue(p);this._oPackage.setEnabled(false);this._oTransport.setEnabled(true);this.setTitle(this._oResources.getText("TRANSPORT_DIALOG_TITLE_SIMPLE"));this.getButtons()[0].setVisible(false);}};d.prototype.setTransports=function(s){var i,e=0,o;if(s){this.setProperty("transports",s);this._oTransport.removeAllItems();e=s.length;for(i=0;i<e;i++){o=s[i];this._oTransport.addItem(new b({key:o.transportId,text:o.description}));}if(e===1){this._oTransport.setSelectedKey(s[0].transportId);this.getButtons()[1].setEnabled(true);}if(e>0){this._oTransport.setEnabled(true);}}};d.prototype.setLrepObject=function(o){if(o&&!this.getProperty("lrepObject")){this.setProperty("lrepObject",o);}};d.prototype.setHidePackage=function(h){this.setProperty("hidePackage",h);this._oPackage.setVisible(!h);this._oPackageLabel.setVisible(!h);if(h){this.getButtons()[0].setEnabled(h);this.setTitle(this._oResources.getText("TRANSPORT_DIALOG_TITLE_SIMPLE"));}};return d;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.transport.TransportSelection')){jQuery.sap.declare('sap.ui.comp.transport.TransportSelection');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.fl.Utils');jQuery.sap.require('sap.ui.fl.Transports');jQuery.sap.require('sap.ui.fl.registry.Settings');sap.ui.define("sap/ui/comp/transport/TransportSelection",["jquery.sap.global","sap/ui/fl/Utils","sap/ui/fl/Transports","sap/ui/comp/transport/TransportDialog","sap/ui/fl/registry/Settings"],function(q,U,T,a,F){"use strict";var b=function(){this.oTransports=new sap.ui.fl.Transports();this.oUtils=sap.ui.fl.Utils;};b.prototype.selectTransport=function(o,O,e,c,C){var s,p;var t=this;if(o){var l=U.getCurrentLayer(false);if(C){s=U.getComponentClassName(C);var p={appDescriptor:U.getAppDescriptor(C),siteId:U.getSiteId(C)};}if(s&&l&&l==='CUSTOMER'){F.getInstance(s,p).then(function(S){if(S.isAtoEnabled()){var d={transportId:"ATO_NOTIFICATION"};O(t._createEventObject(o,d));}else{t._selectTransport(o,O,e,c);}});}else{t._selectTransport(o,O,e,c);}}};b.prototype._selectTransport=function(o,O,e,c){var p,t=this;if(o){p=this.oTransports.getTransports(o);p.then(function(r){var d;if(t._checkDialog(r)){t._openDialog({hidePackage:!t.oUtils.doesSharedVariantRequirePackage(),pkg:o["package"],transports:r.transports,lrepObject:t._toLREPObject(o)},O,e,c);}else{d=t._getTransport(r);O(t._createEventObject(o,d));}},function(r){e(r);});}};b.prototype._createEventObject=function(o,t){return{mParameters:{selectedTransport:t.transportId,selectedPackage:o["package"],dialog:false},getParameters:function(){return this.mParameters;},getParameter:function(n){return this.mParameters[n];}};};b.prototype._toLREPObject=function(o){var O={};if(o.namespace){O.namespace=o.namespace;}if(o.name){O.name=o.name;}if(o.type){O.type=o.type;}return O;};b.prototype._openDialog=function(c,o,e,C){var d=new a(c);d.attachOk(o);d.attachCancel(e);if(C){d.addStyleClass("sapUiSizeCompact");}else{d.removeStyleClass("sapUiSizeCompact");}d.open();return d;};b.prototype._getTransport=function(t){var o;if(!t.localonly){o=this._hasLock(t.transports);}else{o={transportId:""};}return o;};b.prototype._checkDialog=function(t){if(t){if(t.localonly||this._hasLock(t.transports)){return false;}}return true;};b.prototype._hasLock=function(t){var o,l=t.length;while(l--){o=t[l];if(o.locked){return o;}}return false;};return b;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.valuehelpdialog.ValueHelpDialog')){jQuery.sap.declare('sap.ui.comp.valuehelpdialog.ValueHelpDialog');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.m.Dialog');jQuery.sap.require('sap.m.MessageBox');jQuery.sap.require('sap.m.MultiInput');jQuery.sap.require('sap.m.Token');jQuery.sap.require('sap.ui.core.Control');jQuery.sap.require('sap.ui.core.format.DateFormat');jQuery.sap.require('sap.ui.core.format.NumberFormat');jQuery.sap.require('sap.m.VBox');jQuery.sap.require('sap.m.HBox');jQuery.sap.require('sap.m.ButtonType');jQuery.sap.require('sap.m.DialogRenderer');sap.ui.define("sap/ui/comp/valuehelpdialog/ValueHelpDialog",['jquery.sap.global','sap/m/Dialog','sap/m/MessageBox','sap/m/MultiInput','sap/m/Token','sap/ui/comp/library','./ItemsCollection','sap/ui/core/Control','sap/ui/core/format/DateFormat','sap/ui/core/format/NumberFormat','sap/m/VBox','sap/m/HBox','sap/m/ButtonType','sap/ui/comp/util/FormatUtil','sap/m/DialogRenderer'],function(q,D,M,a,T,l,I,C,b,N,V,H,B,F,c){"use strict";var d=D.extend("sap.ui.comp.valuehelpdialog.ValueHelpDialog",{metadata:{library:"sap.ui.comp",properties:{basicSearchText:{type:"string",group:"Misc",defaultValue:null},supportMultiselect:{type:"boolean",group:"Misc",defaultValue:true},supportRanges:{type:"boolean",group:"Misc",defaultValue:false},supportRangesOnly:{type:"boolean",group:"Misc",defaultValue:false},key:{type:"string",group:"Misc",defaultValue:null},keys:{type:"string[]",group:"Misc",defaultValue:null},descriptionKey:{type:"string",group:"Misc",defaultValue:null},maxIncludeRanges:{type:"string",group:"Misc",defaultValue:'-1'},maxExcludeRanges:{type:"string",group:"Misc",defaultValue:'-1'},displayFormat:{type:"string",group:"Misc",defaultValue:null},tokenDisplayBehaviour:{type:"string",group:"Misc",defaultValue:null},filterMode:{type:"boolean",group:"Misc",defaultValue:false}},aggregations:{filterBar:{type:"sap.ui.comp.filterbar.FilterBar",multiple:false}},events:{ok:{parameters:{tokens:{type:"sap.m.Token[]"}}},cancel:{},selectionChange:{parameters:{tableSelectionParams:{type:"object"},updateTokens:{type:"object[]"},useDefault:{type:"boolean",defaultValue:false}}},tokenRemove:{parameters:{tokenKeys:{type:"string[]"},useDefault:{type:"boolean",defaultValue:false}}},updateSelection:{parameters:{tokenKeys:{type:"string[]"},useDefault:{type:"boolean",defaultValue:false}}}}},renderer:c.render});d.prototype.setSupportMultiselect=function(e){this.setProperty("supportMultiselect",e);this._updatePropertySupportMultiselect(e);this._oTokenizerGrid.setVisible(e);this._oButtonOk.setVisible(e);return this;};d.prototype._updatePropertySupportMultiselect=function(e){if(!this._oTable){return;}if(!this._isPhone()){if(this._oTable.setSelectionMode){this._oTable.setSelectionMode(e?sap.ui.table.SelectionMode.MultiToggle:sap.ui.table.SelectionMode.Single);}}else{if(this._oTable.setMode){this._oTable.setMode(e?sap.m.ListMode.MultiSelect:sap.m.ListMode.SingleSelectLeft);}}return this;};d.prototype.setSupportRanges=function(e){this.setProperty("supportRanges",e);this._updateNavigationControl();return this;};d.prototype.setSupportRangesOnly=function(e){this.setProperty("supportRangesOnly",e);this._updateNavigationControl();return this;};d.prototype.setTitle=function(t){this.setProperty("title",t);this._updateDlgTitle();};d.prototype.setFilterBar=function(o){this.setAggregation("filterBar",o);var g=this._oTableGrid;if(g&&o){if(this._isPhone()){if(this._oFilterBar){this._oVBox.removeItem(this._oFilterBar);}}else{if(this._oFilterBar){g.removeContent(this._oFilterBar);}}this._oFilterBar=o;if(this._oFilterBar){this._oFilterBar.addStyleClass("compVHSearch");if(this._isPhone()){var s=sap.ui.getCore().byId(this._oFilterBar.getBasicSearch());if(s instanceof sap.m.SearchField){s.setShowSearchButton(true);s.attachSearch(q.proxy(function(E){if(E.mParameters.refreshButtonPressed!==undefined){this.getFilterBar().search();}},this));}this._oFilterBar.setShowGoOnFB(false);this._oColSearchBox.setLayoutData(new sap.m.FlexItemData({shrinkFactor:0}));this._oVBox.insertItem(this._oColSearchBox,0);this._oFilterBar.setLayoutData(new sap.m.FlexItemData({shrinkFactor:0}));this._oVBox.insertItem(this._oFilterBar,1);this._oFilterBar.attachSearch(q.proxy(function(E){this._updateView(sap.ui.comp.valuehelpdialog._ValueHelpViewMode.PHONE_LIST_VIEW);},this));if(this._currentViewMode===sap.ui.comp.valuehelpdialog._ValueHelpViewMode.PHONE_LIST_VIEW){this._oFilterBar.setVisible(true);this._oFilterBar.setFilterBarExpanded(false);this._oFilterBar._handleVisibilityOfToolbar();var S=this._oFilterBar.getFilterGroupItems()&&this._oFilterBar.getFilterGroupItems().length>0;this._oAdvancedSearchLink.setVisible(S);}}else{this._oFilterBar._setCollectiveSearch(this._oColSearchBox);g.insertContent(this._oFilterBar,0);}}if(this._oFilterBar._oBasicSearchField){var e=this._oFilterBar._oBasicSearchField;e.setValue(this.getBasicSearchText());this.setInitialFocus(e);}}};d.prototype.getFilterBar=function(){return this._oFilterBar;};d.prototype.setBasicSearchText=function(t){this.setProperty("basicSearchText",t);if(this._oFilterBar&&this._oFilterBar._oBasicSearchField){this._oFilterBar._oBasicSearchField.setValue(t);}};d.prototype.setTokens=function(t){if(t.length){var n=0,k;for(var i=0;i<t.length;i++){var e=t[i];if(e.data("range")){var r=e.data("range");k=e.getKey();if(!k){k="range_"+n;n++;}var f=this._getFormatedRangeTokenText(r.operation,r.value1,r.value2,r.exclude,r.keyField);this._addToken2Tokenizer(k,f,r.exclude?this._oExcludedTokens:this._oSelectedTokens);this._oSelectedRanges[k]=r;}else{k=e.getKey();var s=e.getText();var L=e.data("longKey");var R=e.data("row");if(!L){L=k;}this._oSelectedItems.add(L,R?R:e.getText());this._oSelectedTokens.addToken(new T({key:L,text:s,tooltip:s}));}}}else{this._oSelectedItems.removeAll();this._oSelectedRanges={};}};d.prototype.open=function(){this.bCollectiveSearchActive=this.oSelectionTitle.getVisible()&&this.oSelectionButton.getVisible();if(this._oColSearchBox){this._oColSearchBox.setVisible(this.bCollectiveSearchActive);}if(!this._isPhone()){if(this.getSupportRangesOnly()||this.getFilterMode()){this._updateView(sap.ui.comp.valuehelpdialog._ValueHelpViewMode.DESKTOP_CONDITIONS_VIEW);}else{if(!this._oTable){this._createDefaultTable();}}this.setContentWidth(this._getDefaultContentWidth());}else{if(!this._oTable){this._createDefaultTable();}this._updateView(sap.ui.comp.valuehelpdialog._ValueHelpViewMode.PHONE_MAIN_VIEW);}D.prototype.open.apply(this);};d.prototype.getTable=function(){if(!this._oTable){this._createDefaultTable();}return this._oTable;};d.prototype.setTable=function(t){if(t instanceof sap.ui.comp.smarttable.SmartTable){this._oTable=t.getTable();}else{this._oTable=t;}this.theTable=this._oTable;this._initializeTable();this._oTableGrid.addContent(t);};d.prototype._getDefaultContentWidth=function(){var n=0;if(this._oTable){n=this._oTable.getColumns().length;}var e=Math.max(1080,n*130);return e+"px";};d.prototype.resetTableState=function(){if(this._oTable){if(this._oTable.unbindRows){this._oTable.unbindRows();}this._oTable.setNoDataText(this._oRb.getText("VALUEHELPDLG_TABLE_PRESSSEARCH"));}};d.prototype.TableStateSearchData=function(){if(this._oTable){this._oTable.setNoDataText(this._oRb.getText("VALUEHELPDLG_TABLE_PRESSSEARCH"));}};d.prototype.TableStateDataFilled=function(){if(this._oTable){this._oTable.setNoDataText(this._oRb.getText("VALUEHELPDLG_TABLE_NODATA"));}};d.prototype.TableStateDataSearching=function(){if(this._oTable){this._oTable.setNoDataText(this._oRb.getText("VALUEHELPDLG_TABLE_SEARCHING"));}};d.prototype.init=function(){D.prototype.init.apply(this);this._aIncludeRangeOperations={};this._aExcludeRangeOperations={};this.setStretch(this._isPhone());this.setResizable(!this._isPhone());this.setDraggable(!this._isPhone());this.bCollectiveSearchActive=false;this.addStyleClass("compValueHelpDialog");this._oRb=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");this._sTableTitle1=this._oRb.getText("VALUEHELPDLG_TABLETITLE1");this._sTableTitle2=this._oRb.getText("VALUEHELPDLG_TABLETITLE2");this._sTableTitleNoCount=this._oRb.getText("VALUEHELPDLG_TABLETITLENOCOUNT");this._currentViewMode=null;this._oSelectedItems=new I();this._oSelectedRanges={};this._createHeaderBar();this._createCollectiveSearch();this._createTokenizer();this._updateTokenizer();this._oVBox=new V({fitContainer:true});this.addContent(this._oVBox);this._oTableGrid=new sap.ui.layout.Grid({width:"100%",defaultSpan:"L12 M12 S12",vSpacing:0,hSpacing:0,content:[this._oFilterBar]});this._oMainGrid=new sap.ui.layout.Grid({width:"100%",defaultSpan:"L12 M12 S12",vSpacing:0,hSpacing:0,content:[this._oTableGrid]});this._createNavigationControl();this._updateNavigationControl();this._oMainGrid.setLayoutData(new sap.m.FlexItemData({growFactor:1,shrinkFactor:0}));this._oVBox.addItem(this._oMainGrid);if(this.getMaxIncludeRanges()==="-1"&&this.getMaxExcludeRanges()!=="0"&&!this.getFilterMode()){this._oVBox.addItem(this._oTokenizerGrid);}this._createFooterControls();this.setVerticalScrolling(false);this.setHorizontalScrolling(false);if(!sap.ui.Device.system.desktop){this._oVBox.attachBrowserEvent("touchmove",function(e){e.setMarked();});}if(!this._isPhone()){this._updateView(sap.ui.comp.valuehelpdialog._ValueHelpViewMode.DESKTOP_LIST_VIEW);}};d.prototype._updateView=function(n){if(this._currentViewMode===n){return;}switch(n){case sap.ui.comp.valuehelpdialog._ValueHelpViewMode.DESKTOP_LIST_VIEW:this._validateRanges(q.proxy(function(){this._oTokenizerGrid.setVisible(this.getSupportMultiselect());this._oMainGrid.removeAllContent();if(this._oTabBar&&this._oTabBar.getSelectedKey()!==sap.ui.comp.valuehelpdialog._ValueHelpViewMode.DESKTOP_LIST_VIEW){this._oTabBar.setSelectedKey(sap.ui.comp.valuehelpdialog._ValueHelpViewMode.DESKTOP_LIST_VIEW);}this._oMainGrid.addContent(this._oTableGrid);this._updateDlgTitle();},this),q.proxy(function(){this._oTabBar.setSelectedKey(sap.ui.comp.valuehelpdialog._ValueHelpViewMode.DESKTOP_CONDITIONS_VIEW);this._updateView(sap.ui.comp.valuehelpdialog._ValueHelpViewMode.DESKTOP_CONDITIONS_VIEW);},this));break;case sap.ui.comp.valuehelpdialog._ValueHelpViewMode.DESKTOP_CONDITIONS_VIEW:if(this.getSupportRanges()){this.bCollectiveSearchActive=this.oSelectionTitle.getVisible()&&this.oSelectionButton.getVisible();this._oMainGrid.removeAllContent();if(this._oTabBar&&this._oTabBar.getSelectedKey()!==sap.ui.comp.valuehelpdialog._ValueHelpViewMode.DESKTOP_CONDITIONS_VIEW){this._oTabBar.setSelectedKey(sap.ui.comp.valuehelpdialog._ValueHelpViewMode.DESKTOP_CONDITIONS_VIEW);}this._oMainGrid.addContent(this._getRanges());this._oButtonOk.setVisible(this.getSupportRangesOnly()||this.getSupportMultiselect());this._oTokenizerGrid.setVisible(this.getSupportMultiselect());if(!(this.getMaxIncludeRanges()==="-1"&&this.getMaxExcludeRanges()!=="0"&&!this.getFilterMode())){this._oTokenizerGrid.setVisible(false);}}break;case sap.ui.comp.valuehelpdialog._ValueHelpViewMode.PHONE_MAIN_VIEW:this.setVerticalScrolling(false);this._oColSearchBox.setVisible(false);this._oMainListMenu.setVisible(true);this._updateNavigationControl();this._oAdvancedSearchLink.setVisible(false);if(this._oFilterBar){this._oFilterBar.setVisible(false);this._oFilterBar.setFilterBarExpanded(false);}this._oTable.setVisible(false);this._oTokenizerGrid.setVisible(this.getSupportMultiselect());if(!(this.getMaxIncludeRanges()==="-1"&&this.getMaxExcludeRanges()!=="0"&&!this.getFilterMode())){this._oTokenizerGrid.setVisible(false);}if(this._oRanges){this._oRanges.setVisible(false);}this._oButtonGo.setVisible(false);this._oButtonClear.setVisible(false);this._oButtonOk.setVisible(true);this._oButtonCancel.setVisible(true);this._oBackButton.setVisible(false);this._bNoneMainView=false;if(!this._oTokenizerGrid.getVisible()&&!(this._oSelectItemLI.getVisible()&&this._oDefineConditionsLI.getVisible())){this._bNoneMainView=true;if(this._oSelectItemLI.getVisible()){this._updateView(sap.ui.comp.valuehelpdialog._ValueHelpViewMode.PHONE_LIST_VIEW);}if(this._oDefineConditionsLI.getVisible()){this._updateView(sap.ui.comp.valuehelpdialog._ValueHelpViewMode.PHONE_CONDITIONS_VIEW);}return;}break;case sap.ui.comp.valuehelpdialog._ValueHelpViewMode.PHONE_LIST_VIEW:this.setVerticalScrolling(true);this._oColSearchBox.setVisible(this.bCollectiveSearchActive);this._oMainListMenu.setVisible(false);var u=function(){var s=this._oFilterBar&&this._oFilterBar.getFilterGroupItems()&&this._oFilterBar.getFilterGroupItems().length>0;this._oAdvancedSearchLink.setVisible(s);this._oFilterBar.setShowGoButton(!(this._oFilterBar&&this._oFilterBar.getBasicSearch()));}.bind(this);u();if(this._oFilterBar&&this._oFilterBar.attachInitialise){this._oFilterBar.detachInitialise(u);this._oFilterBar.attachInitialise(u);}if(this._oFilterBar){this._oFilterBar.setVisible(true);this._oFilterBar.setFilterBarExpanded(false);}this._oTable.setVisible(true);this._oTokenizerGrid.setVisible(false);if(this._oRanges){this._oRanges.setVisible(false);}this._oButtonGo.setVisible(false);this._oButtonClear.setVisible(false);this._oButtonOk.setVisible(this.getSupportMultiselect());this._oButtonCancel.setVisible(true);this._oBackButton.setVisible(!this._bNoneMainView);break;case sap.ui.comp.valuehelpdialog._ValueHelpViewMode.PHONE_SEARCH_VIEW:this.setVerticalScrolling(true);this._oColSearchBox.setVisible(false);this._oMainListMenu.setVisible(false);if(this._oFilterBar){this._oFilterBar.setVisible(true);this._oFilterBar.setFilterBarExpanded(true);}this._oAdvancedSearchLink.setVisible(false);this._oTable.setVisible(false);this._oTokenizerGrid.setVisible(false);if(this._oRanges){this._oRanges.setVisible(false);}this._oButtonGo.setVisible(true);this._oButtonClear.setVisible(true);this._oButtonOk.setVisible(false);this._oButtonCancel.setVisible(true);this._oBackButton.setVisible(true);break;case sap.ui.comp.valuehelpdialog._ValueHelpViewMode.PHONE_CONDITIONS_VIEW:this.setVerticalScrolling(true);this._oColSearchBox.setVisible(false);this._oMainListMenu.setVisible(false);if(this._oFilterBar){this._oFilterBar.setVisible(false);}this._oAdvancedSearchLink.setVisible(false);this._oTable.setVisible(false);this._oTokenizerGrid.setVisible(false);if(!this._oRanges){this._oMainGrid.addContent(this._getRanges());}this._oRanges.setVisible(true);this._oButtonGo.setVisible(false);this._oButtonClear.setVisible(false);this._oButtonOk.setVisible(true);this._oButtonCancel.setVisible(true);this._oBackButton.setVisible(!this._bNoneMainView);break;default:break;}if(this._oMainListMenu&&this._oVBox){if(this._oFilterBar){this._oFilterBar._handleVisibilityOfToolbar();}this._oVBox.rerender();}this._currentViewMode=n;this._updateDlgTitle();};d.prototype._changeTableRowSelectionForKey=function(k,s){var i;var t=this._oTable;this._bIgnoreSelectionChange=true;if(sap.ui.table.Table&&t instanceof sap.ui.table.Table){var r=t.getBinding("rows");if(r){if(r.aKeys){for(i=0;i<r.aKeys.length;i++){if(r.aKeys[i]===k){if(s){t.addSelectionInterval(i,i);}else{t.removeSelectionInterval(i,i);}break;}}}else{this.oRows=t.getBinding("rows");if(this.oRows.aIndices){for(i=0;i<this.oRows.aIndices.length;i++){var o=t.getContextByIndex(this.oRows.aIndices[i]);if(o){var R=o.getObject();if(R[this.getKey()]===k){if(s){t.addSelectionInterval(i,i);}else{t.removeSelectionInterval(i,i);}break;}}}}}}}else{for(i=0;i<t.getItems().length;i++){var e=t.getItems()[i];var f=e.getBindingContext().getObject();if(f[this.getKey()]===k){t.setSelectedItem(e,s);break;}}}this._bIgnoreSelectionChange=false;};d.prototype.update=function(){var i,j,r,o;var e=this._oSelectedItems.getItems();var f={tokenKeys:e,useDefault:false};this._bIgnoreSelectionChange=true;if(this._hasListeners("updateSelection")){this.fireUpdateSelection(f);}else{f.useDefault=true;}if(f.useDefault){if(sap.ui.table.Table&&this._oTable instanceof sap.ui.table.Table){this.oRows=this._oTable.getBinding("rows");this._oTable.clearSelection();if(this.oRows.aKeys){var k=this.getKeys();var R=k&&k.length>1?this.getKey()+"=":"";for(j=0;j<e.length;j++){var K=e[j];var s=R+"'"+K+"'";for(i=0;i<this.oRows.aKeys.length;i++){var g=this.oRows.aKeys[i];var h=g===K;if(h||g.indexOf(s)>=0){if(!h){this._oSelectedItems.remove(K);var t=this._getTokenByKey(K,this._oSelectedTokens);if(t){t.setKey(g);}}o=this._oTable.getContextByIndex(i);if(o){r=o.getObject();this._oSelectedItems.add(g,r);}this._oTable.addSelectionInterval(i,i);break;}}}}else{if(this.oRows.aIndices){this._oTable.clearSelection();for(j=0;j<e.length;j++){var m=e[j];for(i=0;i<this.oRows.aIndices.length;i++){o=this._oTable.getContextByIndex(this.oRows.aIndices[i]);if(o){r=o.getObject();if(r[this.getKey()]===m){this._oSelectedItems.add(r[this.getKey()],r);this._oTable.addSelectionInterval(i,i);break;}}}}}}}else{var n=this._oTable;for(j=0;j<e.length;j++){var K=e[j];for(i=0;i<n.getItems().length;i++){var p=n.getItems()[i];var u=p.getBindingContext().getObject();if(u[this.getKey()]===K){n.setSelectedItem(p,true);break;}}}}}this._bIgnoreSelectionChange=false;this._updateTitles();};d.prototype._createHeaderBar=function(){this._oTitle=new sap.m.Text({wrapping:false}).addStyleClass("compVHTitleText").unbindText();var o=null;if(this._isPhone()){o=new sap.m.Button({visible:false,type:B.Back,press:q.proxy(function(e){if(this._currentViewMode===sap.ui.comp.valuehelpdialog._ValueHelpViewMode.PHONE_SEARCH_VIEW){this._updateView(sap.ui.comp.valuehelpdialog._ValueHelpViewMode.PHONE_LIST_VIEW);}else{this._updateView(sap.ui.comp.valuehelpdialog._ValueHelpViewMode.PHONE_MAIN_VIEW);}},this)});this._oBackButton=o;}this.setCustomHeader(new sap.m.Bar({contentLeft:o,contentMiddle:this._oTitle}));};d.prototype._createCollectiveSearch=function(){this.oSelectionTitle=new sap.m.Text({visible:false,wrapping:false}).addStyleClass("compVHColSearchText");this.oSelectionButton=new sap.m.Button({icon:"sap-icon://arrow-down",type:sap.m.ButtonType.Transparent,visible:false}).addStyleClass("compVHColSearchBtn");this._oColSearchBox=new H({fitContainer:true,visible:this.oSelectionButton.getVisible(),items:[this.oSelectionTitle,this.oSelectionButton]});};d.prototype._createFooterControls=function(){this._oButtonOk=new sap.m.Button({text:this._oRb.getText("VALUEHELPDLG_OK"),press:q.proxy(this._onCloseAndTakeOverValues,this),visible:this.getSupportMultiselect(),layoutData:new sap.m.OverflowToolbarLayoutData({priority:sap.m.OverflowToolbarPriority.NeverOverflow})});this._oButtonCancel=new sap.m.Button({text:this._oRb.getText("VALUEHELPDLG_CANCEL"),press:q.proxy(this._onCancel,this),layoutData:new sap.m.OverflowToolbarLayoutData({priority:sap.m.OverflowToolbarPriority.NeverOverflow})});if(this._isPhone()){this._oButtonGo=new sap.m.Button({text:this._oRb.getText("VALUEHELPDLG_GO"),type:sap.m.ButtonType.Emphasized,press:q.proxy(this._onGo,this),visible:false,layoutData:new sap.m.OverflowToolbarLayoutData({priority:sap.m.OverflowToolbarPriority.NeverOverflow})});this._oButtonClear=new sap.m.Button({text:this._oRb.getText("VALUEHELPDLG_CLEAR"),press:q.proxy(this._onClear,this),visible:false,layoutData:new sap.m.OverflowToolbarLayoutData({priority:sap.m.OverflowToolbarPriority.NeverOverflow})});this.addButton(this._oButtonGo);this.addButton(this._oButtonClear);}this.addButton(this._oButtonOk);this.addButton(this._oButtonCancel);};d.prototype._createTokenizer=function(){if(this._oTokenizerGrid){return this._oTokenizerGrid;}this._oSelectedTokenTitle=new sap.m.Text().addStyleClass("compVHSelectedItemsText");this._oSelectedTokens=new sap.m.Tokenizer({tokenChange:q.proxy(function(e){if(this._ignoreRemoveToken){return;}if(e.getParameter("type")===sap.m.MultiInput.TokenChangeType.TokensChanged){var r=e.getParameter("removedTokens");var t=[];var R=[];for(var j=0;j<r.length;j++){var f=r[j];var k=f.getKey();if(this._oSelectedRanges&&this._oSelectedRanges[k]){R.push(k);}else{t.push(k);this._oSelectedItems.remove(k);this._removeTokenFromTokenizer(k,this._oSelectedTokens);}}this._removeRangeByKey(R,false);this._updateTitles();var g={tokenKeys:t,useDefault:false};if(this._hasListeners("tokenRemove")){this._bIgnoreSelectionChange=true;this.fireTokenRemove(g);this._bIgnoreSelectionChange=false;}else{g.useDefault=true;}if(g.useDefault){t.forEach(q.proxy(function(s){this._changeTableRowSelectionForKey(s,false);},this));}if(r.length===1){setTimeout(q.proxy(function(){if(this._oSelectedTokens.getTokens()){var i=this._oSelectedTokens.getTokens().length-1;if(i>=0){this._oSelectedTokens.getTokens()[i].focus();}}},this));}this._updateTitles();}},this)}).addStyleClass("compVHTokensDiv");this._oRemoveAllSelectedItemsBtn=new sap.m.Button({type:sap.m.ButtonType.Transparent,icon:sap.ui.core.IconPool.getIconURI("sys-cancel"),tooltip:this._oRb.getText("VALUEHELPVALDLG_REMOVETOKENS_TOOLTIP"),press:q.proxy(function(){this._oSelectedTokens.destroyTokens();this._removeRangeByKey(Object.keys(this._oSelectedRanges),false);this._oSelectedItems.removeAll();this._bIgnoreSelectionChange=true;if(this._oTable&&this._oTable.clearSelection){this._oTable.clearSelection();}if(this._oTable&&this._oTable.removeSelections){this._oTable.removeSelections();}this._bIgnoreSelectionChange=false;this._updateTitles();this._onResize();},this)}).addStyleClass("compVHRemoveAllBtn");var h=new sap.ui.layout.HorizontalLayout({content:[this._oSelectedTokens,this._oRemoveAllSelectedItemsBtn]}).addStyleClass("compVHTokenizerHLayout");this._oIncludeTokenGrid=new sap.ui.layout.Grid({width:"100%",defaultSpan:"L12 M12 S12",hSpacing:0,vSpacing:0,content:[this._oSelectedTokenTitle,h]});this._oExcludedTokenTitle=new sap.m.Text().addStyleClass("compVHSelectedItemsText");this._oExcludedTokens=new sap.m.Tokenizer({tokenChange:q.proxy(function(e){if(this._ignoreRemoveToken){return;}if(e.getParameter("type")===sap.m.MultiInput.TokenChangeType.TokensChanged){var r=e.getParameter("removedTokens");var t=[];for(var j=0;j<r.length;j++){var f=r[j];var k=f.getKey();if(this._oSelectedRanges&&this._oSelectedRanges[k]){t.push(k);}}this._removeRangeByKey(t,true);this._updateTitles();}},this)}).addStyleClass("compVHTokensDiv");this._oRemoveAllExcludeItemsBtn=new sap.m.Button({type:sap.m.ButtonType.Transparent,icon:sap.ui.core.IconPool.getIconURI("sys-cancel"),tooltip:this._oRb.getText("VALUEHELPVALDLG_REMOVETOKENS_TOOLTIP"),press:q.proxy(function(){this._oExcludedTokens.destroyTokens();this._removeRangeByKey(Object.keys(this._oSelectedRanges),true);this._updateTitles();this._onResize();},this)}).addStyleClass("compVHRemoveAllBtn");var o=new sap.ui.layout.HorizontalLayout({content:[this._oExcludedTokens,this._oRemoveAllExcludeItemsBtn]}).addStyleClass("compVHTokenizerHLayout");this._oExcludeTokenGrid=new sap.ui.layout.Grid({width:"100%",defaultSpan:"L12 M12 S12",hSpacing:0,vSpacing:0,content:[this._oExcludedTokenTitle,o]});this._oTokenizerPanel=new sap.m.Panel({expanded:sap.ui.Device.system.desktop,expandable:true,expandAnimation:true,headerText:"",width:"auto",content:[this._oIncludeTokenGrid,this._oExcludeTokenGrid],expand:q.proxy(function(e){this._updateTokenizer();var t=this;setTimeout(function(){t._onResize();},100);if(e.mParameters.expand&&!(this._oTable instanceof sap.m.Table)){var i="#"+this.getId()+"-scrollCont";var s=this.$().find(i);if(s&&s.scrollTop){s.stop().animate({scrollTop:"1000"},1000);}}},this)}).addStyleClass("compVHBackgroundTransparent").addStyleClass("compVHTokensPanel");if(this._isPhone()){this._oSelectedTokens.addStyleClass("sapMTokenizerMultiLine");this._oExcludedTokens.addStyleClass("sapMTokenizerMultiLine");}this._oTokenizerGrid=new sap.ui.layout.Grid({width:"100%",defaultSpan:"L12 M12 S12",hSpacing:0,vSpacing:0,content:this._oTokenizerPanel}).addStyleClass("compVHDarkBackground");return this._oTokenizerGrid;};d.prototype._addToken2Tokenizer=function(k,t,o){var e=this._getTokenByKey(k,o);var s=(typeof t==="string")?t:"";if(e){e.setText(t);e.setTooltip(s);}else{o.addToken(new T({key:k,text:t,tooltip:s}));this._updateTokenizer();}};d.prototype._getTokenByKey=function(k,t){var e=t.getTokens();for(var i=0;i<e.length;i++){var f=e[i];if(f.getKey()===k){return f;}}return null;};d.prototype._removeToken=function(k){if(!this._removeTokenFromTokenizer(k,this._oSelectedTokens)){this._removeTokenFromTokenizer(k,this._oExcludedTokens);}};d.prototype._removeTokenFromTokenizer=function(k,t){var e=this._getTokenByKey(k,t);if(e){this._ignoreRemoveToken=true;t.removeToken(e);this._ignoreRemoveToken=false;this._updateTokenizer();return true;}return false;};d.prototype._updateTokenizer=function(){var e=false;if(this._oTokenizerPanel){e=this._oTokenizerPanel.getExpanded();this._oSelectedTokenTitle.setVisible(false);}var n=this._oSelectedTokens.getTokens().length;var f=this._oExcludedTokens.getTokens().length;var s=this._oRb.getText("VALUEHELPDLG_SELECTEDITEMS");var g=this._oRb.getText("VALUEHELPDLG_NONESELECTEDITEMS");var S=s.replace("{0}",n.toString());var E=this._oRb.getText("VALUEHELPDLG_EXCLUDEDITEMS",f.toString());var t=n===0?g:S;if(this._oTokenizerPanel){if(!e){if(this._isPhone()){S=this._oRb.getText("VALUEHELPDLG_SELECTEDITEMS_SHORT",n.toString());E=this._oRb.getText("VALUEHELPDLG_EXCLUDEDITEMS_SHORT",f.toString());}t="";if(n!==0){t=S;}if(f!==0){t+=(n!==0?" / ":"")+E;}if(t===""){t=g;}}else{if(n===0&&f!==0){t=E;E="";}}this._oTokenizerPanel.setHeaderText(t);}else{this._oSelectedTokenTitle.setText(t);}this._oRemoveAllSelectedItemsBtn.setEnabled(n!==0);this._oExcludedTokenTitle.setText(E);if(n===0&&f!==0){this._oIncludeTokenGrid.addStyleClass("displayNone");if(!this._isPhone()){this._oExcludedTokenTitle.addStyleClass("displayNone");}}else{this._oIncludeTokenGrid.removeStyleClass("displayNone");this._oExcludedTokenTitle.removeStyleClass("displayNone");}if(f===0){this._oExcludeTokenGrid.addStyleClass("displayNone");}else{this._oExcludeTokenGrid.removeStyleClass("displayNone");}};d.prototype._createNavigationControl=function(){if(!this._isPhone()){this._oTabBar=new sap.m.IconTabBar({upperCase:true,expandable:false,items:[new sap.m.IconTabFilter({visible:true,text:this._oRb.getText("VALUEHELPDLG_ITEMSTABLE"),key:sap.ui.comp.valuehelpdialog._ValueHelpViewMode.DESKTOP_LIST_VIEW}),new sap.m.IconTabFilter({visible:true,text:this._oRb.getText("VALUEHELPDLG_RANGES"),key:sap.ui.comp.valuehelpdialog._ValueHelpViewMode.DESKTOP_CONDITIONS_VIEW})],select:q.proxy(function(o){this._updateView(o.getParameters().key);},this)});this._oTabBar.setLayoutData(new sap.m.FlexItemData({shrinkFactor:0}));this._oVBox.addItem(this._oTabBar);}else{this._oSelectItemLI=new sap.m.StandardListItem({type:sap.m.ListType.Navigation,title:this._oRb.getText("VALUEHELPDLG_ITEMSTABLE")}).data("key",sap.ui.comp.valuehelpdialog._ValueHelpViewMode.PHONE_LIST_VIEW);this._oDefineConditionsLI=new sap.m.StandardListItem({type:sap.m.ListType.Navigation,title:this._oRb.getText("VALUEHELPDLG_RANGES")}).data("key",sap.ui.comp.valuehelpdialog._ValueHelpViewMode.PHONE_CONDITIONS_VIEW);this._oMainListMenu=new sap.m.List({mode:sap.m.ListMode.None,items:[this._oSelectItemLI,this._oDefineConditionsLI],itemPress:q.proxy(function(e){if(e){this._updateView(e.mParameters.listItem.data("key"));}},this)});this._oMainListMenu.setLayoutData(new sap.m.FlexItemData({shrinkFactor:0}));this._oVBox.addItem(this._oMainListMenu);this._oAdvancedSearchLink=new sap.m.Link(sap.ui.comp.valuehelpdialog._ValueHelpViewMode.PHONE_SEARCH_VIEW,{text:this._oRb.getText("VALUEHELPDLG_ADVANCEDSEARCH"),press:q.proxy(function(){this._updateView(sap.ui.comp.valuehelpdialog._ValueHelpViewMode.PHONE_SEARCH_VIEW);},this)}).addStyleClass("compVHAdvancedSearchLink");this._oAdvancedSearchLink.setLayoutData(new sap.m.FlexItemData({shrinkFactor:0}));this._oVBox.addItem(this._oAdvancedSearchLink);}};d.prototype._updateNavigationControl=function(){var L=!this.getSupportRangesOnly();var r=this.getSupportRangesOnly()||this.getSupportRanges();if(this._oTabBar){var t=this._oTabBar.getItems();t[0].setVisible(L);t[1].setVisible(r);this._oTabBar.setVisible(L&&r);this._updateDlgTitle();}if(this._oMainListMenu){this._oSelectItemLI.setVisible(L);this._oDefineConditionsLI.setVisible(r);}};d.prototype._removeRangeByKey=function(k,i){var K=k;if(typeof K==="string"){K=[K];}K.forEach(function(k,e,K){var r=this._oSelectedRanges[k];if(r.exclude===i){if(!r._oGrid){delete this._oSelectedRanges[k];if(this._oFilterPanel){var o=r.exclude?this._oFilterPanel._oExcludeFilterPanel:this._oFilterPanel._oIncludeFilterPanel;if(K.length==1){o.removeCondition(k);}else{o._removeConditionFromMap(k);}}}}},this);if(K.length>1&&this._oFilterPanel){var o=i?this._oFilterPanel._oExcludeFilterPanel:this._oFilterPanel._oIncludeFilterPanel;o._clearConditions();o._fillConditions();}};d.prototype._getRanges=function(){if(!this._oRanges){this._oRanges=this._createRanges();}return this._oRanges;};d.prototype._createRanges=function(){q.sap.require("sap.m.P13nConditionPanel");q.sap.require("sap.m.P13nFilterPanel");this._oFilterPanel=new sap.m.P13nFilterPanel({maxIncludes:this.getMaxIncludeRanges(),maxExcludes:this.getMaxExcludeRanges(),containerQuery:true,addFilterItem:q.proxy(function(E){var p=E.mParameters;var o={exclude:p.filterItemData.getExclude(),keyField:p.filterItemData.getColumnKey(),operation:p.filterItemData.getOperation(),value1:p.filterItemData.getValue1(),value2:p.filterItemData.getValue2()};this._oSelectedRanges[p.key]=o;var f=this._getKeyFieldByKey(o.keyField);o.value1=this._convertValue2Object(o.value1,f.type);o.value2=this._convertValue2Object(o.value2,f.type);this._oFilterPanel.addFilterItem(p.filterItemData);var s=this._getFormatedRangeTokenText(o.operation,o.value1,o.value2,o.exclude,o.keyField);this._addToken2Tokenizer(p.key,s,o.exclude?this._oExcludedTokens:this._oSelectedTokens);this._updateTokenizer();},this),removeFilterItem:q.proxy(function(E){var p=E.mParameters;delete this._oSelectedRanges[p.key];this._removeToken(p.key);this._updateTokenizer();},this),updateFilterItem:q.proxy(function(E){var p=E.mParameters;var o=this._oSelectedRanges[p.key];o.exclude=p.filterItemData.getExclude();o.keyField=p.filterItemData.getColumnKey();o.operation=p.filterItemData.getOperation();o.value1=p.filterItemData.getValue1();o.value2=p.filterItemData.getValue2();var f=this._getKeyFieldByKey(o.keyField);o.value1=this._convertValue2Object(o.value1,f.type);o.value2=this._convertValue2Object(o.value2,f.type);var s=this._getFormatedRangeTokenText(o.operation,o.value1,o.value2,o.exclude,o.keyField);this._addToken2Tokenizer(p.key,s,o.exclude?this._oExcludedTokens:this._oSelectedTokens);this._updateTokenizer();},this)});this._oFilterPanel._oIncludeFilterPanel.setDisplayFormat(this.getDisplayFormat());this._oFilterPanel._oExcludeFilterPanel.setDisplayFormat(this.getDisplayFormat());this._oFilterPanel._oIncludeFilterPanel._sAddRemoveIconTooltipKey="CONDITION";this._oFilterPanel._oExcludeFilterPanel._sAddRemoveIconTooltipKey="CONDITION";if(this._aIncludeRangeOperations){for(var t in this._aIncludeRangeOperations){this._oFilterPanel.setIncludeOperations(this._aIncludeRangeOperations[t],t);}}if(this._aExcludeRangeOperations){for(var t in this._aExcludeRangeOperations){this._oFilterPanel.setExcludeOperations(this._aExcludeRangeOperations[t],t);}}if(this._aRangeKeyFields){this._aRangeKeyFields.forEach(function(i){this._oFilterPanel.addItem(new sap.m.P13nItem({columnKey:i.key,text:i.label,type:i.type,maxLength:i.maxLength,scale:i.scale,precision:i.precision,isDefault:i.isDefault,values:i.type==="boolean"?this._getBooleanValues():null}));},this);}if(this._oSelectedRanges){for(var r in this._oSelectedRanges){var e=this._oSelectedRanges[r];this._oFilterPanel.addFilterItem(new sap.m.P13nFilterItem({key:r,exclude:e.exclude,columnKey:e.keyField,operation:e.operation,value1:e.value1,value2:e.value2}));}}var R=new sap.ui.layout.Grid({width:"100%",defaultSpan:"L12 M12 S12",vSpacing:0,hSpacing:0,content:[this._oFilterPanel]});this._sValidationDialogTitle=this._oRb.getText("VALUEHELPVALDLG_TITLE");this._sValidationDialogMessage=this._oRb.getText("VALUEHELPVALDLG_MESSAGE");this._sValidationDialogFieldMessage=this._oRb.getText("VALUEHELPVALDLG_FIELDMESSAGE");return R;};d.prototype._getBooleanValues=function(){q.sap.require("sap.ui.model.odata.type.Boolean");var o=new sap.ui.model.odata.type.Boolean();var e=null;if(o){e=["",o.formatValue(false,"string"),o.formatValue(true,"string")];}return e;};d.prototype._convertValue2Object=function(v,t){if(!v){return v;}var e=v;if(t==="date"){e=new Date(v);}if(t==="time"){e=new Date(v);}if(t==="numeric"){e=parseFloat(v);}if(t==="boolean"){if(v===""){e=null;}else{e=v=='true';}}return e;};d.prototype._getKeyFieldByKey=function(k){var o;if(this._aRangeKeyFields){this._aRangeKeyFields.some(function(e){if(typeof e!=="string"){if(e.key===k){o=e;return true;}}return false;});}return o;};d.prototype._validateRanges=function(f,e){if(this._oRanges){if(!this._oRanges.getParent()){f();return;}var i=this._oFilterPanel.validateConditions();if(!i){M.show(this._sValidationDialogMessage,{icon:M.Icon.WARNING,title:this._sValidationDialogTitle,actions:[M.Action.OK,M.Action.CANCEL],styleClass:!!this.$().closest(".sapUiSizeCompact").length?"sapUiSizeCompact":"",onClose:function(r){if(r===M.Action.OK&&f){f();}if(r===M.Action.CANCEL&&e){e();}}});return;}}f();};d.prototype.setUpdateSingleRowCallback=function(s){this.fSingleRowCallback=s;this._updateNavigationControl();};d.prototype._createDefaultTable=function(){this._bTableCreatedInternal=true;if(!this._isPhone()){sap.ui.getCore().loadLibrary("sap.ui.table");q.sap.require("sap.ui.table.Table");this.setTable(new sap.ui.table.Table());}else{this.setTable(new sap.m.Table());this.TableStateSearchData();}};d.prototype._initializeTable=function(){if(sap.ui.table.Table&&this._oTable instanceof sap.ui.table.Table){this._oTable.setTitle(sap.ui.Device.system.desktop?this._sTableTitleNoCount:null);if(this._bTableCreatedInternal){this._oTable.setSelectionBehavior(sap.ui.table.SelectionBehavior.Row);}this._oTable.setSelectionMode(this.getSupportMultiselect()?sap.ui.table.SelectionMode.MultiToggle:sap.ui.table.SelectionMode.Single);this._oTable.setNoDataText(this._oRb.getText("VALUEHELPDLG_TABLE_PRESSSEARCH"));this._oTable.setVisibleRowCountMode(sap.ui.table.VisibleRowCountMode.Auto);this._oTable.setMinAutoRowCount(sap.ui.Device.system.desktop?5:4);this._oTable.attachRowSelectionChange(q.proxy(function(o){if(this._bIgnoreSelectionChange||!o.getParameter("userInteraction")){return;}var e={tableSelectionParams:o.mParameters,updateTokens:[],useDefault:false};if(this._hasListeners("selectionChange")){this._bIgnoreSelectionChange=true;this.fireSelectionChange(e);this._bIgnoreSelectionChange=false;e.updateTokens.forEach(q.proxy(function(j){this._addRemoveTokenByKey(j.sKey,j.oRow,j.bSelected);},this));}else{e.useDefault=true;}if(e.useDefault){var t=o.getSource();var f=o.getParameter("rowIndices");var i,n=f.length;var g;var h;var r;for(i=0;i<n;i++){g=f[i];h=t.getContextByIndex(g);r=h?h.getObject():null;if(!r){M.show(this._oRb.getText("VALUEHELPDLG_SELECTIONFAILED"),{icon:M.Icon.ERROR,title:this._oRb.getText("VALUEHELPDLG_SELECTIONFAILEDTITLE"),actions:[M.Action.OK],styleClass:!!this.$().closest(".sapUiSizeCompact").length?"sapUiSizeCompact":""});return;}}var u=false;if(t.getBinding("rows").aKeys){u=true;}for(i=0;i<n;i++){g=f[i];h=t.getContextByIndex(g);r=h?h.getObject():null;if(r){var k;if(u){k=h.sPath.substring(1);}else{k=r[this.getKey()];}this._addRemoveTokenByKey(k,r,t.isIndexSelected(g));}}}this._updateTitles();if(!this.getSupportMultiselect()){this._onCloseAndTakeOverValues();}},this));this._oTable.addStyleClass("compVHMainTable");if(!(this._oTable.getParent()instanceof sap.ui.comp.smarttable.SmartTable)){this._oTable.bindAggregation("columns","columns>/cols",q.proxy(function(i,o){var e,t;if(o.getProperty("type")==="string"){t={path:o.getProperty("template")};}if(o.getProperty("type")==="boolean"){e=new sap.m.CheckBox({enabled:false,selected:{path:o.getProperty("template")}});}else{e=new sap.m.Text({wrapping:false,text:{path:o.getProperty("template"),type:o.getProperty("oType")},tooltip:t});}if(this._oTable instanceof sap.ui.table.AnalyticalTable){return new sap.ui.table.AnalyticalColumn(i,{label:"{columns>label}",tooltip:"{columns>label}",template:e,width:"{columns>width}",hAlign:e instanceof sap.m.CheckBox?sap.ui.core.HorizontalAlign.Center:sap.ui.core.HorizontalAlign.Begin,filterProperty:o.getProperty("filter")});}else{return new sap.ui.table.Column(i,{label:"{columns>label}",tooltip:"{columns>label}",template:e,width:"{columns>width}",hAlign:e instanceof sap.m.CheckBox?sap.ui.core.HorizontalAlign.Center:sap.ui.core.HorizontalAlign.Begin,filterProperty:o.getProperty("filter")});}},this));}}else{this._oTable.setMode(this.getSupportMultiselect()?sap.m.ListMode.MultiSelect:sap.m.ListMode.SingleSelectLeft);this._oTable.setGrowing(true);this._oTable.attachSelectionChange(q.proxy(function(o){if(this._bIgnoreSelectionChange){return;}var e=o.mParameters;var f={tableSelectionParams:o.mParameters,updateTokens:[],useDefault:false};if(this._hasListeners("selectionChange")){this._bIgnoreSelectionChange=true;this.fireSelectionChange(f);this._bIgnoreSelectionChange=false;f.updateTokens.forEach(q.proxy(function(j){this._addRemoveTokenByKey(j.sKey,j.oRow,j.bSelected);},this));}else{f.useDefault=true;}if(f.useDefault){var s=e.selected;var i,n=e.listItems.length;for(i=0;i<n;i++){var g=e.listItems[i];var h=g.getBindingContext();var r=h?h.getObject():null;if(r){var k=r[this.getKey()];this._addRemoveTokenByKey(k,r,s);}}}if(!this.getSupportMultiselect()){this._onCloseAndTakeOverValues();}},this));if(!(this._oTable.getParent()instanceof sap.ui.comp.smarttable.SmartTable)){this._oTable.bindAggregation("columns","columns>/cols",q.proxy(function(i,o){var e=o.getProperty("label");var f=this._oTable.getColumns().length>=2;return new sap.m.Column({header:new sap.m.Label({text:e}),demandPopin:f,minScreenWidth:f?(this._oTable.getColumns().length+1)*10+"rem":"1px"});},this));}}};d.prototype._addRemoveTokenByKey=function(k,r,A){if(A){this._oSelectedItems.add(k,r);this._addToken2Tokenizer(k,this._getFormatedTokenText(k),this._oSelectedTokens);}else{this._oSelectedItems.remove(k);this._removeTokenFromTokenizer(k,this._oSelectedTokens);}};d.prototype._onCloseAndTakeOverValues=function(){var t=this;var f=function(){var r;var e=t._oSelectedItems.getSelectedItemsTokenArray(t.getKey(),t.getDescriptionKey(),t.getTokenDisplayBehaviour());if(t._oSelectedRanges){var i=0;for(var g in t._oSelectedRanges){r=t._oSelectedRanges[g];var s=r.tokenValue;if(!s){s=t._getFormatedRangeTokenText(r.operation,r.value1,r.value2,r.exclude,r.keyField);}if(!r._oGrid||r._oGrid.select.getSelected()){e.push(new T({key:"range_"+i,text:s,tooltip:typeof s==="string"?s:null}).data("range",{"exclude":r.exclude,"operation":r.operation,"keyField":r.keyField,"value1":r.value1,"value2":r.value2}));i++;}}}t.fireOk({"tokens":e});};this._validateRanges(f);};d.prototype._onCancel=function(){this.fireCancel();};d.prototype._onGo=function(){this._oFilterBar.search();};d.prototype._onClear=function(){this._oFilterBar.clear();};d.prototype._updateTitles=function(){this._updateTableTitle();this._updateTokenizer();};d.prototype._updateDlgTitle=function(){var m="";var s;if(this._oTitle){if(this._oTabBar&&!this._oTabBar.getVisible()&&!this.getFilterMode()){if(this._oTabBar.getSelectedKey()===sap.ui.comp.valuehelpdialog._ValueHelpViewMode.DESKTOP_LIST_VIEW){m="VALUEHELPDLG_TITLE";}else{if(this._oTabBar.getSelectedKey()===sap.ui.comp.valuehelpdialog._ValueHelpViewMode.DESKTOP_CONDITIONS_VIEW){if(this.getMaxIncludeRanges()==="1"&&this.getMaxExcludeRanges()==="0"){m="VALUEHELPDLG_SINGLECONDITION_TITLE";}else{m="VALUEHELPDLG_RANGESTITLE";}}}}else{if(this._isPhone()&&!this.getFilterMode()){switch(this._currentViewMode){case sap.ui.comp.valuehelpdialog._ValueHelpViewMode.PHONE_MAIN_VIEW:m="";break;case sap.ui.comp.valuehelpdialog._ValueHelpViewMode.PHONE_LIST_VIEW:m="VALUEHELPDLG_ITEMSTABLE";break;case sap.ui.comp.valuehelpdialog._ValueHelpViewMode.PHONE_SEARCH_VIEW:m="VALUEHELPDLG_ADVANCEDSEARCH";break;case sap.ui.comp.valuehelpdialog._ValueHelpViewMode.PHONE_CONDITIONS_VIEW:if(this.getMaxIncludeRanges()==="1"&&this.getMaxExcludeRanges()==="0"){m="VALUEHELPDLG_SINGLECONDITION_TITLE";}else{m="VALUEHELPDLG_RANGES";}break;default:break;}}}if(!s){s=this.getTitle();}if(m){s=this._oRb.getText(m,s);}if(s){this._oTitle.setText(s);}}};d.prototype._updateTableTitle=function(){if(!this._oTable){return;}var e=0;this.oRows=this._oTable.getBinding("rows");var s=false;if(s&&this.getModel()&&this.getModel().isCountSupported){s=this.getModel().isCountSupported();}if(s){if(this.oRows){e=this.oRows.getLength();}this._setTableTitle(this._sTableTitle1.replace("{0}",e));}else{this._setTableTitle(this._sTableTitleNoCount);}};d.prototype._setTableTitle=function(t){if(sap.ui.Device.system.desktop&&!(this._oTable instanceof sap.m.Table)){if(this._oTable.getTitle()){this._oTable.getTitle().setText(t);}else{this._oTable.setTitle(t);}}};d.prototype.onAfterRendering=function(){D.prototype.onAfterRendering.apply(this);if(this._oTable){this._updateTitles();}if(!this._isPhone()&&this.getContentHeight()===""){var r=this.getDomRef("scroll");var _=r.clientHeight;this.setContentHeight(_+"px");}this._sContainerResizeListener=sap.ui.core.ResizeHandler.register(this._oMainGrid,q.proxy(this._onResize,this));this._onResize();};d.prototype.onBeforeRendering=function(){D.prototype.onBeforeRendering.apply(this);this._cleanup();};d.prototype._cleanup=function(){sap.ui.core.ResizeHandler.deregister(this._sContainerResizeListener);this._sContainerResizeListener=null;};d.prototype._getDialogOffset=function(w){var W=w||this._$Window.width();var s={small:600,large:1024};var r=function(e){var R=parseInt(window.getComputedStyle(document.body).fontSize,10);return(e*R)*2;};var e=1;if(W>s.small&&W<s.large){e=2;}else if(W>=s.large){e=2;}return{top:r(e),left:r(e)};};d.prototype._onResize=function(){if(this._isPhone()||!this._oTabBar||this._oTabBar.getSelectedKey()!==sap.ui.comp.valuehelpdialog._ValueHelpViewMode.DESKTOP_LIST_VIEW){return;}var m=this.getDomRef("scroll").clientHeight;var v=this._oVBox.getDomRef();var t=v.children[0].clientHeight;var i=v.children[2].children.length===0?0:v.children[2].children[0].clientHeight;var o=this._oTableGrid.getDomRef();if(o.children[1]){var f=o.children[0].clientHeight;var n=m-t-i-f-1;var e=sap.ui.Device.system.desktop?360:270;n=Math.max(n,e);o.children[1].style.height=n+"px";}};d.prototype.exit=function(){this._cleanup();var e=function(o){if(o&&o.destroy){o.destroy();}return null;};this._oTokenizerGrid=e(this._oTokenizerGrid);this._oRanges=e(this._oRanges);this._oFilterPanel=e(this._oFilterPanel);if(this._bTableCreatedInternal){this._oTable=e(this._oTable);}this._oTable=null;this.theTable=null;this._oTabBar=e(this._oTabBar);this._oMainListMenu=e(this._oMainListMenu);this._oVBox=e(this._oVBox);this._oVarManagment=e(this._oVarManagment);this._aRangeKeyFields=e(this._aRangeKeyFields);this._aIncludeRangeOperations=e(this._aIncludeRangeOperations);this._aExcludeRangeOperations=e(this._aExcludeRangeOperations);this._oFilterBar=e(this._oFilterBar);this._oRb=e(this._oRb);this._sTableTitle1=e(this._sTableTitle1);this._sTableTitle2=e(this._sTableTitle2);this._sTableTitleNoCount=e(this._sTableTitleNoCount);this._sValidationDialogTitle=e(this._sValidationDialogTitle);this._sValidationDialogMessage=e(this._sValidationDialogMessage);this._sValidationDialogFieldMessage=e(this._sValidationDialogFieldMessage);this._oSelectedItems=e(this._oSelectedItems);this._oSelectedRanges=e(this._oSelectedRanges);this._oButtonOk=e(this._oButtonOk);this._oButtonCancel=e(this._oButtonCancel);if(this._oButtonGo){this._oButtonGo=e(this._oButtonGo);}if(this._oButtonClear){this._oButtonClear=e(this._oButtonClear);}};d.prototype.setRangeKeyFields=function(r){this._aRangeKeyFields=r;};d.prototype.getRangeKeyFields=function(){return this._aRangeKeyFields;};d.prototype.setIncludeRangeOperations=function(o,t){t=t||"default";this._aIncludeRangeOperations[t]=o;if(this._oFilterPanel){this._oFilterPanel.setIncludeOperations(this._aIncludeRangeOperations[t],t);}};d.prototype.setExcludeRangeOperations=function(o,t){t=t||"default";this._aExcludeRangeOperations[t]=o;if(this._oFilterPanel){this._oFilterPanel.setExcludeOperations(this._aExcludeRangeOperations[t],t);}};d.prototype._getFormatedTokenText=function(k){var i=this._oSelectedItems.getItem(k);var t=i[this.getDescriptionKey()];var s=i[this.getKey()];if(t===undefined){if(typeof i==="string"){t=i;}else{t=k;}}else{if(t===""){t=k;}else{t=F.getFormattedExpressionFromDisplayBehaviour(this.getTokenDisplayBehaviour()?this.getTokenDisplayBehaviour():sap.ui.comp.smartfilterbar.ControlConfiguration.DISPLAYBEHAVIOUR.descriptionAndId,s,t);}}return t;};d.prototype._getFormatedRangeTokenText=function(o,v,s,e,k){var t="";var f;var g=this._getKeyFieldByKey(k);if(g){switch(g.type){case"numeric":var h;if(g.precision||g.scale){h={};if(g.precision){h["maxIntegerDigits"]=parseInt(g.precision,10);}if(g.scale){h["maxFractionDigits"]=parseInt(g.scale,10);}}f=N.getFloatInstance(h);break;case"date":f=b.getDateInstance();v=new Date(v);s=new Date(s);break;case"time":f=b.getTimeInstance();v=new Date(v);s=new Date(s);break;case"boolean":var i=this._getBooleanValues();v=i[v?2:1];s=i[s?2:1];break;}if(f){if(v){v=f.format(v);}if(s){s=f.format(s);}}}if(v!==""){switch(o){case sap.ui.comp.valuehelpdialog.ValueHelpRangeOperation.Initial:t="=''";break;case sap.ui.comp.valuehelpdialog.ValueHelpRangeOperation.EQ:t="="+v;break;case sap.ui.comp.valuehelpdialog.ValueHelpRangeOperation.GT:t=">"+v;break;case sap.ui.comp.valuehelpdialog.ValueHelpRangeOperation.GE:t=">="+v;break;case sap.ui.comp.valuehelpdialog.ValueHelpRangeOperation.LT:t="<"+v;break;case sap.ui.comp.valuehelpdialog.ValueHelpRangeOperation.LE:t="<="+v;break;case sap.ui.comp.valuehelpdialog.ValueHelpRangeOperation.Contains:t="*"+v+"*";break;case sap.ui.comp.valuehelpdialog.ValueHelpRangeOperation.StartsWith:t=v+"*";break;case sap.ui.comp.valuehelpdialog.ValueHelpRangeOperation.EndsWith:t="*"+v;break;case sap.ui.comp.valuehelpdialog.ValueHelpRangeOperation.BT:if(s!==""){t=v+"..."+s;break;}}}if(e&&t!==""){t="!("+t+")";}if(this._aRangeKeyFields&&this._aRangeKeyFields.length>1&&g&&g.label&&t!==""){t=g.label+": "+t;}return t;};d.prototype._isPhone=function(){return sap.ui.Device.system.phone;};d.prototype._hasListeners=function(e){if(this._bTableCreatedInternal){return false;}return this.hasListeners(e);};sap.ui.comp.valuehelpdialog.ValueHelpRangeOperation={BT:"BT",EQ:"EQ",Contains:"Contains",StartsWith:"StartsWith",EndsWith:"EndsWith",LT:"LT",LE:"LE",GT:"GT",GE:"GE",Initial:"Initial"};sap.ui.comp.valuehelpdialog._ValueHelpViewMode={DESKTOP_LIST_VIEW:"DESKTOP_LIST_VIEW",DESKTOP_CONDITIONS_VIEW:"DESKTOP_CONDITIONS_VIEW",PHONE_MAIN_VIEW:"PHONE_MAIN_VIEW",PHONE_SEARCH_VIEW:"PHONE_SEARCH_VIEW",PHONE_LIST_VIEW:"PHONE_LIST_VIEW",PHONE_CONDITIONS_VIEW:"PHONE_CONDITIONS_VIEW"};return d;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.variants.EditableVariantItem')){jQuery.sap.declare('sap.ui.comp.variants.EditableVariantItem');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.m.ColumnListItem');jQuery.sap.require('sap.m.ColumnListItemRenderer');sap.ui.define("sap/ui/comp/variants/EditableVariantItem",['jquery.sap.global','sap/m/ColumnListItem','sap/m/ColumnListItemRenderer','sap/ui/comp/library'],function(q,C,a,l){"use strict";var E=C.extend("sap.ui.comp.variants.EditableVariantItem",{metadata:{library:"sap.ui.comp",properties:{key:{type:"string",group:"Misc",defaultValue:null},global:{type:"boolean",group:"Misc",defaultValue:null},lifecyclePackage:{type:"string",group:"Misc",defaultValue:null},lifecycleTransportId:{type:"string",group:"Misc",defaultValue:null},namespace:{type:"string",group:"Misc",defaultValue:null},readOnly:{type:"boolean",group:"Misc",defaultValue:false},accessOptions:{type:"string",group:"Misc",defaultValue:null,deprecated:true},labelReadOnly:{type:"boolean",group:"Misc",defaultValue:false}}},renderer:a.render});return E;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.variants.VariantItem')){jQuery.sap.declare('sap.ui.comp.variants.VariantItem');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.Item');sap.ui.define("sap/ui/comp/variants/VariantItem",['jquery.sap.global','sap/ui/comp/library','sap/ui/core/Item'],function(q,l,I){"use strict";var V=I.extend("sap.ui.comp.variants.VariantItem",{metadata:{library:"sap.ui.comp",properties:{executeOnSelection:{type:"boolean",group:"Misc",defaultValue:false},readOnly:{type:"boolean",group:"Misc",defaultValue:false},lifecycleTransportId:{type:"string",group:"Misc",defaultValue:null},global:{type:"boolean",group:"Misc",defaultValue:null},lifecyclePackage:{type:"string",group:"Misc",defaultValue:null},namespace:{type:"string",group:"Misc",defaultValue:null},accessOptions:{type:"string",group:"Misc",defaultValue:null,deprecated:true},labelReadOnly:{type:"boolean",group:"Misc",defaultValue:false}}}});return V;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.variants.VariantManagement')){
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.ui.comp.variants.VariantManagement');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.Device');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.m.SearchField');jQuery.sap.require('sap.m.RadioButton');jQuery.sap.require('sap.ui.core.TextAlign');jQuery.sap.require('sap.m.ScreenSize');jQuery.sap.require('sap.m.PopinDisplay');jQuery.sap.require('sap.m.Column');jQuery.sap.require('sap.m.Text');jQuery.sap.require('sap.m.Bar');jQuery.sap.require('sap.m.Table');jQuery.sap.require('sap.m.Page');jQuery.sap.require('sap.m.PlacementType');jQuery.sap.require('sap.m.ButtonType');jQuery.sap.require('sap.m.Toolbar');jQuery.sap.require('sap.m.ToolbarSpacer');jQuery.sap.require('sap.m.ActionSheet');jQuery.sap.require('sap.m.Button');jQuery.sap.require('sap.m.CheckBox');jQuery.sap.require('sap.m.Dialog');jQuery.sap.require('sap.m.Input');jQuery.sap.require('sap.m.Label');jQuery.sap.require('sap.m.ResponsivePopover');jQuery.sap.require('sap.m.SelectList');jQuery.sap.require('sap.ui.core.Control');jQuery.sap.require('sap.ui.core.Item');jQuery.sap.require('sap.ui.core.ValueState');jQuery.sap.require('sap.ui.core.VerticalAlign');jQuery.sap.require('sap.ui.layout.HorizontalLayout');jQuery.sap.require('sap.ui.layout.Grid');sap.ui.define("sap/ui/comp/variants/VariantManagement",['jquery.sap.global','sap/ui/Device','sap/ui/model/json/JSONModel','sap/m/SearchField','sap/m/RadioButton','sap/ui/core/TextAlign','sap/m/ScreenSize','sap/m/PopinDisplay','sap/m/Column','sap/m/Text','sap/m/Bar','sap/m/Table','sap/m/Page','sap/m/PlacementType','sap/m/ButtonType','sap/m/Toolbar','sap/m/ToolbarSpacer','sap/m/ActionSheet','sap/m/Button','sap/m/CheckBox','sap/m/Dialog','sap/m/Input','sap/m/Label','sap/m/ResponsivePopover','sap/m/SelectList','sap/ui/comp/library','sap/ui/comp/transport/TransportSelection','./EditableVariantItem','./VariantItem','sap/ui/core/Control','sap/ui/core/Item','sap/ui/core/ValueState','sap/ui/core/VerticalAlign','sap/ui/layout/HorizontalLayout','sap/ui/layout/Grid'],function(q,D,J,S,R,T,a,P,C,b,B,c,d,f,g,h,j,A,k,l,m,I,L,n,o,p,r,E,V,s,t,u,v,H,G){"use strict";var w=s.extend("sap.ui.comp.variants.VariantManagement",{metadata:{library:"sap.ui.comp",properties:{initialSelectionKey:{type:"string",group:"Misc",defaultValue:null},enabled:{type:"boolean",group:"Misc",defaultValue:true},defaultVariantKey:{type:"string",group:"Misc",defaultValue:null},selectionKey:{type:"string",group:"Misc",defaultValue:null},showCreateTile:{type:"boolean",group:"Misc",defaultValue:false},showExecuteOnSelection:{type:"boolean",group:"Misc",defaultValue:false},showShare:{type:"boolean",group:"Misc",defaultValue:false},lifecycleSupport:{type:"boolean",group:"Misc",defaultValue:false},standardItemText:{type:"string",group:"Misc",defaultValue:null},industrySolutionMode:{type:"boolean",group:"Misc",defaultValue:false}},defaultAggregation:"items",aggregations:{items:{type:"sap.ui.core.Item",multiple:true,singularName:"item",deprecated:true},variantItems:{type:"sap.ui.comp.variants.VariantItem",multiple:true,singularName:"variantItem"}},events:{save:{parameters:{name:{type:"string"},overwrite:{type:"boolean"},key:{type:"string"},exe:{type:"boolean"},def:{type:"boolean"},global:{type:"boolean"},lifecyclePackage:{type:"string"},lifecycleTransportId:{type:"string"}}},manage:{parameters:{renamed:{type:"string[]"},deleted:{type:"string[]"},exe:{type:"object[]"},def:{type:"boolean"}}},select:{parameters:{key:{type:"string"}}}}},renderer:function(e,i){e.write("<div ");e.writeControlData(i);e.addClass("sapUiCompVarMngmt");e.writeClasses();e.write(">");e.renderControl(i.oVariantLayout);e.write("</div>");}});w.STANDARD_NAME="STANDARD";w.MAX_NAME_LEN=100;w.prototype.init=function(){var e=this;this.STANDARDVARIANTKEY="*standard*";this.setStandardVariantKey(this.STANDARDVARIANTKEY);this.aRemovedVariants=[];this.aRenamedVariants=[];this.aRemovedVariantTransports=[];this.aExeVariants=[];this.oResourceBundle=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");this.lastSelectedVariantKey=this._sStandardVariantKey;this.bVariantItemMode=false;this.oSelectedItem=null;this.sNewDefaultKey="";this.bDirty=false;this.bManagementTableInitialized=false;this.sTransport=null;this.sPackage=null;this.aEvents=[];this.bEventRunning=false;this.bPopoverOpen=false;this.oVariantSelectionPage=null;this.oActions=null;this.oActionSheet=null;this.oActionSheetManage=null;this.oActionSheetSave=null;this.oActionSheetSaveAs=null;this.bManualVariantKey=false;this.bFireSelect=false;this.bExecuteOnSelectForStandard=false;this._isVendorLayer=false;this.oModel=new J({enabled:false});this.setModel(this.oModel,"save_enablement");this.oVariantManage=new k(this.getId()+"-manage",{text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_MANAGE"),enabled:false,press:function(){e._openVariantManagementDialog();}});this.oVariantManage.addStyleClass("sapUiHideOnPhone");this.oVariantSave=new k(this.getId()+"-mainsave",{text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_SAVE"),press:function(){var i=e._createEvent("variantSavePressed",e._variantSavePressed);e._addEvent(i);},enabled:false});this.oVariantSave.setModel(this.oModel);this.oVariantSave.addStyleClass("sapUiHideOnPhone");this.oVariantSaveAs=new k(this.getId()+"-saveas",{text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_SAVEAS"),press:function(){e._openSaveAsDialog();}});this.oVariantSaveAs.addStyleClass("sapUiHideOnPhone");this.oVariantText=new L(this.getId()+"-text");this._setStandardText();this.oVariantText.addStyleClass("sapUICompVarMngmtText");this.oVariantText.addStyleClass("sapUICompVarMngmtEnabled");this.oVariantText.addStyleClass("sapMH4Style");if(D.system.phone){this.oVariantText.addStyleClass("sapUICompVarMngmtTextMaxWidth");}this.oVariantModifiedText=new L(this.getId()+"-modified",{visible:false});this.oVariantModifiedText.setText("*");this.oVariantModifiedText.addStyleClass("sapUICompVarMngmtText");this.oVariantModifiedText.addStyleClass("sapUICompVarMngmtModified");this.oVariantModifiedText.addStyleClass("sapUICompVarMngmtEnabled");this.oVariantModifiedText.addStyleClass("sapMH4Style");this.oVariantPopoverTrigger=new k(this.getId()+"-trigger",{type:g.Transparent,icon:"sap-icon://arrow-down",press:function(){e._openVariantSelection();},tooltip:this.oResourceBundle.getText("VARIANT_MANAGEMENT_TRIGGER_TT")});this.oVariantPopoverTrigger.addStyleClass("sapUICompVarMngmtTriggerBtn");this.oVariantText.setLabelFor(this.oVariantPopoverTrigger);this.oVariantLayout=new H({content:[this.oVariantText,this.oVariantModifiedText,this.oVariantPopoverTrigger]});this.oVariantLayout.addStyleClass("sapUICompVarMngmtLayout");this.addDependent(this.oVariantLayout);this.oVariantList=new o(this.getId()+"-list",{selectionChange:function(i){e.lastSelectedVariantKey=this.getSelectedItem().getKey();e._setSelectionByKey(this.getSelectedItem().getKey());e.oVariantPopOver.close();e.bDirty=false;e.oVariantModifiedText.setVisible(false);e.oModel.setProperty("/enabled",false);e.bFireSelect=true;}});this.oVariantList.setNoDataText(this.oResourceBundle.getText("VARIANT_MANAGEMENT_NODATA"));this.oActionSheetManage=new k({text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_MANAGE"),enabled:false,press:function(i){e._openVariantManagementDialog();}});this.oActionSheetSave=new k({text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_SAVE"),enabled:false,press:function(i){var x=e._createEvent("variantSavePressed",e._variantSavePressed);e._addEvent(x);}});this.oActionSheetSaveAs=new k({text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_SAVEAS"),press:function(i){e._openSaveAsDialog();}});this.oActions=new k(this.getId()+"-actions",{text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_ACTIONS"),press:function(){e._createActionSheet();e.oActionSheet.openBy(this);}});this.oActions.addStyleClass("sapUiVisibleOnlyOnPhone");this.oSearchField=new S();this.oSearchField.attachLiveChange(function(i){e._triggerSearch(i);});this._handleArrowUpDown(this.oVariantList,this.oSearchField);this.oVariantSelectionPage=new d(this.getId()+"selpage",{subHeader:new h({content:[this.oSearchField]}),content:[this.oVariantList],footer:new h({content:[new j(this.getId()+"-spacer"),this.oVariantManage,this.oVariantSave,this.oVariantSaveAs,this.oActions]}),showSubHeader:false,showNavButton:false,showHeader:false});this.oVariantPopOver=new n(this.getId()+"-popover",{title:this.oResourceBundle.getText("VARIANT_MANAGEMENT_VARIANTS"),contentWidth:"400px",placement:f.Bottom,content:[this.oVariantSelectionPage],afterOpen:function(){e.bPopoverOpen=true;},afterClose:function(){e.bPopoverOpen=false;if(e.bFireSelect==true){e.bFireSelect=false;setTimeout(function(){e._fireSelectAsync();},0);}},contentHeight:"300px"});this.oVariantPopOver.addStyleClass("sapUICompVarMngmtPopover");this.oInputName=new I(this.getId()+"-name",{liveChange:function(i){e._checkVariantNameConstraints(this,e.oSaveSave);}});this.oLabelName=new L(this.getId()+"-namelabel",{text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_NAME"),required:true});this.oLabelName.setLabelFor(this.oInputName);this.oDefault=new l(this.getId()+"-default",{text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_SETASDEFAULT"),enabled:true,visible:true,width:"100%"});this.oExecuteOnSelect=new l(this.getId()+"-execute",{text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_EXECUTEONSELECT"),enabled:true,visible:false,width:"100%"});this.oCreateTile=new l(this.getId()+"-tile",{text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_CREATETILE"),enabled:true,visible:false,width:"100%"});this.oShare=new l(this.getId()+"-share",{text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_SHARE"),enabled:true,visible:false,select:function(i){var x=e._createEvent("inputfieldChange",e._handleShareSelected);x.args.push(i);e._addEvent(x);},width:"100%"});this.oInputKey=new I(this.getId()+"-key",{liveChange:function(i){e._checkVariantNameConstraints(this);}});this.oLabelKey=new L(this.getId()+"-keylabel",{text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_KEY"),required:true});this.oLabelKey.setLabelFor(this.oInputKey);this.oSaveSave=new k(this.getId()+"-variantsave",{text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_OK"),press:function(){var i=e._createEvent("variantSaveAs",e._handleVariantSaveAs);e._addEvent(i);},enabled:true});this.oSaveDialogOptionsGrid=new G({defaultSpan:"L6 M6 S12"});this.oManagementTable=new c(this.getId()+"-managementTable");this.oManagementSave=new k(this.getId()+"-managementsave",{text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_OK"),enabled:true,press:function(){var i=e._createEvent("managementSave",e._handleManageSavePressed);e._addEvent(i);}});};w.prototype._checkVariantNameConstraints=function(i,e,M){if(!i){return;}var x=i.getValue();x=x.trim();if(x===""){i.setValueState(u.Error);i.setValueStateText(this.oResourceBundle.getText("VARIANT_MANAGEMENT_ERROR_EMPTY"));}else if(x.length>w.MAX_NAME_LEN){i.setValueState(u.Error);i.setValueStateText(this.oResourceBundle.getText("VARIANT_MANAGEMENT_MAX_LEN",[w.MAX_NAME_LEN]));}else{i.setValueState(u.None);i.setValueStateText(null);}if(e){if(i.getValueState()!==u.Error){this._checkIsDuplicate(i,x,M);}if(i.getValueState()===u.Error){e.setEnabled(false);}else{e.setEnabled(true);}}};w.prototype._checkIsDuplicate=function(i,e,M){var F=this._isDuplicate(i,e,M);if(F){i.setValueState(u.Error);i.setValueStateText(this.oResourceBundle.getText("VARIANT_MANAGEMENT_ERROR_DUPLICATE"));}else{i.setValueState(u.None);i.setValueStateText(null);}return F;};w.prototype._isDuplicate=function(i,e,M){if(M){return this._isDuplicateManaged(i,e,M);}else{return this._isDuplicateSaveAs(e);}};w.prototype._isDuplicateManaged=function(e,x,M){var y,z,i;if(M){y=M.getItems();if(y){for(i=0;i<y.length;i++){z=y[i].getCells()[0];if(z===e){continue;}if(z){if(z.getValue&&(x===z.getValue().trim())){return true;}else if(z.getText&&(x===z.getText().trim())){return true;}}}}}return false;};w.prototype._isInErrorStateManaged=function(e,M){var x,y,i;if(M){x=M.getItems();if(x){for(var i=0;i<x.length;i++){var y=x[i].getCells()[0];if(y===e){continue;}if(y&&y.getValueState&&(y.getValueState()===u.Error)){return true;}}}}return false;};w.prototype._isDuplicateSaveAs=function(e){var i=e.trim();var x=this.getStandardItemText().trim();if(x===i){return true;}var y=this._getItems();for(var z=0;z<y.length;z++){x=y[z].getText().trim();if(x===i){return true;}}return false;};w.prototype._createActionSheet=function(){if(!this.oActionSheet){this.oActionSheet=new A(this.getId()+"-actionsheet",{showCancelButton:true,buttons:[this.oActionSheetManage,this.oActionSheetSave,this.oActionSheetSaveAs],placement:f.Top});}};w.prototype._createSaveDialog=function(){var e=this;var i=this.oInputName?this.oInputName.getValue():"";this.oSaveSave.setEnabled(!this._isDuplicate(this.oInputName,i));if(!this.oSaveDialog){this.oSaveDialog=new m(this.getId()+"-savedialog",{title:this.oResourceBundle.getText("VARIANT_MANAGEMENT_SAVEDIALOG"),beginButton:this.oSaveSave,endButton:new k(this.getId()+"-variantcancel",{text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_CANCEL"),press:function(){e.oSaveDialog.close();}}),content:[this.oLabelName,this.oInputName,this.oLabelKey,this.oInputKey,this.oSaveDialogOptionsGrid],stretch:D.system.phone});this.oSaveDialog.setParent(this);this.oSaveDialog.addStyleClass("sapUiPopupWithPadding");this.oSaveDialog.addStyleClass("sapUiCompVarMngmtSaveDialog");}};w.prototype._createManagementDialog=function(){var e=this;if(!this.oManagementDialog){this.oManagementDialog=new m(this.getId()+"-managementdialog",{contentWidth:"600px",customHeader:new B(this.getId()+"-managementHeader",{contentMiddle:[new b(this.getId()+"-managementHeaderText",{text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_MANAGEDIALOG")})]}),beginButton:this.oManagementSave,endButton:new k(this.getId()+"-managementcancel",{text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_CANCEL"),press:function(){e.aRemovedVariants=[];e.oManagementDialog.close();}}),content:[this.oManagementTable],stretch:D.system.phone,afterClose:function(){if(e.bFireSelect==true){e.bFireSelect=false;setTimeout(function(){e._fireSelectAsync();},0);}}});this.oManagementDialog.setParent(this);this.oManagementDialog.addStyleClass("sapUiPopupWithPadding");}};w.prototype._handleArrowUpDown=function(i,x){var y=null;var z=this;i.attachBrowserEvent("keydown",q.proxy(function(e){if(e.which===38){if(z.oVariantSelectionPage.getShowSubHeader()){y=document.activeElement.id;}}},this));i.attachBrowserEvent("keyup",q.proxy(function(e){if(e.which===38){if(y&&(y===document.activeElement.id)){var F=i.getItems();if(F&&F.length>0){var K=sap.ui.getCore().byId(y);if(K===F[0]){x.focus();}}}y=null;}},this));x.attachBrowserEvent("keyup",q.proxy(function(e){if(e.which===40){var F=i.getItems();if(F&&F.length>0){F[0].focus();}}},this));};w.prototype._triggerSearch=function(e){if(!e){return;}var i=e.getParameters();if(!i){return;}this._restoreCompleteList();var x=i.newValue?i.newValue:"";this._triggerSearchByValue(x.toLowerCase());};w.prototype._triggerSearchByValue=function(e){var i,K,x;this.oSelectedVariantItemKey=null;x=this.oVariantList.getItemByKey(this.getStandardVariantKey());if(x&&(x.getText().toLowerCase().indexOf(e)<0)){if(this.getSelectionKey()===K){this.oSelectedVariantItemKey=K;}this.oVariantList.removeItem(x);x.destroy();}var y=this._getItems();for(var z=0;z<y.length;z++){i=y[z].getText();if(i.toLowerCase().indexOf(e)<0){K=y[z].getKey();x=this.oVariantList.getItemByKey(K);if(x){if(this.getSelectionKey()===K){this.oSelectedVariantItemKey=K;}this.oVariantList.removeItem(x);x.destroy();}}}};w.prototype._restoreCompleteList=function(){var i,e,x,y;var z=0;y=this.oVariantList.getItemByKey(this.getStandardVariantKey());if(!y){y=this._createStandardVariantListItem();if(y){this.oVariantList.insertItem(y,0);}}if(y){z=1;if(this.oSelectedVariantItemKey){if(this.oSelectedVariantItemKey===y.getKey()){this.oVariantList.setSelectedItem(y);this.oSelectedVariantItemKey=null;}}else{if(this.getSelectionKey()==y.getKey()||this.getSelectionKey()===null){this.oVariantList.setSelectedItem(y);}}}x=this._getItems();x.sort(this._compareItems);for(i=0;i<x.length;i++){e=x[i];if(e.getKey()===this.getStandardVariantKey()){continue;}y=this.oVariantList.getItemByKey(e.getKey());if(!y){y=this._createVariantListItem(e,i);this.oVariantList.insertItem(y,i+z);}if(this.oSelectedVariantItemKey){if(this.oSelectedVariantItemKey===y.getKey()){this.oVariantList.setSelectedItem(y);this.oSelectedVariantItemKey=null;}}else{if(this.getSelectionKey()==y.getKey()){this.oVariantList.setSelectedItem(y);}}}};w.prototype._determineStandardVariantName=function(){var e=this.oResourceBundle.getText("VARIANT_MANAGEMENT_STANDARD");if(this.bVariantItemMode===false){e=this.oResourceBundle.getText("VARIANT_MANAGEMENT_DEFAULT");}if(this.getStandardVariantKey()===this.STANDARDVARIANTKEY){if(this.getStandardItemText()!==null&&this.getStandardItemText()!=""){e=this.getStandardItemText();}}return e;};w.prototype._createStandardVariantListItem=function(){var i,e=null;var x=this._determineStandardVariantName();if((this.bVariantItemMode===true)||(this.bVariantItemMode===false&&(this.getSelectionKey()===this.getStandardVariantKey()||this.getSelectionKey()===null))){e=new V(this.oVariantPopoverTrigger.getId()+"-item-standard",{key:this.getStandardVariantKey(),text:x,readOnly:true,executeOnSelection:this.bExecuteOnSelectForStandard});if(this._isIndustrySolutionModeAndVendorLayer()&&this.bVariantItemMode){e.setGlobal(true);}if(this.getStandardVariantKey()!==this.STANDARDVARIANTKEY){i=this.getItemByKey(this.getStandardVariantKey());if(i){this._setVariantListItemProperties(i,e);e.setReadOnly(true);}}}return e;};w.prototype._createVariantListItem=function(i,e){var x=new V(this.oVariantPopoverTrigger.getId()+"-item-"+e,{key:i.getKey(),text:i.getText()});this._setVariantListItemProperties(i,x);return x;};w.prototype._setVariantListItemProperties=function(i,e){if(i.getReadOnly){e.setReadOnly(i.getReadOnly());}if(i.getExecuteOnSelection){e.setExecuteOnSelection(i.getExecuteOnSelection());}if(i.getGlobal){e.setGlobal(i.getGlobal());}if(i.getLifecyclePackage){e.setLifecyclePackage(i.getLifecyclePackage());}if(i.getLifecycleTransportId){e.setLifecycleTransportId(i.getLifecycleTransportId());}if(i.getNamespace){e.setNamespace(i.getNamespace());}if(i.getAccessOptions){e.setAccessOptions(i.getAccessOptions());}if(i.getLabelReadOnly){e.setLabelReadOnly(i.getLabelReadOnly());}};w.prototype.exit=function(){if(this.oSearchField){this.oSearchField.destroy();this.oSearchField=undefined;}if(this.oVariantManage){this.oVariantManage.destroy();this.oVariantManage=undefined;}if(this.oVariantSave){this.oVariantSave.destroy();this.oVariantSave=undefined;}if(this.oVariantList){this.oVariantList.destroy();this.oVariantList=undefined;}if(this.oInputName){this.oInputName.destroy();this.oInputName=undefined;}if(this.oLabelName){this.oLabelName.destroy();this.oLabelName=undefined;}if(this.oDefault){this.oDefault.destroy();this.oDefault=undefined;}if(this.oSaveSave){this.oSaveSave.destroy();this.oSaveSave=undefined;}if(this.oSaveDialog){this.oSaveDialog.destroy();this.oSaveDialog=undefined;}if(this.oManagementTable){this.oManagementTable.destroy();this.oManagementTable=undefined;}if(this.oManagementSave){this.oManagementSave.destroy();this.oManagementSave=undefined;}if(this.oManagementDialog){this.oManagementDialog.destroy();this.oManagementDialog=undefined;}if(this.oVariantText){this.oVariantText.destroy();this.oVariantText=undefined;}if(this.oVariantPopoverTrigger){this.oVariantPopoverTrigger.destroy();this.oVariantPopoverTrigger=undefined;}if(this.oVariantLayout){this.oVariantLayout.destroy();this.oVariantLayout=undefined;}if(this.oVariantPopOver){this.oVariantPopOver.destroy();this.oVariantPopOver=undefined;}if(this.oVariantSaveAs){this.oVariantSaveAs.destroy();this.oVariantSaveAs=undefined;}if(this.oShare){this.oShare.destroy();this.oShare=undefined;}if(this.oExecuteOnSelect){this.oExecuteOnSelect.destroy();this.oExecuteOnSelect=undefined;}if(this.oCreateTile){this.oCreateTile.destroy();this.oCreateTile=undefined;}if(this.oSaveDialogOptionsGrid){this.oSaveDialogOptionsGrid.destroy();this.oSaveDialogOptionsGrid=undefined;}if(this.oVariantSelectionPage){this.oVariantSelectionPage.destroy();this.oVariantSelectionPage=undefined;}if(this.oActions){this.oActions.destroy();this.oActions=undefined;}if(this.oActionSheetManage){this.oActionSheetManage.destroy();this.oActionSheetManage=undefined;}if(this.oActionSheetSave){this.oActionSheetSave.destroy();this.oActionSheetSave=undefined;}if(this.oActionSheetSaveAs){this.oActionSheetSaveAs.destroy();this.oActionSheetSaveAs=undefined;}if(this.oInputKey){this.oInputKey.destroy();this.oInputKey=undefined;}if(this.oLabelKey){this.oLabelKey.destroy();this.oLabelKey=undefined;}};w.prototype.addItem=function(i){i=this.validateAggregation("items",i,true);this.bVariantItemMode=false;this.addAggregation("items",i,false);var _=this.getInitialSelectionKey();this._setSelection(i,_);this._manageButtonState();this._setStandardText();return this;};w.prototype.insertItem=function(i,e){var _=e;i=this.validateAggregation("items",i,true);this.bVariantItemMode=false;this.insertAggregation("items",i,_);var x=this.getInitialSelectionKey();this._setSelection(i,x);this._manageButtonState();this._setStandardText();return this;};w.prototype.removeItem=function(i){this.removeAggregation("items",i);this._manageButtonState();return i;};w.prototype.removeAllItems=function(){var e=this.removeAllAggregation("items");this._manageButtonState();this._setSelectedItem(null);return e;};w.prototype.destroyItems=function(){this.destroyAggregation("items");this._manageButtonState();this._setSelectedItem(null);return this;};w.prototype._getItems=function(){if(this.bVariantItemMode){return this.getVariantItems();}else{return this.getItems();}};w.prototype._removeItem=function(i){if(this.bVariantItemMode){return this.removeVariantItem(i);}else{return this.removeItem(i);}};w.prototype.getItemByKey=function(K){var i=this._getItems();for(var e=0;e<i.length;e++){if(K==i[e].getKey()){return i[e];}}return null;};w.prototype.addVariantItem=function(e){e=this.validateAggregation("variantItems",e,true);this.bVariantItemMode=true;this.addAggregation("variantItems",e,false);var _=this.getInitialSelectionKey();this._setSelection(e,_);this._manageButtonState();this._setStandardText();return this;};w.prototype.insertVariantItem=function(e,i){var _=i;e=this.validateAggregation("variantItems",e,true);this.bVariantItemMode=true;this.insertAggregation("variantItems",e,_);var x=this.getInitialSelectionKey();this._setSelection(e,x);this._manageButtonState();this._setStandardText();return this;};w.prototype._setSelectedItem=function(i){this.oSelectedItem=i;if(i!=null){this.oVariantText.setText(i.getText());}else{this._setStandardText();}};w.prototype._getSelectedItem=function(){return this.oSelectedItem;};w.prototype.setInitialSelectionKey=function(K){this.setProperty("initialSelectionKey",K,true);this._setSelectionByKey(K);};w.prototype.setEnabled=function(e){this.setProperty("enabled",e,false);if(this.oVariantPopoverTrigger){this.oVariantPopoverTrigger.setEnabled(e);}if(!e){this.oVariantText.removeStyleClass("sapUICompVarMngmtEnabled");this.oVariantModifiedText.removeStyleClass("sapUICompVarMngmtEnabled");this.oVariantText.addStyleClass("sapUICompVarMngmtDisabled");this.oVariantModifiedText.addStyleClass("sapUICompVarMngmtDisabled");}else{this.oVariantText.removeStyleClass("sapUICompVarMngmtDisabled");this.oVariantModifiedText.removeStyleClass("sapUICompVarMngmtDisabled");this.oVariantText.addStyleClass("sapUICompVarMngmtEnabled");this.oVariantModifiedText.addStyleClass("sapUICompVarMngmtEnabled");}};w.prototype._setSelection=function(i,K){if(i.getKey()===K){this._setSelectedItem(i);this.fireSelect({key:K});}};w.prototype.addStyleClass=function(e){if(s.prototype.addStyleClass){s.prototype.addStyleClass.apply(this,arguments);}if(this.oVariantPopOver){this.oVariantPopOver.addStyleClass(e);}if(this.oSaveDialog){this.oSaveDialog.addStyleClass(e);}if(this.oManagementDialog){this.oManagementDialog.addStyleClass(e);}};w.prototype.removeStyleClass=function(e){if(s.prototype.addStyleClass){s.prototype.removeStyleClass.apply(this,arguments);}if(this.oVariantPopOver){this.oVariantPopOver.removeStyleClass(e);}if(this.oSaveDialog){this.oSaveDialog.removeStyleClass(e);}if(this.oManagementDialog){this.oManagementDialog.removeStyleClass(e);}};w.prototype.clearVariantSelection=function(){this.setInitialSelectionKey(this.getStandardVariantKey());this._setSelectedItem(null);};w.prototype._setDialogCompactStyle=function(e,i){if(this._checkDialogCompactStyle(e)){i.addStyleClass("sapUiSizeCompact");}else{i.removeStyleClass("sapUiSizeCompact");}};w.prototype._checkDialogCompactStyle=function(e){if(e.$().closest(".sapUiSizeCompact").length>0){return true;}else{return false;}};w.prototype._manageButtonState=function(){if(this._getItems()&&this._getItems().length>0){this.oVariantManage.setEnabled(true);this.oActionSheetManage.setEnabled(true);}else{this.oVariantManage.setEnabled(false);this.oActionSheetManage.setEnabled(false);}};w.prototype.getSelectionKey=function(){var K=null;var i=this._getSelectedItem();if(i!==null){K=i.getKey();}else if(this.bVariantItemMode){K=this.getStandardVariantKey();}else{K=null;}return K;};w.prototype._setSelectionByKey=function(K){var i=this._getItems();var F=false;if(i.length>0){for(var e=0;e<i.length;e++){if(i[e].getKey()===K){this._setSelectedItem(i[e]);F=true;break;}}}if(!F){this._setSelectedItem(null);}};w.prototype.replaceKey=function(O,N){var i=this._getItems();if(i.length>0){for(var e=0;e<i.length;e++){if(i[e].getKey()===O){i[e].setKey(N);if(this.getDefaultVariantKey()==O){this.setDefaultVariantKey(N);}if(this._getSelectedItem()===i[e]){this._setSelectedItem(null);}break;}}}};w.prototype.currentVariantSetModified=function(F){if(F){if(!this.bDirty){this.oVariantModifiedText.setVisible(true);this.bDirty=true;this.oModel.setProperty("/enabled",true);}}else if(this.bDirty){this.oVariantModifiedText.setVisible(false);this.bDirty=false;this.oModel.setProperty("/enabled",false);}};w.prototype.currentVariantGetModified=function(){return this.bDirty;};w.prototype._openVariantSelection=function(){var i=null;if(this.bPopoverOpen==true){return;}this.bPopoverOpen=true;this.oVariantList.destroyItems();this.oVariantSave.setEnabled(false);this.oActionSheetSave.setEnabled(false);if(this.bVariantItemMode===false&&this.getSelectionKey()!==null){this.oVariantSave.setEnabled(true);this.oActionSheetSave.setEnabled(true);}i=this._getItems();if(i.length<9){this.oVariantSelectionPage.setShowSubHeader(false);}else{this.oVariantSelectionPage.setShowSubHeader(true);this.oSearchField.setValue("");}this._restoreCompleteList();if(this.bDirty){var e=this.oVariantList.getItemByKey(this.getSelectionKey());if(e){if(!e.getReadOnly()||(this._isIndustrySolutionModeAndVendorLayer()&&(this.getStandardVariantKey()===e.getKey()))){this.oVariantSave.setEnabled(true);this.oActionSheetSave.setEnabled(true);}}}this.oVariantSaveAs.setEnabled(true);if(this._isIndustrySolutionModeAndVendorLayer()&&(this.getStandardVariantKey()===this.getSelectionKey())&&(this.getStandardVariantKey()===this.STANDARDVARIANTKEY)){this.oVariantSaveAs.setEnabled(false);}this._setDialogCompactStyle(this,this.oVariantPopOver);this._manageButtonState();this.oVariantPopOver.setInitialFocus(this.oVariantList.getSelectedItem().getId());this.oVariantPopOver.openBy(this.oVariantPopoverTrigger.$("img")[0]);};w.prototype.onclick=function(e){if(this.getEnabled()){this._openVariantSelection();}};w.prototype.onkeydown=function(e){if(e.which===q.sap.KeyCodes.F4||e.altKey===true&&e.which===q.sap.KeyCodes.ARROW_UP||e.altKey===true&&e.which===q.sap.KeyCodes.ARROW_DOWN){if(this.getEnabled()){this._openVariantSelection();}}};w.prototype._initalizeManagementTableColumns=function(){if(this.bManagementTableInitialized){return;}this.oManagementTable.addColumn(new C({header:new b({text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_NAME")})}));this.oManagementTable.addColumn(new C({header:new b({text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_VARIANTTYPE")}),width:"4rem",demandPopin:true,popinDisplay:P.Inline,minScreenWidth:a.Tablet}));this.oManagementTable.addColumn(new C({header:new b({text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_DEFAULT")}),width:"4rem",demandPopin:true,popinDisplay:P.Inline,minScreenWidth:a.Tablet}));if(this.getShowExecuteOnSelection()){this.oManagementTable.addColumn(new C({header:new b({text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_EXECUTEONSELECT")}),width:"4rem",hAlign:T.Center,demandPopin:true,popinDisplay:P.Inline,minScreenWidth:a.Tablet}));}this.oManagementTable.addColumn(new C({width:"2.5rem",hAlign:T.Center}));this.bManagementTableInitialized=true;};w.prototype._initalizeSaveAsDialog=function(){this.oSaveDialogOptionsGrid.removeAllContent();this.oShare.setVisible(this.getShowShare());this.oExecuteOnSelect.setVisible(this.getShowExecuteOnSelection());this.oCreateTile.setVisible(this.getShowCreateTile());this.oSaveDialogOptionsGrid.addContent(this.oDefault);if(this.getShowShare()){this.oSaveDialogOptionsGrid.addContent(this.oShare);}if(this.getShowExecuteOnSelection()){this.oSaveDialogOptionsGrid.addContent(this.oExecuteOnSelect);}if(this.getShowCreateTile()){this.oSaveDialogOptionsGrid.addContent(this.oCreateTile);}};w.prototype.onBeforeRendering=function(){var e=function(x){var M,N=0;for(var i=0;i<x.length;i++){M=x[i].$().width();if(M>N){N=M;}}return N;};if(this.oSaveDialogOptionsGrid&&this.oSaveDialog&&this.oSaveDialog.getVisible()){var x=this.oSaveDialogOptionsGrid.getContent();if(x&&x.length>0){var y=this.oSaveDialogOptionsGrid.$().width();var z=e(x);var F=32;var K=12;if(!this._checkDialogCompactStyle(this.oSaveDialog)){F=48;K=18;}if((F+z+K)>y/2){this.oSaveDialogOptionsGrid.setDefaultSpan("L12 M12 S12");}}}};w.prototype._variantSavePressed=function(){var i=this._getSelectedItem();if(!i){if(this.getStandardVariantKey()===this.STANDARDVARIANTKEY){i=new V({text:this._determineStandardVariantName(),key:this.STANDARDVARIANTKEY,global:this._isIndustrySolutionModeAndVendorLayer()});}else{i=this.getItemByKey(this.getStandardVariantKey());}}var e=false;if((this.getDefaultVariantKey()===i.getKey())&&(this.getStandardVariantKey()!==this.STANDARDVARIANTKEY)){e=true;}if(i.getLifecyclePackage&&i.getGlobal()==true){var x=this;var O=function(z,F){x.oVariantPopOver.close();x.sPackage=z;x.sTransport=F;x.fireSave({name:i.getText(),overwrite:true,key:i.getKey(),def:e,global:(x._isIndustrySolutionModeAndVendorLayer()&&(x.getStandardVariantKey()===x.getStandardVariantKey())),lifecyclePackage:x.sPackage,lifecycleTransportId:x.sTransport});i.setLifecycleTransportId(x.sTransport);x.bDirty=false;x.oVariantModifiedText.setVisible(false);x.oModel.setProperty("/enabled",false);x._eventDone();};var y=function(z){x.sTransport=null;x.sPackage=null;x._cancelAllEvents();};this._assignTransport(i,O,y,this.oVariantText);}else{this.oVariantPopOver.close();this.fireSave({name:i.getText(),overwrite:true,key:i.getKey(),def:e});this.bDirty=false;this.oVariantModifiedText.setVisible(false);this.oModel.setProperty("/enabled",false);this._eventDone();}};w.prototype._assignTransport=function(e,O,i,x){var y={type:"variant",name:"",namespace:""};y["package"]="";if(e!==null){y["package"]=e.getLifecyclePackage();y["name"]=e.getKey();y["namespace"]=e.getNamespace();}var _=function(M){var N;var F;F=M.getParameters().selectedTransport;N=M.getParameters().selectedPackage;O(N,F);};var z=function(M){i(M);};if(this.getLifecycleSupport()){var F=null;if(e){F=e.getLifecycleTransportId();}if(F!=null&&F.trim().length>0){O(y["package"],F);}else{var K=new r();K.selectTransport(y,_,z,this._checkDialogCompactStyle(x),x);}}else{O(y["package"],"");}};w.prototype.getDefaultVariantKey=function(){var e=this.getProperty("defaultVariantKey");if(e===""){if(this.bVariantItemMode){e=this.getStandardVariantKey();}}return e;};w.prototype._compareItems=function(e,i){var F=e.getText();var x=i.getText();var y=F.toUpperCase();var z=x.toUpperCase();if(y==z){if(F==x){return 0;}if(F<x){return-1;}if(F>x){return 1;}}if(y<z){return-1;}if(y>z){return 1;}};w.prototype._accessOptionsText=function(O){var M=null;switch(O){case"R":M=this.oResourceBundle.getText("VARIANT_MANAGEMENT_WRONG_LAYER");break;case"RD":M=this.oResourceBundle.getText("VARIANT_MANAGEMENT_WRONG_LANGUAGE");break;default:M=null;}return M;};w.prototype._openSaveAsDialog=function(){this._initalizeSaveAsDialog();if(this._getSelectedItem()){this.oInputName.setValue(this._getSelectedItem().getText());}else{this.oInputName.setValue("");}this.oInputName.setEnabled(true);this.oInputName.setValueState(u.None);this.oInputName.setValueStateText(null);this.oDefault.setSelected(false);this.oShare.setSelected(false);this.oCreateTile.setSelected(false);this.oExecuteOnSelect.setSelected(false);this._createSaveDialog();this._setDialogCompactStyle(this,this.oSaveDialog);this.oVariantPopOver.close();this.sTransport=null;this.sPackage=null;if(this.bManualVariantKey){this.oInputKey.setVisible(true);this.oInputKey.setEnabled(true);this.oInputKey.setValueState(u.None);this.oInputKey.setValueStateText(null);this.oLabelKey.setVisible(true);}else{this.oInputKey.setVisible(false);this.oLabelKey.setVisible(false);}this.oSaveDialog.open();};w.prototype._checkManageItemNameChange=function(M){var e="";var i=null;var x=this;i=M.getCells()[0];e=i.getValue();e=e.trim();var y=M;var K=y.getKey();this._checkVariantNameConstraints(i,this.oManagementSave);if(i.getValueState()===u.Error){this.oManagementSave.setEnabled(false);this._eventDone();return;}if(!this._isInErrorStateManaged(i,this.oManagementTable)){this.oManagementSave.setEnabled(true);}if(this.oVariantList.getItemByKey(K).getText().trim()===e){this._eventDone();return;}if(y.getGlobal()){var O=function(F,N){y.setLifecyclePackage(F);y.setLifecycleTransportId(N);x._eventDone();};var z=function(F){var N=x.oVariantList.getItemByKey(K);i.setValue(N.getText());x._cancelAllEvents();};this._createManagementDialog();this._assignTransport(y,O,z,this.oManagementDialog);}else{this._eventDone();}};w.prototype._handleManageSavePressed=function(){var N=this.oManagementTable.getItems();var i;var e=false;var x="";var O=null;var y=0;for(var z=0;z<N.length;z++){i=this.oVariantList.getItemByKey(N[z].getKey());if(N[z].getCells()[0].getValue){x=N[z].getCells()[0].getValue();}if(N[z].getCells()[0].getText){x=N[z].getCells()[0].getText();}x=x.trim();if(i.getText()!==x){this.aRenamedVariants.push({key:i.getKey(),name:x});O=this.getItemByKey(N[z].getKey());O.setText(x);if(O.setLifecyclePackage){O.setLifecyclePackage(N[z].getLifecyclePackage());O.setLifecycleTransportId(N[z].getLifecycleTransportId());}if(this.lastSelectedVariantKey===i.getKey()){this.oVariantText.setText(x);this.bDirty=false;this.oVariantModifiedText.setVisible(false);this.oModel.setProperty("/enabled",false);}}if(this.getShowExecuteOnSelection()&&i.getExecuteOnSelection&&i.getExecuteOnSelection()!=N[z].getCells()[3].getSelected()){var F=N[z].getCells()[3].getSelected();var K=this.getItemByKey(N[z].getKey());if(K&&K.setExecuteOnSelection){K.setExecuteOnSelection(F);this.aExeVariants.push({key:i.getKey(),exe:F});if(K.setLifecyclePackage){K.setLifecyclePackage(N[z].getLifecyclePackage());K.setLifecycleTransportId(N[z].getLifecycleTransportId());}}}}if(this.oManagementDialog){this.oManagementDialog.close();}this._manageButtonState();if(this.bVariantItemMode===false){if(this.getDefaultVariantKey()!=this.sNewDefaultKey){var M=null;if(this.sNewDefaultKey==this.getStandardVariantKey()){M=this.getItemByKey(this.getDefaultVariantKey());this.fireSave({name:M.getText(),overwrite:true,key:M.getKey(),def:false});}else{M=this.getItemByKey(this.sNewDefaultKey);this.fireSave({name:M.getText(),overwrite:true,key:M.getKey(),def:true});}}}this.setDefaultVariantKey(this.sNewDefaultKey);for(y=0;y<this.aRemovedVariants.length;y++){i=this.getItemByKey(this.aRemovedVariants[y]);for(var Q=0;Q<this.aRemovedVariantTransports.length;Q++){if(this.aRemovedVariants[y]===this.aRemovedVariantTransports[Q].key){var U=this.aRemovedVariantTransports[Q];if(i.setLifecyclePackage){i.setLifecycleTransportId(U.transport);}break;}}}this.fireManage({renamed:this.aRenamedVariants,deleted:this.aRemovedVariants,exe:this.aExeVariants,def:this.getDefaultVariantKey()});for(y=0;y<this.aRemovedVariants.length;y++){i=this.getItemByKey(this.aRemovedVariants[y]);if(i){this._removeItem(i);i.destroy();}if(this.lastSelectedVariantKey===this.aRemovedVariants[y]){e=true;this._setSelectedItem(null);this.bDirty=false;this.oVariantModifiedText.setVisible(false);this.oModel.setProperty("/enabled",false);}}if(e){this.bFireSelect=true;}this._eventDone();};w.prototype._createEvent=function(N,e){var i={name:N,fFunc:e,args:[]};return i;};w.prototype._handleNextEvent=function(){if(this.aEvents.length>0){if(!this.bEventRunning){this.bEventRunning=true;var e=this.aEvents.pop();e.fFunc.apply(this,e.args);}}};w.prototype._addEvent=function(e){this.aEvents.push(e);this._handleNextEvent();};w.prototype._cancelAllEvents=function(){this.aEvents=[];this.bEventRunning=false;};w.prototype._eventDone=function(){this.bEventRunning=false;this._handleNextEvent();};w.prototype._handleManageExecuteOnSelectionChanged=function(e){var i=this;var M=e.getParent();if(M.getGlobal()){var O=function(y,z){M.setLifecyclePackage(y);M.setLifecycleTransportId(z);i._eventDone();};var x=function(y){e.setSelected(!e.getSelected());i._cancelAllEvents();};this._createManagementDialog();this._assignTransport(M,O,x,this.oManagementDialog);}else{this._eventDone();}};w.prototype._handleManageDeletePressed=function(e){if(!this._isInErrorStateManaged(e.getParent().getCells()[0],this.oManagementTable)){this.oManagementSave.setEnabled(true);}var i=e.getParent();if(i.getGlobal()){var x=this;var O=function(z,F){var K=i.getKey();x.aRemovedVariants.push(K);x.oManagementTable.removeItem(i);if(i.getKey()===x.sNewDefaultKey){x.oManagementTable.getItems()[0].getCells()[2].setSelected(true);x.sNewDefaultKey=x.getStandardVariantKey();}i.destroy();var M={key:K,transport:F};x.aRemovedVariantTransports.push(M);x._eventDone();};var y=function(z){x._cancelAllEvents();};this._createManagementDialog();this._assignTransport(i,O,y,this.oManagementDialog);}else{this.aRemovedVariants.push(i.getKey());this.oManagementTable.removeItem(i);if(i.getKey()===this.sNewDefaultKey){this.oManagementTable.getItems()[0].getCells()[2].setSelected(true);this.sNewDefaultKey=this.getStandardVariantKey();}i.destroy();this._eventDone();}};w.prototype._handleShareSelected=function(e){var i=this;if(e.getParameters().selected){var O=function(y,z){i.sTransport=z;i.sPackage=y;i._eventDone();};var x=function(y){i.oShare.setSelected(false);i.sTransport=null;i.sPackage=null;i._cancelAllEvents();};this._createSaveDialog();this._assignTransport(null,O,x,this.oSaveDialog);}else{this.sTransport=null;this.sPackage=null;this._eventDone();}};w.prototype._handleVariantSaveAs=function(){var K="SV"+new Date().getTime();var N=this.oInputName.getValue();var M=this.oInputKey.getValue();var e="";var i="";var x=false;var y=false;var z=null;N=N.trim();if(N==""){this.oInputName.setValueState(u.Error);this.oInputName.setValueStateText(this.oResourceBundle.getText("VARIANT_MANAGEMENT_ERROR_EMPTY"));this._cancelAllEvents();return;}M=M.trim();if(this.bManualVariantKey&&M==""){this.oInputKey.setValueState(u.Error);this.oInputKey.setValueStateText(this.oResourceBundle.getText("VARIANT_MANAGEMENT_ERROR_EMPTY"));this._cancelAllEvents();return;}if(this.bManualVariantKey){K=M;}if(this.oSaveDialog){this.oSaveDialog.close();}if(this.oExecuteOnSelect!==null){x=this.oExecuteOnSelect.getSelected();}if(this.oCreateTile!==null){y=this.oCreateTile.getSelected();}if(this.bVariantItemMode){z=new V({key:K,text:N,readOnly:false,executeOnSelection:x,global:this.oShare.getSelected(),lifecycleTransportId:this.sTransport,lifecyclePackage:this.sPackage});this.addVariantItem(z);this._setSelectedItem(z);}else{z=new t({key:K,text:N});this.addItem(z);this._setSelectedItem(z);}if(this.oDefault.getSelected()){this.setDefaultVariantKey(K);}if(this.oShare.getSelected()){i=this.sPackage;e=this.sTransport;}this._manageButtonState();this.fireSave({name:N,overwrite:false,def:this.oDefault.getSelected(),key:K,exe:this.oExecuteOnSelect.getSelected(),tile:y,global:this.oShare.getSelected(),lifecyclePackage:i,lifecycleTransportId:e});this.bDirty=false;this.oVariantModifiedText.setVisible(false);this.oModel.setProperty("/enabled",false);this._eventDone();};w.prototype._setBackwardCompatibility=function(F){if(this.getItems().length===0&&this.getVariantItems().length===0){this.bVariantItemMode=!F;}this._setStandardText();};w.prototype._setStandardText=function(){var K=this.getSelectionKey();if(K===null||K===this.getStandardVariantKey()){if(this.bVariantItemMode==false){this.oVariantText.setText(this.oResourceBundle.getText("VARIANT_MANAGEMENT_DEFAULT"));}else{this.oVariantText.setText(this.oResourceBundle.getText("VARIANT_MANAGEMENT_STANDARD"));}if(this.getStandardItemText()!==null&&this.getStandardItemText()!=""){this.oVariantText.setText(this.getStandardItemText());}}};w.prototype._openVariantManagementDialog=function(){var i;var e=null;var x=0;var M;var N;var y;var z;var F;var K;var O;var Q;var U;var W;var X;var Y;var Z;var $=this;this.oManagementSave.setEnabled(true);this.oManagementTable.destroyItems();U=function(b1){$._checkVariantNameConstraints(this,$.oManagementSave,$.oManagementTable);};W=function(b1){var c1=$._createEvent("inputfieldChange",$._checkManageItemNameChange);c1.args.push(this.getParent());$._addEvent(c1);};X=function(b1){if(b1.getParameters().selected===true){var i=this.getParent();$.sNewDefaultKey=i.getKey();}};Y=function(b1){var c1=$._createEvent("executeOnSelectionChange",$._handleManageExecuteOnSelectionChanged);c1.args.push(this);$._addEvent(c1);};Z=function(b1){var c1=$._createEvent("manageDeletePressed",$._handleManageDeletePressed);c1.args.push(this);$._addEvent(c1);};this._initalizeManagementTableColumns();this.sNewDefaultKey=this.getDefaultVariantKey();this._restoreCompleteList();if(this.oVariantList.getItems()[0].getKey()!==this.getStandardVariantKey()&&this.bVariantItemMode==false){i=new V(this.oVariantManage.getId()+"-item-standard",{key:this.getStandardVariantKey(),text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_DEFAULT"),readOnly:true,executeOnSelection:false});this.oVariantList.insertItem(i,0);}e=this.oVariantList.getItems();for(var _=0;_<e.length;_++){if(e[_].getReadOnly()||e[_].getLabelReadOnly()){var a1=e[_].getAccessOptions();Q=this._accessOptionsText(a1);}else{Q=null;}if(e[_].getReadOnly()){Q=this.oResourceBundle.getText("VARIANT_MANAGEMENT_WRONG_LAYER");}else if(e[_].getLabelReadOnly()===true){Q=this.oResourceBundle.getText("VARIANT_MANAGEMENT_WRONG_LANGUAGE");}if(e[_].getKey()===this.getStandardVariantKey()){Q=null;}M=new E(this.oVariantManage.getId()+"-edit-"+x,{key:e[_].getKey(),global:e[_].getGlobal(),lifecyclePackage:e[_].getLifecyclePackage(),lifecycleTransportId:e[_].getLifecycleTransportId(),namespace:e[_].getNamespace(),labelReadOnly:e[_].getLabelReadOnly(),vAlign:v.Middle});if(e[_].getKey()===this.getStandardVariantKey()||e[_].getReadOnly()===true||e[_].getLabelReadOnly()===true){N=new b(this.oVariantManage.getId()+"-text-"+x,{text:e[_].getText()});if(Q){N.setTooltip(Q);}}else{N=new I(this.oVariantManage.getId()+"-input-"+x,{value:e[_].getText(),liveChange:U,change:W});}M.addCell(N);if(e[_].getGlobal()){O=this.oResourceBundle.getText("VARIANT_MANAGEMENT_SHARED");}else{O=this.oResourceBundle.getText("VARIANT_MANAGEMENT_PRIVATE");}y=new b(this.oVariantManage.getId()+"-type-"+x,{text:O});y.addStyleClass("sapUICompVarMngmtType");M.addCell(y);z=new R(this.oVariantManage.getId()+"-def-"+x,{groupName:this.oVariantManage.getId(),select:X});if(this.sNewDefaultKey===e[_].getKey()||e[_].getKey()===this.getStandardVariantKey()&&this.sNewDefaultKey===""){z.setSelected(true);}M.addCell(z);if(this.getShowExecuteOnSelection()){F=new l(this.oVariantManage.getId()+"-exe-"+x,{selected:false,enabled:false,select:Y});if(e[_].getExecuteOnSelection){F.setEnabled(!e[_].getReadOnly());F.setSelected(e[_].getExecuteOnSelection());if(Q){F.setTooltip(Q);}}M.addCell(F);}K=new k(this.oVariantManage.getId()+"-del-"+x,{icon:"sap-icon://sys-cancel",enabled:true,type:g.Transparent,press:Z,tooltip:this.oResourceBundle.getText("VARIANT_MANAGEMENT_DELETE")});if(M.getKey()===this.getStandardVariantKey()||(e[_].getReadOnly&&e[_].getReadOnly())){K.setEnabled(false);}K.addStyleClass("sapUiCompVarMngmtDel");M.addCell(K);this.oManagementTable.addItem(M);x++;}this.aRemovedVariants=[];this.aRemovedVariantTransports=[];this.aRenamedVariants=[];this.aExeVariants=[];this._createManagementDialog();this._setDialogCompactStyle(this,this.oManagementDialog);i=this.oVariantList.getSelectedItem();if(i){this.lastSelectedVariantKey=i.getKey();}this.oVariantPopOver.close();this.oManagementDialog.open();};w.prototype._enableManualVariantKey=function(e){this.bManualVariantKey=e;};w.prototype._fireSelectAsync=function(K){var e;if(K===undefined||K===null){var i=this._getSelectedItem();if(i===null){e=this.getStandardVariantKey();}else{e=i.getKey();}}this.fireSelect({key:e});};w.prototype._executeOnSelectForStandardVariant=function(e){this.bExecuteOnSelectForStandard=e;};w.prototype.getStandardVariantKey=function(){return this._sStandardVariantKey;};w.prototype.setStandardVariantKey=function(e){this._sStandardVariantKey=e;};w.prototype._setVendorLayer=function(e){this._isVendorLayer=e;};w.prototype._isIndustrySolutionModeAndVendorLayer=function(){if(this.getIndustrySolutionMode()&&this._isVendorLayer){return true;}return false;};return w;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.filterbar.FilterItem')){jQuery.sap.declare('sap.ui.comp.filterbar.FilterItem');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.m.Label');jQuery.sap.require('sap.ui.core.Element');jQuery.sap.require('sap.ui.core.TooltipBase');jQuery.sap.require('sap.ui.base.DataType');sap.ui.define("sap/ui/comp/filterbar/FilterItem",['jquery.sap.global','sap/m/Label','sap/ui/comp/library','sap/ui/core/Element','sap/ui/core/TooltipBase','sap/ui/base/DataType'],function(q,L,l,E,T,D){"use strict";var F=E.extend("sap.ui.comp.filterbar.FilterItem",{metadata:{library:"sap.ui.comp",properties:{label:{type:"string",group:"Misc",defaultValue:null},name:{type:"string",group:"Misc",defaultValue:null},mandatory:{type:"boolean",group:"Misc",defaultValue:false},visible:{type:"boolean",group:"Misc",defaultValue:true},labelTooltip:{type:"string",group:"Misc",defaultValue:null},partOfCurrentVariant:{type:"boolean",group:"Misc",defaultValue:false},visibleInFilterBar:{type:"boolean",group:"Misc",defaultValue:true}},aggregations:{control:{type:"sap.ui.core.Control",multiple:false}},events:{change:{parameters:{propertyName:{type:"string"}}}}}});F.prototype.init=function(){this._oLabel=null;};F.prototype.setVisible=function(v){this.setProperty("visible",v);this.fireChange({propertyName:"visible"});};F.prototype.setVisibleInFilterBar=function(v){this.setProperty("visibleInFilterBar",v);this.fireChange({propertyName:"visibleInFilterBar"});};F.prototype._replace=function(n){var t=D.getType("sap.ui.core.ID");if(!t.isValid(n)){n=n.replace(/[^A-Za-z0-9_.:]+/g,"_");if(!t.isValid(n)){n="A_"+n;}}return n;};F.prototype._getGroupName=function(){var n="";if(this.getGroupName){n=this._replace(this.getGroupName());}return n;};F.prototype._getName=function(){var n=this._replace(this.getName());var g=this._getGroupName();if(g){n=g+"-"+n;}return n;};F.prototype._createLabelControl=function(f){var t=this.getLabel();var i="filterItem-"+this._getName();if(f){i=f+"-"+i;}var o=new L({id:i,text:t,required:this.getMandatory(),tooltip:this.getLabelTooltip(),textAlign:"Begin"});return o;};F.prototype.setMandatory=function(v){this.setProperty("mandatory",v);if(this._oLabel){this._oLabel.setRequired(v);}this.fireChange({propertyName:"mandatory"});};F.prototype.setLabel=function(v){this.setProperty("label",v);if(this._oLabel){this._oLabel.setText(v);}this.fireChange({propertyName:"label"});};F.prototype.setLabelTooltip=function(t){this.setProperty("labelTooltip",t);if(this._oLabel){this._oLabel.setTooltip(t);}this.fireChange({propertyName:"labelTooltip"});};F.prototype.getLabelControl=function(f){if(!this._oLabel){this._oLabel=this._createLabelControl(f);}return this._oLabel;};F.prototype.destroy=function(){if(this._oLabel&&!this._oLabel.bDestroyed){this._oLabel.destroy();}E.prototype.destroy.apply(this,arguments);this._oLabel=null;};return F;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.filterbar.VariantConverterFrom')){jQuery.sap.declare('sap.ui.comp.filterbar.VariantConverterFrom');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.m.MultiComboBox');jQuery.sap.require('sap.m.MultiInput');jQuery.sap.require('sap.m.DatePicker');jQuery.sap.require('sap.m.DateRangeSelection');sap.ui.define("sap/ui/comp/filterbar/VariantConverterFrom",['jquery.sap.global','sap/ui/comp/smartfilterbar/ControlConfiguration','sap/ui/comp/valuehelpdialog/ValueHelpDialog','sap/m/MultiComboBox','sap/m/MultiInput','sap/m/DatePicker','sap/m/DateRangeSelection'],function(q,C,V,M,a,D,b){"use strict";var c=function(){};c.prototype.convert=function(s,f){var o=null,r=null;var S;if(s){S=JSON.parse(s);if(f&&f.getFilterBarViewMetadata&&S&&(S.Parameters||S.SelectOptions)){o={};if(S.Parameters){this._addParameters(S.Parameters,f,o);}if(S.SelectOptions){this._addSelectOptions(S.SelectOptions,f,o);}r={payload:null,variantId:null};r.payload=JSON.stringify(o);if(S.SelectionVariantID){r.variantId=S.SelectionVariantID;}}}return r;};c.prototype.retrieveVariantId=function(s){var v=null;var S;if(s){S=JSON.parse(s);if(S&&S.SelectionVariantID){v=S.SelectionVariantID;}}return v;};c.prototype._getParameterMetaData=function(n,f){var i,j;var g;var F=f.getFilterBarViewMetadata();if(F){for(i=0;i<F.length;i++){g=F[i];for(j=0;j<g.fields.length;j++){if(n===g.fields[j].fieldName){return g.fields[j];}}}}return null;};c.prototype._addParameters=function(s,f,o){var i;var n,v;var F;for(i=0;i<s.length;i++){v=s[i].PropertyValue;n=s[i].PropertyName;F=this._getParameterMetaData(n,f);if(F){this._addAccordingMetaData(o,F,v);}else{q.sap.log.error("neither metadata nor custom information for filter '"+n+"'");}}};c.prototype._addSelectOptions=function(s,f,o){var i;var n,r;var F,d;for(i=0;i<s.length;i++){n=s[i].PropertyName;r=s[i].Ranges;F=this._getParameterMetaData(n,f);if(F){d=F.control;this._addRangesAccordingMetaData(o,F,r,d);}else{q.sap.log.error("neither metadata nor custom information for filter '"+name+"'");}}};c.prototype._addRangesAccordingMetaData=function(o,f,r,d,n){var i,O;var e=function(s,v){var I=s;if(s==="CP"){I=sap.ui.comp.valuehelpdialog.ValueHelpRangeOperation.Contains;if(v){var h=v.indexOf('*');var j=v.lastIndexOf('*');if((h===0)&&(j!==(v.length-1))){I=sap.ui.comp.valuehelpdialog.ValueHelpRangeOperation.EndsWith;v=v.substring(1,v.length);}else if((h!==0)&&(j===(v.length-1))){I=sap.ui.comp.valuehelpdialog.ValueHelpRangeOperation.StartsWith;v=v.substring(0,v.length-1);}else{v=v.substring(1,v.length-1);}}}return{op:I,v:v};};var g=function(F,r){var i,I,O;if(!o[F]){o[F]={ranges:[],items:[],value:null};}for(i=0;i<r.length;i++){O=e(r[i].Option,r[i].Low);I={"exclude":(r[i].Sign==="E"),"operation":O.op,"keyField":F,"value1":O.v,"value2":r[i].High};o[F].ranges.push(I);}};if(r&&r.length>0){if(f.isCustomFilterField){if(!o._CUSTOM){o._CUSTOM={};}o._CUSTOM[f.fieldName]=r[0].Low;return;}if(f.conditionType){g(f.fieldName,r);return;}if(f.filterRestriction===C.FILTERTYPE.single){if(!r[0].Low&&d&&(d instanceof D)){o[f.fieldName]=null;}else{o[f.fieldName]=r[0].Low;}}else if(f.filterRestriction===C.FILTERTYPE.interval){if(d&&(d instanceof b)){if(r[0].Low&&r[0].High){o[f.fieldName]={low:r[0].Low,high:r[0].High};}else if(r[0].Low&&!r[0].High){o[f.fieldName]={low:r[0].Low,high:r[0].Low};}else if(!r[0].Low&&r[0].High){o[f.fieldName]={low:r[0].High,high:r[0].High};}else{o[f.fieldName]={low:null,high:null};}}else{o[f.fieldName]={low:r[0].Low===undefined?null:r[0].Low,high:r[0].High===undefined?null:r[0].High};}}else if(f.filterRestriction===C.FILTERTYPE.multiple){o[f.fieldName]={ranges:[],items:[],value:null};if(d&&((d instanceof M)||(d instanceof a))){for(i=0;i<r.length;i++){O=e(r[i].Option,r[i].Low);if(O.op===sap.ui.comp.valuehelpdialog.ValueHelpRangeOperation.EQ){if(f.type==="Edm.DateTime"){o[f.fieldName].ranges.push({value1:O.v});}else{o[f.fieldName].items.push({key:O.v});}}}}else{g(f.fieldName,r);}}else{g(f.fieldName,r);}q.sap.log.warning("potential reduced information for filter '"+f.fieldName+"'");}else{q.sap.log.warning("no Ranges-section found for filter '"+f.fieldName+"'");}};c.prototype._addAccordingMetaData=function(o,f,v){var h=f.type==="Edm.DateTime"?"":v;var r=[{Sign:"I",Low:v,High:h,Option:"EQ"}];this._addRangesAccordingMetaData(o,f,r);};return c;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.filterbar.VariantConverterTo')){jQuery.sap.declare('sap.ui.comp.filterbar.VariantConverterTo');jQuery.sap.require('jquery.sap.global');sap.ui.define("sap/ui/comp/filterbar/VariantConverterTo",['jquery.sap.global','sap/ui/comp/smartfilterbar/ControlConfiguration','sap/ui/comp/valuehelpdialog/ValueHelpDialog'],function(q,C,V){"use strict";var a=function(){};a.prototype.convert=function(k,f,d,F){var b,i;var j,J,n=null;var s={SelectionVariantID:k};if(d&&f){j=JSON.parse(d);if(j){b=this._getFields(f);if(b&&b.length>0){for(i=0;i<b.length;i++){this._convertField(s,b[i],j,F);}}if(j._CUSTOM){if(typeof j._CUSTOM==="string"){J=JSON.parse(j._CUSTOM);}else{J=j._CUSTOM;}for(n in J){if(n){this._addSingleValue(s,n,this._getValue(J[n]));}}}}}return JSON.stringify(s);};a.prototype._getParameterMetaData=function(n,f){var i,j;var g;var F=f.getFilterBarViewMetadata();if(F){for(i=0;i<F.length;i++){g=F[i];for(j=0;j<g.fields.length;j++){if(n===g.fields[j].fieldName){return g.fields[j];}}}}return null;};a.prototype._convertField=function(s,f,c,F){var o,v,O=null;var r;var b;if(c&&f&&s){o=c[f];if(o){b=this._getParameterMetaData(f,F);if(b){if(b.isCustomFilterField){return;}if(b.filterRestriction===C.FILTERTYPE.single){v=(o.value===undefined)?o:o.value;this._addSingleValue(s,f,v);}else if(b.filterRestriction===C.FILTERTYPE.interval){if(o.conditionTypeInfo){this._convertFieldByValue(s,f,c);}else{r=this._addRangeEntry(s,f);if((b.type==="Edm.DateTime")&&!o.high){o.high=o.low;}else if((b.type==="Edm.String")&&!o.high){O="EQ";}this._addRangeLowHigh(r,o,O);}}else if(b.filterRestriction===C.FILTERTYPE.multiple){r=this._addRangeEntry(s,f);if(o.items&&o.items.length>0){this._addRangeMultipleSingleValues(r,o.items);}else if(o.ranges&&o.ranges.length>0){this._addRangeMultipleRangeValues(r,o.ranges);}else{this._addRangeSingleValue(r,o.value);}}else{this._convertFieldByValue(s,f,c);}}else{this._convertFieldByValue(s,f,c);}}}};a.prototype._convertFieldByValue=function(s,f,c){var o;var r;if(c&&f&&s){o=c[f];if(o){if(o.conditionTypeInfo){if(o.ranges&&o.ranges.length>0){r=this._addRangeEntry(s,f);this._addRanges(r,o.ranges);}}else if((o.ranges!==undefined)&&(o.items!==undefined)&&(o.value!==undefined)){r=this._addRangeEntry(s,f);if(o.ranges&&o.ranges.length>0){this._addRanges(r,o.ranges);}if(o.items&&o.items.length>0){this._addRangeMultipleSingleValues(r,o.items);}if(o.value){this._addRangeSingleValue(r,o.value);}}else if((o.items!==undefined)&&o.items&&(o.items.length>0)){r=this._addRangeEntry(s,f);this._addRangeMultipleSingleValues(r,o.items);}else if((o.low!==undefined)&&o.low&&(o.high!==undefined)&&o.high){r=this._addRangeEntry(s,f);this._addRangeLowHigh(r,o);}else if((o.value!==undefined)&&o.value){this._addSingleValue(s,f,o.value);}else if(o){this._addSingleValue(s,f,o);}}}};a.prototype._addRangeEntry=function(s,f){var o={PropertyName:f,Ranges:[]};if(!s.SelectOptions){s.SelectOptions=[];}s.SelectOptions.push(o);return o.Ranges;};a.prototype._addRanges=function(r,R){var s,o,l,h;for(var i=0;i<R.length;i++){s=R[i].exclude?"E":"I";l=this._getValue(R[i].value1);h=this._getValue(R[i].value2);if(R[i].operation===sap.ui.comp.valuehelpdialog.ValueHelpRangeOperation.Contains){o="CP";if(l){l="*"+l+"*";}}else if(R[i].operation===sap.ui.comp.valuehelpdialog.ValueHelpRangeOperation.StartsWith){o="CP";if(l){l=l+"*";}}else if(R[i].operation===sap.ui.comp.valuehelpdialog.ValueHelpRangeOperation.EndsWith){o="CP";if(l){l="*"+l;}}else{o=R[i].operation;}r.push({Sign:s,Option:o,Low:l,High:h});}};a.prototype._addRangeMultipleSingleValues=function(r,I){for(var i=0;i<I.length;i++){r.push({Sign:"I",Option:"EQ",Low:this._getValue(I[i].key),High:null});}};a.prototype._addRangeMultipleRangeValues=function(r,I){for(var i=0;i<I.length;i++){r.push({Sign:"I",Option:"EQ",Low:this._getValue(I[i].value1),High:null});}};a.prototype._addRangeSingleValue=function(r,v){r.push({Sign:"I",Option:"EQ",Low:this._getValue(v),High:null});};a.prototype._addRangeLowHigh=function(r,l,o){var O=o||"BT";r.push({Sign:"I",Option:O,Low:this._getValue(l.low),High:this._getValue(l.high)});};a.prototype._addSingleValue=function(s,f,v){if(!s.Parameters){s.Parameters=[];}s.Parameters.push({PropertyName:f,PropertyValue:v});};a.prototype._getFields=function(f){var r=[];if(f){for(var i=0;i<f.length;i++){r.push(f[i].name);}}return r;};a.prototype._getValue=function(v){if((v===null)||(v===undefined)){return null;}return""+v;};a.prototype._getControl=function(f,n){var c=null;var F=this._getParameterMetaData(n,f);if(F){c=F.control;}return c;};return a;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.navpopover.SemanticObjectController')){jQuery.sap.declare('sap.ui.comp.navpopover.SemanticObjectController');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.Element');sap.ui.define("sap/ui/comp/navpopover/SemanticObjectController",['jquery.sap.global','sap/ui/comp/library','sap/ui/core/Element','sap/ui/comp/personalization/Util'],function(q,l,E,P){"use strict";var S=E.extend("sap.ui.comp.navpopover.SemanticObjectController",{metadata:{library:"sap.ui.comp",properties:{ignoredFields:{type:"string",group:"Misc",defaultValue:null},prefetchNavigationTargets:{type:"boolean",group:"Misc",defaultValue:false},fieldSemanticObjectMap:{type:"object",group:"Misc",defaultValue:null},entitySet:{type:"string",group:"Misc",defaultValue:null}},events:{navigationTargetsObtained:{parameters:{mainNavigation:{type:"sap.ui.comp.navpopover.LinkData"},actions:{type:"sap.ui.comp.navpopover.LinkData[]"},ownNavigation:{type:"sap.ui.comp.navpopover.LinkData"},semanticObject:{type:"string"},originalId:{type:"string"},show:{type:"function"}}},beforePopoverOpens:{parameters:{semanticObject:{type:"string"},semanticAttributes:{type:"object"},setSemanticAttributes:{type:"function"},setAppStateKey:{type:"function"},originalId:{type:"string"},open:{type:"function"}}},navigate:{parameters:{text:{type:"string"},href:{type:"string"},semanticObject:{type:"string"},semanticAttributes:{type:"object"},originalId:{type:"string"}}},prefetchDone:{parameters:{semanticObjects:{type:"object"}}}}}});S.prototype.init=function(){this._proxyOnBeforePopoverOpens=q.proxy(this._onBeforePopoverOpens,this);this._proxyOnTargetsObtained=q.proxy(this._onTargetsObtained,this);this._proxyOnNavigate=q.proxy(this._onNavigate,this);this._aRegisteredControls=[];this._aIgnoredSegmanticObjects=[];};S.prototype.registerControl=function(s){if(s.attachBeforePopoverOpens&&!s.hasListeners("beforePopoverOpens")){s.attachBeforePopoverOpens(this._proxyOnBeforePopoverOpens);}if(s.attachNavigationTargetsObtained&&!s.hasListeners("navigationTargetsObtained")){s.attachNavigationTargetsObtained(this._proxyOnTargetsObtained);}if(s.attachInnerNavigate&&!s.hasListeners("innerNavigate")){s.attachInnerNavigate(this._proxyOnNavigate);}this.setIgnoredState(s);this._aRegisteredControls.push(s);};S.prototype.unregisterControl=function(s){if(s.detachBeforePopoverOpens){s.detachBeforePopoverOpens(this._proxyOnBeforePopoverOpens);}if(s.detachNavigationTargetsObtained){s.detachNavigationTargetsObtained(this._proxyOnTargetsObtained);}if(s.detachInnerNavigate){s.detachInnerNavigate(this._proxyOnNavigate);}this._aRegisteredControls.pop(s);};S.prototype._onBeforePopoverOpens=function(e){var p=e.getParameters();if(this.hasListeners("beforePopoverOpens")){this.fireBeforePopoverOpens({semanticObject:p.semanticObject,semanticAttributes:p.semanticAttributes,setSemanticAttributes:p.setSemanticAttributes,setAppStateKey:p.setAppStateKey,originalId:p.originalId,open:p.open});}else{p.open();}};S.prototype._onTargetsObtained=function(e){var p=e.getParameters();if(this.hasListeners("navigationTargetsObtained")){var s=e.getSource();this.fireNavigationTargetsObtained({semanticObject:s.getSemanticObject(),semanticAttributes:s.getSemanticAttributes(),actions:p.actions,mainNavigation:p.mainNavigation,ownNavigation:p.ownNavigation,originalId:p.originalId,show:p.show});}else{p.show();}};S.prototype._onNavigate=function(e){var p=e.getParameters();this.fireNavigate({text:p.text,href:p.href,originalId:p.originalId,semanticObject:p.semanticObject,semanticAttributes:p.semanticAttributes});};S.prototype.setIgnoredState=function(s){if(s instanceof sap.ui.comp.navpopover.SmartLink){var i=this._fieldIsIgnored(s.getFieldName())||!this._linkIsAvailable(s.getSemanticObject());s.setIgnoreLinkRendering(i);}};S.prototype._fieldIsIgnored=function(f){return this._aIgnoredSegmanticObjects.indexOf(f)>-1;};S.prototype._linkIsAvailable=function(s){if(this._oAvailableLinks){if(!this._oAvailableLinks[s]){return false;}}return true;};S.prototype.setIgnoredFields=function(i){this._aIgnoredSegmanticObjects=P.createArrayFromString(i);this.setProperty("ignoredFields",i);this._evaluateEnableState();};S.prototype.setPrefetchNavigationTargets=function(p){this.setProperty("prefetchNavigationTargets",p);if(p){this._prefetchNavigationTargets();}else{this._oAvailableLinks=null;this._evaluateEnableState();}};S.prototype.getFieldSemanticObjectMap=function(){var m=this.getProperty("fieldSemanticObjectMap");if(m){return m;}if(!this.getEntitySet()){q.sap.log.warning("FieldSemanticObjectMap is not set on SemanticObjectController, retrieval without EntitySet not possible");return null;}q.sap.require("sap.ui.comp.odata.MetadataAnalyser");var M=new sap.ui.comp.odata.MetadataAnalyser(this.getModel());m=M.getFieldSemanticObjectMap(this.getEntitySet());if(m){this.setProperty("fieldSemanticObjectMap",m,true);}return m;};S.prototype.getEntitySet=function(){var e=this.getProperty("entitySet");if(e){return e;}var p=this.getParent();while(p){if(p.getEntitySet){e=p.getEntitySet();if(e){this.setProperty("entitySet",e,true);break;}}p=p.getParent();}return e;};S.prototype._prefetchNavigationTargets=function(){var g=sap.ushell&&sap.ushell.Container&&sap.ushell.Container.getService;if(!g){return;}this._oAvailableLinks={};var c=g("CrossApplicationNavigation");var u=g("URLParsing");var p=c.getSemanticObjectLinks('');p.fail(q.proxy(function(){this._oAvailableLinks=null;q.sap.log.error("'getSemanticObjectLinks' failed");this._evaluateEnableState();},this));p.done(q.proxy(function(L){var i,a;if(L&&L.length){a=L.length;for(i=0;i<a;i++){var I=L[i].intent;var s=u.parseShellHash(I);if(s&&s.semanticObject){this._addActionToSemanticObject(s.semanticObject,s.action);}}}this._evaluateEnableState();this.firePrefetchDone({semanticObjects:this._oAvailableLinks});},this));};S.prototype._addActionToSemanticObject=function(s,a){if(!this._oAvailableLinks[s]){this._oAvailableLinks[s]=[];}this._oAvailableLinks[s].push(a);};S.prototype._evaluateEnableState=function(){for(var i=0,L=this._aRegisteredControls.length;i<L;i++){this.setIgnoredState(this._aRegisteredControls[i]);}};return S;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.odata.FieldSelector')){
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.ui.comp.odata.FieldSelector');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.Control');sap.ui.define("sap/ui/comp/odata/FieldSelector",['jquery.sap.global','sap/ui/comp/library','sap/ui/core/Control','./FieldSelectorController'],function(q,l,C,F){"use strict";var a=C.extend("sap.ui.comp.odata.FieldSelector",{metadata:{library:"sap.ui.comp",properties:{showSearchBar:{type:"boolean",group:"Misc",defaultValue:true}},aggregations:{content:{type:"sap.ui.core.Control",multiple:false}},events:{fieldSelectionChanged:{}}}});a._tooltipBinding={parts:[{path:"com.sap.vocabularies.Common.v1.QuickInfo"},{path:"com.sap.vocabularies.Common.v1.Label"}],formatter:function tooltipFormatter(Q,L){if(Q&&Q.String){return Q.String;}if(L&&L.String){return L.String;}return'';}};a.prototype.init=function(){q.sap.require("sap.m.HBox");q.sap.require("sap.m.VBox");q.sap.require("sap.m.FlexItemData");q.sap.require("sap.m.FlexDirection");q.sap.require("sap.m.FlexAlignSelf");q.sap.require("sap.m.FlexAlignItems");q.sap.require("sap.ui.core.ResizeHandler");q.sap.require("sap.ui.comp.odata.FieldSelectorModelConverter");q.sap.require("sap.m.Label");q.sap.require("sap.ui.fl.fieldExt.Access");this._fieldNameText=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("ODATA_FIELD_SEL_NAME");this._fieldTypeText=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("ODATA_FIELD_SEL_TYPE");this._fieldLabelText=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("ODATA_FIELD_SEL_LABEL");this._entityTypeText=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("ODATA_FIELD_SEL_HEADER");this._createNewFieldText=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("ODATA_CREATE_NEW_FIELD");this._oFieldController=new F();this._sSelectedKey=undefined;this._oTable=undefined;this._oSearchField=undefined;this._oConverter=undefined;this._oCreateButton=undefined;this._bDisplayFieldExtButton=undefined;this._oCurrentFieldExtInfo=undefined;this._oScrollView=new sap.m.ScrollContainer();this._oTable=new sap.m.Table();this._oHeaderLayout=undefined;var s=sap.ui.getCore().byId("smartFormPersDialog");if(s){this._oResizeDialogHandlerId=sap.ui.core.ResizeHandler.register(s,q.proxy(this._handleResizeDialog,this));}if(this._oScrollView){this._oResizeScrollViewHandlerId=sap.ui.core.ResizeHandler.register(this._oScrollView,q.proxy(this._handleResizeTable,this));}};a.prototype._handleResizeDialog=function(){if(this._oScrollView){var h=q("#smartFormPersDialog-cont").height();var b=q("#smartFormPersDialogFieldSelectorHeader").height();var c=q("#sapUiCompFieldSelectorHeaderSearch").height();var t=q("#sapUiCompFieldSelectorTable-tblHeader").height();this._oScrollView.setHeight(h-b-c-t+"px");}};a.prototype._handleResizeTable=function(){if(this._oScrollView){var w=this._oScrollView.$("scroll").innerWidth();this._oTable.setWidth(w+"px");}};a.prototype.setModel=function(m,e,s,i,b,I){this._bDisplayFieldExtButton=s;if(!m){q.sap.log.error("oModel has to be set otherwise nothing will be displayed");}if(!e){q.sap.log.error("sEntityTypes has to be set otherwise nothing will be displayed");}this._oFieldController.init(m,e,i,b,I);this._constructLayout();this._updateCreateButtonState();};a.prototype.getSelectedField=function(){var r={entityType:this._sSelectedKey};var s=this._oTable.getSelectedItem();if(s){var S=s.getBindingContext();if(S){var R=S.getProperty();if(R){r.field=R.fieldLabel;r.name=R.name;r.entityName=R.entityName;r.entitySet=this._oFieldController.getMetaDataAnalyzer().getEntitySetNameFromEntityTypeName(r.entityType);r.path=R.name;r.isBoundToODataService=R.id===undefined;if(!r.isBoundToODataService){r.id=R.id;}else{if(r.entityType!==R.entityName){var p=this._oFieldController.getMetaDataAnalyzer()._getNameOfPropertyUsingComplexType(r.entityType,R.entityName);if(p){r.path=p+"/"+R.name;}else{q.sap.log.error("FieldSelector: Property of complex type "+R.name+" not found on entityType "+r.entityType);}}}}}}return r;};a.prototype.updateFieldLabel=function(f){var t=this;var o=this._oFieldController.getFields();var i=f.isBoundToODataService;var n=f.label;if(i===true){var b=f.bindingPaths;q.each(b,function(c,B){var s=B.path;var d=s.indexOf('/');var r=s.slice(0,d);var R=s.slice(d+1);var e=o[r];q.each(e,function(E,g){if(g.name&&g.name===R){g.fieldLabel=n;t._oFieldController.sortFieldsForEntity(r);t._updateTableData();return;}});});}else if(i===false){q.each(o,function(s,e){q.each(e,function(E,c){if(c.id&&c.id===f.id){c.fieldLabel=n;t._oFieldController.sortFieldsForEntity(s);}});});this._updateTableData();}};a.prototype._constructLayout=function(){var t=this;var L=new sap.m.VBox({direction:sap.m.FlexDirection.Column});this._oHeaderLayout=new sap.m.HBox("smartFormPersDialogFieldSelectorHeader",{direction:sap.m.FlexDirection.Row});this._oHeaderLayout.addStyleClass("sapUiCompFieldSelectorHeader");this._oHeaderLayoutSearch=new sap.m.HBox({direction:sap.m.FlexDirection.Row});this._oHeaderLayoutSearch.addStyleClass("sapUiCompFieldSelectorHeaderSearch");this._oResizeHeaderHandlerId=sap.ui.core.ResizeHandler.register(this._oHeaderLayout,q.proxy(this._handleResizeDialog,this));var e=new sap.m.HBox({direction:sap.m.FlexDirection.Row,alignItems:sap.m.FlexAlignItems.Start,layoutData:new sap.m.FlexItemData({growFactor:2})});e.addStyleClass("sapUiCompFieldSelectorHeaderEntitySelection");var h=new sap.m.Label({text:this._entityTypeText,layoutData:new sap.m.FlexItemData({order:1,growFactor:1})});var d=this._getEntityTypesRow();d.setLayoutData(new sap.m.FlexItemData({order:2,growFactor:1}));d.addStyleClass("sapUiCompFieldSelectorComboBox");h.setLabelFor(d);h.setVisible(d.getVisible());e.addItem(h);e.addItem(d);this._oHeaderLayout.addItem(e);var s=this._getSearchRow();s.setLayoutData(new sap.m.FlexItemData({growFactor:1}));s.addStyleClass("sapUiCompFieldSelectorHeader");this._oHeaderLayoutSearch.addItem(s);this._oCreateButton=new sap.m.Button({text:this._createNewFieldText,press:function(E){if(t._oCurrentFieldExtInfo){var c=sap.ushell&&sap.ushell.Container&&sap.ushell.Container.getService("CrossApplicationNavigation");var H=(c&&c.hrefForExternal({target:{semanticObject:"CustomField",action:"develop"},params:{businessContexts:t._oCurrentFieldExtInfo.BusinessContexts,serviceName:t._oCurrentFieldExtInfo.ServiceName,serviceVersion:t._oCurrentFieldExtInfo.ServiceVersion}}));window.open(H,"_blank");}}});this._oCreateButton.addStyleClass("sapUiCompFieldSelectorCreateButton");this._oHeaderLayout.addItem(this._oCreateButton);L.addItem(this._oHeaderLayout);L.addItem(this._oHeaderLayoutSearch);L.addItem(this._getFieldsRow());this.setContent(L);};a.prototype._getEntityTypesRow=function(){var t=this;var d=new sap.m.ComboBox({selectionChange:function(E){t._oSearchField.setValue("");t._sSelectedKey=E.mParameters.selectedItem.getKey();t._updateTableData();t._updateCreateButtonState();},layoutData:new sap.m.FlexItemData({growFactor:1})});var e=this._oFieldController.getEntityTypes();for(var i=0;i<e.length;i++){d.addItem(new sap.ui.core.Item({text:e[i].label,key:e[i].key}));}if(e.length>0){this._sSelectedKey=e[0].key;d.setSelectedKey(this._sSelectedKey);}if(e.length===1){d.setVisible(false);}return d;};a.prototype._getSearchRow=function(){var L=0;var t=this;var v;this._oSearchField=new sap.m.SearchField({visible:this.getShowSearchBar(),liveChange:function(e){v=e.getSource().getValue();var d=(v?300:0);clearTimeout(L);if(d){L=setTimeout(function(){t._executeSearch(v);},d);}else{t._executeSearch(v);}},search:function(e){v=e.getSource().getValue();t._executeSearch(v);},layoutData:new sap.m.FlexItemData({growFactor:2})});return this._oSearchField;};a.prototype._executeSearch=function(v){var f=[];var o=new sap.ui.model.Filter("fieldLabel",sap.ui.model.FilterOperator.Contains,v);var Q=new sap.ui.model.Filter("quickInfo",sap.ui.model.FilterOperator.Contains,v);var b=new sap.ui.model.Filter([o,Q],false);f.push(b);var i=this._oTable.getBinding("items");i.filter(f,"Application");};a.prototype._getFieldsRow=function(){this._oScrollView.setVertical(true);this._oScrollView.addStyleClass("sapUiCompFieldSelectorScrollContainer");var c=[new sap.m.Column({header:new sap.m.Label({text:this._fieldLabelText})})];this._oTable=new sap.m.Table("sapUiCompFieldSelectorTable",{mode:"SingleSelectMaster",columns:c,selectionChange:q.proxy(function(e){var s=this.getSelectedField();this.fireFieldSelectionChanged(s);},this)});this._oTable.setFixedLayout(false);this._updateTableData();this._oScrollView.addContent(this._oTable);this._handleResizeDialog();return this._oScrollView;};a.prototype._updateTableData=function(){var m=new sap.ui.model.json.JSONModel();m.setData({modelData:this._oFieldController.getFields()});var t=new sap.m.ColumnListItem({cells:[new sap.m.Text({text:"{fieldLabel}",tooltip:a._tooltipBinding,wrapping:false})],visible:{path:"fieldLabel",formatter:function(f){return!!f;}}});this._oTable.setModel(m);this._oTable.getModel().setSizeLimit(this._oFieldController.getMaxEntitySetSize()+5);this._oTable.bindItems("/modelData/"+this._sSelectedKey,t);};a.prototype._updateCreateButtonState=function(){if(!this._bDisplayFieldExtButton){this._oCreateButton.setVisible(false);}else{var t=this;var m=this._oFieldController.getMetaDataAnalyzer();t._oCreateButton.setEnabled(false);try{var p=sap.ui.fl.fieldExt.Access.getBusinessContexts(m.oModel.sServiceUrl,this._sSelectedKey);p.done(function(r){if(r){if(r.BusinessContexts){if(r.BusinessContexts.length>0){t._oCurrentFieldExtInfo=r;t._oCreateButton.setEnabled(true);}}}});p.fail(function(e){t._oCreateButton.setEnabled(false);if(e){if(q.isArray(e.errorMessages)){for(var i=0;i<e.errorMessages.length;i++){q.sap.log.error(e.errorMessages[i].text);}}}});}catch(e){t._oCreateButton.setEnabled(false);q.sap.log.error("exception occured in sap.ui.fl.fieldExt.Access.getBusinessContexts");}}};a.prototype.exit=function(){if(this._oResizeDialogHandlerId){sap.ui.core.ResizeHandler.deregister(this._oResizeDialogHandlerId);}if(this._oResizeHeaderHandlerId){sap.ui.core.ResizeHandler.deregister(this._oResizeHeaderHandlerId);}if(this._oResizeScrollViewHandlerId){sap.ui.core.ResizeHandler.deregister(this._oResizeScrollViewHandlerId);}this.destroyAggregation("content");this._oFieldController.destroy();this._sSelectedKey=null;this._oTable=null;this._oScrollView=null;this._oSearchField=null;this._oHeaderLayout=null;if(this._oConverter&&this._oConverter.destroy){this._oConverter.destroy();}this._oConverter=null;if(this._oCreateButton){if(this._oCreateButton.destroy){this._oCreateButton.destroy();}}this._oCreateButton=null;this._oCurrentFieldExtInfo=null;};return a;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.personalization.BaseController')){jQuery.sap.declare('sap.ui.comp.personalization.BaseController');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.m.P13nItem');jQuery.sap.require('sap.ui.base.ManagedObject');jQuery.sap.require('sap.ui.table.Table');sap.ui.define("sap/ui/comp/personalization/BaseController",['jquery.sap.global','sap/m/P13nItem','sap/ui/base/ManagedObject','./Util','sap/ui/table/Table'],function(q,P,M,U,T){"use strict";var B=M.extend("sap.ui.comp.personalization.BaseController",{metadata:{"abstract":true,library:"sap.ui.comp",properties:{type:{type:"string",group:"Misc",defaultValue:null},model:{type:"sap.ui.model.json.JSONModel",group:"Misc",defaultValue:null},persistentDataRestore:{type:"object",group:"Misc",defaultValue:null,visibility:"hidden"},ignoreColumnKeys:{type:"object",group:"Misc",defaultValue:[],visibility:"hidden"}},associations:{table:{type:"sap.ui.core.Control",multiple:false}},events:{beforePotentialTableChange:{},afterPotentialTableChange:{}}}});B.prototype.init=function(){};B.prototype.setModelFunction=function(){var t=this;return function(){if(!this.getModel("$sapmP13nPanel")){this.setModel(t.getModel("$sapuicomppersonalizationBaseController"),"$sapmP13nPanel");}};};B.prototype.getTable=function(){var t=this.getAssociation("table");if(typeof t==="string"){t=sap.ui.getCore().byId(t);}return t;};B.prototype.createPersistentStructure=function(i){i=i||[];var p={};p[this.getType()]={};p[this.getType()][this.getType()+"Items"]=i;return p;};B.prototype.getPersistentData=function(){var d=this.getModel("$sapuicomppersonalizationBaseController").getData();var p={};if(!d.persistentData[this.getType()]){p=this.createPersistentStructure();}else{p[this.getType()]=d.persistentData[this.getType()];}return p;};B.prototype.setPersistentData=function(d){var D=this.getModel("$sapuicomppersonalizationBaseController").getData();D.persistentData[this.getType()]=d[this.getType()];};B.prototype.getPersistentDataItems=function(){return this.getPersistentData()[this.getType()][this.getType()+"Items"];};B.prototype.getTransientData=function(){var d=this.getModel("$sapuicomppersonalizationBaseController").getData();var t={};if(!d.transientData[this.getType()]){t[this.getType()]={};t[this.getType()].title=this.getTitleText();t[this.getType()].items=[];}else{t[this.getType()]=d.transientData[this.getType()];}return t;};B.prototype.setTransientData=function(d){var D=this.getModel("$sapuicomppersonalizationBaseController").getData();D.transientData[this.getType()]=d[this.getType()];};B.prototype.initializeModel=function(m){this.setModel(m,"$sapuicomppersonalizationBaseController");this.setTransientData(this.getTransientData());this.setPersistentData(this.getPersistentData());};B.prototype.createTableRestoreJson=function(){this.setPersistentDataRestore(this._getTable2Json());};B.prototype.getTableRestoreJson=function(){return U.copy(this.getPersistentDataRestore());};B.prototype.reducePersistentModel=function(){var t=this.getTable();if(!t){return;}var c=t.getColumns();var i=[];var p=this.getPersistentData();p[this.getType()][this.getType()+"Items"].forEach(function(I){if(U.getColumn(I.columnKey,c)){i.push(I);}});p[this.getType()][this.getType()+"Items"]=i;this.setPersistentData(p);};B.prototype._getTable2Json=function(){};B.prototype.syncTable2PersistentModel=function(){this.setPersistentData(this._getTable2Json());};B.prototype.syncTable2TransientModel=function(){};B.prototype.getPanel=function(){};B.prototype.onAfterSubmit=function(p){this.syncJsonModel2Table(this.getModel("$sapuicomppersonalizationBaseController").getData().persistentData);};B.prototype.onAfterReset=function(p){};B.prototype.syncJsonModel2Table=function(j){};B.prototype.getChangeType=function(p,o){};B.prototype.getChangeData=function(p,o){};B.prototype.getUnionData=function(p,o){};B.prototype.exit=function(){};return B;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.personalization.ColumnsController')){jQuery.sap.declare('sap.ui.comp.personalization.ColumnsController');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.m.library');sap.ui.define("sap/ui/comp/personalization/ColumnsController",['jquery.sap.global','./BaseController','sap/m/library','./Util'],function(q,B,l,U){"use strict";var C=B.extend("sap.ui.comp.personalization.ColumnsController",{constructor:function(i,s){B.apply(this,arguments);this.setType(sap.m.P13nPanelType.columns);},metadata:{properties:{triggerModelChangeOnColumnInvisible:{type:"boolean",group:"Misc",defaultValue:false}},events:{afterColumnsModelDataChange:{}}}});C.prototype.setTable=function(t){B.prototype.setTable.apply(this,arguments);if(t instanceof sap.ui.table.Table){t.detachColumnMove(this._onColumnMove,this);t.detachColumnVisibility(this._onColumnVisibility,this);t.detachColumnResize(this._onColumnResize,this);t.attachColumnMove(this._onColumnMove,this);t.attachColumnVisibility(this._onColumnVisibility,this);t.attachColumnResize(this._onColumnResize,this);}};C.prototype.getTitleText=function(){return sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("PERSODIALOG_TAB_COLUMNS");};C.prototype.reducePersistentModel=function(){this.syncTable2PersistentModel();};C.prototype._getTable2Json=function(){var j=this.createPersistentStructure();var t=this.getTable();if(t){t.getColumns().forEach(function(c,i){if(U.isColumnIgnored(c,this.getIgnoreColumnKeys())){return;}j.columns.columnsItems.push({columnKey:U.getColumnKey(c),index:(c.getOrder?c.getOrder():i),visible:c.getVisible(),width:c.getWidth()});},this);}return j;};C.prototype.syncTable2PersistentModel=function(){B.prototype.syncTable2PersistentModel.apply(this,arguments);var d=this.getModel("$sapuicomppersonalizationBaseController").getData();var D=this.getChangeData(d.persistentData,this.getTableRestoreJson());if(D){d.persistentData.columns=D.columns;}else{d.persistentData.columns.columnsItems=[];}};C.prototype.syncTable2TransientModel=function(){this._syncTable2TransientModel();};C.prototype._determineTooltipText=function(o){var t=null;if(o&&o.getTooltip){if(o.getTooltip()instanceof sap.ui.core.TooltipBase){t=o.getTooltip().getTooltip_Text();}else{t=o.getTooltip_Text();}if(!t&&o instanceof sap.ui.table.AnalyticalColumn){t=o.getTooltip_AsString();}if(!t&&o.getLabel&&o.getLabel().getTooltip_Text){t=o.getLabel().getTooltip_Text();}}return t;};C.prototype._syncTable2TransientModel=function(){var t=this.getTable();var i=[];if(t){if(t instanceof sap.ui.table.Table){t.getColumns().forEach(function(o){if(U.isColumnIgnored(o,this.getIgnoreColumnKeys())){return;}var T=this._determineTooltipText(o);i.push({columnKey:U.getColumnKey(o),text:o.getLabel().getText(),tooltip:T,visible:o.getVisible(),width:o.getWidth()});},this);}else{if(t instanceof sap.m.Table){var c=t.getColumns();c.sort(function(a,b){var d=a.getOrder();var e=b.getOrder();if(d<e){return-1;}if(d>e){return 1;}return 0;});c.forEach(function(o){if(U.isColumnIgnored(o,this.getIgnoreColumnKeys())){return;}i.push({columnKey:U.getColumnKey(o),text:o.getHeader().getText(),tooltip:(o.getHeader().getTooltip()instanceof sap.ui.core.TooltipBase)?o.getHeader().getTooltip().getTooltip_Text():o.getHeader().getTooltip_Text(),visible:o.getVisible(),width:o.getWidth()});},this);}}}var I=this.getModel("$sapuicomppersonalizationBaseController").getData().transientData.columns.items;if(q(i).not(I).length!==0||q(I).not(i).length!==0){this.getModel("$sapuicomppersonalizationBaseController").getData().transientData.columns.items=i;}};C.prototype._setNewColumnItemIndex=function(d,c,n){var i=-1;if(c&&n!==null&&n!==undefined&&n>-1){i=U.getIndexByKey(d.persistentData.columns.columnsItems,U.getColumnKey(c));if(i>-1){d.persistentData.columns.columnsItems[i].index=n;}else{d.persistentData.columns.columnsItems.push({columnKey:U.getColumnKey(c),index:n});}}};C.prototype._onColumnMove=function(e){var i=0,n=null,t=null;var T=null,d=null,c=null;var N=null,o=null;c=e.getParameter("column");N=e.getParameter("newPos");this.fireBeforePotentialTableChange();if(c){T=this.getTable();o=T.indexOfColumn(c);}if(o!==null&&N!==null){d=this.getModel("$sapuicomppersonalizationBaseController").getData();if(o>N){for(i=N;i<=o;i++){if(i<o){t=T.getColumns()[i];n=i+1;}else{t=c;n=e.getParameter("newPos");}this._setNewColumnItemIndex(d,t,n);}}else{for(i=o;i<=N;i++){if(i===o){t=c;n=e.getParameter("newPos");}else{t=T.getColumns()[i];n=i-1;}this._setNewColumnItemIndex(d,t,n);}}this.getModel("$sapuicomppersonalizationBaseController").setData(d,true);this.fireAfterPotentialTableChange();this.fireAfterColumnsModelDataChange();}};C.prototype._onColumnVisibility=function(e){var d=this.getModel("$sapuicomppersonalizationBaseController").getData();var c=e.getParameter("column");var v=e.getParameter("newVisible");this.fireBeforePotentialTableChange();var i=U.getIndexByKey(d.persistentData.columns.columnsItems,U.getColumnKey(c));if(i>-1){d.persistentData.columns.columnsItems[i].visible=v;}else{d.persistentData.columns.columnsItems.push({columnKey:U.getColumnKey(c),visible:v});}this.getModel("$sapuicomppersonalizationBaseController").setData(d,true);this.fireAfterPotentialTableChange();this.fireAfterColumnsModelDataChange();};C.prototype._onColumnResize=function(e){var c=e.getParameter("column");var d=this.getModel("$sapuicomppersonalizationBaseController").getData();this.fireBeforePotentialTableChange();var i=U.getIndexByKey(d.persistentData.columns.columnsItems,U.getColumnKey(c));if(i>-1){d.persistentData.columns.columnsItems[i].width=e.getParameter("width");}else{d.persistentData.columns.columnsItems.push({columnKey:U.getColumnKey(c),width:e.getParameter("width")});}this.getModel("$sapuicomppersonalizationBaseController").setData(d,true);this.fireAfterPotentialTableChange();this.fireAfterColumnsModelDataChange();};C.prototype.getPanel=function(p){sap.ui.getCore().loadLibrary("sap.m");q.sap.require("sap/m/P13nColumnsPanel");q.sap.require("sap/m/P13nItem");q.sap.require("sap/m/P13nColumnsItem");var t=this;var v=-1;if(p&&p.visibleItemsThreshold){v=p.visibleItemsThreshold;}var P=new sap.m.P13nColumnsPanel({title:this.getTitleText(),visibleItemsThreshold:v,items:{path:'$sapmP13nPanel>/transientData/columns/items',template:new sap.m.P13nItem({columnKey:'{$sapmP13nPanel>columnKey}',text:'{$sapmP13nPanel>text}',visible:'{$sapmP13nPanel>visible}',tooltip:'{$sapmP13nPanel>tooltip}',width:"{$sapmP13nPanel>width}"})},columnsItems:{path:"$sapmP13nPanel>/persistentData/columns/columnsItems",template:new sap.m.P13nColumnsItem({columnKey:"{$sapmP13nPanel>columnKey}",index:"{$sapmP13nPanel>index}",visible:"{$sapmP13nPanel>visible}",width:"{$sapmP13nPanel>width}"})},beforeNavigationTo:t.setModelFunction()});P.attachChangeColumnsItems(function(e){var d=this.getModel("$sapuicomppersonalizationBaseController").getData();var n=e.getParameter('newItems');var E=e.getParameter('existingItems');var c=null,s=null;if(n){n.forEach(function(N){c={columnKey:N.getColumnKey()};if(N.getIndex()!==undefined){c.index=N.getIndex();}if(N.getVisible()!==undefined){c.visible=N.getVisible();}if(N.getWidth()!==undefined){c.width=N.getWidth();}d.persistentData.columns.columnsItems.push(c);});}if(E){E.forEach(function(o){c=null;s=o.getColumnKey();c=U.getArrayElementByKey("columnKey",s,d.persistentData.columns.columnsItems);if(c){if(o.getIndex()!==undefined){c.index=o.getIndex();}if(o.getVisible()!==undefined){c.visible=o.getVisible();}if(o.getWidth()!==undefined){c.width=o.getWidth();}}});}},this);P.attachSetData(function(){var d=this.getModel("$sapuicomppersonalizationBaseController").getData();this.getModel("$sapuicomppersonalizationBaseController").setData(d);},this);this._correctColumnsItemsInPersistentData();return P;};C.prototype.onAfterReset=function(p){var P=null;if(p&&p.columns&&p.columns.oPanel){P=p.columns.oPanel;P.reInitialize();}};C.prototype.onAfterSubmit=function(p){this._correctColumnsItemsInPersistentData(p);B.prototype.onAfterSubmit.apply(this,arguments);};C.prototype._correctColumnsItemsInPersistentData=function(p){this._removeIndexFromInvisibleColumnsItems();this._removeEmptyColumnsItems();if(p){this._correctColumnsItemIndexesBasedOnPayload(p);}};C.prototype._correctColumnsItemIndexesBasedOnPayload=function(p){var c=this.getModel("$sapuicomppersonalizationBaseController").getData().persistentData.columns.columnsItems;var o=null,i=null,s=null,r=-1;if(c&&c.length>0){if(p&&p.columns&&p.columns.tableItemsChanged){p.columns.selectedItems.forEach(function(S,a){i=o=null;s=S.columnKey;o=U.getArrayElementByKey("columnKey",s,c);if(o&&o.index!==undefined&&o.index!==null){i=o.index;}if(i===null||i===undefined){i=a;}if(i<=r){i=r+1;}if(Math.abs(i-r)>1){i=r+1;}if(o){o.index=i;}else{o={"columnKey":s,"index":i};c.push(o);}r=i;});}}};C.prototype._removeEmptyColumnsItems=function(){var c=this.getModel("$sapuicomppersonalizationBaseController").getData().persistentData.columns.columnsItems;var i=0,L=0,o=null;if(c&&c.length){L=c.length;for(i=0;i<L;i++){o=c[i];if(o){if(o.index!==null&&o.index!==undefined){continue;}if(o.visible!==null&&o.visible!==undefined){continue;}if(o.width!==null&&o.width!==undefined){continue;}c.splice(i,1);i-=1;}}}};C.prototype._removeIndexFromInvisibleColumnsItems=function(){var c=null,i=null,I=null,a=0;var p=this.getModel("$sapuicomppersonalizationBaseController").getData().persistentData;var t=this.getModel("$sapuicomppersonalizationBaseController").getData().transientData;var v=null;if(p&&p.columns&&p.columns.columnsItems){c=p.columns.columnsItems;this._sortArrayByPropertyName(c,"index");}if(t&&t.columns&&t.columns.items){i=t.columns.items;}if(c&&c.length){c.forEach(function(o){I=v=null;if(o.index!==undefined){v=o.visible;if(v===undefined||v===null){I=U.getArrayElementByKey("columnKey",o.columnKey,i);if(I&&I.visible!==undefined){v=I.visible;}}if(v===false){delete o.index;a+=1;}else{if(o.index>0&&o.index>=a){o.index-=a;}}}});}};C.prototype.syncJsonModel2Table=function(j){var t=this.getTable();var i=j.columns.columnsItems;this.fireBeforePotentialTableChange();if(t instanceof sap.ui.table.Table){this._applyChangesToUiTableType(t,i);}else if(t instanceof sap.m.Table){this._applyChangesToMTableType(t,i);}this.fireAfterPotentialTableChange();};C.prototype._applyChangesToUiTableType=function(t,c){var d=null,T=null;var f=t.getFixedColumnCount();var F=f===0?f:f-1;var s=function(o,T){var i=t.indexOfColumn(T);var m=o.index;if(m!==undefined&&i!==m){t.removeColumn(T);t.insertColumn(T,m);if(!(i>F&&m>F)){t.setFixedColumnCount(0);}}};var S=function(o,T){if(o.visible!==undefined&&T.getVisible()!==o.visible){T.setVisible(o.visible);}};var e=function(o,T){if(o.width!==undefined&&T.getWidth()!==o.width){T.setWidth(o.width);}};if(c.length){d=t.getColumns();c.sort(function(a,b){if(a.index<b.index){return-1;}if(a.index>b.index){return 1;}return 0;});c.forEach(function(o){T=U.getColumn(o.columnKey,d);if(T){s(o,T);S(o,T);e(o,T);}});}};C.prototype._applyChangesToMTableType=function(t,c){var T=null,d=false;var e=t.getColumns();var s=function(o,T){var m=o.index;if(m!==undefined){T.setOrder(m);d=true;}};var S=function(o,T){if(o.visible!==undefined&&T.getVisible()!==o.visible){T.setVisible(o.visible);}};if(c.length){e=t.getColumns();c.sort(function(a,b){if(a.index<b.index){return-1;}if(a.index>b.index){return 1;}return 0;});c.forEach(function(o){T=U.getColumn(o.columnKey,e);if(T){s(o,T);S(o,T);}});}if(d){t.rerender();}};C.prototype.getChangeType=function(p,P){var c=this.getChangeData(p,P);var n;var t=this;if(c){var o=sap.ui.comp.personalization.ChangeType.TableChanged;c.columns.columnsItems.some(function(i){n=t.getTable()instanceof sap.ui.table.AnalyticalTable||t.getTriggerModelChangeOnColumnInvisible();if(i.visible||(i.visible===false&&n)){o=sap.ui.comp.personalization.ChangeType.ModelChanged;return true;}});return o;}return sap.ui.comp.personalization.ChangeType.Unchanged;};C.prototype.getChangeData=function(p,P){if(!P||!P.columns||!P.columns.columnsItems){return null;}var c={columns:U.copy(p.columns)};var i=true;p.columns.columnsItems.some(function(I){var o=U.getArrayElementByKey("columnKey",I.columnKey,P.columns.columnsItems);if(!U.semanticEqual(I,o)){i=false;return true;}});if(i){return null;}var t=[];c.columns.columnsItems.forEach(function(I,a){var o=U.getArrayElementByKey("columnKey",I.columnKey,P.columns.columnsItems);if(U.semanticEqual(I,o)){t.push(I);return;}for(var b in I){if(b==="columnKey"||!o){if(o&&o[b]===undefined){delete I[b];}else{continue;}}if(I[b]===o[b]){delete I[b];}}if(Object.keys(I).length<2){t.push(I);}});t.forEach(function(I){var a=U.getIndexByKey(c.columns.columnsItems,I.columnKey);c.columns.columnsItems.splice(a,1);});return c;};C.prototype._sortArrayByPropertyName=function(A,p,t){var s=[];if(t===null||t===undefined){t=false;}if(A&&A.length>0&&p!==undefined&&p!==null&&p!==""){if(t){s=q.extend(true,[],A);}else{s=A;}s.sort(function(a,b){var c=a[p];var d=b[p];if(c<d||(c!==undefined&&d===undefined)){return-1;}if(c>d||(c===undefined&&d!==undefined)){return 1;}return 0;});}return s;};C.prototype._recalculateIndexes=function(o,s,e){var m=null,M=null,i=null;if(!o||!o.length){return;}i=o.length-1;if(s===null||s===undefined||s<0||e===null||e===undefined||e<0||e>i||s===e){return;}m=Math.min(s,e);M=Math.max(s,e);o.forEach(function(O,I){if(I<m||I>M||I>i){return;}if(s>e){O.index+=1;}else{O.index-=1;}});};C.prototype.getUnionData=function(p,P){if(!P||!P.columns||!P.columns.columnsItems||P.columns.columnsItems.length===0){return p.columns?{columns:q.extend(true,{},p.columns)}:null;}if(!p||!p.columns||!p.columns.columnsItems){return{columns:q.extend(true,{},P.columns)};}var d=[];var u=this.createPersistentStructure();p.columns.columnsItems.forEach(function(c,i){var o=U.getArrayElementByKey("columnKey",c.columnKey,P.columns.columnsItems);if(o){if(o.visible!==undefined){c.visible=o.visible;}if(o.width!==undefined){c.width=o.width;}if(o.index!==undefined){c.index=o.index;d.push(c);return;}}u.columns.columnsItems.push(c);});if(d&&d.length>0){this._sortArrayByPropertyName(d,"index");d.forEach(function(D){u.columns.columnsItems.splice(D.index,0,D);});}u.columns.columnsItems.forEach(function(c,i){c.index=i;});return u;};C.prototype.isColumnSelected=function(p,P,c){if(!p){P.columnsItems.some(function(o,I){if(o.columnKey===c&&o.visible){i=I;return true;}});return i>-1;}if(!p.selectedItems){return false;}var i=U.getIndexByKey(p.selectedItems,c);return i>-1;};C.prototype.exit=function(){B.prototype.exit.apply(this,arguments);var t=this.getTable();if(t&&t instanceof sap.ui.table.Table){t.detachColumnMove(this._onColumnMove,this);t.detachColumnVisibility(this._onColumnVisibility,this);t.detachColumnResize(this._onColumnResize,this);}};return C;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.personalization.DimeasureController')){jQuery.sap.declare('sap.ui.comp.personalization.DimeasureController');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.m.library');sap.ui.define("sap/ui/comp/personalization/DimeasureController",['jquery.sap.global','./BaseController','sap/m/library','sap/ui/comp/library','./ChartWrapper','./Util'],function(q,B,M,C,c,U){"use strict";var D=B.extend("sap.ui.comp.personalization.DimeasureController",{constructor:function(i,s){B.apply(this,arguments);this.setType(sap.m.P13nPanelType.dimeasure);},metadata:{events:{afterDimeasureModelDataChange:{}}}});D.prototype.setTable=function(t){B.prototype.setTable.apply(this,arguments);if(!(t instanceof c)){throw"The provided object is incorrect. 'oTable' has to be an instance of sap.ui.comp.personalization.ChartWrapper. ";}var o=t.getChartObject();o.detachDrilledDown(this._onDrilledDown,this);o.attachDrilledDown(this._onDrilledDown,this);o.detachDrilledUp(this._onDrilledUp,this);o.attachDrilledUp(this._onDrilledUp,this);var a=this;var d=this.getModel("$sapuicomppersonalizationBaseController").getData();var s=q.proxy(o.setChartType,o);var S=function(b){s(b);if(b&&b!==d.persistentData.dimeasure.chartTypeKey){a.fireBeforePotentialTableChange();d.persistentData.dimeasure.chartTypeKey=b;a.fireAfterPotentialTableChange();a.fireAfterDimeasureModelDataChange();}};if(o.setChartType.toString()===S.toString()){return;}o.setChartType=S;};D.prototype._onDrilledDown=function(e){this._updateModel(e.getSource());};D.prototype._onDrilledUp=function(e){this._updateModel(e.getSource());};D.prototype._updateModel=function(o){var m=this.getModel("$sapuicomppersonalizationBaseController");var d=m.getData();var a=this.getTable().getColumns();this.fireBeforePotentialTableChange();d.persistentData.dimeasure.dimeasureItems=[];o.getVisibleDimensions().forEach(function(s){var b=U.getColumn(s,a);d.persistentData.dimeasure.dimeasureItems.push({columnKey:U.getColumnKey(b),index:d.persistentData.dimeasure.dimeasureItems.length,visible:true,role:b.getRole()});},this);o.getVisibleMeasures().forEach(function(s){var b=U.getColumn(s,a);d.persistentData.dimeasure.dimeasureItems.push({columnKey:U.getColumnKey(b),index:d.persistentData.dimeasure.dimeasureItems.length,visible:true,role:b.getRole()});});m.refresh();this.fireAfterPotentialTableChange();this.fireAfterDimeasureModelDataChange();};D.prototype.createPersistentStructure=function(i){var p=B.prototype.createPersistentStructure.apply(this,arguments);p.dimeasure.chartTypeKey="";return p;};D.prototype.getTitleText=function(){return sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("PERSODIALOG_TAB_DIMEASURE");};D.prototype.onAfterSubmit=function(p){if(!p||!p.dimeasure){return;}var d=this.getModel("$sapuicomppersonalizationBaseController").getData();d.persistentData.dimeasure.dimeasureItems=[];p.dimeasure.dimMeasureItems.forEach(function(o){d.persistentData.dimeasure.dimeasureItems.push({columnKey:o.getColumnKey(),index:o.getIndex(),visible:o.getVisible(),role:o.getRole()});});d.persistentData.dimeasure.chartTypeKey=p.dimeasure.chartTypeKey;this.getModel("$sapuicomppersonalizationBaseController").refresh();B.prototype.onAfterSubmit.apply(this,arguments);};D.prototype.syncJsonModel2Table=function(j){var t=this.getTable();var o=t.getChartObject();var d=[];var m=[];var u=function(e,s,S,g){var f=U.copy(e);f.sort(function(a,b){if(a.index<b.index){return-1;}else if(a.index>b.index){return 1;}else{return 0;}});var h=[];f.forEach(function(a){if(a.visible===true){h.push(a.columnKey);var b=g(a.columnKey);if(b){b.setRole(a.role);}}});if(JSON.stringify(h)!==JSON.stringify(s)){S(h);}};this.fireBeforePotentialTableChange();U.splitDimeasures(j.dimeasure.dimeasureItems,this.getModel("$sapuicomppersonalizationBaseController").getData().transientData.dimeasure.items,d,m);var v=o.getVisibleDimensions();u(d,v,q.proxy(o.setVisibleDimensions,o),q.proxy(o.getDimensionByName,o));var V=o.getVisibleMeasures();u(m,V,q.proxy(o.setVisibleMeasures,o),q.proxy(o.getMeasureByName,o));o.setChartType(j.dimeasure.chartTypeKey);this.fireAfterPotentialTableChange();};D.prototype._getTable2Json=function(){var j=this.createPersistentStructure();var t=this.getTable();if(!t){return j;}var o=t.getChartObject();var v=o.getVisibleDimensions();var V=o.getVisibleMeasures();var a=t.getColumns();j.dimeasure.chartTypeKey=o.getChartType();v.forEach(function(d){var b=U.getColumn(d,a);if(U.isColumnIgnored(b,this.getIgnoreColumnKeys())){return;}if(b.getAggregationRole()!==sap.ui.comp.personalization.AggregationRole.Dimension&&b.getAggregationRole()!==sap.ui.comp.personalization.AggregationRole.Measure){return;}j.dimeasure.dimeasureItems.push({columnKey:U.getColumnKey(b),index:j.dimeasure.dimeasureItems.length,visible:true,role:b.getRole()});},this);V.forEach(function(m){var b=U.getColumn(m,a);if(U.isColumnIgnored(b,this.getIgnoreColumnKeys())){return;}if(b.getAggregationRole()!==sap.ui.comp.personalization.AggregationRole.Dimension&&b.getAggregationRole()!==sap.ui.comp.personalization.AggregationRole.Measure){return;}j.dimeasure.dimeasureItems.push({columnKey:U.getColumnKey(b),index:j.dimeasure.dimeasureItems.length,visible:true,role:b.getRole()});},this);return j;};D.prototype.syncTable2TransientModel=function(){var i=[];var t=this.getTable();if(!t){return;}t.getColumns().forEach(function(o){if(U.isColumnIgnored(o,this.getIgnoreColumnKeys())){return;}if(o.getAggregationRole()===sap.ui.comp.personalization.AggregationRole.NotDimeasure){return;}i.push({columnKey:U.getColumnKey(o),text:o.getLabel(),tooltip:o.getTooltip(),aggregationRole:o.getAggregationRole()});},this);var I=this.getModel("$sapuicomppersonalizationBaseController").getData().transientData.dimeasure.items;if(q(i).not(I).length!==0||q(I).not(i).length!==0){this.getModel("$sapuicomppersonalizationBaseController").getData().transientData.dimeasure.items=i;}};D.prototype.getPanel=function(p){sap.ui.getCore().loadLibrary("sap.m");q.sap.require("sap/m/P13nDimMeasurePanel");q.sap.require("sap/m/P13nItem");q.sap.require("sap/m/P13nDimMeasureItem");var t=this;var a=[];if(p&&p.availableChartTypes){a=p.availableChartTypes;}var P=new sap.m.P13nDimMeasurePanel({title:this.getTitleText(),availableChartTypes:a,chartTypeKey:"{$sapmP13nPanel>/persistentData/dimeasure/chartTypeKey}",items:{path:'$sapmP13nPanel>/transientData/dimeasure/items',template:new sap.m.P13nItem({columnKey:'{$sapmP13nPanel>columnKey}',text:'{$sapmP13nPanel>text}',tooltip:'{$sapmP13nPanel>tooltip}',aggregationRole:'{$sapmP13nPanel>aggregationRole}'})},dimMeasureItems:{path:"$sapmP13nPanel>/persistentData/dimeasure/dimeasureItems",template:new sap.m.P13nDimMeasureItem({columnKey:"{$sapmP13nPanel>columnKey}",index:"{$sapmP13nPanel>index}",visible:"{$sapmP13nPanel>visible}",role:"{$sapmP13nPanel>role}"})},beforeNavigationTo:t.setModelFunction()});return P;};D.prototype._isDimMeasureItemEqual=function(d,o){if(!d&&!o){return true;}if(d&&!o){if(d.index===-1&&d.visible===false){return true;}return false;}if(o&&!d){if(o.index===-1&&o.visible===false){return true;}return false;}for(var p in d){if(o[p]===undefined||d[p]!==o[p]){return false;}}return true;};D.prototype._isSemanticEqual=function(p,P){if(p.dimeasure.chartTypeKey!==P.dimeasure.chartTypeKey){return false;}var s=function(a,b){if(a.visible===true&&(b.visible===false||b.visible===undefined)){return-1;}else if((a.visible===false||a.visible===undefined)&&b.visible===true){return 1;}else if(a.visible===true&&b.visible===true){if(a.index<b.index){return-1;}else if(a.index>b.index){return 1;}else{return 0;}}else if((a.visible===false||a.visible===undefined)&&(b.visible===false||b.visible===undefined)){if(a.columnKey<b.columnKey){return-1;}else if(a.columnKey>b.columnKey){return 1;}else{return 0;}}};var d=U.copy(p.dimeasure.dimeasureItems).sort(s);var e=U.copy(P.dimeasure.dimeasureItems).sort(s);var i=true;d.some(function(o,I){if(!this._isDimMeasureItemEqual(o,e[I])){i=false;return true;}},this);return i;};D.prototype.getChangeType=function(p,P){if(!P||!P.dimeasure||!P.dimeasure.dimeasureItems){return sap.ui.comp.personalization.ChangeType.Unchanged;}return this._isSemanticEqual(p,P)?sap.ui.comp.personalization.ChangeType.Unchanged:sap.ui.comp.personalization.ChangeType.TableChanged;};D.prototype.getChangeData=function(p,P){if(!p||!p.dimeasure||!p.dimeasure.dimeasureItems){return this.createPersistentStructure();}if(!P||!P.dimeasure||!P.dimeasure.dimeasureItems){return{chartTypeKey:p.dimeasure.chartTypeKey,dimeasure:U.copy(p.dimeasure)};}if(!this._isSemanticEqual(p,P)){return{chartTypeKey:p.dimeasure.chartTypeKey,dimeasure:U.copy(p.dimeasure)};}return null;};D.prototype.getUnionData=function(d,o){if(!o||!o.dimeasure||!o.dimeasure.dimeasureItems){return{chartTypeKey:d.dimeasure.chartTypeKey,dimeasure:U.copy(d.dimeasure)};}return{dimeasure:{chartTypeKey:o.dimeasure.chartTypeKey?o.dimeasure.chartTypeKey:d.dimeasure.chartTypeKey,dimeasureItems:U.copy(o.dimeasure.dimeasureItems)}};};D.prototype.exit=function(){B.prototype.exit.apply(this,arguments);var t=this.getTable();if(t&&t instanceof c){var o=t.getChartObject();o.detachDrilledDown(this._onDrilledDown,this);o.detachDrilledUp(this._onDrilledUp,this);}};return D;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.personalization.FilterController')){jQuery.sap.declare('sap.ui.comp.personalization.FilterController');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.m.library');sap.ui.define("sap/ui/comp/personalization/FilterController",['jquery.sap.global','./BaseController','sap/m/library','./Util','./ChartWrapper'],function(q,B,l,U,C){"use strict";var F=B.extend("sap.ui.comp.personalization.FilterController",{constructor:function(i,s){B.apply(this,arguments);this.setType(sap.m.P13nPanelType.filter);},metadata:{events:{afterFilterModelDataChange:{}}}});F.prototype.setTable=function(t){B.prototype.setTable.apply(this,arguments);if(t instanceof sap.ui.table.Table){t.detachFilter(this._onFilter,this);t.attachFilter(this._onFilter,this);}if(t instanceof C){var c=t.getChartObject();c.detachDrilledDown(this._onDrilledDown,this);c.attachDrilledDown(this._onDrilledDown,this);c.detachDrilledUp(this._onDrilledUp,this);c.attachDrilledUp(this._onDrilledUp,this);}};F.prototype.getTitleText=function(){return sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("PERSODIALOG_TAB_FILTER");};sap.ui.comp.personalization.FilterController.prototype._getTable2Json=function(){var j=this.createPersistentStructure();var t=this.getTable();if(t){if(t instanceof sap.ui.table.Table){t.getColumns().forEach(function(c){if(U.isColumnIgnored(c,this.getIgnoreColumnKeys())){return;}if(c.getFiltered()){j.filter.filterItems.push({columnKey:U.getColumnKey(c),operation:c.getFilterOperator(),value1:c.getFilterValue(),value2:""});}},this);}}return j;};F.prototype.syncTable2TransientModel=function(){var t=this.getTable();var i=[];if(t){var b,v,o;if(t.getModel()instanceof sap.ui.model.odata.ODataModel||t.getModel()instanceof sap.ui.model.odata.v2.ODataModel){q.sap.require("sap.ui.model.odata.type.Boolean");o=new sap.ui.model.odata.type.Boolean();}else{if(t.getModel()instanceof sap.ui.model.Model){q.sap.require("sap.ui.model.type.Boolean");o=new sap.ui.model.type.Boolean();}}if(o){b=["",o.formatValue(false,"string"),o.formatValue(true,"string")];}if(t instanceof sap.ui.table.Table){t.getColumns().forEach(function(c){if(U.isColumnIgnored(c,this.getIgnoreColumnKeys())){return;}if(U.isFilterable(c)){if(U.getColumnType(c)==="boolean"){v=U._getCustomProperty(c,"values")||b;}i.push({columnKey:U.getColumnKey(c),text:c.getLabel().getText(),tooltip:(c.getTooltip()instanceof sap.ui.core.TooltipBase)?c.getTooltip().getTooltip_Text():c.getTooltip_Text(),maxLength:U._getCustomProperty(c,"maxLength"),precision:U._getCustomProperty(c,"precision"),scale:U._getCustomProperty(c,"scale"),type:U.getColumnType(c),values:v});}},this);}else if(t instanceof sap.m.Table){t.getColumns().forEach(function(c){if(U.isColumnIgnored(c,this.getIgnoreColumnKeys())){return;}if(U.getColumnType(c)==="boolean"){v=U._getCustomProperty(c,"values")||b;}if(U.isFilterable(c)){i.push({columnKey:U.getColumnKey(c),text:c.getHeader().getText(),tooltip:(c.getHeader().getTooltip()instanceof sap.ui.core.TooltipBase)?c.getHeader().getTooltip().getTooltip_Text():c.getHeader().getTooltip_Text(),maxLength:U._getCustomProperty(c,"maxLength"),precision:U._getCustomProperty(c,"precision"),scale:U._getCustomProperty(c,"scale"),type:U.getColumnType(c),values:v});}},this);}else if(t instanceof sap.ui.comp.personalization.ChartWrapper){t.getColumns().forEach(function(c){if(U.isColumnIgnored(c,this.getIgnoreColumnKeys())){return;}if(U.isFilterable(c)){i.push({columnKey:U.getColumnKey(c),text:c.getLabel(),tooltip:(c.getTooltip()instanceof sap.ui.core.TooltipBase)?c.getTooltip().getTooltip_Text():c.getTooltip_Text(),maxLength:U._getCustomProperty(c,"maxLength"),precision:U._getCustomProperty(c,"precision"),scale:U._getCustomProperty(c,"scale"),type:U.getColumnType(c),values:v});}},this);}}U.sortItemsByText(i);var I=this.getModel("$sapuicomppersonalizationBaseController").getData().transientData.filter.items;if(q(i).not(I).length!==0||q(I).not(i).length!==0){this.getModel("$sapuicomppersonalizationBaseController").getData().transientData.filter.items=i;}};F.prototype._onFilter=function(e){};F.prototype._onDrilledDown=function(e){this._updateModel(e.getSource());};F.prototype._onDrilledUp=function(e){this._updateModel(e.getSource());};F.prototype._updateModel=function(c){var m=this.getModel("$sapuicomppersonalizationBaseController");var d=m.getData();var a=this.getTable().getColumns();this.fireBeforePotentialTableChange();d.persistentData.filter.filterItems=d.persistentData.filter.filterItems.filter(function(f){return f.source!=="chart";});c.getVisibleDimensions().forEach(function(D){this._addSelectedFilterForDimensions(c,D,d,a);},this);m.refresh();this.fireAfterPotentialTableChange();this.fireAfterFilterModelDataChange();};F.prototype._addSelectedFilterForDimensions=function(c,s,d,a){var t=this;var T=function(f){if(!f){return;}if(f&&f.sPath&&f.sOperator){var o=U.getColumn(f.sPath,a);if(!o){return;}if(U.isColumnIgnored(o,t.getIgnoreColumnKeys())){return;}var b={columnKey:f.sPath,operation:f.sOperator,value1:f.oValue1,value2:f.oValue2,source:"chart"};if(t._hasSemanticEqual(b,d.persistentData.filter.filterItems)){return;}d.persistentData.filter.filterItems.push(b);}if(f.aFilters){f.aFilters.forEach(function(e){T(e);});}};c._drillStateStack.forEach(function(S){if(S.dimensions.indexOf(s)>-1){T(S.filter);}});};F.prototype._hasSemanticEqual=function(f,a){if(!f||!a.length){return false;}var e=a.filter(function(o){for(var p in f){if(f[p]!==o[p]){return false;}}return true;});return e.length>0;};F.prototype._hasTableFilterableColumns=function(){var t=this.getTable();if(!t){return false;}var h=false;t.getColumns().some(function(c){if(U.isFilterable(c)){h=true;return true;}});return h;};F.prototype.getPanel=function(p){sap.ui.getCore().loadLibrary("sap.m");q.sap.require("sap/m/P13nFilterPanel");q.sap.require("sap/m/P13nItem");q.sap.require("sap/m/P13nFilterItem");if(!this._hasTableFilterableColumns()){return null;}if(p&&p.column){var c=U.getColumnKey(p.column);if(c){var i=this.getModel("$sapuicomppersonalizationBaseController").getData().transientData.filter.items;i.forEach(function(I,a){I["isDefault"]=I.columnKey===c;},this);}}var t=this;var P=new sap.m.P13nFilterPanel({containerQuery:true,title:this.getTitleText(),items:{path:"$sapmP13nPanel>/transientData/filter/items",template:new sap.m.P13nItem({columnKey:'{$sapmP13nPanel>columnKey}',text:"{$sapmP13nPanel>text}",tooltip:"{$sapmP13nPanel>tooltip}",maxLength:"{$sapmP13nPanel>maxLength}",precision:"{$sapmP13nPanel>precision}",scale:"{$sapmP13nPanel>scale}",type:"{$sapmP13nPanel>type}",isDefault:"{$sapmP13nPanel>isDefault}",values:"{$sapmP13nPanel>values}"})},filterItems:{path:"$sapmP13nPanel>/persistentData/filter/filterItems",template:new sap.m.P13nFilterItem({key:"{$sapmP13nPanel>key}",columnKey:"{$sapmP13nPanel>columnKey}",exclude:"{$sapmP13nPanel>exclude}",operation:"{$sapmP13nPanel>operation}",value1:"{$sapmP13nPanel>value1}",value2:"{$sapmP13nPanel>value2}"})},beforeNavigationTo:t.setModelFunction()});P.attachAddFilterItem(function(e){var d=this.getModel("$sapuicomppersonalizationBaseController").getData();var a=e.getParameters();var f={columnKey:a.filterItemData.getColumnKey(),operation:a.filterItemData.getOperation(),exclude:a.filterItemData.getExclude(),value1:a.filterItemData.getValue1(),value2:a.filterItemData.getValue2()};if(a.index>-1){d.persistentData.filter.filterItems.splice(a.index,0,f);}else{d.persistentData.filter.filterItems.push(f);}this.getModel("$sapuicomppersonalizationBaseController").setData(d,true);},this);P.attachRemoveFilterItem(function(e){var a=e.getParameters();var d=this.getModel("$sapuicomppersonalizationBaseController").getData();if(a.index>-1){d.persistentData.filter.filterItems.splice(a.index,1);this.getModel("$sapuicomppersonalizationBaseController").setData(d,true);}},this);return P;};F.prototype.syncJsonModel2Table=function(j){var t=this.getTable();var c=t.getColumns();var a=q.extend(true,[],c);this.fireBeforePotentialTableChange();if(t instanceof sap.ui.table.Table){j.filter.filterItems.forEach(function(f){var o=U.getColumn(f.columnKey,c);if(o){if(!o.getFiltered()){o.setFiltered(true);}a.splice(a.indexOf(o),1);}});a.forEach(function(o){if(o&&o.getFiltered()){o.setFiltered(false);}});}this.fireAfterPotentialTableChange();};F.prototype.getChangeType=function(p,P){if(!P||!P.filter||!P.filter.filterItems){return sap.ui.comp.personalization.ChangeType.Unchanged;}if(P&&P.filter&&P.filter.filterItems){P.filter.filterItems.forEach(function(f){delete f.key;delete f.source;});}if(p&&p.filter&&p.filter.filterItems){p.filter.filterItems.forEach(function(f){delete f.key;delete f.source;});}var i=JSON.stringify(p.filter.filterItems)!==JSON.stringify(P.filter.filterItems);return i?sap.ui.comp.personalization.ChangeType.ModelChanged:sap.ui.comp.personalization.ChangeType.Unchanged;};F.prototype.getChangeData=function(p,P){if(!p||!p.filter||!p.filter.filterItems){return this.createPersistentStructure();}if(P&&P.filter&&P.filter.filterItems){P.filter.filterItems.forEach(function(f){delete f.key;delete f.source;});}if(p&&p.filter&&p.filter.filterItems){p.filter.filterItems.forEach(function(f){delete f.key;delete f.source;});}if(!P||!P.filter||!P.filter.filterItems){return{filter:U.copy(p.filter)};}if(JSON.stringify(p.filter.filterItems)!==JSON.stringify(P.filter.filterItems)){return{filter:U.copy(p.filter)};}return null;};F.prototype.getUnionData=function(p,P){if(!p||!p.filter||!p.filter.filterItems){return this.createPersistentStructure();}if(!P||!P.filter||!P.filter.filterItems){return{filter:U.copy(p.filter)};}return{filter:U.copy(P.filter)};};F.prototype.exit=function(){B.prototype.exit.apply(this,arguments);var t=this.getTable();if(t&&t instanceof sap.ui.table.Table){t.detachFilter(this._onFilter,this);}if(t&&t instanceof C){var c=t.getChartObject();c.detachDrilledDown(this._onDrilledDown,this);c.detachDrilledUp(this._onDrilledUp,this);}};return F;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.personalization.GroupController')){jQuery.sap.declare('sap.ui.comp.personalization.GroupController');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.m.library');sap.ui.define("sap/ui/comp/personalization/GroupController",['jquery.sap.global','./BaseController','sap/m/library'],function(q,B,l){"use strict";var G=B.extend("sap.ui.comp.personalization.GroupController",{constructor:function(i,s){B.apply(this,arguments);this.setType(sap.m.P13nPanelType.group);},metadata:{events:{afterGroupModelDataChange:{}}}});G.prototype.setTable=function(t){B.prototype.setTable.apply(this,arguments);if(t instanceof sap.ui.table.AnalyticalTable||t instanceof sap.ui.table.Table){t.detachGroup(this._onGroup,this);t.attachGroup(this._onGroup,this);}};G.prototype.getTitleText=function(){return sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("PERSODIALOG_TAB_GROUP");};G.prototype._getTable2Json=function(){var j=this.createPersistentStructure();var t=this.getTable();if(t){var c=[];if(t instanceof sap.ui.table.Table&&t.getGroupBy){c=t.getGroupBy()||[];if(typeof c==="string"){c=[c];}}if(t instanceof sap.ui.table.AnalyticalTable&&t.getGroupedColumns){c=t.getGroupedColumns()||[];}c.forEach(function(C,i){if(typeof C==="string"){C=sap.ui.getCore().byId(C);}if(sap.ui.comp.personalization.Util.isColumnIgnored(C,this.getIgnoreColumnKeys())){return;}if(C.getGrouped()){q.sap.require("sap/m/P13nConditionPanel");j.group.groupItems.push({columnKey:sap.ui.comp.personalization.Util.getColumnKey(C),operation:C.getSortOrder&&C.getSortOrder()===sap.ui.table.SortOrder.Ascending?sap.m.P13nConditionOperation.GroupAscending:sap.m.P13nConditionOperation.GroupDescending,showIfGrouped:C.getShowIfGrouped?C.getShowIfGrouped():false});}},this);}return j;};G.prototype.syncTable2TransientModel=function(){var t=this.getTable();var i=[];if(t){if(t instanceof sap.ui.table.AnalyticalTable||t instanceof sap.ui.table.Table){t.getColumns().forEach(function(c){if(sap.ui.comp.personalization.Util.isColumnIgnored(c,this.getIgnoreColumnKeys())){return;}if(sap.ui.comp.personalization.Util.isGroupable(c)){i.push({columnKey:sap.ui.comp.personalization.Util.getColumnKey(c),text:c.getLabel().getText(),tooltip:(c.getTooltip()instanceof sap.ui.core.TooltipBase)?c.getTooltip().getTooltip_Text():c.getTooltip_Text()});}},this);}if(t instanceof sap.m.Table){t.getColumns().forEach(function(c){if(sap.ui.comp.personalization.Util.isColumnIgnored(c,this.getIgnoreColumnKeys())){return;}if(sap.ui.comp.personalization.Util.isGroupable(c)){i.push({columnKey:sap.ui.comp.personalization.Util.getColumnKey(c),text:c.getHeader().getText(),tooltip:(c.getHeader().getTooltip()instanceof sap.ui.core.TooltipBase)?c.getHeader().getTooltip().getTooltip_Text():c.getHeader().getTooltip_Text()});}},this);}}sap.ui.comp.personalization.Util.sortItemsByText(i);i.splice(0,0,{key:null,text:sap.ui.getCore().getLibraryResourceBundle("sap.m").getText("P13NDIALOG_SELECTION_NONE")});var g=this.getModel("$sapuicomppersonalizationBaseController").getData().transientData.group.items;if(q(i).not(g).length!==0||q(g).not(i).length!==0){this.getModel("$sapuicomppersonalizationBaseController").getData().transientData.group.items=i;}};G.prototype._onGroup=function(e){var t=this.getTable();var g=e.mParameters.groupedColumns;this.fireBeforePotentialTableChange();var d=this.getModel("$sapuicomppersonalizationBaseController").getData();d.persistentData.group.groupItems=[];g.forEach(function(c,i){if(typeof c==="string"){c=sap.ui.getCore().byId(c);}if(t&&t instanceof sap.ui.table.AnalyticalTable){if(c.getGrouped()){d.persistentData.group.groupItems.push({columnKey:sap.ui.comp.personalization.Util.getColumnKey(c),showIfGrouped:c.getShowIfGrouped?c.getShowIfGrouped():false});}}else if(t&&t instanceof sap.ui.table.Table){d.persistentData.group.groupItems.push({columnKey:sap.ui.comp.personalization.Util.getColumnKey(c),showIfGrouped:false});}},this);this.fireAfterPotentialTableChange();this.fireAfterGroupModelDataChange();};G.prototype._hasTableGroupableColumns=function(){var t=this.getTable();if(!t){return false;}var h=false;t.getColumns().some(function(c){if(sap.ui.comp.personalization.Util.isGroupable(c)){h=true;return true;}});return h;};G.prototype.getPanel=function(){sap.ui.getCore().loadLibrary("sap.m");q.sap.require("sap/m/P13nGroupPanel");q.sap.require("sap/m/P13nItem");q.sap.require("sap/m/P13nGroupItem");if(!this._hasTableGroupableColumns()){return null;}var t=this;var p=new sap.m.P13nGroupPanel({maxGroups:this.getTable()instanceof sap.ui.table.AnalyticalTable?"-1":"1",title:this.getTitleText(),containerQuery:true,items:{path:"$sapmP13nPanel>/transientData/group/items",template:new sap.m.P13nItem({columnKey:"{$sapmP13nPanel>columnKey}",text:"{$sapmP13nPanel>text}",tooltip:"{$sapmP13nPanel>tooltip}"})},groupItems:{path:"$sapmP13nPanel>/persistentData/group/groupItems",template:new sap.m.P13nGroupItem({columnKey:"{$sapmP13nPanel>columnKey}",operation:"{$sapmP13nPanel>operation}",showIfGrouped:"{$sapmP13nPanel>showIfGrouped}"})},beforeNavigationTo:t.setModelFunction()});p.attachAddGroupItem(function(e){var d=this.getModel("$sapuicomppersonalizationBaseController").getData();var a=e.getParameters();var g={columnKey:a.groupItemData.getColumnKey(),operation:a.groupItemData.getOperation(),showIfGrouped:a.groupItemData.getShowIfGrouped()};if(a.index>-1){d.persistentData.group.groupItems.splice(a.index,0,g);}else{d.persistentData.group.groupItems.push(g);}this.getModel("$sapuicomppersonalizationBaseController").setData(d,true);},this);p.attachRemoveGroupItem(function(e){var a=e.getParameters();var d=this.getModel("$sapuicomppersonalizationBaseController").getData();if(a.index>-1){d.persistentData.group.groupItems.splice(a.index,1);this.getModel("$sapuicomppersonalizationBaseController").setData(d,true);}},this);return p;};G.prototype.syncJsonModel2Table=function(j){var t=this.getTable();var c=t.getColumns();this.fireBeforePotentialTableChange();if(t instanceof sap.ui.table.TreeTable){return;}else if(t instanceof sap.ui.table.AnalyticalTable){c.forEach(function(C){if(C&&C.getGrouped()){C.setGrouped(false);C.setShowIfGrouped(false);}});j.group.groupItems.forEach(function(g){var C=sap.ui.comp.personalization.Util.getColumn(g.columnKey,c);if(!C){return;}C.setGrouped(true);C.setShowIfGrouped(g.showIfGrouped);});}else if(t instanceof sap.ui.table.Table){if(j.group.groupItems.length>0){j.group.groupItems.some(function(g){var C=sap.ui.comp.personalization.Util.getColumn(g.columnKey,c);if(C){t.setGroupBy(C);return true;}},this);}else{t.setGroupBy(null);}}this.fireAfterPotentialTableChange();};G.prototype.getChangeType=function(p,P){if(!P||!P.group||!P.group.groupItems){return sap.ui.comp.personalization.ChangeType.Unchanged;}var i=JSON.stringify(p.group.groupItems)!==JSON.stringify(P.group.groupItems);return i?sap.ui.comp.personalization.ChangeType.ModelChanged:sap.ui.comp.personalization.ChangeType.Unchanged;};G.prototype.getChangeData=function(p,P){if(!p||!p.group||!p.group.groupItems){return this.createPersistentStructure();}if(!P||!P.group||!P.group.groupItems){return{group:sap.ui.comp.personalization.Util.copy(p.group)};}if(JSON.stringify(p.group.groupItems)!==JSON.stringify(P.group.groupItems)){return{group:sap.ui.comp.personalization.Util.copy(p.group)};}return null;};G.prototype.getUnionData=function(p,P){if(!P||!P.group||!P.group.groupItems){return{group:sap.ui.comp.personalization.Util.copy(p.group)};}return{group:sap.ui.comp.personalization.Util.copy(P.group)};};G.prototype.isGroupSelected=function(p,P,c){var i;if(!p){P.groupItems.some(function(g,I){if(g.columnKey===c){i=I;return true;}});return i>-1;}if(!p.selectedColumnKeys){return false;}if(p.selectedColumnKeys){p.selectedColumnKeys.some(function(s,I){if(s===c){i=I;return true;}});}return i>-1;};G.prototype.exit=function(){B.prototype.exit.apply(this,arguments);var t=this.getTable();if(t&&(t instanceof sap.ui.table.AnalyticalTable||t instanceof sap.ui.table.Table)){t.detachGroup(this._onGroup,this);}};return G;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.personalization.SortController')){jQuery.sap.declare('sap.ui.comp.personalization.SortController');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.m.library');sap.ui.define("sap/ui/comp/personalization/SortController",['jquery.sap.global','./BaseController','sap/m/library','./Util'],function(q,B,l,U){"use strict";var S=B.extend("sap.ui.comp.personalization.SortController",{constructor:function(i,s){B.apply(this,arguments);this.setType(sap.m.P13nPanelType.sort);},metadata:{events:{afterSortModelDataChange:{}}}});S.prototype.setTable=function(t){B.prototype.setTable.apply(this,arguments);if(t instanceof sap.ui.table.Table){t.detachSort(this._onSort,this);t.attachSort(this._onSort,this);}};S.prototype.getTitleText=function(){return sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("PERSODIALOG_TAB_SORT");};S.prototype._getTable2Json=function(){var j=this.createPersistentStructure();var t=this.getTable();U.createSort2Json(t,j.sort.sortItems,this.getIgnoreColumnKeys());return j;};S.prototype.syncTable2TransientModel=function(){var t=this.getTable();var i=[];if(t){if(t instanceof sap.ui.table.Table){t.getColumns().forEach(function(c){if(U.isColumnIgnored(c,this.getIgnoreColumnKeys())){return;}if(U.isSortable(c)){i.push({columnKey:U.getColumnKey(c),text:c.getLabel().getText(),tooltip:(c.getTooltip()instanceof sap.ui.core.TooltipBase)?c.getTooltip().getTooltip_Text():c.getTooltip_Text()});}},this);}else if(t instanceof sap.m.Table){t.getColumns().forEach(function(c){if(U.isColumnIgnored(c,this.getIgnoreColumnKeys())){return;}if(U.isSortable(c)){i.push({columnKey:U.getColumnKey(c),text:c.getHeader().getText(),tooltip:(c.getHeader().getTooltip()instanceof sap.ui.core.TooltipBase)?c.getHeader().getTooltip().getTooltip_Text():c.getHeader().getTooltip_Text()});}},this);}else if(t instanceof sap.ui.comp.personalization.ChartWrapper){t.getColumns().forEach(function(c){if(U.isColumnIgnored(c,this.getIgnoreColumnKeys())){return;}i.push({columnKey:U.getColumnKey(c),text:c.getLabel(),tooltip:(c.getTooltip()instanceof sap.ui.core.TooltipBase)?c.getTooltip().getTooltip_Text():c.getTooltip_Text()});},this);}}U.sortItemsByText(i);i.splice(0,0,{key:null,text:sap.ui.getCore().getLibraryResourceBundle("sap.m").getText("P13NDIALOG_SELECTION_NONE")});var I=this.getModel("$sapuicomppersonalizationBaseController").getData().transientData.sort.items;if(q(i).not(I).length!==0||q(I).not(i).length!==0){this.getModel("$sapuicomppersonalizationBaseController").getData().transientData.sort.items=i;}};S.prototype._onSort=function(e){e.preventDefault();var a=e.mParameters.columnAdded;var t=this.getTable();if(typeof t==="string"){t=sap.ui.getCore().byId(t);}this.fireBeforePotentialTableChange();if(!a){t.getColumns().forEach(function(c,b){if(c.setSorted){c.setSorted(false);}},this);}var c=e.mParameters.column;if(c&&c.setSorted){c.setSorted(true);c.setSortOrder(e.mParameters.sortOrder);}var s=this.getModel("$sapuicomppersonalizationBaseController").getData().persistentData.sort;if(!a){s.sortItems=[];}var i=U.getIndexByKey(s.sortItems,U.getColumnKey(c));if(i>-1){s.sortItems.splice(i,1);}s.sortItems.push({columnKey:U.getColumnKey(c),operation:e.mParameters.sortOrder});this.fireAfterPotentialTableChange();this.fireAfterSortModelDataChange();};S.prototype._hasTableSortableColumns=function(){var t=this.getTable();if(!t){return false;}var h=false;t.getColumns().some(function(c){if(U.isSortable(c)){h=true;return true;}});return h;};S.prototype.getPanel=function(){sap.ui.getCore().loadLibrary("sap.m");q.sap.require("sap/m/P13nSortPanel");q.sap.require("sap/m/P13nItem");q.sap.require("sap/m/P13nSortItem");if(!this._hasTableSortableColumns()){return null;}var t=this;var p=new sap.m.P13nSortPanel({title:this.getTitleText(),containerQuery:true,items:{path:"$sapmP13nPanel>/transientData/sort/items",template:new sap.m.P13nItem({columnKey:"{$sapmP13nPanel>columnKey}",text:"{$sapmP13nPanel>text}",tooltip:"{$sapmP13nPanel>tooltip}",maxLength:"{$sapmP13nPanel>maxlength}",type:"{$sapmP13nPanel>type}"})},sortItems:{path:"$sapmP13nPanel>/persistentData/sort/sortItems",template:new sap.m.P13nSortItem({columnKey:"{$sapmP13nPanel>columnKey}",operation:"{$sapmP13nPanel>operation}"})},beforeNavigationTo:t.setModelFunction()});p.attachAddSortItem(function(e){var d=this.getModel("$sapuicomppersonalizationBaseController").getData();var a=e.getParameters();var s={columnKey:a.sortItemData.getColumnKey(),operation:a.sortItemData.getOperation()};if(a.index>-1){d.persistentData.sort.sortItems.splice(a.index,0,s);}else{d.persistentData.sort.sortItems.push(s);}this.getModel("$sapuicomppersonalizationBaseController").setData(d,true);},this);p.attachRemoveSortItem(function(e){var a=e.getParameters();var d=this.getModel("$sapuicomppersonalizationBaseController").getData();if(a.index>-1){d.persistentData.sort.sortItems.splice(a.index,1);this.getModel("$sapuicomppersonalizationBaseController").setData(d,true);}},this);return p;};S.prototype.syncJsonModel2Table=function(j){var t=this.getTable();var c=t.getColumns();var C=q.extend(true,[],c);this.fireBeforePotentialTableChange();if(t instanceof sap.ui.table.Table){j.sort.sortItems.forEach(function(s){var o=U.getColumn(s.columnKey,c);if(!o){return;}if(!o.getSorted()){o.setSorted(true);}if(o.getSortOrder()!==s.operation){o.setSortOrder(s.operation);}C.splice(C.indexOf(o),1);});C.forEach(function(o){if(o&&o.getSorted()){o.setSorted(false);}});}this.fireAfterPotentialTableChange();};S.prototype.getChangeType=function(p,P){if(!P||!P.sort||!P.sort.sortItems){return sap.ui.comp.personalization.ChangeType.Unchanged;}var i=JSON.stringify(p.sort.sortItems)!==JSON.stringify(P.sort.sortItems);return i?sap.ui.comp.personalization.ChangeType.ModelChanged:sap.ui.comp.personalization.ChangeType.Unchanged;};S.prototype.getChangeData=function(p,P){if(!p||!p.sort||!p.sort.sortItems){return{sort:{sortItems:[]}};}if(!P||!P.sort||!P.sort.sortItems){return{sort:U.copy(p.sort)};}if(JSON.stringify(p.sort.sortItems)!==JSON.stringify(P.sort.sortItems)){return{sort:U.copy(p.sort)};}return null;};S.prototype.getUnionData=function(p,P){if(!P||!P.sort||!P.sort.sortItems){return{sort:U.copy(p.sort)};}return{sort:U.copy(P.sort)};};S.prototype.exit=function(){B.prototype.exit.apply(this,arguments);var t=this.getTable();if(t&&t instanceof sap.ui.table.Table){t.detachSort(this._onSort,this);}};return S;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.providers.BaseValueListProvider')){
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.ui.comp.providers.BaseValueListProvider');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.EventProvider');jQuery.sap.require('sap.ui.model.type.Date');sap.ui.define("sap/ui/comp/providers/BaseValueListProvider",['jquery.sap.global','sap/ui/base/EventProvider','sap/ui/comp/smartfilterbar/ControlConfiguration','sap/ui/model/type/Date','sap/ui/comp/odata/MetadataAnalyser','sap/ui/comp/util/FormatUtil'],function(q,E,C,D,M,F){"use strict";var B=E.extend("sap.ui.comp.providers.BaseValueListProvider",{constructor:function(p){E.call(this);this.sFieldName=p.fieldName;this.oControl=p.control;this.sValueListEntitySetName=null;this.sValueListEntityName=null;this.oODataModel=p.model;this.oFilterModel=p.filterModel;this.oFilterProvider=p.filterProvider;this.sDisplayFormat=p.displayFormat;this._oDateFormatSettings=p.dateFormatSettings;this.bResolveInOutParams=(p.resolveInOutParams===false)?false:true;this.sDisplayBehaviour=p.displayBehaviour;this.sDDLBDisplayBehaviour=this.sDisplayBehaviour;if(!this.sDDLBDisplayBehaviour||this.sDDLBDisplayBehaviour===C.DISPLAYBEHAVIOUR.auto){this.sDDLBDisplayBehaviour=this.oFilterProvider?this.oFilterProvider.sDefaultDropDownDisplayBehaviour:C.DISPLAYBEHAVIOUR.descriptionOnly;}this.sPropertyTypePath="";if(this.bResolveInOutParams&&!this.oFilterModel&&!this.oFilterProvider){this._resolvePropertyPath();}if(p.loadAnnotation&&p.fullyQualifiedFieldName){this._oMetadataAnalyser=p.metadataAnalyser;if(!this._oMetadataAnalyser){this._oMetadataAnalyser=new M(this.oODataModel);this._bCleanupMetadataAnalyser=true;}this._oMetadataAnalyser.getValueListAnnotationLazy(p.fullyQualifiedFieldName).then(this._onAnnotationLoad.bind(this),function(e){this._oError=e;this.bInitialised=true;q.sap.log.debug(e);}.bind(this));}else{this._onAnnotationLoad({primaryValueListAnnotation:p.annotation,additionalAnnotations:p.additionalAnnotations});}if(!sap.ui.comp.smartfilterbar||!sap.ui.comp.smartfilterbar.FilterProvider){q.sap.require("sap.ui.comp.smartfilterbar.FilterProvider");}}});B.prototype.attachValueListChanged=function(f,l){this.attachEvent("valueListChanged",f,l);};B.prototype.detachValueListChanged=function(f,l){this.detachEvent("valueListChanged",f,l);};B.prototype._onAnnotationLoad=function(v){this.oPrimaryValueListAnnotation=v.primaryValueListAnnotation;this.additionalAnnotations=v.additionalAnnotations;this._resolveAnnotationData(this.oPrimaryValueListAnnotation);this.bInitialised=true;if(this.sAggregationName&&!this.bTypeAheadEnabled){this.oControl.rerender();}};B.prototype._resolvePropertyPath=function(){var b=this.oControl.getBindingInfo("value"),p,P,a;if(b&&b.parts){p=b.parts[0]?b.parts[0].path:"";}if(p){a=p.split("/");if(a.length>1){P=a[a.length-1];this.sPropertyTypePath=p.replace("/"+P,"");}}};B.prototype._resolveAnnotationData=function(a){var l=0,i=0,c,f,t,T;if(this.oODataModel&&a){this.bSupportBasicSearch=a.isSearchSupported;this.sValueListTitle=a.valueListTitle||a.qualifier;this.sKey=a.keyField;this._aKeys=a.keys;this.sValueListEntitySetName=a.valueListEntitySetName;this.sValueListEntityName=a.valueListEntityName;this.mInParams=a.inParams;this.mOutParams=a.outParams;this.sTokenDisplayBehaviour=this.sDisplayBehaviour;if(!this.sTokenDisplayBehaviour||this.sTokenDisplayBehaviour===C.DISPLAYBEHAVIOUR.auto){this.sTokenDisplayBehaviour=this.oFilterProvider?this.oFilterProvider.sDefaultTokenDisplayBehaviour:C.DISPLAYBEHAVIOUR.descriptionAndId;}if(!a.descriptionField){this.sTokenDisplayBehaviour=C.DISPLAYBEHAVIOUR.idOnly;}this.sDescription=a.descriptionField||this.sKey;if(this.sValueListEntitySetName&&this.sKey){this._aCols=[];this.aSelect=[];c=a.valueListFields;l=c.length;for(i=0;i<l;i++){f=c[i];t=null;T=null;if(f.type==="Edm.Boolean"){t="boolean";}else if(f.type==="Edm.DateTime"&&f.displayFormat==="Date"){t="date";T=new D();}else if(f.type==="Edm.Decimal"){t="decimal";T=new sap.ui.model.type.Float();}else if(f.type==="Edm.String"){t="string";}this._aCols.push({label:f.fieldLabel,type:t,oType:T,width:F.getWidth(f,15),template:f.name});this.aSelect.push(f.name);}if(a.descriptionField){this.aSelect.push(a.descriptionField);}}}};B.prototype._calculateFilterInputData=function(){var l,v,d=null;delete this.mFilterInputData;if(this.oFilterProvider&&this.oFilterProvider._oSmartFilter){d=this.oFilterProvider._oSmartFilter.getFilterData();}else if(this.oFilterModel){d=this.oFilterModel.getData();}else if(this.oODataModel&&this.bResolveInOutParams){d=this.oODataModel.getData(this.sPropertyTypePath,this.oControl.getBindingContext());}if(this.mInParams&&d){this.mFilterInputData={};this.aFilterField=[];for(l in this.mInParams){if(l){v=this.mInParams[l];if(v!==this.sKey){if(d[l]){this.mFilterInputData[v]=d[l];this.aFilterField.push(v);}}}}}};B.prototype._calculateAndSetFilterOutputData=function(d){var l,v,f=null,o,e,n,i,a;if(this.mOutParams&&d&&(this.oFilterProvider||this.oFilterModel)){f={};a=function(b){return b.key===n.key;};for(l in this.mOutParams){if(l){v=this.mOutParams[l];if(v!==this.sKey){i=d.length;while(i--){o=d[i];if(o[v]){n={key:o[v]};if(!f[l]){if(!e&&this.oFilterModel){e=this.oFilterModel.getData();}if(e&&e[l]&&e[l].items){f[l]=e[l];}else{f[l]={items:[]};}}if(f[l].items.filter(a).length<=0){f[l].items.push(n);}}}}}}if(f){if(this.oFilterProvider){this.oFilterProvider.setFilterData(f);}else if(this.oFilterModel){this.oFilterModel.setData(f,true);}}}else if(this.oODataModel&&this.bResolveInOutParams){this._calculateAndSetODataModelOutputData(d[0]);}};B.prototype._calculateAndSetODataModelOutputData=function(d){var b,l,v,p,V,c={};if(d&&this.mOutParams){b=this.oControl.getBindingContext();for(l in this.mOutParams){if(l){v=this.mOutParams[l];if(v!==this.sKey){V=d[v];c[l]=V;p=this.sPropertyTypePath?this.sPropertyTypePath+"/"+l:l;this.oODataModel.setProperty(p,V,b,true);}}}if(c&&!q.isEmptyObject(c)){this.fireEvent("valueListChanged",{"changes":c});}}};B.prototype.destroy=function(){sap.ui.base.EventProvider.prototype.destroy.apply(this,arguments);if(this._bCleanupMetadataAnalyser&&this._oMetadataAnalyser){this._oMetadataAnalyser.destroy();}this._oMetadataAnalyser=null;this.oControl=null;this.sFieldName=null;this.mFilterInputData=null;this.aFilterField=null;this.sValueListEntitySetName=null;this.sValueListEntityName=null;this.oODataModel=null;this.oFilterModel=null;this.oFilterProvider=null;this.oPrimaryValueListAnnotation=null;this.additionalAnnotations=null;this.sDisplayFormat=null;this.bSupportBasicSearch=null;this.bInitialised=null;this._oError=null;this.sValueListTitle=null;this.sKey=null;this._aKeys=null;this.mInParams=null;this.mOutParams=null;this.sDescription=null;this.aSelect=null;this._aCols=null;this.sDDLBDisplayBehaviour=null;this.sTokenDisplayBehaviour=null;this._oDateFormatSettings=null;this.bIsDestroyed=true;};return B;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.providers.ValueHelpProvider')){jQuery.sap.declare('sap.ui.comp.providers.ValueHelpProvider');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.m.List');jQuery.sap.require('sap.m.PlacementType');jQuery.sap.require('sap.m.ResponsivePopover');jQuery.sap.require('sap.m.StandardListItem');jQuery.sap.require('sap.ui.model.json.JSONModel');sap.ui.define("sap/ui/comp/providers/ValueHelpProvider",['jquery.sap.global','sap/m/List','sap/m/PlacementType','sap/m/ResponsivePopover','sap/m/StandardListItem','./BaseValueListProvider','sap/ui/model/json/JSONModel'],function(q,L,P,R,S,B,J){"use strict";var V=B.extend("sap.ui.comp.providers.ValueHelpProvider",{constructor:function(p){if(p){this.preventInitialDataFetchInValueHelpDialog=p.preventInitialDataFetchInValueHelpDialog;this.sTitle=p.title;this.bSupportMultiselect=p.supportMultiSelect;this.bSupportRanges=p.supportRanges;this.bIsSingleIntervalRange=p.isSingleIntervalRange;this.bIsUnrestrictedFilter=p.isUnrestrictedFilter;this.bTakeOverInputValue=(p.takeOverInputValue===false)?false:true;if(this.bIsSingleIntervalRange){this.bSupportRanges=true;}this._sType=p.type;this._sMaxLength=p.maxLength;this._sScale=p.scale;this._sPrecision=p.precision;}B.apply(this,arguments);this._onInitialise();}});V.prototype._onInitialise=function(){if(this.oControl.attachValueHelpRequest){this._fVHRequested=q.proxy(function(e){if(!this.bInitialised){return;}this.oControl=e.getSource();this.bForceTriggerDataRetreival=e.getParameter("fromSuggestions");if(this.bTakeOverInputValue||this.bForceTriggerDataRetreival){this.sBasicSearchText=e.getSource().getValue();}this._createValueHelpDialog();},this);this.oControl.attachValueHelpRequest(this._fVHRequested);}};V.prototype._createValueHelpDialog=function(){if(!this.bCreated){this.bCreated=true;if(!this._oValueHelpDialogClass){sap.ui.require(['sap/ui/comp/valuehelpdialog/ValueHelpDialog'],this._onValueHelpDialogRequired.bind(this));}else{this._onValueHelpDialogRequired(this._oValueHelpDialogClass);}}};V.prototype._onValueHelpDialogRequired=function(a){this._oValueHelpDialogClass=a;this.oValueHelpDialog=new a({stretch:sap.ui.Device.system.phone,basicSearchText:this.sBasicSearchText,supportRangesOnly:this.bIsSingleIntervalRange||!this.oPrimaryValueListAnnotation,supportMultiselect:this.bSupportMultiselect,title:this.sTitle,supportRanges:this.bSupportRanges,displayFormat:this.sDisplayFormat,ok:q.proxy(this._onOK,this),cancel:q.proxy(this._onCancel,this),afterClose:q.proxy(function(){if(this.oPrimaryValueListAnnotation){this._resolveAnnotationData(this.oPrimaryValueListAnnotation);}this.oValueHelpDialog.destroy();this.bCreated=false;if(this.oControl&&this.oControl.focus&&!sap.ui.Device.system.phone){this.oControl.focus();}},this)});if(this.bIsSingleIntervalRange){this.oValueHelpDialog.setIncludeRangeOperations([sap.ui.comp.valuehelpdialog.ValueHelpRangeOperation.BT,sap.ui.comp.valuehelpdialog.ValueHelpRangeOperation.EQ],this._sType);this.oValueHelpDialog.setMaxIncludeRanges(1);this.oValueHelpDialog.setMaxExcludeRanges(0);this._updateInitialInterval();}else if((this._sType==="date"||this._sType==="time")&&!this.bIsUnrestrictedFilter){this.oValueHelpDialog.setIncludeRangeOperations([sap.ui.comp.valuehelpdialog.ValueHelpRangeOperation.EQ],this._sType);this.oValueHelpDialog.setMaxExcludeRanges(0);}if(this.oControl.$()&&this.oControl.$().closest(".sapUiSizeCompact").length>0){this.oValueHelpDialog.addStyleClass("sapUiSizeCompact");}else{this.oValueHelpDialog.addStyleClass("sapUiSizeCozy");}if(this.bSupportRanges){this.oValueHelpDialog.setRangeKeyFields([{label:this.sTitle,key:this.sFieldName,type:this._sType,scale:this._sScale,precision:this._sPrecision,maxLength:this._sMaxLength}]);}if(!(this.bIsSingleIntervalRange||!this.oPrimaryValueListAnnotation)){this._createAdditionalValueHelpControls();this._createCollectiveSearchControls();this.oValueHelpDialog.setModel(this.oODataModel);}if(this.oControl.getTokens){var t=this.oControl.getTokens();this.oValueHelpDialog.setTokens(t);}this.oValueHelpDialog.open();};V.prototype._updateInitialInterval=function(){var i=this.oControl.getValue(),t,r,v;if(i){t=new sap.m.Token();r={exclude:false,keyField:this.sFieldName};v=i.split("-");if(v&&v.length===2){r.operation="BT";r.value1=v[0];r.value2=v[1];}else{r.operation="EQ";r.value1=i;}t.data("range",r);}if(t){this.oValueHelpDialog.setTokens([t]);}};V.prototype._createCollectiveSearchControls=function(){var p,l,I,i=0,a=0,o,A,r;if(this.additionalAnnotations&&this.additionalAnnotations.length){o=q.proxy(function(e){var s=e.getParameter("listItem"),b;p.close();if(s){b=s.data("_annotation");if(b){this._triggerAnnotationChange(b);}}},this);l=new L({mode:sap.m.ListMode.SingleSelectMaster,selectionChange:o});r=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");p=new R({placement:P.Bottom,showHeader:true,contentHeight:"30rem",title:r.getText("COLLECTIVE_SEARCH_SELECTION_TITLE"),content:[l]});I=new S({title:this.oPrimaryValueListAnnotation.valueListTitle});I.data("_annotation",this.oPrimaryValueListAnnotation);l.addItem(I);l.setSelectedItem(I);this.oValueHelpDialog.oSelectionTitle.setText(this.oPrimaryValueListAnnotation.valueListTitle);this.oValueHelpDialog.oSelectionTitle.setTooltip(this.oPrimaryValueListAnnotation.valueListTitle);a=this.additionalAnnotations.length;for(i=0;i<a;i++){A=this.additionalAnnotations[i];I=new S({title:A.valueListTitle});I.data("_annotation",A);l.addItem(I);}this.oValueHelpDialog.oSelectionButton.setVisible(true);this.oValueHelpDialog.oSelectionTitle.setVisible(true);this.oValueHelpDialog.oSelectionButton.attachPress(function(){p.openBy(this);});}};V.prototype._triggerAnnotationChange=function(a){this.oValueHelpDialog.oSelectionTitle.setText(a.valueListTitle);this.oValueHelpDialog.oSelectionTitle.setTooltip(a.valueListTitle);this.oValueHelpDialog.resetTableState();this._resolveAnnotationData(a);this._createAdditionalValueHelpControls();};V.prototype._createAdditionalValueHelpControls=function(){var b=null;this.oValueHelpDialog.setKey(this.sKey);this.oValueHelpDialog.setKeys(this._aKeys);this.oValueHelpDialog.setDescriptionKey(this.sDescription);this.oValueHelpDialog.setTokenDisplayBehaviour(this.sTokenDisplayBehaviour);var c=new J();c.setData({cols:this._aCols});this.oValueHelpDialog.setModel(c,"columns");if(this.bSupportBasicSearch){b=this.sKey;}this.oSmartFilterBar=new sap.ui.comp.smartfilterbar.SmartFilterBar({entityType:this.sValueListEntityName,basicSearchFieldName:b,enableBasicSearch:this.bSupportBasicSearch,advancedMode:true,showGoOnFB:!sap.ui.Device.system.phone,expandAdvancedArea:(!this.bForceTriggerDataRetreival&&sap.ui.Device.system.desktop),search:this._onFilterBarSearchPressed.bind(this),reset:this._onFilterBarResetPressed.bind(this),filterChange:q.proxy(this._onFilterBarFilterChange,this),initialise:q.proxy(this._onFilterBarInitialise,this)});if(this._oDateFormatSettings){this.oSmartFilterBar.data("dateFormatSettings",this._oDateFormatSettings);}this.oSmartFilterBar.isRunningInValueHelpDialog=true;this.oValueHelpDialog.setFilterBar(this.oSmartFilterBar);};V.prototype._onFilterBarFilterChange=function(){var t=this.oValueHelpDialog.getTable();if(t){t.setShowOverlay(true);}this.oValueHelpDialog.TableStateSearchData();};V.prototype._onFilterBarSearchPressed=function(){this._rebindTable();};V.prototype._rebindTable=function(){var f,p,b,t;f=this.oSmartFilterBar.getFilters();p=this.oSmartFilterBar.getParameters()||{};if(this.aSelect&&this.aSelect.length){p["select"]=this.aSelect.toString();}b={path:"/"+this.sValueListEntitySetName,filters:f,parameters:p,sorter:new sap.ui.model.Sorter(this.sKey),events:{dataReceived:q.proxy(function(e){this.oValueHelpDialog.TableStateDataFilled();t.setBusy(false);var o=e.getSource(),i;if(o&&this.oValueHelpDialog&&this.oValueHelpDialog.isOpen()){i=o.getLength();if(i){this.oValueHelpDialog.update();}}},this)}};t=this.oValueHelpDialog.getTable();t.setShowOverlay(false);this.oValueHelpDialog.TableStateDataSearching();t.setBusy(true);if(t instanceof sap.m.Table){b.factory=function(i,c){var C=t.getModel("columns").getData().cols;return new sap.m.ColumnListItem({cells:C.map(function(a){var d=a.template;return new sap.m.Label({text:"{"+d+"}"});})});};t.bindItems(b);}else{t.bindRows(b);}};V.prototype._onFilterBarResetPressed=function(){this._calculateFilterInputData();if(this.oSmartFilterBar){this.oSmartFilterBar.setFilterData(this.mFilterInputData);}};V.prototype._onFilterBarInitialise=function(){var b=null;this._onFilterBarResetPressed();if(this.oSmartFilterBar&&this.oSmartFilterBar.getBasicSearchControl){b=this.oSmartFilterBar.getBasicSearchControl();if(b){b.setValue(this.sBasicSearchText);if(sap.ui.Device.system.phone&&b instanceof sap.m.SearchField){b.setShowSearchButton(true);}}}if(!this.preventInitialDataFetchInValueHelpDialog||this.bForceTriggerDataRetreival){this._rebindTable();this.bForceTriggerDataRetreival=false;}};V.prototype._onOK=function(c){var t=c.getParameter("tokens"),r,k,i=0,a=[],o=null;this._onCancel();if(this.oControl instanceof sap.m.MultiInput){this.oControl.setTokens(t);i=t.length;while(i--){o=t[i].data("row");if(o){a.push(o);}}}else{if(t[0]){if(this.bIsSingleIntervalRange){r=t[0].data("range");if(r){if(r.operation==="BT"){k=r.value1+"-"+r.value2;}else{k=r.value1;}}}else{k=t[0].getKey();}o=t[0].data("row");if(o){a.push(o);}}this.oControl.setValue(k);this.oControl.fireChange({value:k,validated:true});}this._calculateAndSetFilterOutputData(a);};V.prototype._onCancel=function(){this.oValueHelpDialog.close();this.oValueHelpDialog.setModel(null);};V.prototype.destroy=function(){if(this.oControl&&this.oControl.detachValueHelpRequest){this.oControl.detachValueHelpRequest(this._fVHRequested);this._fVHRequested=null;}B.prototype.destroy.apply(this,arguments);if(this.oValueHelpDialog){this.oValueHelpDialog.destroy();this.oValueHelpDialog=null;}if(this.oSmartFilterBar){this.oSmartFilterBar.destroy();this.oSmartFilterBar=null;}this.sTitle=null;this._oValueHelpDialogClass=null;};return V;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.providers.ValueListProvider')){jQuery.sap.declare('sap.ui.comp.providers.ValueListProvider');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.m.Column');jQuery.sap.require('sap.m.ColumnListItem');jQuery.sap.require('sap.m.Text');jQuery.sap.require('sap.m.Token');jQuery.sap.require('sap.ui.core.Item');jQuery.sap.require('sap.ui.model.Filter');jQuery.sap.require('sap.ui.model.Sorter');jQuery.sap.require('sap.ui.model.json.JSONModel');sap.ui.define("sap/ui/comp/providers/ValueListProvider",['jquery.sap.global','sap/m/Column','sap/m/ColumnListItem','sap/m/Text','sap/m/Token','./BaseValueListProvider','sap/ui/core/Item','sap/ui/model/Filter','sap/ui/model/Sorter','sap/ui/model/json/JSONModel','sap/ui/comp/util/FormatUtil'],function(q,C,a,T,b,B,I,F,S,J,c){"use strict";var V=B.extend("sap.ui.comp.providers.ValueListProvider",{constructor:function(p){if(p){this.sAggregationName=p.aggregation;this.bTypeAheadEnabled=p.typeAheadEnabled;}B.apply(this,arguments);this._onInitialise();}});V.prototype._onInitialise=function(){var e;if(!this.bTypeAheadEnabled){e={onAfterRendering:function(){if(this.bInitialised){this.oControl.removeEventDelegate(e,this);this._createDropDownTemplate();this._fetchData();}}};this.oControl.addEventDelegate(e,this);}else if(this.oControl.attachSuggest){this._fSuggest=function(E){this.oControl=E.getSource();if(!this.bInitialised){return;}if(!this.oTemplate||!this.oControl.data("_hassuggestionTemplate")){this._createSuggestionTemplate();}var s=E.getParameter("suggestValue");this._fetchData(s);}.bind(this);this.oControl.attachSuggest(this._fSuggest);this._handleSelect();}};V.prototype._createDropDownTemplate=function(){this._oTemplate=new I({key:"{"+this.sKey+"}",text:this._getDDLBTextBindingPath()});if(this.sDDLBDisplayBehaviour===sap.ui.comp.smartfilterbar.ControlConfiguration.DISPLAYBEHAVIOUR.idOnly||this.sDDLBDisplayBehaviour===sap.ui.comp.smartfilterbar.ControlConfiguration.DISPLAYBEHAVIOUR.idAndDescription){this._oSorter=new S(this.sKey);}else{this._oSorter=new S(this.sDescription);}};V.prototype._createSuggestionTemplate=function(){var i=0,l=0,t,s=0;this._oTemplate=new a();if(this._aCols){this.oControl.removeAllSuggestionColumns();l=this._aCols.length;for(i=0;i<l;i++){var d=false,m="1px",w=this._aCols[i].width;if(sap.ui.Device.system.phone){w=undefined;if(i>=2){d=true;m=(i+1)*10+"rem";}}this.oControl.addSuggestionColumn(new C({header:new T({wrapping:false,text:this._aCols[i].label,tooltip:this._aCols[i].label}),demandPopin:d,popinDisplay:sap.m.PopinDisplay.Inline,minScreenWidth:m,width:w}));t=null;if(this._aCols[i].type==="string"){t={path:this._aCols[i].template};}this._oTemplate.addCell(new T({wrapping:false,text:{path:this._aCols[i].template,type:this._aCols[i].oType},tooltip:t}));if(w){s+=parseFloat(w.substring(0,w.length-2));}}if(s>0){this.oControl.setMaxSuggestionWidth(s+"em");}}this.oControl.data("_hassuggestionTemplate",true);};V.prototype._getDDLBTextBindingPath=function(){return c.getFormattedBindingExpressionFromDisplayBehaviour(this.sDDLBDisplayBehaviour,this.sKey,this.sDescription);};V.prototype._handleSelect=function(){var h=function(d,f){var k,t,o;if(d){k=d[this.sKey];t=d[this.sDescription];}if(k){if(this.oControl.addToken){t=c.getFormattedExpressionFromDisplayBehaviour(this.sTokenDisplayBehaviour,k,t);o=new b({key:k,text:t,tooltip:t});o.data("row",d);if(f){f(o);}delete this.oControl.__sValidationText;}else{this.oControl.setValue(k);this.oControl.fireChange({value:k,validated:true});}}this._calculateAndSetFilterOutputData([d]);}.bind(this);var A=function(){if(this.oFilterProvider&&this.oFilterProvider._oSmartFilter&&this.oFilterProvider._oSmartFilter.bIsSearchPending&&this.oFilterProvider._oSmartFilter.search){this.oFilterProvider._oSmartFilter.search();}}.bind(this);if(this.oControl.addValidator){this._fValidator=function(d){if(!this.bInitialised){return;}var r=d.suggestionObject,D,i=d.text,f=[],p;if(r){D=this.oODataModel.getData(r.getBindingContextPath());h(D,d.asyncCallback);}else if(i){if(this.sDisplayFormat==="UpperCase"){i=i.toUpperCase();}if(this.oControl.__sValidationText!==i){this.oControl.__sValidationText=i;this.oControl.__bValidatingToken=true;this._calculateFilterInputData();if(this.mFilterInputData&&this.aFilterField){f=sap.ui.comp.smartfilterbar.FilterProvider.generateFilters(this.aFilterField,this.mFilterInputData);}f.push(new F(this.sKey,sap.ui.model.FilterOperator.EQ,i));if(this.bSupportBasicSearch){p={"search-focus":this.sKey};}this.oODataModel.read("/"+this.sValueListEntitySetName,{filters:f,urlParameters:p,success:function(R,e){var o=R;delete this.oControl.__bValidatingToken;if(R){if(R.results&&R.results.length>=1){if(R.results.length===1){o=R.results[0];}if(this.oControl.data("__validationError")){this.oControl.data("__validationError",null);this.oControl.setValueState("None");}}else{this.oControl.setValueState("Error");this.oControl.data("__validationError",true);}if(o&&o[this.sKey]){h(o,d.asyncCallback);}}A();}.bind(this),error:function(){if(this.oControl.data("__validationError")){this.oControl.setValueState("None");}delete this.oControl.__bValidatingToken;A();}.bind(this)});}else{if(this.oControl.data("__validationError")){this.oControl.setValueState(sap.ui.core.ValueState.Error);}}}}.bind(this);this.oControl.addValidator(this._fValidator);}else if(this.oControl.attachSuggestionItemSelected){this._fSuggestionItemSelected=function(e){var r=e.getParameter("selectedRow"),d;if(r){d=r.getModel().getData(r.getBindingContextPath());h(d);}};this.oControl.attachSuggestionItemSelected(this._fSuggestionItemSelected);}this.oControl.setRowResultFunction(function(s){var o,r="";if(s){o=s.getBindingContext();}if(o&&this.sKey){r=o.getProperty(this.sKey);}return r;}.bind(this));};V.prototype._fetchData=function(s){var p={},f=[],l,e;if(this.bTypeAheadEnabled){if(s&&this.sDisplayFormat==="UpperCase"){s=s.toUpperCase();}if(this.bSupportBasicSearch){p["custom"]={"search-focus":this.sKey,"search":s};}this._calculateFilterInputData();if(this.mFilterInputData&&this.aFilterField){f=sap.ui.comp.smartfilterbar.FilterProvider.generateFilters(this.aFilterField,this.mFilterInputData,{dateSettings:this._oDateFormatSettings});}if(!this.bSupportBasicSearch){f.push(new F(this.sKey,sap.ui.model.FilterOperator.StartsWith,s));}l=10;e={dataReceived:function(E){var o=E.getSource(),i;if(o){i=o.getLength();if(i&&i<=l){this.oControl.setShowTableSuggestionValueHelp(false);}else{this.oControl.setShowTableSuggestionValueHelp(true);}}}.bind(this)};}if(this.aSelect&&this.aSelect.length){p["select"]=this.aSelect.toString();}this.oControl.bindAggregation(this.sAggregationName,{path:"/"+this.sValueListEntitySetName,length:l,parameters:p,filters:f,sorter:this._oSorter,events:e,template:this._oTemplate});};V.prototype.destroy=function(){if(this.oControl){if(this.oControl.detachSuggest){this.oControl.detachSuggest(this._fSuggest);this._fSuggest=null;}if(this.oControl.removeValidator){this.oControl.removeValidator(this._fValidator);this._fValidator=null;}else if(this.oControl.detachSuggestionItemSelected){this.oControl.detachSuggestionItemSelected(this._fSuggestionItemSelected);this._fSuggestionItemSelected=null;}this.oControl.unbindAggregation(this.sAggregationName);if(this.oControl.removeAllSuggestionColumns){this.oControl.removeAllSuggestionColumns();}this.oControl.data("_hassuggestionTemplate",false);delete this.oControl.__sValidationText;delete this.oControl.__bValidatingToken;}B.prototype.destroy.apply(this,arguments);if(this.oJsonModel){this.oJsonModel.destroy();this.oJsonModel=null;}this._oTemplate=null;this.sAggregationName=null;this.bTypeAheadEnabled=null;this._oSorter=null;};return V;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.smartfield.ControlFactoryBase')){
/*
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.ui.comp.smartfield.ControlFactoryBase');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.Object');sap.ui.define("sap/ui/comp/smartfield/ControlFactoryBase",["jquery.sap.global","sap/ui/base/Object","sap/ui/comp/util/FormatUtil","sap/ui/comp/providers/ValueHelpProvider","sap/ui/comp/providers/ValueListProvider","sap/ui/comp/smartfield/BindingUtil"],function(q,B,F,V,a,b){"use strict";var C=B.extend("sap.ui.comp.smartfield.ControlFactoryBase",{constructor:function(m,p){B.apply(this,arguments);this.sName="ControlFactoryBase";this._oModel=m;this._oParent=p;this._oBinding=new b();this._aProviders=[];this._oRb=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");}});C.prototype.createControl=function(c){var m,o;m=this._getCreator(c);if(m){o=this[m]();this._addAriaLabelledBy(o);if(o&&o.onCreate){this[o.onCreate](o.control,o.params);}}return o;};C.prototype._addAriaLabelledBy=function(c){if((this._oParent.getControlContext()===sap.ui.comp.smartfield.ControlContextType.None)||(this._oParent.getControlContext()===sap.ui.comp.smartfield.ControlContextType.Form)||(this._oParent.getControlContext()===sap.ui.comp.smartfield.ControlContextType.SmartFormGrid)){if(c&&c.control.addAriaLabelledBy&&this._oParent.getAriaLabelledBy().length>0){c.control.removeAllAriaLabelledBy();this._oParent.getAriaLabelledBy().forEach(function(A){c.control.addAriaLabelledBy(A);});}}};C.prototype.addValidations=function(c,m){var s,e,t=this;s=function(S,E){var M,o,d=E.getSource();if(d){if(d.setValueState){d.setValueState(S);}o=E.getParameter("exception");if(o){M=o.message;}if(!M){M=E.getParameter("message");}if(d.setValueStateText){d.setValueStateText(M);}}if(m){t._oParent[m](S===sap.ui.core.ValueState.Error);}};e=function(E){s(sap.ui.core.ValueState.Error,E);};c.attachFormatError(e);c.attachParseError(e);c.attachValidationError(e);c.attachValidationSuccess(function(E){s(sap.ui.core.ValueState.None,E);});};C.prototype._getDisplayBehaviourConfiguration=function(d){var D=null;var c=this._oParent.getConfiguration();if(c){D=c.getDisplayBehaviour();}if(!D&&this._oMetaData&&this._oMetaData.entityType){D=this._oHelper.oAnnotation.getTextArrangement(this._oMetaData.property.property,this._oMetaData.entityType);}if(!D){D=this._oParent.data(d);}return D;};C.prototype._formatDisplayBehaviour=function(d,k,D){var s=this._getDisplayBehaviourConfiguration(d);if(d==="defaultCheckBoxDisplayBehaviour"){return this._getFormattedExpressionFromDisplayBehaviour(s,k);}return F.getFormattedExpressionFromDisplayBehaviour(s||"idOnly",k,D);};C.prototype._getFormattedExpressionFromDisplayBehaviour=function(d,v){var k="";switch(d){case"OnOff":k=v?"SMARTFIELD_CB_ON":"SMARTFIELD_CB_OFF";break;case"TrueFalse":k=v?"SMARTFIELD_CB_TRUE":"SMARTFIELD_CB_FALSE";break;default:k=v?"SMARTFIELD_CB_YES":"SMARTFIELD_CB_NO";break;}return this._oRb.getText(k);};C.prototype.addValueHelp=function(c,p,v,m,o){var d,e,D,f;if(v.annotation&&(p["sap:value-list"]||p["com.sap.vocabularies.Common.v1.ValueList"])){D=this._getDisplayBehaviourConfiguration("defaultDropDownDisplayBehaviour");f=this._oParent.data("dateFormatSettings");if(!v.noDialog){if(c.setFilterSuggests){c.setFilterSuggests(false);}d=new V({loadAnnotation:true,fullyQualifiedFieldName:v.annotation,metadataAnalyser:v.analyser,control:c,model:m,preventInitialDataFetchInValueHelpDialog:true,dateFormatSettings:f,takeOverInputValue:false,supportMultiSelect:false,supportRanges:false,fieldName:p.name,title:v.dialogtitle,displayBehaviour:D});if(o){d.attachValueListChanged(o);}this._aProviders.push(d);if(c.setShowValueHelp){c.setShowValueHelp(true);}}e=new a({control:c,typeAheadEnabled:!v.noTypeAhead,aggregation:v.aggregation,loadAnnotation:true,fullyQualifiedFieldName:v.annotation,metadataAnalyser:v.analyser,model:m,dateFormatSettings:f,displayBehaviour:D});if(!v.noTypeAhead){if(c.setShowSuggestion){c.setShowSuggestion(true);}}if(o){e.attachValueListChanged(o);}this._aProviders.push(e);}};C.prototype.getAttribute=function(n){var i=this._oParent.getBindingInfo(n);if(i){return this._oBinding.toBindingPath(i);}return this._oParent["get"+n.substring(0,1).toUpperCase()+n.substring(1)]();};C.prototype.createAttributes=function(A,t,N,e){var c=this,n,i,m={};for(n in N){i=this._oParent.getBindingInfo(n);if(i){m[n]=this._oBinding.toBinding(i);}else{m[n]=this._oParent["get"+n.substring(0,1).toUpperCase()+n.substring(1)]();}}if(A){m[A]={model:this._oMetaData.model,path:this._oMetaData.path,type:t?this._oTypes.getType(t):null};}if(e){m[e.event]=function(p){try{c._oParent.fireChange({value:p.mParameters[e.parameter],newValue:p.mParameters[e.parameter]});}catch(d){q.sap.log.warning(d);}};}this.addObjectBinding(m);return m;};C.prototype.mapBindings=function(A,N){var n,i;for(n in N){i=this._oParent.getBindingInfo(n);if(i){A[N[n]]=this._oBinding.toBinding(i);}else{A[N[n]]=this._oParent["get"+n.substring(0,1).toUpperCase()+n.substring(1)]();}}};C.prototype.addObjectBinding=function(A,o){if(!o){o=this._oParent.getObjectBinding(this._oMetaData.model);}if(A&&o){A.objectBindings={};A.objectBindings[this._oMetaData.model]=o.sPath;}};C.prototype.getFormatSettings=function(f){var m,c,o,l;if(f){m=this._oParent.data(f);if(!m){c=this._oParent.getCustomData();if(c){l=c.length;while(l--){o=c[l];if(o.getKey()===f){m=o.getValue();break;}}}}if(m&&typeof(m)==="string"){try{m=JSON.parse(m);}catch(e){return null;}}}return m;};C.prototype.destroy=function(){var l=this._aProviders.length;while(l--){this._aProviders[l].destroy();}this._oBinding.destroy();this._oBinding=null;this._oParent=null;this._oModel=null;this._aProviders=[];this._oRb=null;};return C;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.smartfield.JSONControlFactory')){jQuery.sap.declare('sap.ui.comp.smartfield.JSONControlFactory');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.m.CheckBox');jQuery.sap.require('sap.m.ComboBox');jQuery.sap.require('sap.m.DatePicker');jQuery.sap.require('sap.m.Input');jQuery.sap.require('sap.m.Text');sap.ui.define("sap/ui/comp/smartfield/JSONControlFactory",["jquery.sap.global","sap/m/CheckBox","sap/m/ComboBox","sap/m/DatePicker","sap/m/Input","sap/m/Text","sap/ui/comp/smartfield/ControlFactoryBase","sap/ui/comp/smartfield/JSONTypes"],function(q,C,a,D,I,T,b,J){"use strict";var c=b.extend("sap.ui.comp.smartfield.JSONControlFactory",{constructor:function(m,p,M){b.apply(this,[m,p]);this.sName="JSONControlFactory";this._oMetaData=M;this._oTypes=new J();}});c.prototype._getCreator=function(){var m={"Boolean":"_createBoolean","Date":"_createDate","DateTime":"_createString","Float":"_createString","Integer":"_createString","String":"_createString"};if(!this._oParent.getEditable()||!this._oParent.getEnabled()){if(this._oParent.getJsontype()==="Boolean"){return"_createBoolean";}return"_createDisplay";}return m[this._oParent.getJsontype()]||"_createString";};c.prototype._createString=function(){var n,N,m={width:true,textAlign:true,placeholder:true,name:true,maxLength:true};n=!this._oParent.getShowValueHelp();N=!this._oParent.getShowSuggestion();if(n){if(((this._oParent.data("controlType")==="dropDownList"))){return this._createComboBox({annotation:null,noDialog:n,noTypeAhead:true});}}return{control:new I(this.createAttributes("value",this._oParent.getJsontype(),m,{event:"change",parameter:"value"})),onCreate:"_onCreate",noDialog:n,noTypeAhead:N,params:{getValue:"getValue"}};};c.prototype._createComboBox=function(v){var n={width:true,textAlign:true,placeholder:true,name:true};return{control:new a(this.createAttributes("value",this._oParent.getJsontype(),n,{event:"selectionChange",parameter:"selectedItem"})),onCreate:"_onCreate",params:{valuehelp:v,getValue:"getValue"}};};c.prototype._createBoolean=function(){var A=this.createAttributes("selected",this._oParent.getJsontype(),{},{event:"select",parameter:"selected"});A.enabled=this._oParent.getEditable()&&this._oParent.getEnabled();return{control:new C(A),onCreate:"_onCreate",params:{getValue:"getSelected"}};};c.prototype._createDate=function(){var n={width:true,textAlign:true,placeholder:true,name:true};return{control:new D(this.createAttributes("value",this._oParent.getJsontype(),n,{event:"change",parameter:"value"})),onCreate:"_onCreate",params:{getValue:"getValue"}};};c.prototype._createDisplay=function(){var n={width:true,textAlign:true};return{control:new T(this.createAttributes("text",this._oParent.getJsontype(),n))};};c.prototype._onCreate=function(o,p){var g;this.addValidations(o,"setSimpleClientError");if(p.getValue){g=p.getValue;p.getValue=function(){return o[g]();};}};c.prototype.destroy=function(){this._oTypes.destroy();this._oTypes=null;this._oMetaData=null;b.prototype.destroy.apply(this,[]);};return c;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.smartfield.ODataControlFactory')){jQuery.sap.declare('sap.ui.comp.smartfield.ODataControlFactory');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.m.TextArea');jQuery.sap.require('sap.m.Link');jQuery.sap.require('sap.m.CheckBox');jQuery.sap.require('sap.m.ComboBox');jQuery.sap.require('sap.m.DatePicker');jQuery.sap.require('sap.m.FlexItemData');jQuery.sap.require('sap.m.FlexJustifyContent');jQuery.sap.require('sap.m.HBox');jQuery.sap.require('sap.m.Input');jQuery.sap.require('sap.m.InputType');jQuery.sap.require('sap.m.Select');jQuery.sap.require('sap.m.Text');jQuery.sap.require('sap.ui.core.Renderer');jQuery.sap.require('sap.ui.core.TextAlign');jQuery.sap.require('sap.m.ObjectNumber');jQuery.sap.require('sap.m.ObjectIdentifier');jQuery.sap.require('sap.m.ObjectStatus');jQuery.sap.require('sap.ui.core.ValueState');jQuery.sap.require('sap.m.TimePicker');sap.ui.define("sap/ui/comp/smartfield/ODataControlFactory",["jquery.sap.global","sap/m/TextArea","sap/m/Link","sap/m/CheckBox","sap/m/ComboBox","sap/m/DatePicker","sap/m/FlexItemData","sap/m/FlexJustifyContent","sap/m/HBox","sap/m/Input","sap/m/InputType","sap/m/Select","sap/m/Text","sap/ui/core/Renderer","sap/ui/core/TextAlign","sap/ui/comp/navpopover/SmartLink","./ControlFactoryBase","./FieldControl","./ODataControlSelector","./ODataHelper","./ODataTypes","sap/m/ObjectNumber","sap/m/ObjectIdentifier","sap/m/ObjectStatus","sap/ui/core/ValueState","sap/m/TimePicker"],function(q,T,L,C,a,D,F,b,H,I,c,S,d,R,e,f,g,h,O,i,j,k,l,m,V,o){"use strict";var p=g.extend("sap.ui.comp.smartfield.ODataControlFactory",{constructor:function(M,P,n){g.apply(this,[M,P]);this.sName="ODataControlFactory";this._oMetaData={annotations:{}};this._oMeta=n;this._oHelper=new i(M,this._oBinding);this._oFieldControl=new h(P,this._oHelper);this._oTypes=new j(P);this._oSelector=new O(this._oMetaData,P,this._oTypes);this._bInitialized=false;this.bPending=false;}});p.prototype._init=function(M){this._oMetaData.model=M.model;this._oMetaData.path=M.path;this._oMetaData.entitySet=M.entitySetObject||this._oHelper.oMeta.getODataEntitySet(M.entitySet);this._oMetaData.entityType=M.entityType||this._oHelper.oMeta.getODataEntityType(this._oMetaData.entitySet.entityType);this._oMetaData.navigationPath=M.navigationPath||null;if(this._oModel){this._oHelper.checkNavigationProperty(this._oMetaData,this._oParent);this._oHelper.getProperty(this._oMetaData);if(this._oMetaData.property&&this._oMetaData.property.property){this._oMetaData.annotations.text=this._oHelper.getTextProperty2(this._oMetaData);this._oMetaData.annotations.uom=this._oHelper.getUnitOfMeasure2(this._oMetaData);this._oHelper.getValueListData(this._oMetaData);this._oMetaData.annotations.lineitem=this._oHelper.getAnalyzer().getLineItemAnnotation(this._oMetaData.entitySet.entityType);this._oHelper.getUOMValueListAnnotationPath(this._oMetaData);this._oMetaData.annotations.semantic=this._oHelper.getAnalyzer().getSemanticObjectAnnotationFromProperty(this._oMetaData.property.property);if(this._oMetaData.annotations.uom){this._oMetaData.annotations.uom.annotations={};this._oHelper.getValueListData(this._oMetaData.annotations.uom);}this._oHelper.getUOMTextAnnotation(this._oMetaData);}else{q.sap.log.warning("SmartField: Property "+M.path+" does not exist","SmartField: Property "+M.path+" does not exist","sap.ui.comp.smartfield.ODataControlFactory");}}else{this._oMetaData.modelObject=M.modelObject;this._oMetaData.property=M.property;this._oMetaData.annotations.text=M.annotations.text;this._oMetaData.annotations.uom=M.annotations.uom;if(this._oMetaData.annotations.uom&&!this._oMetaData.annotations.uom.annotations){this._oMetaData.annotations.uom.annotations={};}this._oMetaData.annotations.valuelist=M.annotations.valuelist;this._oMetaData.annotations.valuelistType=M.annotations.valuelistType;this._oMetaData.annotations.lineitem=M.annotations.lineitem;this._oMetaData.annotations.semantic=M.annotations.semantic;this._oMetaData.annotations.valuelistuom=M.annotations.valuelistuom;}};p.prototype._createEdmDisplay=function(){var n,r,A,s,M,t,u,v,w=this,N={width:true,textAlign:true};n=this._oParent.data("configdata");var x=((n&&(n.isInnerControl!==true))||(this._oParent.getControlContext()==="table")||(this._oParent.getControlContext()==="responsiveTable"));var y=this._oSelector.checkComboBox(x);if(y&&y.combobox){return this._createComboBox({annotation:y.annotation,noDialog:true,noTypeAhead:true},true);}if(this._checkLink()&&!this._oSelector.useObjectIdentifier()){return this._createLink();}A=this.createAttributes(null,this._oMetaData.property,N);t=this._oSelector.checkDatePicker();if(t){s=this.getFormatSettings("dateFormatSettings");A.text={model:this._oMetaData.model,path:this._oMetaData.path,type:this._oTypes.getType(this._oMetaData.property,s,{displayFormat:"Date"})};}else{A.text={model:this._oMetaData.model,path:this._oHelper.getEdmDisplayPath(this._oMetaData),type:this._oTypes.getType(this._oMetaData.property)};}if(this._oMetaData.property&&this._oMetaData.property.property){M=this._oHelper.oAnnotation.isMasked(this._oMetaData.property.property);if(M){A.text.formatter=function(z){if(z){return z.replace(new RegExp(".","igm"),"*");}return z;};}v=this._oHelper.oAnnotation.getText(this._oMetaData.property.property);if(v){u=this._oSelector.useObjectIdentifier(t,M);if(u){delete A.width;delete A.textAlign;A.text={path:this._oMetaData.path};A.title={path:this._oHelper.getEdmDisplayPath(this._oMetaData)};if(this._oParent.hasListeners("press")){A.titleActive=true;A.titlePress=function(E){w._oParent.firePress(E);};}}else{if(!(n&&(n.isInnerControl===true))){A.text={};A.text.parts=[];A.text.parts.push(this._oMetaData.path);A.text.parts.push(this._oHelper.getEdmDisplayPath(this._oMetaData));A.text.formatter=function(z,B){return w._formatDisplayBehaviour("defaultInputFieldDisplayBehaviour",z,B);};}}}else if(this._oSelector.checkCheckBox()){A.text.formatter=function(z){return w._formatDisplayBehaviour("defaultCheckBoxDisplayBehaviour",z);};}}if(u){r=new l(A);}else{if(A.text.type&&(A.text.type instanceof sap.ui.comp.smartfield.type.DateTime)&&A.text.type.oConstraints&&A.text.type.oConstraints.isDateOnly){A.wrapping=false;}if(this._oParent.isContextTable()&&sap.ui.getCore().getConfiguration().getRTL()){A.textDirection="LTR";}r=new d(A);}if(!u&&n&&n.configdata&&n.configdata.onText){n.configdata.onText(r);}return{control:r,onCreate:"_onCreate",params:{noValidations:true}};};p.prototype._createEdmTime=function(){var A,n,N={placeholder:true,valueState:true,valueStateText:true};A=this.createAttributes("value",this._oMetaData.property,N,{event:"change"});A.valueFormat="HH:mm:ss";n=new o(A);return{control:n,onCreate:"_onCreate",params:{getValue:"getValue",type:{type:A.value.type,property:this._oMetaData.property}}};};p.prototype._createObjectStatus=function(){var A,t,n;A=this.createAttributes(null,this._oMetaData.property,null);t=this._oHelper.oAnnotation.getText(this._oMetaData.property.property);if(t){A.text={parts:[]};A.text.parts.push(this._oHelper.getEdmDisplayPath(this._oMetaData));}else{A.text={model:this._oMetaData.model,path:this._oMetaData.path,type:this._oTypes.getType(this._oMetaData.property)};}this._addObjectStatusAttributes(A);n=new m(A);return{control:n,onCreate:"_onCreate",params:{getValue:"getText",noValidation:true}};};p.prototype._addObjectStatusAttributes=function(A){var n,P,r,s,t;P=this._oParent.getControlProposal();t=P.getObjectStatus();if(t){n=t.getBindingInfo("criticality");}r=function(u){var v,w;w={0:V.None,1:V.Error,2:V.Warning,3:V.Success};v={"com.sap.vocabularies.UI.v1.CriticalityType/Neutral":V.Neutral,"com.sap.vocabularies.UI.v1.CriticalityType/Negative":V.Warning,"com.sap.vocabularies.UI.v1.CriticalityType/Critical":V.Error,"com.sap.vocabularies.UI.v1.CriticalityType/Positive":V.Success};if(u){return v[u]||w[u]||V.None;}return V.None;};s=function(){var u,v={"Error":"sap-icon://status-negative","Warning":"sap-icon://status-critical","Success":"sap-icon://status-positive","None":"sap-icon://status-inactive"};if(n){if(n.formatter){u=n.formatter.apply(null,arguments);}else{u=arguments[0];}}else{u=t.getCriticality();}if(u){return v[r(u)];}return null;};if(n){A.state={formatter:function(){var u;if(n.formatter){u=n.formatter.apply(null,arguments);}else{u=arguments[0];}return r(u);},parts:n.parts};A.icon={formatter:s,parts:n.parts};}else{if(t){A.state=r(t.getCriticality());}A.icon=s();}};p.prototype._createEdmString=function(){var M,n,r,A,s,t,N={width:true,textAlign:true,placeholder:true,name:true,valueState:true,valueStateText:true};if(this._oSelector.checkCheckBox()){return this._createCheckBox();}s=this._oSelector.checkSelection();if(s.selection){return this._createSelect({annotation:s.annotation,noDialog:true,noTypeAhead:true});}s=this._oSelector.checkComboBox();if(s.combobox){return this._createComboBox({annotation:s.annotation,noDialog:true,noTypeAhead:true});}if(this._oMetaData.property&&this._oMetaData.property.property){n=this._oHelper.oAnnotation.isMultiLineText(this._oMetaData.property.property);if(n){delete N["width"];return this._createMultiLineText(N);}}A=this.createAttributes("value",this._oMetaData.property,N);this._addMaxLength(A,s.annotation);t=new I(A);if(this._oMetaData.property&&this._oMetaData.property.property){M=this._oHelper.oAnnotation.isMasked(this._oMetaData.property.property);if(M){t.setType(c.Password);}this._handleEventingForEdmString(t,this._oMetaData.property);}r=this._oParent.data("configdata");if(r&&r.configdata){if(r.configdata.onInput){r.configdata.onInput(t);}}return{control:t,onCreate:"_onCreate",params:{valuehelp:{annotation:s.annotation,noDialog:!this._oParent.getShowValueHelp(),noTypeAhead:!this._oParent.getShowSuggestion(),aggregation:"suggestionRows"},getValue:"getValue",type:{type:A.value.type,property:this._oMetaData.property}}};};p.prototype._addMaxLength=function(A,n){var B,M;B=this._oParent.getBindingInfo("value");M=this._oTypes.getMaxLength(this._oMetaData.property,B);if(M>0){if(!n||!this._oParent.getShowSuggestion()){A.maxLength=M;}}};p.prototype._addAriaLabelledBy=function(n){var r,t;if((this._oParent.getControlContext()===sap.ui.comp.smartfield.ControlContextType.None)||(this._oParent.getControlContext()===sap.ui.comp.smartfield.ControlContextType.Form)||(this._oParent.getControlContext()===sap.ui.comp.smartfield.ControlContextType.SmartFormGrid)){g.prototype._addAriaLabelledBy.apply(this,arguments);if(n){t=n.control;if(t instanceof H){if(t.getItems().length>0){t=t.getItems()[0];}}}if(t.getAriaLabelledBy&&t.getAriaLabelledBy().length===0){if(this._oHelper.oAnnotation.getLabel(this._oMetaData.property.property)){q.sap.require("sap.ui.core.InvisibleText");r=new sap.ui.core.InvisibleText({text:this._oHelper.oAnnotation.getLabel(this._oMetaData.property.property)});t.addAriaLabelledBy(r);this._oParent.addAggregation("_ariaLabelInvisibleText",r);}}}};p.prototype._handleEventingForEdmString=function(n,P){var u,t=this;if(n){u=this._oHelper.oAnnotation.isUpperCase(P.property);n.attachChange(function(E){var N={};if(E&&E.mParameters){var v=E.mParameters.value;if(u&&v){v=v.toUpperCase();n.setValue(v);}N.value=v;N.newValue=v;if(E.mParameters.validated){N.validated=E.mParameters.validated;}if(n._oSuggestionPopup&&n._oSuggestionPopup.isOpen()){if(!E.mParameters.validated){if(n._iPopupListSelectedIndex>=0){return;}}}try{t._oParent.fireChange(N);}catch(r){q.sap.log.warning(r);}}});}};p.prototype._createComboBox=function(v,n){var r=null,s;var A,N={width:true,textAlign:true,placeholder:true,name:true};s=this._oParent.data("configdata");A=this.createAttributes("selectedKey",this._oMetaData.property,N);A.selectionChange=this._oHelper.getSelectionChangeHandler(this._oParent);if(A.width===""){A.width="100%";}if(n){r=this._createDisplayedComboBox(A);}else{r=new a(A);}if(s&&s.configdata&&s.configdata.onText){s.configdata.onText(r);}return{control:r,onCreate:"_onCreate",params:{valuehelp:{annotation:v.annotation,aggregation:"items",noDialog:v.noDialog,noTypeAhead:v.noTypeAhead},getValue:"getSelectedKey",type:{type:A.selectedKey.type,property:this._oMetaData.property}}};};p.prototype._createDisplayedComboBox=function(A){var n=a.extend("sap.ui.comp.smartfield.DisplayComboBox",{metadata:{library:"sap.ui.comp"},renderer:function(r,s){var w=s.getWidth(),t=s.getValue(),u=s.getTextDirection(),v=s.getTextAlign();t.replace(/\r\n/g,"\n");r.write("<span");r.writeControlData(s);r.addClass("sapMText");r.addClass("sapUiSelectable");if(w){r.addStyle("width",w);}else{r.addClass("sapMTextMaxWidth");}if(u!==sap.ui.core.TextDirection.Inherit){r.writeAttribute("dir",u.toLowerCase());}if(v){v=R.getTextAlign(v,u);if(v){r.addStyle("text-align",v);}}r.writeClasses();r.writeStyles();r.write(">");r.writeEscaped(t);r.write("</span>");},updateDomValue:function(v){if(!this.isActive()){return this;}v=this._getInputValue(v);if(this.$().text()!==v){this.$().text(v);this._bCheckDomValue=true;}return this;}});return new n(A);};p.prototype._createSelect=function(v){var A,n={width:true,name:true};A=this.createAttributes("selectedKey",this._oMetaData.property,n);A.change=this._oHelper.getSelectionChangeHandler(this._oParent);A.forceSelection=false;if(A.width===""){A.width="100%";}return{control:new S(A),onCreate:"_onCreate",params:{valuehelp:{annotation:v.annotation,aggregation:"items",noDialog:v.noDialog,noTypeAhead:v.noTypeAhead},getValue:"getSelectedKey",type:{type:A.selectedKey.type,property:this._oMetaData.property}}};};p.prototype._createCheckBox=function(){var A=this.createAttributes("selected",null,{},{event:"select",parameter:"selected"});A.editable=(this._oParent.getEditable()&&this._oParent.getEnabled()&&this._oParent.getContextEditable());A.selected.type=this._oTypes.getAbapBoolean();return{control:new C(A),onCreate:"_onCreate",params:{getValue:"getSelected"}};};p.prototype._createEdmDateTime=function(){var A,n,N={width:true,textAlign:true,placeholder:true,name:true};A=this.createAttributes(null,this._oMetaData.property,N,{event:"change",parameter:"value"});n=this.getFormatSettings("dateFormatSettings");if(this._oSelector.checkDatePicker()){A.value={path:this._oMetaData.path,type:this._oTypes.getType(this._oMetaData.property,n,{displayFormat:"Date"}),model:this._oMetaData.model};if(n&&n.style){A.displayFormat=n.style;}return{control:new D(A),onCreate:"_onCreate",params:{getValue:"getValue",type:{type:A.value.type,property:this._oMetaData.property}}};}A.value={path:this._oMetaData.path,model:this._oMetaData.model,type:this._oTypes.getType(this._oMetaData.property,n)};return{control:new I(A),onCreate:"_onCreate",params:{getValue:"getValue",type:{type:A.value.type,property:this._oMetaData.property}}};};p.prototype._createEdmDateTimeOffset=function(){var n,A,N={width:true,textAlign:true,placeholder:true,name:true};n=this.getFormatSettings("dateFormatSettings");A=this.createAttributes(null,this._oMetaData.property,N,{event:"change",parameter:"value"});A.value={model:this._oMetaData.model,path:this._oMetaData.path,type:this._oTypes.getType(this._oMetaData.property,n)};return{control:new I(A),onCreate:"_onCreate",params:{getValue:"getValue",type:{type:A.value.type,property:this._oMetaData.property}}};};p.prototype._createEdmNumeric=function(){var A,n={width:true,textAlign:true,placeholder:true,name:true};A=this.createAttributes("value",this._oMetaData.property,n,{event:"change",parameter:"value"});if(this._oParent.isContextTable()&&sap.ui.getCore().getConfiguration().getRTL()){A.textDirection="LTR";}return{control:new I(A),onCreate:"_onCreate",params:{getValue:"getValue",type:{type:A.value.type,property:this._oMetaData.property}}};};p.prototype._createEdmUOM=function(){var P,n,t,A,r,s,B,u,v=this;A=this._createEdmUOMAttributes();r=this._oParent.getObjectBinding(this._oMetaData.model);this.addObjectBinding(A,r);var w=false;if(this._oParent.isContextTable()&&sap.ui.getCore().getConfiguration().getRTL()){w=true;}if(w){A.textDirection="LTR";}n=new I(A);if(this._oParent.data("suppressUnit")==="true"){s={getValue:"getValue"};if(!this._oHelper.oAnnotation.isCurrency(this._oMetaData.annotations.uom.property.property)){s.type={type:A.value.type,property:this._oMetaData.property};}return{control:n,onCreate:"_onCreate",params:s};}if(!this._oHelper.oAnnotation.isCurrency(this._oMetaData.annotations.uom.property.property)){u={type:A.value.type,property:this._oMetaData.property};}P=this._oHelper.getUOMPath(this._oMetaData);A={value:{model:this._oMetaData.model,path:P},change:this._oHelper.getUOMChangeHandler(this._oParent,true),textAlign:this._getEdmUOMTextAlignment()};this.addObjectBinding(A,r);this.mapBindings(A,{"uomEditable":"editable","uomEnabled":"enabled","uomVisible":"visible","mandatory":"mandatory","contextEditable":"contextEditable"});t=new sap.ui.comp.smartfield.SmartField(A);t.data("configdata",{"configdata":{isInnerControl:true,isUOM:!this._oParent.data("configdata"),model:this._oMetaData.model,navigationPath:this._oMetaData.annotations.uom.navigationPath||null,path:P,entitySetObject:this._oMetaData.annotations.uom.entitySet,entityType:this._oMetaData.annotations.uom.entityType,property:this._oMetaData.annotations.uom.property,annotations:{valuelist:this._oMetaData.annotations.valuelistuom,valuelistType:this._oMetaData.annotations.uom.annotations.valuelistType,text:this._oMetaData.annotations.textuom},modelObject:this._oMetaData.modelObject||this._oModel,onText:function(x){n.setLayoutData(new F({growFactor:1}));t.setLayoutData(new F({shrinkFactor:0}));if(x){if(w&&x.setTextDirection){x.setTextDirection("LTR");}if(v._oParent&&(v._oParent.getControlContext()!=='table')&&(v._oParent.getControlContext()!=='responsiveTable')){x.addStyleClass("sapUiCompSmartFieldUnit");}}},onInput:function(x){n.setLayoutData(new F({growFactor:1}));t.setLayoutData(new F({growFactor:0}));if(x){if(w&&x.setTextDirection){x.setTextDirection("LTR");}if(v._oParent&&(v._oParent.getControlContext()!=='table')&&(v._oParent.getControlContext()!=='responsiveTable')){x.addStyleClass("sapUiCompSmartFieldUnit");}}}}});t.data("errorCheck","setComplexClientErrorSecondOperandNested");n.addStyleClass("smartFieldPaddingRight");n.addStyleClass("sapUiCompSmartFieldValue");B=new H({justifyContent:b.End,items:[n,t],fitContainer:true,width:this._oParent.getWidth()});B.addStyleClass("sapUiCompUOM");if(this._oParent.isContextTable()){if(w){B.addStyleClass("sapUiCompUOMInTableLTR");}B.addStyleClass("sapUiCompUOMInTable");}return{control:B,onCreate:"_onCreateUOM",params:{getValue:true,valuehelp:true,type:u}};};p.prototype._createEdmUOMAttributes=function(){var A={textAlign:this._getEdmUOMTextAlignment(),placeholder:this.getAttribute("placeholder"),name:this.getAttribute("name"),change:this._oHelper.getUOMChangeHandler(this._oParent)};if(this._oMetaData.annotations.uom&&this._oHelper.oAnnotation.isCurrency(this._oMetaData.annotations.uom.property.property)){A.value={parts:[{path:this._oMetaData.path},{path:this._oHelper.getUOMPath(this._oMetaData)}],model:this._oMetaData.model,type:this._oTypes.getCurrencyType(this._oMetaData.property)};}else{A.value={model:this._oMetaData.model,path:this._oMetaData.path,type:this._oTypes.getType(this._oMetaData.property)};}return A;};p.prototype._getEdmUOMTextAlignment=function(){var A=this.getAttribute("textAlign");if(!A){A=e.Initial;}if(A===e.Initial){if(this._oParent.isContextTable()){return e.End;}else{return e.Begin;}}return A;};p.prototype._createEdmUOMDisplay=function(){var v,P,n,A,s,B,t,r=this;if(this._checkSuppressUnit()){return this._createEdmDisplay();}s=this._getEdmUOMTextAlignment();var u=false;if(this._oParent.isContextTable()&&sap.ui.getCore().getConfiguration().getRTL()){u=true;}P=this._oHelper.getUOMPath(this._oMetaData);A={text:{parts:[{path:this._oMetaData.path,type:this._oTypes.getType(this._oMetaData.property)},{path:P}],model:this._oMetaData.model,formatter:this._oTypes.getDisplayFormatter(this._oMetaData.property.property,this._oHelper.oAnnotation.isCurrency(this._oMetaData.property.property)),useRawValues:true},textAlign:s};if(u){A.textDirection="LTR";}n=this._oParent.getObjectBinding(this._oMetaData.model);this.addObjectBinding(A,n);v=new d(A);P=this._oHelper.getUOMPath(this._oMetaData);A={value:{model:this._oMetaData.model,path:P},change:this._oHelper.getUOMChangeHandler(this._oParent,true),textAlign:this._getEdmUOMTextAlignment()};this.addObjectBinding(A,n);this.mapBindings(A,{"uomEditable":"editable","uomEnabled":"enabled","uomVisible":"visible","mandatory":"mandatory","contextEditable":"contextEditable"});t=new sap.ui.comp.smartfield.SmartField(A);t.data("configdata",{"configdata":{isInnerControl:true,isUOM:!this._oParent.data("configdata"),model:this._oMetaData.model,navigationPath:this._oMetaData.annotations.uom.navigationPath||null,path:P,entitySetObject:this._oMetaData.annotations.uom.entitySet,entityType:this._oMetaData.annotations.uom.entityType,property:this._oMetaData.annotations.uom.property,annotations:{valuelist:this._oMetaData.annotations.valuelistuom,text:this._oMetaData.annotations.textuom},modelObject:this._oMetaData.modelObject||this._oModel,onText:function(w){if(w){if(w.setWrapping){w.setWrapping(false);}if(u&&w.setTextDirection){w.setTextDirection("LTR");}if(r._oParent&&(r._oParent.getControlContext()!=='table')&&(r._oParent.getControlContext()!=='responsiveTable')){w.addStyleClass("sapUiCompSmartFieldUnit");}}},onInput:function(w){v.setLayoutData(new F({growFactor:0}));t.setLayoutData(new F({growFactor:0}));if(w){if(u&&w.setTextDirection){w.setTextDirection("LTR");}if(r._oParent&&(r._oParent.getControlContext()!=='table')&&(r._oParent.getControlContext()!=='responsiveTable')){w.addStyleClass("sapUiCompSmartFieldUnit");}}},getContextEditable:function(){return r._oParent.getContextEditable();}}});t.data("errorCheck","setComplexClientErrorSecondOperandNested");v.addStyleClass("smartFieldPaddingRight");v.addStyleClass("sapUiCompSmartFieldValue");B=new H({items:[v,t],fitContainer:true,width:this._oParent.getWidth()});if(this._oParent.isContextTable()){B.setJustifyContent("End");this._oParent.addStyleClass("sapUiCompUOMInTable");if(u){B.addStyleClass("sapUiCompUOMInTableLTR");}B.addStyleClass("sapUiCompUOMInTable");}return{control:B};};p.prototype._checkSuppressUnit=function(){var n;if(this._oParent.data("suppressUnit")==="true"){return true;}n=this._oParent.getBindingInfo("uomVisible");if(!n&&!this._oParent.getUomVisible()){return true;}return false;};p.prototype._createEdmUOMObjectStatus=function(){var A,n,r,P,s;s=this._oTypes.getDisplayFormatter(this._oMetaData.property.property,this._oHelper.oAnnotation.isCurrency(this._oMetaData.property.property));P=this._oHelper.getUOMPath(this._oMetaData);A={text:{parts:[{path:this._oMetaData.path,type:this._oTypes.getType(this._oMetaData.property)},{path:P}],formatter:function(){var t=s.apply(this,arguments);return t+arguments[1];},useRawValues:true}};this._addObjectStatusAttributes(A);n=this._oParent.getObjectBinding(this._oMetaData.model);this.addObjectBinding(A,n);r=new m(A);r.addStyleClass("sapUiCompUOM");return{control:r};};p.prototype._createEdmUOMObjectNumber=function(){var A,n,r,s;s=this._getEdmUOMTextAlignment();if(this._oMetaData.annotations.uom&&this._oHelper.oAnnotation.isCurrency(this._oMetaData.annotations.uom.property.property)){A={number:{parts:[{path:this._oMetaData.path},{path:this._oHelper.getUOMPath(this._oMetaData)}],type:this._oTypes.getCurrencyType(this._oMetaData.property)},unit:{path:this._oHelper.getUOMPath(this._oMetaData)},model:this._oMetaData.model,textAlign:s};}else{A={model:this._oMetaData.model,number:{path:this._oMetaData.path,type:this._oTypes.getType(this._oMetaData.property)},unit:{path:this._oHelper.getUOMPath(this._oMetaData)},textAlign:s};}n=this._oParent.getObjectBinding(this._oMetaData.model);this.addObjectBinding(A,n);r=new k(A);r.addStyleClass("sapUiCompUOM");return{control:r};};p.prototype._createEdmSemantic=function(){var P,A,t,n=this,r=this._oParent.getBindingInfo("value");P=r.parts[0].path;var s=this._oMetaData.property.property["sap:label"];if(this._oMetaData.annotations.lineitem&&this._oMetaData.annotations.lineitem.labels&&this._oMetaData.annotations.lineitem.labels[P]){s=this._oMetaData.annotations.lineitem.labels[P];}A={semanticObject:this._oMetaData.annotations.semantic.semanticObject,semanticObjectLabel:s,fieldName:P,width:this.getAttribute("width"),createControlCallback:q.proxy(function(){var u=this.createControl(true);if(u){return u.control;}return null;},this)};t=this._oHelper.oAnnotation.getText(this._oMetaData.property.property);if(t){A.text={parts:[this._oMetaData.path,this._oHelper.getEdmDisplayPath(this._oMetaData)],model:this._oMetaData.model,formatter:function(u,v){if(u&&v){return n._formatDisplayBehaviour("defaultInputFieldDisplayBehaviour",u,v);}return u?u:"";}};}else{A.text={path:P,model:this._oMetaData.model};}return{control:new f(A),onCreate:"_onCreate",params:{getValue:"getInnerControlValue"}};};p.prototype._createMultiLineText=function(n){var A=this.createAttributes("value",this._oMetaData.property,n);var r=this.getFormatSettings("multiLineSettings");A=q.extend(true,r,A);var s=new T(A);this._handleEventingForEdmString(s,this._oMetaData.property);return{control:s,onCreate:"_onCreate",getValue:"getValue",params:{type:{type:A.value.type,property:this._oMetaData.property}}};};p.prototype._checkLink=function(){var n=this._oParent.getBindingInfo("url");if(n){return true;}if(this._oParent.getUrl()){return true;}if(this._oParent.hasListeners("press")){return true;}return false;};p.prototype._createLink=function(){var t=this;var A={text:"",href:""};var n=this._oParent.getBindingInfo("url");if(this._oParent.hasListeners("press")){A["press"]=function(E){t._oParent.firePress(E);};}else if(n){A["href"]=this._oBinding.toBinding(n);}else{A["href"]=this._oParent.getUrl();}n=this._oParent.getBindingInfo("value");if(n){if(this._oMetaData.annotations.text&&this._oMetaData.property.property.type==="Edm.String"){A.text={parts:[this._oMetaData.path,this._oHelper.getEdmDisplayPath(this._oMetaData)],formatter:function(s,r){if(s&&r){return t._formatDisplayBehaviour("defaultInputFieldDisplayBehaviour",s,r);}return s?s:"";}};}else{A["text"]=this._oBinding.toBinding(n);}}else{A["text"]=this._oParent.getValue();}return{control:new L(A),onCreate:"_onCreate",params:{noValidation:true}};};p.prototype._createEdmBoolean=function(){var A,n,r,t=this,s=null,E=false;E=this._oParent.getEditable()&&this._oParent.getEnabled()&&this._oParent.getContextEditable();n=this._oSelector.checkComboBox();if(n.combobox){return this._createComboBox({annotation:n.annotation,noDialog:true,noTypeAhead:true},!E);}if(E){A=this.createAttributes("selected",this._oMetaData.property,{},{event:"select",parameter:"selected"});r=new C(A);s={getValue:"getSelected"};}else{A=this.createAttributes("text",this._oMetaData.property,{width:true,textAlign:true});A.text={model:this._oMetaData.model,path:this._oMetaData.path};A.text.formatter=function(v){return t._formatDisplayBehaviour("defaultCheckBoxDisplayBehaviour",v);};r=new d(A);}return{control:r,onCreate:"_onCreate",params:s};};p.prototype._getCreator=function(B){return this._oSelector.getCreator(B);};p.prototype._onCreate=function(n,P){var G,r,v=true,t=this;if(P){if(P.noValidation){v=false;}if(P.valuehelp){this._getValueHelpDialogTitle(P.valuehelp);P.valuehelp["analyser"]=this._oHelper.getAnalyzer(this._oModel||this._oMetaData.modelObject);this.addValueHelp(n,this._oMetaData.property.property,P.valuehelp,this._oModel||this._oMetaData.modelObject,function(E){t._oParent.fireValueListChanged({"changes":E.mParameters.changes});});}if(P.getValue){G=P.getValue;P.getValue=function(){return n[G]();};}if(P.type){r=this._oFieldControl.getMandatoryCheck(P.type.property);if(r){P.type.type.oFieldControl=r;}}}if(v){this.addValidations(n,this._oParent.data("errorCheck")||"setSimpleClientError");}if(!this._checkUOM()){n.addStyleClass("sapUiCompSmartFieldValue");}};p.prototype._checkUOM=function(){var n=this._oParent.data("configdata");if(n&&n.configdata){if(n.configdata.onInput){return true;}if(n.configdata.onText){return true;}}return false;};p.prototype._getValueHelpDialogTitle=function(v){v.dialogtitle=this._oParent.getTextLabel();if(!v.dialogtitle){v.dialogtitle=this._oHelper.oAnnotation.getLabel(this._oMetaData.property.property)||this._oMetaData.property.property.name;}};p.prototype._onCreateUOM=function(n,P){var r,s;r=n.getItems();this.addValidations(r[0],"setComplexClientErrorFirstOperand");if(P&&P.getValue){P.getValue=function(){return r[0].getValue();};}P.uom=function(){var t=r[1].getAggregation("_content");return t.getValue();};P.uomset=function(v){var t=r[1].getAggregation("_content");t.setValue(v);};if(P.type){s=this._oFieldControl.getMandatoryCheck(P.type.property);if(s){P.type.type.oFieldControl=s;}}};p.prototype.bind=function(){var t=this,n,r,s=function(M,P){try{t._init(M);t._setUOMEditState();t._bind(P);}catch(u){q.sap.log.warning(u,null,"sap.ui.comp.smartfield.ODataControlFactory.bind.fInit");}};if(!this._bInitialized&&!this.bPending){this._bInitialized=true;n=this._oFieldControl.getBindableAttributes();r=this._oParent.data("configdata");if(r&&r.configdata){s(this._oMeta,n);}else if(this._oModel){this.bPending=true;this._oModel.getMetaModel().loaded().then(function(){t.bPending=false;s(t._oMeta,n);});}}};p.prototype._bind=function(B){var n,r,s;s=this._oFieldControl.getControlProperties(this._oMetaData,B);for(n in s){r=this._oBinding.fromFormatter(this._oMetaData.model,s[n]);this._oParent.bindProperty(n,r);}this._oParent.fireInitialise();};p.prototype.rebindOnCreated=function(){var n,B,r;r=this._oFieldControl.getControlProperties(this._oMetaData,["editable"]);for(n in r){B=this._oBinding.fromFormatter(this._oMetaData.model,r[n]);this._oParent.bindProperty(n,B);}};p.prototype._setUOMEditState=function(){var n,B;if(this._oFieldControl.hasUomEditState(this._oMetaData)){n=this._oFieldControl.getUOMEditState(this._oMetaData);if(n){B=this._oBinding.fromFormatter(this._oMetaData.model,n);this._oParent.bindProperty("uomEditState",B);}}};p.prototype.getDataProperty=function(){return this._oMetaData.property;};p.prototype.getMetaData=function(){return this._oMetaData;};p.prototype.destroy=function(){this._oFieldControl.destroy();this._oSelector.destroy();this._oTypes.destroy();this._oHelper.destroy();this._oHelper=null;this._oFieldControl=null;this._oTypes=null;this._oSelector=null;this._oMetaData=null;g.prototype.destroy.apply(this,[]);};return p;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.smartfield.SmartField')){
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.ui.comp.smartfield.SmartField');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.Control');jQuery.sap.require('sap.ui.model.ParseException');jQuery.sap.require('sap.ui.model.ValidateException');sap.ui.define("sap/ui/comp/smartfield/SmartField",["jquery.sap.global","sap/ui/comp/library","./JSONControlFactory","./ODataControlFactory","./BindingUtil","./SideEffectUtil","./ODataHelper","sap/ui/core/Control","sap/ui/model/ParseException","sap/ui/model/ValidateException"],function(q,l,J,O,B,S,a,C,P,V){"use strict";var b=C.extend("sap.ui.comp.smartfield.SmartField",{metadata:{library:"sap.ui.comp",properties:{value:{type:"any",group:"Misc",defaultValue:null},enabled:{type:"boolean",group:"Misc",defaultValue:true},entitySet:{type:"string",group:"Misc",defaultValue:null},editable:{type:"boolean",group:"Misc",defaultValue:true},contextEditable:{type:"boolean",group:"Misc",defaultValue:true},width:{type:"sap.ui.core.CSSSize",group:"Misc",defaultValue:null},textAlign:{type:"sap.ui.core.TextAlign",group:"Misc",defaultValue:sap.ui.core.TextAlign.Initial},placeholder:{type:"string",group:"Misc",defaultValue:null},name:{type:"string",group:"Misc",defaultValue:null},valueState:{type:"sap.ui.core.ValueState",group:"Appearance",defaultValue:sap.ui.core.ValueState.None},valueStateText:{type:"string",group:"Appearance",defaultValue:null},showValueStateMessage:{type:"boolean",group:"Appearance",defaultValue:true},jsontype:{type:"sap.ui.comp.smartfield.JSONType",group:"Misc",defaultValue:null},mandatory:{type:"boolean",group:"Misc",defaultValue:false},maxLength:{type:"int",group:"Misc",defaultValue:0},showSuggestion:{type:"boolean",group:"Misc",defaultValue:true},showValueHelp:{type:"boolean",group:"Misc",defaultValue:true},showLabel:{type:"boolean",group:"Appearance",defaultValue:true},textLabel:{type:"string",group:"Misc",defaultValue:null},tooltipLabel:{type:"string",group:"Misc",defaultValue:null},uomVisible:{type:"boolean",group:"Misc",defaultValue:true},uomEditable:{type:"boolean",group:"Misc",defaultValue:true},uomEnabled:{type:"boolean",group:"Misc",defaultValue:true},url:{type:"string",group:"Misc",defaultValue:null},uomEditState:{type:"int",group:"Misc",defaultValue:-1},controlContext:{type:"sap.ui.comp.smartfield.ControlContextType",group:"Misc",defaultValue:sap.ui.comp.smartfield.ControlContextType.None},proposedControl:{type:"sap.ui.comp.smartfield.ControlProposalType",group:"Misc",defaultValue:sap.ui.comp.smartfield.ControlProposalType.None},wrapping:{type:"boolean",group:"Misc",defaultValue:true}},aggregations:{_content:{type:"sap.ui.core.Control",multiple:false,visibility:"hidden"},configuration:{type:"sap.ui.comp.smartfield.Configuration",multiple:false},controlProposal:{type:"sap.ui.comp.smartfield.ControlProposal",multiple:false},_ariaLabelInvisibleText:{type:"sap.ui.core.InvisibleText",multiple:true,visibility:"hidden"}},associations:{ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"}},events:{entitySetFound:{},change:{},initialise:{},visibleChanged:{},editableChanged:{},contextEditableChanged:{},innerControlsCreated:{},valueListChanged:{},press:{}}},renderer:function(r,c){r.write("<div ");r.writeControlData(c);r.addClass("sapUiCompSmartField");r.writeClasses();r.write(">");r.renderControl(c.getAggregation("_content"));if(c.getAggregation("_ariaLabelInvisibleText")){c.getAggregation("_ariaLabelInvisibleText").forEach(function(i){r.renderControl(i);});}r.write("</div>");}});b.prototype.init=function(){this._bInDestroy=false;this._oSideEffects=new S(this);this._oFactory=null;this._oControl={display:null,edit:null,current:null};this._oValue={display:null,edit:null,uom:null,uomset:null};this._oError={bComplex:false,bFirst:false,bSecond:false};this._sBindingContextPath="";this._oValueBind=null;this._oUtil=new B();this._bSuppressToggleControl=false;};b.prototype.setVisible=function(v,s){C.prototype.setVisible.apply(this,arguments);this.fireVisibleChanged({visible:v});return this;};b.prototype.setEditable=function(v){this.setProperty("editable",v,true);this._bPendigEditableState=false;this._toggleControl();this.fireEditableChanged({editable:v});return this;};b.prototype.setContextEditable=function(v){this.setProperty("contextEditable",v,true);this._bPendigEditableState=false;this._toggleControl();this.fireContextEditableChanged({editable:v});return this;};b.prototype.setWidth=function(w){this.setProperty("width",w,true);this._setOnInnerControl();return this;};b.prototype.setWrapping=function(w){this.setProperty("wrapping",w,true);this._setOnInnerControl();return this;};b.prototype._setOnInnerControl=function(){var c,w,W;c=this.getAggregation("_content");if(c){if(c.setWidth){w=this.getWidth();if(w){c.setWidth(w);}}W=this.getWrapping();if(!W&&c.setWrapping&&(this.getControlContext()==="table")){c.setWrapping(W);}}return this;};b.prototype.setUrl=function(v){this.setProperty("url",v,true);return this;};b.prototype.setEntitySet=function(v){this.setProperty("entitySet",v,true);this.fireEntitySetFound({entitySet:v});return this;};b.prototype._setPendingEditState=function(d){this.data("pedingEditableState",!d);};b.prototype.applySettings=function(s){if(s&&s.customData){for(var i=0;i<s.customData.length;i++){var c=s.customData[i];if(c&&c.mProperties&&c.mProperties.key==="pedingEditableState"){this._bPendigEditableState=c.mProperties.value;}}}C.prototype.applySettings.apply(this,arguments);};b.prototype.setEnabled=function(v){this.setProperty("enabled",v,true);this._toggleControl();return this;};b.prototype.getValue=function(){var p,f;p=this._getMode();f=this._oValue[p];if(f){return f();}return this.getProperty("value");};b.prototype.getValueState=function(){var c,i;c=this.getInnerControls();i=this._getMaxSeverity(c);if(i>-1){return c[i].getValueState();}return sap.ui.core.ValueState.None;};b.prototype.setValueState=function(v){var c,o,m="setSimpleClientError";c=this.getInnerControls();if(c&&c.length){o=c[0];if(c.length>1){m="setComplexClientErrorFirstOperand";}}if(o&&o.setValueState){o.setValueState(v);this[m](v===sap.ui.core.ValueState.Error);}return this;};b.prototype.getValueStateText=function(){var c,i;c=this.getInnerControls();i=this._getMaxSeverity(c);if(i>-1){return c[i].getValueStateText();}return this.getProperty("valueStateText");};b.prototype.setValueStateText=function(t){var c,o;c=this.getInnerControls();if(c&&c.length){o=c[0];}if(o&&o.setValueStateText){o.setValueStateText(t);}return this;};b.prototype._getMaxSeverity=function(c){var s,o,i,d,e=0,I=-1,m={"Error":3,"Warning":2,"Success":1,"None":0};d=c.length;for(i=0;i<d;i++){o=c[i];if(o.getValueState){s=o.getValueState();if(s&&m[s]>e){e=m[s];I=i;}}}return I;};b.prototype.getFocusDomRef=function(){var c,o,d;c=this.getInnerControls();d=c.length;if(d>0){o=c[0];}if(o&&o.getFocusDomRef){return o.getFocusDomRef();}return sap.ui.core.Element.prototype.getFocusDomRef.apply(this,[]);};b.prototype.updateBindingContext=function(s,m,u){if(this._bInDestroy){return;}this._init(m);if(this._oFactory){if(this.getBindingContext()){this._sBindingContextPath=this.getBindingContext().getPath();}if(this._oFactory.bind){this._oFactory.bind();this._checkFieldGroups();}else{this._toggleControl();}}C.prototype.updateBindingContext.apply(this,arguments);};b.prototype._getMode=function(){var e=this.getEditable(),E=this.getEnabled(),c=this.getContextEditable();if(this.getControlContext()==="responsiveTable"&&this.data("suppressUnit")!=="true"){if(!e||!c||!E||(this.getUomEditState()===0)){return"display_uom";}}return e&&E&&c?"edit":"display";};b.prototype._toggleControl=function(){var m,v,c,d=true;if(this._bPendigEditableState||this._bSuppressToggleControl){return;}if(!this._oFactory||this._oFactory.bPending){return;}m=this._getMode();if(m==="edit"||m==="display_uom"){this._createControl(m);}else{v=this.getValue();c=this.data("configdata");if(c&&c.configdata&&!c.configdata.isUOM){if(v===null||v===""){d=false;}}if(d){this._createControl(m);}else{this.setAggregation("_content",null);this._oControl.current="display";}}this._setOnInnerControl();};b.prototype.setValue=function(v){var r=this.setProperty("value",v,true);if(this._oFactory&&!this._oFactory.bPending){this._toggleControl();}return r;};b.prototype._createControl=function(m){var c;if(this._oFactory){if(m!==this._oControl.current||!this._oControl[m]){if(!this._oControl[m]){c=this._oFactory.createControl();if(c){this._oControl[m]=c.control;this._placeCallBacks(c,m);}}this._oControl.current=m;this.setAggregation("_content",this._oControl[m]);this.fireInnerControlsCreated(this.getInnerControls());}else{if(!this.getAggregation("_content")){this.setAggregation("_content",this._oControl[m]);}}}};b.prototype._placeCallBacks=function(c,m){if(c.params&&c.params.getValue){this._oValue[m]=c.params.getValue;}if(c.params&&c.params.uom){this._oValue.uom=c.params.uom;}if(c.params&&c.params.uomset){this._oValue.uomset=c.params.uomset;}};b.prototype._init=function(m){var M,o,c;if(this._sBindingContextPath&&this.getBindingContext()&&this._sBindingContextPath!=this.getBindingContext().getPath()){this._destroyFactory();}if(!this._oFactory){c=this.data("configdata");if(!c){M=this.getModel(m);}o=this._getBindingInfo(m,"value");if(o){if(c||M){this._oFactory=this._createFactory(m,M,o,c);}}else if(M&&!(M instanceof sap.ui.model.json.JSONModel)){if(this.getBindingInfo("url")||this.getUrl()){if(c||M){this._oFactory=this._createFactory(m,M,o,c);}}}}};b.prototype._destroyFactory=function(){this._bSuppressToggleControl=true;this._oFactory.destroy();this._oFactory=null;this._bSuppressToggleControl=false;if(this._oControl["display"]){this._oControl["display"].destroy();this._oControl["display"]=null;}if(this._oControl["edit"]){this._oControl["edit"].destroy();this._oControl["edit"]=null;}this._oControl["current"]=null;this.destroyAggregation("_content");};b.prototype._createFactory=function(m,M,o,c){var e,p;if(M&&M instanceof sap.ui.model.json.JSONModel){return new J(M,this,{model:m,path:o.path});}if(!c){e=this._getEntitySet(m);}if(e||c){if(c){p=c.configdata;}else{p={entitySet:e,model:m,path:(o&&o.path)?o.path:""};}return new O(M,this,p);}return null;};b.prototype._getEntitySet=function(m){var o,e;e=this.getEntitySet();if(e&&!m){return e;}o=this.getBindingContext(m);if(o){if(!o.sPath||(o.sPath&&o.sPath==="/undefined")){return null;}e=this._oUtil.correctPath(o.sPath);this.fireEntitySetFound({entitySet:e});return e;}return null;};b.prototype._getBindingInfo=function(m,n){if(!this._oValueBind){this._oValueBind=this.getBindingInfo(n);try{this._oValueBind=this._oValueBind.parts[0];}catch(e){}}if(this._oValueBind){if(!this._oValueBind.model&&!m){return this._oValueBind;}if(this._oValueBind.model===m){return this._oValueBind;}}return null;};b.prototype.getDataType=function(){var p;if(this._oFactory){if(this._oFactory.getDataProperty){p=this._oFactory.getDataProperty();if(p){return p.property.type;}}return this.getJsonType();}return null;};b.prototype.getDataProperty=function(){if(this._oFactory){if(this._oFactory.getDataProperty){return this._oFactory.getDataProperty();}return null;}return null;};b.prototype.getUnitOfMeasure=function(){if(this._oValue.uom){return this._oValue.uom();}return null;};b.prototype.setUnitOfMeasure=function(u){if(u&&this._oValue.uomset){this._oValue.uomset(u);}};b.prototype.setSimpleClientError=function(e){this._oError.bFirst=e;};b.prototype.setComplexClientErrorFirstOperand=function(e){this._oError.bComplex=true;this._oError.bFirst=e;};b.prototype.setComplexClientErrorSecondOperand=function(e){this._oError.bComplex=true;this._oError.bSecond=e;};b.prototype.setComplexClientErrorSecondOperandNested=function(e){var p=this.getParent().getParent();p.setComplexClientErrorSecondOperand(e);};b.prototype._hasClientError=function(){if(this._oError.bComplex){return this._oError.bFirst||this._oError.bSecond;}return this._oError.bFirst;};b.prototype.checkClientError=function(){var c,d,i;if(this._getMode()==="display"){return false;}if(this._hasClientError()){return true;}c=this.getInnerControls();d=c.length;for(i=0;i<d;i++){this._checkClientError(c[i]);}return this._hasClientError();};b.prototype._checkClientError=function(c){var v=null,t=null,p=null;var o,m,s,d={"sap.m.Input":"value","sap.m.DatePicker":"value","sap.m.ComboBox":"selectedKey"};if(c){s=d[c.getMetadata()._sClassName];}if(s){o=c.getBinding(s);}if(o){try{m="get"+s.substring(0,1).toUpperCase()+s.substring(1);v=c[m]();t=o.getType();if(o.sInternalType){p=t.parseValue(v,o.sInternalType);t.validateValue(p);}}catch(e){if(e instanceof P){c.fireParseError({exception:e});}if(e instanceof V){c.fireValidationError({exception:e});}}}};b.prototype.isContextTable=function(){return(this.getControlContext()==="responsiveTable"||this.getControlContext()==="table"||this.getControlContext()==="smartFormGrid");};b.prototype.getInnerControls=function(){var c,f,m={"sap.m.HBox":function(o){var d,i,e=0;i=o.getItems();if(i){e=i.length;}if(e===0){return[];}if(e===1){return[i[0]];}d=i[1].getAggregation("_content");if(d){return[i[0],d];}return[i[0]];},"sap.ui.comp.navpopover.SmartLink":function(o){var i=o.getAggregation("innerControl");if(i){return[i];}return[];}};c=this.getAggregation("_content");if(c){f=m[c.getMetadata()._sClassName];}if(f){return f(c);}if(c){return[c];}return[];};b.prototype._getEmbeddedSmartField=function(){var c=this.getAggregation("_content");if(c){if(c instanceof sap.m.HBox){var h=c.getItems();if(h){for(var j=0;j<h.length;j++){if(h[j]instanceof b){return h[j];}}}}}return null;};b.prototype.onAfterRendering=function(){if(C.prototype.onAfterRendering){C.prototype.onAfterRendering.apply(this);}this._checkFieldGroups();};b.prototype._checkFieldGroups=function(){var v,m,M=this._getMode();if(this.getBindingContext()&&this._oFactory&&this._oFactory.getMetaData&&M==="edit"&&!this._bSideEffects){m=this._oFactory.getMetaData();if(m&&!m.property||(m.property&&!m.property.property)){return;}v=this._getView();if(v&&m){this._setFieldGroup(m,v);}}};b.prototype._setFieldGroup=function(m,v){var c,i=this._oSideEffects.getFieldGroupIDs(m,v);if(i){c=this.getInnerControls();if(c.length){this._bSideEffects=true;c[0].setFieldGroupIds(i);}}};b.prototype._getView=function(){var o=this.getParent();while(o){if(o instanceof sap.ui.core.mvc.View){return o;}o=o.getParent();}return null;};b.prototype.refreshDataState=function(n,d){var o,c;if(n==="value"){if(d.isLaundering()){if(this.getEditable()){o=this.getBindingContext();if(o&&o.getObject){c=o.getObject();if(c&&c.__metadata&&c.__metadata.created){this._checkCreated=true;return;}}}}if(this._checkCreated&&!d.isLaundering()&&!d.isDirty()){this._oFactory.rebindOnCreated();delete this._checkCreated;}}};b.prototype.exit=function(){this._bInDestroy=true;var i=null;if(this._oSideEffects){this._oSideEffects.destroy();}if(this._oUtil){this._oUtil.destroy();}if(this._oFactory){this._oFactory.destroy();}if(this._getMode()==="edit"){i=this._oControl["display"];}else{i=this._oControl["edit"];}if(i&&i.destroy){i.destroy();}this._oUtil=null;this._oError=null;this._oValue=null;this._oFactory=null;this._oControl=null;this._oValueBind=null;this._oSideEffects=null;};b.getSupportedAnnotationPaths=function(m,e,v,n){var c,u,r=[],M;if(m&&e&&v){M={entitySet:e,entityType:m.getODataEntityType(e.entityType),path:v};c={helper:new a(null,null,m)};if(n){c.navigationPathOnly=n;}c.helper.getProperty(M);b._getFromEntitySet(r,M,c);b._getFromProperty(r,M,c);u=c.helper.getUnitOfMeasure2(M);if(u){b._getFromProperty(r,u,c);}c.helper.destroy();}return r;};b._getFromEntitySet=function(r,m,c){var p;if(m.entitySet){p=c.helper.oAnnotation.getUpdateEntitySetPath(m.entitySet);b._push(p,r,m,c);}};b._push=function(p,r,m,c){var d,s,e,o,R={};if(p){if(c.navigationPathOnly){d=p.split("/");e=d.length;R.entityType=m.entityType;while(e--){s=d.shift();if(s===""){continue;}R=c.helper.getNavigationProperty(R.entityType,s);if(!R.entitySet){break;}if(o){o=o+"/"+s;}else{o=s;}}}else{o=p;}}if(o){if(m.navigationPath){r.push(m.navigationPath+"/"+o);}else{r.push(o);}}};b._getFromProperty=function(r,m,c){var p;if(m.property.property){p=c.helper.oAnnotation.getText(m.property.property);b._push(p,r,m,c);p=c.helper.oAnnotation.getUnit(m.property.property);b._push(p,r,m,c);p=c.helper.oAnnotation.getFieldControlPath(m.property.property);b._push(p,r,m,c);}};b.prototype.addAssociation=function(A,i,s){if(A==="ariaLabelledBy"){this.getInnerControls().forEach(function(c){if(c.addAriaLabelledBy){c.addAriaLabelledBy(i);}});}C.prototype.addAssociation.apply(this,arguments);};return b;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.smartfield.SmartLabel')){jQuery.sap.declare('sap.ui.comp.smartfield.SmartLabel');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.m.Label');jQuery.sap.require('sap.m.LabelRenderer');sap.ui.define("sap/ui/comp/smartfield/SmartLabel",['jquery.sap.global','sap/m/Label','sap/m/LabelRenderer','sap/ui/comp/library','./BindingUtil',"./AnnotationHelper","./SmartField"],function(q,L,a,l,B,A,S){"use strict";var b=L.extend("sap.ui.comp.smartfield.SmartLabel",{metadata:{library:"sap.ui.comp"},renderer:a.render});b.prototype.init=function(){this._sSmartFieldId=null;};b.prototype.bindRequiredPropertyToSmartField=function(){var i=null,o=null;var s=this._getField();if(s&&s.getContextEditable()&&s.getEditable()){o=new B();i=s.getBindingInfo("mandatory");if(i){this.bindProperty("required",o.toBinding(i));}else{this.setRequired(s.getMandatory());}}else{this.unbindProperty("required");this.setRequired(false);}};b.prototype._bindProperties=function(){var s=this._getField();if(s){var o=new B();var i=s.getBindingInfo("visible");if(i){this.bindProperty("visible",o.toBinding(i));}else{this.setVisible(s.getVisible());}this.bindRequiredPropertyToSmartField();i=s.getBindingInfo("textLabel");if(i){this.bindProperty("text",o.toBinding(i));}else{if(!this.getBindingInfo("text")){this.setText(s.getTextLabel());}}i=s.getBindingInfo("tooltipLabel");if(i){this.bindProperty("tooltip",o.toBinding(i));}else{this.setTooltip(s.getTooltipLabel());}}};b.prototype.getLabelInfo=function(){var m,o;var s=this._getField();if(s){this._bindProperties();m=s.getDataProperty();if(m){o=this._getLabelInfo(m);if(o){if(o.text){this._setProperty(this,"text",o.text);}if(o.quickinfo){this._setProperty(this,"tooltip",o.quickinfo);}}}}};b.prototype._setProperty=function(o,p,v){var P;if(o&&p){if(v.match(/{@i18n>.+}/gi)){o.bindProperty(p,v.substring(1,v.length-1));}else{P=p.substring(0,1).toUpperCase()+p.substring(1);if(!o.getBindingInfo(p)&&!o["get"+P]()){o["set"+P](v);}}}};b.prototype.setLabelFor=function(s){if(s){if(typeof s==='string'){this._sSmartFieldId=s;}else{this._sSmartFieldId=s.getId();}this._setLabelFor();sap.m.Label.prototype.setLabelFor.apply(this,[s]);}};b.prototype._getField=function(){if(this._sSmartFieldId){return sap.ui.getCore().byId(this._sSmartFieldId);}return null;};b.prototype._setLabelFor=function(){var d;var s=this._getField();if(s){if(s&&!this._bMetaDataApplied){this._bMetaDataApplied=true;if(s.getDataProperty){d=s.getDataProperty();if(d){this.getLabelInfo();}else{s.attachInitialise(q.proxy(this.getLabelInfo,this));}}}}};b.prototype.updateLabelFor=function(c){if(c&&c.length>0){sap.m.Label.prototype.setLabelFor.apply(this,[c[0]]);c.splice(0,1);this.updateAriaLabeledBy(c);}};b.prototype.updateAriaLabeledBy=function(c){if(c){for(var i=0;i<c.length;i++){if(c[i].addAriaLabelledBy){c[i].addAriaLabelledBy(this);}}}};b.prototype.setText=function(v){this.setProperty("text",v);};b.prototype._getLabelInfo=function(p){var o=new A();if(p&&p.property){return{text:o.getLabel(p.property),quickinfo:o.getQuickInfo(p.property)};}};b.prototype.onBeforeRendering=function(){if(this._sSmartFieldId&&!this._bMetaDataApplied){this._setLabelFor();var s=this._getField();if((s&&s instanceof S)&&(s.getId()===this.getLabelFor())){this.updateLabelFor(s.getInnerControls());}}};b.prototype.destroy=function(s){this._sSmartFieldId=null;L.prototype.destroy.apply(this,[s]);};return b;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.smartfilterbar.FilterProvider')){jQuery.sap.declare('sap.ui.comp.smartfilterbar.FilterProvider');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.m.ComboBox');jQuery.sap.require('sap.m.DatePicker');jQuery.sap.require('sap.m.DateRangeSelection');jQuery.sap.require('sap.m.TimePicker');jQuery.sap.require('sap.m.Input');jQuery.sap.require('sap.m.MultiComboBox');jQuery.sap.require('sap.m.MultiInput');jQuery.sap.require('sap.m.SearchField');jQuery.sap.require('sap.m.Token');jQuery.sap.require('sap.ui.model.Filter');jQuery.sap.require('sap.ui.model.json.JSONModel');sap.ui.define("sap/ui/comp/smartfilterbar/FilterProvider",['jquery.sap.global','sap/m/ComboBox','sap/m/DatePicker','sap/m/DateRangeSelection','sap/m/TimePicker','sap/m/Input','sap/m/MultiComboBox','sap/m/MultiInput','sap/m/SearchField','sap/m/Token','sap/ui/comp/odata/MetadataAnalyser','sap/ui/comp/providers/ValueHelpProvider','sap/ui/comp/providers/ValueListProvider','sap/ui/model/Filter','sap/ui/model/json/JSONModel','sap/ui/comp/odata/ODataType','sap/ui/comp/util/FormatUtil'],function(q,C,D,a,T,I,M,b,S,c,d,V,e,F,J,O,f){"use strict";var g=function(p){this._bInitialized=false;this._bPending=true;if(p){this._oParentODataModel=p.model;this._sServiceURL=p.serviceUrl;this._sBasicSearchFieldName=p.basicSearchFieldName;this._isBasicSearchEnabled=p.enableBasicSearch;this._bUseContainsAsDefault=p.useContainsAsDefaultFilter==="true";this.sEntityType=p.entityType;this._isRunningInValueHelpDialog=p.isRunningInValueHelpDialog;this._oAdditionalConfiguration=p.additionalConfiguration;this.sDefaultDropDownDisplayBehaviour=p.defaultDropDownDisplayBehaviour;this.sDefaultTokenDisplayBehaviour=p.defaultTokenDisplayBehaviour;if(typeof p.dateFormatSettings==="string"){try{this._oDateFormatSettings=p.dateFormatSettings?JSON.parse(p.dateFormatSettings):undefined;}catch(h){}}else{this._oDateFormatSettings=p.dateFormatSettings;}this._oSmartFilter=p.smartFilter;}this.sFilterModelName=g.FILTER_MODEL_NAME;this._sBasicFilterAreaID=g.BASIC_FILTER_AREA_ID;this._aFilterBarViewMetadata=[];this._aFilterBarMultiValueFieldMetadata=[];this._aFilterBarDateFieldNames=[];this._aFilterBarTimeFieldNames=[];this._aFilterBarTimeIntervalFieldNames=[];this._aFilterBarDateTimeMultiValueFieldNames=[];this._aFilterBarStringFieldNames=[];this._aFieldGroupAnnotation=[];this._oMetadataAnalyser=new d(this._oParentODataModel||this._sServiceURL);this.oModel=new J();this._aValueListProvider=[];this._aValueHelpDialogProvider=[];this._mConditionTypeFields={};this._intialiseMetadata();this._bInitialized=true;};g.FILTER_MODEL_NAME="fi1t3rM0d31";g.BASIC_FILTER_AREA_ID="_BASIC";g.BASIC_SEARCH_FIELD_ID="_BASIC_SEARCH_FIELD";g.CUSTOM_FIELDS_MODEL_PROPERTY="_CUSTOM";g.FIELD_NAME_REGEX=/\./g;g.prototype._intialiseMetadata=function(){var G,h,o,k,i,j,l,m,n,p,r;this._aFilterBarViewMetadata.push({groupName:this._sBasicFilterAreaID,index:0,fields:[]});this.sEntityTypeName=this._oMetadataAnalyser.removeNamespace(this.sEntityType);k=this._oMetadataAnalyser.getAllFilterableFieldsByEntityTypeName(this.sEntityType);if(k){this._updateDisplayBehaviour();this._aFieldGroupAnnotation=this._oMetadataAnalyser.getFieldGroupAnnotation(this.sEntityType);if(this._aFieldGroupAnnotation){G=this._aFieldGroupAnnotation.length;for(i=0;i<G;i++){o=this._aFieldGroupAnnotation[i];n=this._createGroupMetadata(o);n.index=this._aFilterBarViewMetadata.length;this._aFilterBarViewMetadata.push(n);}}G=k.length;for(i=0;i<G;i++){o=k[i];h=o.fields.length;n=this._createGroupMetadata(o);this._aFilterBarViewMetadata.push(n);for(j=0;j<h;j++){l=o.fields[j];if(l.type.indexOf("Edm.")===0){m=this._createFieldMetadata(l);n.fields.push(m);}}}}r=this._getAdditionalConfigurationForCustomGroups(k);G=r.length;for(j=0;j<G;j++){n=this._createGroupMetadataForCustomGroup(r[j]);if(n){this._aFilterBarViewMetadata.push(n);}}p=this._getAdditionalConfigurationForCustomFilterFields();h=p.length;for(j=0;j<h;j++){m=this._createFieldMetadataForCustomFilterFields(p[j]);if(m){this._aFilterBarViewMetadata[0].fields.push(m);}}if(this._hasBasicSearch()){m=this._createBasicSearchFieldMetadata();this._aFilterBarViewMetadata[0].fields.push(m);}this._applyGroupId();this._applyIndexes();this._createInitialModel(true);this._initializeConditionTypeFields();this.setPending(this.isPending());};g.prototype.attachPendingChange=function(h){this._fPendingChange=h;};g.prototype.detachPendingChange=function(){this._fPendingChange=null;};g.prototype.setPending=function(v){var h=this._bPending!==v;this._bPending=v;if(h&&this._fPendingChange){this._fPendingChange(v);}};g.prototype.isPending=function(){if(!this._bInitialized){return true;}for(var n in this._mConditionTypeFields){if(this._mConditionTypeFields[n].conditionType.isPending()){return true;}}return false;};g.prototype._updateDisplayBehaviour=function(){this._sTextArrangementDisplayBehaviour=this._oMetadataAnalyser.getTextArrangementValue(this.sEntityType);if(!this.sDefaultDropDownDisplayBehaviour){if(this._sTextArrangementDisplayBehaviour){this.sDefaultDropDownDisplayBehaviour=this._sTextArrangementDisplayBehaviour;}else{this.sDefaultDropDownDisplayBehaviour=sap.ui.comp.smartfilterbar.ControlConfiguration.DISPLAYBEHAVIOUR.descriptionOnly;}}if(!this.sDefaultTokenDisplayBehaviour){if(this._sTextArrangementDisplayBehaviour){this.sDefaultTokenDisplayBehaviour=this._sTextArrangementDisplayBehaviour;}else{this.sDefaultTokenDisplayBehaviour=sap.ui.comp.smartfilterbar.ControlConfiguration.DISPLAYBEHAVIOUR.descriptionAndId;}}};g.prototype._hasBasicSearch=function(){return this._isBasicSearchEnabled;};g.prototype._getAdditionalConfigurationForCustomFilterFields=function(){var h,l,n,i,r,j,k,o;if(!this._oAdditionalConfiguration){return[];}h=this._oAdditionalConfiguration.getControlConfiguration();o=this._oMetadataAnalyser.getAllFilterableFieldNamesByEntityTypeName(this.sEntityType);if(!o||!o.length){return h;}r=[];n=o.length;l=h.length;for(i=0;i<l;i++){k=false;for(j=0;j<n;j++){if(o[j]===h[i].key){k=true;break;}}if(!k){r.push(h[i]);}}return r;};g.prototype._getAdditionalConfigurationForCustomGroups=function(o){var G,l,n,i,r,j,h,s;if(!this._oAdditionalConfiguration){return[];}G=this._oAdditionalConfiguration.getGroupConfiguration();if(!o||!o.length){return G;}r=[];n=o.length;l=G.length;for(i=0;i<l;i++){h=false;for(j=0;j<n;j++){s=o[j].groupName||o[j].groupEntityName;if(s===G[i].key){h=true;break;}}if(!h){r.push(G[i]);}}return r;};g.prototype._createInitialModelForField=function(j,o,u){var h,i,H=false,k=false,l=null,s=null,L,m=null,n=[],r=[];if(!o||o.isCustomFilterField){return;}if(o.filterRestriction!==sap.ui.comp.smartfilterbar.ControlConfiguration.FILTERTYPE.multiple){k=true;}if(u){h=o.defaultFilterValues;H=h&&h.length;}if(o.filterRestriction===sap.ui.comp.smartfilterbar.ControlConfiguration.FILTERTYPE.single){if(H){i=h[0];l=i.low;}j[o.fieldName]=l;}else if(o.filterRestriction===sap.ui.comp.smartfilterbar.ControlConfiguration.FILTERTYPE.interval&&o.type!=="Edm.Time"){if(H){i=h[0];l=i.low;s=i.high;}j[o.fieldName]={low:l,high:s};}else{if(H){L=h.length;while(L--){i=h[L];if(k){m={"exclude":i.sign==="E","operation":i.operator,"keyField":o.fieldName,"value1":i.low,"value2":i.high};}else{m={key:i.low,text:i.low};}n.push(m);}}this._aFilterBarMultiValueFieldMetadata.push(o);j[o.fieldName]={value:null};if(k){r=n.slice(0);n=[];j[o.fieldName].ranges=r;}j[o.fieldName].items=n;this._updateMultiValueControl(o.control,n,r);}};g.prototype._createInitialModel=function(u){var o,G,h,k,j,i;o={};this._bCreatingInitialModel=true;this._aFilterBarMultiValueFieldMetadata=[];if(this._aFilterBarViewMetadata){G=this._aFilterBarViewMetadata.length;for(i=0;i<G;i++){k=this._aFilterBarViewMetadata[i];h=k.fields.length;for(j=0;j<h;j++){this._createInitialModelForField(o,k.fields[j],u);}}}this.oModel.setData(o);this._updateConditionTypeFields([]);this._bCreatingInitialModel=false;};g.prototype._updateMultiValueControl=function(o,h,r){var i=0,t=null,j=null,R=null,s=null,k=null;if(o&&h){i=h.length;if(o instanceof b){t=[];while(i--){s=h[i].text||h[i].key;t.push(new c({key:h[i].key,text:s,tooltip:s}));}if(r){i=r.length;while(i--){R=r[i];if(R.tokenText){s=R.tokenText;}else{s=f.getFormattedRangeText(R.operation,R.value1,R.value2,R.exclude);}j=new c({text:s,tooltip:s});j.data("range",R);t.push(j);}}o.setTokens(t);}if(o instanceof M){k=[];while(i--){k.push(h[i].key);}o.setSelectedKeys(k);}}};g.prototype._applyIndexes=function(){var h,i;if(!this._aFilterBarViewMetadata){return;}this._aFilterBarViewMetadata=this._sortByIndex(this._aFilterBarViewMetadata);h=this._aFilterBarViewMetadata.length;for(i=0;i<h;i++){if(this._aFilterBarViewMetadata[i].fields){this._aFilterBarViewMetadata[i].fields=this._sortByIndex(this._aFilterBarViewMetadata[i].fields);}}};g.prototype._sortByIndex=function(A){var h,i,l,j,k,r;if(!A||!A.length){return A;}r=[];h=[];l=A.length;for(i=0;i<l;i++){if(parseInt(A[i].index,10)||A[i].index===0){if(h.length===0){h.push(A[i]);}else{k=h.length;for(j=0;j<k;j++){if(h[j].index>A[i].index){h.splice(j,0,A[i]);break;}else if(j+1===h.length){h.push(A[i]);break;}}}}else{r.push(A[i]);}}l=h.length;for(i=0;i<l;i++){if(h[i].index>r.length){r.push(h[i]);}else{r.splice(h[i].index,0,h[i]);}}return r;};g.prototype._applyGroupId=function(){var h,i,l,j,o,n,k;h=this._aFilterBarViewMetadata.length;for(i=0;i<h;i++){if(!this._aFilterBarViewMetadata[i].fields){continue;}l=this._aFilterBarViewMetadata[i].fields.length;for(j=0;j<l;j++){o=this._aFilterBarViewMetadata[i].fields[j];if(o&&o.groupId&&o.groupId!==this._aFilterBarViewMetadata[i].groupName){n=undefined;for(k=0;k<h;k++){if(this._aFilterBarViewMetadata[k].groupName===o.groupId){n=this._aFilterBarViewMetadata[k];break;}}if(n){this._aFilterBarViewMetadata[i].fields.splice(j,1);j--;l--;n.fields=n.fields||[];n.fields.push(o);}}}}};g.prototype._createGroupMetadata=function(o){var G,h,s;s=o.groupName||o.groupEntityName;h=this._oAdditionalConfiguration.getGroupConfigurationByKey(s);G={};G.groupName=s;G.groupLabel=this._getGroupLabel(o,h);G.fields=[];G.index=this._getGroupIndex(h);return G;};g.prototype._createGroupMetadataForCustomGroup=function(G){var o;o={};o.groupName=G.key;o.groupLabel=G.label;o.fields=[];o.index=this._getGroupIndex(G);return o;};g.prototype._createControl=function(o){var h,t,i=false,j,k={},m,l;if(o.customControl){return o.customControl;}if(o.precision||o.scale){k.precision=o.precision;k.scale=o.scale;}if(o.maxLength){k.maxLength=o.maxLength;}if(o.displayFormat){k.displayFormat=o.displayFormat;}if(o.fControlConstructor===a||o.fControlConstructor===D){j=this._oDateFormatSettings;}t=O.getType(o.type,j,k);h=new o.fControlConstructor();if(o.fControlConstructor===a){h.bindProperty('dateValue',this.sFilterModelName+">/"+o.fieldName+"/low");h.bindProperty('secondDateValue',this.sFilterModelName+">/"+o.fieldName+"/high");}else if(o.fControlConstructor===C){if(h.setForceSelection){h.setForceSelection(true);}this._associateValueList(h,"items",o);h.attachSelectionChange(function(){if(this._bUpdatingFilterData||this._bCreatingInitialModel){return;}h.fireChange({filterChangeReason:o.fieldName,value:""});}.bind(this));h.bindProperty('selectedKey',this.sFilterModelName+">/"+o.fieldName);}else if(o.fControlConstructor===M){this._associateValueList(h,"items",o);h.attachSelectionChange(function(E){if(this._bUpdatingFilterData||this._bCreatingInitialModel){return;}var n=E.getSource(),s=null,K=[],L;s=n.getSelectedItems();if(s){L=s.length;while(L--){K.push({key:s[L].getKey(),text:s[L].getText()});}}if(this.oModel){this.oModel.setProperty("/"+o.fieldName+"/items",K);}n.fireChange({filterChangeReason:o.fieldName,value:""});}.bind(this));h.bindProperty('value',this.sFilterModelName+">/"+o.fieldName+"/value");}else if(o.fControlConstructor===b){if(o.controlType===sap.ui.comp.smartfilterbar.ControlConfiguration.CONTROLTYPE.date||o.type==="Edm.Time"){h.setValueHelpOnly(true);if(o.filterRestriction===sap.ui.comp.smartfilterbar.ControlConfiguration.FILTERTYPE.interval){this._associateValueHelpDialog(h,o,false,false);}else{this._associateValueHelpDialog(h,o,true,true);}}else{if(o.hasValueHelpDialog){this._associateValueHelpDialog(h,o,o.filterRestriction!==sap.ui.comp.smartfilterbar.ControlConfiguration.FILTERTYPE.multiple,true);}else{h.setShowValueHelp(false);}h.bindProperty('value',{path:this.sFilterModelName+">/"+o.fieldName+"/value",type:t});}this._handleMultiInput(h,o);}else if(o.fControlConstructor===I){if(o.filterRestriction===sap.ui.comp.smartfilterbar.ControlConfiguration.FILTERTYPE.interval){i=true;h.bindProperty('value',this.sFilterModelName+">/"+o.fieldName+"/low");if(!this.oResourceBundle){this.oResourceBundle=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");}if(!this.sIntervalPlaceholder){this.sIntervalPlaceholder=this.oResourceBundle.getText("INTERVAL_PLACEHOLDER_TEXT");}h.setPlaceholder(this.sIntervalPlaceholder);}else{h.bindProperty('value',{path:this.sFilterModelName+">/"+o.fieldName,type:t});}if(o.hasValueHelpDialog){h.setShowValueHelp(true);this._associateValueHelpDialog(h,o,false,false);}}else if(o.fControlConstructor===D||o.fControlConstructor===T){h.bindProperty('dateValue',this.sFilterModelName+">/"+o.fieldName);}if(h instanceof D){if(this._oDateFormatSettings&&this._oDateFormatSettings.style){h.setDisplayFormat(this._oDateFormatSettings.style);}h.attachChange(function(E){var v=E.getParameter("valid");h.data("__mandatoryEmpty",null);if(v){h.setValueState(sap.ui.core.ValueState.None);h.setValueStateText();}else{h.setValueState(sap.ui.core.ValueState.Error);if(t){try{t.parseValue("foo","string");}catch(n){h.setValueStateText(n.message);}}}});}if(o.hasTypeAhead){h.setShowSuggestion(true);h.setFilterSuggests(false);this._associateValueList(h,"suggestionRows",o,true);}if(o.displayFormat==="UpperCase"&&h.attachChange&&h.setValue){h.attachChange(function(){var v=h.getValue();if(v){h.setValue(v.toUpperCase());}});}if(h instanceof I){if(!o.hasValueListAnnotation&&!i&&o.maxLength){m=parseInt(o.maxLength,10);if(!isNaN(m)){h.setMaxLength(m);}}}l=function(E){var n=E.getParameter("exception");if(h){if(n){if(h.setValueStateText){h.setValueStateText(n.message);}}if(h.setValueState){h.setValueState(sap.ui.core.ValueState.Error);}h.data("__mandatoryEmpty",null);}};h.attachParseError(l);h.attachFormatError(l);h.attachValidationError(l);h.attachValidationSuccess(function(E){if(h){if(h.setValueState){h.setValueState(sap.ui.core.ValueState.None);}if(h.setValueStateText){h.setValueStateText();}h.data("__mandatoryEmpty",null);delete h.__sValidationText;}});return h;};g.prototype._getControlConstructor=function(o){var h=I,i,j;if(o.isCustomFilterField){h=undefined;}else{i=(o.filterRestriction===sap.ui.comp.smartfilterbar.ControlConfiguration.FILTERTYPE.single);j=(o.filterRestriction===sap.ui.comp.smartfilterbar.ControlConfiguration.FILTERTYPE.interval);if(o.controlType===sap.ui.comp.smartfilterbar.ControlConfiguration.CONTROLTYPE.date){o.displayFormat="Date";if(i){h=D;}else{h=j?a:b;}this._aFilterBarDateFieldNames.push(o.fieldName);if(o.filterRestriction===sap.ui.comp.smartfilterbar.ControlConfiguration.FILTERTYPE.multiple){this._aFilterBarDateTimeMultiValueFieldNames.push(o.fieldName);}}else if(o.controlType===sap.ui.comp.smartfilterbar.ControlConfiguration.CONTROLTYPE.dropDownList){h=(i)?C:M;if(!i){o.filterRestriction=sap.ui.comp.smartfilterbar.ControlConfiguration.FILTERTYPE.multiple;}}else if(o.type==="Edm.Time"){if(i){h=T;}else{h=b;}this._aFilterBarTimeFieldNames.push(o.fieldName);if(j){this._aFilterBarTimeIntervalFieldNames.push(o.fieldName);}else if(o.filterRestriction===sap.ui.comp.smartfilterbar.ControlConfiguration.FILTERTYPE.multiple){this._aFilterBarDateTimeMultiValueFieldNames.push(o.fieldName);}}else if(!i&&!j){h=b;}}return h;};g.prototype._handleMultiInput=function(o,h){o.setEnableMultiLineMode(true);o.attachTokenChange(function(E){if(this._bUpdatingFilterData||this._bCreatingInitialModel||E.getParameter("type")!=="tokensChanged"){return;}var t=E.getSource().getTokens(),i=[],l,j=null,r=null,R=[];if(t){l=t.length;while(l--){j=t[l];r=j.data("range");if(r){r.tokenText=j.getText();R.push(r);}else{i.push({key:j.getKey(),text:j.getText()});}}}if(this.oModel){this.oModel.setProperty("/"+h.fieldName+"/items",i);this.oModel.setProperty("/"+h.fieldName+"/ranges",R);}o.fireChange({filterChangeReason:h.fieldName,value:""});}.bind(this));if(h.hasValueListAnnotation||h.type==="Edm.String"){o.attachEvent("_validateOnPaste",function(E){var t=E.getParameter("texts"),p,l,s,r;l=t?t.length:0;if(l>1){E.preventDefault();p=this.oModel.getProperty("/"+h.fieldName);r=p.ranges||[];o.setValue("");while(l--){s=t[l];if(s){r.push({"exclude":false,"operation":"EQ","keyField":h.fieldName,"value1":s,"value2":null});}}this.oModel.setProperty("/"+h.fieldName+"/ranges",r);this._updateMultiValueControl(o,p.items,r);}}.bind(this));}};g.prototype._associateValueHelpDialog=function(o,h,s,i){this._aValueHelpDialogProvider.push(new V({loadAnnotation:h.hasValueListAnnotation,fullyQualifiedFieldName:h.fullName,metadataAnalyser:this._oMetadataAnalyser,control:o,filterModel:this.oModel,filterProvider:this,model:this._oParentODataModel,preventInitialDataFetchInValueHelpDialog:h.preventInitialDataFetchInValueHelpDialog,dateFormatSettings:this._oDateFormatSettings,supportMultiSelect:i,supportRanges:s,isUnrestrictedFilter:h.filterRestriction!==sap.ui.comp.smartfilterbar.ControlConfiguration.FILTERTYPE.multiple,isSingleIntervalRange:h.filterRestriction===sap.ui.comp.smartfilterbar.ControlConfiguration.FILTERTYPE.interval,fieldName:h.fieldName,type:h.filterType,scale:h.scale,precision:h.precision,maxLength:h.maxLength,displayFormat:h.displayFormat,displayBehaviour:h.displayBehaviour,title:h.label}));};g.prototype._associateValueList=function(o,A,h,H){if(h.hasValueListAnnotation){this._aValueListProvider.push(new e({control:o,fieldName:h.fieldName,typeAheadEnabled:H,aggregation:A,displayFormat:h.displayFormat,displayBehaviour:h.displayBehaviour,dateFormatSettings:this._oDateFormatSettings,loadAnnotation:true,fullyQualifiedFieldName:h.fullName,metadataAnalyser:this._oMetadataAnalyser,filterModel:this.oModel,filterProvider:this,model:this._oParentODataModel}));}};g.prototype._createFieldMetadata=function(o){var h,i;o.fieldName=this._getFieldName(o);o.fieldNameOData=o.fieldName.replace(g.FIELD_NAME_REGEX,"/");i=this._oAdditionalConfiguration.getControlConfigurationByKey(o.fieldName);h=q.extend({},o);h.filterRestriction=this._getFilterRestriction(o,i);this._updateValueListMetadata(h,o);h.hasValueHelpDialog=this._hasValueHelpDialog(h,i);h.preventInitialDataFetchInValueHelpDialog=i?i.preventInitialDataFetchInValueHelpDialog:true;h.controlType=this._getControlType(h,i);if(i&&i.displayBehaviour){h.displayBehaviour=i.displayBehaviour;}h.isCustomFilterField=!!(i&&i.customControl);h.visibleInAdvancedArea=!!(i&&i.visibleInAdvancedArea);h.label=this._getLabel(o,i);h.isMandatory=this._isMandatory(o,i);h.width=this._getWidth(i);h.isVisible=this._isVisible(i);h.groupId=this._getGroupID(o,i);h.index=this._getIndex(o,i);h.fControlConstructor=this._getControlConstructor(h);h.filterType=this._getFilterType(h);h.hasTypeAhead=this._hasTypeAhead(h,o,i);h.customControl=i?i.customControl:undefined;h.control=this._createControl(h);this._applyWidth(h);h.defaultFilterValues=i?i.defaultFilterValues:undefined;if(h.type==="Edm.String"){this._aFilterBarStringFieldNames.push(h.fieldName);}h.conditionType=null;var j=i?i.conditionType:null;if(j){var s="";if(typeof j==="object"){s=j.module;delete j.module;}else{s=j;j=null;}try{q.sap.require(s);var k=q.sap.getObject(s);if(k){h.conditionType=new k(h.fieldName,this,h);this._mConditionTypeFields[h.fieldName]=h;}if(j){h.conditionType.applySettings(j);}}catch(l){q.sap.log.error("Module "+s+" could not be loaded");}}return h;};g.prototype._getFilterType=function(o){if(O.isNumeric(o.type)){return"numeric";}else if(o.type==="Edm.DateTime"&&o.displayFormat==="Date"){return"date";}else if(o.type==="Edm.String"){return"string";}else if(o.type==="Edm.Boolean"){return"boolean";}else if(o.type==="Edm.Time"){return"time";}return undefined;};g.prototype._updateValueListMetadata=function(o,h){o.hasValueListAnnotation=h["sap:value-list"]!==undefined;if(o.hasValueListAnnotation){o.hasFixedValues=h["sap:value-list"]==="fixed-values";}else if(h["com.sap.vocabularies.Common.v1.ValueList"]){o.hasValueListAnnotation=true;o.hasFixedValues=this._oMetadataAnalyser.getValueListSemantics(h["com.sap.vocabularies.Common.v1.ValueList"])==="fixed-values";}};g.prototype._createBasicSearchFieldMetadata=function(){var o;var r=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");o={};o.filterRestriction=sap.ui.comp.smartfilterbar.ControlConfiguration.FILTERTYPE.single;o.name=g.BASIC_SEARCH_FIELD_ID;o.fieldName=g.BASIC_SEARCH_FIELD_ID;o.label=undefined;o.isMandatory=false;o.isVisible=true;o.groupId=g.BASIC_FILTER_AREA_ID;o.index=0;o.control=new S({showSearchButton:false});if(!this._isRunningInValueHelpDialog){o.control.setPlaceholder(r.getText("FILTER_BAR_BSEARCH_PLACE_HOLDER"));}o.control.bindProperty('value',this.sFilterModelName+">/"+o.fieldName);return o;};g.prototype._applyWidth=function(o){if(o&&o.width&&o.control&&o.control.setWidth&&(typeof o.control.setWidth==='function')){o.control.setWidth(o.width);}};g.prototype._createFieldMetadataForCustomFilterFields=function(o){var h;if(!o||!o.customControl){return undefined;}h={};h.name=o.key;h.fieldName=o.key;h.label=o.label;h.visibleInAdvancedArea=!!(o&&o.visibleInAdvancedArea);h.isVisible=this._isVisible(o);h.groupId=o.groupId;h.isMandatory=this._isMandatory(undefined,o);h.index=o.index;h.width=this._getWidth(o);h.control=o.customControl;h.isCustomFilterField=true;this._applyWidth(h);return h;};g.prototype._getFieldName=function(o){if(!o.parentPropertyName){return o.name;}else{return o.parentPropertyName+"."+o.name;}};g.prototype._hasValueHelpDialog=function(o,h){var v=true;if(h){if(h.controlType===sap.ui.comp.smartfilterbar.ControlConfiguration.CONTROLTYPE.dropDownList){v=false;}else if(h.hasValueHelpDialog!==true){v=false;}}if(o&&!o.hasValueListAnnotation){if(o.filterRestriction===sap.ui.comp.smartfilterbar.ControlConfiguration.FILTERTYPE.single||o.filterRestriction===sap.ui.comp.smartfilterbar.ControlConfiguration.FILTERTYPE.multiple){v=false;}}return v;};g.prototype._isVisible=function(o){if(o&&o.isVisible===false){return false;}return true;};g.prototype._getWidth=function(o){if(o&&o.width){return o.width;}return undefined;};g.prototype._isMandatory=function(o,h){if(h&&h.mandatory!==sap.ui.comp.smartfilterbar.ControlConfiguration.MANDATORY.auto){return h.mandatory===sap.ui.comp.smartfilterbar.ControlConfiguration.MANDATORY.mandatory;}if(o){return o.requiredField;}return false;};g.prototype._getFilterRestriction=function(o,h){var s;if(h&&h.filterType&&h.filterType!==sap.ui.comp.smartfilterbar.ControlConfiguration.FILTERTYPE.auto){s=h.filterType;}else if(o.filterRestriction==="single-value"){s=sap.ui.comp.smartfilterbar.ControlConfiguration.FILTERTYPE.single;}else if(o.filterRestriction==="multi-value"){s=sap.ui.comp.smartfilterbar.ControlConfiguration.FILTERTYPE.multiple;}else if(o.filterRestriction==="interval"){s=sap.ui.comp.smartfilterbar.ControlConfiguration.FILTERTYPE.interval;}else{s=sap.ui.comp.smartfilterbar.ControlConfiguration.FILTERTYPE.auto;}return s;};g.prototype._getControlType=function(o,h){var s;if(h&&h.controlType&&h.controlType!==sap.ui.comp.smartfilterbar.ControlConfiguration.CONTROLTYPE.auto){s=h.controlType;}else if(o.type==="Edm.DateTime"&&o.displayFormat==="Date"){s=sap.ui.comp.smartfilterbar.ControlConfiguration.CONTROLTYPE.date;}else if(o.hasValueListAnnotation&&o.hasFixedValues){s=sap.ui.comp.smartfilterbar.ControlConfiguration.CONTROLTYPE.dropDownList;}else{s=sap.ui.comp.smartfilterbar.ControlConfiguration.CONTROLTYPE.input;}return s;};g.prototype._getGroupID=function(o,h){if(h&&h.groupId){return h.groupId;}else if(o&&o.requiredField){return this._sBasicFilterAreaID;}return this._getGroupIDFromFieldGroup(o);};g.prototype._getGroupIDFromFieldGroup=function(o){var l=0,h=null,G;if(o&&this._aFieldGroupAnnotation&&this._aFieldGroupAnnotation.length){l=this._aFieldGroupAnnotation.length;while(l--){h=this._aFieldGroupAnnotation[l];if(h&&h.fields&&h.fields.indexOf(o.fieldNameOData)>-1){G=h.groupName;break;}}}return G;};g.prototype._getLabel=function(o,h){if(h&&h.label){return h.label;}return this._getLabelFromFieldGroup(o)||o.fieldLabel||o.fieldName;};g.prototype._getLabelFromFieldGroup=function(o){var l=0,h=null,L;if(o&&this._aFieldGroupAnnotation&&this._aFieldGroupAnnotation.length){l=this._aFieldGroupAnnotation.length;while(l--){h=this._aFieldGroupAnnotation[l];if(h&&h.fields&&h.fields.indexOf(o.fieldNameOData)>-1){L=h.labels[o.fieldNameOData];break;}}}return L;};g.prototype._getIndex=function(o,h){if(h&&(h.index||h.index===0)){return h.index;}return this._getIndexFromFieldGroup(o);};g.prototype._getIndexFromFieldGroup=function(o){var l=0,h=null,i;if(o&&this._aFieldGroupAnnotation&&this._aFieldGroupAnnotation.length){l=this._aFieldGroupAnnotation.length;while(l--){h=this._aFieldGroupAnnotation[l];if(h&&h.fields){i=h.fields.indexOf(o.fieldNameOData);if(i>-1){break;}i=undefined;}}}return i;};g.prototype._getGroupIndex=function(G){if(G&&(G.index||G.index===0)){return G.index;}};g.prototype._getGroupLabel=function(o,G){if(G&&G.label){return G.label;}return o.groupLabel||o.groupName||o.groupEntityName;};g.prototype._hasTypeAhead=function(o,h,i){var H;H=true;if(i){H=i.hasTypeAhead;}else if(h.type!=="Edm.String"){return false;}if(!(o.fControlConstructor===I||o.fControlConstructor===b)){return false;}return H;};g.prototype.getModel=function(){return this.oModel;};g.prototype.getFilterBarViewMetadata=function(){return this._aFilterBarViewMetadata;};g.prototype.getParameters=function(){var p,B=null;if(this.oModel){B=this.oModel.getProperty("/"+g.BASIC_SEARCH_FIELD_ID);}if(this._sBasicSearchFieldName||B){p={custom:{}};if(this._sBasicSearchFieldName){p.custom["search-focus"]=this._sBasicSearchFieldName;}p.custom["search"]=B||"";}return p;};g.prototype.getFilters=function(h){var o=null;if(this.oModel){o=this.oModel.getData();}return g.generateFilters(h,o,{dateSettings:this._oDateFormatSettings,useContainsAsDefault:this._bUseContainsAsDefault,stringFields:this._aFilterBarStringFieldNames,timeFields:this._aFilterBarTimeFieldNames});};g.prototype.getFilterData=function(){return this.oModel?this.oModel.getData():null;};g.prototype.getFilterDataAsString=function(){return this.oModel?this.oModel.getJSON():null;};g.prototype.getFilledFilterData=function(h){var o,i={},j,s,v;o=this.oModel?this.oModel.getData():null;if(o&&h){j=h.length;while(j--){s=h[j];if(s&&s!==g.BASIC_SEARCH_FIELD_ID){v=o[s];if(v&&v.hasOwnProperty("low")){if(v.low){i[s]=v;}}else if(v&&v.hasOwnProperty("items")){if(v.value&&typeof v.value==="string"){v.value=v.value.trim();}if(v.items.length||(v.ranges&&v.ranges.length)||v.value){i[s]=v;}}else if(v){if(typeof v==="string"){v=v.trim();}if(v){i[s]=v;}}}if(j===0){s=g.CUSTOM_FIELDS_MODEL_PROPERTY;v=o[s];if(v){i[s]=v;}}}}return q.extend(true,{},i);};g.prototype.getFilledFilterDataAsString=function(h){return JSON.stringify(this.getFilledFilterData(h));};g.prototype.setFilterData=function(j,r){var o=null,h=null,k=null;if(this.oModel&&j){this._bUpdatingFilterData=true;if(r){this._createInitialModel(false);}o=this._parseFilterData(j,r);if(o){this.oModel.setData(o,true);h=[];var s=arguments[2];if(s){h.push(s);}for(k in o){h.push(k);}this._handleFilterDataUpdate(h);}this._bUpdatingFilterData=false;}};g.prototype.setFilterDataAsString=function(j,r){if(j){this.setFilterData(JSON.parse(j),r);}};g.prototype._parseFilterData=function(j,r){return g.parseFilterData(this.oModel.getData(),j,{dateFields:this._aFilterBarDateFieldNames,timeFields:this._aFilterBarTimeFieldNames,timeIntervalFields:this._aFilterBarTimeIntervalFieldNames,dateTimeMultiValueFields:this._aFilterBarDateTimeMultiValueFieldNames,conditionTypeFields:this._mConditionTypeFields},r);};g.prototype._handleFilterDataUpdate=function(h){var i=0,o,j,k;if(this._aFilterBarMultiValueFieldMetadata){i=this._aFilterBarMultiValueFieldMetadata.length;while(i--){if(!j){j=this.oModel.getData();}if(j){o=this._aFilterBarMultiValueFieldMetadata[i];if(h.indexOf(o.fieldName)>-1){k=j[o.fieldName];if(k){this._updateMultiValueControl(o.control,k.items,k.ranges);}}}}this._updateConditionTypeFields(h);}};g.prototype.clear=function(){this._createInitialModel(false);};g.prototype.reset=function(){this._createInitialModel(true);};g.prototype._initializeConditionTypeFields=function(){function h(E){t.setPending(t.isPending());}for(var n in this._mConditionTypeFields){this._mConditionTypeFields[n].conditionType.initialize(this.oModel.getData()[n]);var t=this;if(this._mConditionTypeFields[n].conditionType.getAsync()){this._mConditionTypeFields[n].conditionType.attachPendingChange(h);}}};g.prototype._updateConditionTypeFields=function(u){if(typeof u==="string"){u=[u];}var U=u||[];if(U.length===0){for(var n in this.oModel.getData()){U.push(n);}}for(var n in this._mConditionTypeFields){this._mConditionTypeFields[n].conditionType.providerDataUpdated(U,this.oModel.getData());}};g.prototype._validateConditionTypeFields=function(){var i=false;for(var n in this._mConditionTypeFields){var v=this._mConditionTypeFields[n].conditionType.validate();if(!v&&!i){i=true;}}return i;};g.generateFilters=function(h,o,s){var i=[],A=null,E=null,j=null,k=null,m=g.FIELD_NAME_REGEX,v=null,l,n,p=null,L=0,r=0;var t,u,w,x,U,y;if(s){t=s.dateSettings;u=s.useContainsAsDefault;w=s.stringFields;x=s.timeFields;}if(h&&o){r=h.length;while(r--){y=false;k=h[r];if(k&&k!==g.BASIC_SEARCH_FIELD_ID){U=false;if(u&&w){if(w.indexOf(k)>-1){U=true;}}else if(x&&x.indexOf(k)>-1){y=true;}v=o[k];k=k.replace(m,"/");if(v&&v.hasOwnProperty("low")){if(v.low&&v.high){l=v.low;n=v.high;if(t&&t.UTC&&l instanceof Date&&n instanceof Date){l=g.getDateInUTCOffset(l);n=g.getDateInUTCOffset(n);}i.push(new F(k,sap.ui.model.FilterOperator.BT,l,n));}else if(v.low){if(v.low instanceof Date){l=v.low;if(t&&t.UTC){l=g.getDateInUTCOffset(l);}i.push(new F(k,sap.ui.model.FilterOperator.EQ,l));}else if(typeof v.low==="string"){p=v.low.split("-");if(p&&p.length===2){i.push(new F(k,sap.ui.model.FilterOperator.BT,p[0],p[1]));}else{i.push(new F(k,U?sap.ui.model.FilterOperator.Contains:sap.ui.model.FilterOperator.EQ,v.low));}}}}else if(v&&v.hasOwnProperty("items")){A=[];j=[];E=null;if(v&&v.hasOwnProperty("ranges")){p=v.ranges;L=p.length;while(L--){l=p[L].value1;n=p[L].value2;if(y){if(l instanceof Date){l=f.getEdmTimeFromDate(l);}if(n instanceof Date){n=f.getEdmTimeFromDate(n);}}else if(t&&t.UTC){if(l instanceof Date){l=g.getDateInUTCOffset(l);}if(n instanceof Date){n=g.getDateInUTCOffset(n);}}if(p[L].exclude){if(p[L].operation===sap.ui.model.FilterOperator.EQ){j.push(new F(k,sap.ui.model.FilterOperator.NE,l));}}else{A.push(new F(k,p[L].operation,l,n));}}if(j.length){E=new F(j,true);}}p=v.items;L=p.length;while(L--){A.push(new F(k,sap.ui.model.FilterOperator.EQ,p[L].key));}if(v.value||v.value===0||v.value===false){if(typeof v.value==="string"){v.value=v.value.trim();}if(v.value||v.value===0||v.value===false){A.push(new F(k,U?sap.ui.model.FilterOperator.Contains:sap.ui.model.FilterOperator.EQ,v.value));}}if(A.length){if(E){i.push(new F([new F(A,false),E],true));}else{i.push(new F(A,false));}}else if(E){i.push(E);}}else if(v||v===0||v===false){if(typeof v==="string"){v=v.trim();}if(v&&v instanceof Date){if(y){v=f.getEdmTimeFromDate(v);}else if(t&&t.UTC){v=g.getDateInUTCOffset(v);}}if(v||v===0||v===false){i.push(new F(k,U?sap.ui.model.FilterOperator.Contains:sap.ui.model.FilterOperator.EQ,v));}}}}}return(i.length>1)?[new F(i,true)]:i;};g.parseFilterData=function(o,h,s,r){var R={},m=null,j=null,v=null,n,k,i,l,p,t,u,w,x,E;if(s){t=s.dateFields;u=s.timeFields;w=s.timeIntervalFields;x=s.dateTimeMultiValueFields;m=s.conditionTypeFields||{};}if(!t){t=[];}if(!u){u=[];}if(!w){w=[];}if(!x){x=[];}if(o&&h){k=q.extend({},h,true);for(j in k){if(o.hasOwnProperty(j)&&j!==g.CUSTOM_FIELDS_MODEL_PROPERTY){v=o[j];n=k[j];if(j in m){if("conditionTypeInfo"in n||(!("conditionTypeInfo"in n)&&n.ranges)){m[j].conditionType.initialize(n);}}else if(v&&v.hasOwnProperty("low")){R[j]=n;if(n){if(n.low&&n.high){if(!(n.low instanceof Date)){R[j].low=new Date(n.low);}if(!(n.high instanceof Date)){R[j].high=new Date(n.high);}}else if((n.low||n.value)&&!n.high){if(!n.low&&n.value){n.low=n.value;}if((t.indexOf(j)>-1||u.indexOf(j)>-1)&&!(n.low instanceof Date)){R[j].low=new Date(n.low);}else{R[j].low=n.low;}R[j].high=null;}}}else if(v&&v.hasOwnProperty("items")){if(n&&(n.items||n.ranges)){if(n.ranges&&n.ranges.length){if(w.indexOf(j)>-1){l=n.ranges.length;for(i=0;i<l;i++){p=n.ranges[i];if(!p.exclude&&(p.operation==="EQ"||p.operation==="BT")){break;}p=null;}if(p){if(p.value1&&typeof p.value1==="string"){p.value1=new Date(p.value1);}if(p.value2&&typeof p.value2==="string"){p.value2=new Date(p.value2);}R[j]={ranges:[p],items:[],value:""};}continue;}else if(x.indexOf(j)>-1){l=n.ranges.length;E=[];for(i=0;i<l;i++){p=n.ranges[i];if(!p.exclude&&p.operation==="EQ"){if(p.value1&&typeof p.value1==="string"){p.value1=new Date(p.value1);}E.push(p);}}R[j]={ranges:E,items:[],value:""};continue;}else if(t.indexOf(j)>-1||u.indexOf(j)>-1){l=n.ranges.length;for(i=0;i<l;i++){p=n.ranges[i];if(p.value1&&typeof p.value1==="string"){p.value1=new Date(p.value1);}if(p.value2&&typeof p.value2==="string"){p.value2=new Date(p.value2);}}}}R[j]=n;}else if(typeof n==="string"||typeof n==="number"||n instanceof Date){if(n&&(t.indexOf(j)>-1||u.indexOf(j)>-1)){if(typeof n==="string"){n=new Date(n);}R[j]={ranges:[{"exclude":false,"operation":"EQ","keyField":j,"value1":n,"value2":null}],items:[],value:""};}else{R[j]={value:n,items:[]};}}}else{R[j]=null;if(typeof n==="string"||typeof n==="boolean"||typeof n==="number"||n instanceof Date){if(typeof n==="string"&&(t.indexOf(j)>-1||u.indexOf(j)>-1)){R[j]=new Date(n);}else{R[j]=n;}}else if(n&&(n.value||n.value===0||n.value===false)){R[j]=n.value;}else if(n&&n.items&&n.items.length){R[j]=n.items[0].key;}else if(n&&n.ranges&&n.ranges.length){l=n.ranges.length;for(i=0;i<l;i++){p=n.ranges[i];if(!p.exclude&&p.operation==="EQ"){break;}p=null;}if(p&&p.value1){if(typeof p.value1==="string"&&(t.indexOf(j)>-1||u.indexOf(j)>-1)){R[j]=new Date(p.value1);}else{R[j]=p.value1;}}}}}else if(r||j===g.CUSTOM_FIELDS_MODEL_PROPERTY){R[j]=k[j];}}}return R;};g.getDateInUTCOffset=function(o){return new Date(o.valueOf()-o.getTimezoneOffset()*60*1000);};g.prototype.destroy=function(){var i=0;this._aFilterBarViewMetadata=null;this._aFilterBarDateFieldNames=null;this._aFilterBarTimeFieldNames=null;this._aFilterBarTimeIntervalFieldNames=null;this._aFilterBarDateTimeMultiValueFieldNames=null;this._aFilterBarStringFieldNames=null;this._aFilterBarMultiValueFieldMetadata=null;this._aFieldGroupAnnotation=null;if(this._oMetadataAnalyser&&this._oMetadataAnalyser.destroy){this._oMetadataAnalyser.destroy();}this._oMetadataAnalyser=null;if(this._aValueHelpDialogProvider){i=this._aValueHelpDialogProvider.length;while(i--){this._aValueHelpDialogProvider[i].destroy();}}this._aValueHelpDialogProvider=null;if(this._aValueListProvider){i=this._aValueListProvider.length;while(i--){this._aValueListProvider[i].destroy();}}this._aValueListProvider=null;this.oResourceBundle=null;this.sIntervalPlaceholder=null;this.sDefaultDropDownDisplayBehaviour=null;this.sDefaultTokenDisplayBehaviour=null;this._oSmartFilter=null;this.bIsDestroyed=true;};return g;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.smartform.GroupElement')){jQuery.sap.declare('sap.ui.comp.smartform.GroupElement');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.m.Label');jQuery.sap.require('sap.m.VBox');jQuery.sap.require('sap.m.HBox');jQuery.sap.require('sap.ui.core.Element');jQuery.sap.require('sap.ui.layout.form.FormElement');jQuery.sap.require('sap.ui.layout.ResponsiveFlowLayoutData');jQuery.sap.require('sap.ui.core.TooltipBase');sap.ui.define("sap/ui/comp/smartform/GroupElement",['jquery.sap.global','sap/m/Label',"sap/m/VBox","sap/m/HBox",'sap/ui/comp/library','sap/ui/core/Element','sap/ui/layout/form/FormElement','sap/ui/layout/ResponsiveFlowLayoutData','sap/ui/comp/smartfield/SmartLabel','sap/ui/comp/smartfield/SmartField','sap/ui/comp/smartfield/BindingUtil','sap/ui/comp/smartfield/Configuration','sap/ui/core/TooltipBase'],function(q,L,V,H,l,E,F,R,S,a,B,C,T){"use strict";var G=F.extend("sap.ui.comp.smartform.GroupElement",{metadata:{library:"sap.ui.comp",properties:{useHorizontalLayout:{type:"boolean",group:"Misc",defaultValue:null},horizontalLayoutGroupElementMinWidth:{type:"int",group:"Misc",defaultValue:null},elementForLabel:{type:"int",group:"Misc",defaultValue:0}},defaultAggregation:"elements",aggregations:{elements:{type:"sap.ui.core.Control",multiple:true,singularName:"element"}},events:{visibleChanged:{}}},_visibilityDerived:false});G.prototype.init=function(){F.prototype.init.apply(this,arguments);};G.prototype._getFieldRelevantForLabel=function(){var f=this.getFields();var e=[];var t=this;f.forEach(function(o){if(o instanceof V&&t.getUseHorizontalLayout()){e=e.concat(t._extractFields([o]));}else{e.push(o);}});e=e.filter(function(o){return!(o instanceof sap.m.Label);});var i=this.getElementForLabel();if(e.length>i&&(e[i]instanceof a)){return e[i];}return null;};G.prototype._extractFields=function(e,b){var f=[];if(b===undefined){b=false;}e.forEach(function(o){if(o.getItems){f=f.concat(o.getItems());}else{f.push(o);}});if(f.some(function(o){return o.getItems;})){f=this._extractFields(f);}if(b){f=f.filter(function(o){return!(o instanceof sap.m.Label);});}return f;};G.prototype._createLabel=function(s){var o=null;var i=null;var b=new B();var f=this._getFieldRelevantForLabel();if(f){if(f.getShowLabel()){if(s){f.setTextLabel(s);}o=new S();if(s){o.setText(s);}o.setLabelFor(f);}}else{i=this.getBindingInfo("label");if(s){o=new L();o.setText(s);}else if(i){o=new L();o.bindProperty("text",b.toBinding(i));}}return o;};G.prototype.updateLabelOfFormElement=function(i,s){var t=null,c=false;var r=this._getFieldRelevantForLabel();var o=this._getLabel();if(o){if(r&&(!(o instanceof S))){o=this._createLabel(o.getText());c=true;}}else{o=this._createLabel();c=true;}if(o){if(s&&i&&(o instanceof S)){if(s===r){o.updateLabelFor(i);}else{}}var b=this._getFieldRelevantForLabel();if(o instanceof S){if(b&&b.setTextLabel){if(b.getTextLabel()){o.setText(b.getTextLabel());}}}t=this.getTooltip();if(t){if(o instanceof S){if(b&&b.setTooltipLabel){b.setTooltipLabel(t.getText());}}}else{o.setTooltip(t);}}if(c){this.setLabel(o);}};G.prototype.setLabel=function(o){var O,b=o;var i;if(typeof o==="string"){O=this._getLabel();if(O&&O instanceof S){O.setText(o);b=O;var s=this._getFieldRelevantForLabel();if(s&&s.getTextLabel&&o!=null){s.setTextLabel(o);}}else{b=new L({text:o});}}if(this.getUseHorizontalLayout()){if(this.getFields()[0]instanceof V){i=this.getFields()[0].getItems();i.some(function(I){if(I instanceof L){O=I;return true;}});if(O){O=b;}else{this.getFields()[0].insertItem(b,0);}return this;}}F.prototype.setLabel.apply(this,[b]);};G.prototype.setTooltip=function(t){var o=t;if(typeof t==="string"){o=new T({text:t});}F.prototype.setTooltip.apply(this,[o]);};G.prototype._getLabel=function(){var e=null,i=null,r=false;var o=F.prototype.getLabel.apply(this);if(!o){e=this.getElements();if(e&&e.length>0&&e[0]instanceof V){i=e[0].getItems();i.some(function(I){r=false;if(I instanceof L){o=I;r=true;}return r;});}}return o;};G.prototype.getLabelText=function(){var s="";var o=this._getLabel();if(o){s=o.getText();}return s;};G.prototype.setEditMode=function(e){var b=this.getElements();var i=[];var t=this;b.forEach(function(o){if(o instanceof V){i=t._extractFields([o]);i.forEach(function(I){if(I instanceof a){if(!(I.data("editable")===false)){I.setContextEditable(e);}}});}else if(o instanceof a){if(!(o.data("editable")===false)){o.setContextEditable(e);}}});return this;};G.prototype._getVisibilityOfFields=function(f,I){var r=false;var i=0,b=0,o=null;if(f&&f.length){b=f.length;for(i=0;i<b;i++){o=f[i];if(o){if(I&&o instanceof S){continue;}if(o instanceof V){r=this._getVisibilityOfFields(this._extractFields([o]),true);}else{r=o.getVisible();}}if(r){break;}}}return r;};G.prototype._updateFormElementVisibility=function(){var A=this.getVisible();var v=false,f=null;if(A===false&&this._visibilityDerived===false){return;}f=this.getFields();if(f&&f.length){v=this._getVisibilityOfFields(f);}if(A!==v){this._visibilityDerived=true;F.prototype.setProperty.apply(this,['visible',v]);this.fireVisibleChanged({visible:v});if(this.getParent()){this.getParent()._updateLineBreaks();}}};G.prototype._updateFormElementEditable=function(e){var o=this._getLabel();if(o&&o instanceof S){o.bindRequiredPropertyToSmartField();}};G.prototype._updateLayout=function(){var t=this;var v=null;var h=null;var f=[];var e=[];var o=null;if(this.getUseHorizontalLayout()){e=this.getFields();f=this._extractFields(e,true);}else{f=this.getFields();}var b=this._getLabel();if(this.getUseHorizontalLayout()){if(this.getFields().length>0&&this.getFields()[0].getLayoutData()){o=this.getFields()[0].getLayoutData().clone();}this.removeAllFields();if(f.length>0){if(f.length>1){h=new H({"items":[].concat(f)});}if(h){v=new V({"items":[].concat(h)});}else{v=new V({"items":[].concat(f)});}v.addStyleClass("sapUiCompGroupElementVBox");if(o){v.setLayoutData(o);}this.addField(v);}if(b){F.prototype.setLabel.apply(this,[new sap.m.Label()]);F.prototype.destroyLabel.apply(this);if(v){v.insertItem(b,0);}}}else{this.removeAllFields();f.forEach(function(c){t.addField(c);});}};G.prototype.setProperty=function(p,v){F.prototype.setProperty.apply(this,[p,v]);if(p==='visible'){this._visibilityDerived=false;this._updateFormElementVisibility();}};G.prototype.setVisible=function(v){this._visibilityDerived=false;F.prototype.setProperty.apply(this,['visible',v]);this._updateFormElementVisibility();};G.prototype.setUseHorizontalLayout=function(v){this.setProperty("useHorizontalLayout",v);this._updateLayout();};G.prototype.setHorizontalLayoutGroupElementMinWidth=function(n){this.setProperty("horizontalLayoutGroupElementMinWidth",n);this._updateLayout();};G.prototype.getFormElement=function(){return this;};G.prototype.addElement=function(e){var t=this;if(e.getEditable){if(!e.getEditable()){e.data("editable",false);}}if(e.attachVisibleChanged){e.attachVisibleChanged(function(o){t._updateFormElementVisibility();});}if(e.attachContextEditableChanged){e.attachContextEditableChanged(function(o){t._updateFormElementEditable(o);});}if(e.attachEditableChanged){e.attachEditableChanged(function(o){t._updateFormElementEditable(o);});}if(e.attachInnerControlsCreated){e.attachInnerControlsCreated(function(o){t._updateFormElementLabel(o);});}if(e.setControlContext){e.setControlContext(sap.ui.comp.smartfield.ControlContextType.Form);}this.addField(e);this.updateLabelOfFormElement();this._updateLayout();};G.prototype._updateFormElementLabel=function(e){var f=this.getFields();if(f[0]instanceof V){f=f[0].getItems();if(f[0]instanceof L){f.splice(0,1);}}this.updateLabelOfFormElement(e.getParameters(),e.oSource);};G.prototype.addCustomData=function(c){F.prototype.addCustomData.apply(this,arguments);var e=this.getFields();e.forEach(function(o){if(o instanceof a){o.addCustomData(c.clone());}});return this;};G.prototype.insertElement=function(e,i){this.insertField(e,i);return this;};G.prototype.getElements=function(){return this.getFields();};G.prototype.removeElement=function(e){return this.removeField(e);};G.prototype.removeAllElements=function(){return this.removeAllFields();};G.prototype.removeAggregation=function(A,o){if(A==="elements"){return this.removeField(o);}else{return E.prototype.removeAggregation.apply(this,arguments);}};G.prototype.removeAllAggregation=function(A){if(A==="elements"){return this.removeAllElements();}else{return E.prototype.removeAllAggregation.apply(this,arguments);}};G.prototype.getVisibleBasedOnElements=function(){var i=true;var e=this.getElements();if(e&&e.length>0){i=e.some(function(o){return o.getVisible();});}return i;};return G;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.smartform.flexibility.DialogContent')){
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.ui.comp.smartform.flexibility.DialogContent');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.m.Button');jQuery.sap.require('sap.m.FlexAlignItems');jQuery.sap.require('sap.m.FlexAlignSelf');jQuery.sap.require('sap.m.FlexDirection');jQuery.sap.require('sap.m.FlexItemData');jQuery.sap.require('sap.m.FlexJustifyContent');jQuery.sap.require('sap.m.HBox');jQuery.sap.require('sap.m.VBox');jQuery.sap.require('sap.ui.core.Control');jQuery.sap.require('sap.ui.core.ResizeHandler');jQuery.sap.require('sap.ui.fl.registry.Settings');jQuery.sap.require('sap.ui.layout.Grid');sap.ui.define("sap/ui/comp/smartform/flexibility/DialogContent",['jquery.sap.global','sap/m/Button','sap/m/FlexAlignItems','sap/m/FlexAlignSelf','sap/m/FlexDirection','sap/m/FlexItemData','sap/m/FlexJustifyContent','sap/m/HBox','sap/m/VBox','sap/ui/comp/library','sap/ui/comp/odata/FieldSelector','./FieldList','sap/ui/core/Control','sap/ui/core/ResizeHandler','sap/ui/fl/registry/Settings','sap/ui/layout/Grid'],function(q,B,F,a,b,c,d,H,V,l,e,f,C,R,S,G){"use strict";var D=C.extend("sap.ui.comp.smartform.flexibility.DialogContent",{metadata:{library:"sap.ui.comp",aggregations:{content:{type:"sap.ui.core.Control",multiple:false}}}});D.prototype.init=function(){this._oScrollView=new sap.m.ScrollContainer();var s=sap.ui.getCore().byId("smartFormPersDialog");if(s){this._oResizeDialogHandlerId=R.register(s,q.proxy(this._handleResizeDialog,this));}this._textResources=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");this._constructLayout();this._createButtons();this._createFieldList();this._createFieldSelector();this._createModels();this._initiateBinding();this.addStyleClass("sapUiSizeCompact");this._sFirstIdPart=undefined;};D.prototype._handleResizeDialog=function(){if(this._oScrollView){var h=q("#smartFormPersDialog-cont").height();var g=q("#smartFormPersDialogFieldListHeader").height();this._oScrollView.setHeight(h-g+"px");}};D.prototype._initiateBinding=function(){this._oFieldList.bindAggregation("nodes",{path:"/children",factory:this._createNodeFactoryFunction.bind(this)});this._oFieldList.attachSelectionChanged(this._onSelectionChanged.bind(this));this._oFieldList.attachLabelChanged(this._onLabelChanged.bind(this));this._oFieldList.attachNodeHidden(this._onNodeAddedOrHidden.bind(this));this._oBtnMoveDown.bindProperty("enabled",{path:"/isMoveDownButtonEnabled"});this._oBtnMoveUp.bindProperty("enabled",{path:"/isMoveUpButtonEnabled"});this._oBtnMoveBottom.bindProperty("enabled",{path:"/isMoveBottomButtonEnabled"});this._oBtnMoveTop.bindProperty("enabled",{path:"/isMoveTopButtonEnabled"});this._oBtnAddField.bindProperty("enabled",{parts:[{path:"addFieldButtonDependencies>/selectedField"},{path:"addFieldButtonDependencies>/groups"}],formatter:this._isAddFieldEnabled.bind(this)});};D.prototype._createModels=function(){this._oAddFieldButtonDependenciesModel=new sap.ui.model.json.JSONModel({"selectedField":undefined,"groups":undefined});this.setModel(this._oAddFieldButtonDependenciesModel,'addFieldButtonDependencies');this._emptyModel=new sap.ui.model.json.JSONModel();};D.prototype.setViewId=function(i){this._sViewId=i;};D.prototype.initialiseODataFieldSelector=function(o,E,s,i,m,I,p){var O;var g=false;O=this._oFieldSelector;if(O){S.getInstance(s,p).then(function(h){if(h.isModelS){g=h.isModelS();}O.setModel(o,E,g,i,m,I);});}};D.prototype._createNodeFactoryFunction=function(i,o){var n,N;n={label:{path:"label"},nodes:{path:o.getPath()+"/children",factory:this._createNodeFactoryFunction.bind(this)},isSelected:{path:"isSelected"},isVisible:{path:"isVisible"}};N=new sap.ui.comp.smartform.flexibility.FieldListNode(i,n);return N;};D.prototype._onSelectionChanged=function(E){var s,n;s=E.getParameter('node');n=s.getBindingContext().getObject();this._changeSelection(n);this.getModel().updateBindings();};D.prototype._onLabelChanged=function(E){var o,g;o=E.getParameter('node');g=o.getBindingContext().getObject();this._oFieldSelector.updateFieldLabel(g);};D.prototype._onNodeAddedOrHidden=function(E){this._oAddFieldButtonDependenciesModel.setProperty("/groups",this.getModel().getData().children);this._triggerAddFieldButtonDependenciesBindings();};D.prototype._changeSelection=function(n){if(this._oSelectedFieldListNodeData){this._oSelectedFieldListNodeData.isSelected=false;}this._oSelectedFieldListNodeData=n;this._oSelectedFieldListNodeData.isSelected=true;this._readDataFromModelAndUpdateMoveButtonEnabledState();this.getModel().updateBindings();};D.prototype._readDataFromModelAndUpdateMoveButtonEnabledState=function(){var o;o=this._getDataFromModel();this._updateMoveButtonEnabledState(o);};D.prototype._checkMoveDown=function(n,g,A){var i,m={};m.enabled=false;m.moveStep=0;m.newParent=undefined;m.enabled=n.parent.children.length-1>n.index;if(m.enabled){for(i=n.index+1;i<n.parent.children.length;i++){m.moveStep+=1;if(!n.parent.children[i].hasOwnProperty('isVisible')||n.parent.children[i].isVisible){return m;}if(i===(n.parent.children.length-1)){m.enabled=false;}}}if(!m.enabled){var h=A[g-1].indexOf(n.parent);m.enabled=A[g-1].length-1>h;if(m.enabled){for(i=h+1;i<A[g-1].length;i++){if(!A[g-1][i].hasOwnProperty('isVisible')||A[g-1][i].isVisible){m.newParent=A[g-1][i];return m;}if(i===(A[g-1].length-1)){m.enabled=false;}}}}return m;};D.prototype._checkMoveUp=function(n,g,A){var i,m={};m.enabled=false;m.moveStep=0;m.newParent=undefined;m.enabled=n.index>0;if(m.enabled){for(i=n.index-1;i>=0;i--){m.moveStep+=1;if(!n.parent.children[i].hasOwnProperty('isVisible')||n.parent.children[i].isVisible){return m;}if(i===0){m.enabled=false;}}}if(!m.enabled){var h=A[g-1].indexOf(n.parent);m.enabled=h>0;if(m.enabled){for(i=h-1;i>=0;i--){if(!A[g-1][i].hasOwnProperty('isVisible')||A[g-1][i].isVisible){m.newParent=A[g-1][i];return m;}if(i===0){m.enabled=false;}}}}return m;};D.prototype._updateMoveButtonEnabledState=function(o){var g,i,I,h,j;var t=this;g=function(n,k,A){var m=t._checkMoveDown(n,k,A);var M=t._checkMoveUp(n,k,A);i=m.enabled;I=M.enabled;h=i;j=I;};if(this._oSelectedFieldListNodeData){this._findNodeInDataModel(o,this._oSelectedFieldListNodeData.id,g);}else{i=false;I=false;h=false;j=false;}o.isMoveDownButtonEnabled=i;o.isMoveUpButtonEnabled=I;o.isMoveBottomButtonEnabled=h;o.isMoveTopButtonEnabled=j;};D.prototype._constructLayout=function(){this.oLayout=new H({direction:b.Row});this.oLayoutLeft=new V({direction:b.Column,layoutData:new c({order:1,growFactor:2})});this.oLayoutLeft.addStyleClass("sapUiCompDialogContentFieldListContainer");this.oLayoutMiddle=new V({direction:b.Column,layoutData:new c({order:2,growFactor:1})});this.oLayoutMiddle.addStyleClass("sapUiCompDialogContentMiddle");this.oLayoutTopLeft=new G("smartFormPersDialogFieldListHeader");this.oLayoutTopLeft.addStyleClass("sapUiCompDialogContentFieldListContainerTop");this.oLayoutLeft.addItem(this.oLayoutTopLeft);this.oLayoutRight=new V({direction:b.Column,layoutData:new c({order:3,growFactor:9})});this.oLayout.addItem(this.oLayoutLeft);this.oLayout.addItem(this.oLayoutMiddle);this.oLayout.addItem(this.oLayoutRight);this.setContent(this.oLayout);};D.prototype._createFieldList=function(){this._oScrollView.setWidth("100%");this._oScrollView.setVertical(true);this._oFieldList=new f(this.getId()+'-FieldList');this._oScrollView.addContent(this._oFieldList);this._handleResizeDialog();this.oLayoutLeft.addItem(this._oScrollView);};D.prototype._createFieldSelector=function(){this._oFieldSelector=new e({layoutData:new c({order:3,growFactor:9})});this._oFieldSelector.attachFieldSelectionChanged(this._writeSelectedFieldToModel.bind(this));this.oLayoutRight.addItem(this._oFieldSelector);};D.prototype._writeSelectedFieldToModel=function(s){this._oAddFieldButtonDependenciesModel.setProperty("/selectedField",s.mParameters);this._triggerAddFieldButtonDependenciesBindings();};D.prototype._triggerAddFieldButtonDependenciesBindings=function(){this.setModel(this._emptyModel,'addFieldButtonDependencies');if(!this._oAddFieldButtonDependenciesModel.getData().groups){this._oAddFieldButtonDependenciesModel.setProperty("groups",this.getModel().getData().children);}this.setModel(this._oAddFieldButtonDependenciesModel,'addFieldButtonDependencies');};D.prototype._isAddFieldEnabled=function(s,g){var v=!!s&&!!s.name;return v&&g&&this._containsVisibleGroups(g);};D.prototype._containsVisibleGroups=function(g){var v=this._getVisibleGroups(g);return v.length>0;};D.prototype._getVisibleGroups=function(g){var v=[];g.forEach(function(n){if(n.isVisible){v.push(n);}});return v;};D.prototype._createButtons=function(){var t,T;this._oBtnMoveBottom=new B(this.getId()+'-MoveBottomButton',{layoutData:new sap.ui.layout.GridData({span:"L2 M3 S3"})});this._oBtnMoveBottom.setIcon("sap-icon://expand-group");this._oBtnMoveBottom.attachPress(this._onMoveBottomClick.bind(this));T=this._textResources.getText("FORM_PERS_DIALOG_MOVE_BOTTOM");this._oBtnMoveBottom.setTooltip(T);this.oLayoutTopLeft.addContent(this._oBtnMoveBottom);this._oBtnMoveDown=new B(this.getId()+'-MoveDownButton',{layoutData:new sap.ui.layout.GridData({span:"L2 M3 S3"})});this._oBtnMoveDown.setIcon("sap-icon://slim-arrow-down");this._oBtnMoveDown.attachPress(this._onMoveDownClick.bind(this));T=this._textResources.getText("FORM_PERS_DIALOG_MOVE_DOWN");this._oBtnMoveDown.setTooltip(T);this.oLayoutTopLeft.addContent(this._oBtnMoveDown);this._oBtnMoveUp=new B(this.getId()+'-MoveUpButton',{layoutData:new sap.ui.layout.GridData({span:"L2 M3 S3"})});this._oBtnMoveUp.setIcon("sap-icon://slim-arrow-up");this._oBtnMoveUp.attachPress(this._onMoveUpClick.bind(this));T=this._textResources.getText("FORM_PERS_DIALOG_MOVE_UP");this._oBtnMoveUp.setTooltip(T);this.oLayoutTopLeft.addContent(this._oBtnMoveUp);this._oBtnMoveTop=new B(this.getId()+'-MoveTopButton',{layoutData:new sap.ui.layout.GridData({span:"L2 M3 S3"})});this._oBtnMoveTop.setIcon("sap-icon://collapse-group");this._oBtnMoveTop.attachPress(this._onMoveTopClick.bind(this));T=this._textResources.getText("FORM_PERS_DIALOG_MOVE_TOP");this._oBtnMoveTop.setTooltip(T);this.oLayoutTopLeft.addContent(this._oBtnMoveTop);this._oBtnAddGroup=new B(this.getId()+'-AddGroupButton',{layoutData:new sap.ui.layout.GridData({span:"L4 M12 S12"})});t=this._textResources.getText("FORM_PERS_DIALOG_ADD_GROUP");this._oBtnAddGroup.setText(t);this._oBtnAddGroup.attachPress(this._onAddGroupClick.bind(this));T=this._textResources.getText("FORM_PERS_DIALOG_ADD_GROUP");this._oBtnAddGroup.setTooltip(T);this.oLayoutTopLeft.addContent(this._oBtnAddGroup);this._oBtnAddField=new B(this.getId()+'-AddFieldButton');this._oBtnAddField.setIcon("sap-icon://slim-arrow-left");this._oBtnAddField.attachPress(this._onAddFieldClick.bind(this));T=this._textResources.getText("FORM_PERS_DIALOG_ADD_FIELD");this._oBtnAddField.setTooltip(T);this.oLayoutMiddle.addItem(this._oBtnAddField);};D.prototype._onMoveUpClick=function(){var m,o,i;m=this.getModel();if(m){i=this._getIdOfSelectedFieldListNode();o=this._getDataFromModel();this._executeMoveUp(o,i);this._updateMoveButtonEnabledState(o);m.setData(o);}};D.prototype._onMoveDownClick=function(){var o,i,m;m=this.getModel();if(m){i=this._getIdOfSelectedFieldListNode();o=this._getDataFromModel();this._executeMoveDown(o,i);this._updateMoveButtonEnabledState(o);m.setData(o);}};D.prototype._onMoveTopClick=function(){var m,o,i;m=this.getModel();if(m){i=this._getIdOfSelectedFieldListNode();o=this._getDataFromModel();this._executeMoveTop(o,i);this._updateMoveButtonEnabledState(o);m.setData(o);}};D.prototype._onMoveBottomClick=function(){var o,i,m;m=this.getModel();if(m){i=this._getIdOfSelectedFieldListNode();o=this._getDataFromModel();this._executeMoveBottom(o,i);this._updateMoveButtonEnabledState(o);m.setData(o);}};D.prototype._onAddGroupClick=function(){var o,m;m=this.getModel();if(m){o=this._getDataFromModel();this._executeAddGroup(o);m.setData(o);this._onNodeAddedOrHidden();}};D.prototype._getIdOfSelectedFieldListNode=function(){var n;n=this._oSelectedFieldListNodeData;if(n){return n.id;}};D.prototype._onAddFieldClick=function(E){var m,o;m=this.getModel();if(m){o=this._getDataFromModel();this._executeAddField(o);m.setData(o);}};D.prototype._getParentAndIndexNodeForNewField=function(o){var i,n,p;i=this._getIdOfSelectedFieldListNode();this._findNodeInDataModel(o,i,function(N){if(N.type==='group'){p=N;if(p.children&&p.children.length){n=p.children.length;}}else{p=N.parent;n=N.index+1;}});if(!p){p=this._getBottomGroup(o);n=p.children.length;}return{parent:p,index:n};};D.prototype._getBottomGroup=function(o){var g;if(o&&o.children&&o.children.length>0){var v=this._getVisibleGroups(o.children);g=v[v.length-1];}return g;};D.prototype._getDataFromModel=function(){var m;m=this.getModel();if(m){return m.getData();}};D.prototype._createAdjacenceList=function(o){var A,g;A=[];g=function(n,p,h,i){n.index=h;n.parent=p;A[i]=A[i]||[];A[i].push(n);};this._dfs(o,g);return A;};D.prototype._destroyAdjacenceList=function(o){var g;g=function(n,p,h,i){delete n.index;delete n.parent;};this._dfs(o,g);};D.prototype._dfs=function(o,g,p,n,h){var i;if(!o){return;}h=h||0;n=n||0;g(o,p,n,h);if(o&&o.children){for(i=0;i<o.children.length;i++){this._dfs(o.children[i],g,o,i,h+1);}}};D.prototype._findNodeInDataModel=function(o,i,g){var A;A=this._createAdjacenceList(o);(function(){var n,j,h,k,N;h=A.length;for(n=0;n<h;n++){k=A[n].length;for(j=0;j<k;j++){N=A[n][j];if(N.id===i){g(N,n,A);return;}}}}());this._destroyAdjacenceList(o);};D.prototype._moveDownNode=function(n,g,A){var m=this._checkMoveDown(n,g,A);if(m.enabled){if(m.newParent){n.parent.children.splice(n.index,1);m.newParent.children=m.newParent.children||[];m.newParent.children.splice(0,0,n);}else{n.parent.children.splice(n.index,1);n.parent.children.splice(n.index+m.moveStep,0,n);}}};D.prototype._moveUpNode=function(n,g,A){var m=this._checkMoveUp(n,g,A);if(m.enabled){if(m.newParent){n.parent.children.splice(n.index,1);m.newParent.children=m.newParent.children||[];m.newParent.children.push(n);}else{n.parent.children.splice(n.index,1);n.parent.children.splice(n.index-m.moveStep,0,n);}}};D.prototype._moveBottomNode=function(n,g,A){var m=this._checkMoveDown(n,g,A);if(m.enabled){if(m.newParent){n.parent.children.splice(n.index,1);m.newParent.children=m.newParent.children||[];m.newParent.children.push(n);}else{n.parent.children.splice(n.index,1);n.parent.children.push(n);}}};D.prototype._moveTopNode=function(n,g,A){var m=this._checkMoveUp(n,g,A);if(m.enabled){if(m.newParent){n.parent.children.splice(n.index,1);m.newParent.children=m.newParent.children||[];m.newParent.children.splice(0,0,n);}else{n.parent.children.splice(n.index,1);n.parent.children.splice(0,0,n);}}};D.prototype._executeMoveDown=function(o,i){return this._findNodeInDataModel(o,i,this._moveDownNode.bind(this));};D.prototype._executeMoveUp=function(o,i){return this._findNodeInDataModel(o,i,this._moveUpNode.bind(this));};D.prototype._executeMoveBottom=function(o,i){return this._findNodeInDataModel(o,i,this._moveBottomNode.bind(this));};D.prototype._executeMoveTop=function(o,i){return this._findNodeInDataModel(o,i,this._moveTopNode.bind(this));};D.prototype._executeAddField=function(o){var n,N,t=this;n=this._getParentAndIndexNodeForNewField(o);N=this._getNewNodeFromSelectedODataField(o,this._getSelectedFieldFromFieldSelector());var E=this._getExistingField(N,o);if(E){this._findNodeInDataModel(o,E.id,function(g,h,A){g.isVisible=true;g.parent.children.splice(g.index,1);if(g.parent===n.parent){if(g.index<n.index){n.index--;}}t._addField(g,n.parent,n.index);});}else{this._addField(N,n.parent,n.index);}};D.prototype._getExistingField=function(n,o){var g=false;var r='';if(n.isBoundToODataService){r=n.entityType+'/'+n.fieldValue;}else{r=n.id;}var h=function(p,s){if(s.path===r){g=true;}};var j=function(p){if(p===r){g=true;}};if(o.children){for(var i=0;i<o.children.length;i++){var k=o.children[i];if(k.type==="field"){if(k.isBoundToODataService){q.each(k.bindingPaths,h);}else{j(k.id);}}if(g){return k;}var m=this._getExistingField(n,k);if(m){return m;}}}};D.prototype._addField=function(n,p,g){if(!n){return;}p.children=p.children||[];if(g||g===0){p.children.splice(g,0,n);}else{p.children.push(n);}};D.prototype._getNewNodeFromSelectedODataField=function(o,s){var n;if(!s){return null;}n={bindingPaths:(s.isBoundToODataService)?[{path:s.entityName+'/'+s.path}]:[{path:''}],isBoundToODataService:s.isBoundToODataService,id:(s.isBoundToODataService)?o.id+"_"+s.entityType+"_"+s.path.replace("/","_"):s.id,entitySet:s.entitySet,entityType:s.entityType,entityName:s.entityName,label:s.field,valueProperty:"value",fieldValue:s.path,jsType:"sap.ui.comp.smartfield.SmartField",isVisible:true,type:"field"};return n;};D.prototype._getSelectedFieldFromFieldSelector=function(){return this._oFieldSelector.getSelectedField();};D.prototype._executeAddGroup=function(o){var t,n;t=this._textResources.getText("FORM_PERS_DIALOG_NEW_GROUP");n={id:this._sViewId+q.sap.uid(),label:t,isVisible:true,type:"group",children:[]};o.children.splice(0,0,n);this._changeSelection(n);};D.prototype.exit=function(){if(this._oScrollView){this._oScrollView.destroy();this._oScrollView=null;}if(this._oBtnMoveBottom){this._oBtnMoveBottom.destroy();this._oBtnMoveBottom=null;}if(this._oBtnMoveDown){this._oBtnMoveDown.destroy();this._oBtnMoveDown=null;}if(this._oBtnMoveUp){this._oBtnMoveUp.destroy();this._oBtnMoveUp=null;}if(this._oBtnMoveTop){this._oBtnMoveTop.destroy();this._oBtnMoveTop=null;}if(this._oBtnAddGroup){this._oBtnAddGroup.destroy();this._oBtnAddGroup=null;}if(this._oBtnAddField){this._oBtnAddField.destroy();this._oBtnAddField=null;}if(this._oFieldSelector){this._oFieldSelector.destroy();this._oFieldSelector=null;}if(this.oLayoutRight){this.oLayoutRight.destroy();this.oLayoutRight=null;}if(this.oLayoutMiddle){this.oLayoutMiddle.destroy();this.oLayoutMiddle=null;}if(this.oLayoutTopLeft){this.oLayoutTopLeft.destroy();this.oLayoutTopLeft=null;}if(this.oLayoutLeft){this.oLayoutLeft.destroy();this.oLayoutLeft=null;}if(this.oLayout){this.oLayout.destroy();this.oLayout=null;}};return D;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.smartform.flexibility.FieldListNode')){jQuery.sap.declare('sap.ui.comp.smartform.flexibility.FieldListNode');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.m.CheckBox');jQuery.sap.require('sap.m.FlexBox');jQuery.sap.require('sap.ui.core.Control');jQuery.sap.require('sap.m.Button');sap.ui.define("sap/ui/comp/smartform/flexibility/FieldListNode",['jquery.sap.global','sap/m/CheckBox','sap/m/FlexBox','sap/ui/comp/library','./Input','sap/ui/core/Control','sap/m/Button'],function(q,C,F,l,I,a,B){"use strict";var b=a.extend("sap.ui.comp.smartform.flexibility.FieldListNode",{metadata:{library:"sap.ui.comp",properties:{label:{type:"string",group:"Misc",defaultValue:null},isVisible:{type:"boolean",group:"Misc",defaultValue:null},isSelected:{type:"boolean",group:"Misc",defaultValue:null}},aggregations:{nodes:{type:"sap.ui.comp.smartform.flexibility.FieldListNode",multiple:true,singularName:"node"},layout:{type:"sap.ui.core.Control",multiple:false}},events:{selected:{parameters:{target:{type:"sap.ui.comp.smartform.flexibility.FieldListNode"}}},labelChanged:{parameters:{target:{type:"sap.ui.comp.smartform.flexibility.FieldListNode"}}},nodeHidden:{parameters:{target:{type:"sap.ui.comp.smartform.flexibility.FieldListNode"}}}}}});b.prototype.init=function(){this._textResources=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");this._oLayout=new F({direction:sap.m.FlexDirection.Row,justifyContent:sap.m.FlexJustifyContent.SpaceBetween});this._oLabelInputField=new I(this.getId()+'-Input');this._oLabelInputField.addStyleClass("sapUiCompFieldListNodeLabelInputField");this._oLabelInputField.setValue(this.getLabel());this._oLabelInputField.setEditable(false);this._oLabelInputField.attachChange(this._onLabelChanged.bind(this));this._oLabelInputField.attachSelectedByKeyboard(this._onLabelSelectedByKeyboard.bind(this));this._oLabelInputField.setLayoutData(new sap.m.FlexItemData({}));this._oLayout.addItem(this._oLabelInputField);this._oDeleteButton=new B(this.getId()+'_Button');this._oDeleteButton.setType("Transparent");this._oDeleteButton.setIcon("sap-icon://decline");this._oDeleteButton.setIconDensityAware(false);this._oDeleteButton.setTooltip(this._textResources.getText("FORM_PERS_VIS_CHECKBOX_TOOLTIP"));this._oDeleteButton.attachPress(this._hideNode.bind(this));this._oDeleteButton.setLayoutData(new sap.m.FlexItemData({}));this._oLayout.addItem(this._oDeleteButton);this.setLayout(this._oLayout);};b.prototype.setLabel=function(L){this._oLabelInputField.setValue(L);this.setProperty("label",L);};b.prototype.setIsVisible=function(i){if(this.getModel()){this.getModel().setData(this.getModel().getData());}this.setProperty("isVisible",i);this.setVisible(i);};b.prototype.setIsSelected=function(i){if(!i){this._oLabelInputField.setEditable(false);}this.setProperty("isSelected",i);};b.prototype._hideNode=function(e){this.setIsVisible(false);this._fireNodeHiddenAndDelegateToParent(this);};b.prototype._onLabelChanged=function(e){var L;L=this._oLabelInputField.getValue();if(L!==this.getLabel()){this.setProperty("label",L);}this._oLabelInputField.setEditable(false);this._fireLabelChangedAndDelegateToParent(this);};b.prototype._onLabelSelectedByKeyboard=function(e){this._oLabelInputField.setEditable(true);this._fireSelectedAndDelegateToParent(this);};b.prototype.onAfterRendering=function(){this.registerToDOMEvents();};b.prototype.onBeforeRendering=function(){this.deregisterToDOMEvents();};b.prototype.registerToDOMEvents=function(){q("#"+this.getId()).on('click',q.proxy(this._handleClick,this));};b.prototype.deregisterToDOMEvents=function(){q("#"+this.getId()).off('click');};b.prototype._handleClick=function(e){var t,s;t=e.target||e.srcElement;if(t){s=sap.ui.getCore().byId(t.id);if(!(s instanceof b)){if(t.parentElement){s=sap.ui.getCore().byId(t.parentElement.id);}}}if((s===this._oLabelInputField)&&this.getIsSelected()){this._oLabelInputField.setEditable(true);}if(s===this||s===this._oLabelInputField){this._fireSelectedAndDelegateToParent(this);}};b.prototype._fireSelectedAndDelegateToParent=c('fireSelected','_fireSelectedAndDelegateToParent');b.prototype._fireLabelChangedAndDelegateToParent=c('fireLabelChanged','_fireLabelChangedAndDelegateToParent');b.prototype._fireNodeHiddenAndDelegateToParent=c('fireNodeHidden','_fireNodeHiddenAndDelegateToParent');function c(f,s){return function(o){var p;if(!(o instanceof b)){return;}this[f]({target:o});p=this.getParent();if(p&&p instanceof b){p[s](o);}};}return b;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.smartvariants.SmartVariantManagement')){
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.ui.comp.smartvariants.SmartVariantManagement');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.fl.Change');jQuery.sap.require('sap.ui.fl.Persistence');jQuery.sap.require('sap.ui.fl.registry.Settings');jQuery.sap.require('sap.ui.fl.Utils');sap.ui.define("sap/ui/comp/smartvariants/SmartVariantManagement",['jquery.sap.global','sap/ui/comp/library','./PersonalizableInfo','sap/ui/comp/variants/VariantItem','sap/ui/comp/variants/VariantManagement','sap/ui/fl/Change','sap/ui/fl/Persistence','sap/ui/fl/registry/Settings','sap/ui/fl/Utils'],function(q,l,P,V,a,C,b,S,F){"use strict";var c=a.extend("sap.ui.comp.smartvariants.SmartVariantManagement",{metadata:{library:"sap.ui.comp",aggregations:{personalizableControls:{type:"sap.ui.comp.smartvariants.PersonalizableInfo",multiple:true,singularName:"personalizableControl"}},events:{initialise:{},afterSave:{}}},renderer:function(r,o){a.getMetadata().getRenderer().render(r,o);}});c.prototype.init=function(){a.prototype.init.apply(this);this._mStandardVariants={};this._mControlPersistence={};this._mControlComponent={};this._mControlPromise={};this._mCurrentVariantId={};this._aPersonalizableControls=null;this._bIsInitialized=false;if(this.setLifecycleSupport){this.setLifecycleSupport(true);}this._setBackwardCompatibility(false);};c.prototype.addPersonalizableControl=function(o){var d=null;var s=o.getControl();this.addAggregation("personalizableControls",o,true);if(s){d=sap.ui.getCore().byId(s);this._mControlPersistence[d]=new b(d,o.getKeyName());this._mControlComponent[d]=sap.ui.fl.Utils.getComponentClassName(d);}this._handleGetChanges(d);};c.prototype._handleGetChanges=function(o){var t=this;if(o&&this._mControlPersistence&&this._mControlPersistence[o]){this._mControlPromise[o]={};this._mControlPromise[o].promise=new Promise(function(r,d){t._mControlPersistence[o].getChanges().then(function(v){var s=t._mControlPersistence[o].getComponentName();var p={appDescriptor:F.getAppDescriptor(o),siteId:F.getSiteId(o)};sap.ui.fl.registry.Settings.getInstance(s,p).then(function(e){var R={variants:v,settings:e};r(R);});},function(e){d(e);});});}};c.prototype._createControlWrapper=function(o){var d=null;var e=sap.ui.getCore().byId(o.getControl());if(e){d={control:e,type:o.getType(),dataSource:o.getDataSource(),persistence:this._mControlPersistence[e],keyName:o.getKeyName()};if(this._mControlPromise[e]&&this._mControlPromise[e].promise){d.promise=this._mControlPromise[e].promise;}}return d;};c.prototype.getVariantContent=function(o,k){var d=null;if(k===this.STANDARDVARIANTKEY){d=this.getStandardVariant(o);}else{d=this._getVariantContent(o,k);}return d;};c.prototype._getVariant=function(o,i){var d=null;if(o){var p=this._mControlPersistence[o];if(p){d=p.getChange(i);}}return d;};c.prototype._getVariantContent=function(o,k){var d=null;var v=this._getVariant(o,k);if(v){d=v.getContent();}return d;};c.prototype._getAllPersonalizableControls=function(){var i;var o=null;if(!this._aPersonalizableControls){this._aPersonalizableControls=[];var p=this.getPersonalizableControls();if(p){for(i=0;i<p.length;i++){o=this._createControlWrapper(p[i]);if(o){this._aPersonalizableControls.push(o);}}}}return this._aPersonalizableControls;};c.prototype._createVariantEntries=function(v,o){var n=null;var s,d=null;var e,f;var g=[];this.removeAllItems();if(v){for(n in v){if(n){e=v[n];if(e.isVariant()){f=new V({key:e.getId(),text:e.getText("variantName"),global:!e.isUserDependent(),executeOnSelection:this._getExecuteOnSelection(e),lifecycleTransportId:e.getRequest(),lifecyclePackage:e.getPackage(),namespace:e.getNamespace(),readOnly:e.isReadOnly(),labelReadOnly:e.isLabelReadOnly()});if(this._hasStoredStandardVariant(e)){d=e.getId();}this.addVariantItem(f);g.push(e.getId());}}}}if(o){s=this._getDefaultVariantKey(o);if(s){this.setInitialSelectionKey(s);}var h=this._isApplicationVariant(o.control);if(h){this.setIndustrySolutionMode(h);h=F.isVendorLayer();this._setVendorLayer(h);}if(this.getIndustrySolutionMode()){if(o.standardvariantkey!==undefined){delete o.standardvariantkey;}if(d){o.standardvariantkey=d;this.setStandardVariantKey(d);}}}if(this._isVariantDownport(o)){this._enableManualVariantKey(true);}return g;};c.prototype.getVariantsInfo=function(f){if(!f){q.sap.log.error("'getVariantsInfo' failed . Expecting callBack not passed.");return;}var n=null;var v;var d=[];var e;var t=this;try{e=this._getAllPersonalizableControls();if(e&&(e.length===1)&&e[0].persistence&&e[0].control){e[0].persistence.getChanges().then(function(m){if(m){for(n in m){if(n){v=m[n];if(v.isVariant()){d.push({key:v.getId(),text:v.getText("variantName")});}}}}f(d);},function(h){var E="'getChanges' failed:";if(h&&h[0]&&h[0].messages&&h[0].messages[0]){E+=(' '+h[0].messages[0]);}t._setErrorValueState(t.oResourceBundle.getText("VARIANT_MANAGEMENT_READ_FAILED"),E,e[0].control);f(d);});}}catch(g){this._setErrorValueState(this.oResourceBundle.getText("VARIANT_MANAGEMENT_READ_FAILED"),"'getChanges' throws an exception",null);}};c.prototype.getCurrentVariantId=function(){var k="";var i=this._getSelectedItem();if(i){k=i.getKey();if(k===this.STANDARDVARIANTKEY){k="";}}return k;};a.prototype.setCurrentVariantId=function(v,d){var o;var i=this._determineVariantId(v);var e=this._getAllPersonalizableControls();if(e&&(e.length===1)&&e[0].persistence&&e[0].control){if(!this._bIsInitialized){this._mCurrentVariantId[e[0].control]=v;}else{o=this.getVariantContent(e[0].control,i);if(o){this._setSelectionByKey(i);if(d!==true){this._applyVariant(e[0].control,o);}}}}};c.prototype._determineVariantId=function(v){var i=v;if(!i){i=this.getStandardVariantKey();}else{if(!this.getItemByKey(i)){i=this.getStandardVariantKey();}}return i;};c.prototype.initialise=function(){var t=this;var d;var o=null,e=null,v;var p={variantKeys:[]};var k;try{d=this._getAllPersonalizableControls();if(d&&(d.length===1)&&d[0].persistence&&d[0].control&&d[0].promise){d[0].promise.then(function(r){var m=r.variants;p.variantKeys=t._createVariantEntries(m,d[0]);var D=t._getDefaultVariantKey(d[0]);if(D){v=t._getVariant(d[0].control,D);if(v){t.setDefaultVariantKey(D);t.setInitialSelectionKey(D);}}var s=null;if(d[0].standardvariantkey){s=t._getVariantContent(d[0].control,d[0].standardvariantkey);}if(d[0].standardvariantkey&&((d[0].type==="table")||(d[0].type==="chart"))){e=s;t._applyVariant(d[0].control,e,"STANDARD",true);}t.fireEvent("initialise",p);t._bIsInitialized=true;if(!d[0].standardvariantkey){t._setStandardVariant(d[0]);}var g=t._mCurrentVariantId[d[0].control];if(g){k=t._determineVariantId(g);t.setInitialSelectionKey(k);t._mCurrentVariantId[d[0].control]=undefined;}k=t.getSelectionKey();if(k&&(k!==t.getStandardVariantKey())){o=t._getVariantContent(d[0].control,k);}else{if(d[0].standardvariantkey&&(!e)){o=s;}}if(d[0].standardvariantkey){t._updateStandardVariant(d[0].control,s);}if(o){t._applyVariant(d[0].control,o,null,true);}else{if((k===t.STANDARDVARIANTKEY)&&t.bExecuteOnSelectForStandard){if(d[0].control.search){t.setInitialSelectionKey(k);d[0].control.search();}}}},function(g){var E="'getChanges' failed:";if(g&&g[0]&&g[0].messages&&g[0].messages[0]){E+=(' '+g[0].messages[0]);}t._setErrorValueState(t.oResourceBundle.getText("VARIANT_MANAGEMENT_READ_FAILED"),E,d[0].control);t.fireEvent("initialise",p);t._setStandardVariant(d[0].control);});}else{this._setErrorValueState(this.oResourceBundle.getText("VARIANT_MANAGEMENT_READ_FAILED"),"'initialise' no personalizable component available",null);this.fireEvent("initialise",p);if(d&&(d.length===1)&&d[0].control){this._setStandardVariant(d[0].control);}}}catch(f){this._setErrorValueState(this.oResourceBundle.getText("VARIANT_MANAGEMENT_READ_FAILED"),"'getChanges' throws an exception",null);this.fireEvent("initialise",p);if(d&&(d.length===1)&&d[0].control){this._setStandardVariant(d[0].control);}}};c.prototype._updateVariant=function(v,o){if(this._isIndustrySolutionModeAndVendorLayer()||(v.key!==this.getStandardVariantKey())){if(v&&o&&o.control&&o.control.fetchVariant){var d=this._getVariant(o.control,v.key);if(d){try{if((v.lifecycleTransportId!==null)&&(v.lifecycleTransportId!==undefined)){d.setRequest(v.lifecycleTransportId);}var e=o.control.fetchVariant();if(e){var i=this.getItemByKey(v.key);if(i){e.executeOnSelection=i.getExecuteOnSelection();}if(e.standardvariant!==undefined){delete e.standardvariant;}if(this._isIndustrySolutionModeAndVendorLayer()&&(v.key===this.getStandardVariantKey())){e.standardvariant=true;}d.setContent(e);}}catch(f){q.sap.log.error("'_updateVariant' throws an exception");}}}}};c.prototype._newVariant=function(v,o){var i;if(v&&o&&o.control&&o.control.fetchVariant&&o.persistence){var t=o.type;var d=o.dataSource;var u=!v.global;var p="";if((v.lifecyclePackage!==null)&&(v.lifecyclePackage!==undefined)){p=v.lifecyclePackage;}var T="";if((v.lifecycleTransportId!==null)&&(v.lifecycleTransportId!==undefined)){T=v.lifecycleTransportId;}var e=o.control.fetchVariant();if(e){var s=JSON.stringify(e);e=JSON.parse(s);if(v.exe){e.executeOnSelection=v.exe;}if(v.tile){e.tile=v.tile;}if(e.standardvariant!==undefined){delete e.standardvariant;}if(this._isIndustrySolutionModeAndVendorLayer()&&v.key===this.STANDARDVARIANTKEY){e.standardvariant=true;}}i=this._isVariantDownport(o)?v.key:null;var m={type:t,ODataService:d,texts:{variantName:v.name},content:e,isVariant:true,packageName:p,isUserDependent:u,id:i};i=o.persistence.addChange(m);this.replaceKey(v.key,i);this.setInitialSelectionKey(i);if(this.getIndustrySolutionMode()&&v.key===this.STANDARDVARIANTKEY){this.setStandardVariantKey(i);}var f=this._getVariant(o.control,i);if(f){f.setRequest(T);var I=this.getItemByKey(i);if(I){I.setNamespace(f.getNamespace());}}if(v.def===true){this._setDefaultVariantKey(o,i);}}};c.prototype._appendLifecycleInformation=function(v,i){var t;var I=this.getItemByKey(i);if(I){t=I.getLifecycleTransportId();if(t===null||t===undefined){t="";}if(v){v.setRequest(t);}}};c.prototype._renameVariant=function(v,o){if(v.key!==this.getStandardVariantKey()){if(v&&o&&o.control){var d=this._getVariant(o.control,v.key);if(d){d.setText("variantName",v.name);this._appendLifecycleInformation(d,v.key);}}}};c.prototype._deleteVariants=function(v,o){var i;if(v&&v.length&&o&&o.control){var s=this._getDefaultVariantKey(o);for(i=0;i<v.length;i++){if(v[i]===this.getStandardVariantKey()){continue;}var d=this._getVariant(o.control,v[i]);if(d){d.markForDeletion();if(s&&s===v[i]){this._setDefaultVariantKey(o,"");}this._appendLifecycleInformation(d,v[i]);}}}};c.prototype._getDefaultVariantKey=function(o){var d="";if(o&&o.persistence){d=o.persistence.getDefaultVariantIdSync();}return d;};c.prototype._setDefaultVariantKey=function(o,v){if(o&&o.persistence){o.persistence.setDefaultVariantIdSync(v);}};c.prototype._isVariantDownport=function(o){var d=false;if(o&&o.persistence){d=o.persistence.isVariantDownport();}return d;};c.prototype._getExecuteOnSelection=function(v){var o;if(v){o=v.getContent();if(o&&(o.executeOnSelection!==undefined)){return o.executeOnSelection;}}return false;};c.prototype._hasStoredStandardVariant=function(v){var o;if(v){o=v.getContent();if(o&&o.standardvariant){return o.standardvariant;}}return false;};c.prototype._isComponentTemplate=function(o){var i=false;var d=F.getComponentForControl(o);if(d&&d.getAppComponent){d=d.getAppComponent();if(d){i=true;}}return i;};c.prototype._isApplicationVariant=function(o){if(F.isApplicationVariant(o)){return true;}if(this._isComponentTemplate(o)){return true;}return false;};c.prototype._setExecuteOnSelections=function(v,o){var i;if(v&&v.length&&o&&o.control){for(i=0;i<v.length;i++){var d=this._getVariant(o.control,v[i].key);if(d){var j=d.getContent();if(j){j.executeOnSelection=v[i].exe;d.setContent(j);}this._appendLifecycleInformation(d,v[i].key);}}}};c.prototype._save=function(o){var t=this;if(o&&o.persistence){try{o.persistence.saveAll().then(function(){t.fireEvent("afterSave");},function(d){var E="'_save' failed:";if(d&&d[0]&&d[0].messages&&d[0].messages[0]){E+=(' '+d[0].messages[0]);}t._setErrorValueState(t.oResourceBundle.getText("VARIANT_MANAGEMENT_SAVE_FAILED"),E,o.control);});}catch(e){this._setErrorValueState(this.oResourceBundle.getText("VARIANT_MANAGEMENT_SAVE_FAILED"),"'_save' throws an exception",o.control);}}};c.prototype.fireSave=function(v){var s=false;var d=this._getAllPersonalizableControls();if(d&&(d.length===1)){if(v){if(v.overwrite){if(this._isIndustrySolutionModeAndVendorLayer()||(v.key!==this.getStandardVariantKey())){this.fireEvent("save");if(v.key===this.STANDARDVARIANTKEY){this._newVariant(v,d[0]);}else{this._updateVariant(v,d[0]);}s=true;}}else{this.fireEvent("save");this._newVariant(v,d[0]);s=true;}if(s){this._save(d[0]);}}}};c.prototype.fireManage=function(v){var i;var d=this._getAllPersonalizableControls();if(d&&(d.length===1)){if(v){if(v.renamed){for(i=0;i<v.renamed.length;i++){this._renameVariant(v.renamed[i],d[0]);}}if(v.deleted){this._deleteVariants(v.deleted,d[0]);}if(v.exe){this._setExecuteOnSelections(v.exe,d[0]);}if(v.def){var D=this._getDefaultVariantKey(d[0]);if(D!==v.def){this._setDefaultVariantKey(d[0],v.def);}}if((v.deleted&&v.deleted.length>0)||(v.renamed&&v.renamed.length>0)||(v.exe&&v.exe.length>0)||v.def){this._save(d[0]);}}}};c.prototype.fireSelect=function(v){var o=null;var d=this._getAllPersonalizableControls();if(d&&(d.length===1)){if(v&&v.key){o=this.getVariantContent(d[0].control,v.key);if(o){var s=JSON.stringify(o);o=JSON.parse(s);if((v.key===this.STANDARDVARIANTKEY)&&this.bExecuteOnSelectForStandard){o.executeOnSelection=this.bExecuteOnSelectForStandard;}this._applyVariant(d[0].control,o);}}}};c.prototype._setStandardVariant=function(o){var d=o.control;if(d){if(d.fireBeforeVariantSave){d.fireBeforeVariantSave(a.STANDARD_NAME);}this._assignStandardVariant(d);}};c.prototype._updateStandardVariant=function(o,d){this._assignStandardVariantForCotrol(o,d);};c.prototype._assignStandardVariant=function(o){var s=null;if(o){if(o.fetchVariant){s=o.fetchVariant();}this._assignStandardVariantForCotrol(o,s);}};c.prototype._assignStandardVariantForCotrol=function(o,s){if(o){this._mStandardVariants[o]=s;}};c.prototype.getStandardVariant=function(o){var d=null;if(this._mStandardVariants&&o&&this._mStandardVariants[o]){d=this._mStandardVariants[o];}return d;};c.prototype._applyVariant=function(o,d,s,i){if(o&&o.applyVariant){o.applyVariant(d,s,i);}};c.prototype._setErrorValueState=function(t,L,o){this.setEnabled(false);if(L){q.sap.log.error(L);}};c.prototype.exit=function(){a.prototype.exit.apply(this,arguments);this._mStandardVariants=null;this._mControlPersistence=null;this._aPersonalizableControls=null;var n;for(n in this._mControlPromise){if(n&&this._mControlPromise[n].promise){this._mControlPromise[n].promise=null;delete this._mControlPromise[n].promise;}}this._mControlPromise=null;this._mControlComponent=null;this._mCurrentVariantId=null;};return c;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.smartvariants.SmartVariantManagementUi2')){
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.ui.comp.smartvariants.SmartVariantManagementUi2');jQuery.sap.require('jquery.sap.global');sap.ui.define("sap/ui/comp/smartvariants/SmartVariantManagementUi2",['jquery.sap.global','sap/ui/comp/library','./PersonalizableInfo','sap/ui/comp/variants/VariantItem','sap/ui/comp/variants/VariantManagement'],function(q,l,P,V,a){"use strict";var S=a.extend("sap.ui.comp.smartvariants.SmartVariantManagementUi2",{metadata:{library:"sap.ui.comp",aggregations:{personalizableControl:{type:"sap.ui.comp.smartvariants.PersonalizableInfo",multiple:false}},events:{initialise:{},afterSave:{}}},renderer:function(r,c){a.getMetadata().getRenderer().render(r,c);}});S.prototype.init=function(){a.prototype.init.apply(this);this._oStandardVariant=null;this._oPersController=null;this._sKeyName=null;this._oContainer=null;this._oVariantSet=null;if(this.setLifecycleSupport){this.setLifecycleSupport(false);}this._setBackwardCompatibility(false);};S.prototype.getVariantContent=function(c,k){var C=null;if(k===this.STANDARDVARIANTKEY){C=this._getStandardVariant();}else{if(this._oVariantSet){var v=this._oVariantSet.getVariant(k);if(v){C=this._getContent(v);}}}return C;};S.prototype.getCurrentVariantId=function(){var k="";var i=this._getSelectedItem();if(i){k=i.getKey();if(k===this.STANDARDVARIANTKEY){k="";}}return k;};S.prototype.setCurrentVariantId=function(v,d){var c;var i=v;if(!i){i=this.STANDARDVARIANTKEY;}else{if(!this.getItemByKey(i)){i=this.STANDARDVARIANTKEY;}}if(this._oVariantSet){c=this.getVariantContent(this._oPersController,i);if(c){this._setSelectionByKey(i);if(d!==true){this._applyVariantContent(c);}}}};S.prototype.addPersonalizableControl=function(c){this.setAggregation("personalizableControl",c,true);if(c.getControl()){this._oPersController=sap.ui.getCore().byId(c.getControl());}this._sKeyName=c.getKeyName();};S.prototype.initialise=function(){var c=this._getPersistencyKey();if(!c){q.sap.log.warning("PersistencyKey not set");this.fireEvent("initialise");return;}if(sap.ushell&&sap.ushell.Container){var t=this;sap.ushell.Container.getService("Personalization").getContainer(c,{validity:Infinity}).fail(function(){q.sap.log.error("Loading personalization container failed");t._setErrorValueState(t.oResourceBundle.getText("VARIANT_MANAGEMENT_READ_FAILED"));t.fireEvent("initialise");}).done(function(C){t._readPersonalization(C);t.fireEvent("initialise");t._setStandardVariant();t._setSelectedVariant();});return;}q.sap.log.error("Could not obtain the personalization container");this._setErrorValueState(this.oResourceBundle.getText("VARIANT_MANAGEMENT_READ_FAILED"));this.fireEvent("initialise");};S.prototype._setSelectedVariant=function(){var v=null;if(this._oVariantSet){var k=this.getSelectionKey();if(k){v=this._oVariantSet.getVariant(k);if(v){this._applyVariant(v);}}}};S.prototype._reCreateVariantEntries=function(){var n=null;var v=null;var o,b;this.removeAllItems();if(this._oVariantSet){var m=this._oVariantSet.getVariantNamesAndKeys();if(m){for(n in m){if(n){b=new V({text:n,key:m[n]});this.addVariantItem(b);}}v=this._oVariantSet.getCurrentVariantKey();o=this._oVariantSet.getVariant(v);if(o){this.setDefaultVariantKey(v);this.setInitialSelectionKey(v);}}}};S.prototype._getVariantSetAdapter=function(){var v=null;if(this._oContainer){v=new sap.ushell.services.Personalization.VariantSetAdapter(this._oContainer);}return v;};S.prototype._createVariantEntries=function(){var v=this._getVariantSetAdapter();if(v){this._oVariantSet=v.getVariantSet("filterBarVariantSet");if(this._oVariantSet){this._reCreateVariantEntries();}else{this._oVariantSet=v.addVariantSet("filterBarVariantSet");}}};S.prototype._readPersonalization=function(c){this._oContainer=c;if(this._oContainer){this._createVariantEntries();}};S.prototype._savePersonalizationContainer=function(){var t=this;if(this._oContainer){this._oContainer.save().fail(function(){q.sap.log.error("Saving personalization data failed");t._setErrorValueState(t.oResourceBundle.getText("VARIANT_MANAGEMENT_SAVE_FAILED"));}).done(function(){q.sap.log.info("Saving personalization data succeeded");t.fireEvent("afterSave");});}};S.prototype.fireSave=function(v){var o=null,n=null;var s;if(!this._oVariantSet){return;}if(v){if(v.overwrite){if(v.key){o=this._oVariantSet.getVariant(v.key);}}else{if(v.name){o=this._oVariantSet.addVariant(v.name);n=o;s=n.getVariantKey();this.replaceKey(v.key,s);this.setInitialSelectionKey(s);}}if(o){this.fireEvent("save",v);var b=this._fetchVariant();if(b){o.setItemValue("filterBarVariant",b.filterBarVariant);o.setItemValue("filterbar",b.filterbar);if(b.basicSearch){o.basicSearch=b.basicSearch;}s=o.getVariantKey();if(v.def){if(s){this._oVariantSet.setCurrentVariantKey(s);}}else{var d=this._oVariantSet.getCurrentVariantKey();if(s===d){this._oVariantSet.setCurrentVariantKey(null);}}}this._savePersonalizationContainer();}}};S.prototype._setStandardVariant=function(){if(this._oPersController&&this._oPersController.fireBeforeVariantSave){this._oPersController.fireBeforeVariantSave(a.STANDARD_NAME);}this._oStandardVariant=this._fetchVariant();};S.prototype._getStandardVariant=function(){return this._oStandardVariant;};S.prototype.getStandardVariant=function(){return this._getStandardVariant();};S.prototype._setVariantName=function(v,s,n){var k;var f,F;if(this._oVariantSet){var N=this._oVariantSet.addVariant(n);f=v.getItemValue("filterBarVariant");N.setItemValue("filterBarVariant",f);F=v.getItemValue("filterbar");N.setItemValue("filterbar",F);k=this._oVariantSet.getCurrentVariantKey();if(k===s){this._oVariantSet.setCurrentVariantKey(N.getVariantKey());}this._oVariantSet.delVariant(s);k=N.getVariantKey();this.replaceKey(s,k);this.setInitialSelectionKey(k);}};S.prototype.fireManage=function(v){var i;var r=null,d=null;var o;if(!this._oVariantSet){return;}if(v){r=v.renamed;d=v.deleted;if(r){for(i=0;i<r.length;i++){o=this._oVariantSet.getVariant(r[i].key);if(o){if(o.setVariantName){o.setVariantName(r[i].name);}else{this._setVariantName(o,r[i].key,r[i].name);}}}}if(d){var s=this._oVariantSet.getCurrentVariantKey();for(i=0;i<d.length;i++){o=this._oVariantSet.getVariant(d[i]);if(o){if(s&&s===o.getVariantKey()){this._oVariantSet.setCurrentVariantKey(null);}this._oVariantSet.delVariant(d[i]);}}}if(v.def){o=this._oVariantSet.getVariant(v.def);if(o||(v.def===this.STANDARDVARIANTKEY)){this._oVariantSet.setCurrentVariantKey(v.def);}}if((d&&d.length>0)||(r&&r.length>0)||(v.def)){this._savePersonalizationContainer();}}};S.prototype.fireSelect=function(v){var o=null;if(v&&v.key){if(this._oVariantSet){if(v.key===this.STANDARDVARIANTKEY){o=this._getStandardVariant();}else{o=this._oVariantSet.getVariant(v.key);}}}if(o){this._applyVariant(o);}};S.prototype._getContent=function(v){var c=null;if(v){if(v.getItemValue){c={filterbar:v.getItemValue("filterbar"),filterBarVariant:v.getItemValue("filterBarVariant")};if(v.basicSearch){c.basicSearch=v.basicSearch;}}else{c=v;}}return c;};S.prototype._applyVariant=function(v){var c=this._getContent(v);this._applyVariantContent(c);};S.prototype._applyVariantContent=function(c){if(c&&this._oPersController&&this._oPersController.applyVariant){this._oPersController.applyVariant(c);}};S.prototype._fetchVariant=function(){if(this._oPersController&&this._oPersController.fetchVariant){return this._oPersController.fetchVariant();}return null;};S.prototype._getPersistencyKey=function(){if(this._oPersController&&this._sKeyName){return this._oPersController.getProperty(this._sKeyName);}return null;};S.prototype._setErrorValueState=function(t){this.setEnabled(false);};S.prototype.exit=function(){a.prototype.exit.apply(this,arguments);this._oStandardVariant=null;this._oPersController=null;this._sKeyName=null;this._oContainer=null;this._oVariantSet=null;};return S;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.filterbar.FilterBar')){
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.ui.comp.filterbar.FilterBar');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.m.MultiInput');jQuery.sap.require('sap.m.Bar');jQuery.sap.require('sap.m.Button');jQuery.sap.require('sap.m.ButtonType');jQuery.sap.require('sap.m.CheckBox');jQuery.sap.require('sap.m.Label');jQuery.sap.require('sap.m.LabelDesign');jQuery.sap.require('sap.m.Link');jQuery.sap.require('sap.m.List');jQuery.sap.require('sap.m.ListSeparators');jQuery.sap.require('sap.m.Panel');jQuery.sap.require('sap.m.PlacementType');jQuery.sap.require('sap.m.SearchField');jQuery.sap.require('sap.m.Text');jQuery.sap.require('sap.m.Toolbar');jQuery.sap.require('sap.m.ToolbarSpacer');jQuery.sap.require('sap.ui.Device');jQuery.sap.require('sap.ui.core.Icon');jQuery.sap.require('sap.ui.core.TextAlign');jQuery.sap.require('sap.ui.core.Title');jQuery.sap.require('sap.ui.core.ValueState');jQuery.sap.require('sap.ui.layout.Grid');jQuery.sap.require('sap.ui.layout.GridRenderer');jQuery.sap.require('sap.ui.layout.GridData');jQuery.sap.require('sap.ui.layout.HorizontalLayout');jQuery.sap.require('sap.ui.layout.ResponsiveFlowLayout');jQuery.sap.require('sap.ui.layout.ResponsiveFlowLayoutData');jQuery.sap.require('sap.ui.layout.VerticalLayout');jQuery.sap.require('sap.ui.layout.form.Form');jQuery.sap.require('sap.ui.layout.form.FormContainer');jQuery.sap.require('sap.ui.layout.form.FormElement');jQuery.sap.require('sap.ui.layout.form.ResponsiveGridLayout');jQuery.sap.require('sap.ui.layout.form.FormRenderer');sap.ui.define("sap/ui/comp/filterbar/FilterBar",['jquery.sap.global','sap/m/MultiInput','sap/m/Bar','sap/m/Button','sap/m/ButtonType','sap/m/CheckBox','sap/m/Label','sap/m/LabelDesign','sap/m/Link','sap/m/List','sap/m/ListSeparators','sap/m/Panel','sap/m/PlacementType','sap/m/SearchField','sap/m/Text','sap/m/Toolbar','sap/m/ToolbarSpacer','sap/ui/Device','./VariantConverterFrom','./VariantConverterTo','sap/ui/comp/library','sap/ui/comp/smartvariants/PersonalizableInfo','sap/ui/comp/smartvariants/SmartVariantManagementUi2','sap/ui/comp/variants/VariantManagement','sap/ui/core/Icon','sap/ui/core/TextAlign','sap/ui/core/Title','sap/ui/core/ValueState','sap/ui/layout/Grid','sap/ui/layout/GridRenderer','sap/ui/layout/GridData','sap/ui/layout/HorizontalLayout','sap/ui/layout/ResponsiveFlowLayout','sap/ui/layout/ResponsiveFlowLayoutData','sap/ui/layout/VerticalLayout','sap/ui/layout/form/Form','sap/ui/layout/form/FormContainer','sap/ui/layout/form/FormElement','sap/ui/layout/form/ResponsiveGridLayout','sap/ui/layout/form/FormRenderer'],function(q,M,B,a,b,C,L,c,d,e,f,P,g,S,T,h,k,D,V,l,m,o,p,r,I,s,t,u,G,v,w,H,R,x,y,F,z,A,E,J){"use strict";var K=G.extend("sap.ui.comp.filterbar.FilterBar",{metadata:{library:"sap.ui.comp",properties:{persistencyKey:{type:"string",group:"Misc",defaultValue:null},advancedMode:{type:"boolean",group:"Misc",defaultValue:false},expandAdvancedArea:{type:"boolean",group:"Misc",defaultValue:false,deprecated:true},searchEnabled:{type:"boolean",group:"Misc",defaultValue:true},filterBarExpanded:{type:"boolean",group:"Misc",defaultValue:true},considerGroupTitle:{type:"boolean",group:"Misc",defaultValue:false},showClearButton:{type:"boolean",group:"Misc",defaultValue:false},showRestoreButton:{type:"boolean",group:"Misc",defaultValue:true},showGoOnFB:{type:"boolean",group:"Misc",defaultValue:true},showRestoreOnFB:{type:"boolean",group:"Misc",defaultValue:false},showClearOnFB:{type:"boolean",group:"Misc",defaultValue:false},showGoButton:{type:"boolean",group:"Misc",defaultValue:null,deprecated:true},deltaVariantMode:{type:"boolean",group:"Misc",defaultValue:true},filterContainerWidth:{type:"string",group:"Misc",defaultValue:"12rem"}},aggregations:{filterItems:{type:"sap.ui.comp.filterbar.FilterItem",multiple:true,singularName:"filterItem"},filterGroupItems:{type:"sap.ui.comp.filterbar.FilterGroupItem",multiple:true,singularName:"filterGroupItem"}},associations:{basicSearch:{type:"sap.m.SearchField",multiple:false}},events:{cancel:{},reset:{parameters:{selectionSet:{type:"sap.ui.core.Control[]"}}},search:{parameters:{selectionSet:{type:"sap.ui.core.Control[]"}}},beforeVariantSave:{parameters:{context:{type:"string"}}},beforeVariantFetch:{},afterVariantLoad:{parameters:{context:{type:"string"}}},filterChange:{},clear:{parameters:{selectionSet:{type:"sap.ui.core.Control[]"}}},initialise:{},afterVariantSave:{},filtersDialogClosed:{}}},renderer:v.render});K.INTERNAL_GROUP="__$INTERNAL$";K.prototype.init=function(){this._oBasicAreaLayout=null;this._oVariantManagement=null;this._oCollectiveSearch=null;this._aBasicAreaSelection=null;this._mAdvancedAreaFilter=null;this._fRegisteredFetchData=null;this._fRegisteredApplyData=null;this._fRegisterGetFiltersWithValues=null;this._oHideShowButton=null;this._oSearchButton=null;this._oFiltersButton=null;this._oClearButtonOnFB=null;this._oRestoreButtonOnFB=null;this._bIsInitialized=false;this._oDialog=null;this._oFilterDialog=null;this._aFields=null;this._oBasicSearchField=null;this._oVariant={};this._filterChangeSemaphore=true;this._triggerFilterChangeState=true;this._fRegisteredFilterChangeHandlers=null;this._fInitialiseVariants=null;this._oRb=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");this.addStyleClass("sapUiCompFilterBar");if(this._isPhone()){this.addStyleClass("sapUiCompFilterBarPhone");}else{this.addStyleClass("sapUiCompFilterBarNonPhone");}this.addStyleClass("sapUiCompFilterBarMarginBottom");this.addStyleClass("sapUiCompFilterBarPaddingPanel");this._oToolbar=this._createToolbar();this._oToolbar.setLayoutData(new w({span:"L12 M12 S12"}));this.addContent(this._oToolbar);this._oBasicAreaLayout=this._createBasicAreaLayout();this._oBasicAreaLayout.setLayoutData(new w({span:"L12 M12 S12"}));this.addContent(this._oBasicAreaLayout);this._oAdvancedPanel=new P();this._oAdvancedPanel.setLayoutData(new w({span:"L12 M12 S12"}));this._oAdvancedPanel.setVisible(false);this._oAdvancedAreaForm=this._createAdvancedAreaForm();this._oAdvancedPanel.addContent(this._oAdvancedAreaForm);this.addContent(this._oAdvancedPanel);q(window).on("resize.basicsearch",q.proxy(this._fHandleResize,this));this.oModel=new sap.ui.model.json.JSONModel({});this.setModel(this.oModel,"FilterBar");this._oHintText=new T({text:this._oRb.getText("FILTER_BAR_NO_FILTERS_ON_FB"),textAlign:s.Center});this._oHintText.setVisible(false);this._oHintText.addStyleClass("sapUiCompFilterBarHint");this._oBasicAreaLayout.addContent(this._oHintText);if(this._isTablet()||this._isPhone()){this.setFilterBarExpanded(false);}};K.prototype._hasAnyVisibleFiltersOnFB=function(){var j=this._retrieveVisibleAdvancedItems();for(var i=0;i<j.length;i++){if(j[i].filterItem.getVisibleInFilterBar()){return true;}}return false;};K.prototype._showHintText=function(){var i=0;if(!this.getAdvancedMode()&&!this._isPhone()){var j=!this._hasAnyVisibleFiltersOnFB();if(j&&this._mAdvancedAreaFilter){i=this._oBasicAreaLayout.indexOfContent(this._oHintText);if(i<0){this._oBasicAreaLayout.insertContent(this._oHintText,0);}}this._oHintText.setVisible(j);if(i<0){this._oBasicAreaLayout.rerender();}}};K.prototype._adaptButtonsEnablement=function(){var i=false||!!this._mAdvancedAreaFilter;this._oHideShowButton.setEnabled(i);this._oClearButtonOnFB.setEnabled(i);this._oRestoreButtonOnFB.setEnabled(i);this._oFiltersButton.setEnabled(i);if(i&&this.getFilterBarExpanded()&&!this._isPhone()&&!this.getAdvancedMode()){this._oBasicAreaLayout.setVisible(true);}};K.prototype.setShowClearOnFB=function(i){if(!this._isPhone()){this.setProperty("showClearOnFB",i);this._oClearButtonOnFB.setVisible(i);}};K.prototype.setShowRestoreOnFB=function(i){if(!this._isPhone()){this.setProperty("showRestoreOnFB",i);this._oRestoreButtonOnFB.setVisible(i);}};K.prototype.setShowGoOnFB=function(i){this.setProperty("showGoOnFB",i);this._oSearchButton.setVisible(i);};K.prototype.setShowGoButton=function(i){this.setShowGoOnFB(i);};K.prototype.getShowGoButton=function(){return this.getShowGoOnFB();};K.prototype.setCurrentVariantId=function(i,j){if(this._oVariantManagement){this._oVariantManagement.setCurrentVariantId(i,j);}};K.prototype.getCurrentVariantId=function(){var i="";if(this._oVariantManagement){i=this._oVariantManagement.getCurrentVariantId();}return i;};K.prototype.getDataSuiteFormat=function(i){var j=null;var n,N,O;if(this._oVariantManagement){n=this.getCurrentVariantId();if(this.getFilterDataAsString){O=this._determineVariantFiltersInfo(i,true);N=this.getFilterDataAsString(i);if(N){var Q=new l();j=Q.convert(n,O,N,this);}}}return j;};K.prototype.setDataSuiteFormat=function(i,j){var n,N;var O;if(i){n=new V();N=n.convert(i,this);if(N){O=this._getConsiderFilterChanges();if(N.variantId&&this._oVariantManagement){if(this._bIsInitialized){this._setFilterVisibility(N.variantId);}else{this._oVariantManagement.setInitialSelectionKey(N.variantId);}}if(N.payload&&this.setFilterDataAsString){this._setConsiderFilterChanges(false);this.setFilterDataAsString(N.payload,j);}this._setConsiderFilterChanges(O);}}};K.prototype._setFilterVisibility=function(i){if(this._oVariantManagement.getSelectionKey()!==i){this._oVariantManagement.setInitialSelectionKey(i);var j=this._getStandardVariant();if(j){var n=this._oVariantManagement.getVariantContent(this,i);if(n&&n.filterbar){if(n.version==="V2"){n=this.mergeVariant(j,n);}this._reapplyVisibility(n.filterbar);}}}};K.prototype.setPersistencyKey=function(i){this.setProperty("persistencyKey",i);if(this._oVariantManagement){this._oVariantManagement.setVisible(true);}};K.prototype.clearVariantSelection=function(){if(this._oVariantManagement){this._oVariantManagement.clearVariantSelection();}};K.prototype.setSearchEnabled=function(i){this.setProperty("searchEnabled",i);if(this._oSearchButton){this._oSearchButton.setEnabled(i);}};K.prototype.getSearchEnabled=function(){return this.getProperty("searchEnabled");};K.prototype.setSearchButtonEmphType=function(i){};K.prototype.setSimplifiedMode=function(i){};K.prototype.getSimplifiedMode=function(){if(this.getAdvancedMode()){return false;}return true;};K.prototype.setExpandAdvancedArea=function(i){this.setFilterBarExpanded(i);};K.prototype.getExpandAdvancedArea=function(){return this.getFilterBarExpanded();};K.prototype.setAdvancedMode=function(i){this.setProperty("advancedMode",i);if(i){if(this._oVariantManagement){this._oVariantManagement.setVisible(false);}if(this._oToolbar){this._oToolbar.addStyleClass("sapUiCompFilterBarToolbarBasicSearchNoVariant");}if(this._oBasicSearchField){if(this._oToolbar.indexOfContent(this._oBasicSearchField)<0){this._oToolbar.insertContent(this._oBasicSearchField,1);}}}else{if(this.getPersistencyKey()){if(this._oVariantManagement){this._oVariantManagement.setVisible(true);}if(this._oToolbar){this._oToolbar.removeStyleClass("sapUiCompFilterBarToolbarBasicSearchNoVariant");}}}this._oFiltersButton.setVisible(!i);this._oHideShowButton.setVisible((i&&this._isPhone())?false:true);this._oBasicAreaLayout.setVisible(!i);this._oAdvancedPanel.setVisible(i&&this.getFilterBarExpanded());};K.prototype._setCollectiveSearch=function(i){if(this.getAdvancedMode()&&i){if(this._oToolbar){if(this._oVariantManagement){this._oToolbar.removeContent(this._oVariantManagement);this._oVariantManagement=null;}if(this._oCollectiveSearch){this._oToolbar.removeContent(this._oCollectiveSearch);}this._oCollectiveSearch=i;this._oToolbar.insertContent(this._oCollectiveSearch,0);this._oToolbar.removeStyleClass("sapUiCompFilterBarToolbarBasicSearchNoVariant");}}};K.prototype.setBasicSearch=function(i){this.setAssociation("basicSearch",i,true);var j=this;if(this._oBasicSearchField){this._oToolbar.removeContent(this._oBasicSearchField);}if(i&&(!this._isPhone()||this.getAdvancedMode())){this._oToolbar.insertContent(i,1);if(this._isUi2Mode()){i.attachLiveChange(function(n){j.fireFilterChange(n);});}}this._oBasicSearchField=i;};K.prototype.addFilterItem=function(i){var n,j,N;if(!i){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterItem()"+" Expected argument 'oFilterItem' may not be null nor empty");}n=i.getName();if(!n){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterItem()"+" Expected argument 'oFilterItem.name' may not be null nor empty");}j=i.getControl();if(!j){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterItem()"+" Expected argument 'oFilterItem.control' may not be null nor empty");}this.addAggregation("filterItems",i,true);if(!this._aBasicAreaSelection){this._aBasicAreaSelection=[];}var O={control:i.getControl(),filterItem:i};this._aBasicAreaSelection.push(O);N=new sap.ui.comp.filterbar.FilterGroupItem({label:i.getLabel(),labelTooltip:i.getLabelTooltip(),name:i.getName(),mandatory:i.getMandatory(),visible:i.getVisible(),visibleInFilterBar:i.getVisibleInFilterBar(),partOfCurrentVariant:true,control:i.getControl(),groupName:K.INTERNAL_GROUP,groupTitle:""});N._iSpan=i._iSpan;if(i.data('isCustomField')){N.data('isCustomField',true);}i.attachChange(this._filterItemChange.bind(this,null));this.addFilterGroupItem(N);};K.prototype.addFilterGroupItem=function(i){var n,j,O,N;if(!i){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterGroupItem()"+" Expected argument 'oFilterGroupItem' may not be null nor empty");}this.addAggregation("filterGroupItems",i,true);j=i.getGroupName();if(!j){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterGroupItems()"+" GroupName may not be null nor empty");}n=i.getName();if(!n){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterGroupItems()"+" Name may not be null nor empty");}if(!this._mAdvancedAreaFilter){this._mAdvancedAreaFilter={};}if(!this._mAdvancedAreaFilter[j]){this._mAdvancedAreaFilter[j]={};this._mAdvancedAreaFilter[j].filterItem=null;this._mAdvancedAreaFilter[j].items=[];}if(!this._mAdvancedAreaFilter[j].filterItem){this._mAdvancedAreaFilter[j].filterItem=i;}O={control:i.getControl(),filterItem:i};if(this.getAdvancedMode()||i.getVisibleInFilterBar()){i.setVisibleInFilterBar(true);}else{i.setVisibleInFilterBar(false);}this._mAdvancedAreaFilter[j].items.push(O);N=this._addControlToBasicAreaFormContainer(i);if(N){O.container=N;N.setVisible(i.getVisible()&&i.getVisibleInFilterBar());if(i.getVisibleInFilterBar()){i.setPartOfCurrentVariant(i.getVisibleInFilterBar());}i.attachChange(this._filterGroupItemChange.bind(this));}if(this.getAdvancedMode()){this._rerenderAA();}else{this._showHintText();}this._adaptButtonsEnablement();};K.prototype._filterItemChange=function(i,j){var n;var N;var O;if(j&&j.oSource&&(j.oSource instanceof sap.ui.comp.filterbar.FilterItem)){O=j.getParameter("propertyName");if(O==="visibleInFilterBar"||O==="visible"||O==="label"||O==="labelTooltip"||O==="mandatory"){n=this._determineItemByName(j.oSource.getName(),K.INTERNAL_GROUP);if(n&&n.filterItem){if((O==="visible")){N=j.oSource.getVisible();n.filterItem.setVisible(N);}else if(O==="visibleInFilterBar"){N=j.oSource.getVisibleInFilterBar();var Q=this._checkChangePossibleVisibleInFilterBar(n.filterItem,N);if(Q){n.filterItem.setVisibleInFilterBar(N);}else{j.oSource.setVisibleInFilterBar(true);}}else if(O==="label"){n.filterItem.setLabel(j.oSource.getLabel());}else if(O==="labelTooltip"){n.filterItem.setLabelTooltip(j.oSource.getLabelTooltip());}else if(O==="mandatory"){N=j.oSource.getMandatory();n.filterItem.setMandatory(N);}}}}};K.prototype._filterGroupItemChange=function(i){var j;var n;if(i&&i.oSource){n=i.getParameter("propertyName");if(n==="visibleInFilterBar"||n==="visible"){j=this._determineItemByName(i.oSource.getName(),i.oSource.getGroupName());if(j){if(n==="visibleInFilterBar"){var N=i.oSource.getVisibleInFilterBar();var O=this._checkChangePossibleVisibleInFilterBar(i.oSource,N);if(!O){i.oSource.setVisibleInFilterBar(true);N=true;}if(N){i.oSource.setPartOfCurrentVariant(true);}if(!this.getAdvancedMode()){this._rerenderItem(j);this._adaptLinkText(i.oSource.getGroupName());}}else if(n==="visible"){if(this.getAdvancedMode()&&j.container){j.container.setVisible(true);}else{this._updateToolbarText();this._rerenderGroup(j,i.oSource.getGroupName());}}this._showHintText();}}else if(n==="groupTitle"){if(this._mAdvancedAreaFilter&&this._mAdvancedAreaFilter[i.oSource.getGroupName()]){if(this._mAdvancedAreaFilter[i.oSource.getGroupName()].formcontainer){this._mAdvancedAreaFilter[i.oSource.getGroupName()].formcontainer.setTitle(i.oSource.getGroupTitle());}else{this._adaptGroupTitle(i.oSource.getGroupName());}}}else if(n==="label"){if(!this._mAdvancedAreaFilter[i.oSource.getGroupName()].formcontainer){this._adaptGroupTitleForFilter(i.oSource);}}else if(n==="mandatory"){if(this._oFilterDialog){this._adaptMandatoryForFilter(i.oSource);}}if(this.getAdvancedMode()){this._rerenderAA();}}};K.prototype._addContainer=function(i){if(i){if(this._oBasicAreaLayout&&!this._oFilterDialog){if(i.container&&(this._oBasicAreaLayout.indexOfContent(i.container)===-1)){this._addContainerInOrder(i.filterItem,i.container);}}}};K.prototype._addContainerInOrder=function(j,N){var n,i,O,Q=this._oBasicAreaLayout.getContent(),U=-1;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){var W=this._mAdvancedAreaFilter[n];if(W&&W.items){for(i=0;i<W.items.length;i++){if(W.items[i].container===N){this._oBasicAreaLayout.insertContent(N,U+1);return;}O=Q.indexOf(W.items[i].container);if(O>=0){U=O;}}}}}};K.prototype._checkChangePossibleVisibleInFilterBar=function(i,j){if(i&&i.getMandatory()&&!j){var n=this._hasFilterValue(i);if(!n){i.setVisibleInFilterBar(true);return false;}}return true;};K.prototype._adaptLinkText=function(i){if(this._mAdvancedAreaFilter&&this._mAdvancedAreaFilter[i]&&this._mAdvancedAreaFilter[i].link){this._setLinkText(i,this._mAdvancedAreaFilter[i].link);}};K.prototype._hasFilterValue=function(i){var j=this._getFiltersWithValues();return this._checkFilterForValue(j,i);};K.prototype._adaptMandatoryForFilter=function(i){var j;var n=i.getGroupName();if(i){j=this._determineItemByName(i.getName(),n);if(j&&j.checkbox&&j.checkbox.getVisible()){var N=true;if(i.getMandatory()){var O=this._hasFilterValue(i);if(!O){N=false;i.setVisibleInFilterBar(true);}}j.checkbox.setEnabled(N);}}};K.prototype._adaptGroupTitleForFilter=function(i){var j;var n;if(i){j=i.getLabel();n=i.getLabelControl(this.getId());if(this.getConsiderGroupTitle()){if(n&&i.getGroupTitle()){n.setText(j+" ("+i.getGroupTitle()+')');}}else{n.setText(j);}}};K.prototype._adaptGroupTitle=function(j){var i;var n;if(this._mAdvancedAreaFilter&&this._mAdvancedAreaFilter[j]&&this._mAdvancedAreaFilter[j].items){for(i=0;i<this._mAdvancedAreaFilter[j].items.length;i++){n=this._mAdvancedAreaFilter[j].items[i];if(n&&n){this._adaptGroupTitleForFilter(n.filterItem);}}}};K.prototype._adaptGroupsTitle=function(){var n=null;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n&&n!==K.INTERNAL_GROUP){this._adaptGroupTitle(n);}}}};K.prototype.registerGetFiltersWithValues=function(i){this._fRegisterGetFiltersWithValues=i;};K.prototype.registerFetchData=function(i){this._fRegisteredFetchData=i;};K.prototype.registerApplyData=function(i){this._fRegisteredApplyData=i;};K.prototype._isTINAFScenario=function(){if(this._oVariantManagement){if(!this._isUi2Mode()){return true;}}else{if(this._oCollectiveSearch&&this.getAdvancedMode()){return true;}}return false;};K.prototype.fireInitialise=function(){if(this._isTINAFScenario()){this._createVisibleFilters();if(this.getAdvancedMode()){this._ensureFilterLoaded(null);}this._fireInitialiseEvent();}else{this._initializeVariantManagement();}};K.prototype._initializeVariantManagement=function(){this._createVisibleFilters();if(this._oVariantManagement&&this.getPersistencyKey()){this._fInitialiseVariants=q.proxy(this._initialiseVariants,this);this._oVariantManagement.attachInitialise(this._fInitialiseVariants);this._oVariantManagement.initialise();}else{this._fireInitialiseEvent();}};K.prototype._fireInitialiseEvent=function(){this.fireEvent("initialise");this._bIsInitialized=true;this._updateToolbarText();};K.prototype._initialiseVariants=function(){this._fireInitialiseEvent();if(this._oVariantManagement){this._oVariantManagement.currentVariantSetModified(false);}};K.prototype.fireAfterVariantLoad=function(i){this._rerenderFilters();var j={context:i};this.fireEvent("afterVariantLoad",j);};K.prototype.fireBeforeVariantSave=function(i){var j={context:i};var n=this._getConsiderFilterChanges();if(i){this._setConsiderFilterChanges(false);}this.fireEvent("beforeVariantSave",j);if(i){this._setConsiderFilterChanges(n);}};K.prototype.removeAllFilterItems=function(){var i;var j;this._aBasicAreaSelection=null;var n=this._oBasicAreaLayout.getContent();if(n){for(i=0;i<n.length;i++){this._oBasicAreaLayout.removeContent(n[i]);}}j=this.getFilterItems();if(this._mAdvancedAreaFilter){if((this._mAdvancedAreaFilter[K.INTERNAL_GROUP])&&(this._mAdvancedAreaFilter[K.INTERNAL_GROUP].items)){for(i=0;i<this._mAdvancedAreaFilter[K.INTERNAL_GROUP].items.length;i++){if(this._mAdvancedAreaFilter[K.INTERNAL_GROUP].items[i].filterItem){j.push(this._mAdvancedAreaFilter[K.INTERNAL_GROUP].items[i].filterItem);}}delete this._mAdvancedAreaFilter[K.INTERNAL_GROUP];}if(Object.keys(this._mAdvancedAreaFilter).length===0){this._mAdvancedAreaFilter=null;}}this._destroyItems(j);this._adaptButtonsEnablement();};K.prototype.removeAllFilterGroupItems=function(){var n=null,i;var j=[];for(n in this._mAdvancedAreaFilter){if(n){if(this._mAdvancedAreaFilter[n]&&this._mAdvancedAreaFilter[n].items){for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){if(this._mAdvancedAreaFilter[n].items[i].filterItem){j.push(this._mAdvancedAreaFilter[n].items[i].filterItem);}}delete this._mAdvancedAreaFilter[n];}}if(Object.keys(this._mAdvancedAreaFilter).length===0){this._mAdvancedAreaFilter=null;}}this.__bDeleteMode=true;this._destroyItems(j);this.__bDeleteMode=false;this._adaptButtonsEnablement();};K.prototype.removeAllFilters=function(){this.removeAllFilterItems();this.removeAllFilterGroupItems();this.removeBasicSearch();};K.prototype.removeBasicSearch=function(){this.setBasicSearch(null);};K.prototype.getAllFilterItems=function(j){var i,n=null;var N=[];var O,Q;if(!j){this._ensureFilterLoaded(null);}if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){O=this._mAdvancedAreaFilter[n];if(O.items){for(i=0;i<O.items.length;i++){Q=O.items[i];if(Q&&Q.filterItem&&Q.filterItem.getVisible()){if(j){if(Q.filterItem.getVisibleInFilterBar()||Q.filterItem.getPartOfCurrentVariant()){N.push(Q.filterItem);}}else{N.push(Q.filterItem);}}}}}}}return N;};K.prototype._clearErrorState=function(){var i;var j;var n=this.determineMandatoryFilterItems();if(n){for(i=0;i<n.length;i++){j=this.determineControlByFilterItem(n[i]);if(j&&j.setValueState){j.setValueState(u.None);}}}};K.prototype.getAggregation=function(n){if(n=="filterGroupItems"&&!this.__bDeleteMode){this._ensureFilterLoaded(null);}return G.prototype.getAggregation.apply(this,arguments);};K.prototype._getFilterInformation=function(){return[];};K.prototype._createVisibleFilters=function(){this._aFields=this._getFilterInformation();var i,j;if(this._aFields&&this._aFields.length>0){if(!this._mAdvancedAreaFilter){this._mAdvancedAreaFilter={};}for(i=0;i<this._aFields.length;i++){j=this._aFields[i];if(j.groupName!==K.INTERNAL_GROUP){if(!this._mAdvancedAreaFilter[j.groupName]){this._mAdvancedAreaFilter[j.groupName]={};this._mAdvancedAreaFilter[j.groupName].groupTitle=j.groupTitle;this._mAdvancedAreaFilter[j.groupName].filterItem=null;this._mAdvancedAreaFilter[j.groupName].items=[];}}if(j.visibleInAdvancedArea||(j.groupName===K.INTERNAL_GROUP)){this._instanciateFilterItem(j);}}this._adaptButtonsEnablement();}};K.prototype._ensureFilterLoaded=function(n){var i,j,N;if(this._aFields&&this._aFields.length>0){for(j=0;j<this._aFields.length;j++){N=this._aFields[j];if(!N.factory){continue;}if(n){for(i=0;i<n.length;i++){if((N.fieldName===n[i].name)&&(N.groupName===n[i].group)){this._instanciateFilterItem(N);break;}}}else{this._instanciateFilterItem(N);}}if(!n){this._aFields=[];}}};K.prototype._instanciateFilterItem=function(i){if(i.factory){i.factory();delete i.factory;}};K.prototype._destroyItems=function(j){if(j&&j.length){for(var i=0;i<j.length;i++){j[i].destroy();}}};K.prototype._reapplyVisibility=function(j){var i,n=null;var N;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){var O=this._mAdvancedAreaFilter[n];if(O&&O.items){for(i=0;i<O.items.length;i++){N=O.items[i];if(N&&N.filterItem){this._setPersVisibility(j,N.filterItem);}}if(n!==K.INTERNAL_GROUP){this._adaptLinkText(n);}}}}}};K.prototype._setPersVisibility=function(i,j){var n,N;var O;if(j){N=j.getName();n=j.getGroupName();O=this._checkForFilterInfo(i,N,n);if(this._isTINAFScenario()){if(O){j.setVisibleInFilterBar(O.visibleInFilterBar);j.setPartOfCurrentVariant(O.partOfCurrentVariant);}else{j.setVisibleInFilterBar(false);j.setPartOfCurrentVariant(n===K.INTERNAL_GROUP);}}else{if(O&&(O.visibleInFilterBar!==undefined)){j.setVisibleInFilterBar((O.visibleInFilterBar));j.setPartOfCurrentVariant((O.partOfCurrentVariant));}else{if((n!==K.INTERNAL_GROUP)&&O&&(O.group===n)){j.setVisibleInFilterBar((O!==null));}}}if(n===K.INTERNAL_GROUP){j.setPartOfCurrentVariant(true);}}};K.prototype._checkForFilterInfo=function(j,n,N){var i;var O=null;if(j&&j.length){for(i=0;i<j.length;i++){if((j[i].name===n)&&(j[i].group===N)){O=j[i];break;}}}return O;};K.prototype._createVariantManagement=function(){var i=new p({});var j=new o({type:"filterBar",keyName:"persistencyKey"});j.setControl(this);i.addPersonalizableControl(j);i.addStyleClass("sapUiCompFilterBarMarginLeft");return i;};K.prototype._getFiltersWithValues=function(){if(this._fRegisterGetFiltersWithValues){try{return this._fRegisterGetFiltersWithValues();}catch(i){q.sap.log.error("callback for obtaining the filter count throws an exception");}}return null;};K.prototype._getFiltersWithValuesCount=function(){var i,n=0;var j=this._getFiltersWithValues();if(j){for(i=0;i<j.length;i++){if(j[i].getVisible()&&(j[i].getVisibleInFilterBar()||j[i].getPartOfCurrentVariant())){n++;}}}if(this._oBasicSearchField&&this._oBasicSearchField.getValue&&this._oBasicSearchField.getValue()){n++;}return n;};K.prototype._checkFilterForValue=function(j,n){var i;if(j){for(i=0;i<j.length;i++){if(j[i]===n){return true;}}}return false;};K.prototype._handleVisibilityOfToolbar=function(){if(this.getAdvancedMode()){var j=false;var n=this._oToolbar.getContent();for(var i=0;i<n.length;i++){if(n[i]instanceof k){continue;}if(n[i].getVisible&&n[i].getVisible()){j=true;break;}}this._oToolbar.setVisible(j);}};K.prototype._toggleHideShow=function(){this.setFilterBarExpanded(!this.getFilterBarExpanded());};K.prototype._updateToolbarText=function(){var n=this._getFiltersWithValuesCount();var i=n?(this._oRb.getText("FILTER_BAR_ACTIVE_FILTERS",[n])):(this._oRb.getText("FILTER_BAR_ACTIVE_FILTERS_ZERO"));this._oFiltersButton.setText(i);};K.prototype.setFilterBarExpanded=function(i){if(this.getAdvancedMode()){this.setProperty("filterBarExpanded",i);if(i){this._oHideShowButton.setText(this._oRb.getText("FILTER_BAR_VH_HIDE"));}else{this._oHideShowButton.setText(this._oRb.getText("FILTER_BAR_VH_SHOW"));}this._oSearchButton.setVisible(this.getShowGoOnFB());this._oAdvancedPanel.setVisible(i);}else{var j=this._isPhone()?false:i;this.setProperty("filterBarExpanded",j);if(this._isPhone()){this._oHideShowButton.setVisible(false);this._oSearchButton.setVisible(this.getShowGoOnFB());this._oBasicAreaLayout.setVisible(false);}else{if(j){this._oHideShowButton.setText(this._oRb.getText("FILTER_BAR_HIDE"));}else{this._oHideShowButton.setText(this._oRb.getText("FILTER_BAR_SHOW"));}this._oHideShowButton.setVisible(true);this._oSearchButton.setVisible(this.getShowGoOnFB());if(this._oHideShowButton.getEnabled()){this._oBasicAreaLayout.setVisible(j);}else{this._oBasicAreaLayout.setVisible(false);}}}this._updateToolbarText();};K.prototype._selectionChangedInFilterDialog=function(i,j){j.setVisibleInFilterBar(i.getSelected());if(this._getConsiderFilterChanges()&&this._oVariantManagement&&this._oVariantManagement.getEnabled()){this._oVariantManagement.currentVariantSetModified(true);}this._bDirtyViaDialog=true;};K.prototype._mandatoryFilterChange=function(i){if(!i){return;}var j=i.getParameters();if(!j||!j.oSource){return;}var n=this._determineByControl(j.oSource);if(n&&n.checkbox){var N=n.filterItem;if(!N.getMandatory()){return;}var O=this._hasFilterValue(N);if(N.getVisibleInFilterBar()){if(O){n.checkbox.setEnabled(true);}else{n.checkbox.setEnabled(false);}}else{if(!O){N.setVisibleInFilterBar(true);n.checkbox.setSelected(true);n.checkbox.setEnabled(false);}}}};K.prototype._createFiltersAndAdaptBasicArea=function(){var i;this._setConsiderFilterChanges(false);this._recreateBasicAreaContainer(true);i=this._createFilters();this._setConsiderFilterChanges(true);return i;};K.prototype._determineNotAssignedFiltersCount=function(j){var n=0,i,N;if(this._mAdvancedAreaFilter[j]&&this._mAdvancedAreaFilter[j].items){for(i=0;i<this._mAdvancedAreaFilter[j].items.length;i++){N=this._mAdvancedAreaFilter[j].items[i].filterItem;if(!N.getVisible()){continue;}if(!N.getPartOfCurrentVariant()&&!N.getVisibleInFilterBar()){n++;}}}return n;};K.prototype._rerenderGroup=function(j,n){var i;var N;this._rerenderItem(j);this._adaptLinkText(n);if(j.formelement){if(this._mAdvancedAreaFilter[n]&&this._mAdvancedAreaFilter[n].items&&this._mAdvancedAreaFilter[n].formcontainer){for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){N=this._mAdvancedAreaFilter[n].items[i].filterItem;if(N&&N.getVisible()){this._mAdvancedAreaFilter[n].formcontainer.setVisible(true);return;}}this._mAdvancedAreaFilter[n].formcontainer.setVisible(false);}}};K.prototype._setLinkTextAndCount=function(i,j,n){var N;if(n){N=this._oRb.getText("FILTER_BAR_SHOW_MORE_FILTERS",[n]);}else{N=this._oRb.getText("FILTER_BAR_SHOW_CHANGE_FILTERS");}j.setText(N);};K.prototype._setLinkText=function(i,j){var n=this._determineNotAssignedFiltersCount(i);this._setLinkTextAndCount(i,j,n);};K.prototype._createLink=function(i,j){var n=this;var N=new d();this._setLinkText(i,N);N.attachPress(function(){n._createAddRemoveFiltersDialog(i,N);});if(j){N.addAriaLabelledBy(j);}return N;};K.prototype._isPhone=function(){return(D.system.phone)?true:false;};K.prototype._isTablet=function(){return(D.system.tablet&&!D.system.desktop)?true:false;};K.prototype._createForm=function(i){var j=this;var n=null;n=F.extend('sap.ui.comp.filterbar.Form',{metadata:{},renderer:function(N,O){J.render.apply(this,arguments);}});(function(){n.prototype.contentOnAfterRendering=function(){F.prototype.contentOnAfterRendering.apply(this,arguments);j._adaptStyleSheet();if(!j._isPhone()){j._repositionAddToFilterBarLabel();}};}());return new n({editable:true,layout:i});};K.prototype._adaptStyleSheet=function(){var i,O;var j,N,n=null;for(n in this._mAdvancedAreaFilter){if(n&&this._mAdvancedAreaFilter[n].items){for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){j=this._mAdvancedAreaFilter[n].items[i];if(j&&j.control&&j.control instanceof M){N=j.control.$();if(N){O=N.parent().css("overflow");if(O!=="visible"){N.parent().css({"overflow":"visible"});}}}}}}};K.prototype._createFilters=function(){var j=this;var n=null,i;var N;var O=null,Q,U,W;var X,Y,Z;var $=null;var _;var a1=null;var b1=true;var c1;var d1=new E();d1.setColumnsL(1);d1.setColumnsM(1);var e1=this._createForm(d1);e1.addStyleClass("sapUiCompFilterBarDialogForm");if(this._oVariantManagement){var f1=this._oToolbar.indexOfContent(this._oVariantManagement);if(f1>=0){var g1=this._oVariantManagement.clone();g1._setSelectionByKey(this._oVariantManagement.getSelectionKey());this._oToolbar.removeContent(this._oVariantManagement);this._oToolbar.insertContent(g1,f1);this._oVariant.key=this._oVariantManagement.getSelectionKey();this._oVariant.modified=this._oVariantManagement.currentVariantGetModified();O=new z();this._oVariantManagement.setLayoutData(new w({span:"L10 M10 S12"}));Q=new A({fields:this._oVariantManagement});O.addFormElement(Q);if(!this._isPhone()){a1=new L({});a1.setLayoutData(new w({span:"L2 M2 S2"}));a1.addStyleClass("sapUiCompFilterBarAddFilterLabel");this._oAddToFilterBarLabel=a1;Q=new A({label:a1});O.addFormElement(Q);}e1.addFormContainer(O);}e1.addStyleClass("sapUiCompFilterBarGroupTitle");}if(this._oBasicSearchField){if(!O){O=new z();}if(!this._isPhone()){this._oToolbar.removeContent(this._oBasicSearchField);this._oBasicSearchFieldClone=this._oBasicSearchField.clone();this._oToolbar.insertContent(this._oBasicSearchFieldClone,1);}else{if(this.getAdvancedMode()){this._oBasicSearchFieldClone=this._oBasicSearchField.clone();}}if(this._isPhone()){this._oBasicSearchField.setLayoutData(new w({span:"L8 M8 S12"}));}else{this._oBasicSearchField.setLayoutData(new w({span:"L8 M8 S11",indent:"L0 M3 S0"}));}if(this._isPhone()&&this.getAdvancedMode()){Q=new A({fields:[this._oBasicSearchFieldClone]});}else{Q=new A({fields:[this._oBasicSearchField]});}O.addFormElement(Q);}this._ensureFilterLoaded(null);var h1=this._getFiltersWithValues();this._fRegisteredFilterChangeHandlers=function(i1){j._mandatoryFilterChange(i1);};this.attachFilterChange(this._fRegisteredFilterChangeHandlers);this._oVariant.content=this.fetchVariant();this._oInitialVariant={};q.extend(true,this._oInitialVariant,this._oVariant);for(n in this._mAdvancedAreaFilter){if(n&&this._mAdvancedAreaFilter[n].items){if(n===K.INTERNAL_GROUP){N=this._oRb.getText("FILTER_BAR_BASIC_GROUP");}else{N=this._mAdvancedAreaFilter[n].filterItem.getGroupTitle();}Z=new t({text:N});O=new z({title:Z});if(b1&&N===""&&a1){a1.removeStyleClass("sapUiCompFilterBarAddFilterLabel");a1.addStyleClass("sapUiCompFilterBarAddFilterLabelNoGroup");}b1=false;c1=0;this._mAdvancedAreaFilter[n].formcontainer=O;for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){W=this._mAdvancedAreaFilter[n].items[i];if(W.control.getWidth){W.width=W.control.getWidth();if(W.control.setWidth){W.control.setWidth("100%");}}Y=W.filterItem.getLabelControl(this.getId());if(this.getConsiderGroupTitle()){Y.setText(W.filterItem.getLabel());}$=new C({tooltip:this._oRb.getText("FILTER_BAR_SHOW_IN_FILTERBAR")});$.setSelected(W.filterItem.getVisibleInFilterBar());if(W.filterItem.getMandatory()){_=this._checkFilterForValue(h1,W.filterItem);if(!_&&W.filterItem.getVisibleInFilterBar()){$.setEnabled(false);}}$.attachSelect(q.proxy(this._selectionChangedInFilterDialog,this,$,W.filterItem));if(this._isPhone()){Y.setLayoutData(new w({span:"L3 M3 S12"}));W.control.setLayoutData(new w({span:"L8 M8 S12"}));$.setVisible(false);}else{Y.setLayoutData(new w({span:"L3 M3 S12"}));W.control.setLayoutData(new w({span:"L8 M8 S11"}));$.setLayoutData(new w({span:"L1 M1 S1"}));}Q=new A({label:Y,fields:[W.control,$]});Q.setVisible(W.filterItem.getVisible()&&(W.filterItem.getVisibleInFilterBar()||W.filterItem.getPartOfCurrentVariant()));if(!W.filterItem.getVisible()){c1++;}W.formelement=Q;W.checkbox=$;O.addFormElement(Q);}U=O.getFormElements();if(U&&U.length>0){if((n!==K.INTERNAL_GROUP)&&!this.getAdvancedMode()){X=this._createLink(n,Z);if(X){if(this._isPhone()){X.setLayoutData(new w({span:"L8 M8 S12"}));}else{X.setLayoutData(new w({span:"L8 M8 S12",indent:"L3 M3 S0"}));}Q=new A({fields:[X]});this._mAdvancedAreaFilter[n].link=X;O.addFormElement(Q);}if(c1===U.length){O.setVisible(false);}}e1.addFormContainer(O);}}}return e1;};K.prototype._recreateBasicAreaContainer=function(U){var n=null,i;var j,N;var O,Q;if(this._oVariantManagement){var W=this._oToolbar.getContent();this._oToolbar.removeContent(W[0]);this._oToolbar.insertContent(this._oVariantManagement,0);}if(this._oBasicSearchField){if(!this._isPhone()){if(this._oBasicSearchFieldClone){this._oToolbar.removeContent(this._oBasicSearchFieldClone);this._oBasicSearchFieldClone=null;}if(this._oToolbar.indexOfContent(this._oBasicSearchField)<0){this._oToolbar.insertContent(this._oBasicSearchField,1);}}else{if(this.getAdvancedMode()){this._oBasicSearchFieldClone=null;}}}this._oBasicAreaLayout.removeAllContent();for(n in this._mAdvancedAreaFilter){if(n&&this._mAdvancedAreaFilter[n].items){for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){O=this._mAdvancedAreaFilter[n].items[i].filterItem;if(U){if(!O.getVisible()||!O.getVisibleInFilterBar()){continue;}j=this._mAdvancedAreaFilter[n].items[i].control.clone();N=O.getLabelControl(this.getId()).clone();if(this.getConsiderGroupTitle()){O.getLabelControl(this.getId()).setText(O.getLabel());}}else{j=this._mAdvancedAreaFilter[n].items[i].control;N=O.getLabelControl(this.getId());if(this._mAdvancedAreaFilter[n].items[i].width){j.setWidth(this._mAdvancedAreaFilter[n].items[i].width);}}Q=this._addControlToBasicAreaContainer(O,j,N);if(Q){Q.setVisible(O.getVisible()&&O.getVisibleInFilterBar());this._mAdvancedAreaFilter[n].items[i].container=Q;}}}}};K.prototype._searchRequested=function(i){if(this.search()){this._oFilterDialog.close();}};K.prototype._closeDialogAndRestoreFilterBar=function(i){this._sSearchCriteriaInFiltersDialog=null;this._oVariant={};i.removeAllFormContainers();this._recreateBasicAreaContainer();this._deleteProperties();this._adaptGroupsTitle();if(this._fRegisteredFilterChangeHandlers){this.detachFilterChange(this._fRegisteredFilterChangeHandlers);this._fRegisteredFilterChangeHandlers=null;}this._updateToolbarText();};K.prototype._variantSave=function(i){var j;this._oVariant={};this.fireBeforeVariantSave();if(this._oVariantManagement&&this._oFilterDialog){j=this._oVariantManagement.getSelectionKey();this._oVariant.key=j;this._oVariant.modified=false;this._oVariant.content=this._oVariantManagement.getVariantContent(this,j);}};K.prototype._afterVariantSave=function(i){this.fireAfterVariantSave();};K.prototype._variantSavePressed=function(i){if(this._oVariantManagement){var j=this._oVariantManagement.getSelectionKey();var n=this._oVariantManagement.getItemByKey(this._oVariantManagement.getSelectionKey());if(!this._oVariantManagement._isIndustrySolutionModeAndVendorLayer()&&((j===this._oVariantManagement.getStandardVariantKey())||(n&&n.getReadOnly&&n.getReadOnly()))){this._oVariantManagement._openSaveAsDialog();}else{this._oVariantManagement._variantSavePressed();}this._bDirtyViaDialog=false;if(this._oInitialVariant&&this._oVariantManagement._getVariantContent){this._oInitialVariant.content=this._oVariantManagement._getVariantContent(this,j);}}};K.prototype._findFirstVisibleGroup=function(){var n=null;for(n in this._mAdvancedAreaFilter){if(n&&this._mAdvancedAreaFilter[n].formcontainer&&this._mAdvancedAreaFilter[n].formcontainer.getVisible()){return this._mAdvancedAreaFilter[n].formcontainer.getTitle();}}return null;};K.prototype._repositionAddToFilterBarLabel=function(){if(!this._isPhone()){var i=this._findFirstVisibleGroup();if(i&&this._oAddToFilterBarLabel){var j=i.$();if(j){var n=j.offset();var N=this._oAddToFilterBarLabel.$();if(N){var O=N.offset();if(O&&n){O.top=n.top+5;O.right=32;N.offset(O);}}}}if(this._oAddToFilterBarLabel&&!this._oAddToFilterBarLabel.getText()){this._oAddToFilterBarLabel.setText(this._oRb.getText("FILTER_BAR_SHOW_IN_FILTERBAR"));}}};K.prototype._cancelFilterDialog=function(){if(this._oInitialVariant&&this._oInitialVariant.content&&this._bDirtyViaDialog){this.applyVariant(this._oInitialVariant.content,"CANCEL");if(this._oVariantManagement){this._oVariantManagement._setSelectionByKey(this._oInitialVariant.key);this._oVariantManagement.currentVariantSetModified(this._oInitialVariant.modified);}this.fireCancel();}};K.prototype._showFilterDialog=function(){q.sap.require("sap.m.Dialog");var i=this;this._oFilterDialog=new sap.m.Dialog({stretch:D.system.phone});this._oFilterDialog.setParent(this);this._oFilterDialog.addStyleClass("sapUiPopupWithPadding");if(this.$().closest(".sapUiSizeCompact").length>0){this._oFilterDialog.addStyleClass("sapUiSizeCompact");}this._oFilterDialog.addStyleClass("sapUiCompFilterBarDialog");if(!this._isPhone()){this._oFilterDialog.addStyleClass("sapUiCompFilterBarDialogNonPhone");}this._oFilterDialog.setTitle(this._oRb.getText("FILTER_BAR_ADV_FILTERS_DIALOG"));this._oFilterDialog.addStyleClass("sapMH4FontSize");this._oFilterDialog.addStyleClass("sapMH4Style");this._oFilterDialog.setVerticalScrolling(true);var j=new B();var n=new S({placeholder:this._oRb.getText("FILTER_BAR_SEARCH")});n.attachLiveChange(function(Q){if(i._oFilterDialog){i._triggerSearchInFilterDialog(Q);}});this._oFiltersSearchField=n;j.addContentRight(n);this._oFilterDialog.setSubHeader(j);var N=this._createFiltersAndAdaptBasicArea();if(!N){q.sap.log.error("Content for Advanced Filters Dialog could not be created");return;}this._oFilterDialog.addContent(N);this._bOKFiltersDialogTriggered=false;this._oFilterDialog.attachBeforeClose(function(){if(!i._bOKFiltersDialogTriggered){i._cancelFilterDialog();}i._closeDialogAndRestoreFilterBar(N);});this._oFilterDialog.attachAfterClose(function(){i._oBasicAreaLayout.rerender();i._oInitialVariant=null;i._oFilterDialog.destroy();i._oFilterDialog=null;i._showHintText();i.fireFiltersDialogClosed();});this._oFilterDialog.setInitialFocus(n);this._addFilterDialogButtons(N);if(!this._isPhone()){this._oFilterDialog.setContentWidth("42rem");}var O=q(document).height()/16;this._oFilterDialog.setContentHeight((O-17)+"rem");this._bDirtyViaDialog=false;this._oFilterDialog.open();};K.prototype._addFilterDialogButtons=function(i){q.sap.require("sap.m.OverflowToolbarPriority");q.sap.require("sap.m.OverflowToolbarLayoutData");var j=this;var n;var N=null,O,Q,U,W;U=new a(this.getId()+"-btnGoFilterDialog",{text:this._oRb.getText("FILTER_BAR_GO"),press:function(){j._bOKFiltersDialogTriggered=true;U.focus();j._searchRequested(i);},layoutData:new sap.m.OverflowToolbarLayoutData({priority:sap.m.OverflowToolbarPriority.NeverOverflow}),type:b.Emphasized});this._oFilterDialog.addButton(U);if(!this.getAdvancedMode()){if(this._oVariantManagement&&this._oVariantManagement.getVisible()&&this._oVariantManagement.oVariantSave){N=new a(this.getId()+"-btnSaveFilterDialog",{text:this._oRb.getText("VARIANT_MANAGEMENT_SAVE"),enabled:this._oVariantManagement.oVariantSave.getEnabled(),press:function(){j._variantSavePressed();},layoutData:new sap.m.OverflowToolbarLayoutData({priority:sap.m.OverflowToolbarPriority.Low})});n=this._oVariantManagement.getModel("save_enablement");N.setModel(n);N.bindProperty("enabled","/enabled");this._oFilterDialog.addButton(N);}O=new a(this.getId()+"-btnClearFilterDialog",{text:this._oRb.getText("FILTER_BAR_CLEAR"),visible:this.getShowClearButton(),press:function(){j.clear();},layoutData:new sap.m.OverflowToolbarLayoutData({priority:sap.m.OverflowToolbarPriority.Low})});this._oFilterDialog.addButton(O);Q=new a(this.getId()+"-btnRestoreFilterDialog",{text:this._oRb.getText("FILTER_BAR_RESTORE"),visible:this.getShowRestoreButton(),press:function(){j.reset();if(j._oVariantManagement){j._oVariantManagement.currentVariantSetModified(false);}},layoutData:new sap.m.OverflowToolbarLayoutData({priority:sap.m.OverflowToolbarPriority.Low})});if(n){Q.setEnabled(this._oVariantManagement.oVariantSave.getEnabled());Q.setModel(n);Q.bindProperty("enabled","/enabled");}this._oFilterDialog.addButton(Q);W=new a(this.getId()+"-btnCancelFilterDialog",{text:this._oRb.getText("FILTER_BAR_CANCEL"),press:function(){j._oFilterDialog.close();},layoutData:new sap.m.OverflowToolbarLayoutData({priority:sap.m.OverflowToolbarPriority.High})});this._oFilterDialog.addButton(W);}};K.prototype._createButtons=function(i){var j=this;this._oHideShowButton=new a(this.getId()+"-btnShowHide",{text:this._oRb.getText("FILTER_BAR_HIDE"),type:b.Transparent,enabled:false});this._oHideShowButton.attachPress(function(){j._toggleHideShow();});i.addContent(this._oHideShowButton);this._oClearButtonOnFB=new a(this.getId()+"-btnClear",{visible:this.getShowClearOnFB(),text:this._oRb.getText("FILTER_BAR_CLEAR"),type:b.Transparent,enabled:false});this._oClearButtonOnFB.attachPress(function(){j.clear();});i.addContent(this._oClearButtonOnFB);this._oRestoreButtonOnFB=new a(this.getId()+"-btnRestore",{visible:this.getShowRestoreOnFB(),text:this._oRb.getText("FILTER_BAR_RESTORE"),type:b.Transparent,enabled:false});this._oRestoreButtonOnFB.attachPress(function(){j.reset();if(j._oVariantManagement){j._oVariantManagement.currentVariantSetModified(false);}});i.addContent(this._oRestoreButtonOnFB);this._oFiltersButton=new a(this.getId()+"-btnFilters",{text:this._oRb.getText("FILTER_BAR_ACTIVE_FILTERS_ZERO"),type:b.Transparent,enabled:false});this._oFiltersButton.attachPress(function(){j._showFilterDialog();});i.addContent(this._oFiltersButton);this._oSearchButton=new a(this.getId()+"-btnGo",{visible:this.getShowGoOnFB(),text:this._oRb.getText("FILTER_BAR_GO"),type:b.Emphasized});this._oSearchButton.attachPress(function(){j._oSearchButton.focus();j.search();});i.addContent(this._oSearchButton);};K.prototype._createVariantLayout=function(){this._oVariantManagement=this._createVariantManagement();this._oVariantManagement.setVisible(false);this._fSaveVariant=q.proxy(this._variantSave,this);this._oVariantManagement.attachSave(this._fSaveVariant);this._fAfterSaveVariant=q.proxy(this._afterVariantSave,this);this._oVariantManagement.attachAfterSave(this._fAfterSaveVariant);return this._oVariantManagement;};K.prototype._createToolbar=function(){var i=new h();var j=this._createVariantLayout();i.addContent(j);i.addContent(new k());this._createButtons(i);i.addStyleClass("sapUiCompFilterBarToolbar");i.addStyleClass("sapUiCompFilterBarToolbarMarker");return i;};K.prototype._createBasicAreaLayout=function(){var i=new H({visible:false});i.setAllowWrapping(true);i.addStyleClass("sapUiCompFilterBarWidth100");i.addStyleClass("sapUiCompFilterBarBasicArea");return i;};K.prototype._createAdvancedAreaForm=function(){var i=new E();i.addStyleClass("sapUiCompFilterBarPaddingForm");i.setColumnsL(3);i.setColumnsM(2);var j=new F({editable:true});j.setLayout(i);return j;};K.prototype._addControlToBasicAreaFormContainer=function(i){var j=i.getControl();if(!j){q.sap.log.error("no Control obtained");return null;}var n=i.getLabelControl(this.getId());if(!n){q.sap.log.error("no Label obtained");return null;}this._adaptGroupTitleForFilter(i);return this._addControlToBasicAreaContainer(i,j,n);};K.prototype._addControlToBasicAreaContainer=function(i,j,n){var N=new y();N.setLayoutData(new x({margin:true}));if(i._iSpan&&i._iSpan>1){var W=parseInt(this.getFilterContainerWidth(),10),U=this.getFilterContainerWidth().replace(""+W,"");W=(W*i._iSpan)+1;N.setWidth(W+U);}else{N.setWidth(this.getFilterContainerWidth());}if(n){N.addContent(n);var O=null;if(this.getConditionTypeByKey){O=this.getConditionTypeByKey(i.getName());}if(O){O.setLabel(n);}else if(n.setLabelFor){n.setLabelFor(j);}}N.addContent(j);N.addStyleClass("sapUiCompFilterBarPaddingRight");N.addStyleClass("sapUiCompFilterBarPaddingTop");if(!this.getAdvancedMode()){if(i&&i.getVisible()&&i.getVisibleInFilterBar()){this._oBasicAreaLayout.addContent(N);}}return N;};K.prototype._rerenderAA=function(){this._oAdvancedAreaForm.removeAllFormContainers();var i=this._flattenMap();this._layOutAA(i);};K.prototype._layOutAA=function(i){if(this._mAdvancedAreaFilter&&Object.keys(this._mAdvancedAreaFilter).length>1){this._layOutAAMultipleGroup(i);}else{this._layOutAASingleGroup(i);}};K.prototype._layOutAAMultipleGroup=function(n){var i,j,N=0;var O=null;for(i=0;i<n.length;i++){if(n[i].control===null){N++;}}var Q=this._oAdvancedAreaForm.getLayout();if(Q){if(N>=3){Q.setLabelSpanL(5);Q.setLabelSpanM(5);Q.setColumnsL(3);Q.setColumnsM(2);}else if(N===2){Q.setLabelSpanL(4);Q.setLabelSpanM(5);Q.setColumnsL(2);Q.setColumnsM(2);}else if(N===1){Q.setLabelSpanL(4);Q.setLabelSpanM(5);Q.setColumnsL(2);Q.setColumnsM(2);}}for(i=0;i<n.length;i++){if(n[i].control===null){O=new z();if(Object.keys(this._mAdvancedAreaFilter).length>1){O.setTitle(n[i].filterItem.getGroupTitle());}this._oAdvancedAreaForm.addFormContainer(O);j=i+1;while(j<n.length&&(n[j].control)){this._addControlToAdvancedArea(n[j].filterItem,n[j].control,O);j++;}i=j-1;}}if(N===1){this._oAdvancedAreaForm.addFormContainer(new z());}};K.prototype._layOutAASingleGroup=function(j){var i,n,N,O;var Q=j.length-1;var U=Q>2?2:1;if(U>1){N=Math.floor(Q/U);O=((N*U)<Q);for(i=1;i<U;i++){n=i*N;if(O){++n;}if((n+i)<j.length){j.splice(n+i,0,j[0]);}}}this._layOutAAMultipleGroup(j);};K.prototype._flattenMap=function(){var n=null,i;var j=[];var N;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n&&this._mAdvancedAreaFilter[n].items){N=false;for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){var O=this._mAdvancedAreaFilter[n].items[i];if(O.filterItem&&O.filterItem.getVisibleInFilterBar()&&O.filterItem.getVisible()){if(!N){N=true;j.push({control:null,filterItem:this._mAdvancedAreaFilter[n].filterItem});}j.push({control:O.control,filterItem:O.filterItem});}}}}}return j;};K.prototype._triggerSearchByValue=function(j){var i,n,N;var O;var Q;j=j.replace(/^\s+|\s+$/g,"").toLowerCase();if(this._aListItems){var U=0;for(i=this._aListItems.length-1;i>=0;i--){O=this._aListItems[i].getContent();if(O&&(O.length>0)){n=O[0].getText();N=this._aListItems[i].data("quickinfo");if((n.toLowerCase().indexOf(j)>=0||(N&&N.toLowerCase().indexOf(j)>=0))||(this._aListItems[i].hasStyleClass("sapUiCompFilterBarGroupListItem")&&U>0)){Q=true;if(this._aListItems[i].hasStyleClass("sapUiCompFilterBarGroupListItem")){if(!U){Q=false;}}else{U++;}this._aListItems[i].setVisible(Q);}else{this._aListItems[i].setVisible(false);}}}}};K.prototype._triggerSearch=function(i){if(!i){return;}var j=i.getParameters();if(!j){return;}var n=j.newValue?j.newValue:"";this._triggerSearchByValue(n);};K.prototype._triggerSearchByValueInFilterDialog=function(j){var n=null,i;var N,O;var Q,U;var W;var X;var Y=true;j=j.replace(/^\s+|\s+$/g,"").toLowerCase();if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){Q=this._mAdvancedAreaFilter[n];if(Q&&Q.items){W=0;X=0;for(i=0;i<Q.items.length;i++){if(Q.items[i]&&Q.items[i].filterItem&&Q.items[i].formelement){U=Q.items[i].filterItem;if(U.getVisible()){if(j){N=U.getLabel();O=U.getLabelTooltip();if((N.toLowerCase().indexOf(j)>=0||(O&&O.toLowerCase().indexOf(j)>=0))){if(U.getPartOfCurrentVariant()){Q.items[i].formelement.setVisible(true);}else{++X;}}else{++W;Q.items[i].formelement.setVisible(false);}}else{Q.items[i].formelement.setVisible(U.getVisibleInFilterBar()||U.getPartOfCurrentVariant());if(Q.link&&!Q.link.getVisible()){Q.link.setVisible(true);}}}else{++W;}}}if(Q&&Q.formcontainer){if(W===Q.items.length){Q.formcontainer.setVisible(false);}else{Y=false;Q.formcontainer.setVisible(true);if(Q.link){Q.link.setVisible((j&&(X===0))?false:true);if(j&&(X>0)){this._setLinkTextAndCount(n,Q.link,X);}else{this._setLinkText(n,Q.link);}}}}}}}}if(this._oAddToFilterBarLabel){this._oAddToFilterBarLabel.setVisible(!Y);}};K.prototype._triggerSearchInFilterDialog=function(i){if(!i){return;}var j=i.getParameters();if(!j){return;}var n=j.newValue?j.newValue:"";this._sSearchCriteriaInFiltersDialog=n;this._triggerSearchByValueInFilterDialog(n);};K.prototype._generateListItems=function(j,n){q.sap.require("sap.m.CustomListItem");var i;var N,O;var Q;var U=false;if(this.$().closest(".sapUiSizeCompact").length>0){U=true;}if(j&&this._mAdvancedAreaFilter){O=this._mAdvancedAreaFilter[j];if(O&&O.items){for(i=0;i<O.items.length;i++){var W=O.items[i];if(W&&W.filterItem){if(!W.filterItem.getVisible()){continue;}N=new sap.m.CustomListItem();N.setVisible(true);if(!U){N.addStyleClass("sapUiCompFilterBarListItem");}else{N.addStyleClass("sapUiCompFilterBarListItemCompact");}N.data("quickinfo",W.filterItem.getLabelTooltip());W.initialPartOfCurrentVariant=W.filterItem.getPartOfCurrentVariant();N.data('item',W);Q=new L({text:W.filterItem.getLabel(),tooltip:W.filterItem.getLabelTooltip()});N.addContent(Q);n.addItem(N);if(W.filterItem.getPartOfCurrentVariant()){n.setSelectedItem(N);}if(((W.filterItem.getMandatory()&&W.checkbox&&!W.checkbox.getEnabled())||W.filterItem.getVisibleInFilterBar())){N.getModeControl().setEnabled(false);}}}}}var X=this;n.attachSelectionChange(function(Y){if(Y){var Z=Y.getParameters();if(Z){var N=Z.listItem;if(N){var $=N.getModeControl();var W=N.data('item');X._selectionChangedInAddFiltersDialog($,W);}}}});};K.prototype._rerenderItem=function(i){var j;if(i){j=i.filterItem.getVisible()&&i.filterItem.getVisibleInFilterBar();if(i.container){i.container.setVisible(j);if(j){this._addContainer(i);}}if(i.formelement){i.formelement.setVisible(i.filterItem.getVisible()&&(i.filterItem.getVisibleInFilterBar()||i.filterItem.getPartOfCurrentVariant()));if(i.checkbox){i.checkbox.setSelected(i.filterItem.getVisibleInFilterBar());}}}};K.prototype._rerenderFilters=function(){var i;var n=null;var j=null;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n&&this._mAdvancedAreaFilter[n]&&this._mAdvancedAreaFilter[n].items){for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){j=this._mAdvancedAreaFilter[n].items[i];this._rerenderItem(j);}}}}this._updateToolbarText();};K.prototype.rerenderFilters=function(){this._rerenderFilters();};K.prototype._closeAddRemoveFiltersDialog=function(i,j){if(i&&j){if(this._sSearchCriteriaInFiltersDialog&&this._oFilterDialog){this._triggerSearchByValueInFilterDialog(this._sSearchCriteriaInFiltersDialog);}else{this._setLinkText(i,j);}}};K.prototype._cancelAddRemoveFiltersDialog=function(j){var i;var n;if(j&&this._mAdvancedAreaFilter&&this._mAdvancedAreaFilter[j]&&this._mAdvancedAreaFilter[j].items){for(i=0;i<this._mAdvancedAreaFilter[j].items.length;i++){n=this._mAdvancedAreaFilter[j].items[i];if(n.initialPartOfCurrentVariant!==undefined&&n.filterItem){if(n.filterItem.getPartOfCurrentVariant()!==n.initialPartOfCurrentVariant){n.filterItem.setPartOfCurrentVariant(n.initialPartOfCurrentVariant);this._rerenderItem(n);this._notifyAboutChangedFilters(n.initialPartOfCurrentVariant,n.control);}}}}if(this._oVariantManagement&&(this._oVariant.modified2!==undefined)){this._oVariantManagement.currentVariantSetModified(this._oVariant.modified2);}};K.prototype._createAddRemoveFiltersDialog=function(j,n){q.sap.require("sap.m.Dialog");q.sap.require("sap.m.ListMode");var i,N=this;if(!j){return;}this._oDialog=new sap.m.Dialog({stretch:D.system.phone});this._oDialog.addStyleClass("sapUiPopupWithPadding");this._oDialog.addStyleClass("sapUiCompAddRemoveFilterDialog");if(this.$().closest(".sapUiSizeCompact").length>0){this._oDialog.addStyleClass("sapUiSizeCompact");}this._oDialog.setTitle(this._oRb.getText("SELECT_FILTER_FIELDS"));this._oDialog.addStyleClass("sapMH4FontSize");this._oDialog.addStyleClass("sapMH4Style");this._oDialog.setVerticalScrolling(true);var O=new B();var Q=new S({placeholder:this._oRb.getText("FILTER_BAR_SEARCH")});this._oSearchField=Q;Q.attachLiveChange(function(Y){N._triggerSearch(Y);});O.addContentRight(Q);this._oDialog.setSubHeader(O);var U=new e({mode:sap.m.ListMode.MultiSelect});U.setShowSeparators(f.None);this._oDialog.addContent(U);this._generateListItems(j,U);this._aListItems=U.getItems();for(i=0;i<this._aListItems.length;i++){U.addItem(this._aListItems[i]);}if(this._oVariant&&this._oVariantManagement){this._oVariant.modified2=this._oVariantManagement.currentVariantGetModified();}this._bOKButtonAddRemoveFilterDialogTriggered=false;var W=new a(this.getId()+"-btnOKAddRemoveDialog",{text:this._oRb.getText("FILTER_BAR_OK")});W.attachPress(function(){N._bOKButtonAddRemoveFilterDialogTriggered=true;N._oDialog.close();});this._oDialog.addAggregation("buttons",W);this._oDialog.setInitialFocus(this._oSearchField);this._oDialog.setContentHeight("23.25rem");if(this._sSearchCriteriaInFiltersDialog){this._oSearchField.setValue(this._sSearchCriteriaInFiltersDialog);this._triggerSearchByValue(this._sSearchCriteriaInFiltersDialog);}var X=new a(this.getId()+"-btnCancelAddRemoveDialog",{text:this._oRb.getText("FILTER_BAR_CANCEL"),press:function(){N._oDialog.close();}});this._oDialog.addAggregation("buttons",X);this._oDialog.attachBeforeClose(function(){if(!N._bOKButtonAddRemoveFilterDialogTriggered){N._cancelAddRemoveFiltersDialog(j);}N._closeAddRemoveFiltersDialog(j,n);});this._oDialog.attachAfterClose(function(){this._aListItems=null;N._oDialog.destroy();N._oDialog=null;});this._oDialog.open();};K.prototype._selectionChangedInAddFiltersDialog=function(i,j){var n=i.getSelected();if(!n&&((j.filterItem.getMandatory()&&!j.checkbox.getEnabled())||j.filterItem.getVisibleInFilterBar())){i.setSelected(true);return;}j.filterItem.setPartOfCurrentVariant(n);this._rerenderItem(j);this._notifyAboutChangedFilters(n,j.control);};K.prototype._setTriggerFilterChangeState=function(i){this._triggerFilterChangeState=i;};K.prototype._getTriggerFilterChangeState=function(){return this._triggerFilterChangeState;};K.prototype._setConsiderFilterChanges=function(i){this._filterChangeSemaphore=i;};K.prototype._getConsiderFilterChanges=function(){return this._filterChangeSemaphore;};K.prototype.fireFilterChange=function(i){this._updateToolbarText();if(!this._getTriggerFilterChangeState()){return;}if(this._getConsiderFilterChanges()&&this._oVariantManagement&&this._oVariantManagement.getEnabled()){this._oVariantManagement.currentVariantSetModified(true);}if(this._oFilterDialog&&!(this._oFilterDialog.isOpen())){return;}this._bDirtyViaDialog=true;this.fireEvent("filterChange",i);};K.prototype._notifyAboutChangedFilters=function(i,j){var O;if(i){O={"added":j};}else{O={"deleted":j};}this.fireFilterChange(O);};K.prototype._determineVariantFiltersInfo=function(j,N){var i;var n=null,O,Q;var U=[];if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){if(this._mAdvancedAreaFilter[n].items){for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){O=this._mAdvancedAreaFilter[n].items[i];if(j||O.filterItem.getVisible()){Q={group:O.filterItem.getGroupName(),name:O.filterItem.getName(),partOfCurrentVariant:O.filterItem.getPartOfCurrentVariant(),visibleInFilterBar:O.filterItem.getVisibleInFilterBar()};if(N||this._considerFilter(Q)){U.push(Q);}}}}}}}return U;};K.prototype.mergeVariant=function(i,j){var n={};q.extend(true,n,j);n.filterbar=[];n.filterBarVariant={};q.extend(true,n.filterbar,i.filterbar);q.extend(true,n.filterBarVariant,i.filterBarVariant);if(j&&j.version==="V2"){n.filterbar=this._mergeVariantFields(n.filterbar,j.filterbar);n.filterBarVariant=j.filterBarVariant;}return n;};K.prototype._mergeVariantFields=function(j,n){var i;n.forEach(function(N){for(i=0;i<j.length;i++){if((j[i].group===N.group)&&(j[i].name===N.name)){j.splice(i,1);break;}}});return j.concat(n);};K.prototype._isUi2Mode=function(){if(this._oVariantManagement instanceof p){return true;}return false;};K.prototype._isDeltaHandling=function(){if(this._isUi2Mode()){return false;}return this.getDeltaVariantMode();};K.prototype._getStandardVariant=function(){return this._oVariantManagement.getStandardVariant(this);};K.prototype._considerFilter=function(j){if(!this._isDeltaHandling()){return true;}var n=null;var N=this._getStandardVariant();if(N&&N.filterbar){for(var i=0;i<N.filterbar.length;i++){if((N.filterbar[i].group===j.group)&&(N.filterbar[i].name===j.name)){n=N.filterbar[i];break;}}}if(!n){if(!j.partOfCurrentVariant){return false;}return true;}if((n.partOfCurrentVariant!==j.partOfCurrentVariant)||(n.visibleInFilterBar!==j.visibleInFilterBar)){return true;}return false;};K.prototype._addControlToAdvancedArea=function(i,j,n){var N=new A({label:i.getLabelControl(this.getId()),fields:[(j!==null)?j:new T()]});n.addFormElement(N);};K.prototype._determineVisibility=function(i){var j=false;if(i){j=i.getVisible()&&(i.getVisibleInFilterBar()||i.getPartOfCurrentVariant());}return j;};K.prototype._retrieveVisibleAdvancedItems=function(){var i,n=null,j;var N=[];if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){if(this._mAdvancedAreaFilter[n]&&this._mAdvancedAreaFilter[n].items){for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){j=this._mAdvancedAreaFilter[n].items[i];if(j){if(this._determineVisibility(j.filterItem)){N.push(j);}}}}}}}return N;};K.prototype._retrieveCurrentSelectionSet=function(){var i;var j=[];var n=this._retrieveVisibleAdvancedItems();for(i=0;i<n.length;i++){if(n[i].control){j.push(n[i].control);}}return j;};K.prototype.search=function(){var i={};i.selectionSet=this._retrieveCurrentSelectionSet();this.fireSearch(i);return true;};K.prototype.clear=function(){var i={};i.selectionSet=this._retrieveCurrentSelectionSet();this._clearErrorState();this.fireClear(i);this._updateToolbarText();};K.prototype.reset=function(){var i={};i.selectionSet=this._retrieveCurrentSelectionSet();this.fireReset(i);this._resetVariant();};K.prototype._resetVariant=function(){var i=null;if(this._oVariantManagement){var j=this._oVariantManagement.getSelectionKey();if(j){i=this._oVariantManagement.getVariantContent(this,j);if(this._oVariant){this._oVariant.content=i;this._oVariant.modified=false;}if(i){this.applyVariant(i,"RESET");}}}this._resetFilterBarSearch();};K.prototype._resetFilterBarSearch=function(){this._sSearchCriteriaInFiltersDialog="";this._oFiltersSearchField.setValue(this._sSearchCriteriaInFiltersDialog);this._triggerSearchByValueInFilterDialog(this._sSearchCriteriaInFiltersDialog);};K.prototype._applyVariant=function(i,j,n){var N=null;var O;var Q,U=false;if(i){if(n){Q=this._getTriggerFilterChangeState();this._setTriggerFilterChangeState(false);}this._setConsiderFilterChanges(false);O=i.filterBarVariant;N=i.filterbar;this._applyVariantFields(O);this._ensureFilterLoaded(N);this._reapplyVisibility(N);if(this._oBasicSearchField&&this._oBasicSearchField.setValue){this._oBasicSearchField.setValue(""||i.basicSearch);}this.fireAfterVariantLoad(j);this._setConsiderFilterChanges(true);this._updateToolbarText();if(i.executeOnSelection){U=i.executeOnSelection;}if(U){this.search();}else{this._clearErrorState();}if(n){this._setTriggerFilterChangeState(Q);}}};K.prototype._fetchVariantFiltersData=function(){if(this._fRegisteredFetchData){try{return this._fRegisteredFetchData();}catch(i){q.sap.log.error("callback for fetching data throws an exception");}}else{q.sap.log.warning("no callback for fetch data supplied");}return null;};K.prototype._applyVariantFields=function(j){if(this._fRegisteredApplyData){try{return this._fRegisteredApplyData(j);}catch(i){q.sap.log.error("callback for applying data throws an exception");}}else{q.sap.log.warning("no callback for appy data supplied");}};K.prototype._isStandardVariant=function(){var i=this.getCurrentVariantId();if(!i){return true;}if(this._oVariantManagement&&(i===this._oVariantManagement.getStandardVariantKey())){return true;}return false;};K.prototype.fetchVariant=function(i){var j;var n={};if(this._isDeltaHandling()){if(!this._isStandardVariant()){n.version="V2";}}this.fireBeforeVariantFetch();j=this._determineVariantFiltersInfo(i,!n.version);n.filterbar=(!j)?[]:j;n.filterBarVariant=this._fetchVariantFiltersData();if(this._oBasicSearchField&&this._oBasicSearchField.getValue){n.basicSearch=this._oBasicSearchField.getValue();}if(this._oVariant&&this._oVariant.content){this._oVariant.content=n;}return n;};K.prototype.applyVariant=function(i,j,n){if(i.version==="V2"){i=this.mergeVariant(this._getStandardVariant(),i,j);}this._applyVariant(i,j,n);};K.prototype.determineMandatoryFilterItems=function(){var i;var j=[];var n=this._retrieveVisibleAdvancedItems();for(i=0;i<n.length;i++){if(n[i].filterItem.getMandatory()===true){if(n[i].control){j.push(n[i].filterItem);}}}return j;};K.prototype.determineControlByFilterItem=function(j){var i,n=null;var N,O;if(this._aBasicAreaSelection){for(i=0;i<this._aBasicAreaSelection.length;i++){N=this._aBasicAreaSelection[i];if(j===N.filterItem){return N.control;}}}if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){O=this._mAdvancedAreaFilter[n];if(O&&O.items){for(i=0;i<O.items.length;i++){N=O.items[i];if(j===N.filterItem){return N.control;}}}}}}return null;};K.prototype.determineControlByName=function(n,i){if(i){this._ensureFilterLoaded([{name:n,group:i}]);}var j=this._determineItemByName(n,i);if(j){return j.control;}return null;};K.prototype._determineItemByName=function(n,j){var i;var N,O;var Q=j;if(!n){return null;}if(!Q){Q=K.INTERNAL_GROUP;}if(this._mAdvancedAreaFilter){O=this._mAdvancedAreaFilter[Q];if(O&&O.items){for(i=0;i<O.items.length;i++){N=O.items[i];if(N&&N.filterItem&&(N.filterItem.getName()===n)){return N;}}}}return null;};K.prototype.determineFilterItemByName=function(N){var n,i;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){i=this._determineItemByName(N,n);if(i){return i.filterItem;}}}return null;};K.prototype._determineByFilterGroupItem=function(j){var i,n=j.getGroupName();if(this._mAdvancedAreaFilter&&this._mAdvancedAreaFilter[n]){var N=this._mAdvancedAreaFilter[n];if(N&&N.items){for(i=0;i<N.items.length;i++){if(N.items[i]&&N.items[i].filterItem===j){return N.items[i];}}}}return null;};K.prototype._determineByControl=function(j){var n=null,i;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){var N=this._mAdvancedAreaFilter[n];if(N&&N.items){for(i=0;i<N.items.length;i++){if(N.items[i]&&N.items[i].control===j){return N.items[i];}}}}}}return null;};K.prototype._deleteProperties=function(){var n=null,i;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){var j=this._mAdvancedAreaFilter[n];if(j&&j.items){if(j.formcontainer){delete j.formcontainer;}if(j.link){delete j.link;}for(i=0;i<j.items.length;i++){if(j.items[i]&&j.items[i].checkbox){delete j.items[i].checkbox;}if(j.items[i]&&j.items[i].formelement){delete j.items[i].formelement;}}}}}}};K.prototype._fHandleResize=function(){if(!this._isPhone()&&this._oFilterDialog&&this._mAdvancedAreaFilter){this._repositionAddToFilterBarLabel();}};K.prototype.onAfterRendering=function(){this._fHandleResize();};K.prototype._destroyLazyFilterControl=function(){var j,i;if(this._aFields&&(this._aFields.length>0)){if(this._aFields&&this._aFields.length>0){for(j=0;j<this._aFields.length;j++){i=this._aFields[j];if(i.factory){if(i.control){i.control.destroy();}}}}}};K.prototype._destroyNonVisibleFilterControl=function(){var i,n,j;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n&&this._mAdvancedAreaFilter[n]&&this._mAdvancedAreaFilter[n].items){for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){j=this._mAdvancedAreaFilter[n].items[i];if(j&&j.container){if(this._oBasicAreaLayout&&(this._oBasicAreaLayout.indexOfContent(j.container)<0)){if(j.control&&!j.bDestroyed){j.control.destroy();j.bDestroyed=true;}}}}}}}};K.prototype._destroyFilterControls=function(){if(!this.getAdvancedMode()){this._destroyLazyFilterControl();this._destroyNonVisibleFilterControl();}};K.prototype.destroy=function(){q(window).off("resize.basicsearch");if(this._oVariantManagement){if(this._fInitialiseVariants){this._oVariantManagement.detachInitialise(this._fInitialiseVariants);this._fInitialiseVariants=null;}if(this._fSaveVariant){this._oVariantManagement.detachSave(this._fSaveVariant);this._fSaveVariant=null;}if(this._fAfterSaveVariant){this._oVariantManagement.detachSave(this._fAfterSaveVariant);this._fAfterSaveVariant=null;}}this._destroyFilterControls();G.prototype.destroy.apply(this,arguments);if(this._oDialog){this._oDialog.destroy();this._oDialog=null;}if(this._oFilterDialog){this._oFilterDialog.destroy();this._oFilterDialog=null;}this._aFields=null;this._oHintText=null;this._aBasicAreaSelection=null;this._mAdvancedAreaFilter=null;this._oBasicAreaLayout=null;this._oVariantManagement=null;this._oCollectiveSearch=null;this._oVariant=null;this._fRegisteredFetchData=null;this._fRegisteredApplyData=null;this._fRegisterGetFiltersWithValues=null;this._fRegisteredFilterChangeHandlers=null;this._oSearchButton=null;this._oFiltersButton=null;this._oHideShowButton=null;this._oClearButtonOnFB=null;this._oRestoreButtonOnFB=null;this._oAddToFilterBarLabel=null;this._oBasicSearchField=null;};return K;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.filterbar.FilterGroupItem')){
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.ui.comp.filterbar.FilterGroupItem');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.m.Label');jQuery.sap.require('sap.ui.core.TooltipBase');sap.ui.define("sap/ui/comp/filterbar/FilterGroupItem",['jquery.sap.global','sap/m/Label','./FilterItem','sap/ui/comp/library','sap/ui/core/TooltipBase'],function(q,L,F,l,T){"use strict";var a=F.extend("sap.ui.comp.filterbar.FilterGroupItem",{metadata:{library:"sap.ui.comp",properties:{groupTitle:{type:"string",group:"Misc",defaultValue:null},groupName:{type:"string",group:"Misc",defaultValue:null},visibleInAdvancedArea:{type:"boolean",group:"Misc",defaultValue:false}}}});a.prototype.init=function(){this.setVisibleInAdvancedArea(false);};a.prototype.setGroupTitle=function(v){this.setProperty("groupTitle",v);this.fireChange({propertyName:"groupTitle"});};a.prototype.setVisibleInAdvancedArea=function(v){this.setVisibleInFilterBar(v);};a.prototype.getVisibleInAdvancedArea=function(){return this.getVisibleInFilterBar();};a.prototype.destroy=function(){F.prototype.destroy.apply(this,arguments);};return a;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.personalization.Controller')){
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.ui.comp.personalization.Controller');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.ManagedObject');sap.ui.define("sap/ui/comp/personalization/Controller",['jquery.sap.global','sap/ui/base/ManagedObject','./ColumnsController','./FilterController','./GroupController','./SortController','./DimeasureController','./Util','sap/ui/comp/library','./ChartWrapper'],function(q,M,C,F,G,S,D,U,a,b){"use strict";var c=M.extend("sap.ui.comp.personalization.Controller",{constructor:function(i,s){M.apply(this,arguments);},metadata:{publicMethods:["setPersonalizationData"],properties:{setting:{type:"object",defaultValue:null},resetToInitialTableState:{type:"boolean",defaultValue:true}},associations:{table:{type:"object",multiple:false}},events:{beforePotentialTableChange:{},afterPotentialTableChange:{},afterP13nModelDataChange:{parameters:{changeReason:{type:"sap.ui.comp.personalization.ResetType"},persistentData:{type:"object"},changeData:{type:"object"},changeType:{type:"sap.ui.comp.personalization.ChangeType"},changeTypeVariant:{type:"sap.ui.comp.personalization.ChangeType"}}}},library:"sap.ui.comp"}});c.prototype.setSetting=function(s){s=this.validateProperty("setting",s);this.setProperty("setting",s,true);if(!s){return this;}if(!this.getTable()){this._bSettingPending=true;return this;}this._mergeSettingCurrentBy(s);this._removeUnsupportedNamespaces();this._checkIgnoredColumnKeys();this._masterSync(c.SyncReason.NewSetting,null);return this;};c.prototype._mergeSettingCurrentBy=function(s){for(var t in s){if(s[t].visible===false){delete this._oSettingCurrent[t];continue;}if(this._oSettingCurrent[t]&&this._oSettingCurrent[t].visible===true){this._oSettingCurrent[t].controller=s[t].controller?s[t].controller:this._oSettingCurrent[t].controller;this._oSettingCurrent[t].payload=s[t].payload?s[t].payload:undefined;this._oSettingCurrent[t].ignoreColumnKeys=s[t].ignoreColumnKeys?s[t].ignoreColumnKeys:[];this._oSettingCurrent[t].triggerModelChangeOnColumnInvisible=s[t].triggerModelChangeOnColumnInvisible?s[t].triggerModelChangeOnColumnInvisible:undefined;}else{this._oSettingCurrent[t]={visible:s[t].visible,controller:s[t].controller?s[t].controller:undefined,payload:s[t].payload?s[t].payload:undefined,ignoreColumnKeys:s[t].ignoreColumnKeys?s[t].ignoreColumnKeys:[],triggerModelChangeOnColumnInvisible:s[t].triggerModelChangeOnColumnInvisible?s[t].triggerModelChangeOnColumnInvisible:undefined};}}};c.prototype._mixSetting=function(s,o){if(!o){return s;}for(var t in o){if(o[t].visible&&s[t]&&s[t].visible){o[t].controller=s[t].controller;o[t].payload=o[t].payload?o[t].payload:s[t].payload;}}return o;};c.prototype.setTable=function(t){this.setAssociation("table",t);if(!t){return this;}if(t instanceof b){this._oSettingCurrent=U.copy(this._oSettingOriginalChart);}else{this._oSettingCurrent=U.copy(this._oSettingOriginalTable);}if(this._bSettingPending){this._bSettingPending=false;this._mergeSettingCurrentBy(this.getSetting());}this._oInitialVisiblePanelType=this._getInitialVisiblePanelType();this._removeUnsupportedNamespaces();this._checkIgnoredColumnKeys();if(!U.isConsistent(this.getTable().getColumns())){throw"The table instance provided contain some columns for which a columnKey is provided, some for which a columnKey is not provided. This is not allowed ! ";}this._masterSync(c.SyncReason.NewTable,null);return this;};c.prototype.getTable=function(){var t=this.getAssociation("table");if(typeof t==="string"){t=sap.ui.getCore().byId(t);}return t;};c.prototype.getModel=function(){return this._oModel;};c.prototype.init=function(){var t=this;this._oDialog=null;this._oPayload=null;this._oPersistentDataRestore=null;this._oPersistentDataCurrentVariant=null;this._oPersistentDataAlreadyKnown=null;this._oPersistentDataBeforeOpen=null;this._oModel=null;this._aColumnKeysOfDateType=[];this._bSettingPending=false;this._aColumnKeysOfBooleanType=[];this._aColumnKeysOfTimeType=[];this._oSettingOriginalTable={columns:{controller:new C({afterColumnsModelDataChange:function(e){t._fireChangeEvent();},beforePotentialTableChange:function(e){t.fireBeforePotentialTableChange();},afterPotentialTableChange:function(e){t.fireAfterPotentialTableChange();}}),visible:true},sort:{controller:new S({afterSortModelDataChange:function(e){t._fireChangeEvent();},beforePotentialTableChange:function(e){t.fireBeforePotentialTableChange();},afterPotentialTableChange:function(e){t.fireAfterPotentialTableChange();}}),visible:true},filter:{controller:new F({afterFilterModelDataChange:function(e){t._fireChangeEvent();},beforePotentialTableChange:function(e){t.fireBeforePotentialTableChange();},afterPotentialTableChange:function(e){t.fireAfterPotentialTableChange();}}),visible:true},group:{controller:new G({afterGroupModelDataChange:function(e){t._fireChangeEvent();},beforePotentialTableChange:function(e){t.fireBeforePotentialTableChange();},afterPotentialTableChange:function(e){t.fireAfterPotentialTableChange();}}),visible:true}};this._oSettingOriginalChart={dimeasure:{controller:new D({afterDimeasureModelDataChange:function(e){t._fireChangeEvent();},beforePotentialTableChange:function(e){t.fireBeforePotentialTableChange();},afterPotentialTableChange:function(e){t.fireAfterPotentialTableChange();}}),visible:true},sort:{controller:new S({afterSortModelDataChange:function(e){t._fireChangeEvent();},beforePotentialTableChange:function(e){t.fireBeforePotentialTableChange();},afterPotentialTableChange:function(e){t.fireAfterPotentialTableChange();}}),visible:true},filter:{controller:new F({afterFilterModelDataChange:function(e){t._fireChangeEvent();},beforePotentialTableChange:function(e){t.fireBeforePotentialTableChange();},afterPotentialTableChange:function(e){t.fireAfterPotentialTableChange();}}),visible:true}};};c.prototype.openDialog=function(s){this._masterSync(c.SyncReason.NewTableBinding,null);this._oDialog=new sap.m.P13nDialog({stretch:sap.ui.Device.system.phone,showReset:true,initialVisiblePanelType:this._oInitialVisiblePanelType,validationExecutor:q.proxy(this._handleDialogValidate,this)});this._oDialog.toggleStyleClass("sapUiSizeCompact",!!q(this.getTable().getDomRef()).closest(".sapUiSizeCompact").length);var o=this._mixSetting(this._oSettingCurrent,s);var p=this._callControllers(o,"getPanel");for(var t in o){if(p[t]){this._oDialog.addPanel(p[t]);}}this._oPersistentDataBeforeOpen=this._getPersistentDataCopy();this._oDialog.attachOk(this._handleDialogOk,this);this._oDialog.attachCancel(this._handleDialogCancel,this);this._oDialog.attachReset(this._handleDialogReset,this);this._oDialog.attachAfterClose(this._handleDialogAfterClose,this);this._oDialog.open();};sap.ui.comp.personalization.Controller.prototype._getSettingOfPanels=function(){if(!this._oDialog||!this._oDialog.getPanels()){return{};}var s={};this._oDialog.getPanels().forEach(function(p){var t=p.getType();s[t]={controller:this._oSettingCurrent[t].controller,visible:this._oSettingCurrent[t].visible};},this);return s;};c.prototype._getPersistentDataCopy=function(){var p={};if(this.getModel()&&this.getModel().getData().persistentData){p=U.copy(this.getModel().getData().persistentData);}return p;};c.prototype.setPersonalizationData=function(n){if(!this._sanityCheck(n)){return;}this._masterSync(c.SyncReason.NewModelDataVariant,n);if(this.getTable()&&this.getTable().setFixedColumnCount){this.getTable().setFixedColumnCount(0);}this._fireChangeEvent();};c.prototype.setChartType=function(s){};c.prototype.resetPersonalization=function(r){var R=this.getResetToInitialTableState();if(r===sap.ui.comp.personalization.ResetType.ResetFull||r===sap.ui.comp.personalization.ResetType.ResetPartial){R=(r===sap.ui.comp.personalization.ResetType.ResetFull);}if(R){this._masterSync(c.SyncReason.ResetModelData,null);this._fireChangeEvent(sap.ui.comp.personalization.ResetType.ResetFull);}else{this._masterSync(c.SyncReason.ResetModelDataVariant,null);this._fireChangeEvent(sap.ui.comp.personalization.ResetType.ResetPartial);}};c.prototype._handleDialogReset=function(e){if(this.getResetToInitialTableState()){this._masterSync(c.SyncReason.ResetModelData,null);}else{this._masterSync(c.SyncReason.ResetModelDataVariant,null);}var r=this._getSettingOfPanels();this._callControllers(r,"onAfterReset",e.getParameter("payload"));};c.prototype._handleDialogCancel=function(e){this._oDialog.detachCancel(this._handleDialogCancel,this);this._oDialog.close();};c.prototype._handleDialogOk=function(e){this._oDialog.detachOk(this._handleDialogOk,this);this._oPayload={trigger:"ok",payload:e.getParameter("payload")};this._oDialog.close();};c.prototype._handleDialogValidate=function(p){var s=this._getSettingOfPanels();var P=this._callControllers(s,"getUnionData",U.copy(this._oPersistentDataRestore),this._getPersistentDataCopy());return sap.ui.comp.personalization.Util.validate(s,p,this.getTable(),P);};c.prototype._getInitialVisiblePanelType=function(){for(var t in this._oSettingCurrent){return t;}};c.prototype._handleDialogAfterClose=function(){var t=this;var _=this._oPayload;this._oInitialVisiblePanelType=this._oDialog.getVisiblePanel()?this._oDialog.getVisiblePanel().getType():this._getInitialVisiblePanelType();if(_&&_.trigger==="ok"){setTimeout(function(){var s=t._getSettingOfPanels();if(t._oDialog){t._oDialog.destroy();t._oDialog=null;}t._callControllers(s,"onAfterSubmit",t._oPayload.payload);t._oPayload=null;t._fireChangeEvent();t._oPersistentDataBeforeOpen=null;},0);}else{setTimeout(function(){if(t._oDialog){t._oDialog.destroy();t._oDialog=null;}t._masterSync(c.SyncReason.NewModelData,t._oPersistentDataBeforeOpen);t._oPersistentDataBeforeOpen=null;},0);}};c.prototype._masterSync=function(u,n){var t=null,j=null;switch(u){case c.SyncReason.NewTableBinding:this._callControllers(this._oSettingCurrent,"syncTable2TransientModel");break;case c.SyncReason.NewTable:this.initializeModel();this._callControllers(this._oSettingCurrent,"setTable",this.getTable());this._setSizeLimit(this.getTable());this._callControllers(this._oSettingCurrent,"syncTable2TransientModel");this._callControllers(this._oSettingCurrent,"createTableRestoreJson");this._callControllers(this._oSettingCurrent,"syncTable2PersistentModel");j=this._callControllers(this._oSettingCurrent,"getTableRestoreJson");this._oPersistentDataRestore=U.copy(j);this._oPersistentDataCurrentVariant={};this._aColumnKeysOfDateType=[];this._aColumnKeysOfTimeType=[];this._aColumnKeysOfBooleanType=[];this._oPersistentDataAlreadyKnown=U.copy(this._oPersistentDataRestore);break;case c.SyncReason.NewSetting:this.initializeModel();if(this.getTable()){this._callControllers(this._oSettingCurrent,"setTable",this.getTable());this._setSizeLimit(this.getTable());}this._callControllers(this._oSettingCurrent,"setIgnoreColumnKeys");this._callControllers(this._oSettingCurrent,"setTriggerModelChangeOnColumnInvisible");this._callControllers(this._oSettingCurrent,"syncTable2TransientModel");this._callControllers(this._oSettingCurrent,"createTableRestoreJson");this._callControllers(this._oSettingCurrent,"syncTable2PersistentModel");j=this._callControllers(this._oSettingCurrent,"getTableRestoreJson");this._oPersistentDataRestore=U.copy(j);this._oPersistentDataAlreadyKnown=U.copy(this._oPersistentDataRestore);for(t in this._oPersistentDataRestore){if(!this._oSettingCurrent[t]){delete this._oPersistentDataRestore[t];}}for(t in this._oPersistentDataAlreadyKnown){if(!this._oSettingCurrent[t]){delete this._oPersistentDataAlreadyKnown[t];}}for(t in this._oPersistentDataCurrentVariant){if(!this._oSettingCurrent[t]){delete this._oPersistentDataCurrentVariant[t];}}break;case c.SyncReason.NewModelDataVariant:if(n===null){n={};}var p=this._callControllers(this._oSettingCurrent,"getUnionData",U.copy(this._oPersistentDataRestore),U.copy(n));this.initializeModel(p);this._callControllers(this._oSettingCurrent,"syncTable2TransientModel");this._callControllers(this._oSettingCurrent,"syncJsonModel2Table",p);this._callControllers(this._oSettingCurrent,"reducePersistentModel");this._oPersistentDataCurrentVariant=U.copy(n);break;case c.SyncReason.NewModelData:if(n===null){n={};}var p=this._callControllers(this._oSettingCurrent,"getUnionData",U.copy(this._oPersistentDataRestore),U.copy(n));this.initializeModel(p);this._callControllers(this._oSettingCurrent,"syncTable2TransientModel");this._callControllers(this._oSettingCurrent,"syncJsonModel2Table",p);this._callControllers(this._oSettingCurrent,"reducePersistentModel");break;case c.SyncReason.ResetModelData:var P=this._projectRestoreData2PersistentModel4Panels(this._oPersistentDataRestore);this.initializeModel(P);this._callControllers(this._oSettingCurrent,"syncTable2TransientModel");this._callControllers(this._oSettingCurrent,"syncJsonModel2Table",U.copy(P));this._callControllers(this._oSettingCurrent,"reducePersistentModel");break;case c.SyncReason.ResetModelDataVariant:var P=this._projectRestoreData2PersistentModel4Panels(this._oPersistentDataCurrentVariant);var o=this._callControllers(this._oSettingCurrent,"getUnionData",U.copy(this._oPersistentDataRestore),U.copy(P));this.initializeModel(o);this._callControllers(this._oSettingCurrent,"syncTable2TransientModel");this._callControllers(this._oSettingCurrent,"syncJsonModel2Table",o);this._callControllers(this._oSettingCurrent,"reducePersistentModel");break;default:}this.getModel().refresh();};c.prototype.initializeModel=function(n){if(!this.getModel()){this._oModel=new sap.ui.model.json.JSONModel();this._oModel.setDefaultBindingMode(sap.ui.model.BindingMode.TwoWay);}var N=null;if(n){N=U.copy(n);}var o=N||((this.getModel().getData()&&this.getModel().getData().persistentData)?this.getModel().getData().persistentData:{});for(var t in o){if(!this._oSettingCurrent[t]){delete o[t];}}this.getModel().setData({transientData:{},persistentData:o});this._callControllers(this._oSettingCurrent,"initializeModel",this.getModel());};c.prototype._fireChangeEvent=function(r){var o={};var p=this._callControllers(this._oSettingCurrent,"getUnionData",U.copy(this._oPersistentDataRestore),this._getPersistentDataCopy());var s=this._callControllers(this._oSettingCurrent,"getChangeType",p,U.copy(this._oPersistentDataAlreadyKnown));var P=this._callControllers(this._oSettingCurrent,"getUnionData",U.copy(this._oPersistentDataRestore),U.copy(this._oPersistentDataCurrentVariant));o.changeTypeVariant=this._callControllers(this._oSettingCurrent,"getChangeType",p,P);var d=U.copy(this._oPersistentDataAlreadyKnown);o.changeType=this._callControllers(this._oSettingCurrent,"getChangeType",p,d);if(!U.hasChangedType(s)&&!U.hasChangedType(o.changeTypeVariant)){return;}if(!this._aColumnKeysOfDateType.length&&(U.isNamespaceChanged(o.changeType,sap.m.P13nPanelType.filter)||U.isNamespaceChanged(o.changeTypeVariant,sap.m.P13nPanelType.filter))){this._aColumnKeysOfDateType=U.getColumnKeysOfDateType(this.getTable());}if(!this._aColumnKeysOfTimeType.length&&(U.isNamespaceChanged(o.changeType,sap.m.P13nPanelType.filter)||U.isNamespaceChanged(o.changeTypeVariant,sap.m.P13nPanelType.filter))){this._aColumnKeysOfTimeType=U.getColumnKeysOfTimeType(this.getTable());}if(!this._aColumnKeysOfBooleanType.length&&(U.isNamespaceChanged(o.changeType,sap.m.P13nPanelType.filter)||U.isNamespaceChanged(o.changeTypeVariant,sap.m.P13nPanelType.filter))){this._aColumnKeysOfBooleanType=U.getColumnKeysOfBooleanType(this.getTable());}if(r===sap.ui.comp.personalization.ResetType.ResetFull||r===sap.ui.comp.personalization.ResetType.ResetPartial){o.changeReason=r;}var e=this._callControllers(this._oSettingCurrent,"getChangeData",p,d);o.changeData=U.removeEmptyProperty(U.copy(e));U.recoverPersonalisationData(o.changeData,this.getTable(),this._aColumnKeysOfDateType);U.recoverPersonalisationTimeData(o.changeData,this.getTable(),this._aColumnKeysOfTimeType);U.recoverPersonalisationBooleanData(o.changeData,this.getTable(),this._aColumnKeysOfBooleanType);var f=U.copy(this._oPersistentDataRestore);var g=this._callControllers(this._oSettingCurrent,"getChangeData",p,f);o.persistentData=U.removeEmptyProperty(g);U.recoverPersonalisationData(o.persistentData,this.getTable(),this._aColumnKeysOfDateType);U.recoverPersonalisationTimeData(o.persistentData,this.getTable(),this._aColumnKeysOfTimeType);U.recoverPersonalisationBooleanData(o.persistentData,this.getTable(),this._aColumnKeysOfBooleanType);this.fireAfterP13nModelDataChange(o);this._oPersistentDataAlreadyKnown=this._callControllers(this._oSettingCurrent,"getUnionData",U.copy(this._oPersistentDataAlreadyKnown),e);};c.prototype._projectRestoreData2PersistentModel4Panels=function(p){if(!this._oDialog||q.isEmptyObject(p)){return p;}var P=this._getPersistentDataCopy();var d=this._oDialog.getPanels();d.forEach(function(o){if(p[o.getType()]){P[o.getType()]=U.copy(p[o.getType()]);}else{delete P[o.getType()];}});return P;};c.prototype._checkIgnoredColumnKeys=function(){var t=this.getTable();if(!t){return;}if(t instanceof b){return;}var i=U.getUnionOfAttribute(this._oSettingCurrent,"ignoreColumnKeys");var v=U.getVisibleColumnKeys(t);i.some(function(s){if(v.indexOf(s)>-1){throw"The provided 'ignoreColumnKeys' are inconsistent. No columns specified as ignored is allowed to be visible.";}});var d=this;t.getColumns().forEach(function(o){var s=q.proxy(o.setVisible,o);var f=function(V){if(V){var i=U.getUnionOfAttribute(d._oSettingCurrent,"ignoreColumnKeys");if(i.indexOf(U.getColumnKey(this))>-1){throw"The provided 'ignoreColumnKeys' are inconsistent. No column specified as ignored is allowed to be visible. "+this;}}s(V);};if(o.setVisible.toString()===f.toString()){return;}o.setVisible=f;});};c.prototype._removeUnsupportedNamespaces=function(){var t=this.getTable();if(t&&t instanceof sap.ui.table.Table&&!(t instanceof sap.ui.table.AnalyticalTable)){delete this._oSettingCurrent.group;}};c.prototype._getArgumentsByType=function(A,t){var r=[],o=null;if(A&&A.length&&t){A.forEach(function(d){if(d&&d[t]&&typeof d[t]!=="function"){o={};o[t]=d[t];r.push(o);}else{r.push(d);}});}return r;};c.prototype._callControllers=function(s,m){var t=null,o=null,d=null,A=null;var r={},e=Array.prototype.slice.call(arguments,2);for(t in s){o=d=A=null;o=s[t];d=o.controller;if(!d||!o.visible||!d[m]){continue;}A=this._getArgumentsByType(e,t);if(m==="getPanel"){A.push(o.payload);}else if(m==="setIgnoreColumnKeys"){A.push(o.ignoreColumnKeys);}else if(m==="setTriggerModelChangeOnColumnInvisible"){A.push(o.triggerModelChangeOnColumnInvisible);}var R=d[m].apply(d,A);if(R!==null&&R!==undefined&&R[t]!==undefined){r[t]=R[t];}else{r[t]=R;}}return r;};c.prototype._setSizeLimit=function(t){this.getModel().setSizeLimit(this.getTable().getColumns().length+1000);};c.prototype._sanityCheck=function(n){return true;};c.prototype.exit=function(){var t;if(this._oDialog){this._oDialog.destroy();this._oDialog=null;}this._callControllers(this._oSettingCurrent,"destroy");for(t in this._oSettingCurrent){this._oSettingCurrent[t]=null;}this._oSettingCurrent=null;for(t in this._oSettingOriginalTable){this._oSettingOriginalTable[t]=null;}this._oSettingOriginalTable=null;this._oSettingCurrent=null;for(t in this._oSettingOriginalChart){this._oSettingOriginalChart[t]=null;}this._oSettingOriginalChart=null;if(this.getModel()){this.getModel().destroy();this._oModel=null;}this._oPersistentDataRestore=null;this._oPersistentDataCurrentVariant=null;this._oPersistentDataAlreadyKnown=null;this._oPersistentDataBeforeOpen=null;this._oPayload=null;};c.SyncReason={NewTable:0,NewSetting:1,NewModelData:6,NewModelDataVariant:2,ResetModelData:3,ResetModelDataVariant:4,NewTableBinding:5};return c;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.providers.ControlProvider')){jQuery.sap.declare('sap.ui.comp.providers.ControlProvider');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.m.CheckBox');jQuery.sap.require('sap.m.ComboBox');jQuery.sap.require('sap.m.DatePicker');jQuery.sap.require('sap.m.TimePicker');jQuery.sap.require('sap.m.HBox');jQuery.sap.require('sap.m.Input');jQuery.sap.require('sap.m.Text');sap.ui.define("sap/ui/comp/providers/ControlProvider",['jquery.sap.global','sap/m/CheckBox','sap/m/ComboBox','sap/m/DatePicker','sap/m/TimePicker','sap/m/HBox','sap/m/Input','sap/m/Text','sap/ui/comp/navpopover/SmartLink','sap/ui/comp/odata/MetadataAnalyser','sap/ui/comp/smartfield/ODataHelper','sap/ui/comp/smartfield/SmartField','sap/ui/comp/odata/ODataType','sap/ui/comp/util/FormatUtil'],function(q,C,a,D,T,H,I,b,S,M,O,c,d,F){"use strict";var e=function(p){if(p){this._oParentODataModel=p.model;this._oMetadataAnalyser=p.metadataAnalyser;this._aODataFieldMetadata=p.fieldsMetadata;this._oDateFormatSettings=p.dateFormatSettings;this._bEnableDescriptions=p.enableDescriptions;this._oCurrencyFormatSettings=p.currencyFormatSettings;this._oDefaultDropDownDisplayBehaviour=p.defaultDropDownDisplayBehaviour||"descriptionAndId";this.useSmartField=p.useSmartField==="true";this._sEntitySet=p.entitySet;}if(!this._oMetadataAnalyser&&this._oParentODataModel){this._oMetadataAnalyser=new M(this._oParentODataModel);this._intialiseMetadata();}this._mSmartField={};this._oHelper=new O(this._oMetadataAnalyser.oModel);this._aValueListProvider=[];this._aValueHelpProvider=[];};e.prototype._intialiseMetadata=function(){if(!this._aODataFieldMetadata){this._aODataFieldMetadata=this._oMetadataAnalyser.getFieldsByEntitySetName(this.sEntity);}};e.prototype.getFieldViewMetadata=function(f,i){var o=this._createFieldMetadata(f);this._createFieldTemplate(o,i);return o;};e.prototype._createFieldTemplate=function(v,i){if(this.useSmartField){v.template=new c({value:{path:v.name},entitySet:this._sEntitySet,contextEditable:{path:"sm4rtM0d3l>/editable",mode:"OneWay"},controlContext:"table",wrapping:false});if(d.isNumeric(v.type)||d.isDateOrTime(v.type)){v.template.setTextAlign("End");v.template.setWidth("100%");}this._completeSmartField(v);v.template._setPendingEditState(i);}else{v.template=i?this._createEditableTemplate(v):this._createDisplayOnlyTemplate(v);}};e.prototype._completeSmartField=function(v){var o={annotations:{},path:v.name};if(!this._mSmartField.entitySetObject){this._mSmartField.entitySetObject=this._oHelper.oMeta.getODataEntitySet(this._sEntitySet);this._mSmartField.entityType=this._oHelper.oMeta.getODataEntityType(this._mSmartField.entitySetObject.entityType);}o.modelObject=this._oParentODataModel;o.entitySetObject=this._mSmartField.entitySetObject;o.entitySet=this._mSmartField.entitySetObject;o.entityType=this._mSmartField.entityType;this._oHelper.getProperty(o);o.annotations.uom=this._oHelper.getUnitOfMeasure2(o);o.annotations.text=this._oHelper.getTextProperty2(o);o.annotations.lineitem=this._oMetadataAnalyser.getLineItemAnnotation(o.entitySetObject.entityType);o.annotations.semantic=this._oMetadataAnalyser.getSemanticObjectAnnotationFromProperty(o.property.property);this._oHelper.getUOMTextAnnotation(o);if(o.property.property["sap:value-list"]||o.property.property["com.sap.vocabularies.Common.v1.ValueList"]){o.annotations.valuelist=this._oHelper.getValueListAnnotationPath(o);if(o.property.property["sap:value-list"]){o.annotations.valuelistType=o.property.property["sap:value-list"];}else{o.annotations.valuelistType=this._oMetadataAnalyser.getValueListSemantics(o.property.property["com.sap.vocabularies.Common.v1.ValueList"]);}}this._oHelper.getUOMValueListAnnotationPath(o);delete o.entitySet;v.template.data("configdata",{"configdata":o});v.template.data("dateFormatSettings",this._oDateFormatSettings);v.template.data("currencyFormatSettings",this._oCurrencyFormatSettings);v.template.data("defaultDropDownDisplayBehaviour",this._oDefaultDropDownDisplayBehaviour);if(o.annotations.uom||d.isNumeric(v.type)||d.isDateOrTime(v.type)){var A=v.template.getTextAlign();if(A==="Initial"){A="End";}v.align=A;v.textDirection="LTR";}};e.prototype._createEditableTemplate=function(v,B){var t=null,f,o,g;if(v.type==="Edm.DateTime"||v.type==="Edm.DateTimeOffset"){if(v.displayFormat==="Date"){f=this._oDateFormatSettings;o={displayFormat:"Date"};t=new D({dateValue:{path:v.name}});}}else if(v.type==="Edm.Boolean"){t=new C({selected:{path:v.name}});}else if(v.type==="Edm.Decimal"){o={precision:v.precision,scale:v.scale};}g=d.getType(v.type,f,o);if(v.semanticObject&&(!B)){t=this._createSmartLinkFieldTemplate(v,g,function(){var i=this._createEditableTemplate(v,true);if(i.setWrapping&&v.template&&v.template.getWrapping){i.setWrapping(v.template.getWrapping());}return i;}.bind(this));}if(!t){if(v.type==="Edm.Time"){t=new T({value:{path:v.name,type:g}});}else{t=new I({value:{path:v.name,type:g}});if(v.isMeasureField){t.bindProperty("description",{path:v.unit});t.setTextAlign("End");t.setTextDirection("LTR");t.setFieldWidth("80%");}else if(this._bEnableDescriptions&&v.description){t.bindProperty("description",{path:v.description});}else if(d.isNumeric(v.type)||d.isDateOrTime(v.type)){t.setTextAlign("End");t.setTextDirection("LTR");}if(v.hasValueListAnnotation){this._associateValueHelpAndSuggest(t,v);}}}return t;};e.prototype._associateValueHelpAndSuggest=function(o,f){o.setShowValueHelp(true);this._aValueHelpProvider.push(new sap.ui.comp.providers.ValueHelpProvider({loadAnnotation:true,fullyQualifiedFieldName:f.fullName,metadataAnalyser:this._oMetadataAnalyser,control:o,model:this._oParentODataModel,preventInitialDataFetchInValueHelpDialog:true,dateFormatSettings:this._oDateFormatSettings,takeOverInputValue:false,fieldName:f.fieldName,type:f.type,maxLength:f.maxLength,displayFormat:f.displayFormat,displayBehaviour:f.displayBehaviour,title:f.label}));o.setShowSuggestion(true);o.setFilterSuggests(false);this._aValueListProvider.push(new sap.ui.comp.providers.ValueListProvider({loadAnnotation:true,fullyQualifiedFieldName:f.fullName,metadataAnalyser:this._oMetadataAnalyser,control:o,model:this._oParentODataModel,dateFormatSettings:this._oDateFormatSettings,typeAheadEnabled:true,aggregation:"suggestionRows",displayFormat:f.displayFormat,displayBehaviour:f.displayBehaviour}));};e.prototype._createDisplayOnlyTemplate=function(v,B){var t=null,o=null,f,g,A,s,h;if(v.displayFormat==="Date"){f=this._oDateFormatSettings;g={displayFormat:"Date"};}else if(v.type==="Edm.Decimal"){g={precision:v.precision,scale:v.scale};}o=d.getType(v.type,f,g);if(d.isNumeric(v.type)||d.isDateOrTime(v.type)){A="End";}if(v.isMeasureField){v.textDirection="LTR";t=this._createMeasureFieldTemplate(v,o);}else if(v.semanticObject&&(!B)){t=this._createSmartLinkFieldTemplate(v,o,function(){var i=this._createDisplayOnlyTemplate(v,true);if(i.setWrapping&&v.template&&v.template.getWrapping){i.setWrapping(v.template.getWrapping());}return i;}.bind(this));}else{h={path:v.name,type:o};if(this._bEnableDescriptions&&v.description){s=v.displayBehaviour;h={parts:[{path:v.name,type:o},{path:v.description}],formatter:function(i,j){return F.getFormattedExpressionFromDisplayBehaviour(s,i,j);}};}t=new b({wrapping:false,textAlign:A,textDirection:A==="End"?"LTR":undefined,text:h});}v.align=A;return t;};e.prototype._createSmartLinkFieldTemplate=function(v,t,f){var B={path:v.name,type:t};if(this._bEnableDescriptions&&v.description){B={parts:[{path:v.name,type:t},{path:v.description}],formatter:function(i,s){return F.getFormattedExpressionFromDisplayBehaviour(v.displayBehaviour,i,s);}};}var o=new S({semanticObject:v.semanticObject,semanticObjectLabel:v.label,fieldName:v.name,text:B});o.setCreateControlCallback(f);return o;};e.prototype._createMeasureFieldTemplate=function(v,t){var o,V,u,E=false;E=!!(v.isCurrencyField&&this._oCurrencyFormatSettings&&this._oCurrencyFormatSettings.showCurrencySymbol);V=new b({wrapping:false,textAlign:"End",text:{parts:[{path:v.name,type:t},{path:v.unit}],formatter:v.isCurrencyField?F.getAmountCurrencyFormatter():F.getMeasureUnitFormatter(),useRawValues:v.isCurrencyField}});u=new b({wrapping:false,textAlign:"Begin",width:"2.5em",text:{path:v.unit,formatter:E?F.getCurrencySymbolFormatter():undefined}});o=new H({justifyContent:"End",items:[V,u]});o.addStyleClass("sapUiCompUOMInTableLTR");return o;};e.prototype._createFieldMetadata=function(f){var o=q.extend({},f);o.label=f.fieldLabel||f.name;o.quickInfo=f.quickInfo||o.label;o.displayBehaviour=o.displayBehaviour||this._oDefaultDropDownDisplayBehaviour;o.filterType=this._getFilterType(f);this._updateValueListMetadata(o,f);this._setAnnotationMetadata(o);return o;};e.prototype._updateValueListMetadata=function(f,o){f.hasValueListAnnotation=o["sap:value-list"]!==undefined;if(f.hasValueListAnnotation){f.hasFixedValues=o["sap:value-list"]==="fixed-values";}else if(o["com.sap.vocabularies.Common.v1.ValueList"]){f.hasValueListAnnotation=true;f.hasFixedValues=this._oMetadataAnalyser.getValueListSemantics(o["com.sap.vocabularies.Common.v1.ValueList"])==="fixed-values";}};e.prototype._setAnnotationMetadata=function(f){var A=null;if(!this.useSmartField&&f&&f.fullName){A=this._oMetadataAnalyser.getSemanticObjectAnnotation(f.fullName);if(A){f.semanticObject=A.semanticObject;}}};e.prototype._getFilterType=function(f){if(d.isNumeric(f.type)){return"numeric";}else if(f.type==="Edm.DateTime"&&f.displayFormat==="Date"){return"date";}else if(f.type==="Edm.String"){return"string";}else if(f.type==="Edm.Boolean"){return"boolean";}else if(f.type==="Edm.Time"){return"time";}return undefined;};e.prototype.destroy=function(){var i;if(this._oMetadataAnalyser&&this._oMetadataAnalyser.destroy){this._oMetadataAnalyser.destroy();}this._oMetadataAnalyser=null;if(this._aValueHelpProvider){i=this._aValueHelpProvider.length;while(i--){this._aValueHelpProvider[i].destroy();}}this._aValueHelpProvider=null;if(this._aValueListProvider){i=this._aValueListProvider.length;while(i--){this._aValueListProvider[i].destroy();}}if(this._oHelper){this._oHelper.destroy();}this._oHelper=null;this._mSmartField=null;this._aValueListProvider=null;this._aODataFieldMetadata=null;this._oCurrencyFormatter=null;this.bIsDestroyed=true;};return e;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.providers.TableProvider')){jQuery.sap.declare('sap.ui.comp.providers.TableProvider');jQuery.sap.require('jquery.sap.global');sap.ui.define("sap/ui/comp/providers/TableProvider",['jquery.sap.global','sap/ui/comp/odata/MetadataAnalyser','./ControlProvider','sap/ui/comp/util/FormatUtil'],function(q,M,C,F){"use strict";var T=function(p){if(p){this._oParentODataModel=p.model;this.sEntitySet=p.entitySet;this._sIgnoredFields=p.ignoredFields;this._sInitiallyVisibleFields=p.initiallyVisibleFields;this.isEditableTable=p.isEditableTable;this._isAnalyticalTable=p.isAnalyticalTable;this.useSmartField=p.useSmartField;this.enableInResultForLineItem=p.enableInResultForLineItem==="true";try{this._oDateFormatSettings=p.dateFormatSettings?JSON.parse(p.dateFormatSettings):undefined;this._oCurrencyFormatSettings=p.currencyFormatSettings?JSON.parse(p.currencyFormatSettings):undefined;this._oDefaultDropDownDisplayBehaviour=p.defaultDropDownDisplayBehaviour;}catch(e){}}this._aODataFieldMetadata=[];this._aTableViewMetadata=[];this._aIgnoredFields=[];this._aInitiallyVisibleFields=[];this._oMetadataAnalyser=new M(this._oParentODataModel);this._intialiseMetadata();};T.prototype._intialiseMetadata=function(){var t=[],i,l,f,o,s,S,a;this._aODataFieldMetadata=this._oMetadataAnalyser.getFieldsByEntitySetName(this.sEntitySet);a=this._oMetadataAnalyser.getEntityTypeNameFromEntitySetName(this.sEntitySet);this._oPresentationVariant=this._oMetadataAnalyser.getPresentationVariantAnnotation(a);if(this._oPresentationVariant){this._oLineItemAnnotation=this._oPresentationVariant.lineItemAnnotation;}else{this._oLineItemAnnotation=this._oMetadataAnalyser.getLineItemAnnotation(a);}S=this._oMetadataAnalyser.getEntityContainerAttribute("supported-formats");if(S){this._bSupportsExcelExport=S.indexOf("xlsx")>-1;}if(!this._oDefaultDropDownDisplayBehaviour){this._oDefaultDropDownDisplayBehaviour=this._oMetadataAnalyser.getTextArrangementValue(a);}this._generateArrays();this._oControlProvider=new C({metadataAnalyser:this._oMetadataAnalyser,model:this._oParentODataModel,fieldsMetadata:this._aODataFieldMetadata,dateFormatSettings:this._oDateFormatSettings,currencyFormatSettings:this._oCurrencyFormatSettings,defaultDropDownDisplayBehaviour:this._oDefaultDropDownDisplayBehaviour,useSmartField:this.useSmartField,enableDescriptions:!this._isAnalyticalTable,entitySet:this.sEntitySet});this._oFieldSemanticObjectMap={};if(this._aODataFieldMetadata){l=this._aODataFieldMetadata.length;}for(i=0;i<l;i++){f=this._aODataFieldMetadata[i];if(this._aIgnoredFields.indexOf(f.name)>-1||!f.visible){continue;}if(f.type.indexOf("Edm.")===0){o=this._oControlProvider.getFieldViewMetadata(f,this.isEditableTable);this._enrichWithTableViewMetadata(f,o);t.push(o);if(o.semanticObject){this._oFieldSemanticObjectMap[o.name]=o.semanticObject;}}}s=function(b,c){if(b.index||b.index===0){if(c.index||c.index===0){return b.index-c.index;}return-1;}if(c.index||c.index===0){return 1;}return 0;};this._aTableViewMetadata=t.sort(s);};T.prototype.getFieldSemanticObjectMap=function(){return this._oFieldSemanticObjectMap;};T.prototype.getTableViewMetadata=function(){return this._aTableViewMetadata;};T.prototype.getSupportsExcelExport=function(){return this._bSupportsExcelExport;};T.prototype.getIsUTCDateHandlingEnabled=function(){return this._oDateFormatSettings?this._oDateFormatSettings.UTC:false;};T.prototype._generateArrays=function(){if(this._sIgnoredFields){this._aIgnoredFields=this._sIgnoredFields.split(",");}if(this._sInitiallyVisibleFields){this._aInitiallyVisibleFields=this._sInitiallyVisibleFields.split(",");}};T.prototype._enrichWithTableViewMetadata=function(f,o){var a;this._updateLabel(o);o.isInitiallyVisible=this._isInitiallyVisible(f);o.index=this._getIndex(f);o.width=F.getWidth(f);if(o.isMeasureField&&o.unit){a=o.unit;}else if(o.description){a=o.description;}o.additionalProperty=a;o.summed=f.aggregationRole==="measure";this._setInResult(o);this._setSortOrder(o);};T.prototype._isInitiallyVisible=function(f){var i=false;if(this._oLineItemAnnotation&&this._oLineItemAnnotation.fields){i=this._oLineItemAnnotation.fields.indexOf(f.name)>-1;if(i&&!sap.ui.Device.system.desktop){var I=this._getFieldImportance(f);if(I){if(sap.ui.Device.system.tablet){i=I==="High"||I==="Medium";}else if(sap.ui.Device.system.phone){i=I==="High";}}}}if(!i&&this._aInitiallyVisibleFields){i=this._aInitiallyVisibleFields.indexOf(f.name)>-1;}return i;};T.prototype._setInResult=function(f){if(this._oPresentationVariant){if(this._oPresentationVariant.requestAtLeastFields&&this._oPresentationVariant.requestAtLeastFields.indexOf(f.name)>-1){f.inResult=true;}}else if(this.enableInResultForLineItem){if(this._oLineItemAnnotation&&this._oLineItemAnnotation.fields&&this._oLineItemAnnotation.fields.indexOf(f.name)>-1){f.inResult=true;}}};T.prototype._setSortOrder=function(f){var l;if(this._oPresentationVariant&&this._oPresentationVariant.sortOrderFields){l=this._oPresentationVariant.sortOrderFields.length;for(var i=0;i<l;i++){if(this._oPresentationVariant.sortOrderFields[i].name===f.name){f.sorted=true;f.sortOrder=this._oPresentationVariant.sortOrderFields[i].descending?"Descending":"Ascending";break;}}}};T.prototype._getFieldImportance=function(f){var r=null;if(this._oLineItemAnnotation&&this._oLineItemAnnotation.importance){r=this._oLineItemAnnotation.importance[f.name];}return r;};T.prototype._getIndex=function(f){var i=-1,l=0;if(this._oLineItemAnnotation&&this._oLineItemAnnotation.fields){l=this._oLineItemAnnotation.fields.length;i=this._oLineItemAnnotation.fields.indexOf(f.name);}if(i<0&&this._aInitiallyVisibleFields){i=this._aInitiallyVisibleFields.indexOf(f.name)+l;}if(i>-1){return i;}return undefined;};T.prototype._updateLabel=function(f){var l;if(this._oLineItemAnnotation&&this._oLineItemAnnotation.labels){l=this._oLineItemAnnotation.labels[f.name];}if(l){f.label=l;if(f.template&&f.template.setSemanticObjectLabel){f.template.setSemanticObjectLabel(f.label);}}};T.prototype.destroy=function(){if(this._oMetadataAnalyser&&this._oMetadataAnalyser.destroy){this._oMetadataAnalyser.destroy();}this._oMetadataAnalyser=null;this._aODataFieldMetadata=null;this._aTableViewMetadata=null;this._aIgnoredFields=null;this._aInitiallyVisibleFields=null;this._sIgnoredFields=null;this._sInitiallyVisibleFields=null;this.bIsDestroyed=true;};return T;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.smartfilterbar.SmartFilterBar')){jQuery.sap.declare('sap.ui.comp.smartfilterbar.SmartFilterBar');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.m.MessageBox');sap.ui.define("sap/ui/comp/smartfilterbar/SmartFilterBar",['jquery.sap.global','sap/m/MessageBox','sap/ui/comp/filterbar/FilterBar','sap/ui/comp/filterbar/FilterGroupItem','sap/ui/comp/filterbar/FilterItem','sap/ui/comp/library','./AdditionalConfigurationHelper','./ControlConfiguration','./FilterProvider','./GroupConfiguration','sap/ui/comp/smartvariants/PersonalizableInfo','sap/ui/comp/smartvariants/SmartVariantManagement','sap/ui/comp/odata/ODataModelUtil'],function(q,M,F,a,b,l,A,C,c,G,P,S,O){"use strict";var d=F.extend("sap.ui.comp.smartfilterbar.SmartFilterBar",{metadata:{library:"sap.ui.comp",properties:{entityType:{type:"string",group:"Misc",defaultValue:null},resourceUri:{type:"string",group:"Misc",defaultValue:null},basicSearchFieldName:{type:"string",group:"Misc",defaultValue:null},enableBasicSearch:{type:"boolean",group:"Misc",defaultValue:false}},aggregations:{controlConfiguration:{type:"sap.ui.comp.smartfilterbar.ControlConfiguration",multiple:true,singularName:"controlConfiguration"},groupConfiguration:{type:"sap.ui.comp.smartfilterbar.GroupConfiguration",multiple:true,singularName:"groupConfiguration"}},events:{pendingChange:{pendingValue:{type:"boolean"}}}},renderer:function(r,o){F.getMetadata().getRenderer().render(r,o);}});d.prototype.init=function(){this._aFilterBarViewMetadata=null;this.isRunningInValueHelpDialog=false;F.prototype.init.apply(this);sap.ui.getCore().getMessageManager().registerObject(this,true);};d.prototype._initializeMetadata=function(){if(!this.isInitialised){O.handleModelInit(this,this._onMetadataInitialised);}};d.prototype._onMetadataInitialised=function(){this._bMetaModelLoadAttached=false;if(!this.isInitialised){this._createFilterProvider();if(this._oFilterProvider){this._aFilterBarViewMetadata=this._oFilterProvider.getFilterBarViewMetadata();if(this._aFilterBarViewMetadata){this._attachAdditionalConfigurationChanged();this.isInitialised=true;this.setModel(this._oFilterProvider.oModel,this._oFilterProvider.sFilterModelName);this.registerGetFiltersWithValues(q.proxy(this.getFiltersWithValues,this));this.registerFetchData(q.proxy(this.getFilterDataAsString,this,true));this.registerApplyData(q.proxy(function(j){this.setFilterDataAsString(j,true);},this));this._initializeVariantManagement();}}}};d.prototype.getFilterBarViewMetadata=function(){return this._aFilterBarViewMetadata;};d.prototype._createFilterProvider=function(){var r,m,e;m=this.getModel();r=this.getResourceUri();e=this.getEntityType();if((m||r)&&e){this._oFilterProvider=new sap.ui.comp.smartfilterbar.FilterProvider({basicSearchFieldName:this.getBasicSearchFieldName(),enableBasicSearch:this.getEnableBasicSearch(),entityType:e,serviceUrl:r,isRunningInValueHelpDialog:this.isRunningInValueHelpDialog,model:m,additionalConfiguration:this.getAdditionalConfiguration(),defaultDropDownDisplayBehaviour:this.data("defaultDropDownDisplayBehaviour"),defaultTokenDisplayBehaviour:this.data("defaultTokenDisplayBehaviour"),dateFormatSettings:this.data("dateFormatSettings"),useContainsAsDefaultFilter:this.data("useContainsAsDefaultFilter"),smartFilter:this});this._oFilterProvider.attachPendingChange(function(v){this.firePendingChange({pendingValue:v});}.bind(this));}};d.prototype._attachAdditionalConfigurationChanged=function(){var e,g,i,f;g=this.getGroupConfiguration();f=g.length;for(i=0;i<f;i++){g[i].attachChange(this._handleGroupConfigurationChanged.bind(this));}e=this.getControlConfiguration();f=e.length;for(i=0;i<f;i++){e[i].attachChange(this._handleControlConfigurationChanged.bind(this));}};d.prototype._handleControlConfigurationChanged=function(e){var p,o,f,k,v;p=e.getParameter("propertyName");o=e.oSource;if(!o){return;}k=o.getKey();f=this._getFilterItemByName(k);if(!f){return;}if(p==="visible"){v=o.getVisible();f.setVisible(v);}else if(p==="label"){v=o.getLabel();f.setLabel(v);}else if(p==="visibleInAdvancedArea"){v=o.getVisibleInAdvancedArea();if(f.setVisibleInAdvancedArea){f.setVisibleInAdvancedArea(v);}}};d.prototype._handleGroupConfigurationChanged=function(e){var p,g;p=e.getParameter("propertyName");g=e.oSource;if(p==="label"){this._handleGroupConfigurationLabelChanged(g);}};d.prototype._handleGroupConfigurationLabelChanged=function(g){var f,k,L;if(!g){return;}L=g.getLabel();k=g.getKey();f=this._getFilterGroupItemByGroupName(k);if(f){f.setGroupTitle(L);}};d.prototype._getFilterItemByName=function(n){var f,e,i;f=this.getFilterItems();f.push.apply(f,this.getFilterGroupItems());e=f.length;for(i=0;i<e;i++){if(f[i].getName()===n){return f[i];}}};d.prototype._getFilterGroupItemByGroupName=function(n){var f,e,i;f=this.getFilterGroupItems();e=f.length;for(i=0;i<e;i++){if(f[i].getGroupName()===n){return f[i];}}};d.prototype.getAdditionalConfiguration=function(){return new A(this.getControlConfiguration(),this.getGroupConfiguration());};d.prototype.setEntityType=function(e){this.setProperty("entityType",e);this._initializeMetadata();};d.prototype.setResourceUri=function(r){this.setProperty("resourceUri",r);this._initializeMetadata();};d.prototype.propagateProperties=function(){F.prototype.propagateProperties.apply(this,arguments);this._initializeMetadata();};d.prototype._getFilterInformation=function(){var f,i,j,L=0,e=0,g,h=[],o;if(this._aFilterBarViewMetadata){L=this._aFilterBarViewMetadata.length;for(i=0;i<L;i++){f=this._aFilterBarViewMetadata[i];g=f.fields;e=g.length;for(j=0;j<e;j++){o=g[j];if(o.name===c.BASIC_SEARCH_FIELD_ID){this.setBasicSearch(o.control);this._attachToBasicSearch(o.control);continue;}else{if(f.groupName===c.BASIC_FILTER_AREA_ID){this._createFieldInBasicArea(o);}else{this._createFieldInAdvancedArea(f.groupName,f.groupLabel,o);}}h.push(o);}}}return h;};d.prototype._validateState=function(){var f=null,L,o,i=false;f=this.getAllFilterItems(true);if(f){L=f.length;while(L--){o=this.determineControlByFilterItem(f[L]);if(o){if(o.getValueState&&o.getValueState()===sap.ui.core.ValueState.Error&&!o.data("__mandatoryEmpty")){i=true;break;}else if(o.__bValidatingToken){this.bIsSearchPending=true;i=true;break;}}}}if(this._oFilterProvider){return!i&&!this._oFilterProvider._validateConditionTypeFields();}else{return!i;}};d.prototype._attachToBasicSearch=function(B){if(B){B.attachSearch(q.proxy(this.search,this));B.attachLiveChange(q.proxy(this._onChange,this));}};d.prototype._onChange=function(e){var o=e.getSource();if(o.data("__mandatoryEmpty")){o.data("__mandatoryEmpty",null);o.setValueState(sap.ui.core.ValueState.None);}if(o.data("__validationError")&&!o.getValue()){o.data("__validationError",null);o.setValueState(sap.ui.core.ValueState.None);}if(this._oFilterProvider._bUpdatingFilterData||this._oFilterProvider._bCreatingInitialModel){return;}if(!o||(o&&!o.__bValidatingToken)){this.fireFilterChange(e);this._oFilterProvider._updateConditionTypeFields(e.getParameter("filterChangeReason"));}};d.prototype._handleChange=function(o){if(o){if(o.attachChange){o.attachChange(q.proxy(this._onChange,this));}}};d.prototype._handleEnter=function(o){o.attachBrowserEvent("keydown",function(e){if(e.which===13){o.__bSuggestInProgress=(o._oSuggestionPopup&&o._oSuggestionPopup.isOpen());}});o.attachBrowserEvent("keyup",q.proxy(function(e){if(e.which===13&&!o.__bSuggestInProgress){this.search();}},this));};d.prototype._createFilterFieldControl=function(f){if(f.conditionType){this._createConditionTypeItem(f);}else if(!f.control&&f.fCreateControl){f.fCreateControl(f);delete f.fCreateControl;}this._handleEnter(f.control);this._handleChange(f.control);};d.prototype._createConditionTypeItem=function(f){if(!f.conditionType){return;}q.sap.require("sap.m.HBox");var L=new sap.m.HBox(),s=1;f.conditionType.initializeFilterItem(this.getFilterContainerWidth(),L);f._iSpan=s+1;f.control=L;};d.prototype._createFieldInBasicArea=function(f){f.factory=function(){this._createFilterFieldControl(f);if(!f.control){return;}var o=new b({labelTooltip:f.quickInfo,label:f.label,name:f.fieldName,mandatory:f.isMandatory,visible:f.isVisible,control:f.control});if(f._iSpan){o._iSpan=f._iSpan;}if(f.isCustomFilterField){o.data("isCustomField",true);}this.addFilterItem(o);}.bind(this);f.groupName=F.INTERNAL_GROUP;return f;};d.prototype._createFieldInAdvancedArea=function(g,s,f){f.factory=function(){this._createFilterFieldControl(f);var o=new a({labelTooltip:f.quickInfo,label:f.label,name:f.fieldName,groupName:g,groupTitle:s,mandatory:f.isMandatory,visible:f.isVisible,visibleInAdvancedArea:f.visibleInAdvancedArea,control:f.control});if(f._iSpan){o._iSpan=f._iSpan;}if(f.isCustomFilterField){o.data("isCustomField",true);}this.addFilterGroupItem(o);}.bind(this);f.groupName=g;f.groupTitle=s;return f;};d.prototype.getFilters=function(f){if(!f||!f.length){f=this._getVisibleFieldNames();}return this._oFilterProvider?this._oFilterProvider.getFilters(f):[];};d.prototype.getParameters=function(){return this._oFilterProvider?this._oFilterProvider.getParameters():{};};d.prototype.getControlByKey=function(k){var f;f=this._getFilterItemByName(k);if(f){return this.determineControlByFilterItem(f);}};d.prototype._getVisibleFieldNames=function(){var f=[],v=this.getAllFilterItems(true),L=v.length,i;L=v.length;while(L--){i=v[L];if(i){f.push(i.getName());}}return f;};d.prototype.getFilterData=function(e){var D=null;if(this._oFilterProvider){if(e){D=this._oFilterProvider.getFilterData();}else{D=this._oFilterProvider.getFilledFilterData(this._getVisibleFieldNames());}}return D;};d.prototype._checkHasValueData=function(o){if(o){if(typeof o==="boolean"){return o;}else if(typeof o==="string"){if(o.toLowerCase()==="true"){return true;}}}return false;};d.prototype._checkForValues=function(D,f,o){var v=null;if(D&&f&&o){if(!f.data("isCustomField")){v=D[f.getName()];}else{var e=o.data("hasValue");if((e!==undefined)&&(e!=null)){return this._checkHasValueData(e);}else{if(o.getValue){v=o.getValue();}else if(o.getSelectedKey){v=o.getSelectedKey();}}}}return v?true:false;};d.prototype.getFiltersWithValues=function(){var f=[];var e=this.getAllFilterItems(true),o,D=this.getFilterData(),L=0,g;if(e&&D){L=e.length;while(L--){o=e[L];g=this.determineControlByFilterItem(o);if(this._checkForValues(D,o,g)){f.push(o);}}}return f;};d.prototype.getFilterDataAsString=function(e){var D=null;if(this._oFilterProvider){if(e){D=this._oFilterProvider.getFilterDataAsString();}else{D=this._oFilterProvider.getFilledFilterDataAsString(this._getVisibleFieldNames());}}return D;};d.prototype.setFilterData=function(j,r){if(this._oFilterProvider){this._oFilterProvider.setFilterData(j,r);}if(j&&(Object.keys(j).length===1)&&j._CUSTOM){return;}this.fireFilterChange({afterFilterDataUpdate:true});};d.prototype.setFilterDataAsString=function(j,r){if(j){this.setFilterData(JSON.parse(j),r);}};d.prototype.fireClear=function(){this._clearFilterFields();this.fireEvent("clear",arguments);};d.prototype._clearFilterFields=function(){if(this._oFilterProvider){this._oFilterProvider.clear();}this.fireFilterChange({afterFilterDataUpdate:true});};d.prototype.fireReset=function(){this._resetFilterFields();this.fireEvent("reset",arguments);};d.prototype._resetFilterFields=function(){if(this._oFilterProvider){this._oFilterProvider.reset();}this.fireFilterChange({afterFilterDataUpdate:true});};d.prototype.search=function(){var p=[],o={},e,i=false,E;delete this.bIsSearchPending;e=this._validateState();if(!e){if(this.bIsSearchPending){return;}else{i=true;}}else{e=this._validateMandatoryFields();}if(this.isPending()&&!this._bIsPendingChangeAttached){var h=function(f){if(f.getParameter("pendingValue")===false){this.detachPendingChange(h);this._bIsPendingChangeAttached=false;this.search();}}.bind(this);this._bIsPendingChangeAttached=true;this.attachPendingChange(h);return;}if(e){o.selectionSet=this._retrieveCurrentSelectionSet();p.push(o);this.fireSearch(p);}else{if(!this._oResourceBundle){this._oResourceBundle=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");}if(!i){if(!this._sMandatoryErrorMessage){this._sMandatoryErrorMessage=this._oResourceBundle.getText("EMPTY_MANDATORY_MESSAGE");}E=this._sMandatoryErrorMessage;}else{if(!this._sValidationErrorMessage){this._sValidationErrorMessage=this._oResourceBundle.getText("VALIDATION_ERROR_MESSAGE");}E=this._sValidationErrorMessage;}try{M.error(E,{styleClass:(this.$()&&this.$().closest(".sapUiSizeCompact").length)?"sapUiSizeCompact":""});}catch(x){return;}if(this._bExpandAdvancedFilterArea&&this.rerenderFilters){this.rerenderFilters(true);}}return e;};d.prototype.isPending=function(){if(!this._oFilterProvider){return false;}return this._oFilterProvider.isPending();};d.prototype._validateMandatoryFields=function(){var f=true,e=this.determineMandatoryFilterItems(),o,D=this.getFilterData(),L=0,g;this._bExpandAdvancedFilterArea=false;if(e&&D){L=e.length;while(L--){o=e[L];g=this.determineControlByFilterItem(o);if(g&&g.setValueState){if(this._checkForValues(D,o,g)){if(g.data("__mandatoryEmpty")){g.data("__mandatoryEmpty",null);g.setValueState(sap.ui.core.ValueState.None);}}else{f=false;g.setValueState(sap.ui.core.ValueState.Error);g.data("__mandatoryEmpty",true);if(o.getGroupName){this._bExpandAdvancedFilterArea=true;}}}}}return f;};d.prototype._setSmartVariant=function(s){if(s){var o=sap.ui.getCore().byId(s);if(o){if(o instanceof S){if(this._oVariantManagement&&!this._oVariantManagement.isPageVariant()){this._replaceVariantManagement(o);this._oSmartVariantManagement=o;}}else{q.sap.log.error("Control with the id="+s+" not of expected type");}}else{q.sap.log.error("Control with the id="+s+" not found");}}};d.prototype.setSmartVariant=function(s){if(this.getAdvancedMode()){q.sap.log.error("not supported for the advanced mode");return;}this.setAssociation("smartVariant",s);this._setSmartVariant(s);};d.prototype._createVariantManagement=function(){this._oSmartVariantManagement=null;if(this.getAdvancedMode()){return F.prototype._createVariantManagement.apply(this);}this._oSmartVariantManagement=new S(this.getId()+"-variant",{showExecuteOnSelection:true,showShare:true});return this._oSmartVariantManagement;};d.prototype._initializeVariantManagement=function(){if(!this.isRunningInValueHelpDialog&&this._oSmartVariantManagement&&this.getPersistencyKey()){var p=new P({type:"filterBar",keyName:"persistencyKey",dataSource:this.getEntityType()});p.setControl(this);this._oSmartVariantManagement.addPersonalizableControl(p);var v=this._checkHasValueData(this.data("executeStandardVariantOnSelect"));if(v){this._oSmartVariantManagement._executeOnSelectForStandardVariant(v);}F.prototype._initializeVariantManagement.apply(this,arguments);}else{this.fireInitialise();}};d.prototype.getBasicSearchControl=function(){return sap.ui.getCore().byId(this.getBasicSearch());};d.prototype.addFieldToAdvancedArea=function(k){var f;f=this._getFilterItemByName(k);if(f&&f.setVisibleInAdvancedArea){f.setVisibleInAdvancedArea(true);}};d.prototype.getConditionTypeByKey=function(k){if(this._oFilterProvider._mConditionTypeFields[k]){return this._oFilterProvider._mConditionTypeFields[k].conditionType;}};d.prototype.destroy=function(){F.prototype.destroy.apply(this,arguments);sap.ui.getCore().getMessageManager().unregisterObject(this);if(this._oFilterProvider&&this._oFilterProvider.destroy){this._oFilterProvider.destroy();}this._oFilterProvider=null;this._aFilterBarViewMetadata=null;this._bExpandAdvancedFilterArea=null;this._oResourceBundle=null;this._sMandatoryErrorMessage=null;this._sValidationErrorMessage=null;this._oSmartVariantManagement=null;};return d;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.smartform.Group')){jQuery.sap.declare('sap.ui.comp.smartform.Group');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.Element');jQuery.sap.require('sap.ui.layout.ResponsiveFlowLayoutData');jQuery.sap.require('sap.ui.layout.form.FormContainer');sap.ui.define("sap/ui/comp/smartform/Group",['jquery.sap.global','sap/ui/comp/library','sap/ui/core/Element','sap/ui/layout/ResponsiveFlowLayoutData','sap/ui/layout/form/FormContainer','./GroupElement'],function(q,l,E,R,F,G){"use strict";var a=F.extend("sap.ui.comp.smartform.Group",{metadata:{library:"sap.ui.comp",designTime:true,properties:{useHorizontalLayout:{type:"boolean",group:"Misc",defaultValue:null},horizontalLayoutGroupElementMinWidth:{type:"int",group:"Misc",defaultValue:null},label:{type:"string",group:"Misc",defaultValue:null}},defaultAggregation:"groupElements",aggregations:{groupElements:{type:"sap.ui.comp.smartform.GroupElement",multiple:true,singularName:"groupElement"},layout:{type:"sap.ui.layout.GridData",multiple:false}},_visibilityDerived:false}});a.prototype.init=function(){F.prototype.init.apply(this,arguments);var r=new R({"linebreak":true,"linebreakable":true});this.setLayoutData(r);this._updateFormContainerLabel();};a.prototype.setUseHorizontalLayout=function(v){this.setProperty("useHorizontalLayout",v);var g=this.getGroupElements();if(g){g.forEach(function(o){o.setUseHorizontalLayout(v);});}};a.prototype.setHorizontalLayoutGroupElementMinWidth=function(n){this.setProperty("horizontalLayoutGroupElementMinWidth",n);var g=this.getGroupElements();if(g){g.forEach(function(o){o.setHorizontalLayoutGroupElementMinWidth(n);});}};a.prototype.setEditMode=function(e){var g=this.getGroupElements();if(g){g.forEach(function(o){o.setEditMode(e);});}return this;};a.prototype._updateFormContainerLabel=function(){var t=this.getTitle();if(!t&&this.getLabel()){t=new sap.ui.core.Title(this.getId()+"--Title");this.setTitle(t);}if(t){t.setText(this.getLabel());}};a.prototype._delegateEditModeFromParent=function(g){var p=null;var e=false;if(g){p=this.getParent();if(p&&p.getEditable){e=p.getEditable();g.setEditMode(e);}}};a.prototype._updateLineBreaks=function(){if(!this.getUseHorizontalLayout()){return;}var s=this.getParent();while(!s._getCurrentSpan&&s.getParent){s=s.getParent();}if(!s._getCurrentSpan){return;}var c=s._getCurrentSpan();if(!c){return;}var e=this.getGroupElements();e=e.filter(function(o){return o.getVisible();});var C=0;e.forEach(function(o){C=C+1;var L=o.getFields()[0].getLayoutData();if(L){if(c*C>12){L.setLinebreak(true);C=1;}else{L.setLinebreak(false);}}});};a.prototype._updateFormContainerVisibility=function(){var A=this.getVisible();if(A===false&&this._visibilityDerived===false){return;}var g=this.getGroupElements();var v=false;v=g.some(function(o){return o.getVisible();});if(A!==v){this._visibilityDerived=true;F.prototype.setProperty.apply(this,["visible",v]);}};a.prototype.setProperty=function(p,v){F.prototype.setProperty.apply(this,arguments);if(p==='label'){this._updateFormContainerLabel();}if(p==='visible'){this._visibilityDerived=false;}};a.prototype.setVisible=function(v){this._visibilityDerived=false;F.prototype.setProperty.apply(this,['visible',v]);};a.prototype.addAggregation=function(A,o){var i=A;var t=this;if(A==="groupElements"){i="formElements";this._delegateEditModeFromParent(o);o.setHorizontalLayoutGroupElementMinWidth(this.getHorizontalLayoutGroupElementMinWidth());o.setUseHorizontalLayout(this.getUseHorizontalLayout());o.attachVisibleChanged(function(e){t._updateFormContainerVisibility(e);});}F.prototype.addAggregation.apply(this,[i,o]);};a.prototype.addGroupElement=function(g){this.addAggregation("groupElements",g);};a.prototype.getGroupElements=function(){return this.getFormElements();};a.prototype.setAggregation=function(A,o){var i=A;if(A==="layout"){i="layoutData";}F.prototype.setAggregation.apply(this,[i,o]);};a.prototype.addCustomData=function(c){F.prototype.addCustomData.apply(this,arguments);var g=this.getGroupElements();if(g){g.forEach(function(o){o.addCustomData(c.clone());});}return this;};a.prototype.insertGroupElement=function(g,i){var f=this.getParent();if(f&&f.getEditable){g.setEditMode(f.getEditable());}return this.insertFormElement(g,i);};a.prototype.removeGroupElement=function(g){var o=null;var b=[];var i=0;if(g instanceof G){o=g;}else{b=this.getGroupElements();if(b){if(typeof g==="number"){o=b[g];}else if(typeof g==="string"){for(i;i<b.length;i++){if(b[i].sId===g){o=b[i];break;}}}}}if(o){return this.removeFormElement(o);}else{return null;}};a.prototype.removeAllGroupElements=function(){return this.removeAllFormElements();};a.prototype.removeAggregation=function(A,o){if(A==="groupElements"){return this.removeGroupElement(o);}else{return E.prototype.removeAggregation.apply(this,arguments);}};a.prototype.removeAllAggregation=function(A){if(A==="groupElements"){return this.removeAllGroupElements();}else{return E.prototype.removeAllAggregation.apply(this,arguments);}};a.prototype.destroyGroupElements=function(){return this.destroyFormElements();};return a;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.smartform.flexibility.FormP13nHandler')){
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.ui.comp.smartform.flexibility.FormP13nHandler');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.m.Dialog');jQuery.sap.require('sap.m.FlexBox');jQuery.sap.require('sap.m.FlexItemData');jQuery.sap.require('sap.m.Text');jQuery.sap.require('sap.m.Button');jQuery.sap.require('sap.m.DialogType');jQuery.sap.require('sap.ui.core.mvc.XMLView');jQuery.sap.require('sap.ui.fl.Utils');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.fl.FlexControllerFactory');jQuery.sap.require('sap.m.MessageBox');jQuery.sap.require('sap.ui.fl.Transports');jQuery.sap.require('sap.ui.fl.registry.Settings');sap.ui.define("sap/ui/comp/smartform/flexibility/FormP13nHandler",["jquery.sap.global","sap/m/Dialog","sap/m/FlexBox","sap/m/FlexItemData","sap/m/Text","sap/m/Button","sap/m/DialogType","sap/ui/core/mvc/XMLView","sap/ui/comp/smartform/SmartForm","sap/ui/comp/smartform/Group","sap/ui/comp/smartform/GroupElement","sap/ui/comp/odata/FieldSelector","sap/ui/fl/Utils","sap/ui/model/json/JSONModel","sap/ui/fl/FlexControllerFactory","sap/m/MessageBox","sap/ui/comp/transport/TransportSelection","sap/ui/fl/Transports","sap/ui/fl/registry/Settings"],function(q,D,F,a,T,B,b,X,S,d,e,f,g,J,h,M,l,m,n){"use strict";var o=function(){this._oOriginalDataModelForDialog=null;};o.prototype.init=function(s){var p;this._oSmartForm=s;this._oDialogContent=null;this._textResources=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");this._oDialog=this._createDialog();var t=this;this._mergeErrorOccured=false;var c=this._getFlexController();if(this._oSmartForm){p={appDescriptor:g.getAppDescriptor(this._oSmartForm),siteId:g.getSiteId(this._oSmartForm)};}return n.getInstance(c.getComponentName(),p).then(function(i){if(!i.hasMergeErrorOccured()){t._oDialog.setContentHeight("60%");t._oDialog.setTitle(t._textResources.getText("FORM_PERS_DIALOG_TITLE"));t._oDialogContent=t._createDialogContent();t._oDialog.addContent(t._oDialogContent);}else{t._mergeErrorOccured=true;t._oDialog.setType(b.Message);t._oDialog.setTitle(t._textResources.getText("FORM_PERS_DIALOG_ERR_TITLE"));t._showMergeErrorMessageInDialog();}t._createButtons(i);});};o.prototype._createDialog=function(){var c;c=new D("smartFormPersDialog",{contentWidth:"60%",verticalScrolling:false,horizontalScrolling:false,afterClose:[this._destroyDialog,this]});return c;};o.prototype._createButtons=function(s){var O=new B(this._oDialog.getId()+'-OkButton');O.setText(this._textResources.getText("FORM_PERS_DIALOG_OK"));O.attachPress(this._dialogOkClicked.bind(this));this._oDialog.addButton(O);var c=new B(this._oDialog.getId()+'-CancelButton');c.setText(this._textResources.getText("FORM_PERS_DIALOG_CANCEL"));c.attachPress({sAction:"cancel"},this._closeDialog,this);this._oDialog.addButton(c);var i=new B(this._oDialog.getId()+'-RestoreButton');i.setText(this._textResources.getText("FORM_PERS_DIALOG_RESET"));i.attachPress({sAction:"discard"},this._confirmDiscardAllChanges,this);this._oDialog.addButton(i);if(!s.isProductiveSystem()&&!s.hasMergeErrorOccured()){var t=new B(this._oDialog.getId()+'-TransportButton');t.setText(this._textResources.getText("FORM_PERS_DIALOG_TRANSPORT"));t.attachPress({sAction:"transport"},this._confirmTransportAllChanges,this);if(this._oDialog){this._oDialog.addButton(t);}}};o.prototype._showTransportErrorMessage=function(E){return this._showMessage(M.Icon.ERROR,"FORM_PERS_TRANSPORT_ERROR_TITLE","FORM_PERS_TRANSPORT_ERROR_MESSAGE",E);};o.prototype._openTransportSelection=function(c,s){var t=this;return new Promise(function(r,i){var O=function(R){if(R&&R.getParameters){var p=R.getParameters().selectedTransport;var P=R.getParameters().selectedPackage;var u=R.getParameters().dialog;var v={transport:p,packageName:P,fromDialog:u};r(v);}else{r({});}};var E=function(p){if(s&&(p.sId===''||p.sId==='cancel')){r();}t._showTransportErrorMessage(p).then(function(){i(p);});};var j={};if(c){j["package"]=c.getPackage();j.namespace=c.getNamespace();j.name=c.getId();j.type=c.getDefinition().fileType;}var k=new sap.ui.comp.transport.TransportSelection();k.selectTransport(j,O,E,false,t._oSmartForm);});};o.prototype._dialogOkClicked=function(){var c=[];if(!this._mergeErrorOccured){c=this._getChangeDataFromDialog();}if(c.length===0){this._closeDialog();return new Promise(function(r,i){r({});});}var t=this;return t._createAndApplyChanges(c).then(function(){t._closeDialog();});};o.prototype._createAndApplyChanges=function(c){var t=this;return Promise.resolve().then(function(){var i;i=t._getFlexController();function v(C){return C&&C.selector&&C.selector.id;}c.filter(v).forEach(function(C){var j=t._getControlById(C.selector.id);i.createAndApplyChange(C,j);});})['catch'](function(E){g.log.error("Create and apply error: "+E);return E;}).then(function(E){return t._getFlexController().saveAll().then(function(){if(E){throw E;}});})['catch'](function(E){g.log.error("Create and apply and/or save error: "+E);return t._showApplySaveChangesErrorMessage(E);});};o.prototype._getControlById=function(c){return sap.ui.getCore().byId(c);};o.prototype._getFlexController=function(){return h.createForControl(this._oSmartForm);};o.prototype._createDialogContent=function(){var c,j,C;if(!this._oSmartForm){return undefined;}j=this._createModelFromSmartForm(this._oSmartForm);j.isMoveDownButtonEnabled=false;j.isMoveUpButtonEnabled=false;j.isMoveBottomButtonEnabled=false;j.isMoveTopButtonEnabled=false;this._oOriginalDataModelForDialog=JSON.parse(JSON.stringify(j));this._oModel=new J();this._oModel.setData(j);c=new sap.ui.comp.smartform.flexibility.DialogContent(this._oDialog.getId()+'-Content');c.setModel(this._oModel);var v=g.getViewForControl(this._oSmartForm);c.setViewId(v.createId(""));var i=this._getIgnoredFields(this._oSmartForm);C=g.getComponentClassName(this._oSmartForm);var p={appDescriptor:g.getAppDescriptor(this._oSmartForm),siteId:g.getSiteId(this._oSmartForm)};c.initialiseODataFieldSelector(this._oSmartForm.getModel(),this._oSmartForm.getEntityType(),C,i,this._mBindingPathToFieldListElement,this._mIdToFieldListElement,p);return c;};o.prototype._getIgnoredFields=function(s){if(s){var c=s.getIgnoredFields();if(c){var i=c.split(",");return i;}}return[];};o.prototype._createChangeSpecificDataFromDialogModel=function(j,c){var C=[],k;var p={};this._createNodeMap(j,p);var r={};this._createNodeMap(c,r);var i,I,N,s,t;var u=Object.keys(p);for(i=0;i<u.length;i++){I=u[i];if(r[I]&&r[I].node){N=p[I].node;s=r[I].node;if(N.label&&s.label&&N.label!==s.label){k=this._createLabelChange(I,s.label,s.type);if(k&&k.selector&&k.selector.id){C.push(k);}}if((N.isVisible&&!s.isVisible)||(!N.isVisible&&s.isVisible)){if(s.isVisible){t=true;}else{t=false;}C.push(this._createVisibilityChange(I,t));}}}var P={};for(i=0;i<c.length;i++){this._check4AddChanges(c[i],p,C,P);}for(i=0;i<c.length;i++){this._check4InterMoveChanges(c[i],r,p,C,P);this._check4IntraMoveChanges(c[i],r,p,C,P);}return C;};o.prototype._check4AddChanges=function(p,c,C,P){if(p&&p.id&&p.children){var i,s=0,I,j,k;j=p.id;if(c[j]&&c[j].node){var r=c[j].node;if(!P){P={};}P[j]={};P[j].index={};for(i=0;i<r.children.length;i++){k=r.children[i];I=k.id;P[j].index[I]=i;}}for(i=0;i<p.children.length;i++){k=p.children[i];if(k.id){I=k.id;if(!c[I]){var t=this._createAddChange(j,k,i);if(t&&t.selector&&t.selector.id){C.push(t);s++;if(!k.isVisible){C.push(this._createVisibilityChange(I,false));}}}else if(s>0&&P[j]&&P[j].index[I]!==undefined){P[j].index[I]=P[j].index[I]+s;}this._check4AddChanges(k,c,C,P);}}}};o.prototype._check4InterMoveChanges=function(p,c,r,C,P){if(p&&p.id&&p.children){var i,I,s,t,u=[],v={},w,x={};s=p.id;var L=p.children.length;for(i=0;i<L;i++){w=p.children[i];if(w.id){I=w.id;if(r[I]&&r[I].index!==undefined){if(!r[I].index[s]&&r[I].index[s]!==0){var j,y=[];y=Object.keys(r[I].index);for(j=0;j<y.length;j++){t=y[j];if(!v[t]){v[t]=[];}v[t].push({"id":I,"index":c[I].index[s]});var z,A=[],E,k;if(P[t]&&P[t].index[I]!==undefined){E=P[t].index[I];delete P[t].index[I];A=Object.keys(P[t].index);for(k=0;k<A.length;k++){z=A[k];if(P[t].index[z]>E){P[t].index[z]--;}}}if(P[s]){E=c[I].index[s];A=Object.keys(P[s].index);for(k=0;k<A.length;k++){z=A[k];if(P[s].index[z]>=E){P[s].index[z]++;}}P[s].index[I]=E;}}}}this._check4InterMoveChanges(w,c,r,C,P);}}if(v){u=Object.keys(v);for(i=0;i<u.length;i++){t=u[i];x=this._createMoveChange(t,p.type,v[t],p.id);if(x&&x.selector&&x.selector.id){C.push(x);}}}}};o.prototype._check4IntraMoveChanges=function(p,c,j,C,P){if(p&&p.id&&p.children){var i,I,s,k=[],r,t={};s=p.id;var L=p.children.length;for(i=0;i<L;i++){r=p.children[i];if(r.id){I=r.id;if(j[I]&&j[I].index!==undefined){if(j[I].index[s]!==undefined&&j[I].index[s]!==i){if(P[s]&&P[s].index[I]!==undefined&&P[s].index[I]!==i){k.push({"id":I,"index":c[I].index[s]});}}}this._check4IntraMoveChanges(r,c,j,C,P);}}if(k.length>0){t=this._createMoveChange(s,p.type,k,"");if(t&&t.selector&&t.selector.id){C.push(t);}}}};o.prototype._createAddChange=function(i,N,I){var A={};A.selector={};A.selector.id=i;A.index=I;A.newControlId=N.id;switch(N.type){case"form":A={};break;case"group":A.changeType="addGroup";if(!N.label){A.groupLabel="";}else{A.groupLabel=N.label;}break;case"field":A.changeType="addField";if(!N.label){A.fieldLabel="";}else{A.fieldLabel=N.label;}if(!N.fieldValue){A.fieldValue="";}else{A.fieldValue=N.fieldValue;}if(!N.valueProperty){A.valueProperty="";}else{A.valueProperty=N.valueProperty;}if(!N.jsType){A.jsType="";}else{A.jsType=N.jsType;}break;default:A={};break;}return A;};o.prototype._createLabelChange=function(i,L,t){var c={};c.selector={};c.selector.id=i;switch(t){case"form":c={};break;case"group":c.changeType="renameGroup";c.groupLabel=L;break;case"field":c.changeType="renameField";c.fieldLabel=L;break;default:c={};break;}return c;};o.prototype._createMoveChange=function(i,t,I,s){var c={};c.selector={};c.selector.id=i;switch(t){case"form":c.changeType="moveGroups";c.moveGroups=I;break;case"group":c.changeType="moveFields";c.moveFields=I;break;default:c={};break;}if(s){c.targetId=s;}return c;};o.prototype._createVisibilityChange=function(i,I){var v={};v.selector={};v.selector.id=i;if(I===true){v.changeType="unhideControl";}else{v.changeType="hideControl";}return v;};o.prototype._createNodeMap=function(j,N,p){if(!N){throw new Error("Node map instance must be provided");}if(!j||!j.length){return;}var c,I;var i,L=j.length;for(i=0;i<L;i++){c=j[i];if(c&&c.id){I=c.id;if(!N[I]){N[I]={};N[I].node=c;}if(p&&p.id){if(!N[I].index){N[I].index={};}N[I].index[p.id]=i;}if(c.children){this._createNodeMap(c.children,N,c);}}}};o.prototype.show=function(){this._oDialog.open();};o.prototype._showMergeErrorMessageInDialog=function(){var c=new F();c.setDirection("Column");c.setAlignItems("Start");var i=new T();i.setText(this._textResources.getText("FORM_PERS_DIALOG_ERR_DESC"));i.setLayoutData(new a({order:1,growFactor:1}));var j=new T();j.setText(this._textResources.getText("FORM_PERS_DIALOG_ERR_HINT"));j.setLayoutData(new a({order:1,growFactor:1}));c.addItem(i);c.addItem(j);this._oDialog.addContent(c);};o.prototype._closeDialog=function(){if(this._oDialog){this._oDialog.close();}this._destroyDialog();};o.prototype._destroyDialog=function(){if(this._oDialogContent){this._oDialogContent.destroy();this._oDialogContent=null;}if(this._oDialog){this._oDialog.destroy();this._oDialog=null;}};o.prototype._createSmartFormControlMap=function(s){var c=[];var C;if(s){C=s.getId();c[C]=s;var G=s.getGroups();if(G){for(var i=0;i<G.length;i++){var k=G[i];if(k){C=k.getId();c[C]=k;var p=k.getGroupElements();if(p){for(var j=0;j<p.length;j++){var r=p[j];if(r){C=r.getId();c[C]=r;}}}}}}}return c;};o.prototype._showDiscardSuccessMessage=function(){return this._showMessage(M.Icon.SUCCESS,"FORM_PERS_DISCARD_SUCCESS_TITLE","FORM_PERS_DISCARD_SUCCESS_MESSAGE");};o.prototype._showTransportSuccessMessage=function(){return this._showMessage(M.Icon.SUCCESS,"FORM_PERS_TRANSPORT_SUCCESS_TITLE","FORM_PERS_TRANSPORT_SUCCESS_MESSAGE");};o.prototype._showTransportInapplicableMessage=function(){return this._showMessage(M.Icon.INFORMATION,"FORM_PERS_TRANSPORT_INAPPLICABLE_TITLE","FORM_PERS_TRANSPORT_INAPPLICABLE_MESSAGE");};o.prototype._showDiscardErrorMessage=function(E){return this._showMessage(M.Icon.ERROR,"FORM_PERS_DISCARD_ERROR_TITLE","FORM_PERS_DISCARD_ERROR_MESSAGE",E);};o.prototype._showApplySaveChangesErrorMessage=function(E){return this._showMessage(M.Icon.ERROR,"FORM_PERS_APPLYSAVE_ERROR_TITLE","FORM_PERS_APPLYSAVE_ERROR_MESSAGE",E);};o.prototype._showMessage=function(c,t,s,E){return new Promise(function(r){if(E&&(E.sId===''||E.sId==='cancel')){r();}else{var i,j;if(E){j=[E.message||E];i=this._textResources.getText(s,j);}i=this._textResources.getText(s);var k=this._textResources.getText(t);M.show(i,{icon:c,title:k,onClose:r});}}.bind(this));};o.prototype._filterChangesForSmartForm=function(c,s){var r=[];var j=this._createSmartFormControlMap(s);for(var i=0;i<c.length;i++){var C=c[i];var k=C.getSelector().id;if(j[k]){r.push(C);}}return r;};o.prototype._setTransports=function(c,C,t,i){var j=this;if(C>=0){var k=c[C];if(i===true){if(k.getDefinition().packageName!=="$TMP"){k.setRequest(t);}C--;return j._setTransports(c,C,t,i);}else{if(k.getDefinition().packageName!=="$TMP"){return j._openTransportSelection(k).then(function(p){k.setRequest(p.transport);if(p.fromDialog===true){t=p.transport;i=true;}C--;return j._setTransports(c,C,t,i);});}else{C--;return j._setTransports(c,C,t,i);}}}else{return Promise.resolve();}};o.prototype._deleteChanges=function(c,s){var t=this;var i=this._filterChangesForSmartForm(c,s);var j=t._getFlexController();var C=i.length-1;return this._setTransports(i,C).then(function(){return j.discardChanges(i);}).then(function(){return t._showDiscardSuccessMessage();})["catch"](function(E){return t._showDiscardErrorMessage(E);});};o.prototype._confirmDiscardAllChanges=function(){var t=this;var p={appDescriptor:g.getAppDescriptor(t._oSmartForm),siteId:g.getSiteId(t._oSmartForm)};var c=function(A){if(A==="OK"){var j=t._getFlexController();j.getComponentChanges(p).then(function(C){var k=t._convertToChangeArray(C);return t._deleteChanges(k,t._oSmartForm);})["catch"](function(E){return t._showDiscardErrorMessage();}).then(function(){t._closeDialog();});}};var s=this._textResources.getText("FORM_PERS_RESET_MESSAGE");var i=this._textResources.getText("FORM_PERS_RESET_TITLE");M.confirm(s,{title:i,onClose:c});};o.prototype._confirmTransportAllChanges=function(){var t=this;return Promise.resolve().then(c)['catch'](i).then(j).then(k).then(p).then(r)['catch'](s).then(u);function c(){var C=t._getChangeDataFromDialog();if(C.length>0){return t._createAndApplyChanges(C);}}function i(E){g.log.error("SmartForm changes could not be applied or saved: "+E);return t._showApplySaveChangesErrorMessage(E).then(function(){throw new Error('createAndApply failed');});}function j(){return t._getAllLocalChanges();}function k(A){return!!A.length;}function p(v){if(v){return t._openTransportSelection(null,true);}else{return t._showTransportInapplicableMessage();}}function r(v){if(v&&v.transport&&v.packageName!=="$TMP"){return t._transportAllLocalChanges(v);}}function s(E){if(E.message==='createAndApply failed'){return;}g.log.error("transport error"+E);return t._showTransportErrorMessage(E);}function u(){t._closeDialog();}};o.prototype._getChangeDataFromDialog=function(){var c,C;c=this._oModel.getData();C=this._createChangeSpecificDataFromDialogModel([this._oOriginalDataModelForDialog],[c]);return C;};o.prototype._getAllLocalChanges=function(){var t=this;var p={appDescriptor:g.getAppDescriptor(t._oSmartForm),siteId:g.getSiteId(t._oSmartForm)};return t._getFlexController().getComponentChanges(p).then(function(c){var A=t._convertToChangeArray(c);return t._filterChangesForSmartForm(A,t._oSmartForm);});};o.prototype._transportAllLocalChanges=function(t){var c=this;return c._getAllLocalChanges().then(function(A){var i=c._convertToChangeTransportData(A);var j=new m();var k={};k.transportId=t.transport;k.changeIds=i;return j.makeChangesTransportable(k).then(function(){A.forEach(function(C){if(C.getPackage()==='$TMP'){var p=C.getDefinition();p.packageName='';C.setResponse(p);}});}).then(function(){return c._showTransportSuccessMessage();});});};o.prototype._convertToChangeTransportData=function(L){var t=[];var c=L.length;for(var i=0;i<c;i++){var C=L[i];var j={};j.namespace=C.getNamespace();j.fileName=C.getId();j.fileType=C.getDefinition().fileType;t.push(j);}return t;};o.prototype._convertToChangeArray=function(c){var C=c;if(!q.isArray(c)){C=[];var k=Object.keys(c);for(var i=0;i<k.length;i++){C.push(c[k[i]]);}}return C;};o.prototype._createModelFromSmartForm=function(s){var c,j,i,p,r,t,k,u;var v=this;this._mBindingPathToFieldListElement={};this._mIdToFieldListElement={};if(s){c=this._getModelNodeForSmartForm(s);j=s.getGroups();if(j){for(i=0;i<j.length;i++){p=j[i];if(!g.checkControlId(p)){continue;}r=this._getModelNodeForSmartGroup(p);c.children.push(r);if(p){t=p.getGroupElements();if(t){for(k=0;k<t.length;k++){if(!g.checkControlId(t[k])){continue;}var G=t[k];u=this._getModelNodeForSmartGroupElement(G);var w=!!(u.label);if(w){r.children.push(u);q.each(u.bindingPaths,function(x,y){v._mBindingPathToFieldListElement[y.path]=u;});this._mIdToFieldListElement[u.id]=u;}}}}}}}return c;};o.prototype._getModelNodeForSmartForm=function(s){var r={};r.id=s.getId();r.label=s.getTitle();r.isVisible=s.getVisible();r.type="form";r.children=[];return r;};o.prototype._getModelNodeForSmartGroup=function(s){var r={};r.id=s.getId();r.label=s.getLabel();r.isVisible=s.getVisible();r.type="group";r.children=[];return r;};o.prototype._determineRelevantBindingPathsOf=function(C,i){var t=this;if(!i){i=[];}if((!C)||(!C.getMetadata)){return;}var j=C.getMetadata();if(j){var p=j.getAllProperties();q.each(p,function(c,k){var r=c==='text'||c==='value'||c==='selected'||c==='selectedKey';if(r){var s=C.getBinding(c);if(s){var u=s.getPath();if(u){var v=t._getAbsoluteBindingPath(C,u);var I=function(w){return(w.path===v);};if(!i.some(I)){i.push({path:v});}}}}});var A=j.getAllAggregations();q.each(A,function(k,r){var v=C.getAggregation(k);if(!q.isArray(v)){var s=[];s.push(v);v=s;}if(v){for(var c=0;c<v.length;c++){t._determineRelevantBindingPathsOf(v[c],i);}}});}return i;};o.prototype._getAbsoluteBindingPath=function(c,s){var p='';var i=c.getModel();if(i){var j=i.getMetaModel();if(j){var k=c.getBindingContext();if(k){var r=k.getPath();if(r){var t=j.getMetaContext(r);if(t){var u=t.sPath;if(u){var E=j.getObject(u).name;if(E){p=p+E+'/';}}}}}}}return p+s;};o.prototype._getModelNodeForSmartGroupElement=function(G){var r={};r.id=G.getId();r.label=G.getLabelText();r.isVisible=G.getVisible();if(r.isVisible){r.isVisible=G.getVisibleBasedOnElements();}r.type="field";r.bindingPaths=this._determineRelevantBindingPathsOf(G);return r;};return o;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.smarttable.SmartTable')){
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.ui.comp.smarttable.SmartTable');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.m.VBoxRenderer');jQuery.sap.require('sap.m.Column');jQuery.sap.require('sap.m.Label');jQuery.sap.require('sap.m.MessageBox');jQuery.sap.require('sap.m.Table');jQuery.sap.require('sap.m.Text');jQuery.sap.require('sap.m.Title');jQuery.sap.require('sap.m.OverflowToolbar');jQuery.sap.require('sap.m.OverflowToolbarButton');jQuery.sap.require('sap.m.ToolbarSeparator');jQuery.sap.require('sap.m.VBox');jQuery.sap.require('sap.ui.model.FilterOperator');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.table.AnalyticalColumn');jQuery.sap.require('sap.ui.table.AnalyticalTable');jQuery.sap.require('sap.ui.table.Column');jQuery.sap.require('sap.ui.table.Table');jQuery.sap.require('sap.ui.table.TreeTable');sap.ui.define("sap/ui/comp/smarttable/SmartTable",['jquery.sap.global','sap/m/VBoxRenderer','sap/m/Column','sap/m/Label','sap/m/MessageBox','sap/m/Table','sap/m/Text','sap/m/Title','sap/m/OverflowToolbar','sap/m/OverflowToolbarButton','sap/m/ToolbarSeparator','sap/m/VBox','sap/ui/comp/library','sap/ui/comp/providers/TableProvider','sap/ui/comp/smartfilterbar/FilterProvider','sap/ui/comp/smartvariants/SmartVariantManagement','sap/ui/model/FilterOperator','sap/ui/model/json/JSONModel','sap/ui/table/AnalyticalColumn','sap/ui/table/AnalyticalTable','sap/ui/table/Column','sap/ui/table/Table','sap/ui/table/TreeTable','sap/ui/comp/personalization/Util','sap/ui/comp/util/FormatUtil','sap/ui/comp/odata/ODataModelUtil'],function(q,V,C,L,M,R,T,a,O,b,c,d,l,f,F,S,g,J,A,h,j,k,m,P,n,o){"use strict";var p=d.extend("sap.ui.comp.smarttable.SmartTable",{metadata:{library:"sap.ui.comp",designTime:true,properties:{entitySet:{type:"string",group:"Misc",defaultValue:null},smartFilterId:{type:"string",group:"Misc",defaultValue:null},ignoredFields:{type:"string",group:"Misc",defaultValue:null},initiallyVisibleFields:{type:"string",group:"Misc",defaultValue:null},requestAtLeastFields:{type:"string",group:"Misc",defaultValue:null},ignoreFromPersonalisation:{type:"string",group:"Misc",defaultValue:null},tableType:{type:"sap.ui.comp.smarttable.TableType",group:"Misc",defaultValue:null},useVariantManagement:{type:"boolean",group:"Misc",defaultValue:true},useExportToExcel:{type:"boolean",group:"Misc",defaultValue:true},useTablePersonalisation:{type:"boolean",group:"Misc",defaultValue:true},showRowCount:{type:"boolean",group:"Misc",defaultValue:true},header:{type:"string",group:"Misc",defaultValue:null},toolbarStyleClass:{type:"string",group:"Misc",defaultValue:null},enableCustomFilter:{type:"boolean",group:"Misc",defaultValue:true},persistencyKey:{type:"string",group:"Misc",defaultValue:null},useOnlyOneSolidToolbar:{type:"boolean",group:"Misc",defaultValue:false},currentVariantId:{type:"string",group:"Misc",defaultValue:null},editable:{type:"boolean",group:"Misc",defaultValue:false},enableAutoBinding:{type:"boolean",group:"Misc",defaultValue:false},tableBindingPath:{type:"string",group:"Misc",defaultValue:null},editTogglable:{type:"boolean",group:"Misc",defaultValue:false},demandPopin:{type:"boolean",group:"Misc",defaultValue:false}},aggregations:{customToolbar:{type:"sap.m.Toolbar",multiple:false},semanticObjectController:{type:"sap.ui.comp.navpopover.SemanticObjectController",multiple:false},noData:{type:"sap.ui.core.Control",altTypes:["string"],multiple:false}},events:{initialise:{},beforeRebindTable:{},editToggled:{},dataReceived:{},afterVariantInitialise:{},afterVariantSave:{},afterVariantApply:{},showOverlay:{},fieldChange:{}}},renderer:V.render});p.prototype.init=function(){sap.m.FlexBox.prototype.init.call(this);this.addStyleClass("sapUiCompSmartTable");this.setFitContainer(true);this.setHeight("100%");};p.prototype._createVariantManagementControl=function(){if(this._oVariantManagement||(!this.getUseVariantManagement()&&!this.getUseTablePersonalisation())||!this.getPersistencyKey()){return;}var e=new sap.ui.comp.smartvariants.PersonalizableInfo({type:"table",keyName:"persistencyKey",dataSource:"TODO"});e.setControl(this);this._oVariantManagement=new sap.ui.comp.smartvariants.SmartVariantManagement(this.getId()+"-variant",{personalizableControls:e,initialise:function(E){if(!this._oCurrentVariant){this._oCurrentVariant="STANDARD";}this.fireAfterVariantInitialise();}.bind(this),afterSave:function(){this.fireAfterVariantSave({currentVariantId:this.getCurrentVariantId()});}.bind(this),showShare:true});this._oVariantManagement.initialise();};p.prototype.setUseExportToExcel=function(u){if(u===this.getUseExportToExcel()){return;}this.setProperty("useExportToExcel",u,true);if(this._oToolbar){this._createToolbarContent();}};p.prototype.setUseTablePersonalisation=function(u){this.setProperty("useTablePersonalisation",u,true);};p.prototype.setUseVariantManagement=function(u){this.setProperty("useVariantManagement",u,true);if(this._oPersController){this._oPersController.setResetToInitialTableState(!u);}};p.prototype.setToolbarStyleClass=function(s){this.setProperty("toolbarStyleClass",s,true);};p.prototype.setCustomToolbar=function(e){if(this._oCustomToolbar){this.removeItem(this._oCustomToolbar);}this._oCustomToolbar=e;};p.prototype.getCustomToolbar=function(){return this._oCustomToolbar;};p.prototype.setHeader=function(t){this.setProperty("header",t,true);this._refreshHeaderText();};p.prototype.setShowRowCount=function(s){this.setProperty("showRowCount",s,true);this._refreshHeaderText();};p.prototype.setEditTogglable=function(t){this.setProperty("editTogglable",t,true);};p.prototype.setEditable=function(e){this.setProperty("editable",e,true);};p.prototype.setDemandPopin=function(D){var e=this.getDemandPopin();if(e===D){return;}this.setProperty("demandPopin",D,true);if(this.bIsInitialised){if(D){this._updateColumnsPopinFeature();}else{this._deactivateColumnsPopinFeature();}}};p.prototype._refreshHeaderText=function(){if(!this._headerText){return;}var t=this.getHeader();if(this.getShowRowCount()){var r=parseInt(this._getRowCount(),10);q.sap.require("sap.ui.core.format.NumberFormat");var v=sap.ui.core.format.NumberFormat.getFloatInstance().format(r);t+=" ("+v+")";}this._headerText.setText(t);};p.prototype._createToolbar=function(){var e=null;if(!this._oToolbar){e=this.getCustomToolbar();if(e){this._oToolbar=e;}else{this._oToolbar=new O({design:sap.m.ToolbarDesign.Transparent});this._oToolbar.addStyleClass("sapUiCompSmartTableToolbar");if(this.getToolbarStyleClass()){this._oToolbar.addStyleClass(this.getToolbarStyleClass());}}this._oToolbar.setLayoutData(new sap.m.FlexItemData({shrinkFactor:0}));this.insertItem(this._oToolbar,0);}};p.prototype._createToolbarContent=function(){if(!this._oToolbar){this._createToolbar();}this._addVariantManagementToToolbar();this._addSeparatorToToolbar();this._addHeaderToToolbar();this._addSpacerToToolbar();this._addEditTogglableToToolbar();this._addTablePersonalisationToToolbar();this._addExportToExcelToToolbar();if(this._oToolbar&&(this._oToolbar.getContent().length===0||(this._oToolbar.getContent().length===1&&this._oToolbar.getContent()[0]instanceof sap.m.ToolbarSpacer))){this.removeItem(this._oToolbar);this._oToolbar.destroy();this._oToolbar=null;}};p.prototype._addEditTogglableToToolbar=function(){var B;if(this.getEditTogglable()){if(!this._oEditButton){B=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("TABLE_EDITTOGGLE_TOOLTIP");this._oEditButton=new sap.m.OverflowToolbarButton(this.getId()+"-btnEditToggle",{icon:this.getEditable()?"sap-icon://display":"sap-icon://edit",text:B,tooltip:B,press:function(){var e=this.getEditable();e=!e;this.setEditable(e,true);this._oEditButton.setIcon(e?"sap-icon://display":"sap-icon://edit");this.fireEditToggled({editable:e});}.bind(this)});}this._oToolbar.addContent(this._oEditButton);}else if(this._oEditButton){this._oToolbar.removeContent(this._oEditButton);}};p.prototype._addHeaderToToolbar=function(){if(this.getHeader()){if(!this._headerText){this._headerText=new a(this.getId()+"-header");this._headerText.addStyleClass("sapMH4Style");this._headerText.addStyleClass("sapUiCompSmartTableHeader");}this._refreshHeaderText();this._oToolbar.insertContent(this._headerText,0);}else if(this._headerText){this._oToolbar.removeContent(this._headerText);}};p.prototype._addSeparatorToToolbar=function(){if(this.getHeader()&&this.getUseVariantManagement()){if(!this._oSeparator){this._oSeparator=new c(this.getId()+"-toolbarSeperator");}this._oToolbar.insertContent(this._oSeparator,0);if(!this._oToolbar.getHeight()){this._oToolbar.addStyleClass("sapUiCompSmartTableToolbarHeight");}}else if(this._oSeparator){this._oToolbar.removeContent(this._oSeparator);}};p.prototype._addVariantManagementToToolbar=function(){if(this.getUseVariantManagement()){this._oToolbar.insertContent(this._oVariantManagement,0);}else if(this._oVariantManagement){this._oToolbar.removeContent(this._oVariantManagement);}};p.prototype._addSpacerToToolbar=function(){var e=false,I=this._oToolbar.getContent(),i,r;if(I){r=I.length;i=0;for(i;i<r;i++){if(I[i]instanceof sap.m.ToolbarSpacer){e=true;break;}}}if(!e){this._oToolbar.addContent(new sap.m.ToolbarSpacer(this.getId()+"-toolbarSpacer"));}};p.prototype._addTablePersonalisationToToolbar=function(){var B;if(this.getUseTablePersonalisation()){if(!this._oTablePersonalisationButton){B=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("TABLE_PERSOBTN_TOOLTIP");this._oTablePersonalisationButton=new sap.m.OverflowToolbarButton(this.getId()+"-btnPersonalisation",{icon:"sap-icon://action-settings",text:B,tooltip:B,press:function(e){this._oPersController.openDialog();}.bind(this)});}this._oToolbar.addContent(this._oTablePersonalisationButton);}else if(this._oTablePersonalisationButton){this._oToolbar.removeContent(this._oTablePersonalisationButton);}};p.prototype._addExportToExcelToToolbar=function(){if(this.getUseExportToExcel()&&this._bTableSupportsExcelExport){var t=this,B;if(!this._oUseExportToExcel){B=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("TABLE_EXPORT_TEXT");this._oUseExportToExcel=new sap.m.OverflowToolbarButton(this.getId()+"-btnExcelExport",{icon:"sap-icon://excel-attachment",text:B,tooltip:B,press:function(e){var D=function(){var i=t._getRowBinding();var u=i.getDownloadUrl("xlsx");u=t._removeExpandParameter(u);window.open(u);};var r=t._getRowCount();if(r>10000){M.confirm(sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("DOWNLOAD_CONFIRMATION_TEXT",r),{actions:[M.Action.YES,M.Action.NO],onClose:function(i){if(i===M.Action.YES){D();}}});}else{D();}}});this._setExcelExportEnableState();}this._oToolbar.addContent(this._oUseExportToExcel);}else if(this._oUseExportToExcel){this._oToolbar.removeContent(this._oUseExportToExcel);}};p.prototype._adjustUrlToVisibleColumns=function(u){var v=this._getVisibleColumnPaths();var s=u.replace(new RegExp("([\\?&]\\$select=)[^&]+"),function(r,e){if(v&&v.length){return e+q.sap.encodeURL(v.join(","));}else{return"";}});return s;};p.prototype._removeExpandParameter=function(u){var s=u.replace(new RegExp("([\\?&]\\$expand=[^&]+)(&?)"),function(r,e,i){return i?e.substring(0,1):"";});return s;};p.prototype._getRowCount=function(){var r=this._getRowBinding();if(!r){return 0;}var i=0;if(r.getTotalSize){i=r.getTotalSize();}else{i=r.getLength();}if(i<0||i==="0"){i=0;}return i;};p.prototype._setExcelExportEnableState=function(){if(this._oUseExportToExcel){var r=this._getRowCount();if(r>0){this._oUseExportToExcel.setEnabled(true);}else{var e;if(this._isMobileTable){e=this._oTable.getItems();}else{e=this._oTable.getRows();}var E=e!=null&&e.length>0&&e[0].getBindingContext()!=null;this._oUseExportToExcel.setEnabled(E);}}};p.prototype._createPersonalizationController=function(){if(this._oPersController||!this.getUseTablePersonalisation()){return;}var s=this.data("p13nDialogSettings");if(typeof s==="string"){try{s=JSON.parse(s);}catch(e){s=null;}}s=this._setIgnoreFromPersonalisationToSettings(s);q.sap.require("sap.ui.comp.personalization.Controller");this._oPersController=new sap.ui.comp.personalization.Controller({table:this._oTable,setting:s,resetToInitialTableState:!this.getUseVariantManagement(),beforePotentialTableChange:this._beforePersonalisationModelDataChange.bind(this),afterPotentialTableChange:this._afterPersonalisationModelDataChange.bind(this),afterP13nModelDataChange:this._personalisationModelDataChange.bind(this)});};p.prototype._setIgnoreFromPersonalisationToSettings=function(s){var i=P.createArrayFromString(this.getIgnoreFromPersonalisation());if(i.length){if(!s){s={};}var e=function(r){if(!s[r]){s[r]={};}s[r].ignoreColumnKeys=i;};e("filter");e("sort");e("group");e("columns");}return s;};p.prototype._getRowBinding=function(){if(this._oTable){return this._oTable.getBinding(this._sAggregation);}};p.prototype.setEntitySet=function(e){this.setProperty("entitySet",e);this._initialiseMetadata();};p.prototype.propagateProperties=function(){d.prototype.propagateProperties.apply(this,arguments);this._initialiseMetadata();};p.prototype._initialiseMetadata=function(){if(!this.bIsInitialised){o.handleModelInit(this,this._onMetadataInitialised);}};p.prototype._onMetadataInitialised=function(){this._bMetaModelLoadAttached=false;if(!this.bIsInitialised){this._createTableProvider();if(this._oTableProvider){this._aTableViewMetadata=this._oTableProvider.getTableViewMetadata();if(this._aTableViewMetadata){if(!this._isMobileTable&&this.getDemandPopin()){this.setDemandPopin(false);q.sap.log.error("use SmartTable property 'demandPopin' only  with responsive table, property has been set to false");}this.bIsInitialised=true;this._bTableSupportsExcelExport=this._oTableProvider.getSupportsExcelExport();this._listenToSmartFilter();this._createVariantManagementControl();this._createToolbarContent();this._createContent();this._createPersonalizationController();this._oEditModel=new J({editable:this.getEditable()});this.bindProperty("editable",{path:"sm4rtM0d3l>/editable"});this.setModel(this._oEditModel,"sm4rtM0d3l");this.fireInitialise();if(this.getEnableAutoBinding()){if(this._oSmartFilter&&this._oSmartFilter.isPending()){this._oSmartFilter.search();}else{this._reBindTable();}}}}}};p.prototype._createTableProvider=function(){var e,E,i;E=this.getEntitySet();i=this.getIgnoredFields();e=this.getModel();if(e&&!this._bTableCreated){this._aExistingColumns=[];this._aAlwaysSelect=[];this._oTemplate=null;this._createToolbar();this._createTable();this._bTableCreated=true;}if(e&&E){if(this._aExistingColumns.length){if(i){i+=","+this._aExistingColumns.toString();}else{i=this._aExistingColumns.toString();}}this._oTableProvider=new sap.ui.comp.providers.TableProvider({entitySet:E,ignoredFields:i,initiallyVisibleFields:this.getInitiallyVisibleFields(),isEditableTable:this.getEditable(),isAnalyticalTable:this._isAnalyticalTable,dateFormatSettings:this.data("dateFormatSettings"),currencyFormatSettings:this.data("currencyFormatSettings"),defaultDropDownDisplayBehaviour:this.data("defaultDropDownDisplayBehaviour"),useSmartField:this.data("useSmartField"),enableInResultForLineItem:this.data("enableInResultForLineItem"),model:e});}};p.prototype._listenToSmartFilter=function(){var s=null;s=this.getSmartFilterId();this._oSmartFilter=this._findControl(s);if(this._oSmartFilter){this._oSmartFilter.attachSearch(this._reBindTable,this);this._oSmartFilter.attachFilterChange(this._showOverlay,this,true);this._oSmartFilter.attachCancel(this._showOverlay,this,false);this._setNoDataText(sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("SMARTTABLE_NO_DATA"));}};p.prototype._showOverlay=function(s){if(s){var e={show:true};this.fireShowOverlay({overlay:e});s=e.show;}this._oTable.setShowOverlay(s);};p.prototype._findControl=function(i){var r,v;if(i){r=sap.ui.getCore().byId(i);if(!r){v=this._getView();if(v){r=v.byId(i);}}}return r;};p.prototype._getView=function(){if(!this._oView){var e=this.getParent();while(e){if(e instanceof sap.ui.core.mvc.View){this._oView=e;break;}e=e.getParent();}}return this._oView;};p.prototype.rebindTable=function(e){this._reBindTable(null,e);};p.prototype._reBindTable=function(e,r){var t,s,u,i,v,w,x=[],y,E,z,B,D,G,H={},I={preventTableBind:false};u=this._getTablePersonalisationData()||{};y=u.filters;E=u.excludeFilters;G=u.sorters;if(this._oSmartFilter){w=this._oSmartFilter.getFilters();H=this._oSmartFilter.getParameters()||{};}if(w&&w.length){if(E){x=[new sap.ui.model.Filter([w[0],E],true)];}else{x=w;}}else if(E){x=[E];}if(y){y=x.concat(y);}else{y=x;}z=this.getRequestAtLeastFields();if(z){B=z.split(",");}else{B=[];}B=B.concat(this._aAlwaysSelect);D=this._getVisibleColumnPaths();if(!D||!D.length){D=B;}else{v=B.length;for(i=0;i<v;i++){if(D.indexOf(B[i])<0){D.push(B[i]);}}}if(this._sSelectForGroup&&D.indexOf(this._sSelectForGroup)<0){D.push(this._sSelectForGroup);}if(D.length){H["select"]=D.toString();}H["useBatchRequests"]=true;if(!G){G=[];}I.filters=y;I.sorter=G;I.parameters=H;I.length=undefined;I.startIndex=undefined;this.fireBeforeRebindTable({bindingParams:I});if(!I.preventTableBind){G=I.sorter;y=I.filters;H=I.parameters;D=I.parameters["select"];if(!D||!D.length){M.error(sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("SMARTTABLE_NO_COLS"),{styleClass:(this.$()&&this.$().closest(".sapUiSizeCompact").length)?"sapUiSizeCompact":""});return;}s=this.getTableBindingPath()||("/"+this.getEntitySet());this._oTable.setEnableBusyIndicator(false);this._oTable.setBusy(true);if(this._oTable._setSuppressRefresh){this._oTable._setSuppressRefresh(false);}this._bDataLoadPending=true;t=this._oTable.getBinding(this._sAggregation);if(t&&t.mParameters&&!r){r=!(q.sap.equal(H,t.mParameters,true)&&q.sap.equal(H.custom,t.mParameters.custom)&&!I.length&&!I.startIndex&&s===t.getPath());}if(!t||!this._bIsTableBound||r){this._oTable.bindRows({path:s,filters:y,sorter:G,parameters:H,length:I.length,startIndex:I.startIndex,template:this._oTemplate,events:{dataRequested:function(){this._bIgnoreChange=true;}.bind(this),dataReceived:function(e){if(e&&e.getParameter&&!e.getParameter("data")){return;}this._bIgnoreChange=false;this._onDataLoadComplete(e,true);this.fireDataReceived(e);}.bind(this),change:function(e){if(this._bIgnoreChange){return;}var K,N=false;K=(e&&e.getParameter)?e.getParameter("reason"):undefined;if(!K||K==="filter"){N=true;}if(K==="change"||N){this._onDataLoadComplete(e,N);}}.bind(this)}});this._bIsTableBound=true;}else{if(Object.keys(y).length===0){y=[];}t.sort(G);t.filter(y,"Application");}this._showOverlay(false);}};p.prototype._onDataLoadComplete=function(e,i){if(this._bDataLoadPending||i){if(this._bDataLoadPending){this._oTable.setBusy(false);this._oTable.setEnableBusyIndicator(true);}this._bDataLoadPending=false;if(!this._bNoDataUpdated&&!this._getRowCount()){this._bNoDataUpdated=true;this._setNoDataText();}this.updateTableHeaderState();this._disableSumRows();}};p.prototype.setNoData=function(N){this._oNoData=N;};p.prototype.getNoData=function(){return this._oNoData;};p.prototype._setNoDataText=function(s){var e=this._oTable.setNoData;if(!e){e=this._oTable.setNoDataText;}if(!e){return;}var N=s;if(!N){N=this.getNoData();}if(!N){N=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("SMARTTABLE_NO_RESULTS");}e.call(this._oTable,N,true);};p.prototype.updateTableHeaderState=function(){this._refreshHeaderText();this._setExcelExportEnableState();};p.prototype._createContent=function(){var i,e=0,r,s,I,t;t=this._parseIndexedColumns();e=this._aTableViewMetadata.length;for(i=0;i<e;i++){r=this._aTableViewMetadata[i];if(r.inResult){this._aAlwaysSelect.push(r.name);}this._registerContentTemplateEvents(r.template);I=this.getId()+"-"+r.name.replace(/[^A-Za-z0-9_.:-]+/g,"_");s=this._createColumn(r,I);s.data("p13nData",{columnKey:r.name,leadingProperty:r.name,additionalProperty:r.additionalProperty,sortProperty:r.sortable?r.name:undefined,filterProperty:r.filterable?r.name:undefined,type:r.filterType,maxLength:r.maxLength,precision:r.precision,scale:r.scale,aggregationRole:r.aggregationRole});if(r.filterable&&s.setFilterProperty){s.setFilterProperty(r.name);}if(r.sortable&&s.setSortProperty){s.setSortProperty(r.name);}this._oTable.addColumn(s);}this._insertIndexedColumns(t);this._updateColumnsPopinFeature();this._storeInitialColumnSettings();};p.prototype._parseIndexedColumns=function(){var i,e,r,I,s,t,u,v;var w=this._oTable.getColumns();var x=null;if(this._oTemplate&&this._oTemplate.getCells){x=this._oTemplate.getCells();}if(!w){return null;}I=[];e=w.length;for(i=0;i<e;i++){r=w[i];s=r.data("p13nData");t=null;if(s){t=s.columnIndex;}u=-1;if(t!==null&&t!==undefined){u=parseInt(t,10);}if(!isNaN(u)&&u>-1){if(x){v=x[i];this._oTemplate.removeCell(v);}else{v=null;}I.push({index:u,column:r,template:v});this._oTable.removeColumn(r);}}I.sort(function(y,z){return y.index-z.index;});return I;};p.prototype._insertIndexedColumns=function(I){var i,e,r;if(!I){return;}e=I.length;for(i=0;i<e;i++){r=I[i];this._oTable.insertColumn(r.column,r.index);if(r.column.setInitialOrder){r.column.setInitialOrder(r.index);}if(r.template){this._oTemplate.insertCell(r.template,r.index);}}};p.prototype._updateColumnsPopinFeature=function(){if(!this._isMobileTable||!this.getDemandPopin()){return;}var e=this._oTable.getColumns();if(!e){return;}e=e.filter(function(t){return t.getVisible();});e.sort(function(t,u){return t.getOrder()-u.getOrder();});var r,s=e.length;for(var i=0;i<s;i++){r=e[i];if(i<2){r.setDemandPopin(false);r.setMinScreenWidth("1px");}else{r.setDemandPopin(true);r.setPopinDisplay(sap.m.PopinDisplay.Inline);r.setMinScreenWidth((i+1)*10+"rem");}}};p.prototype._storeInitialColumnSettings=function(){this._aInitialSorters=[];P.createSort2Json(this._oTable,this._aInitialSorters,P.createArrayFromString(this.getIgnoreFromPersonalisation()));};p.prototype._deactivateColumnsPopinFeature=function(){if(!this._isMobileTable){return;}var e=this._oTable.getColumns();if(!e){return;}var r,s=e.length;for(var i=0;i<s;i++){r=e[i];r.setDemandPopin(false);r.setMinScreenWidth("1px");}};p.prototype._registerContentTemplateEvents=function(t){if(t instanceof sap.ui.comp.navpopover.SmartLink){var s=this.getSemanticObjectController();t.setSemanticObjectController(s);}if(t&&t.attachChange){t.attachChange(function(e){this.fireFieldChange({changeEvent:e});}.bind(this));}};p.prototype._updateInitialColumns=function(){var i=this._oTable.getColumns(),r=i?i.length:0,s,t,u;while(r--){u=null;s=i[r];if(s){t=s.data("p13nData");if(typeof t==="string"){try{t=JSON.parse(t);}catch(e){}if(t){s.data("p13nData",t);}}if(t){u=t["columnKey"];}if(u){this._aExistingColumns.push(u);}}}};p.prototype._getVisibleColumnPaths=function(){var s=[],e=this._oTable.getColumns(),i,r=e?e.length:0,t,u,v,w;for(i=0;i<r;i++){t=e[i];v=null;if(t.getVisible()){if(t.getLeadingProperty){v=t.getLeadingProperty();}u=t.data("p13nData");if(u){if(!v){v=u["leadingProperty"];}w=u["additionalProperty"];}if(v&&s.indexOf(v)<0){s.push(v);}if(w&&s.indexOf(w)<0){s.push(w);}}}return s;};p.prototype._createTable=function(){var e=this.getItems(),i=e?e.length:0,t;this._sAggregation="rows";while(i--){t=e[i];if(t instanceof k||t instanceof R){break;}t=null;}if(t){this._oTable=t;if(t instanceof h){this._isAnalyticalTable=true;}else if(t instanceof R){this._isMobileTable=true;this._oTemplate=(t.getItems()&&t.getItems().length>0)?t.getItems()[0]:new sap.m.ColumnListItem();t.removeAllItems();}else if(t instanceof m){this._isTreeTable=true;}this._updateInitialColumns();}else{if(this.getTableType()==="AnalyticalTable"){this._isAnalyticalTable=true;this._oTable=new h({enableCustomFilter:true});}else if(this.getTableType()==="ResponsiveTable"){this._isMobileTable=true;this._oTable=new R({growing:true});this._oTemplate=new sap.m.ColumnListItem();}else if(this.getTableType()==="TreeTable"){this._isTreeTable=true;this._oTable=new m({selectionMode:sap.ui.table.SelectionMode.MultiToggle});}else{this._oTable=new k({selectionMode:sap.ui.table.SelectionMode.MultiToggle});}if(this._oTable.setVisibleRowCountMode){this._oTable.setVisibleRowCountMode(sap.ui.table.VisibleRowCountMode.Auto);}this.insertItem(this._oTable,2);}if(!this._oTable.getLayoutData()){if(this._oTable instanceof sap.m.Table||(this._oTable.getVisibleRowCountMode&&this._oTable.getVisibleRowCountMode()!==sap.ui.table.VisibleRowCountMode.Auto)){this._oTable.setLayoutData(new sap.m.FlexItemData({growFactor:1,baseSize:"auto"}));}else{this._oTable.setLayoutData(new sap.m.FlexItemData({growFactor:1,baseSize:"0%"}));}}if(this._oTable.addAriaLabelledBy){this._oTable.addAriaLabelledBy(this.getId()+"-header");}this._oTable.addStyleClass("sapUiCompSmartTableInnerTable");this._oTable.setEnableBusyIndicator(true);this._oTable.setBusyIndicatorDelay(100);if(this._oTable.setEnableCustomFilter){this._oTable.setEnableCustomFilter(this.getEnableCustomFilter());}if(this._oTable.setShowColumnVisibilityMenu){this._oTable.setShowColumnVisibilityMenu(false);}if(this._oTable.getEnableCustomFilter&&this._oTable.getEnableCustomFilter()){if(this._oTable.setEnableCellFilter){this._oTable.setEnableCellFilter(false);}if(this._oTable.attachCustomFilter){this._oTable.attachCustomFilter(this._showTableFilterDialog.bind(this));}}if(this._isAnalyticalTable){this._createColumn=this._createAnalyticalColumn;}else if(this._isMobileTable){this._sAggregation="items";this._createColumn=this._createMobileColumn;this._oTable.bindRows=this._oTable.bindItems;}if(!this._isMobileTable){this._oTable.attachEvent("_rowsUpdated",function(){this._setExcelExportEnableState();},this);}if(this._oTable._setLargeDataScrolling){this._oTable._setLargeDataScrolling(true);}};p.prototype.getTable=function(){return this._oTable;};p.prototype._showTableFilterDialog=function(e){if(this._oPersController){this._oPersController.openDialog({filter:{visible:true,payload:{column:e.getParameter("column")}}});}};p.prototype._disableSumRows=function(){if(sap.ui.Device.browser.msie&&sap.ui.Device.browser.version<11){q.sap.delayedCall(60,this,function(){if(this.getEditable()){this._oTable.$().find(".sapUiAnalyticalTableSum input").prop("disabled",true);this._oTable.$().find(".sapUiTableGroupHeader input").prop("disabled",true);}});}};p.prototype._createColumn=function(e,i){var r;r=new j(i,{autoResizable:true,hAlign:e.align,width:e.width,visible:e.isInitiallyVisible,label:new L(i+"-header",{textAlign:e.align,text:e.label,textDirection:e.textDirection}),sorted:e.sorted,sortOrder:e.sortOrder,tooltip:e.quickInfo,showSortMenuEntry:e.sortable,showFilterMenuEntry:e.filterable,name:e.fieldName,template:e.template});return r;};p.prototype._createAnalyticalColumn=function(e,i){var r;if(e.isCurrencyField&&e.template.addStyleClass){e.template.addStyleClass("sapUiUfdCurrency");}r=new A(i,{autoResizable:true,hAlign:e.align,width:e.width,visible:e.isInitiallyVisible,inResult:e.inResult,label:new L(i+"-header",{textAlign:e.align,text:e.label,textDirection:e.textDirection}),tooltip:e.quickInfo,sorted:e.sorted,sortOrder:e.sortOrder,showSortMenuEntry:e.sortable,showFilterMenuEntry:e.filterable,summed:e.summed,leadingProperty:e.name,template:e.template});return r;};p.prototype._createMobileColumn=function(e,i){var r;r=(new C(i,{hAlign:e.align,visible:e.isInitiallyVisible,header:new T(i+"-header",{text:e.label}),tooltip:e.quickInfo}));if(e.template&&e.template.setWrapping){e.template.setWrapping(true);}if(this._oTemplate){this._oTemplate.addCell(e.template);}return r;};p.prototype.fetchVariant=function(){if(this._oCurrentVariant==="STANDARD"||this._oCurrentVariant===null){return{};}return this._oCurrentVariant;};p.prototype.applyVariant=function(v,s){this._oCurrentVariant=v;if(this._oCurrentVariant==="STANDARD"){this._oCurrentVariant=null;}P.recoverPersonalisationData(this._oCurrentVariant,this._oTable);if(s==="STANDARD"){this._oApplicationDefaultVariant=this._oCurrentVariant;}if(this._oApplicationDefaultVariant&&!s){this._oCurrentVariant=q.extend(true,{},this._oApplicationDefaultVariant,v);}this._bApplyingVariant=true;if(this._oTable._setSuppressRefresh){this._oTable._setSuppressRefresh(true);}if(this._oPersController){if(this._oCurrentVariant===null||q.isEmptyObject(this._oCurrentVariant)){this._oPersController.resetPersonalization(sap.ui.comp.personalization.ResetType.ResetFull);}else{this._oPersController.setPersonalizationData(this._oCurrentVariant);}}if(this._bIsTableBound||!this._oSmartFilter){this._reBindTable(null,true);}else{this._showOverlay(true);}this._bApplyingVariant=false;this.fireAfterVariantApply({currentVariantId:this.getCurrentVariantId()});};p.prototype._beforePersonalisationModelDataChange=function(e){this._oTable.setEnableBusyIndicator(false);this._oTable.setBusy(true);if(this._oTable._setSuppressRefresh){this._oTable._setSuppressRefresh(true);}};p.prototype._afterPersonalisationModelDataChange=function(e){this._updateColumnsPopinFeature();this._oTable.setBusy(false);this._oTable.setEnableBusyIndicator(true);};p.prototype._personalisationModelDataChange=function(e){this._oCurrentVariant=e.getParameter("persistentData");if(this._bApplyingVariant){return;}var i=e.getParameter("changeType");var r=this._getChangeStatus(i);if(r===sap.ui.comp.personalization.ChangeType.Unchanged){return;}if(!this.getUseVariantManagement()){this._persistPersonalisation();}else if(this._oVariantManagement){this._oVariantManagement.currentVariantSetModified(true);}if(r===sap.ui.comp.personalization.ChangeType.ModelChanged){if(this._bIsTableBound||!this._oSmartFilter){this._reBindTable(null,i.columns===sap.ui.comp.personalization.ChangeType.ModelChanged);}else{this._showOverlay(true);}}};p.prototype._getChangeStatus=function(e){if(!e){return sap.ui.comp.personalization.ChangeType.ModelChanged;}if(e.sort===sap.ui.comp.personalization.ChangeType.ModelChanged||e.filter===sap.ui.comp.personalization.ChangeType.ModelChanged||e.columns===sap.ui.comp.personalization.ChangeType.ModelChanged||e.group===sap.ui.comp.personalization.ChangeType.ModelChanged){return sap.ui.comp.personalization.ChangeType.ModelChanged;}if(e.sort===sap.ui.comp.personalization.ChangeType.TableChanged||e.filter===sap.ui.comp.personalization.ChangeType.TableChanged||e.columns===sap.ui.comp.personalization.ChangeType.TableChanged||e.group===sap.ui.comp.personalization.ChangeType.TableChanged){return sap.ui.comp.personalization.ChangeType.TableChanged;}return sap.ui.comp.personalization.ChangeType.Unchanged;};p.prototype._getTablePersonalisationData=function(){if(!this._oCurrentVariant){return null;}var s=[],e=[],E=[],i,G,r,t,u,v,w,x,y="",I;this._sSelectForGroup=null;if(this._isMobileTable&&this._oCurrentVariant.group&&this._oCurrentVariant.group.groupItems){G=this._oCurrentVariant.group.groupItems[0];u=this._getColumnByKey(G.columnKey);if(u){y=u.getHeader().getText();}x=this._getPathFromColumnKeyAndProperty(G.columnKey,"sortProperty");w=x;r=new sap.ui.model.Sorter(w,G.operation==="GroupDescending",function(z){var K=z.getProperty(w);return{key:K,text:y?y+" : "+K:K};});this._sSelectForGroup=w;s.push(r);}if(this._oCurrentVariant.sort){t=this._oCurrentVariant.sort.sortItems;}else{t=this._aInitialSorters;}if(t){t.forEach(function(z){var D=z.operation==="Descending";x=this._getPathFromColumnKeyAndProperty(z.columnKey,"sortProperty");if(r&&r.sPath===x){r.bDescending=D;}else{s.push(new sap.ui.model.Sorter(x,D));}},this);}if(this._oCurrentVariant.filter){this._oCurrentVariant.filter.filterItems.forEach(function(z){var B=z.value1,D=z.value2;x=null;I=false;u=this._getColumnByKey(z.columnKey);if(u){if(u.getFilterProperty){x=u.getFilterProperty();}v=u.data("p13nData");if(v){I=v.type==="time";if(!x){x=v["filterProperty"];}}}if(I){if(B instanceof Date){B=n.getEdmTimeFromDate(B);}if(D instanceof Date){D=n.getEdmTimeFromDate(D);}}else if(B instanceof Date&&this._oTableProvider&&this._oTableProvider.getIsUTCDateHandlingEnabled()){B=F.getDateInUTCOffset(B);D=D?F.getDateInUTCOffset(D):D;}if(z.exclude){E.push(new sap.ui.model.Filter(x,g.NE,B));}else{e.push(new sap.ui.model.Filter(x,z.operation,B,D));}},this);if(E.length){i=new sap.ui.model.Filter(E,true);}}return{filters:e,excludeFilters:i,sorters:s};};p.prototype._getColumnByKey=function(s){var e,r,t,i,u;if(this._oTable){e=this._oTable.getColumns();t=e.length;for(i=0;i<t;i++){r=e[i];u=r.data("p13nData");if(u&&u.columnKey===s){return r;}}}return null;};p.prototype._getPathFromColumnKeyAndProperty=function(s,e){var i=null,r,t;r=this._getColumnByKey(s);if(r){if(e=="sortProperty"&&r.getSortProperty){i=r.getSortProperty();}else if(e=="filterProperty"&&r.getFilterProperty){i=r.getFilterProperty();}else if(e=="leadingProperty"&&r.getLeadingProperty){i=r.getLeadingProperty();}if(!i){t=r.data("p13nData");if(t){i=t[e];}}}return i;};p.prototype._persistPersonalisation=function(){var t=this;if(this._oVariantManagement){this._oVariantManagement.getVariantsInfo(function(v){var s=null;if(v&&v.length>0){s=v[0].key;}var e=s!==null;var i={name:"Personalisation",global:false,overwrite:e,key:s,def:true};t._oVariantManagement.fireSave(i);});}};p.prototype.getCurrentVariantId=function(){var K="";if(this._oVariantManagement){K=this._oVariantManagement.getCurrentVariantId();}return K;};p.prototype.setCurrentVariantId=function(v){if(this._oVariantManagement){this._oVariantManagement.setCurrentVariantId(v);}else{q.sap.log.error("sap.ui.comp.smarttable.SmartTable.prototype.setCurrentVariantId: VariantManagement does not exist");}};p.prototype.exit=function(){if(this._oSmartFilter){this._oSmartFilter.detachSearch(this._reBindTable,this);this._oSmartFilter.detachFilterChange(this._showOverlay,this);this._oSmartFilter.detachCancel(this._showOverlay,this);this._oSmartFilter=null;}if(this._oTableProvider&&this._oTableProvider.destroy){this._oTableProvider.destroy();}this._oTableProvider=null;if(this._oPersController&&this._oPersController.destroy){this._oPersController.destroy();}this._oPersController=null;if(this._oVariantManagement&&this._oVariantManagement.destroy){this._oVariantManagement.destroy();}if(this._oEditModel){this._oEditModel.destroy();}if(this._oNoData&&this._oNoData.destroy){this._oNoData.destroy();}this.oNoData=null;this._oEditModel=null;this._oVariantManagement=null;this._oCurrentVariant=null;this._oApplicationDefaultVariant=null;this._aTableViewMetadata=null;this._aExistingColumns=null;this._aAlwaysSelect=null;this._oCustomToolbar=null;this._oToolbar=null;if(this._oUseExportToExcel&&!this.getUseExportToExcel()){this._oUseExportToExcel.destroy();}this._oUseExportToExcel=null;this._oTablePersonalisationButton=null;if(!this._bIsTableBound&&this._oTemplate){this._oTemplate.destroy();}this._oTemplate=null;this._oView=null;this._oTable=null;};return p;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.providers.ChartProvider')){jQuery.sap.declare('sap.ui.comp.providers.ChartProvider');jQuery.sap.require('jquery.sap.global');sap.ui.define("sap/ui/comp/providers/ChartProvider",['jquery.sap.global','sap/ui/comp/odata/MetadataAnalyser','sap/ui/comp/odata/ChartMetadata','sap/ui/comp/odata/ODataType','./ControlProvider'],function(q,M,C,O,a){"use strict";var b=function(p){if(p){this._oParentODataModel=p.model;this.sEntitySet=p.entitySet;this._sIgnoredFields=p.ignoredFields;this.useSmartField=p.useSmartField;this.enableInResultForLineItem=p.enableInResultForLineItem==="true";this._oDefaultDropDownDisplayBehaviour=p.defaultDropDownDisplayBehaviour;try{this._oDateFormatSettings=p.dateFormatSettings?JSON.parse(p.dateFormatSettings):undefined;this._oCurrencyFormatSettings=p.currencyFormatSettings?JSON.parse(p.currencyFormatSettings):undefined;}catch(e){}}this._aODataFieldMetadata=[];this._oChartViewMetadata=null;this._aIgnoredFields=[];this._oMetadataAnalyser=new M(this._oParentODataModel);this._intialiseMetadata();};b.prototype._intialiseMetadata=function(){var c,d=[],f,F,i,l=0;this._aODataFieldMetadata=this._oMetadataAnalyser.getFieldsByEntitySetName(this.sEntitySet);f=this._oMetadataAnalyser.getEntityTypeNameFromEntitySetName(this.sEntitySet);this._oPresentationVariant=this._oMetadataAnalyser.getPresentationVariantAnnotation(f);if(this._oPresentationVariant&&this._oPresentationVariant.chartAnnotation){this._oChartAnnotation=this._oPresentationVariant.chartAnnotation;}else{this._oChartAnnotation=this._oMetadataAnalyser.getChartAnnotation(f);}if(!this._oDefaultDropDownDisplayBehaviour){this._oDefaultDropDownDisplayBehaviour=this._oMetadataAnalyser.getTextArrangementValue(f);}this._generateIgnoredFieldsArray();this._oControlProvider=new a({metadataAnalyser:this._oMetadataAnalyser,model:this._oParentODataModel,fieldsMetadata:this._aODataFieldMetadata,dateFormatSettings:this._oDateFormatSettings,currencyFormatSettings:this._oCurrencyFormatSettings,defaultDropDownDisplayBehaviour:this._oDefaultDropDownDisplayBehaviour,useSmartField:this.useSmartField,enableDescriptions:false,entitySet:this.sEntitySet});if(this._aODataFieldMetadata){l=this._aODataFieldMetadata.length;}for(i=0;i<l;i++){F=this._aODataFieldMetadata[i];if(this._aIgnoredFields.indexOf(F.name)>-1||!F.visible){continue;}if(F.type.indexOf("Edm.")===0){c=this._getFieldViewMetadata(F);this._enrichWithChartViewMetadata(F,c);d.push(F);}}if(this._oChartAnnotation){this._oChartViewMetadata=q.extend({},this._oChartAnnotation);this._oChartViewMetadata.chartType=C.getChartType(this._oChartViewMetadata.chartType);this._oChartViewMetadata.fields=d;}};b.prototype._setAnnotationMetadata=function(f){var A=null;if(f&&f.fullName){A=this._oMetadataAnalyser.getSemanticObjectAnnotation(f.fullName);if(A){f.semanticObject=A.semanticObject;}}};b.prototype._getFieldViewMetadata=function(f){var c=this._oControlProvider.getFieldViewMetadata(f,false);this._setAnnotationMetadata(c);return c;};b.prototype._generateIgnoredFieldsArray=function(){if(this._sIgnoredFields){this._aIgnoredFields=this._sIgnoredFields.split(",");}};b.prototype._enrichWithChartViewMetadata=function(f,v){f.isMeasure=f.aggregationRole&&f.aggregationRole==="measure";f.isDimension=f.aggregationRole&&f.aggregationRole==="dimension";f.role=this._getRole(f);f.filterType=v.filterType;if(v.template){f.template=v.template;}if(f.isDimension){f.displayBehaviour=v.displayBehaviour;}f.isSemanticObject=(v.semanticObject)?true:false;this._setInResult(f);this._setSortOrder(f);};b.prototype._setInResult=function(f){if(this._oPresentationVariant){if(this._oPresentationVariant.requestAtLeastFields&&this._oPresentationVariant.requestAtLeastFields.indexOf(f.name)>-1){f.inResult=true;}}else if(this.enableInResultForLineItem){if(this._oLineItemAnnotation&&this._oLineItemAnnotation.fields&&this._oLineItemAnnotation.fields.indexOf(f.name)>-1){f.inResult=true;}}};b.prototype._setSortOrder=function(f){var l;if(this._oPresentationVariant&&this._oPresentationVariant.sortOrderFields){l=this._oPresentationVariant.sortOrderFields.length;for(var i=0;i<l;i++){if(this._oPresentationVariant.sortOrderFields[i].name===f.name){f.sorted=true;f.sortOrder=this._oPresentationVariant.sortOrderFields[i].descending?"Descending":"Ascending";break;}}}};b.prototype._unmarkTextDimensions=function(f,t){var i,F;for(i=0;i<f.length;i++){F=f[i];if(F.isDimension){if(t.indexOf(F.name)>-1){F.isDimension=false;}}}};b.prototype._getRole=function(f){if(this._oChartAnnotation){if(f.isDimension&&this._oChartAnnotation.dimensionAttributes){return C.getDimensionRole(this._oChartAnnotation.dimensionAttributes[f.name]);}else if(f.isMeasure&&this._oChartAnnotation.measureAttributes){return C.getMeasureRole(this._oChartAnnotation.measureAttributes[f.name]);}}};b.prototype.getChartViewMetadata=function(){return this._oChartViewMetadata;};b.prototype.getIsUTCDateHandlingEnabled=function(){return this._oDateFormatSettings?this._oDateFormatSettings.UTC:false;};b.prototype.destroy=function(){if(this._oMetadataAnalyser&&this._oMetadataAnalyser.destroy){this._oMetadataAnalyser.destroy();}this._oMetadataAnalyser=null;this._aODataFieldMetadata=null;this._oChartViewMetadata=null;this._sIgnoredFields=null;this.bIsDestroyed=true;};return b;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.smartchart.SmartChart')){jQuery.sap.declare('sap.ui.comp.smartchart.SmartChart');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.chart.Chart');jQuery.sap.require('sap.chart.library');jQuery.sap.require('sap.chart.data.Dimension');jQuery.sap.require('sap.chart.data.Measure');jQuery.sap.require('sap.m.ToggleButton');jQuery.sap.require('sap.m.Button');jQuery.sap.require('sap.m.Text');jQuery.sap.require('sap.m.ComboBox');jQuery.sap.require('sap.m.ComboBoxRenderer');jQuery.sap.require('sap.m.FlexItemData');jQuery.sap.require('sap.ui.core.Item');jQuery.sap.require('sap.m.OverflowToolbar');jQuery.sap.require('sap.m.OverflowToolbarButton');jQuery.sap.require('sap.m.ToolbarSeparator');jQuery.sap.require('sap.m.ToolbarDesign');jQuery.sap.require('sap.m.ToolbarSpacer');jQuery.sap.require('sap.m.VBox');jQuery.sap.require('sap.m.VBoxRenderer');jQuery.sap.require('sap.ui.model.Filter');jQuery.sap.require('sap.ui.model.FilterOperator');jQuery.sap.require('sap.ui.Device');sap.ui.define("sap/ui/comp/smartchart/SmartChart",['jquery.sap.global','sap/ui/comp/library','sap/chart/Chart','sap/chart/library','sap/chart/data/Dimension','sap/chart/data/Measure','sap/m/ToggleButton','sap/m/Button','sap/m/Text','sap/m/ComboBox','sap/m/ComboBoxRenderer','sap/m/FlexItemData','sap/ui/core/Item','sap/m/OverflowToolbar','sap/m/OverflowToolbarButton','sap/m/ToolbarSeparator','sap/m/ToolbarDesign','sap/m/ToolbarSpacer','sap/m/VBox','sap/m/VBoxRenderer','sap/ui/comp/providers/ChartProvider','sap/ui/comp/smartfilterbar/FilterProvider','sap/ui/comp/smartvariants/SmartVariantManagement','sap/ui/model/Filter','sap/ui/model/FilterOperator','sap/ui/comp/personalization/Util','sap/ui/Device','sap/ui/comp/odata/ODataModelUtil'],function(q,l,C,c,D,M,T,B,d,f,g,F,I,O,h,j,k,m,V,o,p,r,S,s,t,P,u,v){"use strict";var w=V.extend("sap.ui.comp.smartchart.SmartChart",{metadata:{library:"sap.ui.comp",properties:{entitySet:{type:"string",group:"Misc",defaultValue:null},smartFilterId:{type:"string",group:"Misc",defaultValue:null},ignoredFields:{type:"string",group:"Misc",defaultValue:null},requestAtLeastFields:{type:"string",group:"Misc",defaultValue:null},ignoreFromPersonalisation:{type:"string",group:"Misc",defaultValue:null},chartType:{type:"string",group:"Misc",defaultValue:null},ignoredChartTypes:{type:"string",group:"Misc",defaultValue:null},useVariantManagement:{type:"boolean",group:"Misc",defaultValue:true},useChartPersonalisation:{type:"boolean",group:"Misc",defaultValue:true},header:{type:"string",group:"Misc",defaultValue:null},persistencyKey:{type:"string",group:"Misc",defaultValue:null},currentVariantId:{type:"string",group:"Misc",defaultValue:null},enableAutoBinding:{type:"boolean",group:"Misc",defaultValue:false},chartBindingPath:{type:"string",group:"Misc",defaultValue:null},showDrillButtons:{type:"boolean",group:"Misc",defaultValue:true},showZoomButtons:{type:"boolean",group:"Misc",defaultValue:true},showSemanticNavigationButton:{type:"boolean",group:"Misc",defaultValue:true},showLegendButton:{type:"boolean",group:"Misc",defaultValue:true},legendVisible:{type:"boolean",group:"Misc",defaultValue:true},selectionMode:{type:"sap.chart.SelectionMode",group:"Misc",defaultValue:sap.chart.SelectionMode.Single},showFullScreenButton:{type:"boolean",group:"Misc",defaultValue:true},useTooltip:{type:"boolean",group:"Misc",defaultValue:true}},aggregations:{toolbar:{type:"sap.m.Toolbar",multiple:false},semanticObjectController:{type:"sap.ui.comp.navpopover.SemanticObjectController",multiple:false}},events:{initialise:{},beforeRebindChart:{},dataReceived:{},afterVariantInitialise:{},afterVariantSave:{},afterVariantApply:{},showOverlay:{}}},renderer:o.render});w.prototype.init=function(){sap.m.FlexBox.prototype.init.call(this);this.addStyleClass("sapUiCompSmartChart");this.setFitContainer(true);this._bUpdateToolbar=true;this._oChartTypeModel=null;this.setHeight("100%");var a=new sap.ui.model.json.JSONModel({items:[]});this.setModel(a,"$smartChartTypes");this._oRb=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");this.sResizeListenerId=null;if(u.system.desktop){this.sResizeListenerId=sap.ui.core.ResizeHandler.register(this,q.proxy(this._adjustHeight,this));}else{u.orientation.attachHandler(this._adjustHeight,this);u.resize.attachHandler(this._adjustHeight,this);}};w.prototype._createVariantManagementControl=function(){if(this._oVariantManagement||(!this.getUseVariantManagement()&&!this.getUseChartPersonalisation())||!this.getPersistencyKey()){return;}var a=new sap.ui.comp.smartvariants.PersonalizableInfo({type:"chart",keyName:"persistencyKey",dataSource:"TODO"});a.setControl(this);this._oVariantManagement=new S({personalizableControls:a,initialise:function(e){if(!this._oCurrentVariant){this._oCurrentVariant="STANDARD";}this.fireAfterVariantInitialise();}.bind(this),save:function(e){this._variantSaved();}.bind(this),afterSave:function(){this.fireAfterVariantSave({currentVariantId:this.getCurrentVariantId()});}.bind(this),showShare:false});this._oVariantManagement.initialise();};w.prototype._variantSaved=function(){if(this._oPersController){this._oPersController.setPersonalizationData(this._oCurrentVariant);}};w.prototype.setUseChartPersonalisation=function(U){this.setProperty("useChartPersonalisation",U,true);this._bUpdateToolbar=true;};w.prototype._createPopover=function(){if(!this._oPopover&&this._oChart){q.sap.require("sap.viz.ui5.controls.Popover");this._oPopover=new sap.viz.ui5.controls.Popover({});this._oPopover.connect(this._oChart.getVizUid());}};w.prototype._createTooltip=function(){if(this._oChart){this._oChart.setVizProperties({"interaction":{"behaviorType":null},"tooltip":{"visible":true}});}};w.prototype._createTooltipOrPopover=function(){if(this.getUseTooltip()){this._createTooltip();}else{this._createPopover();}};w.prototype._destroyPopover=function(){if(this._oPopover){this._oPopover.destroy();this._oPopover=null;}};w.prototype.setUseVariantManagement=function(U){this.setProperty("useVariantManagement",U,true);if(this._oPersController){this._oPersController.setResetToInitialTableState(!U);}this._bUpdateToolbar=true;};w.prototype.setToolbar=function(a){if(this._oToolbar){this.removeItem(this._oToolbar);}this._oToolbar=a;this._bUpdateToolbar=true;};w.prototype.getToolbar=function(){return this._oToolbar;};w.prototype.setHeader=function(a){this.setProperty("header",a,true);this._refreshHeaderText();};w.prototype._refreshHeaderText=function(){if(!this._headerText){this._bUpdateToolbar=true;return;}var a=this.getHeader();this._headerText.setText(a);};w.prototype._createToolbar=function(){if(!this._oToolbar){this._oToolbar=new O({design:k.Transparent});this._oToolbar.addStyleClass("sapUiCompSmartChartToolbar");}this._oToolbar.setLayoutData(new sap.m.FlexItemData({shrinkFactor:0}));this.insertItem(this._oToolbar,0);};w.prototype._createToolbarContent=function(){this._addVariantManagementToToolbar();this._addSeparatorToToolbar();this._addHeaderToToolbar();this._addSpacerToToolbar();this._addSemanticNavigationButton();this._addChartTypeToToolbar();this._addDrillUpDownButtons();this._addLegendButton();this._addZoomInOutButtons();this._addPersonalisationToToolbar();this._addFullScrrenButton();if(this._oToolbar&&(this._oToolbar.getContent().length===0||(this._oToolbar.getContent().length===1&&this._oToolbar.getContent()[0]instanceof m))){this.removeItem(this._oToolbar);this._oToolbar.destroy();this._oToolbar=null;}};w.prototype._addFullScrrenButton=function(){var a,b=this;if(this.getShowFullScreenButton()){a=new h(this.getId()+"-btnFullScreen",{press:function(){b.setFullScreen(!b.bFullScreen);}});this.oFullScreenButton=a;this.setFullScreen(this.bFullScreen,true);this._oToolbar.addContent(a);}};w.prototype._addZoomInOutButtons=function(){var a=this;this._oZoomInButton=new h(this.getId()+"-btnZoomIn",{tooltip:this._oRb.getText("CHART_ZOOMINBTN_TOOLTIP"),icon:"sap-icon://zoom-in",press:function(){if(a._oChart){a._oChart.zoom({direction:"in"});}},visible:this.getShowZoomButtons()});this._oZoomOutButton=new h(this.getId()+"-btnZoomOut",{tooltip:this._oRb.getText("CHART_ZOOMOUTBTN_TOOLTIP"),icon:"sap-icon://zoom-out",press:function(){if(a._oChart){a._oChart.zoom({direction:"out"});}},visible:this.getShowZoomButtons()});this._oToolbar.addContent(this._oZoomInButton);this._oToolbar.addContent(this._oZoomOutButton);};w.prototype.setShowZoomButtons=function(b){this.setProperty("showZoomButtons",b);if(this._oZoomInButton){this._oZoomInButton.setVisible(b);}if(this._oZoomOutButton){this._oZoomOutButton.setVisible(b);}};w.prototype.setLegendVisible=function(b){this.setProperty("legendVisible",b);this._setLegendVisible(b);};w.prototype._setLegendVisible=function(b){var a=this._getVizFrame();if(a){a.setLegendVisible(b);}};w.prototype._getVizFrame=function(){var a=null;if(this._oChart){a=this._oChart.getAggregation("_vizFrame");}return a;};w.prototype._addLegendButton=function(){var a=this;this._oLegendButton=new h(this.getId()+"-btnLegend",{tooltip:this._oRb.getText("CHART_LEGENDBTN_TOOLTIP"),icon:"sap-icon://legend",press:function(){a.setLegendVisible(!a.getLegendVisible());},visible:this.getShowLegendButton()});this._oToolbar.addContent(this._oLegendButton);};w.prototype.setShowLegendButton=function(b){this.setProperty("showLegendButton",b);if(this._oLegendButton){this._oLegendButton.setVisible(b);}};w.prototype.setShowSemanticNavigationButton=function(b){this.setProperty("showSemanticNavigationButton",b);if(this._oSemanticalNavButton){this._oSemanticalNavButton.setVisible(b);}else{if(b){this._addSemanticNavigationButton();}}};w.prototype._addSemanticNavigationButton=function(){var a=this,b;if(!this._oSemanticalNavButton&&this.getShowSemanticNavigationButton()){this._oSemanticalNavButton=new B(this.getId()+"-btnNavigation",{text:this._oRb.getText("CHART_SEMNAVBTN"),tooltip:this._oRb.getText("CHART_SEMNAVBTN_TOOLTIP"),visible:this.getShowSemanticNavigationButton(),enabled:false});q.sap.require("sap.ui.comp.navpopover.NavigationPopoverHandler");var n=new sap.ui.comp.navpopover.NavigationPopoverHandler({control:this._oSemanticalNavButton});var e=this.getSemanticObjectController();if(e){n.setSemanticObjectController(e);}this._oSemanticalNavButton.attachPress(function(E){if(b&&(b.length>0)){if(b.length===1){n.setSemanticObject(b[0].name);n.setSemanticObjectLabel(b[0].fieldLabel);n._handlePressed(E);}else{a._semanticObjectList(b,n);}}});if(this._oChart){this._oChart.attachDeselectData(function(E){b=a._setSelectionDataPointHandling(n);});this._oChart.attachSelectData(function(E){b=a._setSelectionDataPointHandling(n);});}var i=this._indexOfSpacerOnToolbar();this._oToolbar.insertContent(this._oSemanticalNavButton,i+1);}};w.prototype._setSelectionDataPointHandling=function(n){var a=this._setSelectionDataPoint(n);if(a&&a.length>0){this._oSemanticalNavButton.setEnabled(true);}else{this._oSemanticalNavButton.setEnabled(false);}return a;};w.prototype._setSelectionDataPoint=function(n){var a,b,e=null,y;var z=this._oChart.getSelectedDataPoints();if(!z||!z.dataPoints||(z.dataPoints.length===0)){return e;}if(z.dataPoints.length===1){a=z.dataPoints[0].context;if(a){b=a.getObject();if(b){e=this._determineSemanticObjects(b,a);if(e&&(e.length>0)){n.setBindingContext(a);}}}return e;}y=[];for(var i=0;i<z.dataPoints.length;i++){a=z.dataPoints[i].context;if(a){b=a.getObject();if(b){y.push(b);}}}if(y&&y.length>0){e=this._condensBasedOnSameValue(y);if(e&&e.length>0){n.setBindingContext(z.dataPoints[z.dataPoints.length-1].context);}}return e;};w.prototype._condensBasedOnSameValue=function(a){var b=null,R,e,n;b=this._determineSemanticObjects(a[0]);if(b&&b.length>0){for(var i=0;i<b.length;i++){e=b[i];n=e.name;if(this._bAllValuesAreEqual(a,n)){if(!R){R=[];}R.push(e);}}b=R;}return b;};w.prototype._bAllValuesAreEqual=function(a,b){var e,n;for(var i=0;i<a.length;i++){e=a[i];if(i===0){n=e[b];continue;}if(n!=e[b]){return false;}}return true;};w.prototype._semanticObjectList=function(a,n){q.sap.require("sap.m.List");q.sap.require("sap.m.ListType");q.sap.require("sap.m.PlacementType");q.sap.require("sap.m.StandardListItem");q.sap.require("sap.m.ResponsivePopover");var b,L,e,y;if(this._oChart){L=new sap.m.List({mode:sap.m.ListMode.SingleSelectMaster,selectionChange:function(E){if(E&&E.mParameters&&E.mParameters.listItem){y=E.mParameters.listItem.data("semObj");if(y){n.setSemanticObject(y.name);n.setSemanticObjectLabel(y.fieldLabel);n._handlePressed(E);}}b.close();}});for(var i=0;i<a.length;i++){y=a[i];e=new sap.m.StandardListItem({title:y.fieldLabel,type:sap.m.ListType.Active});e.data("semObj",y);L.addItem(e);}b=new sap.m.ResponsivePopover({title:this._oRb.getText("CHART_SEMNAVBTN"),showHeader:false,contentWidth:"12rem",placement:sap.m.PlacementType.Left});b.addContent(L);b.openBy(this._oSemanticalNavButton);}};w.prototype._determineSemanticObjects=function(e,i){var n,y,z=[];if(e){for(n in e){if(n){y=this._getField(n);if(y&&y.isDimension&&y.isSemanticObject){z.push(y);}}}}if(z){z.sort(function(a,b){return a.fieldLabel.localeCompare(b.fieldLabel);});}return z;};w.prototype._checkSemanticNavigationButton=function(b){if(this._oSemanticalNavButton){this._oSemanticalNavButton.setEnabled(b);}};w.prototype._addDrillUpDownButtons=function(){var a=this;this._oDrillUpButton=new h(this.getId()+"-btnDrillUp",{tooltip:this._oRb.getText("CHART_DRILLUPBTN_TOOLTIP"),icon:"sap-icon://drill-up",press:function(){if(a._oChart){a._oChart.drillUp();}},visible:this.getShowDrillButtons()});this._oDrillDownButton=new h(this.getId()+"-btnDrillDown",{tooltip:this._oRb.getText("CHART_DRILLDOWNBTN_TOOLTIP"),icon:"sap-icon://drill-down",press:function(e){a._drillDown(e);},visible:this.getShowDrillButtons()});this._oToolbar.addContent(this._oDrillUpButton);this._oToolbar.addContent(this._oDrillDownButton);};w.prototype.setShowDrillButtons=function(b){this.setProperty("showDrillButtons",b);if(this._oDrillUpButton){this._oDrillUpButton.setVisible(b);}if(this._oDrillDownButton){this._oDrillDownButton.setVisible(b);}};w.prototype._triggerSearchInPopover=function(e,L){var a,i,b,n,y,z;if(!e||!L){return;}a=e.getParameters();if(!a){return;}y=a.newValue?a.newValue.toLowerCase():"";if(this._oChart){z=L.getItems();for(i=0;i<z.length;i++){n=z[i].getTooltip();b=z[i].getTitle();if((b&&(b.toLowerCase().indexOf(y)>-1))||(n&&(n.toLowerCase().indexOf(y)>-1))){z[i].setVisible(true);}else{z[i].setVisible(false);}}}};w.prototype._drillDown=function(e){q.sap.require("sap.m.Bar");q.sap.require("sap.m.List");q.sap.require("sap.m.ListType");q.sap.require("sap.m.SearchField");q.sap.require("sap.m.PlacementType");q.sap.require("sap.m.StandardListItem");q.sap.require("sap.m.ResponsivePopover");var a=this,b,n,y,z,L,A,E,G,i,H;if(this._oChart){A=new sap.m.List({mode:sap.m.ListMode.SingleSelectMaster,selectionChange:function(e){if(e&&e.mParameters&&e.mParameters.listItem){if(e.mParameters.listItem.getType()===sap.m.ListType.Inactive){return;}var z=e.mParameters.listItem.data("dim");if(z){a._oChart.drillDown(z);}}b.close();}});E=new sap.m.Bar();G=new sap.m.SearchField({placeholder:this._oRb.getText("CHART_DRILLDOWN_SEARCH")});G.attachLiveChange(function(e){a._triggerSearchInPopover(e,A);});E.addContentRight(G);b=new sap.m.ResponsivePopover({title:this._oRb.getText("CHART_DRILLDOWN_TITLE"),contentWidth:"25rem",contentHeight:"20rem",placement:sap.m.PlacementType.Bottom,subHeader:E});b.addContent(A);n=this._oChart.getVisibleDimensions();y=this._getSortedDimensions();if(y.length<7){E.setVisible(false);}for(i=0;i<y.length;i++){if(n.indexOf(y[i].getName())>-1){continue;}z=y[i];L=new sap.m.StandardListItem({title:z.getLabel(),type:sap.m.ListType.Active});L.data("dim",z);H=this._getFieldTooltip(z.name);if(H){L.setTooltip(H);}if(n.indexOf(y[i].getName())>-1){L.setType(sap.m.ListType.Inactive);}A.addItem(L);}b.openBy(e.getSource());}};w.prototype._addHeaderToToolbar=function(){if(this.getHeader()){if(!this._headerText){this._headerText=new d();this._headerText.addStyleClass("sapMH4Style");this._headerText.addStyleClass("sapUiCompSmartChartHeader");}this._refreshHeaderText();this._oToolbar.insertContent(this._headerText,0);}else if(this._headerText){this._oToolbar.removeContent(this._headerText);}};w.prototype._addSeparatorToToolbar=function(){if(this.getHeader()&&this.getUseVariantManagement()){this._oSeparator=new j();this._oToolbar.insertContent(this._oSeparator,0);if(!this._oToolbar.getHeight()){this._oToolbar.setHeight("3rem");}}else if(this._oSeparator){this._oToolbar.removeContent(this._oSeparator);}};w.prototype._addVariantManagementToToolbar=function(){if(this.getUseVariantManagement()){this._oToolbar.insertContent(this._oVariantManagement,0);}else if(this._oVariantManagement){this._oToolbar.removeContent(this._oVariantManagement);}};w.prototype._addSpacerToToolbar=function(){if(this._indexOfSpacerOnToolbar()===-1){this._oToolbar.addContent(new m());}};w.prototype._indexOfSpacerOnToolbar=function(){var a=this._oToolbar.getContent(),i,L;if(a){L=a.length;i=0;for(i;i<L;i++){if(a[i]instanceof m){return i;}}}return-1;};w.prototype._addPersonalisationToToolbar=function(){if(this.getUseChartPersonalisation()){if(!this._oChartPersonalisationButton){this._oChartPersonalisationButton=new h(this.getId()+"-btnPersonalisation",{icon:"sap-icon://action-settings",tooltip:this._oRb.getText("CHART_PERSOBTN_TOOLTIP"),press:q.proxy(function(e){this._oPersController.openDialog({dimeasure:{visible:true,payload:{availableChartTypes:this._getAllChartTypes()}},sort:{visible:true},filter:{visible:true}});},this)});}this._oToolbar.addContent(this._oChartPersonalisationButton);}else if(this._oChartPersonalisationButton){this._oToolbar.removeContent(this._oChartPersonalisationButton);}};w.prototype._addChartTypeToToolbar=function(){this._oChartTypeButton=this._createChartTypeButton();this._oToolbar.addContent(this._oChartTypeButton);};w.prototype._createChartTypeComboBox=function(){var a=this;var i=new I({key:"{$smartChartTypes>key}",text:"{$smartChartTypes>text}"});var b=new f({enabled:false,items:{path:"$smartChartTypes>/items",template:i}});b.attachSelectionChange(null,function(){a._setChartType(b.getSelectedItem().getKey());});return b;};w.prototype._createChartTypeButton=function(){var a=this;var b=new T({enabled:false,press:function(e){this.setPressed(true);a._displayChartTypes(e);}});this._enreachButton(this._oChart.getChartType());return b;};w.prototype._displayChartTypes=function(e){q.sap.require("sap.m.Bar");q.sap.require("sap.m.List");q.sap.require("sap.m.ListType");q.sap.require("sap.ui.core.ListItem");q.sap.require("sap.m.SearchField");q.sap.require("sap.m.PlacementType");q.sap.require("sap.m.StandardListItem");q.sap.require("sap.m.ResponsivePopover");var a=this,b,L,i,n;if(this._oChart&&e){var y=e.getSource();var z=new sap.m.StandardListItem({title:"{$smartChartTypes>text}",icon:"{$smartChartTypes>icon}",selected:"{$smartChartTypes>selected}"});L=new sap.m.List({mode:sap.m.ListMode.SingleSelectMaster,items:{path:"$smartChartTypes>/items",template:z},selectionChange:function(e){if(e&&e.mParameters&&e.mParameters.listItem){var A=e.mParameters.listItem.getBinding("title");if(A){var E=A.getContext();if(E){var G=E.getObject();if(G&&G.key){a._setChartType(G.key);a._enreachButton(G.key,G.text);}}}}y.setPressed(false);b.close();}});i=new sap.m.Bar();n=new sap.m.SearchField({placeholder:this._oRb.getText("CHART_TYPE_SEARCH")});n.attachLiveChange(function(e){a._triggerSearchInPopover(e,L);});i.addContentRight(n);b=new sap.m.ResponsivePopover({title:this._oRb.getText("CHART_TYPE_TITLE"),contentWidth:"25rem",contentHeight:"20rem",placement:sap.m.PlacementType.Bottom,subHeader:i});b.setModel(this.getModel("$smartChartTypes"),"$smartChartTypes");b.addContent(L);if(L.getItems().length<7){i.setVisible(false);}b.openBy(y);}};w.prototype._selectCurrentChartType=function(L){var a=this._oChart.getChartType();var b,e=L.getItems();for(var i=0;i<e.length;i++){b=e[i];if(b){var n=b.getBinding("title");if(n){var y=n.getContext();if(y){var z=y.getObject();if(z&&z.key&&(z.key===a)){L.setSelectedItem(b);return;}}}}}};var x={"bar":"sap-icon://horizontal-bar-chart","bullet":"sap-icon://horizontal-bullet-chart","bubble":"sap-icon://bubble-chart","column":"sap-icon://vertical-bar-chart","combination":"sap-icon://business-objects-experience","dual_bar":"sap-icon://horizontal-bar-chart","dual_column":"sap-icon://vertical-bar-chart","dual_combination":"sap-icon://business-objects-experience","dual_line":"sap-icon://line-chart","dual_stacked_bar":"sap-icon://full-stacked-chart","dual_stacked_column":"sap-icon://vertical-stacked-chart","dual_stacked_combination":"sap-icon://business-objects-experience","donut":"sap-icon://donut-chart","heatmap":"sap-icon://heatmap-chart","horizontal_stacked_combination":"sap-icon://business-objects-experience","line":"sap-icon://line-chart","pie":"sap-icon://pie-chart","scatter":"sap-icon://scatter-chart","stacked_bar":"sap-icon://full-stacked-chart","stacked_column":"sap-icon://vertical-stacked-chart","stacked_combination":"sap-icon://business-objects-experience","treemap":"sap-icon://Chart-Tree-Map","vertical_bullet":"sap-icon://vertical-bullet-chart","100_dual_stacked_bar":"sap-icon://full-stacked-chart","100_dual_stacked_column":"sap-icon://vertical-stacked-chart","100_stacked_bar":"sap-icon://full-stacked-chart","100_stacked_column":"sap-icon://full-stacked-column-chart"};w.prototype._getMatchingIcon=function(a){var i=x[a];if(!i){i="";}return i;};w.prototype._enreachButton=function(K,a){if(!this._oChartTypeButton){return;}if(a===undefined){a=K;var b=this._retrieveChartTypeDescription(K);if(b&&b.text){a=b.text;}}var e=this._getMatchingIcon(K);this._oChartTypeButton.setIcon(e?e:"sap-icon://vertical-bar-chart");this._oChartTypeButton.setTooltip(this._oRb.getText("CHART_TYPE_TOOLTIP",[a]));};w.prototype._updateAvailableChartType=function(){var a=this,b,e,i=[];b=this.getModel("$smartChartTypes");if(!b){return;}e={items:i};var n=this._oChart.getChartType();var y="";this._getAvailableChartTypes().forEach(function(z){var A={key:z.key,text:z.text,icon:a._getMatchingIcon(z.key),selected:n===z.key};i.push(A);if(A.selected){y=A.text;}});b.setData(e);if(this._oChartTypeButton){if(!this._oChartTypeButton.getEnabled()){this._oChartTypeButton.setEnabled(true);}this._enreachButton(n,y);}};w.prototype._createPersonalizationController=function(){if(this._oPersController||!this.getUseChartPersonalisation()){return;}var a=this.data("p13nDialogSettings");if(typeof a==="string"){try{a=JSON.parse(a);}catch(e){a=null;}}a=this._setIgnoreFromPersonalisationToSettings(a);a=a||{};q.sap.require("sap.ui.comp.personalization.Controller");var b=P.createChartWrapper(this._oChart,this._oChart.data("p13nData"));if(this.$()&&this.$().closest(".sapUiSizeCompact").length>0){this._oChart.addStyleClass("sapUiSizeCompact");}this._oPersController=new sap.ui.comp.personalization.Controller({table:b,setting:a,resetToInitialTableState:!this.getUseVariantManagement(),afterP13nModelDataChange:q.proxy(this._personalisationModelDataChange,this)});};w.prototype._setIgnoreFromPersonalisationToSettings=function(a){var i=P.createArrayFromString(this.getIgnoreFromPersonalisation());if(i.length){if(!a){a={};}var b=function(e){if(!a[e]){a[e]={};}a[e].ignoreColumnKeys=i;};b("dimeasure");b("filter");b("sort");}return a;};w.prototype._personalisationModelDataChange=function(e){this._oCurrentVariant=e.getParameter("persistentData");if(this._bApplyingVariant){return;}var a=e.getParameter("changeType");var b=this._getChangeStatus(a);if(b===sap.ui.comp.personalization.ChangeType.Unchanged){return;}if(!this.getUseVariantManagement()){this._persistPersonalisation();}else if(this._oVariantManagement){this._oVariantManagement.currentVariantSetModified(true);}if(b===sap.ui.comp.personalization.ChangeType.TableChanged){if(this._oCurrentVariant.dimeasure&&this._oCurrentVariant.dimeasure.chartTypeKey){this._updateAvailableChartType();}if(this._oSemanticalNavButton){this._oSemanticalNavButton.setEnabled(false);}}else if(b===sap.ui.comp.personalization.ChangeType.ModelChanged){if(this._bIsChartBound||!this._oSmartFilter){this._reBindChart();}else{this._showOverlay(true);}}};w.prototype._getChangeStatus=function(a){if(!a){return sap.ui.comp.personalization.ChangeType.ModelChanged;}if(a.sort===sap.ui.comp.personalization.ChangeType.ModelChanged||a.filter===sap.ui.comp.personalization.ChangeType.ModelChanged||a.dimeasure===sap.ui.comp.personalization.ChangeType.ModelChanged||a.group===sap.ui.comp.personalization.ChangeType.ModelChanged){return sap.ui.comp.personalization.ChangeType.ModelChanged;}if(a.sort===sap.ui.comp.personalization.ChangeType.TableChanged||a.filter===sap.ui.comp.personalization.ChangeType.TableChanged||a.dimeasure===sap.ui.comp.personalization.ChangeType.TableChanged||a.group===sap.ui.comp.personalization.ChangeType.TableChanged){return sap.ui.comp.personalization.ChangeType.TableChanged;}return sap.ui.comp.personalization.ChangeType.Unchanged;};w.prototype.setEntitySet=function(e){this.setProperty("entitySet",e);this._initialiseMetadata();};w.prototype.propagateProperties=function(){V.prototype.propagateProperties.apply(this,arguments);this._initialiseMetadata();};w.prototype._initialiseMetadata=function(){if(!this.bIsInitialised){v.handleModelInit(this,this._onMetadataInitialised);}};w.prototype._onMetadataInitialised=function(){this._bMetaModelLoadAttached=false;if(!this.bIsInitialised){this._createChartProvider();if(this._oChartProvider){this._oChartViewMetadata=this._oChartProvider.getChartViewMetadata();if(this._oChartViewMetadata){this.bIsInitialised=true;this._listenToSmartFilter();this._createVariantManagementControl();this._assignData();this._createContent();this._createToolbarContent();this._createPersonalizationController();this.fireInitialise();if(this.getEnableAutoBinding()){if(this._oSmartFilter&&this._oSmartFilter.isPending()){this._oSmartFilter.search();}else{this._reBindChart();}}}}}};w.prototype._createChartProvider=function(){var a,e;e=this.getEntitySet();a=this.getModel();if(a&&!this._bChartCreated){this._aAlwaysSelect=[];this._createToolbar();this._createChart();this._bChartCreated=true;}if(a&&e){this._oChartProvider=new p({entitySet:e,ignoredFields:this.getIgnoredFields(),dateFormatSettings:this.data("dateFormatSettings"),currencyFormatSettings:this.data("currencyFormatSettings"),defaultDropDownDisplayBehaviour:this.data("defaultDimensionDisplayBehaviour"),useSmartField:this.data("useSmartField"),enableInResultForLineItem:this.data("enableInResultForLineItem"),model:a});}};w.prototype._listenToSmartFilter=function(){var a=null;a=this.getSmartFilterId();this._oSmartFilter=this._findControl(a);if(this._oSmartFilter){this._oSmartFilter.attachSearch(this._reBindChart,this);this._oSmartFilter.attachFilterChange(this._showOverlay,this,true);this._oSmartFilter.attachCancel(this._showOverlay,this,false);}};w.prototype._renderOverlay=function(b){if(this._oChart){var $=this._oChart.$(),a=$.find(".sapUiCompSmartChartOverlay");if(b&&a.length===0){a=q("<div>").addClass("sapUiOverlay sapUiCompSmartChartOverlay").css("z-index","1");$.append(a);}else if(!b){a.remove();}}};w.prototype._showOverlay=function(b){if(b){var a={show:true};this.fireShowOverlay({overlay:a});b=a.show;}this._renderOverlay(b);};w.prototype._findControl=function(i){var R,a;if(i){R=sap.ui.getCore().byId(i);if(!R){a=this._getView();if(a){R=a.byId(i);}}}return R;};w.prototype._getView=function(){if(!this._oView){var a=this.getParent();while(a){if(a instanceof sap.ui.core.mvc.View){this._oView=a;break;}a=a.getParent();}}return this._oView;};w.prototype.rebindChart=function(){this._reBindChart();};w.prototype._reBindChart=function(){var R,a,b,e,n,y=[],z,E,A,G={},H={preventChartBind:false};e=this._getChartPersonalisationData()||{};z=e.filters;E=e.excludeFilters;A=e.sorters;if(this._oSmartFilter){n=this._oSmartFilter.getFilters();G=this._oSmartFilter.getParameters()||{};}if(n&&n.length){if(E){y=[new sap.ui.model.Filter([n[0],E],true)];}else{y=n;}}else if(E){y=[E];}if(z){z=y.concat(z);}else{z=y;}R=this.getRequestAtLeastFields();if(R){a=R.split(",");}else{a=[];}a.concat(this._aAlwaysSelect);if(!b||!b.length){b=a;}else{for(var i=0;i<a.length;i++){if(b.indexOf(a[i])<0){b.push(a[i]);}}}if(b&&b.length){G["select"]=b.toString();}G["entitySet"]=this.getEntitySet();if(!A){A=[];}H.filters=z;H.sorter=A;H.parameters=G;this.fireBeforeRebindChart({bindingParams:H});if(!H.preventChartBind){A=H.sorter;z=H.filters;this._oChart.setBusy(true);this._bDataLoadPending=true;this._oChart.bindData({path:this.getChartBindingPath()||("/"+this.getEntitySet()),parameters:G,filters:z,sorter:A,events:{dataReceived:function(J){if(J&&J.getParameter&&J.getParameter("__simulateAsyncAnalyticalBinding")){return;}this._onDataLoadComplete(J,true);this.fireDataReceived();}.bind(this),change:this._onDataLoadComplete.bind(this)}});this._showOverlay(false);this._bIsChartBound=true;}};w.prototype._onDataLoadComplete=function(e,b){if(this._oSemanticalNavButton){this._oSemanticalNavButton.setEnabled(false);}if(this._bDataLoadPending||b){this._bDataLoadPending=false;this._updateAvailableChartType();this._oChart.setBusy(false);}};w.prototype._assignData=function(){if(this._oChartViewMetadata&&this._oChart){if(this._oChartViewMetadata.measureFields&&(this._oChartViewMetadata.measureFields.length>0)){this._oChart.setVisibleMeasures(this._oChartViewMetadata.measureFields);}if(this._oChartViewMetadata.dimensionFields&&(this._oChartViewMetadata.dimensionFields.length>0)){this._oChart.setVisibleDimensions(this._oChartViewMetadata.dimensionFields);}if(!this.getChartType()&&this._oChartViewMetadata.chartType){this._setChartType(this._oChartViewMetadata.chartType);}if(this._oChartViewMetadata.semantics==="aggregate"){this._oChart.setIsAnalytical(true);}}};w.prototype._createP13nObject=function(a){return{columnKey:a.name,leadingProperty:a.name,additionalProperty:a.additionalProperty,sortProperty:a.sortable?a.name:undefined,filterProperty:a.filterable?a.name:undefined,type:a.filterType,maxLength:a.maxLength,precision:a.precision,scale:a.scale,isMeasure:a.isMeasure,isDimension:a.isDimension,aggregationRole:a.aggregationRole,label:a.fieldLabel,tooltip:a.quickInfo};};w.prototype._createContent=function(){q.sap.require("sap.ui.comp.util.FormatUtil");var i,L=0,a,b,e,n=[],y,z=this;L=this._oChartViewMetadata.fields.length;for(i=0;i<L;i++){b=null;a=this._oChartViewMetadata.fields[i];y=this._createP13nObject(a);e={name:a.name,label:a.fieldLabel};if(a.inResult){this._aAlwaysSelect.push(a.name);}if(a.isDimension){b=new D(e);this._oChart.addDimension(b);if(a.description){b.setTextProperty(a.description);b.setTextFormatter(function(K,A){var N=this.getIdentity();var E=z._getDisplayBehaviour(N);return sap.ui.comp.util.FormatUtil.getFormattedExpressionFromDisplayBehaviour(E,K,A);});}}else if(a.isMeasure){b=new M(e);this._oChart.addMeasure(b);if(a.unit){b.setUnitBinding(a.unit);}}else if(a.sortable||a.filterable){n.push(y);}if(b){if(a.role){b.setRole(a.role);}b.data("p13nData",y);}}if(this._oChart){this._oChart.data("p13nData",n);}};w.prototype._getDisplayBehaviour=function(n){var a=this._getField(n);if(a){return a.displayBehaviour;}return"";};w.prototype._getField=function(n){var a,i,L;if(n&&this._oChartViewMetadata&&this._oChartViewMetadata.fields){L=this._oChartViewMetadata.fields.length;for(i=0;i<L;i++){a=this._oChartViewMetadata.fields[i];if(a.name===n){return a;}}}return null;};w.prototype._createChart=function(){var a=this.getItems(),L=a?a.length:0,b;while(L--){b=a[L];if(b instanceof C){break;}b=null;}if(b){this._oChart=b;}else{this._oChart=new C({uiConfig:{applicationSet:'fiori'},vizProperties:{title:{text:''}},selectionMode:this.getSelectionMode(),width:"100%"});this.insertItem(this._oChart,2);}if(!this._oChart.getLayoutData()){this._oChart.setLayoutData(new sap.m.FlexItemData({growFactor:1,baseSize:"0%"}));}this._setChartType(this.getChartType());this._createTooltipOrPopover();};w.prototype.getChart=function(){return this._oChart;};w.prototype._getChartTypes=function(){var a;try{a=sap.chart.api.getChartTypes();}catch(e){a={};q.sap.log.error("sap.chart.api..getChartTypes throws an exception.\n"+e.toString());}return a;};w.prototype._getAvailableChartTypes=function(){var i,K,a=[],b,e={},n;if(this._oChart){n=P.createArrayFromString(this.getIgnoredChartTypes());e=this._getChartTypes();b=this._oChart.getAvailableChartTypes().available;if(b){for(i=0;i<b.length;i++){K=b[i].chart;if(n.indexOf(K)<0){a.push({key:K,text:e[K]});}}}}return a;};w.prototype._getAllChartTypes=function(){var K,a=[],b,i;i=P.createArrayFromString(this.getIgnoredChartTypes());b=this._getChartTypes();for(K in b){if(K){if(i.indexOf(K)<0){a.push({key:K,text:b[K]});}}}return a;};w.prototype._retrieveChartTypeDescription=function(a){var b=this._getChartTypes();return({key:a,text:b[a]});};w.prototype._setChartType=function(a){if(this._oChart){this._oChart.setChartType(a);}};w.prototype._getDimensions=function(){var a=[];if(this._oChart){a=this._oChart.getDimensions();}return a;};w.prototype._getVisibleDimensions=function(){var a=[];if(this._oChart){a=this._oChart.getVisibleDimensions();}return a;};w.prototype._getMeasures=function(){var a=[];if(this._oChart){a=this._oChart.getMeasures();}return a;};w.prototype._getVisibleMeasures=function(){var a=[];if(this._oChart){a=this._oChart.getVisibleMeasures();}return a;};w.prototype._getSortedDimensions=function(){var e=[];if(this._oChart){e=this._oChart.getDimensions();if(e){e.sort(function(a,b){return a.getLabel().localeCompare(b.getLabel());});}}return e;};w.prototype.fetchVariant=function(){if(this._oCurrentVariant==="STANDARD"||this._oCurrentVariant===null){return{};}return this._oCurrentVariant;};w.prototype.applyVariant=function(a,b){this._oCurrentVariant=a;if(this._oCurrentVariant==="STANDARD"){this._oCurrentVariant=null;}if(b==="STANDARD"){this._oApplicationDefaultVariant=this._oCurrentVariant;}if(this._oApplicationDefaultVariant&&!b){this._oCurrentVariant=q.extend(true,{},this._oApplicationDefaultVariant,a);}this._bApplyingVariant=true;if(this._oPersController){if(this._oCurrentVariant===null||q.isEmptyObject(this._oCurrentVariant)){this._oPersController.resetPersonalization(sap.ui.comp.personalization.ResetType.ResetFull);}else{this._oPersController.setPersonalizationData(this._oCurrentVariant);}}if(this._bIsChartBound||!this._oSmartFilter){this._reBindChart();}else{this._showOverlay(true);}this._bApplyingVariant=false;this.fireAfterVariantApply({currentVariantId:this.getCurrentVariantId()});};w.prototype._getFieldTooltip=function(K){var a=this._getFieldByKey(K);if(a){return a.quickInfo;}return"";};w.prototype._getFieldByKey=function(K){var i,a=null;if(this._oChartViewMetadata&&this._oChartViewMetadata.fields){for(i=0;i<this._oChartViewMetadata.fields.length;i++){a=this._oChartViewMetadata.fields[i];if(K===a.name){return a;}}return null;}};w.prototype._getByKey=function(a,K){var i,L,b,e;if(a){L=a.length;for(i=0;i<L;i++){b=a[i];e=b.data("p13nData");if(e&&e.columnKey===K){return b;}}}return null;};w.prototype._getDimensionByKey=function(K){if(this._oChart){return this._getByKey(this._oChart.getDimensions(),K);}return null;};w.prototype._getMeasureByKey=function(K){if(this._oChart){return this._getByKey(this._oChart.getMeasures(),K);}return null;};w.prototype._getChartObjByKey=function(K){var a=this._getDimensionByKey(K);if(!a){a=this._getMeasureByKey(K);}return a;};w.prototype._getPathFromColumnKeyAndProperty=function(a,b){var e=null,i,n;i=this._getChartObjByKey(a);if(i){n=i.data("p13nData");if(n){e=n[b];}}return e;};w.prototype._getChartPersonalisationData=function(){if(!this._oCurrentVariant){return null;}var a=[],b=[],e=[],E,i,n;if(this._oCurrentVariant.sort){i=this._oCurrentVariant.sort.sortItems;}else{i=this._aInitialSorters;}if(i){i.forEach(function(y){var z=y.operation==="Descending";n=y.columnKey;a.push(new sap.ui.model.Sorter(n,z));},this);}if(this._oCurrentVariant.filter){this._oCurrentVariant.filter.filterItems.forEach(function(y){var z=y.value1,A=y.value2;n=y.columnKey;if(z instanceof Date&&this._oChartProvider&&this._oChartProvider.getIsUTCDateHandlingEnabled()){z=r.getDateInUTCOffset(z);A=A?r.getDateInUTCOffset(A):A;}if(y.exclude){e.push(new s(n,t.NE,z));}else{b.push(new s(n,y.operation,z,A));}},this);if(e.length){E=new s(e,true);}}return{filters:b,excludeFilters:E,sorters:a};};w.prototype._persistPersonalisation=function(){var a=this;if(this._oVariantManagement){this._oVariantManagement.getVariantsInfo(function(b){var e=null;if(b&&b.length>0){e=b[0].key;}var i=e!==null;var n={name:"Personalisation",global:false,overwrite:i,key:e,def:true};a._oVariantManagement.fireSave(n);});}};w.prototype.getCurrentVariantId=function(){var K="";if(this._oVariantManagement){K=this._oVariantManagement.getCurrentVariantId();}return K;};w.prototype.setCurrentVariantId=function(a){if(this._oVariantManagement){this._oVariantManagement.setCurrentVariantId(a);}else{q.sap.log.error("sap.ui.comp.smartchart.SmartChart.prototype.setCurrentVariantId: VariantManagement does not exist");}};w.prototype._adjustHeight=function(){if(this._oChart){var i=0,H=this.getDomRef().offsetHeight;if(H===0){return;}if(this._oToolbar&&this._oToolbar.getDomRef()){i=this._oToolbar.getDomRef().offsetHeight;}var a=0;this._oChart.setHeight((H-i-a)+"px");}};w.prototype.setFullScreen=function(b,a){if(!this.oFullScreenButton||(b===this.bFullScreen&&!a)){return;}this.bFullScreen=b;if(this.bFullScreen){this.oFullScreenButton.setTooltip(this._oRb.getText("CHART_MINIMIZEBTN_TOOLTIP"));this.oFullScreenButton.setIcon("sap-icon://exit-full-screen");this._enterFullScreen();}else{this.oFullScreenButton.setTooltip(this._oRb.getText("CHART_MAXIMIZEBTN_TOOLTIP"));this.oFullScreenButton.setIcon("sap-icon://full-screen");this._exitFullScreen();}};w.prototype._enterFullScreen=function(){q.sap.require("sap.ui.core.delegate.ScrollEnablement");this._oScrollEnablement=new sap.ui.core.delegate.ScrollEnablement(this,this.getId()+'-wrapper',{horizontal:true,vertical:true});if(!this._oPopup){this._oPopup=new sap.ui.core.Popup({modal:true,shadow:false,autoClose:false});}this.$content=this.$();if(this.$content){this.$tempNode=q('<div></div>');this.$content.before(this.$tempNode);this._$overlay=q("<div id='"+q.sap.uid()+"'></div>");this._$overlay.css("top","0px");this._$overlay.css("left","0px");this._$overlay.css("width","100%");this._$overlay.css("height","100%");this._$overlay.append(this.$content);this._oPopup.setContent(this._$overlay);}else{q.sap.log.warn('Overlay: content does not exist or contains more than one child');}this._oToolbar.setDesign(k.Solid);this._oPopup.open(200,null,q('body'));};w.prototype._exitFullScreen=function(){if(!this.$tempNode){return;}if(this._oScrollEnablement){this._oScrollEnablement.destroy();this._oScrollEnablement=null;}this.$tempNode.replaceWith(this.$content);this._oToolbar.setDesign(k.Auto);this._oPopup.close();this._$overlay.remove();};w.prototype.exit=function(){this._oRb=null;if(this._oSmartFilter){this._oSmartFilter.detachSearch(this._reBindChart,this);this._oSmartFilter.detachFilterChange(this._showOverlay,this);this._oSmartFilter.detachCancel(this._showOverlay,this);}if(this._oChartProvider&&this._oChartProvider.destroy){this._oChartProvider.destroy();}this._oChartProvider=null;if(this._oPersController&&this._oPersController.destroy){this._oPersController.destroy();}this._oPersController=null;if(this._oVariantManagement&&this._oVariantManagement.destroy){this._oVariantManagement.destroy();}this._oVariantManagement=null;this._destroyPopover();if(this._oPopup){this._oPopup.destroy();this._oPopup=null;}if(u.system.desktop&&this.sResizeListenerId){sap.ui.core.ResizeHandler.deregister(this.sResizeListenerId);this.sResizeListenerId=null;}else{u.orientation.detachHandler(this._adjustHeight,this);u.resize.detachHandler(this._adjustHeight,this);}this._oCurrentVariant=null;this._oApplicationDefaultVariant=null;this._oChartViewMetadata=null;this._aAlwaysSelect=null;this._oSmartFilter=null;this._oToolbar=null;this._oChartPersonalisationButton=null;this._oView=null;this._oChart=null;};return w;},true);};if(!jQuery.sap.isDeclared('sap.ui.comp.smartmicrochart.SmartAreaMicroChart')){jQuery.sap.declare('sap.ui.comp.smartmicrochart.SmartAreaMicroChart');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.suite.ui.microchart.library');jQuery.sap.require('sap.suite.ui.microchart.AreaMicroChart');jQuery.sap.require('sap.suite.ui.microchart.AreaMicroChartPoint');jQuery.sap.require('sap.suite.ui.microchart.AreaMicroChartItem');sap.ui.define("sap/ui/comp/smartmicrochart/SmartAreaMicroChart",['jquery.sap.global','sap/ui/comp/library','sap/suite/ui/microchart/library','sap/ui/comp/providers/ChartProvider','sap/suite/ui/microchart/AreaMicroChart','sap/suite/ui/microchart/AreaMicroChartPoint','sap/suite/ui/microchart/AreaMicroChartItem'],function(q,l,M,C,A,a,b){"use strict";var S=A.extend("sap.ui.comp.smartmicrochart.SmartAreaMicroChart",{metadata:{library:"sap.ui.comp",properties:{entitySet:{type:"string",group:"Misc",defaultValue:null},smartFilterId:{type:"string",group:"Misc",defaultValue:null},ignoredFields:{type:"string",group:"Misc",defaultValue:null},ignoreFromPersonalisation:{type:"string",group:"Misc",defaultValue:null},chartType:{type:"string",group:"Misc",defaultValue:null},useVariantManagement:{type:"boolean",group:"Misc",defaultValue:true},useChartPersonalisation:{type:"boolean",group:"Misc",defaultValue:true},persistencyKey:{type:"string",group:"Misc",defaultValue:null},currentVariantId:{type:"string",group:"Misc",defaultValue:null},enableAutoBinding:{type:"boolean",group:"Misc",defaultValue:false},chartBindingPath:{type:"string",group:"Misc",defaultValue:null}},events:{initialise:{},beforeRebindChart:{},afterVariantInitialise:{},afterVariantSave:{},afterVariantApply:{},showOverlay:{}}}});S.prototype.setEntitySet=function(e){this.setProperty("entitySet",e);this._initialiseMetadata();};S.prototype.propagateProperties=function(){A.prototype.propagateProperties.apply(this,arguments);this._initialiseMetadata();};S.prototype._initialiseMetadata=function(){if(!this._bIsInitialised){var m=this.getModel();if(m){if(m.bLoadMetadataAsync&&m.getMetaModel()&&m.getMetaModel().loaded){if(!this._bMetaModelLoadAttached){m.getMetaModel().loaded().then(this._onMetadataInitialised.bind(this));this._bMetaModelLoadAttached=true;}}else{this._onMetadataInitialised();}}}};S.prototype._createChartProvider=function(){var m,e;e=this.getEntitySet();m=this.getModel();if(m&&!this._bChartCreated){this._bChartCreated=true;}if(m&&e){this._oChartProvider=new C({entitySet:e,ignoredFields:this.getIgnoredFields(),dateFormatSettings:this.data("dateFormatSettings"),currencyFormatSettings:this.data("currencyFormatSettings"),defaultDropDownDisplayBehaviour:this.data("defaultDropDownDisplayBehaviour"),useSmartField:this.data("useSmartField"),enableInResultForLineItem:this.data("enableInResultForLineItem"),model:m});}};S.prototype._onMetadataInitialised=function(){this._bMetaModelLoadAttached=false;if(!this._bIsInitialised){this._createChartProvider();if(this._oChartProvider){this._oChartViewMetadata=this._oChartProvider.getChartViewMetadata();if(this._oChartViewMetadata){this._bIsInitialised=true;this._assignData();this.fireInitialise();}}}};S.prototype._assignData=function(){if(this._oChartViewMetadata){if(this._oChartViewMetadata.fields&&(this._oChartViewMetadata.fields.length>0)){this._aMeasures=q.grep(this._oChartViewMetadata.fields,function(v,i){return v.isMeasure;});this._aDimensions=q.grep(this._oChartViewMetadata.fields,function(v,i){return v.isDimension;});var t=this;this._aChartPoints=[];q(this._aMeasures[0].dataPoint).map(function(){return this.value;}).each(function(){t._aChartPoints.push(new a({x:this.x,y:this.y}));});this.setChart(new b({points:this._aChartPoints}));this._aTargetPoints=[];q(this._aMeasures[1].dataPoint).map(function(){return this.value;}).each(function(){t._aTargetPoints.push(new a({x:this.x,y:this.y}));});this.setTarget(new b({points:this._aTargetPoints}));this._aInnerMinThresholdPoints=[];q(this._aMeasures[2].dataPoint).map(function(){return this.value;}).each(function(){t._aInnerMinThresholdPoints.push(new a({x:this.x,y:this.y}));});this.setTarget(new b({points:this._aInnerMinThresholdPoints}));this._aInnerMaxThresholdPoints=[];q(this._aMeasures[3].dataPoint).map(function(){return this.value;}).each(function(){t._aInnerMaxThresholdPoints.push(new a({x:this.x,y:this.y}));});this.setTarget(new b({points:this._aInnerMaxThresholdPoints}));this._aMinThresholdPoints=[];q(this._aMeasures[4].dataPoint).map(function(){return this.value;}).each(function(){t._aMinThresholdPoints.push(new a({x:this.x,y:this.y}));});this.setTarget(new b({points:this._aMinThresholdPoints}));this._aMaxThresholdPoints=[];q(this._aMeasures[5].dataPoint).map(function(){return this.value;}).each(function(){t._aMaxThresholdPoints.push(new a({x:this.x,y:this.y}));});this.setTarget(new b({points:this._aMaxThresholdPoints}));}}};return S;});};if(!jQuery.sap.isDeclared('sap.ui.comp.smartmicrochart.SmartBulletMicroChart')){jQuery.sap.declare('sap.ui.comp.smartmicrochart.SmartBulletMicroChart');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.suite.ui.microchart.library');jQuery.sap.require('sap.suite.ui.microchart.BulletMicroChart');sap.ui.define("sap/ui/comp/smartmicrochart/SmartBulletMicroChart",['jquery.sap.global','sap/ui/comp/library','sap/suite/ui/microchart/library','sap/ui/comp/providers/ChartProvider','sap/suite/ui/microchart/BulletMicroChart'],function(q,l,M,C,B){"use strict";var S=B.extend("sap.ui.comp.smartmicrochart.SmartBulletMicroChart",{metadata:{library:"sap.ui.comp",properties:{entitySet:{type:"string",group:"Misc",defaultValue:null},smartFilterId:{type:"string",group:"Misc",defaultValue:null},ignoredFields:{type:"string",group:"Misc",defaultValue:null},ignoreFromPersonalisation:{type:"string",group:"Misc",defaultValue:null},chartType:{type:"string",group:"Misc",defaultValue:null},useVariantManagement:{type:"boolean",group:"Misc",defaultValue:true},useChartPersonalisation:{type:"boolean",group:"Misc",defaultValue:true},persistencyKey:{type:"string",group:"Misc",defaultValue:null},currentVariantId:{type:"string",group:"Misc",defaultValue:null},enableAutoBinding:{type:"boolean",group:"Misc",defaultValue:false},chartBindingPath:{type:"string",group:"Misc",defaultValue:null}},events:{initialise:{},beforeRebindChart:{},afterVariantInitialise:{},afterVariantSave:{},afterVariantApply:{},showOverlay:{}}}});S.prototype.setEntitySet=function(e){this.setProperty("entitySet",e);this._initialiseMetadata();};S.prototype.propagateProperties=function(){B.prototype.propagateProperties.apply(this,arguments);this._initialiseMetadata();};S.prototype._initialiseMetadata=function(){if(!this._bIsInitialised){var m=this.getModel();if(m){if(m.bLoadMetadataAsync&&m.getMetaModel()&&m.getMetaModel().loaded){if(!this._bMetaModelLoadAttached){m.getMetaModel().loaded().then(this._onMetadataInitialised.bind(this));this._bMetaModelLoadAttached=true;}}else{this._onMetadataInitialised();}}}};S.prototype._createChartProvider=function(){var m,e;e=this.getEntitySet();m=this.getModel();if(m&&!this._bChartCreated){this._bChartCreated=true;}if(m&&e){this._oChartProvider=new C({entitySet:e,ignoredFields:this.getIgnoredFields(),dateFormatSettings:this.data("dateFormatSettings"),currencyFormatSettings:this.data("currencyFormatSettings"),defaultDropDownDisplayBehaviour:this.data("defaultDropDownDisplayBehaviour"),useSmartField:this.data("useSmartField"),enableInResultForLineItem:this.data("enableInResultForLineItem"),model:m});}};S.prototype._onMetadataInitialised=function(){this._bMetaModelLoadAttached=false;if(!this._bIsInitialised){this._createChartProvider();if(this._oChartProvider){this._oChartViewMetadata=this._oChartProvider.getChartViewMetadata();if(this._oChartViewMetadata){this._bIsInitialised=true;this._assignData();this.fireInitialise();}}}};S.prototype._assignData=function(){if(this._oChartViewMetadata){if(this._oChartViewMetadata.fields&&(this._oChartViewMetadata.fields.length>0)){this._aMeasures=q.grep(this._oChartViewMetadata.fields,function(v,i){return v.isMeasure;});this._aDimensions=q.grep(this._oChartViewMetadata.fields,function(v,i){return v.isDimension;});if(this._aMeasures[0]!==null&&this._aMeasures[0].dataPoint!==null){var a=this._aMeasures[0].dataPoint;if(a.valueFormat!==null){this.setProperty("scale",a.valueFormat.scalefactor,true);}this.setProperty("showActualValue",a.showActualValue,true);this.setProperty("showDeltaValue",a.showDeltaValue,true);this.setProperty("showValueMarker",a.showValueMarker,true);this.setProperty("mode",a.mode,true);this.setProperty("actualValueLabel",a.actualValueLabel,true);this.setProperty("deltaValueLabel",a.deltaValueLabel,true);this.setProperty("targetValueLabel",a.targetValueLabel,true);}if(this._aMeasures[1]!==null&&this._aMeasures[1].dataPoint!==null){var t=this._aMeasures[1].dataPoint;this.setProperty("targetValue",t.value,true);this.setProperty("showTargetValue",t.showTargetValue,true);}if(this._aMeasures[2]!==null&&this._aMeasures[2].dataPoint!==null){var f=this._aMeasures[2].dataPoint;this.setProperty("forecastValue",f.value,true);if(f.valueRange!==null){this.setProperty("minValue",f.valueRange.minValue,true);this.setProperty("maxValue",f.valueRange.maxValue,true);}}this.invalidate();}}};return S;});};
