/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2014-2016 SAP SE. All rights reserved
 */
sap.ui.define(['jquery.sap.global','./Base'],function(q,B){"use strict";var M=function(){};M.prototype=q.sap.newObject(B.prototype);M.CHANGE_TYPE="moveElements";M.prototype.applyChange=function(c,s){var t=this;var C=c.getContent();if(s.getId()!==c.getSelector().id){throw new Error("Source parent id (selector) doesn't match the control on which to apply the change");}var S=c.getSelector().aggregation;if(!S){throw new Error("No source aggregation supplied via selector for move");}if(!C.target||!C.target.selector){throw new Error("No target supplied for move");}var T=this._byId(C.target.selector.id);if(!T){throw new Error("Move target parent not found");}var a=C.target.selector.aggregation;if(!a){throw new Error("No target aggregation supplied for move");}if(!C.movedElements){throw new Error("No moveElements supplied");}C.movedElements.forEach(function(m){var o=t._byId(m.selector.id);if(!o){throw new Error("Unkown element with id '"+m.selector.id+"' in moveElements supplied");}if(typeof m.targetIndex!=="number"){throw new Error("Missing targetIndex for element with id '"+m.selector.id+"' in moveElements supplied");}t.removeAggregation(s,S,o);t.addAggregation(T,a,o,m.targetIndex);});};M.prototype.completeChangeContent=function(c,s){var t=this;var S=this.getSpecificChangeInfo(s);var C=c.getDefinition();C.changeType=M.CHANGE_TYPE;C.selector=S.source;C.content={movedElements:[],target:{selector:S.target}};S.movedElements.forEach(function(e){var E=e.element||t._byId(e.id);C.content.movedElements.push({selector:{id:E.getId(),type:t._getType(E)},sourceIndex:e.sourceIndex,targetIndex:e.targetIndex});});};M.prototype.getSpecificChangeInfo=function(s){var S=this._getParentElement(this._mSource||s.source);var t=this._getParentElement(this._mTarget||s.target);var a=this._mSource&&this._mSource.aggregation||s.source.aggregation;var T=this._mTarget&&this._mTarget.aggregation||s.target.aggregation;var m={source:{id:S.getId(),aggregation:a,type:this._getType(S)},target:{id:t.getId(),aggregation:T,type:this._getType(t)},movedElements:this._aMovedElements||s.movedElements};return m;};M.prototype.setMovedElements=function(e){this._aMovedElements=e;};M.prototype.setSource=function(s){this._mSource=s;};M.prototype.setTarget=function(t){this._mTarget=t;};M.prototype._byId=function(i){return sap.ui.getCore().byId(i);};M.prototype._getType=function(e){return e.getMetadata().getName();};M.prototype._getParentElement=function(d){var e=d.parent;if(!e){e=this._byId(d.id);}return e;};return M;},true);
