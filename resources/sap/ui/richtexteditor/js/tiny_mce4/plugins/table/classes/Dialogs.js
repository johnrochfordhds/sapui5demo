define("tinymce/tableplugin/Dialogs",["tinymce/util/Tools","tinymce/Env"],function(T,E){var e=T.each;return function(a){var s=this;function c(){var i=a.settings.color_picker_callback;if(i){return function(){var s=this;i.call(a,function(v){s.value(v).fire('change');},s.value());};}}function b(i){return{title:'Advanced',type:'form',defaults:{onchange:function(){h(i,this.parents().reverse()[0],this.name()=="style");}},items:[{label:'Style',name:'style',type:'textbox'},{type:'form',padding:0,formItemDefaults:{layout:'grid',alignH:['start','right']},defaults:{size:7},items:[{label:'Border color',type:'colorbox',name:'borderColor',onaction:c()},{label:'Background color',type:'colorbox',name:'backgroundColor',onaction:c()}]}]};}function r(i){return i?i.replace(/px$/,''):"";}function d(i){if(/^[0-9]+$/.test(i)){i+="px";}return i;}function u(i){e('left center right'.split(' '),function(n){a.formatter.remove('align'+n,{},i);});}function f(i){e('top middle bottom'.split(' '),function(n){a.formatter.remove('valign'+n,{},i);});}function g(i,k,l){function n(v,o){o=o||[];T.each(v,function(p){var q={text:p.text||p.title};if(p.menu){q.menu=n(p.menu);}else{q.value=p.value;if(k){k(q);}}o.push(q);});return o;}return n(i,l||[]);}function h(i,w,k){var l=w.toJSON();var n=i.parseStyle(l.style);if(k){w.find('#borderColor').value(n["border-color"]||'')[0].fire('change');w.find('#backgroundColor').value(n["background-color"]||'')[0].fire('change');}else{n["border-color"]=l.borderColor;n["background-color"]=l.backgroundColor;}w.find('#style').value(i.serializeStyle(i.parseStyle(i.serializeStyle(n))));}function j(i,k,l){var n=i.parseStyle(i.getAttrib(l,'style'));if(n["border-color"]){k.borderColor=n["border-color"];}if(n["background-color"]){k.backgroundColor=n["background-color"];}k.style=i.serializeStyle(n);}function m(i,k,l){var n=i.parseStyle(i.getAttrib(k,'style'));e(l,function(o){n[o.name]=o.value;});i.setAttrib(k,'style',i.serializeStyle(i.parseStyle(i.serializeStyle(n))));}s.tableProps=function(){s.table(true);};s.table=function(k){var l=a.dom,t,n,o,p,q={},v,w;function x(){function z(B,C,D){if(B.tagName==="TD"||B.tagName==="TH"){l.setStyle(B,C,D);}else{if(B.children){for(var i=0;i<B.children.length;i++){z(B.children[i],C,D);}}}}var A;h(l,this);q=T.extend(q,this.toJSON());if(q["class"]===false){delete q["class"];}a.undoManager.transact(function(){if(!t){t=a.plugins.table.insertTable(q.cols||1,q.rows||1);}a.dom.setAttribs(t,{style:q.style,'class':q['class']});if(a.settings.table_style_by_css){w=[];w.push({name:'border',value:q.border});w.push({name:'border-spacing',value:d(q.cellspacing)});m(l,t,w);l.setAttribs(t,{'data-mce-border-color':q.borderColor,'data-mce-cell-padding':q.cellpadding,'data-mce-border':q.border});if(t.children){for(var i=0;i<t.children.length;i++){z(t.children[i],'border',q.border);z(t.children[i],'padding',d(q.cellpadding));}}}else{a.dom.setAttribs(t,{border:q.border,cellpadding:q.cellpadding,cellspacing:q.cellspacing});}if(l.getAttrib(t,'width')&&!a.settings.table_style_by_css){l.setAttrib(t,'width',r(q.width));}else{l.setStyle(t,'width',d(q.width));}l.setStyle(t,'height',d(q.height));A=l.select('caption',t)[0];if(A&&!q.caption){l.remove(A);}if(!A&&q.caption){A=l.create('caption');A.innerHTML=!E.ie?'<br data-mce-bogus="1"/>':'\u00a0';t.insertBefore(A,t.firstChild);}u(t);if(q.align){a.formatter.apply('align'+q.align,{},t);}a.focus();a.addVisual();});}function y(z,A){var B=a.dom.select("td,th",z),C;function D(C,F){for(var i=0;i<F.length;i++){var G=l.getStyle(F[i],A);if(typeof C==="undefined"){C=G;}if(C!=G){return"";}}return C;}C=D(C,B);return C;}if(k===true){t=l.getParent(a.selection.getStart(),'table');if(t){q={width:r(l.getStyle(t,'width')||l.getAttrib(t,'width')),height:r(l.getStyle(t,'height')||l.getAttrib(t,'height')),cellspacing:r(l.getStyle(t,'border-spacing')||l.getAttrib(t,'cellspacing')),cellpadding:l.getAttrib(t,'data-mce-cell-padding')||l.getAttrib(t,'cellpadding')||y(t,'padding'),border:l.getAttrib(t,'data-mce-border')||l.getAttrib(t,'border')||y(t,'border'),borderColor:l.getAttrib(t,'data-mce-border-color'),caption:!!l.select('caption',t)[0],'class':l.getAttrib(t,'class')};e('left center right'.split(' '),function(i){if(a.formatter.matchNode(t,'align'+i)){q.align=i;}});}}else{n={label:'Cols',name:'cols'};o={label:'Rows',name:'rows'};}if(a.settings.table_class_list){if(q["class"]){q["class"]=q["class"].replace(/\s*mce\-item\-table\s*/g,'');}p={name:'class',type:'listbox',label:'Class',values:g(a.settings.table_class_list,function(i){if(i.value){i.textStyle=function(){return a.formatter.getCssText({block:'table',classes:[i.value]});};}})};}v={type:'form',layout:'flex',direction:'column',labelGapCalc:'children',padding:0,items:[{type:'form',labelGapCalc:false,padding:0,layout:'grid',columns:2,defaults:{type:'textbox',maxWidth:50},items:(a.settings.table_appearance_options!==false)?[n,o,{label:'Width',name:'width'},{label:'Height',name:'height'},{label:'Cell spacing',name:'cellspacing'},{label:'Cell padding',name:'cellpadding'},{label:'Border',name:'border'},{label:'Caption',name:'caption',type:'checkbox'}]:[n,o,{label:'Width',name:'width'},{label:'Height',name:'height'}]},{label:'Alignment',name:'align',type:'listbox',text:'None',values:[{text:'None',value:''},{text:'Left',value:'left'},{text:'Center',value:'center'},{text:'Right',value:'right'}]},p]};if(a.settings.table_advtab!==false){j(l,q,t);a.windowManager.open({title:"Table properties",data:q,bodyType:'tabpanel',body:[{title:'General',type:'form',items:v},b(l)],onsubmit:x});}else{a.windowManager.open({title:"Table properties",data:q,body:v,onsubmit:x});}};s.merge=function(i,k){a.windowManager.open({title:"Merge cells",body:[{label:'Cols',name:'cols',type:'textbox',value:'1',size:10},{label:'Rows',name:'rows',type:'textbox',value:'1',size:10}],onsubmit:function(){var l=this.toJSON();a.undoManager.transact(function(){i.merge(k,l.cols,l.rows);});}});};s.cell=function(){var i=a.dom,k,l,n,o=[];function p(){h(i,this);l=T.extend(l,this.toJSON());a.undoManager.transact(function(){e(o,function(k){a.dom.setAttribs(k,{scope:l.scope,style:l.style,'class':l['class']});a.dom.setStyles(k,{width:d(l.width),height:d(l.height)});if(l.type&&k.nodeName.toLowerCase()!=l.type){k=i.rename(k,l.type);}u(k);if(l.align){a.formatter.apply('align'+l.align,{},k);}f(k);if(l.valign){a.formatter.apply('valign'+l.valign,{},k);}});a.focus();});}o=a.dom.select('td[data-mce-selected],th[data-mce-selected]');k=a.dom.getParent(a.selection.getStart(),'td,th');if(!o.length&&k){o.push(k);}k=k||o[0];if(!k){return;}l={width:r(i.getStyle(k,'width')||i.getAttrib(k,'width')),height:r(i.getStyle(k,'height')||i.getAttrib(k,'height')),scope:i.getAttrib(k,'scope'),'class':i.getAttrib(k,'class')};l.type=k.nodeName.toLowerCase();e('left center right'.split(' '),function(t){if(a.formatter.matchNode(k,'align'+t)){l.align=t;}});e('top middle bottom'.split(' '),function(t){if(a.formatter.matchNode(k,'valign'+t)){l.valign=t;}});if(a.settings.table_cell_class_list){n={name:'class',type:'listbox',label:'Class',values:g(a.settings.table_cell_class_list,function(t){if(t.value){t.textStyle=function(){return a.formatter.getCssText({block:'td',classes:[t.value]});};}})};}var q={type:'form',layout:'flex',direction:'column',labelGapCalc:'children',padding:0,items:[{type:'form',layout:'grid',columns:2,labelGapCalc:false,padding:0,defaults:{type:'textbox',maxWidth:50},items:[{label:'Width',name:'width'},{label:'Height',name:'height'},{label:'Cell type',name:'type',type:'listbox',text:'None',minWidth:90,maxWidth:null,values:[{text:'Cell',value:'td'},{text:'Header cell',value:'th'}]},{label:'Scope',name:'scope',type:'listbox',text:'None',minWidth:90,maxWidth:null,values:[{text:'None',value:''},{text:'Row',value:'row'},{text:'Column',value:'col'},{text:'Row group',value:'rowgroup'},{text:'Column group',value:'colgroup'}]},{label:'H Align',name:'align',type:'listbox',text:'None',minWidth:90,maxWidth:null,values:[{text:'None',value:''},{text:'Left',value:'left'},{text:'Center',value:'center'},{text:'Right',value:'right'}]},{label:'V Align',name:'valign',type:'listbox',text:'None',minWidth:90,maxWidth:null,values:[{text:'None',value:''},{text:'Top',value:'top'},{text:'Middle',value:'middle'},{text:'Bottom',value:'bottom'}]}]},n]};if(a.settings.table_cell_advtab!==false){j(i,l,k);a.windowManager.open({title:"Cell properties",bodyType:'tabpanel',data:l,body:[{title:'General',type:'form',items:q},b(i)],onsubmit:p});}else{a.windowManager.open({title:"Cell properties",data:l,body:q,onsubmit:p});}};s.row=function(){var i=a.dom,t,k,l,n,o,p=[],q;function v(){var t,w,x;h(i,this);o=T.extend(o,this.toJSON());a.undoManager.transact(function(){var y=o.type;e(p,function(l){a.dom.setAttribs(l,{scope:o.scope,style:o.style,'class':o['class']});a.dom.setStyles(l,{height:d(o.height)});if(y!=l.parentNode.nodeName.toLowerCase()){t=i.getParent(l,'table');w=l.parentNode;x=i.select(y,t)[0];if(!x){x=i.create(y);if(t.firstChild){t.insertBefore(x,t.firstChild);}else{t.appendChild(x);}}x.appendChild(l);if(!w.hasChildNodes()){i.remove(w);}}u(l);if(o.align){a.formatter.apply('align'+o.align,{},l);}});a.focus();});}t=a.dom.getParent(a.selection.getStart(),'table');k=a.dom.getParent(a.selection.getStart(),'td,th');e(t.rows,function(w){e(w.cells,function(x){if(i.getAttrib(x,'data-mce-selected')||x==k){p.push(w);return false;}});});l=p[0];if(!l){return;}o={height:r(i.getStyle(l,'height')||i.getAttrib(l,'height')),scope:i.getAttrib(l,'scope'),'class':i.getAttrib(l,'class')};o.type=l.parentNode.nodeName.toLowerCase();e('left center right'.split(' '),function(w){if(a.formatter.matchNode(l,'align'+w)){o.align=w;}});if(a.settings.table_row_class_list){n={name:'class',type:'listbox',label:'Class',values:g(a.settings.table_row_class_list,function(w){if(w.value){w.textStyle=function(){return a.formatter.getCssText({block:'tr',classes:[w.value]});};}})};}q={type:'form',columns:2,padding:0,defaults:{type:'textbox'},items:[{type:'listbox',name:'type',label:'Row type',text:'None',maxWidth:null,values:[{text:'Header',value:'thead'},{text:'Body',value:'tbody'},{text:'Footer',value:'tfoot'}]},{type:'listbox',name:'align',label:'Alignment',text:'None',maxWidth:null,values:[{text:'None',value:''},{text:'Left',value:'left'},{text:'Center',value:'center'},{text:'Right',value:'right'}]},{label:'Height',name:'height'},n]};if(a.settings.table_row_advtab!==false){j(i,o,l);a.windowManager.open({title:"Row properties",data:o,bodyType:'tabpanel',body:[{title:'General',type:'form',items:q},b(i)],onsubmit:v});}else{a.windowManager.open({title:"Row properties",data:o,body:q,onsubmit:v});}};};});
