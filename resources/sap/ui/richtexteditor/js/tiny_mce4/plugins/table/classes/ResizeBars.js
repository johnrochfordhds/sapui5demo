define("tinymce/tableplugin/ResizeBars",["tinymce/util/Tools","tinymce/util/VK"],function(T,V){var h;return function(a){var R='mce-resize-bar',b='mce-resize-bar-row',c='row-resize',d='data-row',f='data-initial-top',g='mce-resize-bar-col',k='col-resize',l='data-col',m='data-initial-left',n=4,o=10,p=10,q='mce-resize-bar-dragging';var s=new RegExp(/(\d+(\.\d+)?%)/),t=new RegExp(/px|em/);var u,v,w,x,y,z;function A(i,r){return{index:i,y:a.dom.getPos(r).y};}function B(i,r){return{index:i,y:a.dom.getPos(r).y+r.offsetHeight};}function C(i,e){return{index:i,x:a.dom.getPos(e).x};}function D(i,e){return{index:i,x:a.dom.getPos(e).x+e.offsetWidth};}function E(){var e=a.getBody().dir;return e==='rtl';}function F(){return a.inline;}function G(){return F?a.getBody().ownerDocument.body:a.getBody();}function H(i,e){return E()?D(i,e):C(i,e);}function I(i,e){return E()?C(i,e):D(i,e);}function J(e,i){return K(e,'width')/K(i,'width')*100;}function K(e,i){var j=a.dom.getStyle(e,i,true);var r=parseInt(j,10);return r;}function L(e){var i=K(e,'width');var j=K(e.parentElement,'width');return i/j*100;}function M(e,i){var j=K(e,'width');return i/j*100;}function N(e,i){var j=K(e.parentElement,'width');return i/j*100;}function O(e,j,r){var E1=[];for(var i=1;i<r.length;i++){var F1=r[i].element;E1.push(e(i-1,F1));}var G1=r[r.length-1];E1.push(j(r.length-1,G1.element));return E1;}function P(){var e=a.dom.select('.'+R,G());T.each(e,function(i){a.dom.remove(i);});}function Q(e){P();b1(e);}function S(e,i,j,r,E1,F1,G1,H1){var I1={'data-mce-bogus':'all','class':R+' '+e,'unselectable':'on','data-mce-resize':false,style:'cursor: '+i+'; '+'margin: 0; '+'padding: 0; '+'position: absolute; '+'left: '+j+'px; '+'top: '+r+'px; '+'height: '+E1+'px; '+'width: '+F1+'px; '};I1[G1]=H1;return I1;}function U(r,e,i){T.each(r,function(j){var E1=i.x,F1=j.y-n/2,G1=n,H1=e;a.dom.add(G(),'div',S(b,c,E1,F1,G1,H1,d,j.index));});}function W(e,i,j){T.each(e,function(r){var E1=r.x-n/2,F1=j.y,G1=i,H1=n;a.dom.add(G(),'div',S(g,k,E1,F1,G1,H1,l,r.index));});}function X(e){return T.map(e.rows,function(r){var i=T.map(r.cells,function(j){var E1=j.hasAttribute('rowspan')?parseInt(j.getAttribute('rowspan'),10):1;var F1=j.hasAttribute('colspan')?parseInt(j.getAttribute('colspan'),10):1;return{element:j,rowspan:E1,colspan:F1};});return{element:r,cells:i};});}function Y(e){function r(i,j){return i+','+j;}function E1(i,j){return H1[r(i,j)];}function F1(){var i=[];T.each(I1,function(j){i=i.concat(j.cells);});return i;}function G1(){return I1;}var H1={};var I1=[];var J1=0;var K1=0;T.each(e,function(L1,M1){var N1=[];T.each(L1.cells,function(O1){var P1=0;while(H1[r(M1,P1)]!==undefined){P1++;}var Q1={element:O1.element,colspan:O1.colspan,rowspan:O1.rowspan,rowIndex:M1,colIndex:P1};for(var i=0;i<O1.colspan;i++){for(var j=0;j<O1.rowspan;j++){var cr=M1+j;var cc=P1+i;H1[r(cr,cc)]=Q1;J1=Math.max(J1,cr+1);K1=Math.max(K1,cc+1);}}N1.push(Q1);});I1.push({element:L1.element,cells:N1});});return{grid:{maxRows:J1,maxCols:K1},getAt:E1,getAllCells:F1,getAllRows:G1};}function Z(e,j){var r=[];for(var i=e;i<j;i++){r.push(i);}return r;}function $(e,j,r){var E1=e();var F1;for(var i=0;i<E1.length;i++){if(j(E1[i])){F1=E1[i];}}return F1?F1:r();}function _(e){var j=Z(0,e.grid.maxCols);var r=Z(0,e.grid.maxRows);return T.map(j,function(E1){function F1(){var I1=[];for(var i=0;i<r.length;i++){var J1=e.getAt(i,E1);if(J1&&J1.colIndex===E1){I1.push(J1);}}return I1;}function G1(i){return i.colspan===1;}function H1(){var I1;for(var i=0;i<r.length;i++){I1=e.getAt(i,E1);if(I1){return I1;}}return null;}return $(F1,G1,H1);});}function a1(e){var j=Z(0,e.grid.maxCols);var r=Z(0,e.grid.maxRows);return T.map(r,function(E1){function F1(){var I1=[];for(var i=0;i<j.length;i++){var J1=e.getAt(E1,i);if(J1&&J1.rowIndex===E1){I1.push(J1);}}return I1;}function G1(i){return i.rowspan===1;}function H1(){return e.getAt(E1,0);}return $(F1,G1,H1);});}function b1(e){var i=X(e);var j=Y(i);var r=a1(j);var E1=_(j);var F1=a.dom.getPos(e);var G1=r.length>0?O(A,B,r):[];var H1=E1.length>0?O(H,I,E1):[];U(G1,e.offsetWidth,F1);W(H1,e.offsetHeight,F1);}function c1(e,r,E1,F1){if(r<0||r>=e.length-1){return"";}var G1=e[r];if(G1){G1={value:G1,delta:0};}else{var H1=e.slice(0,r).reverse();for(var i=0;i<H1.length;i++){if(H1[i]){G1={value:H1[i],delta:i+1};}}}var I1=e[r+1];if(I1){I1={value:I1,delta:1};}else{var J1=e.slice(r+1);for(var j=0;j<J1.length;j++){if(J1[j]){I1={value:J1[j],delta:j+1};}}}var K1=I1.delta-G1.delta;var L1=Math.abs(I1.value-G1.value)/K1;return E1?L1/K(F1,'width')*100:L1;}function d1(e,i){var j=a.dom.getStyle(e,i);if(!j){j=a.dom.getAttrib(e,i);}if(!j){j=a.dom.getStyle(e,i,true);}return j;}function e1(e,i,j){var r=d1(e,'width');var E1=parseInt(r,10);var F1=i?J(e,j):K(e,'width');if(i&&!n1(r)||!i&&!o1(r)){E1=0;}return!isNaN(E1)&&E1>0?E1:F1;}function f1(e,j,r){var E1=_(e);var F1=T.map(E1,function(J1){return H(J1.colIndex,J1.element).x;});var G1=[];for(var i=0;i<E1.length;i++){var H1=E1[i].element.hasAttribute('colspan')?parseInt(E1[i].element.getAttribute('colspan'),10):1;var I1=H1>1?c1(F1,i):e1(E1[i].element,j,r);I1=I1?I1:o;G1.push(I1);}return G1;}function g1(e){var i=d1(e,'height');var j=parseInt(i,10);if(n1(i)){j=0;}return!isNaN(j)&&j>0?j:K(e,'height');}function h1(e){var r=a1(e);var j=T.map(r,function(H1){return A(H1.rowIndex,H1.element).y;});var E1=[];for(var i=0;i<r.length;i++){var F1=r[i].element.hasAttribute('rowspan')?parseInt(r[i].element.getAttribute('rowspan'),10):1;var G1=F1>1?c1(j,i):g1(r[i].element);G1=G1?G1:p;E1.push(G1);}return E1;}function i1(e,i,j,r,E1){var F1=e.slice(0);function G1(L1){return T.map(L1,function(){return 0;});}function H1(){var K1;if(E1){K1=[100-F1[0]];}else{var L1=Math.max(r,F1[0]+j);K1=[L1-F1[0]];}return K1;}function I1(L1,M1){var N1=G1(F1.slice(0,L1));var O1=G1(F1.slice(M1+1));var K1;if(j>=0){var P1=Math.max(r,F1[M1]-j);K1=N1.concat([j,P1-F1[M1]]).concat(O1);}else{var Q1=Math.max(r,F1[L1]+j);var R1=F1[L1]-Q1;K1=N1.concat([Q1-F1[L1],R1]).concat(O1);}return K1;}function J1(L1,M1){var N1=G1(F1.slice(0,M1));var K1;if(j>=0){K1=N1.concat([j]);}else{var O1=Math.max(r,F1[M1]+j);K1=N1.concat([O1-F1[M1]]);}return K1;}var K1;if(e.length===0){K1=[];}else if(e.length===1){K1=H1();}else if(i===0){K1=I1(0,1);}else if(i>0&&i<e.length-1){K1=I1(i,i+1);}else if(i===e.length-1){K1=J1(i-1,i);}else{K1=[];}return K1;}function j1(e,j,E1){var r=0;for(var i=e;i<j;i++){r+=E1[i];}return r;}function k1(e,i){var j=e.getAllCells();return T.map(j,function(r){var E1=j1(r.colIndex,r.colIndex+r.colspan,i);return{element:r.element,width:E1,colspan:r.colspan};});}function l1(e,i){var j=e.getAllCells();return T.map(j,function(r){var E1=j1(r.rowIndex,r.rowIndex+r.rowspan,i);return{element:r.element,height:E1,rowspan:r.rowspan};});}function m1(e,j){var r=e.getAllRows();return T.map(r,function(E1,i){return{element:E1.element,height:j[i]};});}function n1(e){return s.test(e);}function o1(e){return t.test(e);}function p1(e,j,r){var E1=X(e);var F1=Y(E1);function G1(P1,Q1){T.each(P1,function(S1){a.dom.setStyle(S1.element,'width',S1.width+Q1);a.dom.setAttrib(S1.element,'width',null);});}function H1(){return r<F1.grid.maxCols-1?L(e):L(e)+N(e,j);}function I1(){return r<F1.grid.maxCols-1?K(e,'width'):K(e,'width')+j;}function J1(R1,Q1,S1){if(r==F1.grid.maxCols-1||!S1){a.dom.setStyle(e,'width',R1+Q1);a.dom.setAttrib(e,'width',null);}}var K1=n1(e.width)||n1(e.style.width);var L1=f1(F1,K1,e);var M1=K1?M(e,j):j;var N1=i1(L1,r,M1,o,K1,e);var O1=[];for(var i=0;i<N1.length;i++){O1.push(N1[i]+L1[i]);}var P1=k1(F1,O1);var Q1=K1?'%':'px';var R1=K1?H1():I1();a.undoManager.transact(function(){G1(P1,Q1);J1(R1,Q1,K1);});}function q1(e,j,r){var E1=X(e);var F1=Y(E1);var G1=h1(F1);var H1=[],I1=0;for(var i=0;i<G1.length;i++){H1.push(i===r?j+G1[i]:G1[i]);I1+=I1[i];}var J1=l1(F1,H1);var K1=m1(F1,H1);a.undoManager.transact(function(){T.each(K1,function(L1){a.dom.setStyle(L1.element,'height',L1.height+'px');a.dom.setAttrib(L1.element,'height',null);});T.each(J1,function(L1){a.dom.setStyle(L1.element,'height',L1.height+'px');a.dom.setAttrib(L1.element,'height',null);});a.dom.setStyle(e,'height',I1+'px');a.dom.setAttrib(e,'height',null);});}function r1(){u=setTimeout(function(){v1();},200);}function s1(){clearTimeout(u);}function t1(){var e=document.createElement('div');e.setAttribute('style','margin: 0; '+'padding: 0; '+'position: fixed; '+'left: 0px; '+'top: 0px; '+'height: 100%; '+'width: 100%;');e.setAttribute('data-mce-bogus','all');return e;}function u1(i,j){a.dom.bind(i,'mouseup',function(){v1();});a.dom.bind(i,'mousemove',function(e){s1();if(v){j(e);}});a.dom.bind(i,'mouseout',function(){r1();});}function v1(){a.dom.remove(w);if(v){a.dom.removeClass(x,q);v=false;var i,e;if(x1(x)){var j=parseInt(a.dom.getAttrib(x,m),10);var r=a.dom.getPos(x).x;i=parseInt(a.dom.getAttrib(x,l),10);e=E()?j-r:r-j;p1(h,e,i);}else if(y1(x)){var E1=parseInt(a.dom.getAttrib(x,f),10);var F1=a.dom.getPos(x).y;i=parseInt(a.dom.getAttrib(x,d),10);e=F1-E1;q1(h,e,i);}Q(h);a.nodeChanged();}}function w1(e,i){w=w?w:t1();v=true;a.dom.addClass(e,q);x=e;u1(w,i);a.dom.add(G(),w);}function x1(e){return a.dom.hasClass(e,g);}function y1(e){return a.dom.hasClass(e,b);}function z1(e){y=y!==undefined?y:e.clientX;var i=e.clientX-y;y=e.clientX;var j=a.dom.getPos(x).x;a.dom.setStyle(x,'left',j+i+'px');}function A1(e){z=z!==undefined?z:e.clientY;var i=e.clientY-z;z=e.clientY;var j=a.dom.getPos(x).y;a.dom.setStyle(x,'top',j+i+'px');}function B1(e){y=undefined;w1(e,z1);}function C1(e){z=undefined;w1(e,A1);}function D1(e){var i=e.target,j=a.getBody();if(!a.$.contains(j,h)&&h!==j){return;}if(x1(i)){e.preventDefault();var r=a.dom.getPos(i).x;a.dom.setAttrib(i,m,r);B1(i);}else if(y1(i)){e.preventDefault();var E1=a.dom.getPos(i).y;a.dom.setAttrib(i,f,E1);C1(i);}}a.on('init',function(){a.dom.bind(G(),'mousedown',D1);});a.on('ObjectResized',function(e){var i=e.target;if(i.nodeName==='TABLE'){var j=[];T.each(i.rows,function(r){T.each(r.cells,function(E1){var F1=a.dom.getStyle(E1,'width',true);j.push({cell:E1,width:F1});});});T.each(j,function(r){a.dom.setStyle(r.cell,'width',r.width);a.dom.setAttrib(r.cell,'width',null);});}});a.on('mouseover',function(e){if(!v){var i=a.dom.getParent(e.target,'table');if(e.target.nodeName==='TABLE'||i){h=i;Q(i);}}});a.on('keydown',function(e){switch(e.keyCode){case V.LEFT:case V.RIGHT:case V.UP:case V.DOWN:P();break;}});a.on('remove',function(){P();a.dom.unbind(G(),'mousedown',D1);});return{adjustWidth:p1,adjustHeight:q1,clearBars:P,drawBars:b1,determineDeltas:i1,getTableGrid:Y,getTableDetails:X,getWidths:f1,getPixelHeights:h1,isPercentageBasedSize:n1,isPixelBasedSize:o1,recalculateWidths:k1,recalculateCellHeights:l1,recalculateRowHeights:m1};};});
