define("tinymce/tableplugin/Plugin",["tinymce/tableplugin/TableGrid","tinymce/tableplugin/Quirks","tinymce/tableplugin/CellSelection","tinymce/tableplugin/Dialogs","tinymce/tableplugin/ResizeBars","tinymce/util/Tools","tinymce/dom/TreeWalker","tinymce/Env","tinymce/PluginManager"],function(T,Q,C,D,R,a,b,E,P){var c=a.each;function d(f){var g,s=this,h=new D(f),r;if(f.settings.object_resizing&&f.settings.table_resize_bars!==false&&(f.settings.object_resizing===true||f.settings.object_resizing==='table')){r=R(f);}function j(e){return function(){f.execCommand(e);};}function k(e,i){var y,x,z,A;z='<table id="__mce"><tbody>';for(y=0;y<i;y++){z+='<tr>';for(x=0;x<e;x++){z+='<td>'+(E.ie&&E.ie<10?'&nbsp;':'<br>')+'</td>';}z+='</tr>';}z+='</tbody></table>';f.undoManager.transact(function(){f.insertContent(z);A=f.dom.get('__mce');f.dom.setAttrib(A,'id',null);f.$('tr',A).each(function(B,F){f.fire('newrow',{node:F});f.$('th,td',F).each(function(B,G){f.fire('newcell',{node:G});});});f.dom.setAttribs(A,f.settings.table_default_attributes||{});f.dom.setStyles(A,f.settings.table_default_styles||{});});return A;}function l(e,i,x){function y(){var z,A,B={},F=0,G;A=f.dom.select('td[data-mce-selected],th[data-mce-selected]');z=A[0];if(!z){z=f.selection.getStart();}if(x&&A.length>0){c(A,function(H){return B[H.parentNode.parentNode.nodeName]=1;});c(B,function(H){F+=H;});G=F!==1;}else{G=!f.dom.getParent(z,i);}e.disabled(G);f.selection.selectorChanged(i,function(G){e.disabled(!G);});}if(f.initialized){y();}else{f.on('init',y);}}function p(){l(this,'table');}function m(){l(this,'td,th');}function n(){l(this,'td,th',true);}function o(){var e='';e='<table role="grid" class="mce-grid mce-grid-border" aria-readonly="true">';for(var y=0;y<10;y++){e+='<tr>';for(var x=0;x<10;x++){e+='<td role="gridcell" tabindex="-1"><a id="mcegrid'+(y*10+x)+'" href="#" '+'data-mce-x="'+x+'" data-mce-y="'+y+'"></a></td>';}e+='</tr>';}e+='</table>';e+='<div class="mce-text-center" role="presentation">1 x 1</div>';return e;}function q(e,i,z){var A=z.getEl().getElementsByTagName('table')[0];var x,y,B,F,G;var H=z.isRtl()||z.parent().rel=='tl-tr';A.nextSibling.innerHTML=(e+1)+' x '+(i+1);if(H){e=9-e;}for(y=0;y<10;y++){for(x=0;x<10;x++){F=A.rows[y].childNodes[x].firstChild;G=(H?x>=e:x<=e)&&y<=i;f.dom.toggleClass(F,'mce-active',G);if(G){B=F;}}}return B.parentNode;}if(f.settings.table_grid===false){f.addMenuItem('inserttable',{text:'Insert table',icon:'table',context:'table',onclick:h.table});}else{f.addMenuItem('inserttable',{text:'Insert table',icon:'table',context:'table',ariaHideMenu:true,onclick:function(e){if(e.aria){this.parent().hideAll();e.stopImmediatePropagation();h.table();}},onshow:function(){q(0,0,this.menu.items()[0]);},onhide:function(){var e=this.menu.items()[0].getEl().getElementsByTagName('a');f.dom.removeClass(e,'mce-active');f.dom.addClass(e[0],'mce-active');},menu:[{type:'container',html:o(),onPostRender:function(){this.lastX=this.lastY=0;},onmousemove:function(e){var i=e.target,x,y;if(i.tagName.toUpperCase()=='A'){x=parseInt(i.getAttribute('data-mce-x'),10);y=parseInt(i.getAttribute('data-mce-y'),10);if(this.isRtl()||this.parent().rel=='tl-tr'){x=9-x;}if(x!==this.lastX||y!==this.lastY){q(x,y,e.control);this.lastX=x;this.lastY=y;}}},onclick:function(e){var s=this;if(e.target.tagName.toUpperCase()=='A'){e.preventDefault();e.stopPropagation();s.parent().cancel();f.undoManager.transact(function(){k(s.lastX+1,s.lastY+1);});f.addVisual();}}}]});}f.addMenuItem('tableprops',{text:'Table properties',context:'table',onPostRender:p,onclick:h.tableProps});f.addMenuItem('deletetable',{text:'Delete table',context:'table',onPostRender:p,cmd:'mceTableDelete'});f.addMenuItem('cell',{separator:'before',text:'Cell',context:'table',menu:[{text:'Cell properties',onclick:j('mceTableCellProps'),onPostRender:m},{text:'Merge cells',onclick:j('mceTableMergeCells'),onPostRender:n},{text:'Split cell',onclick:j('mceTableSplitCells'),onPostRender:m}]});f.addMenuItem('row',{text:'Row',context:'table',menu:[{text:'Insert row before',onclick:j('mceTableInsertRowBefore'),onPostRender:m},{text:'Insert row after',onclick:j('mceTableInsertRowAfter'),onPostRender:m},{text:'Delete row',onclick:j('mceTableDeleteRow'),onPostRender:m},{text:'Row properties',onclick:j('mceTableRowProps'),onPostRender:m},{text:'-'},{text:'Cut row',onclick:j('mceTableCutRow'),onPostRender:m},{text:'Copy row',onclick:j('mceTableCopyRow'),onPostRender:m},{text:'Paste row before',onclick:j('mceTablePasteRowBefore'),onPostRender:m},{text:'Paste row after',onclick:j('mceTablePasteRowAfter'),onPostRender:m}]});f.addMenuItem('column',{text:'Column',context:'table',menu:[{text:'Insert column before',onclick:j('mceTableInsertColBefore'),onPostRender:m},{text:'Insert column after',onclick:j('mceTableInsertColAfter'),onPostRender:m},{text:'Delete column',onclick:j('mceTableDeleteCol'),onPostRender:m}]});var t=[];c("inserttable tableprops deletetable | cell row column".split(' '),function(e){if(e=='|'){t.push({text:'-'});}else{t.push(f.menuItems[e]);}});f.addButton("table",{type:"menubutton",title:"Table",menu:t});if(!E.isIE){f.on('click',function(e){e=e.target;if(e.nodeName==='TABLE'){f.selection.select(e);f.nodeChanged();}});}s.quirks=new Q(f);f.on('Init',function(){s.cellSelection=new C(f);s.resizeBars=r;});f.on('PreInit',function(){f.serializer.addAttributeFilter('data-mce-cell-padding,data-mce-border,data-mce-border-color',function(e,x){var i=e.length;while(i--){e[i].attr(x,null);}});});c({mceTableSplitCells:function(e){e.split();},mceTableMergeCells:function(e){var i;i=f.dom.getParent(f.selection.getStart(),'th,td');if(!f.dom.select('td[data-mce-selected],th[data-mce-selected]').length){h.merge(e,i);}else{e.merge();}},mceTableInsertRowBefore:function(e){e.insertRow(true);},mceTableInsertRowAfter:function(e){e.insertRow();},mceTableInsertColBefore:function(e){e.insertCol(true);},mceTableInsertColAfter:function(e){e.insertCol();},mceTableDeleteCol:function(e){e.deleteCols();},mceTableDeleteRow:function(e){e.deleteRows();},mceTableCutRow:function(e){g=e.cutRows();},mceTableCopyRow:function(e){g=e.copyRows();},mceTablePasteRowBefore:function(e){e.pasteRows(g,true);},mceTablePasteRowAfter:function(e){e.pasteRows(g);},mceTableDelete:function(e){if(r){r.clearBars();}e.deleteTable();}},function(e,i){f.addCommand(i,function(){var x=new T(f);if(x){e(x);f.execCommand('mceRepaint');s.cellSelection.clear();}});});c({mceInsertTable:h.table,mceTableProps:function(){h.table(true);},mceTableRowProps:h.row,mceTableCellProps:h.cell},function(e,i){f.addCommand(i,function(x,y){e(y);});});function u(){f.addButton('tableprops',{title:'Table properties',onclick:h.tableProps,icon:'table'});f.addButton('tabledelete',{title:'Delete table',onclick:j('mceTableDelete')});f.addButton('tablecellprops',{title:'Cell properties',onclick:j('mceTableCellProps')});f.addButton('tablemergecells',{title:'Merge cells',onclick:j('mceTableMergeCells')});f.addButton('tablesplitcells',{title:'Split cell',onclick:j('mceTableSplitCells')});f.addButton('tableinsertrowbefore',{title:'Insert row before',onclick:j('mceTableInsertRowBefore')});f.addButton('tableinsertrowafter',{title:'Insert row after',onclick:j('mceTableInsertRowAfter')});f.addButton('tabledeleterow',{title:'Delete row',onclick:j('mceTableDeleteRow')});f.addButton('tablerowprops',{title:'Row properties',onclick:j('mceTableRowProps')});f.addButton('tablecutrow',{title:'Cut row',onclick:j('mceTableCutRow')});f.addButton('tablecopyrow',{title:'Copy row',onclick:j('mceTableCopyRow')});f.addButton('tablepasterowbefore',{title:'Paste row before',onclick:j('mceTablePasteRowBefore')});f.addButton('tablepasterowafter',{title:'Paste row after',onclick:j('mceTablePasteRowAfter')});f.addButton('tableinsertcolbefore',{title:'Insert column before',onclick:j('mceTableInsertColBefore')});f.addButton('tableinsertcolafter',{title:'Insert column after',onclick:j('mceTableInsertColAfter')});f.addButton('tabledeletecol',{title:'Delete column',onclick:j('mceTableDeleteCol')});}function v(e){var i=f.dom.is(e,'table')&&f.getBody().contains(e);return i;}function w(){var e=f.settings.table_toolbar;if(e===''||e===false){return;}if(!e){e='tableprops tabledelete | '+'tableinsertrowbefore tableinsertrowafter tabledeleterow | '+'tableinsertcolbefore tableinsertcolafter tabledeletecol';}f.addContextToolbar(v,e);}u();w();if(f.settings.table_tab_navigation!==false){f.on('keydown',function(e){var i,x,y;if(e.keyCode==9){i=f.dom.getParent(f.selection.getStart(),'th,td');if(i){e.preventDefault();x=new T(f);y=e.shiftKey?-1:1;f.undoManager.transact(function(){if(!x.moveRelIdx(i,y)&&y>0){x.insertRow();x.refresh();x.moveRelIdx(i,y);}});}}});}s.insertTable=k;}P.add('table',d);});
