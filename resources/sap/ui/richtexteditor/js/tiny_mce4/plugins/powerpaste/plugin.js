/* Ephox PowerPaste plugin
 *
 * Copyright 2010-2015 Ephox Corporation.  All rights reserved.
 *
 * Version: 2.1.3.1
 */
(function(){if(this.ephox)var d=this.ephox.bolt;var q={};var z=function(a){var m=C(a);var f=a.split('.');var t=Function('return this;')();for(var i=0;i<f.length-1;++i){if(t[f[i]]===undefined)t[f[i]]={};t=t[f[i]];}t[f[f.length-1]]=m;};var A=function(a){var b=q[a].dependencies;var c=q[a].definition;var e=[];for(var i=0;i<b.length;++i)e.push(C(b[i]));q[a].instance=c.apply(null,e);if(q[a].instance===undefined)throw'required module ['+a+'] could not be defined (definition function returned undefined)';};var B=function(i,a,b){if(typeof i!=='string')throw'invalid module definition, module id must be defined and be a string';if(a===undefined)throw'invalid module definition, dependencies must be specified';if(b===undefined)throw'invalid module definition, definition function must be specified';q[i]={dependencies:a,definition:b,instance:undefined};};var C=function(i){if(q[i]===undefined)throw'required module ['+i+'] is not defined';if(q[i].instance===undefined)A(i);return q[i].instance;};var D=function(a,c){var b=[];for(var i=0;i<a.length;++i)b.push(C(a[i]));c.apply(null,c);};var E=this.ephox||{};E.bolt={module:{api:{define:B,require:D,demand:C}}};var F=B;var G=D;var H=C;E.bolt.module.api.define("global!Array",[],function(){return Array;});E.bolt.module.api.define("global!String",[],function(){return String;});(function(a,b,c){a('ephox.compass.Arr',['global!Array','global!String'],function(e,S){var g=function(x){return function(y){return x===y;};};var h=(function(){var h=e.prototype.indexOf;var f=function(i,x){return h.call(i,x);};var s=function(i,x){return K(i,g(x));};return h===undefined?s:f;})();var j=function(f,x){return h(f,x)>-1;};var k=function(x,f){return K(x,f)>-1;};var l=function(f,x){var r=[];for(var i=0;i<f.length;i+=x){var s=f.slice(i,i+x);r.push(s);}return r;};var m=function(s,f){var y=s.length;var r=new e(y);for(var i=0;i<y;i++){var x=s[i];r[i]=f(x,i,s);}return r;};var n=function(r,f){for(var i=0,s=r.length;i<s;i++){var x=r[i];f(x,i,r);}};var p=function(f,r){var s=[];var y=[];for(var i=0,X=f.length;i<X;i++){var x=f[i];var Y=r(x,i,f)?s:y;Y.push(x);}return{pass:s,fail:y};};var o=function(f,s){var r=[];for(var i=0,y=f.length;i<y;i++){var x=f[i];if(s(x,i,f)){r.push(x);}}return r;};var t=function(s,f){if(s.length===0){return[];}else{var y=f(s[0]);var r=[];var X=[];for(var i=0,Y=s.length;i<Y;i++){var x=s[i];var Z=f(x);if(Z!==y){r.push(X);X=[];}y=Z;X.push(x);}if(X.length!==0){r.push(X);}return r;}};var u=function(x,f,i){return v(T(x),f,i);};var v=function(i,f,r){n(i,function(x){r=f(r,x);});return r;};var w=function(f,r){for(var i=0,s=f.length;i<s;i++){var x=f[i];if(r(x,i,f)){return x;}}return undefined;};var I=function(x,f,i){var r=w(x,f);return r!==undefined?r:i;};var J=function(x,f,i){var r=w(x,f);if(r===undefined){throw i||'Could not find element in array: '+S(x);}else{return r;}};var K=function(x,f){var r=f||O;for(var i=0,s=x.length;i<s;++i){if(r(x[i])===true){return i;}}return-1;};var L=e.prototype.push;var M=function(x){var r=[];for(var i=0,f=x.length;i<f;++i){L.apply(r,x[i]);}return r;};var N=function(x,f){var i=m(x,f);return M(i);};var O=g(true);var P=function(x,f){var r=f||O;for(var i=0,s=x.length;i<s;++i){if(r(x[i],i)!==true){return false;}}return true;};var Q=function(f,r){return f.length===r.length&&P(f,function(x,i){return x===r[i];});};var R=e.prototype.slice;var T=function(x){var r=R.call(x,0);r.reverse();return r;};var U=function(f,i){return o(f,function(x){return!j(i,x);});};var V=function(s,f){var r={};for(var i=0,y=s.length;i<y;i++){var x=s[i];r[S(x)]=f(x,i);}return r;};var W=function(x){return[x];};return{map:m,each:n,partition:p,filter:o,groupBy:t,indexOf:h,foldr:u,foldl:v,find:w,findIndex:K,findOr:I,findOrDie:J,flatten:M,bind:N,forall:P,exists:k,contains:j,equal:Q,reverse:T,chunk:l,difference:U,mapToObject:V,pure:W};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(c,r,e){c('ephox.peanut.Fun',['global!Array'],function(g){var n=function(){};var h=function(f,a){return function(){return f(a.apply(null,arguments));};};var i=function(v){return function(){return v;};};var j=function(x){return x;};var t=function(a,b){return a===b;};var k=function(f){var s=g.prototype.slice;var a=s.call(arguments,1);return function(){var b=a.concat(s.call(arguments,0));return f.apply(null,b);};};var l=function(f){return function(){return!f.apply(null,arguments);};};var m=function(a){return function(){throw a;};};var o=function(f){return f();};var p=function(f){f();};return{noop:n,compose:h,constant:i,identity:j,tripleEquals:t,curry:k,not:l,die:m,apply:o,call:p};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);E.bolt.module.api.define("global!Error",[],function(){return Error;});E.bolt.module.api.define("global!console",[],function(){if(typeof console==="undefined")console={log:function(){}};return console;});E.bolt.module.api.define("global!document",[],function(){return document;});(function(a,r,b){a('ephox.sugar.api.Element',['ephox.peanut.Fun','global!Error','global!console','global!document'],function(c,e,f,g){var h=function(l,s){var m=s||g;var n=m.createElement('div');n.innerHTML=l;if(!n.hasChildNodes()||n.childNodes.length>1){f.error('HTML does not have a single root node',l);throw'HTML must have a single root node';}return k(n.childNodes[0]);};var i=function(t,s){var l=s||g;var n=l.createElement(t);return k(n);};var j=function(t,s){var l=s||g;var n=l.createTextNode(t);return k(n);};var k=function(n){if(n===null||n===undefined)throw new e('Node cannot be null or undefined');return{dom:c.constant(n)};};return{fromHtml:h,fromTag:i,fromText:j,fromDom:k};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.classify.Type',['global!Array','global!String'],function(c,S){var e=function(x){if(x===null)return'null';var t=typeof x;if(t==='object'&&c.prototype.isPrototypeOf(x))return'array';if(t==='object'&&S.prototype.isPrototypeOf(x))return'string';return t;};var i=function(t){return function(v){return e(v)===t;};};return{isString:i('string'),isObject:i('object'),isArray:i('array'),isNull:i('null'),isBoolean:i('boolean'),isUndefined:i('undefined'),isFunction:i('function'),isNumber:i('number')};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);E.bolt.module.api.define("global!Object",[],function(){return Object;});(function(a,b,c){a('ephox.compass.Obj',['global!Object'],function(O){var e=(function(){var f=O.keys;var k=function(o){var r=[];for(var i in o){if(o.hasOwnProperty(i)){r.push(i);}}return r;};return f===undefined?k:f;})();var g=function(o,f){var r=e(o);for(var k=0,t=r.length;k<t;k++){var i=r[k];var x=o[i];f(x,i,o);}};var h=function(o,f){return j(o,function(x,i,o){return{k:i,v:f(x,i,o)};});};var j=function(o,f){var r={};g(o,function(x,i){var t=f(x,i,o);r[t.k]=t.v;});return r;};var l=function(o,k){var t={};var f={};g(o,function(x,i){var r=k(x,i)?t:f;r[i]=x;});return{t:t,f:f};};var m=function(o,f){var r=[];g(o,function(v,i){r.push(f(v,i));});return r;};var n=function(o,f){var r=e(o);for(var k=0,t=r.length;k<t;k++){var i=r[k];var x=o[i];if(f(x,i,o)){return x;}}return undefined;};var p=function(o){return m(o,function(v){return v;});};var s=function(o){return p(o).length;};return{bifilter:l,each:g,map:h,mapToArray:m,tupleMap:j,find:n,keys:e,values:p,size:s};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.bud.NodeTypes',[],function(){return{ATTRIBUTE:2,CDATA_SECTION:4,COMMENT:8,DOCUMENT:9,DOCUMENT_TYPE:10,DOCUMENT_FRAGMENT:11,ELEMENT:1,TEXT:3,PROCESSING_INSTRUCTION:7,ENTITY_REFERENCE:5,ENTITY:6,NOTATION:12};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,b,c){a('ephox.sugar.api.Node',['ephox.bud.NodeTypes'],function(N){var n=function(k){var r=k.dom().nodeName;return r.toLowerCase();};var e=function(k){return k.dom().nodeType;};var v=function(k){return k.dom().nodeValue;};var i=function(t){return function(k){return e(k)===t;};};var f=function(k){return e(k)===N.COMMENT||n(k)==='#comment';};var g=i(N.ELEMENT);var h=i(N.TEXT);var j=i(N.DOCUMENT);return{name:n,type:e,value:v,isElement:g,isText:h,isDocument:j,isComment:f};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.sugar.api.Attr',['ephox.classify.Type','ephox.compass.Arr','ephox.compass.Obj','ephox.sugar.api.Node','global!Error','global!console'],function(T,c,O,N,e,f){var g=function(k,p,v){if(T.isString(v)||T.isBoolean(v)||T.isNumber(v)){k.setAttribute(p,v+'');}else{f.error('Invalid call to Attr.set. Key ',p,':: Value ',v,':: Element ',k);throw new e('Attribute value was not simple');}};var s=function(k,p,v){g(k.dom(),p,v);};var h=function(p,u){var w=p.dom();O.each(u,function(v,k){g(w,k,v);});};var i=function(k,p){var v=k.dom().getAttribute(p);return v===null?undefined:v;};var j=function(k,p){var u=k.dom();return u&&u.hasAttribute?u.hasAttribute(p):false;};var l=function(k,p){k.dom().removeAttribute(p);};var m=function(k){var p=k.dom().attributes;return p===undefined||p===null||p.length===0;};var n=function(k){return c.foldl(k.dom().attributes,function(p,u){p[u.name]=u.value;return p;},{});};var t=function(k,p,u){if(j(k,u)&&!j(p,u))s(p,u,i(k,u));};var o=function(k,p,u){if(!N.isElement(k)||!N.isElement(p))return;c.each(u,function(v){t(k,p,v);});};return{clone:n,set:s,setAll:h,get:i,has:j,remove:l,hasNone:m,transfer:o};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.powerpaste.util.NodeUtil',['ephox.compass.Arr','ephox.sugar.api.Element','ephox.sugar.api.Attr','global!document'],function(c,e,f,g){var n=function(i){var t=g.createElement("div");t.appendChild(i.cloneNode(true));var s=t.innerHTML;t=i=null;return s;};var h=function(i){c.each(c.map(i.getElementsByTagName('*'),e.fromDom),function(j){if(f.has(j,'data-mce-style')&&!f.has(j,'style')){f.set(j,'style',f.get(j,'data-mce-style'));}})};return{nodeToString:n,restoreStyleAttrs:h};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);E.bolt.module.api.define("global!tinymce",[],function(){return tinymce;});(function(a,r,b){a('ephox.powerpaste.i18n.I18n',['global!tinymce'],function(t){var m=function(){return"Your browser security settings may be preventing images from being imported.";};var f=function(){return t.Env.mac&&t.Env.webkit?m()+" <a href=\"https://support.ephox.com/entries/59328357-Safari-6-1-and-7-Flash-Sandboxing\" style=\"text-decoration: underline\">More information on paste for Safari</a>":m();};var e={"cement.dialog.paste.title":"Paste Formatting Options","cement.dialog.paste.instructions":"Choose to keep or remove formatting in the pasted content.","cement.dialog.paste.merge":"Keep Formatting","cement.dialog.paste.clean":"Remove Formatting","cement.dialog.flash.title":"Local Image Import","cement.dialog.flash.trigger-paste":"Trigger paste again from the keyboard to paste content with images.","cement.dialog.flash.missing":"Adobe Flash is required to import images from Microsoft Office. Install the <a href=\"http://get.adobe.com/flashplayer/\" target=\"_blank\">Adobe Flash Player</a>.","cement.dialog.flash.press-escape":"Press <span class=\"ephox-polish-help-kbd\">ESC</span> to ignore local images and continue editing.","loading.wait":"Please wait...","flash.clipboard.no.rtf":f(),"safari.imagepaste":"Safari does not support direct paste of images. <a href=\"https://support.ephox.com/entries/88543243-Safari-Direct-paste-of-images-does-not-work\" style=\"text-decoration: underline\">More information on image pasting for Safari</a>","error.code.images.not.found":"The images service was not found: (","error.imageupload":"Image failed to upload: (","error.full.stop":").","errors.local.images.disallowed":"Local image paste has been disabled. Local images have been removed from pasted content.","flash.crashed":"Images have not been imported as Adobe Flash appears to have crashed. This may be caused by pasting large documents.","errors.imageimport.failed":"Some images failed to import.","errors.imageimport.unsupported":"Unsupported image type.","errors.imageimport.invalid":"Image is invalid."};var g=function(k){return e[k];};var c=function(k){return t.translate(g(k));};return{translate:c};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.powerpaste.alien.Once',[],function(){return function(f){var c=false;return function(){if(!c){c=true;f.apply(null,arguments);}};};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(c,r,e){c('ephox.perhaps.Option',['ephox.peanut.Fun'],function(g){var h=function(v){return k(function(n,s){return s(v);});};var i=function(){return k(function(n,s){return n();});};var j=function(v){return v===null||v===undefined?i():h(v);};var k=function(b){var n=function(v){return b(g.constant(false),function(o){return o===v;});};var p=function(){return b(g.constant(false),g.constant(true));};var s=g.not(p);var t=function(v){return b(g.constant(v),g.identity);};var u=function(f){return b(f,g.identity);};var w=function(a){return b(g.die(a||'error: getOrDie called on none.'),g.identity);};var y=function(o){return b(g.constant(o),h);};var I=function(f){return b(f,h);};var J=function(f){return M(function(v){return h(f(v));});};var K=function(o){return b(i,function(a){return o.fold(i,function(f){return h(f(a));});});};var L=J;var M=function(f){return b(i,f);};var N=function(){return b(i,g.identity);};var O=function(f){return b(g.constant(false),f);};var P=function(f){return b(g.constant(true),f);};var Q=function(f){return b(i,function(v){return f(v)?h(v):i();});};var l=function(o){return b(o.isNone,o.is);};var m=function(o,a){return b(o.isNone,function(x){return o.fold(g.constant(false),g.curry(a,x));});};var R=function(){return b(g.constant([]),function(v){return[v];});};var S=function(){return b(g.constant("none()"),function(a){return"some("+a+")";});};return{is:n,isSome:p,isNone:s,getOr:t,getOrThunk:u,getOrDie:w,or:y,orThunk:I,fold:b,map:J,each:L,bind:M,ap:K,flatten:N,exists:O,forall:P,equals:l,equals_:m,filter:Q,toArray:R,toString:S};};var l=function(a,b){return a.equals(b);};var m=function(a,b,f){return a.equals_(b,f);};return{some:h,none:i,from:j,equals:l,equals_:m};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(b,r,c){b('ephox.powerpaste.imageupload.TinyUploader',['ephox.compass.Arr','ephox.peanut.Fun'],function(e,f){return function(g){var u=function(){g.uploadImages();};var p=function(i){e.each(i,function(a){a.fold(function(j,k,o,l){e.each(g.dom.select('img[src="'+o+'"]'),function(m){g.dom.setAttrib(m,'src',l.result);});},f.noop);});};var h=function(i,a,o,j){return j.result;};return{uploadImages:u,prepareImages:p,getLocalURL:h};};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.powerpaste.tinymce.ErrorDialog',[],function(){return{showDialog:function(e,c){var f=function(){win.close();};var g=[{text:'Ok',onclick:f}];var w={title:"Error",spacing:10,padding:10,items:[{type:'container',html:c}],buttons:g};win=e.windowManager.open(w);}};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.powerpaste.imageupload.UploadError',['ephox.powerpaste.alien.Once','ephox.powerpaste.i18n.I18n','ephox.powerpaste.tinymce.ErrorDialog'],function(O,I,c){return function(e,u){var s=function(){return I.translate('error.code.images.not.found')+u+I.translate('error.full.stop');};var g=function(){return I.translate('error.imageupload')+u+I.translate('error.full.stop');};var f=function(h){var j=h.status();var n=j===0||(j>=400||j<500);var k=n?s:g;c.showDialog(e,k());};var i=function(){return O(f);};return{instance:i};};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.flour.style.Resolver',['ephox.compass.Arr'],function(c){var e=function(p){var n=f(p);var h=function(i){var j=i.split(' ');var k=c.map(j,function(l){return g(n,l);});return k.join(' ');};return{resolve:h};};var f=function(n){return n.replace(/\./g,'-');};var g=function(n,h){return n+'-'+h;};return{create:e,cssNamespace:f,cssClass:g};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.salmon.style.Styles',['ephox.flour.style.Resolver'],function(R){var s=R.create('ephox-salmon');return{resolve:s.resolve};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(c,r,e){c('ephox.scullion.Immutable2',['ephox.compass.Arr','ephox.compass.Obj','ephox.peanut.Fun'],function(g,O,h){var $=function(a){return Array.prototype.slice.call(a);};var p=function(j,k){var n=function(){var v=$(arguments);if(j.length!==v.length)throw'Wrong number of arguments to struct. Expected "['+j.length+']", got '+v.length+' arguments';var s={};g.each(j,function(a,i){s[a]=h.constant(v[i]);});return s;};var l=function(a,b){for(var i=0;i<j.length;i++){var f=(k&&k[i])||h.tripleEquals;var x=j[i];if(!f(a[x](),b[x]())){return false;}}return true;};var m=function(o){return O.map(o,function(f){return f();});};return{nu:n,eq:l,evaluate:m};};return{product:p};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.scullion.Immutable',['ephox.scullion.Immutable2'],function(I){return function(){return I.product(arguments).nu;};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(b,r,c){b('ephox.scullion.BagUtils',['ephox.classify.Type','ephox.compass.Arr'],function(T,e){var f=function(a){return a.slice(0).sort();};var g=function(a,k){throw'All required keys ('+f(a).join(', ')+') were not specified. Specified keys were: '+f(k).join(', ')+'.';};var u=function(a){throw'Unsupported keys for object: '+f(a).join(', ');};var v=function(l,i){if(!T.isArray(i))throw'The '+l+' fields must be an array. Was: '+i+'.';e.each(i,function(a){if(!T.isString(a))throw'The value '+a+' in the '+l+' fields was not a string.';});};var h=function(i,t){throw'All values need to be of type: '+t+'. Keys ('+f(i).join(', ')+') were not.';};var j=function(a){var k=f(a);var l=e.find(k,function(s,i){return i<k.length-1&&s===k[i+1];});if(l!==undefined&&l!==null)throw'The field: '+l+' occurs more than once in the combined fields: ['+k.join(', ')+'].';};return{sort:f,reqMessage:g,unsuppMessage:u,validateStrArr:v,invalidTypeMessage:h,checkDupes:j};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,b,c){a('ephox.scullion.MixedBag',['ephox.compass.Arr','ephox.compass.Obj','ephox.peanut.Fun','ephox.perhaps.Option','ephox.scullion.BagUtils','global!Object'],function(e,O,f,g,h,i){return function(j,o){var k=j.concat(o);if(k.length===0)throw'You must specify at least one required or optional field.';h.validateStrArr('required',j);h.validateStrArr('optional',o);h.checkDupes(k);return function(l){var m=O.keys(l);var n=e.forall(j,function(D){return e.contains(m,D);});if(!n)h.reqMessage(j,m);var u=e.filter(m,function(p){return!e.contains(k,p);});if(u.length>0)h.unsuppMessage(u);var r={};e.each(j,function(D){r[D]=f.constant(l[D]);});e.each(o,function(p){r[p]=f.constant(i.prototype.hasOwnProperty.call(l,p)?g.some(l[p]):g.none());});return r;};};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.scullion.Struct',['ephox.scullion.Immutable','ephox.scullion.Immutable2','ephox.scullion.MixedBag'],function(I,c,M){return{immutable:I,immutable2:c,immutableBag:M};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,b,c){a('ephox.sugar.alien.Recurse',[],function(){var t=function(g,f){var r=[];var h=function(e){r.push(e);return f(e);};var i=f(g);do{i=i.bind(h);}while(i.isSome());return r;};return{toArray:t};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.sugar.api.Selectors',['ephox.bud.NodeTypes','ephox.compass.Arr','ephox.perhaps.Option','ephox.sugar.api.Element','global!Error','global!document'],function(N,c,O,e,f,g){var S=0;var M=1;var W=2;var h=3;var s=(function(){var t=g.createElement('span');return t.matches!==undefined?S:t.msMatchesSelector!==undefined?M:t.webkitMatchesSelector!==undefined?W:t.mozMatchesSelector!==undefined?h:-1;})();var i=N.ELEMENT;var j=N.DOCUMENT;var k=function(n,p){var t=n.dom();if(t.nodeType!==i)return false;else if(s===S)return t.matches(p);else if(s===M)return t.msMatchesSelector(p);else if(s===W)return t.webkitMatchesSelector(p);else if(s===h)return t.mozMatchesSelector(p);else throw new f('Browser lacks native selectors');};var l=function(n){return n.nodeType!==i&&n.nodeType!==j||n.childElementCount===0;};var m=function(n,p){var t=p===undefined?g:p.dom();return l(t)?[]:c.map(t.querySelectorAll(n),e.fromDom);};var o=function(n,p){var t=p===undefined?g:p.dom();return l(t)?O.none():O.from(t.querySelector(n)).map(e.fromDom);};return{all:m,is:k,one:o};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.sugar.api.Compare',['ephox.compass.Arr','ephox.peanut.Fun','ephox.sugar.api.Selectors'],function(c,e,S){var f=function(g,h){return g.dom()===h.dom();};var m=function(g,h){return c.exists(h,e.curry(f,g));};return{eq:f,member:m,is:S.is};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.sugar.api.Traverse',['ephox.classify.Type','ephox.compass.Arr','ephox.peanut.Fun','ephox.perhaps.Option','ephox.scullion.Struct','ephox.sugar.alien.Recurse','ephox.sugar.api.Compare','ephox.sugar.api.Element'],function(T,c,e,O,S,R,f,g){var o=function(p){return g.fromDom(p.dom().ownerDocument);};var h=function(p){var v=o(p);return g.fromDom(v.dom().documentElement);};var i=function(p){var v=p.dom();var i=v.ownerDocument.defaultView;return g.fromDom(i);};var j=function(p){var v=p.dom();return O.from(v.parentNode).map(g.fromDom);};var k=function(v){return j(v).bind(function(p){var x=I(p);var P=c.findIndex(x,function(Q){return f.eq(v,Q);});return P>-1?O.some(P):O.none();});};var l=function(p,v){var x=T.isFunction(v)?v:e.constant(false);return m(p,x);};var m=function(p,x){return j(p).fold(function(){return[];},function(v){var P=[v];return x(v)?P:P.concat(m(v,x));});};var s=function(p){var v=function(P){return c.filter(P,function(x){return!f.eq(p,x);});};return j(p).map(I).map(v).getOr([]);};var n=function(p){var v=p.dom();return O.from(v.offsetParent).map(g.fromDom);};var t=function(p){var v=p.dom();return O.from(v.previousSibling).map(g.fromDom);};var u=function(p){var v=p.dom();return O.from(v.nextSibling).map(g.fromDom);};var w=function(p){return c.reverse(R.toArray(p,t));};var y=function(p){return R.toArray(p,u);};var I=function(p){var v=p.dom();return c.map(v.childNodes,g.fromDom);};var J=function(p,v){var I=p.dom().childNodes;return O.from(I[v]).map(g.fromDom);};var K=function(p){return J(p,0);};var L=function(p){return J(p,p.dom().childNodes.length-1);};var M=S.immutable('element','offset');var N=function(p,v){var x=I(p);return x.length>0&&v<x.length?M(x[v],0):M(p,v);};return{owner:o,defaultView:i,documentElement:h,parent:j,findIndex:k,parents:l,siblings:s,prevSibling:t,offsetParent:n,prevSiblings:w,nextSibling:u,nextSiblings:y,children:I,child:J,firstChild:K,lastChild:L,leaf:N};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.sugar.api.Insert',['ephox.sugar.api.Traverse'],function(T){var c=function(m,h){var i=T.parent(m);i.each(function(v){v.dom().insertBefore(h.dom(),m.dom());});};var e=function(m,h){var s=T.nextSibling(m);s.fold(function(){var i=T.parent(m);i.each(function(v){f(v,h);});},function(v){c(v,h);});};var p=function(h,i){var j=T.firstChild(h);j.fold(function(){f(h,i);},function(v){h.dom().insertBefore(i.dom(),v.dom());});};var f=function(h,i){h.dom().appendChild(i.dom());};var g=function(h,i,j){T.child(h,j).fold(function(){f(h,i);},function(v){c(v,i);});};var w=function(h,i){c(h,i);f(i,h);};return{before:c,after:e,prepend:p,append:f,appendAt:g,wrap:w};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.sugar.api.InsertAll',['ephox.compass.Arr','ephox.sugar.api.Insert'],function(c,I){var f=function(m,e){c.each(e,function(x){I.before(m,x);});};var g=function(m,j){c.each(j,function(x,i){var e=i===0?m:j[i-1];I.after(e,x);});};var p=function(e,i){c.each(i.slice().reverse(),function(x){I.prepend(e,x);});};var h=function(e,i){c.each(i,function(x){I.append(e,x);});};return{before:f,after:g,prepend:p,append:h};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.sugar.api.Remove',['ephox.sugar.api.InsertAll','ephox.sugar.api.Traverse'],function(I,T){var e=function(f){f.dom().textContent='';};var c=function(f){var g=f.dom();if(g.parentNode!==null)g.parentNode.removeChild(g);};var u=function(w){var f=T.children(w);if(f.length>0)I.before(w,f);c(w);};return{empty:e,remove:c,unwrap:u};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,b,c){a('ephox.peanut.Thunk',[],function(){var e=function(f){var g=false;var r;return function(){if(!g){g=true;r=f.apply(null,arguments);}return r;};};return{cached:e};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.sugar.api.Body',['ephox.peanut.Thunk','ephox.sugar.api.Element','ephox.sugar.api.Node','global!document'],function(T,c,N,e){var i=function(g){var h=N.isText(g)?g.dom().parentNode:g.dom();return h!==undefined&&h!==null&&h.ownerDocument.body.contains(h);};var f=T.cached(function(){var f=e.body;if(f===null||f===undefined)throw'Body is not available yet';return c.fromDom(f);});return{body:f,inBody:i};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.sugar.api.PredicateFilter',['ephox.compass.Arr','ephox.sugar.api.Body','ephox.sugar.api.Traverse'],function(c,e,T){var f=function(p){return i(e.body(),p);};var g=function(j,p,k){return c.filter(T.parents(j,k),p);};var s=function(j,p){return c.filter(T.siblings(j),p);};var h=function(j,p){return c.filter(T.children(j),p);};var i=function(j,p){var k=[];c.each(T.children(j),function(x){if(p(x)){k=k.concat([x]);}k=k.concat(i(x,p));});return k;};return{all:f,ancestors:g,siblings:s,children:h,descendants:i};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.sugar.api.SelectorFilter',['ephox.sugar.api.PredicateFilter','ephox.sugar.api.Selectors'],function(P,S){var c=function(e){return S.all(e);};var f=function(i,j,k){return P.ancestors(i,function(e){return S.is(e,j);},k);};var s=function(i,j){return P.siblings(i,function(e){return S.is(e,j);});};var g=function(i,j){return P.children(i,function(e){return S.is(e,j);});};var h=function(e,i){return S.all(i,e);};return{all:c,ancestors:f,siblings:s,children:g,descendants:h};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(b,r,c){b('ephox.sugar.impl.ClosestOrAncestor',['ephox.classify.Type','ephox.perhaps.Option'],function(T,O){return function(i,e,s,a,f){return i(s,a)?O.some(s):T.isFunction(f)&&f(s)?O.none():e(s,a,f);};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.sugar.api.SelectorFind',['ephox.perhaps.Option','ephox.sugar.api.SelectorFilter','ephox.sugar.api.Selectors','ephox.sugar.impl.ClosestOrAncestor'],function(O,S,c,e){var f=function(k){return O.from(S.all(k)[0]);};var g=function(k,l,m){return O.from(S.ancestors(k,l,m)[0]);};var s=function(k,l){return O.from(S.siblings(k,l)[0]);};var h=function(k,l){return O.from(S.children(k,l)[0]);};var i=function(k,l){return O.from(S.descendants(k,l)[0]);};var j=function(k,l,m){return e(c.is,g,k,l,m);};return{first:f,ancestor:g,sibling:s,child:h,descendant:i,closest:j};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.salmon.api.Ephemera',['ephox.peanut.Fun','ephox.salmon.style.Styles','ephox.sugar.api.Attr','ephox.sugar.api.Remove','ephox.sugar.api.SelectorFind'],function(c,S,e,R,f){var u=S.resolve('upload-image-container');var g='data-'+S.resolve('image-blob');var h=function(j){f.child(j,'img').each(i);R.unwrap(j);};var i=function(j){e.remove(j,'class');};return{uploadContainer:c.constant(u),blobId:c.constant(g),cleanup:h};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.sugar.api.Elements',['ephox.compass.Arr','ephox.sugar.api.Element','ephox.sugar.api.Traverse','global!document'],function(c,e,T,f){var g=function(k,s){var l=s||f;var m=l.createElement('div');m.innerHTML=k;return T.children(e.fromDom(m));};var h=function(t,s){return c.map(t,function(x){return e.fromTag(x,s);});};var i=function(t,s){return c.map(t,function(x){return e.fromText(x,s);});};var j=function(n){return c.map(n,e.fromDom);};return{fromHtml:g,fromTags:h,fromText:i,fromDom:j};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,c){a('ephox.powerpaste.tinymce.UndoRewriter',['ephox.compass.Arr','ephox.salmon.api.Ephemera','ephox.sugar.api.Element','ephox.sugar.api.Elements','ephox.sugar.api.InsertAll','ephox.sugar.api.SelectorFilter'],function(e,U,f,g,I,S){var u=function(b){for(var i=0;i<b.undoManager.data.length;i++){var j=b.undoManager.data[i].content;var t=f.fromTag('div');I.append(t,g.fromHtml(j));var k=S.descendants(t,'.'+U.uploadContainer());e.each(k,U.cleanup);b.undoManager.data[i].content=t.dom().innerHTML;}};var h=function(j,b,k){for(var i=0;i<j.undoManager.data.length;i++){j.undoManager.data[i].content=j.undoManager.data[i].content.split(b.objurl()).join(k.location);}};return{unwrapHistory:u,resrcHistory:h};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.epithet.Global',[],function(){return Function('return this;')();});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.epithet.Resolve',['ephox.epithet.Global'],function(c){var e=function(p,s){var o=s||c;for(var i=0;i<p.length&&o!==undefined&&o!==null;++i)o=o[p[i]];return o;};var f=function(p,s){var g=p.split('.');return e(g,s);};return{path:e,resolve:f};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.numerosity.core.Global',['ephox.epithet.Resolve'],function(R){var u=function(n,s){return R.resolve(n,s);};var g=function(n,s){var c=u(n,s);if(c===undefined)throw n+' not available on this browser';return c;};return{getOrDie:g};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.numerosity.api.URL',['ephox.numerosity.core.Global'],function(c){var e=function(){return c.getOrDie('URL');};var f=function(h){return e().createObjectURL(h);};var g=function(u){e().revokeObjectURL(u);};return{createObjectURL:f,revokeObjectURL:g};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.salmon.api.BlobCache',['ephox.compass.Obj','ephox.numerosity.api.URL','ephox.perhaps.Option','ephox.scullion.Struct'],function(O,U,e,S){var f=S.immutable('id','blob','objurl','data');return function(){var g={};var h=function(c,n,o,p){var s=f(c,n,o,p);g[c]=s;return s;};var i=function(c){return e.from(g[c]);};var j=function(c){U.revokeObjectURL(c.objurl());};var l=function(n){return e.from(O.find(g,function(c){return c.data().result===n;}));};var k=function(c){var o=g[c];delete g[c];if(o!==undefined)j(o);};var m=function(){O.each(g,j);g={};};return{add:h,get:i,remove:k,lookupByData:l,destroy:m};};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.porkbun.Event',['ephox.compass.Arr','ephox.scullion.Struct'],function(c,S){return function(f){var s=S.immutable.apply(null,f);var h=[];var e=function(g){if(g===undefined){throw'Event bind error: undefined handler';}h.push(g);};var u=function(g){var i=c.indexOf(h,g);if(i!==-1){h.splice(i,1);}};var t=function(){var g=s.apply(null,arguments);c.each(h,function(i){i(g);});};return{bind:e,unbind:u,trigger:t};};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.porkbun.Events',['ephox.compass.Obj'],function(O){var c=function(t){var e=O.map(t,function(g){return{bind:g.bind,unbind:g.unbind};});var f=O.map(t,function(g){return g.trigger;});return{registry:e,trigger:f};};return{create:c};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.salmon.api.ImageTracker',['ephox.compass.Arr','ephox.salmon.style.Styles','ephox.salmon.api.Ephemera','ephox.porkbun.Event','ephox.porkbun.Events','ephox.sugar.api.Attr','ephox.sugar.api.SelectorFilter'],function(c,S,e,f,g,h,i){var u='data-'+S.resolve('image-upload');var j=function(l,m){return i.descendants(l,'img['+u+'="'+m+'"]');};var k=function(l){return i.descendants(l,'img:not(['+u+'])['+e.blobId()+']');};return function(){var l=[];var m=[];var n=g.create({complete:f(['response'])});var z=function(x,y){h.set(x,u,y);l.push(y);};var o=function(x){l=c.filter(l,function(y,I){return y!==x;});if(v()===false)t();};var p=function(x,y){m.push({'success':x,'element':y.dom()});};var s=function(x,y,I){c.each(y,function(J){h.remove(J,u);p(I,J);});o(x);};var t=function(){n.trigger.complete(m);m=[];};var v=function(){return l.length>0;};var w=function(x){return c.contains(l,x);};return{findById:j,findAll:k,register:z,report:s,inProgress:v,isActive:w,events:n.registry};};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.highway.Merger',['ephox.classify.Type'],function(T){var s=function(d,n){return n;};var c=function(d,n){var g=T.isObject(d)&&T.isObject(n);return g?f(d,n):n;};var e=function(g){return function(){var o=Array.prototype.slice.call(arguments,0);if(o.length===0)throw"Can't merge zero objects";var h={};for(var i=0;i<o.length;i++){var j=o[i];for(var k in j)if(Object.prototype.hasOwnProperty.call(j,k)){h[k]=g(h[k],j[k]);}}return h;};};var f=e(c);var m=e(s);return{deepMerge:f,merge:m};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.scullion.ADT',['ephox.classify.Type','ephox.compass.Arr','ephox.compass.Obj','ephox.peanut.Fun','global!Array'],function(T,c,O,e,f){var g=function(h){if(!T.isArray(h)){throw'cases must be an array';}if(h.length===0){throw'there must be at least one case';}var i={};c.each(h,function(j,k){var l=O.keys(j);if(l.length!==1){throw'one and only one name per case';}var m=l[0];var v=j[m];if(i[m]!==undefined){throw'duplicate key detected:'+m;}else if(m==='cata'){throw'cannot have a case named cata (sorry)';}else if(!T.isArray(v)){throw'case arguments must be an array';}i[m]=function(){var n=f.prototype.slice.call(arguments);if(n.length!==v.length){throw'Wrong number of arguments to case '+m+'. Expected '+v.length+' ('+v+'), got '+n.length;}return{fold:function(){if(arguments.length!==h.length){throw'Wrong number of arguments to fold. Expected '+h.length+', got '+arguments.length;}var t=arguments[k];return t.apply(null,n);}};};});return i;};return{generate:g};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.hermes.api.ImageAsset',['ephox.highway.Merger','ephox.scullion.ADT'],function(M,c){var e=c.generate([{'blob':['id','blob','objurl','data']},{'url':['id','url','raw']}]);var f=function(s,o,g){return s.fold(o,g);};return M.merge(e,{cata:f});});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(b,c,g){b('ephox.perhaps.Result',['ephox.peanut.Fun','ephox.perhaps.Option'],function(h,O){var i=function(r){return k(function(e,v){return v(r);});};var j=function(m){return k(function(e,v){return e(m);});};var k=function(e){var l=function(v){return e(h.constant(false),function(o){return o===v;});};var n=function(){return e(h.constant(false),h.constant(true));};var p=h.not(n);var r=function(a){return e(h.constant(a),h.identity);};var s=function(f){return e(f,h.identity);};var t=function(){return e(function(m){h.die(m)();},h.identity);};var u=function(o){return e(h.constant(o),i);};var w=function(f){return e(f,i);};var x=function(f){return I(function(a){return i(f(a));});};var y=x;var I=function(f){return e(j,f);};var J=function(f){return e(h.constant(false),f);};var K=function(f){return e(h.constant(true),f);};var L=function(){return e(O.none,O.some);};return{is:l,isValue:n,isError:p,getOr:r,getOrThunk:s,getOrDie:t,or:u,orThunk:w,fold:e,map:x,each:y,bind:I,exists:J,forall:K,toOption:L};};return{value:i,error:j};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.sugar.alien.Toggler',[],function(){return function(t,c,i){var e=i||false;var o=function(){c();e=true;};var g=function(){t();e=false;};var h=function(){var f=e?g:o;f();};var j=function(){return e;};return{on:o,off:g,toggle:h,isOn:j};};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.sugar.api.Class',['ephox.sugar.alien.Toggler','ephox.sugar.api.Attr'],function(T,c){var e=function(i,j){i.dom().classList.add(j);};var f=function(i,j){var k=i.dom().classList;k.remove(j);if(k.length===0){c.remove(i,'class');}};var t=function(i,j){return i.dom().classList.toggle(j);};var g=function(i,j){var k=i.dom().classList;var o=function(){k.remove(j);};var l=function(){k.add(j);};return T(o,l,h(i,j));};var h=function(i,j){var k=i.dom().classList;return k!==undefined&&k.contains(j);};return{add:e,remove:f,toggle:t,toggler:g,has:h};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.salmon.ui.UploadUi',['ephox.salmon.api.Ephemera','ephox.sugar.api.Class','ephox.sugar.api.Element','ephox.sugar.api.Insert','ephox.sugar.api.InsertAll','ephox.sugar.api.Remove','ephox.sugar.api.SelectorFind','ephox.sugar.api.Traverse'],function(c,e,f,I,g,R,S,T){var h=function(j){S.ancestor(j,'.'+c.uploadContainer()).each(function(w){var k=T.children(w);g.before(w,k);R.remove(w);});};var i=function(j){var k=f.fromTag('div');e.add(k,c.uploadContainer());I.before(j,k);I.append(k,j);};return{removeUi:h,addUi:i};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.salmon.api.UploadUtils',['ephox.compass.Arr','ephox.hermes.api.ImageAsset','ephox.peanut.Fun','ephox.perhaps.Option','ephox.perhaps.Result','ephox.salmon.api.Ephemera','ephox.salmon.ui.UploadUi','ephox.scullion.ADT','ephox.scullion.Struct','ephox.sugar.api.Attr','ephox.sugar.api.SelectorFind','global!console'],function(c,I,e,O,R,U,f,g,S,h,i,j){var k=S.immutable('image','blobInfo');var u=g.generate([{'failure':['error']},{'success':['result','images','blob']}]);var p=function(w,x,y){var J=w.isActive(x);w.register(y,x);f.addUi(y);return!J?O.some(x):O.none();};var l=function(w,x,y,J){c.each(x,function(K){h.set(K,'src',J.location);h.remove(K,U.blobId());});return s(w,y,x);};var m=function(w,x,y,J,K,L,M){var N=function(){j.error('Internal error with blob cache',K);M(u.failure({status:e.constant(666)}));};w.upload(L,K,function(P){var Q=x.findById(J,K);c.each(Q,f.removeUi);P.fold(function(T){M(u.failure(T));},function(T){l(y,Q,K,T).fold(N,function(V){M(u.success(T,Q,V));});});x.report(K,Q,P.isValue());});};var n=function(w,x,y,J,K,L){var M=w.lookupByData(K.result).getOrThunk(function(){return w.add(x,y,J,K);});h.set(L,U.blobId(),M.id());return R.value(k(L,M));};var o=function(w,x){var y=h.get(x,U.blobId());return w.get(y).fold(function(){return R.error(y);},function(J){return R.value(k(x,J));});};var s=function(w,x,y){return w.get(x).fold(function(){return R.error('Internal error with blob cache');},function(J){w.remove(x);return R.value(J);});};var t=function(w,x,y){return c.bind(y,function(J){return I.cata(J,function(K,L,M,N){var P=i.descendant(x,'img[src="'+M+'"]');return P.fold(function(){return[R.error('Image that was just inserted could not be found: '+M)];},function(Q){return[n(w,K,L,M,N,Q)];});},e.constant([]));});};var v=function(w,x,y){var J=w.findAll(y);if(w.inProgress())return[];return c.map(J,function(K){return o(x,K);});};return{prepareForUpload:p,handleUpload:m,registerAssets:t,findBlobs:v};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.numerosity.api.FormData',['ephox.numerosity.core.Global'],function(c){return function(){var f=c.getOrDie('FormData');return new f();};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);E.bolt.module.api.define("global!Math",[],function(){return Math;});E.bolt.module.api.define("global!isFinite",[],function(){return isFinite;});E.bolt.module.api.define("global!isNaN",[],function(){return isNaN;});E.bolt.module.api.define("global!parseFloat",[],function(){return parseFloat;});(function(a,r,b){a('ephox.violin.util.Validate',['global!Math','global!isFinite','global!isNaN','global!parseFloat'],function(M,i,c,p){var T=function(f){return function(g,h){var t=typeof h;if(t!==f)throw g+' was not a '+f+'. Was: '+h+' ('+t+')';};};var s=T('string');var v=function(f,g){s(f,g);var l=g.length;if(l!==1)throw f+' was not a single char. Was: '+g;};var n=T('number');var I=function(f,g){n(f,g);if(g!==M.abs(g))throw f+' was not an integer. Was: '+g;};var e=function(f){return!c(p(f))&&i(f);};var N=function(f,g){I(f,g);if(g<0)throw f+' was not a natural number. Was: '+g;};return{vString:s,vChar:v,vInt:I,vNat:N,pNum:e};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(e,f,g){e("ephox.violin.Strings",['ephox.violin.util.Validate'],function(V){var h=function(s,a,b){if(a==="")return true;if(s.length<a.length)return false;var x=s.substr(b,b+a.length);return x===a;};var j=function(s,c){var i=function(a){var t=typeof a;return t==="string"||t==="number";};return s.replace(/\${([^{}]*)}/g,function(a,b){var l=c[b];return i(l)?l:a;});};var k=function(b){var c=function(a,b){var r=[];for(var i=0;i<a.length;i++)r.push(b(a[i]));return r;};return function(){var a=c(arguments,function(x){return typeof x==="string"?x.toLowerCase():x;});return b.apply(this,a);};};var m=function(s,a){return h(s,a,0);};var n=k(m);var o=function(s,a){return h(s,a,s.length-a.length);};var p=k(o);var u=function(s,c){return s.substr(0,c);};var v=function(s,c){return s.substr(s.length-c,s.length);};var w=function(c,a){return function(s,b){return c(s,b)?a(s,s.length-b.length):s;};};var y=w(m,v);var I=w(o,u);var J=function(a,b){return a+b;};var K=function(a,b){return b+a;};var L=function(c,a){return function(s,b){return c(s,b)?s:a(s,b);};};var M=L(m,K);var N=L(o,J);var O=function(s){return s.replace(/^\s+|\s+$/g,'');};var P=function(s){return s.replace(/^\s+/g,'');};var Q=function(s){return s.replace(/\s+$/g,'');};var R=function(s,a){return s.indexOf(a)!=-1;};var S=k(R);var T=function(s){return s.replace(/\"/gm,"&quot;");};var U=function(a,b){return a===b;};var W=k(U);var X=function(s){if(s==="")throw"head on empty string";return s.substr(0,1);};var Y=function(s){if(s==="")throw"toe on empty string";return s.substr(s.length-1,s.length);};var Z=function(s){if(s==="")throw"tail on empty string";return s.substr(1,s.length-1);};var $=function(s){if(s==="")throw"torso on empty string";return s.substr(0,s.length-1);};var _=function(s){if(s==="")return s;return X(s).toUpperCase()+Z(s);};var a1=function(s,a){V.vString('str',s);V.vNat('num',a);var r='';for(var i=0;i<a;i++){r+=s;}return r;};var b1=function(a){return function(s,c,b){V.vString('str',s);V.vChar('c',c);V.vNat('width',b);var l=s.length;return l>=b?s:a(s,a1(c,b-l));};};var c1=b1(function(s,a){return a+s;});var d1=b1(function(s,a){return s+a;});return{supplant:j,startsWith:m,startsWithIgnoringCase:n,endsWith:o,endsWithIgnoringCase:p,first:u,last:v,removeLeading:y,removeTrailing:I,ensureLeading:M,ensureTrailing:N,trim:O,lTrim:P,rTrim:Q,contains:R,containsIgnoringCase:S,htmlEncodeDoubleQuotes:T,equals:U,equalsIgnoringCase:W,head:X,repead:a1,padLeft:c1,padRight:d1,toe:Y,tail:Z,torso:$,capitalize:_};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.salmon.services.UploadCommon',['ephox.classify.Type','ephox.compass.Arr','ephox.numerosity.api.FormData','ephox.scullion.Struct','ephox.violin.Strings'],function(T,c,e,S,f){var g=S.immutable('message','status','contents');var k=['jpg','png','gif','jpeg'];var h=function(l,m){if(T.isString(l.type)&&f.startsWith(l.type,'image/')){var n=l.type.substr('image/'.length);return c.contains(k,n)?m+'.'+n:m;}else{return m;}};var i=function(l,m){var u=T.isString(l.name)&&!f.endsWith(l.name,'.tmp');return u?l.name:h(l,m);};var j=function(l,m,n){var o=e();o.append(l,m,n);return{data:o,contentType:false,processData:false};};return{failureObject:g,getFilename:i,buildExtra:j};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.numerosity.api.XMLHttpRequest',['ephox.numerosity.core.Global'],function(c){return function(){var f=c.getOrDie('XMLHttpRequest');return new f();};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(b,r,c){b('ephox.jax.base.Ajax',['ephox.classify.Type','ephox.compass.Obj','ephox.highway.Merger','ephox.numerosity.api.XMLHttpRequest','ephox.perhaps.Result','ephox.violin.Strings','global!console'],function(T,O,M,X,R,S,f){var g={'*':'*/*',text:'text/plain',html:'text/html',xml:'application/xml, text/xml',json:'application/json, text/javascript'};var h=function(u,s,i,j){var l={url:u,contentType:'application/json',processData:false,type:'GET'};var o=M.merge(l,j);var m=X();m.open(o.type.toUpperCase(),o.url,true);if(T.isString(o.contentType)){m.setRequestHeader('Content-Type',o.contentType);}var n=o.dataType;var a=T.isString(n)&&n!=='*'?g[n]+', '+g['*']+'; q=0.01':g['*'];m.setRequestHeader('Accept',a);if(o.xhrFields!==undefined&&o.xhrFields.withCredentials===true){m.withCredentials=true;}if(T.isObject(o.headers))O.each(o.headers,function(v,k){if(!T.isString(k)&&!T.isString(v))f.error('Request header data was not a string: ',k,' -> ',v);else m.setRequestHeader(k,v);});var p=function(e,k,v){s(e);};var t=function(e){i('Could not load url "'+u+'": '+e.status+' '+e.statusText,e.status,e.responseText);};var w=function(k){try{return R.value(JSON.parse(k.response));}catch(e){return R.error({status:k.status,statusText:'Response was not JSON',responseText:k.responseText});}};var x=function(m){var e=o.dataType==='json'?w(m):R.value(m.response);e.fold(t,function(k){p(k,m.statusText,m);});};var y=function(){if(m.status===0){if(S.startsWith(o.url,'file:'))x(m);else i('Unknown HTTP error (possible cross-domain request)',m.status,m.responseText);}else if(m.status<100||m.status>=400){t(m);}else{x(m);}};m.onerror=t;m.onload=y;if(o.data===undefined){m.send();}else{m.send(o.data);}};return{ajax:h};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.numerosity.api.JSON',['ephox.numerosity.core.Global'],function(c){var j=function(){return c.getOrDie('JSON');};var p=function(o){return j().parse(o);};var s=function(o){return j().stringify(o);};return{parse:p,stringify:s};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.jax.plain.Ajax',['ephox.highway.Merger','ephox.jax.base.Ajax','ephox.numerosity.api.JSON'],function(M,c,J){var g=function(u,s,e,f){c.ajax(u,s,e,M.merge({dataType:'text',type:'GET'},f));};var p=function(u,e,s,f,h){c.ajax(u,s,f,M.merge({dataType:'text',data:J.stringify(e),type:'POST'},h));};return{get:g,post:p};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.yuri.resolve.Recompose',[],function(){var c=function(t){var e='';if(t.protocol!==''){e+=t.protocol;e+=':';}if(t.authority!==''){e+='//';e+=t.authority;}e+=t.path;if(t.query!==''){e+='?';e+=t.query;}if(t.anchor!==''){e+='#';e+=t.anchor;}return e;};return{recompose:c};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){
// (c) Steven Levithan <stevenlevithan.com>
// MIT License
a('ephox.yuri.api.Parser',['ephox.highway.Merger'],function(M){var c={strictMode:false,key:['source','protocol','authority','userInfo','user','password','host','port','relative','path','directory','file','query','anchor'],q:{name:'queryKey',parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};var p=function(s,f){var o=f,m=o.parser[o.strictMode?'strict':'loose'].exec(s),u={},i=14;while(i--)u[o.key[i]]=m[i]||'';u[o.q.name]={};u[o.key[12]].replace(o.q.parser,function($,g,h){if(g)u[o.q.name][g]=h;});return u;};var e=function(s,o){var f=M.merge(c,o);return p(s,f);};return{parse:e};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.yuri.normalize.Dots',['ephox.violin.Strings'],function(S){var c=function(p){return S.removeTrailing(p,l(p));};var f=function(p){return p.match(/(^\/?.*?)(\/|$)/)[1];};var l=function(p){return p.substring(p.lastIndexOf('/'));};var e=function(p){var i=p;var o='';while(i!==''){if(S.startsWith(i,'../')){i=S.removeLeading(i,'../');}else if(S.startsWith(i,'./')){i=S.removeLeading(i,'./');}else if(S.startsWith(i,'/./')){i='/'+S.removeLeading(i,'/./');}else if(i==='/.'){i='/';}else if(S.startsWith(i,'/../')){i='/'+S.removeLeading(i,'/../');o=c(o);}else if(i==='/..'){i='/';o=c(o);}else if(i==='.'||i==='..'){i='';}else{var g=f(i);i=S.removeLeading(i,g);o+=g;}}return o;};return{remove:e};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.yuri.resolve.Merge',['ephox.violin.Strings'],function(S){var m=function(c,e,f){if(f!==''&&c==='')return'/'+e;var l=c.substring(c.lastIndexOf('/')+1);return S.removeTrailing(c,l)+e;};return{merge:m};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,c){a('ephox.yuri.resolve.Transform',['ephox.violin.Strings','ephox.yuri.api.Parser','ephox.yuri.normalize.Dots','ephox.yuri.resolve.Merge'],function(S,P,e,M){var t=function(f,g){var o={strictMode:true};var b=P.parse(f,o);var h=P.parse(g,o);var i={};if(h.protocol!==''){i.protocol=h.protocol;i.authority=h.authority;i.path=e.remove(h.path);i.query=h.query;}else{if(h.authority!==''){i.authority=h.authority;i.path=e.remove(h.path);i.query=h.query;}else{if(h.path===''){i.path=b.path;if(h.query!==''){i.query=h.query;}else{i.query=b.query;}}else{if(S.startsWith(h.path,'/')){i.path=e.remove(h.path);}else{i.path=M.merge(b.path,h.path,f.authority);i.path=e.remove(i.path);}i.query=h.query;}i.authority=b.authority;}i.protocol=b.protocol;}i.anchor=h.anchor;return i;};return{transform:t};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.yuri.api.Resolver',['ephox.yuri.resolve.Recompose','ephox.yuri.resolve.Transform'],function(R,T){var c=function(e,f){var t=T.transform(e,f);return R.recompose(t);};return{resolve:c};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.salmon.services.UploadDirect',['ephox.classify.Type','ephox.highway.Merger','ephox.jax.plain.Ajax','ephox.numerosity.api.JSON','ephox.perhaps.Result','ephox.salmon.services.UploadCommon','ephox.violin.Strings','ephox.yuri.api.Resolver'],function(T,M,c,J,R,U,S,f){return function(s){var g=function(){var e=s.url;var l=e.lastIndexOf('/');var j=l>0?e.substr(0,l):e;var _=s.basePath===undefined?j:s.basePath;return S.endsWith(_,'/')?_:_+'/';};var h=g();var i=function(e,j){var k=e.split(/\s+/);var l=(k.length===1&&k[0]!=='')?k[0]:j;return f.resolve(h,l);};var u=function(j,k,l){var m=j.blob();var n=function(e,w,x){l(R.error(U.failureObject(e,w,x)));};var o=U.getFilename(m,k);var p=s.credentials!==true?{}:{xhrFields:{withCredentials:true}};var t=M.merge(p,U.buildExtra('image',m,o));var v=function(_){var w;try{var x=J.parse(_);if(!T.isString(x.location)){n('JSON response did not contain a string location',500,_);return;}else{w=x.location;}}catch(e){w=_;}var y=i(w,o);l(R.value({location:y}));};c.post(s.url,{},v,n,t);};return{upload:u};};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);E.bolt.module.api.define("global!setTimeout",[],function(){return setTimeout;});(function(a,r,b){a('ephox.salmon.services.UploadFunction',['ephox.classify.Type','ephox.perhaps.Result','ephox.salmon.services.UploadCommon','ephox.scullion.Struct','global!console','global!setTimeout'],function(T,R,U,S,c,s){var i=S.immutable('id','filename','blob','base64');return function(h){var u=function(e,f,g){var j=function(n){g(R.error(n));};var k=function(n){if(!T.isString(n)){c.error('Image upload result was not a string');j('');}else{g(R.value({location:n}));}};var l=U.getFilename(e.blob(),f);var m=i(f,l,e.blob(),e.data().result);s(function(){h(m,k,j);},0);};return{upload:u};};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.salmon.api.Uploaders',['ephox.salmon.services.UploadCommon','ephox.salmon.services.UploadDirect','ephox.salmon.services.UploadFunction'],function(U,c,e){var f=function(s){return c(s);};var g=function(k){return e(k);};var h=function(m,s,k){return U.failureObject(m,s,k);};var i=function(k,l){return U.getFilename(k,l);};var j=function(k,l,m){return U.buildExtra(k,l,m);};return{direct:f,custom:g,failureObject:h,getFilename:i,buildExtra:j};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,c){a('ephox.powerpaste.imageupload.EphoxUploader',['ephox.compass.Arr','ephox.peanut.Fun','ephox.perhaps.Option','ephox.powerpaste.imageupload.TinyUploader','ephox.powerpaste.imageupload.UploadError','ephox.powerpaste.tinymce.UndoRewriter','ephox.salmon.api.BlobCache','ephox.salmon.api.ImageTracker','ephox.salmon.api.UploadUtils','ephox.salmon.api.Uploaders','ephox.sugar.api.Attr','ephox.sugar.api.Element'],function(e,f,O,T,U,g,h,I,i,j,k,l){var m=function(o,s){var p=h();var t=I();var u=U();var v=U(o,s.url);var w=j.direct(s);var x=function(){return l.fromDom(o.getBody());};var y=function(Q,R,b){e.each(R,function(S){k.set(S,'data-mce-src',Q.location);});g.resrcHistory(o,b,Q);};t.events.complete.bind(function(b){g.unwrapHistory(o);});var J=function(b,Q,R){i.handleUpload(w,t,p,x(),b,Q,function(S){S.fold(function(V){R(V);},y);});};var K=function(b,Q){i.prepareForUpload(t,b.blobInfo().id(),b.image()).each(function(R){J(R,b.blobInfo(),Q);});};var L=function(b){var Q=v.instance();var R=i.registerAssets(p,x(),b);e.each(R,function(S){S.fold(function(V){console.error(V);},function(V){K(V,Q);});});};var M=function(){var b=v.instance();var Q=i.findBlobs(t,p,x());e.each(Q,function(R){R.fold(function(S){t.report(S,O.none(),false);},function(S){K(S,b);});});};var N=function(b){M();L(b);};var P=function(b,Q,R,S){return R;};return{uploadImages:N,prepareImages:f.noop,getLocalURL:P};};var n=function(b){var t=T(b);return{uploadImages:f.noop,prepareImages:t.prepareImages,getLocalURL:t.getLocalURL};};return function(b,s){return s?m(b,s):n(b);};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.powerpaste.imageupload.UploaderFactory',['ephox.powerpaste.imageupload.EphoxUploader','ephox.powerpaste.imageupload.TinyUploader'],function(c,T){return function(e){var f=!e.uploadImages&&e.settings.images_upload_url?{url:e.settings.images_upload_url,basePath:e.settings.images_upload_base_path,credentials:e.settings.images_upload_credentials}:null;return!e.uploadImages?c(e,f):T(e);};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,b,c){a('ephox.powerpaste.legacy.tinymce.Util',[],function(){var e=function(i,t){return function(){return i.apply(t,arguments);};};var f=function(n){if(n.ownerDocument.defaultView){return n.ownerDocument.defaultView.getComputedStyle(n,null);}return n.currentStyle||{};};var l=function(m){if(typeof(console)!=='undefined'&&console.log){console.log(m);}};var g=function(j){var k=Array.prototype.slice.call(j).reverse();return function(m){var r=m;for(var i=0;i<k.length;i++){var n=k[i];r=n(r);}return r;};};var h=function(o){tinymce.each(Array.prototype.slice.call(arguments,1),function(i){for(var p in i){o[p]=i[p];}});return o;};return{each:tinymce.each,trim:tinymce.trim,bind:e,extend:h,ephoxGetComputedStyle:f,log:l,compose:g};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){
/**
 * Source code in this file has been taken under a commercial license from tinymce/jscripts/tiny_mce/plugins/paste/editor_plugin_src.js
 * Copyright 2009, Moxiecode Systems AB
 */
a('ephox.powerpaste.legacy.tinymce.Clipboard',['ephox.powerpaste.legacy.tinymce.Util'],function(U){var c=tinymce.each;var g=function(j,k,e){var n,o,l,s=j.selection,m=j.dom,p=j.getBody(),t;if(e.clipboardData&&e.clipboardData.getData('text/html')){e.preventDefault();var u=e.clipboardData.getData('text/html');var v=u.match(/<html[\s\S]+<\/html>/i);var w=v===null?u:v[0];return k(w);}if(m.get('_mcePaste'))return;n=m.add(p,'div',{id:'_mcePaste','class':'mcePaste'},'\uFEFF<br _mce_bogus="1">');if(p!=j.getDoc().body)t=m.getPos(j.selection.getStart(),p).y;else t=p.scrollTop;m.setStyles(n,{position:'absolute',left:-10000,top:t,width:1,height:1,overflow:'hidden'});if(tinymce.isIE){l=m.doc.body.createTextRange();l.moveToElementText(n);l.execCommand('Paste');m.remove(n);if(n.innerHTML==='\uFEFF'){j.execCommand('mcePasteWord');e.preventDefault();return;}k(n.innerHTML);return tinymce.dom.Event.cancel(e);}else{var x=function(e){e.preventDefault();};m.bind(j.getDoc(),'mousedown',x);m.bind(j.getDoc(),'keydown',x);if(tinymce.isGecko){l=j.selection.getRng(true);if(l.startContainer==l.endContainer&&l.startContainer.nodeType==3){nodes=m.select('p,h1,h2,h3,h4,h5,h6,pre',n);if(nodes.length==1)m.remove(nodes.reverse(),true);}}o=j.selection.getRng();n=n.firstChild;l=j.getDoc().createRange();l.setStart(n,0);l.setEnd(n,1);s.setRng(l);window.setTimeout(function(){var h='',y=m.select('div.mcePaste');U.each(y,function(n){var I=n.firstChild;if(I&&I.nodeName=='DIV'&&I.style.marginTop&&I.style.backgroundColor){m.remove(I,1);}U.each(m.select('div.mcePaste',n),function(n){m.remove(n,1);});U.each(m.select('span.Apple-style-span',n),function(n){m.remove(n,1);});U.each(m.select('br[_mce_bogus]',n),function(n){m.remove(n);});h+=n.innerHTML;});U.each(y,function(n){m.remove(n);});if(o)s.setRng(o);k(h);m.unbind(j.getDoc(),'mousedown',x);m.unbind(j.getDoc(),'keydown',x);},0);}};var f=function(h,j){return function(e){g(h,j,e);};};var i=function(h,j){return function(e){if(tinymce.isOpera||navigator.userAgent.indexOf('Firefox/2')>0){if(((tinymce.isMac?e.metaKey:e.ctrlKey)&&e.keyCode==86)||(e.shiftKey&&e.keyCode==45))g(h,j,e);}};};return{getOnPasteFunction:f,getOnKeyDownFunction:i};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.powerpaste.legacy.data.Insert',[],function(){var i=function(f,e){var c=e.getDoc(),m,g="ephoxInsertMarker",s=e.selection,h=e.dom;s.setContent('<span id="'+g+'">&nbsp;</span>');m=h.get(g);var l=c.createDocumentFragment();while(f.firstChild&&!h.isBlock(f.firstChild)){l.appendChild(f.firstChild);}var t=c.createDocumentFragment();while(f.lastChild&&!h.isBlock(f.lastChild)){t.appendChild(f.lastChild);}m.parentNode.insertBefore(l,m);h.insertAfter(t,m);if(f.firstChild){if(h.isBlock(f.firstChild)){while(!h.isBlock(m.parentNode)&&m.parentNode!==h.getRoot()){m=h.split(m.parentNode,m);}if(!h.is(m.parentNode,'td,th')&&m.parentNode!==h.getRoot()){m=h.split(m.parentNode,m);}}h.replace(f,m);}else{h.remove(m);}};return{insert:i};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.powerpaste.legacy.tinymce.Settings',['ephox.powerpaste.legacy.tinymce.Util'],function(U){var c={strip_class_attributes:'all',retain_style_properties:'none'};var e={strip_class_attributes:'none',retain_style_properties:'valid'};var g=function(p,i){if(p&&typeof(p)!='string'){return p;}switch(p){case'clean':return c;case'merge':return e;default:return i;}};var f=function(p,i,j){var s=g(p,i);s=U.extend(s,{base_64_images:j});return s;};var h=function(p,i,j){var w=f(p,c,j);var k=f(i,e,j);var l=k;var s=function(n){l=n?w:k;};var m=function(n){return l[n];};return{setWordContent:s,get:m};};return{create:h};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.powerpaste.legacy.data.tokens.Attributes',['ephox.powerpaste.legacy.tinymce.Util'],function(U){var i=function(e){return e.specified!==false||(e.nodeName==='name'&&e.value!=='');};var c=function(f,e){if(!f||!e){return f||e;}return function(n,v){return e(n,f(n,v));};};var m=function(n){var e=0;var g;var h=function(){return g;};var j;var k=function(){return j();};j=function(){g={};e=0;U.each(n.attributes,function(f){var v=f.nodeName,w=f.value;if(i(f)){if(w!==null&&w!==undefined){g[v]=w;e++;}}});if(g.style===undefined&&n.style.cssText){g.style=n.style.cssText;e++;}j=h;return g;};var l=function(){j();return e;};var u;var o;var p=function(f){if(!u){o=j;}u=c(u,f);j=function(){j=o;t(function(v,w){var x=u(v,w);if(x===null){n.removeAttribute(v);delete g[v];e--;}else if(x!==w){if(v==='class'){n.className=x;}else{n.setAttribute(v,x);}g[v]=x;}});j=h;return g;};};var s=function(f){return j()[f];};var t=function(f){U.each(j(),function(v,w){f(w,v);});};return{get:s,each:t,filter:p,getAttributes:k,getAttributeCount:l};};return{manager:m};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.powerpaste.legacy.data.tokens.Token',['ephox.powerpaste.legacy.data.tokens.Attributes','ephox.powerpaste.legacy.tinymce.Util'],function(c,U,T){var S='startElement';var e='endElement';var f='text';var g='comment';var h=c.manager;var j=function(i){return i.replace(/-(.)/g,function(v,w){return w.toUpperCase();});};var k=function(i){return i.replace(/([A-Z])/g,function(v,w){return'-'+w.toLowerCase();});};var s=false;var l=function(v,w,x){var i,y=v.style.length,I,J,K;K=w||v.getAttribute("style");if(K===undefined||K===null||!K.split){K=v.style.cssText;}U.each(K.split(';'),function(L){var M=L.indexOf(':');if(M>0){I=U.trim(L.substring(0,M));if(I.toUpperCase()===I){I=I.toLowerCase();}I=k(I);J=U.trim(L.substring(M+1));if(!s)s=I.indexOf('mso-')===0;x(I,J);}});if(!s){J=v.style['mso-list'];if(J){x('mso-list',J);}}};var t=function(i,v,w){var x;var y;var I;var J;var K;switch(i.nodeType){case 1:if(v){x=e;}else{x=S;J=h(i);K={};l(i,w,function(a1,b1){K[a1]=b1;});}if(i.scopeName!=="HTML"&&i.scopeName&&i.tagName&&i.tagName.indexOf(':')<=0){y=(i.scopeName+":"+i.tagName).toUpperCase();}else{y=i.tagName;}break;case 3:x=f;I=i.nodeValue;break;case 8:x=g;I=i.nodeValue;break;default:U.log("WARNING: Unsupported node type encountered: "+i.nodeType);break;}var L=function(){if(J)J.getAttributes();return i;};var M=function(){return y;};var N=function(){return x;};var O=function(){return I;};var P=function(){return"Type: "+x+", Tag: "+y+" Text: "+I;};var Q=function(a1){return J.get(a1.toLowerCase());};var R=function(a1){if(x===S){J.filter(a1);}};var V=function(a1){if(N()===S){var b1="";U.each(K,function(c1,d1){var e1=a1(d1,c1);if(e1===null){if(i.style.removeProperty){i.style.removeProperty(j(d1));}else{i.style.removeAttribute(j(d1));}delete K[d1];}else{b1+=d1+': '+e1+'; ';K[d1]=e1;}});b1=b1?b1:null;R(function(c1,d1){if(c1==='style'){return b1;}return d1;});i.style.cssText=b1;}};var W=function(){return J.getAttributeCount();};var X=function(a1){J.each(a1);};var Y=function(a1){return K[a1];};var Z=function(a1){U.each(K,function(b1,c1){a1(c1,b1);});};var $=function(){return U.ephoxGetComputedStyle(i);};var _=function(){return x===f&&/^[\s\u00A0]*$/.test(I);};return{getNode:L,tag:M,type:N,text:O,toString:P,getAttribute:Q,filterAttributes:R,filterStyles:V,getAttributeCount:W,attributes:X,getStyle:Y,styles:Z,getComputedStyle:$,isWhitespace:_};};var m=function(i,v,w,x){var y=x.createElement(i),I="";U.each(v,function(J,K){y.setAttribute(K,J);});U.each(w,function(J,K){I+=K+":"+J+";";y.style[j(K)]=J;});return t(y,false,I!==""?I:null);};var n=function(i,v){return t(v.createElement(i),true);};var o=function(i,v){return t(v.createComment(i),false);};var p=function(i,v){return t(v.createTextNode(i));};var u=n('HTML',window.document);return{START_ELEMENT_TYPE:S,END_ELEMENT_TYPE:e,TEXT_TYPE:f,COMMENT_TYPE:g,FINISHED:u,token:t,createStartElement:m,createEndElement:n,createComment:o,createText:p};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.powerpaste.legacy.data.tokens.Serializer',['ephox.powerpaste.legacy.data.tokens.Token'],function(T){var c=function(e){var f=e.createDocumentFragment();var i=f;var p=function(n){h(n);f=n;};var g=function(){f=f.parentNode;};var h=function(n){f.appendChild(n);};var j=function(t){var s=function(t){var n=t.getNode().cloneNode(false);p(n);};var k=function(t,l){var n=e.createTextNode(t.text());h(n);};switch(t.type()){case T.START_ELEMENT_TYPE:s(t);break;case T.TEXT_TYPE:k(t);break;case T.END_ELEMENT_TYPE:g();break;case T.COMMENT_TYPE:break;default:throw{message:'Unsupported token type: '+t.type()};}};return{dom:i,receive:j};};return{create:c};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.powerpaste.legacy.data.tokens.Tokenizer',['ephox.powerpaste.legacy.data.tokens.Token'],function(T){var t=function(h,c){var e;c=c||window.document;e=c.createElement('div');c.body.appendChild(e);e.style.position='absolute';e.style.left='-10000px';e.innerHTML=h;nextNode=e.firstChild||T.FINISHED;var n=[];endNode=false;var g=function(j,k){if(j===T.FINISHED){return j;}else if(j){return T.token(j,k);}else{return undefined;}};var f=function(){var j=nextNode;var k=endNode;if(!endNode&&nextNode.firstChild){n.push(nextNode);nextNode=nextNode.firstChild;}else if(!endNode&&nextNode.nodeType===1){endNode=true;}else if(nextNode.nextSibling){nextNode=nextNode.nextSibling;endNode=false;}else{nextNode=n.pop();endNode=true;}if(j!==T.FINISHED&&!nextNode){c.body.removeChild(e);nextNode=T.FINISHED;}return g(j,k);};var i=function(){return nextNode!==undefined;};return{hasNext:i,next:f};};return{tokenize:t};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.powerpaste.legacy.data.tokens.Filter',['ephox.powerpaste.legacy.data.tokens.Token','ephox.powerpaste.legacy.tinymce.Util'],function(T,U){var c=function(f,g){var h=function(n,s,i){var j;var k,l,m=false;var o=function(){if(g)g(L);m=false;k=[];l=[];};var p=function(M){U.each(M,function(N){n.receive(N);});};var t=function(M){if(m){l.push(M);}else{n.receive(M);}};var u=function(M){if(g)k.push(M);f(L,M);if(M===T.FINISHED){x();}};var v=function(){m=true;};var w=function(){p(k);o();};var x=function(){J();p(l);o();};var y=function(M){j=j||[];j.push(M);};var I=function(){return j&&j.length>0;};var J=function(){U.each(j,function(M){t(M);});K();};var K=function(){j=[];};var L={document:i||window.document,settings:s||{},emit:t,receive:u,startTransaction:v,rollback:w,commit:x,defer:y,hasDeferred:I,emitDeferred:J,dropDeferred:K};o();return L;};return h;};var e=function(f){return c(function(g,t){t.filterAttributes(U.bind(f,g));g.emit(t);});};return{createFilter:c,createAttributeFilter:e};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.powerpaste.legacy.filters.Text',['ephox.powerpaste.legacy.data.tokens.Filter','ephox.powerpaste.legacy.data.tokens.Token'],function(c,T){var l=/^(P|H[1-6]|T[DH]|LI|DIV|BLOCKQUOTE|PRE|ADDRESS|FIELDSET|DD|DT|CENTER)$/;var e=function(t){return l.test(t.tag());};var f=function(){return null;};var i=false;return c.createFilter(function(g,t){var h=function(){if(!i){g.emit(T.createStartElement('P',{},{},g.document));i=true;}};switch(t.type()){case T.TEXT_TYPE:h();g.emit(t);break;case T.END_ELEMENT_TYPE:if(i&&(e(t)||t===T.FINISHED)){g.emit(T.createEndElement('P',g.document));i=false;}else if(t.tag()==='BR'){g.emit(t);}break;case T.START_ELEMENT_TYPE:if(t.tag()==='BR'){t.filterAttributes(f);t.filterStyles(f);g.emit(t);}else if(t.tag()==='IMG'&&t.getAttribute('alt')){h();g.emit(T.createText(t.getAttribute('alt'),g.document));}break;}if(t===T.FINISHED){g.emit(t);}});});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.powerpaste.legacy.data.tokens.Helper',['ephox.powerpaste.legacy.data.tokens.Token'],function(T){var c=function(){if(navigator.userAgent.indexOf('Gecko')>0&&navigator.userAgent.indexOf('WebKit')<0)return false;var g=document.createElement('div');try{g.innerHTML='<p style="mso-list: Ignore;">&nbsp;</p>';}catch(i){return false;}return T.token(g.firstChild).getStyle('mso-list')==='Ignore';};var s=c();var e=function(t){return t.tag()==='A'||t.tag()==='SPAN';};var h=function(t){var g=t.getStyle('mso-list');return g&&g!=='skip';};var f=function(t,g){if(t.type()===T.START_ELEMENT_TYPE){return t.getAttributeCount()===0||(g&&t.getAttributeCount()===1&&(t.getAttribute('style')!==null&&t.getAttribute('style')!==undefined));}else{return t.type()===T.END_ELEMENT_TYPE;}};return{hasNoAttributes:f,supportsCustomStyles:s,spanOrA:e,hasMsoListStyle:h};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.powerpaste.legacy.filters.list.ListTypes',['ephox.powerpaste.legacy.data.tokens.Token','ephox.powerpaste.legacy.tinymce.Util'],function(T,U){var o=[{regex:/^\(?[dc][\.\)]$/,type:{tag:'OL',type:'lower-alpha'}},{regex:/^\(?[DC][\.\)]$/,type:{tag:'OL',type:'upper-alpha'}},{regex:/^\(?M*(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})[\.\)]$/,type:{tag:'OL',type:'upper-roman'}},{regex:/^\(?m*(cm|cd|d?c{0,3})(xc|xl|l?x{0,3})(ix|iv|v?i{0,3})[\.\)]$/,type:{tag:'OL',type:'lower-roman'}},{regex:/^\(?[0-9]+[\.\)]$/,type:{tag:'OL'}},{regex:/^([0-9]+\.)*[0-9]+\.?$/,type:{tag:'OL',variant:'outline'}},{regex:/^\(?[a-z]+[\.\)]$/,type:{tag:'OL',type:'lower-alpha'}},{regex:/^\(?[A-Z]+[\.\)]$/,type:{tag:'OL',type:'upper-alpha'}}];var u={'\u2022':{tag:'UL',type:'disc'},'\u00B7':{tag:'UL',type:'disc'},'\u00A7':{tag:'UL',type:'square'}};var c={'o':{tag:'UL',type:'circle'},'-':{tag:'UL',type:'disc'},'\u25CF':{tag:'UL',type:'disc'}};var e=function(t,v){var n={tag:t.tag,type:t.type,variant:v};if(t.start){n.start=t.start;}if(!t.type)delete n.type;return n;};var g=function(i,p,j){var l=null,t,s,v;if(i){t=i.text;s=i.symbolFont;}t=U.trim(t);l=c[t];if(!l){if(s){l=u[t];if(!l){l={tag:'UL',variant:t};}else{l=e(l,t);}}else{U.each(o,function(B){if(B.regex.test(t)){if(p&&f(B.type,p,true)){l=B.type;l.start=parseInt(t);return false;}if(!l)l=B.type;l.start=parseInt(t);}});if(l&&!l.variant){if(t.charAt(0)==='(')v='()';else if(t.charAt(t.length-1)===')')v=')';else v='.';l=e(l,v);}}}else{l=e(l,t);}if(l&&l.tag==='OL'&&j&&(j.tag()!=='P'||/^MsoHeading/.test(j.getAttribute('class')))){l=null;}return l;};var f=function(t,i,j){return t===i||(t&&i&&t.tag===i.tag&&t.type===i.type&&(j||t.variant===i.variant));};var h=function(t,s){if(t.type()==T.START_ELEMENT_TYPE){font=t.getStyle('font-family');if(font){s=(font==='Wingdings'||font==='Symbol');}else if(/^(P|H[1-6]|DIV)$/.test(t.tag())){s=false;}}return s;};return{guessListType:g,eqListType:f,checkFont:h};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.powerpaste.legacy.filters.list.CommentHeuristics',['ephox.powerpaste.legacy.data.tokens.Token','ephox.powerpaste.legacy.filters.list.ListTypes','ephox.powerpaste.legacy.tinymce.Util'],function(T,L,U){var i=function(t,h){var j,k,l,o=false,v,p;var u=function(n){var w=n.style.fontFamily;if(w){o=(w==='Wingdings'||w==='Symbol');}};if(t.type()===T.START_ELEMENT_TYPE&&h.openedTag&&t.tag()==='SPAN'){l=h.openedTag.getNode();u(l);if(l.childNodes.length>1&&l.firstChild.tagName==='A'&&l.firstChild.textContent===''){l=l.childNodes[1];}while(l.firstChild&&(l.firstChild.tagName==='SPAN'||l.firstChild.tagName==='A')){l=l.firstChild;u(l);}l=l.firstChild;if(l&&l.nodeType===3){v=l.value;if(!U.trim(v)){l=l.parentNode.nextSibling;v=l?l.value:'';}if(!l||U.trim(l.parentNode.textContent)!=v){return false;}p=L.guessListType({text:v,symbolFont:o},null,h.originalToken);if(p){return l.nextSibling&&l.nextSibling.tagName==='SPAN'&&/^[\u00A0\s]/.test(l.nextSibling.firstChild.value)&&(h.openedTag.tag()==='P'||p.tag==='UL');}}else{return l&&l.tagName==='IMG';}}return false;};var g=function(n,p){var h,j,o=0;h=n.parentNode;while(h!==null&&h!==undefined&&h!==p.parentNode){o+=h.offsetLeft;h=h.offsetParent;}return o;};var m=function(h){var j={};return function(p,k){var l,n=p+","+k;if(j.hasOwnProperty(n)){return j[n];}l=h.call(null,p,k);j[n]=l;return l;};};var f=function(h){var j=h.indexOf('.');if(j>=0&&U.trim(h.substring(j+1))===className){match=results[2];return false;}};var c=m(function(h,j){var k,l=/([^{]+){([^}]+)}/g,n,o,p;l.lastIndex=0;while((k=l.exec(h))!==null&&!n){U.each(k[1].split(','),f(selector));}if(n){o=document.createElement('p');o.setAttribute("style",n);p=U.ephoxGetComputedStyle(o);return p?""+p.marginLeft:false;}return false;});var e=function(){var l;var h;var j=function(k,t,s,n){var o,p,u,v=1;if(n&&/^([0-9]+\.)+[0-9]+\.?$/.test(n.text)){return n.text.replace(/([0-9]+|\.$)/g,'').length+1;}o=h||parseInt(c(s,t.getAttribute('class')));p=g(k.getNode(),t.getNode());if(!o){o=48;}else{if(l){p+=l;}else if(p===0){l=o;p+=o;}}h=o=Math.min(p,o);v=Math.max(1,Math.floor(p/o))||1;return v;};return{guessIndentLevel:j};};var s=function(){var h=false;var s="";var j=function(t){if(h&&t.type()===T.TEXT_TYPE){s+=t.text();return true;}else if(t.type()===T.START_ELEMENT_TYPE&&t.tag()==='STYLE'){h=true;return true;}else if(t.type()===T.END_ELEMENT_TYPE&&t.tag()==='STYLE'){h=false;return true;}return false;};return{check:j};};return{isListWithoutCommentsOrStyles:i,indentGuesser:e,styles:s};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.powerpaste.legacy.filters.list.Emitter',['ephox.powerpaste.legacy.data.tokens.Token','ephox.powerpaste.legacy.filters.list.ListTypes'],function(T,L){var i=['disc','circle','square'];var c=function(t,l){if(t.tag==='UL'){if(i[l-1]===t.type){t={tag:'UL'};}}return t;};return function(e,f){var l=[];var g=[];var h=0;var j;var o=function(v,w){var x={},y={};h++;if(w){if(v.type){x={'list-style-type':v.type};}}if(v.start&&v.start>1){y={start:v.start};}l.push(v);e.emit(T.createStartElement(v.tag,y,x,f));j=v;};var k=function(){e.emit(T.createEndElement(l.pop().tag,f));h--;j=l[l.length-1];};var m=function(){while(h>0){n();k();}e.commit();};var n=function(){var v=g?g.pop():'P';if(v!='P'){e.emit(T.createEndElement(v,f));}e.emit(T.createEndElement('LI',f));};var p=function(v,w,x){var y={};if(!v){y['list-style-type']='none';}else{var I=v.getStyle('margin-left');if(I!==undefined){y['margin-left']=I;}}if(j&&!L.eqListType(j,w)){k();if(x){e.emit(T.createStartElement('P',{},{},f));e.emit(T.createText('\u00A0',f));e.emit(T.createEndElement('P',f));}o(w,true);}e.emit(T.createStartElement('LI',{},y,f));if(v&&v.tag()!='P'){g.push(v.tag());v.filterStyles(function(){return null;});e.emit(v);}else{g.push('P');}};var s=function(v,w,x,y){var I={},J;if(!x)return;if(!h)h=0;while(h>v){n();k();}x=c(x,v);if(h==v){n();p(w,x,y);}else{if(v>1&&g.length>0&&g[g.length-1]!=='P'){e.emit(T.createEndElement(g[g.length-1],f));g[g.length-1]='P';}while(h<v){o(x,h==v-1);p(h==v?w:undefined,x);}}};var t=function(){return h;};var u=function(){return j;};return{openList:o,closelist:k,closeAllLists:m,closeItem:n,openLI:p,openItem:s,getCurrentListType:u,getCurrentLevel:t};};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.powerpaste.legacy.filters.list.ListStates',['ephox.powerpaste.legacy.data.tokens.Helper','ephox.powerpaste.legacy.data.tokens.Token','ephox.powerpaste.legacy.filters.list.CommentHeuristics','ephox.powerpaste.legacy.filters.list.ListTypes','ephox.powerpaste.legacy.tinymce.Util'],function(c,T,e,L,U){var u=function(v,w){U.log("Unexpected token in list conversion: "+w.toString());v.rollback();};var p=function(v,w,x){if(w==x){return v;}return null;};var f=function(v,w,x){if(x.type()===T.TEXT_TYPE&&U.trim(x.text())===''){v.defer(x);}else if(!w.skippedPara&&x.type()===T.START_ELEMENT_TYPE&&x.tag()==='P'&&!c.hasMsoListStyle(x)){w.openedTag=x;v.defer(x);w.nextFilter=s;}else{n(v,w,x);}};var s=function(v,w,x){if(x.type()===T.START_ELEMENT_TYPE&&x.tag()==='SPAN'&&w.spanCount.length===0&&(c.supportsCustomStyles||!e.isListWithoutCommentsOrStyles(x,w))&&!c.hasMsoListStyle(x)){v.defer(x);w.spanCount.push(x);}else if(x.type()===T.END_ELEMENT_TYPE){if(x.tag()==='SPAN'){v.defer(x);w.spanCount.pop();}else if(x.tag()==='P'){v.defer(x);w.skippedPara=true;w.openedTag=null;w.nextFilter=f;}else{w.nextFilter=n;w.nextFilter(v,w,x);}}else if(x.isWhitespace()){v.defer(x);}else{w.nextFilter=n;w.nextFilter(v,w,x);}};var m=function(v,w,x){if(x.type()===T.END_ELEMENT_TYPE&&x.tag()===w.originalToken.tag()){w.nextFilter=f;}else if(x===T.FINISHED){w.emitter.closeAllLists();v.emit(x);}};var n=function(v,w,x){var y=function(){w.emitter.closeAllLists();v.emitDeferred();w.openedTag=null;v.emit(x);w.nextFilter=n;};if(x.type()===T.START_ELEMENT_TYPE&&c.hasMsoListStyle(x)&&x.tag()!=='LI'){var I=x.getStyle('mso-list');if(false&&I==='skip'){w.nextFilter=m;w.originalToken=x;}else{var J=/ level([0-9]+)/.exec(x.getStyle('mso-list'));if(J&&J[1]){w.itemLevel=parseInt(J[1],10)+w.styleLevelAdjust;if(w.nextFilter===n){v.emitDeferred();}else{v.dropDeferred();}w.nextFilter=l;v.startTransaction();w.originalToken=x;w.commentMode=false;}else{y();}}}else if(!c.supportsCustomStyles&&((x.type()===T.COMMENT_TYPE&&x.text()==='[if !supportLists]')||(e.isListWithoutCommentsOrStyles(x,v)))){if(x.type()===T.START_ELEMENT_TYPE&&x.tag()==='SPAN'){w.spanCount.push(x);}w.nextFilter=l;v.startTransaction();w.originalToken=w.openedTag;w.commentMode=true;w.openedTag=null;v.dropDeferred();}else if(x.type()===T.END_ELEMENT_TYPE&&c.spanOrA(x)){v.defer(x);w.spanCount.pop();}else if(x.type()===T.START_ELEMENT_TYPE){if(c.spanOrA(x)){v.defer(x);w.spanCount.push(x);}else{if(w.openedTag){w.emitter.closeAllLists();v.emitDeferred();}w.openedTag=x;v.defer(x);}}else{y();}};var g=function(v,w,x){if(x.type()===T.END_ELEMENT_TYPE&&w.originalToken.tag()===x.tag()){w.nextFilter=f;w.styleLevelAdjust=-1;}v.emit(x);};var l=function(v,w,x){if(x.type()==T.START_ELEMENT_TYPE&&x.getStyle('mso-list')==='Ignore'){w.nextFilter=h;}if(x.type()===T.START_ELEMENT_TYPE&&x.tag()==='SPAN'){w.spanCount.push(x);if(w.commentMode&&x.getAttribute("style")===""||x.getAttribute("style")===null){w.nextFilter=h;}}else if(x.tag()==='A'){if(x.type()===T.START_ELEMENT_TYPE){w.spanCount.push(x);}else{w.spanCount.pop();}}else if(x.type()===T.TEXT_TYPE){if(w.commentMode){w.nextFilter=h;w.nextFilter(v,w,x);}else{var y=w.originalToken;var I=w.spanCount;w.emitter.closeAllLists();v.emit(y);U.each(I,U.bind(v.emit,v));v.emit(x);v.commit();w.originalToken=y;w.nextFilter=g;}}else if(!w.commentMode&&x.type()===T.COMMENT_TYPE){}else{u(v,x);}};var h=function(v,w,x){if(x.type()===T.TEXT_TYPE){if(x.isWhitespace()){}else{w.nextFilter=i;w.bulletInfo={text:x.text(),symbolFont:w.symbolFont};}}else if(c.spanOrA(x)){if(x.type()===T.START_ELEMENT_TYPE){w.spanCount.push(x);}else{w.spanCount.pop();}}else if(x.type()===T.START_ELEMENT_TYPE&&x.tag()==='IMG'){w.nextFilter=i;w.bulletInfo={text:'\u2202',symbolFont:true};}else{u(v,x);}};var i=function(v,w,x){if(x.type()===T.START_ELEMENT_TYPE&&c.spanOrA(x)){w.spanCount.push(x);w.nextFilter=j;}else if(x.type()===T.END_ELEMENT_TYPE&&c.spanOrA(x)){w.spanCount.pop();w.nextFilter=k;}else if(x.type()===T.END_ELEMENT_TYPE&&x.tag()==='IMG'){}else{u(v,x);}};var j=function(v,w,x){if(x.type()===T.END_ELEMENT_TYPE){if(c.spanOrA(x)){w.spanCount.pop();}w.nextFilter=k;}};var k=function(v,w,x){var y=function(I){w.nextFilter=o;if(w.commentMode)w.itemLevel=w.indentGuesser.guessIndentLevel(x,w.originalToken,w.styles.styles,w.bulletInfo);w.listType=L.guessListType(w.bulletInfo,p(w.emitter.getCurrentListType(),w.emitter.getCurrentLevel(),w.itemLevel),w.originalToken);if(w.listType){w.emitter.openItem(w.itemLevel,w.originalToken,w.listType,w.skippedPara);v.emitDeferred();while(w.spanCount.length>0){v.emit(w.spanCount.shift());}if(I){v.emit(x);}}else{U.log("Unknown list type: "+w.bulletInfo.text+" Symbol font? "+w.bulletInfo.symbolFont);v.rollback();}};if(x.type()===T.TEXT_TYPE||x.type()===T.START_ELEMENT_TYPE){y(true);}else if(x.type()===T.COMMENT_TYPE){y(x.text()!=='[endif]');}else if(x.type()===T.END_ELEMENT_TYPE){if(c.spanOrA(x)){w.spanCount.pop();}}else{u(v,x);}};var o=function(v,w,x){if(x.type()===T.END_ELEMENT_TYPE&&x.tag()===w.originalToken.tag()){w.nextFilter=f;w.skippedPara=false;}else{v.emit(x);}};var t=n;return{initial:t};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.powerpaste.legacy.filters.list.Lists',['ephox.powerpaste.legacy.data.tokens.Filter','ephox.powerpaste.legacy.data.tokens.Helper','ephox.powerpaste.legacy.data.tokens.Token','ephox.powerpaste.legacy.filters.list.CommentHeuristics','ephox.powerpaste.legacy.filters.list.Emitter','ephox.powerpaste.legacy.filters.list.ListStates','ephox.powerpaste.legacy.filters.list.ListTypes','ephox.powerpaste.legacy.tinymce.Util'],function(c,e,T,f,g,L,h,U){var i={};var j=function(m){i.nextFilter=L.initial;i.itemLevel=0;i.originalToken=null;i.commentMode=false;i.openedTag=null;i.symbolFont=false;i.listType=null;i.indentGuesser=f.indentGuesser();i.emitter=g(m,m.document);i.styles=f.styles();i.spanCount=[];i.skippedPara=false;i.styleLevelAdjust=0;i.bulletInfo=undefined;};j({});var k=function(m){j(m);};var l=function(m,t){if(i.styles.check(t)){return;}i.symbolFont=h.checkFont(t,i.symbolFont);i.nextFilter(m,i,t);};return c.createFilter(l,k);});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.powerpaste.legacy.tinymce.BrowserFilters',['ephox.powerpaste.legacy.tinymce.Util'],function(U){var t=function(l){var h=l;var m=h.charCodeAt(h.length-1)===65279;return m?h.substring(0,h.length-1):l;};var c=function(h){return(/<(h[1-6r]|p|div|address|pre|form|table|tbody|thead|tfoot|th|tr|td|li|ol|ul|caption|blockquote|center|dl|dt|dd|dir|fieldset)/).test(h)?h.replace(/(?:<br>&nbsp;[\s\r\n]+|<br>)*(<\/?(h[1-6r]|p|div|address|pre|form|table|tbody|thead|tfoot|th|tr|td|li|ol|ul|caption|blockquote|center|dl|dt|dd|dir|fieldset)[^>]*>)(?:<br>&nbsp;[\s\r\n]+|<br>)*/g,'$1'):h;};var e=function(h){return h.replace(/<br><br>/g,'<BR><BR>');};var f=function(h){return h.replace(/<br>/g,' ');};var g=function(h){return h.replace(/<BR><BR>/g,'<br>');};var i=[t];var j=(tinymce.isIE&&document.documentMode>=9)?[g,f,e,c].concat(i):i;var k=U.compose(j);return{all:k,textOnly:t};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.powerpaste.legacy.filters.FilterInlineStyles',['ephox.powerpaste.legacy.data.tokens.Filter'],function(c){var e=/^(mso-.*|tab-stops|tab-interval|language|text-underline|text-effect|text-line-through|font-color|horiz-align|list-image-[0-9]+|separator-image|table-border-color-(dark|light)|vert-align|vnd\..*)$/;var f=function(s){return function(n,v){var p=false;switch(s){case'all':case'*':p=true;break;case'valid':p=!e.test(n);break;case undefined:case'none':p=n==='list-style-type';break;default:p=(','+s+',').indexOf(','+n+',')>=0;break;}return p?v:null;};};return c.createFilter(function(g,t){var s=g.settings.get('retain_style_properties');t.filterStyles(f(s));g.emit(t);});});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.powerpaste.legacy.filters.InferListTags',['ephox.powerpaste.legacy.data.tokens.Filter','ephox.powerpaste.legacy.data.tokens.Token'],function(c,T){return c.createFilter(function(e,t){if(e.seenList){e.emit(t);}else if(e.inferring){if(t.tag()==='LI'){if(t.type()===T.START_ELEMENT_TYPE){e.inferring++;}else{e.inferring--;if(!e.inferring){e.needsClosing=true;}}}e.emit(t);}else{if(t.tag()==='OL'||t.tag()==='UL'){e.seenList=true;}else if(t.tag()==='LI'){e.inferring=1;if(!e.needsClosing){e.emit(T.createStartElement('UL',{},{},e.document));}}if(e.needsClosing&&!e.inferring&&!t.isWhitespace()){e.needsClosing=false;e.emit(T.createEndElement('UL',e.document));}e.emit(t);}});});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.powerpaste.legacy.filters.StripBookmarks',['ephox.powerpaste.legacy.data.tokens.Filter'],function(c){return c.createAttributeFilter(function(n,v){if(n==='name'||n==='id'){return null;}return v;});});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.powerpaste.legacy.filters.StripClassAttributes',['ephox.powerpaste.legacy.data.tokens.Filter'],function(c){return c.createAttributeFilter(function(n,v){var e;if(n==='class'){e=this.settings.get('strip_class_attributes');switch(e){case'mso':return v.indexOf('Mso')===0?null:v;case'none':return v;default:return null;}}return v;});});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.powerpaste.legacy.filters.StripEmptyInlineElements',['ephox.powerpaste.legacy.data.tokens.Filter','ephox.powerpaste.legacy.data.tokens.Helper','ephox.powerpaste.legacy.data.tokens.Token'],function(c,e,T){var f=[];var o=[];var h=false;var g=function(i,p){var j,t,m=1;for(j=p+1;j<i;j++){t=f[j];if(t&&t.tag()==='SPAN'){if(t.type()===T.START_ELEMENT_TYPE){m++;}else if(t.type()===T.END_ELEMENT_TYPE){m--;if(m===0){f[j]=null;return;}}}}};var k=function(j){if(h){var t,m=f.length,i;for(i=0;i<m;i++){t=f[i];if(!t)continue;if(t.type()===T.START_ELEMENT_TYPE&&t.tag()==='SPAN'&&e.hasNoAttributes(t)){g(m,i);}else{j.emit(t);}}}f=[];o=[];h=false;};var l=function(i,t){f.push(t);o=o||[];if(t.type()===T.START_ELEMENT_TYPE){o.push(t);}else if(t.type()===T.END_ELEMENT_TYPE){o.pop();if(o.length===0){k(i,t);return;}}};return c.createFilter(function(i,t){var j=',FONT,EM,STRONG,SAMP,ACRONYM,CITE,CODE,DFN,KBD,TT,B,I,U,S,SUB,SUP,INS,DEL,VAR,SPAN,';f=f||[];var m=function(t){return!(j.indexOf(','+t.tag()+',')>=0&&e.hasNoAttributes(t,true));};if(f.length===0){if(t.type()===T.START_ELEMENT_TYPE){if(m(t)){i.emit(t);}else{l(i,t);}}else{i.emit(t);}}else{if(!h)h=m(t);l(i,t);}});});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.powerpaste.legacy.filters.StripEmptyStyleAttributes',['ephox.powerpaste.legacy.data.tokens.Filter'],function(c){return c.createAttributeFilter(function(n,v){if(n==='style'&&v===''){return null;}return v;});});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.powerpaste.legacy.filters.StripLangAttribute',['ephox.powerpaste.legacy.data.tokens.Filter'],function(c){return c.createAttributeFilter(function(n,v){return n==='lang'?null:v;});});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.powerpaste.legacy.filters.StripImages',['ephox.powerpaste.legacy.data.tokens.Filter','ephox.powerpaste.legacy.data.tokens.Token'],function(c,T){return c.createFilter(function(e,t){if(t.tag()==='IMG'){if(t.type()===T.END_ELEMENT_TYPE&&e.skipEnd){e.skipEnd=false;return;}else if(t.type()===T.START_ELEMENT_TYPE){if(/^file:/.test(t.getAttribute('src'))){e.skipEnd=true;return;}else if(e.settings.get('base_64_images')&&/^data:image\/.*;base64/.test(t.getAttribute('src'))){e.skipEnd=true;return;}}}e.emit(t);});});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.powerpaste.legacy.filters.StripMetaAndLinkElements',['ephox.powerpaste.legacy.data.tokens.Filter'],function(c){return c.createFilter(function(e,t){if(t.tag()!=='META'&&t.tag()!=='LINK'){e.emit(t);}});});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.powerpaste.legacy.filters.StripNoAttributeA',['ephox.powerpaste.legacy.data.tokens.Filter','ephox.powerpaste.legacy.data.tokens.Helper','ephox.powerpaste.legacy.data.tokens.Token'],function(c,e,T){var k=function(t){return!e.hasNoAttributes(t)&&!/^OLE_LINK/.test(t.getAttribute('name'));};var s=[];return c.createFilter(function(f,t){var o;if(t.type()===T.START_ELEMENT_TYPE&&t.tag()==='A'){s.push(t);if(k(t)){f.defer(t);}}else if(t.type()===T.END_ELEMENT_TYPE&&t.tag()==='A'){o=s.pop();if(k(o)){f.defer(t);}if(s.length===0){f.emitDeferred();}}else if(f.hasDeferred()){f.defer(t);}else{f.emit(t);}});});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.powerpaste.legacy.filters.StripScripts',['ephox.powerpaste.legacy.data.tokens.Filter','ephox.powerpaste.legacy.data.tokens.Token'],function(c,T){var s=false;return c.createFilter(function(e,t){if(t.tag()==='SCRIPT'){s=t.type()===T.START_ELEMENT_TYPE;}else if(!s){t.filterAttributes(function(n,v){if(/^on/.test(n)||n==='language')return null;return v;});e.emit(t);}});});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.powerpaste.legacy.wordimport.CommonFilters',['ephox.powerpaste.legacy.filters.FilterInlineStyles','ephox.powerpaste.legacy.filters.InferListTags','ephox.powerpaste.legacy.filters.StripBookmarks','ephox.powerpaste.legacy.filters.StripClassAttributes','ephox.powerpaste.legacy.filters.StripEmptyInlineElements','ephox.powerpaste.legacy.filters.StripEmptyStyleAttributes','ephox.powerpaste.legacy.filters.StripLangAttribute','ephox.powerpaste.legacy.filters.StripImages','ephox.powerpaste.legacy.filters.StripMetaAndLinkElements','ephox.powerpaste.legacy.filters.StripNoAttributeA','ephox.powerpaste.legacy.filters.StripScripts'],function(c,I,S,e,f,g,h,i,j,k,l){return[l,S,i,c,h,g,e,k,f,j,I];});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.powerpaste.legacy.filters.StripFormattingAttributes',['ephox.powerpaste.legacy.data.tokens.Filter'],function(c){return c.createFilter(function(e,t){t.filterAttributes(function(n,v){if(n==='align')return null;if((t.tag()==='UL'||t.tag()==='OL')&&n==='type')return null;return v;});e.emit(t);});});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.powerpaste.legacy.filters.StripNamespaceDeclarations',['ephox.powerpaste.legacy.data.tokens.Filter'],function(c){return c.createAttributeFilter(function(n,v){if(/^xmlns(:|$)/.test(n)){return null;}return v;});});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.powerpaste.legacy.filters.StripOPTags',['ephox.powerpaste.legacy.data.tokens.Filter'],function(c){return c.createFilter(function(e,t){if(!t.tag||!/^([OVWXP]|U[0-9]+|ST[0-9]+):/.test(t.tag())){e.emit(t);}});});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.powerpaste.legacy.filters.StripTocLinks',['ephox.powerpaste.legacy.data.tokens.Filter'],function(c){return c.createAttributeFilter(function(n,v){if(n==='href'&&(v.indexOf('#_Toc')>=0||v.indexOf('#_mso')>=0)){return null;}return v;});});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.powerpaste.legacy.filters.StripVMLAttributes',['ephox.powerpaste.legacy.data.tokens.Filter'],function(c){return c.createAttributeFilter(function(n,v){if(/^v:/.test(n)){return null;}return v;});});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.powerpaste.legacy.wordimport.WordOnlyFilters',['ephox.powerpaste.legacy.filters.StripFormattingAttributes','ephox.powerpaste.legacy.filters.StripNamespaceDeclarations','ephox.powerpaste.legacy.filters.StripOPTags','ephox.powerpaste.legacy.filters.StripTocLinks','ephox.powerpaste.legacy.filters.StripVMLAttributes','ephox.powerpaste.legacy.filters.list.Lists'],function(S,c,e,f,g,L){return[e,L,f,g,c,S];});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.powerpaste.legacy.wordimport.WordImport',['ephox.powerpaste.legacy.data.tokens.Serializer','ephox.powerpaste.legacy.data.tokens.Tokenizer','ephox.powerpaste.legacy.filters.Text','ephox.powerpaste.legacy.filters.list.Lists','ephox.powerpaste.legacy.tinymce.BrowserFilters','ephox.powerpaste.legacy.wordimport.CommonFilters','ephox.powerpaste.legacy.wordimport.WordOnlyFilters'],function(S,T,c,L,e,f,W){var g=function(m,s,n,o){var i,j=s;for(i=m.length-1;i>=0;i--){j=m[i](j,n,o);}return j;};var h=function(i,s,m,n){var o=S.create(m);var t=T.tokenize(i,m);pipeline=g(n,o,s,m);while(t.hasNext()){pipeline.receive(t.next());}return o.dom;};var j=function(i,s,m){var n=e.all(i);var o=l(n);s.setWordContent(o);var p=f;if(o){p=W.concat(f);}return h(n,s,m,p);};var k=function(i,s,m){var n=e.textOnly(i);return h(n,s,m,[c]);};var l=function(i){return i.indexOf('<o:p>')>=0||i.indexOf('p.MsoNormal, li.MsoNormal, div.MsoNormal')>=0||i.indexOf('MsoListParagraphCxSpFirst')>=0||i.indexOf('<w:WordDocument>')>=0;};return{filter:j,filterPlainText:k,isWordContent:l};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.powerpaste.tinymce.LegacyTinyDialog',['ephox.powerpaste.legacy.data.Insert','ephox.powerpaste.legacy.tinymce.Settings','ephox.powerpaste.legacy.wordimport.WordImport','global!setTimeout'],function(I,S,W,s){return function(e,t){var c=function(f){var g=function(i){var j={content:f};e.fire('PastePreProcess',j);var k=S.create(i||e.settings.powerpaste_word_import,i||e.settings.powerpaste_html_import,true);var l=W.filter(j.content,k,e.getDoc());e.fire('PastePostProcess',l);e.undoManager.transact(function(){I.insert(l,e);});};var h=function(i){return i==='clean'||i==='merge';};var o=function(){var w;var i=function(){w.close();g('clean');};var m=function(){w.close();g('merge');};var j=[{text:t('cement.dialog.paste.clean'),onclick:i},{text:t('cement.dialog.paste.merge'),onclick:m}];var k={title:t('cement.dialog.paste.title'),spacing:10,padding:10,items:[{type:'container',html:t('cement.dialog.paste.instructions')}],buttons:j};w=e.windowManager.open(k);s(function(){if(w){w.getEl().focus();}},1);};if(W.isWordContent(f)&&!h(e.settings.powerpaste_word_import)){o();}else if(!h(e.settings.powerpaste_html_import)){o();}else{g();}};return{showDialog:c};};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.powerpaste.tinymce.LegacyPowerPaste',['ephox.powerpaste.i18n.I18n','ephox.powerpaste.legacy.tinymce.Clipboard','ephox.powerpaste.tinymce.LegacyTinyDialog'],function(I,c,L){return function(f,s){var t=this,o,g;var h=L(f,I.translate);var i=function(j){return function(e){j(e);};};o=c.getOnPasteFunction(f,h.showDialog);f.on('paste',i(o));g=c.getOnKeyDownFunction(f,h.showDialog);f.on('keydown',i(g));f.addCommand('mceInsertClipboardContent',function(u,e){h.showDialog(e.content||e);});if(f.settings.paste_preprocess){f.on('PastePreProcess',function(e){f.settings.paste_preprocess.call(t,t,e);});}};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.epithet.Id',[],function(){var u=0;var g=function(p){var c=new Date();var t=c.getTime();var e=Math.floor(Math.random()*1000000000);u++;return p+"_"+e+u+String(t);};return{generate:g};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.fred.core.DeviceType',['ephox.peanut.Fun'],function(c){return function(o,e,u){var i=o.isiOS()&&(u.search(/iPad/i)!==-1);var f=o.isiOS()&&!i;var g=o.isAndroid()&&(o.version.major===3);var h=o.isAndroid()&&(o.version.major===4);var j=i||g||(h&&u.search(/mobile/i)===-1);var k=(o.isiOS()||o.isAndroid());var l=k&&!j;return{isiPad:c.constant(i),isiPhone:c.constant(f),isTablet:c.constant(j),isPhone:c.constant(l),isTouch:c.constant(k),isAndroid:o.isAndroid,isiOS:o.isiOS};};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.fred.core.Platform',[],function(){var c=function(e,f,o){return{browser:{current:e,version:f},os:{current:o}};};return{create:c};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.fred.core.GetterHelper',[],function(){var g=function(v){return function(){return v;};};var c=function(s,e,o){for(var i=0;i<o.length;i++){s['is'+o[i].name]=g(o[i].name===e);}};return{getter:g,attachGetters:c};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.fred.core.Result',['ephox.fred.core.GetterHelper'],function(c){var e=function(o,f,v){var g=c.attachGetters;var h={};h.current=f;h.version=v;g(h,h.current,o);return h;};return{create:e};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.fred.core.SearchInfo',['ephox.violin.Strings'],function(V){var c=V.contains;var f=function(x){return function(u){return c(u,x);};};var g=function(){try{var i=new ActiveXObject('ChromeTab.ChromeFrame');return!!i;}catch(e){return false;}};var n=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/;var h=function(i){var e=[{name:'Spartan',versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(u){var m=c(u,'edge/')&&c(u,'chrome')&&c(u,'safari')&&c(u,'applewebkit');return m;}},{name:'ChromeFrame',versionRegexes:[/.*?chromeframe\/([0-9]+)\.([0-9]+).*/,n],search:function(u){return c(u,'chromeframe')?i():false;}},{name:'Chrome',versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,n],search:function(u){return c(u,'chrome')&&!c(u,'chromeframe');}},{name:'IE',versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(u){var j=(c(u,'msie')||c(u,'trident'));var k=c(u,'chromeframe');return k?j&&!i():j;}},{name:'Opera',versionRegexes:[n,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:f('opera')},{name:'Firefox',versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:f('firefox')},{name:'Safari',versionRegexes:[n],search:f('safari')},{name:'Envjs',versionRegexes:[/.*?envjs\/\ ?([0-9]+)\.([0-9]+).*/],search:f('envjs')}];var o=[{name:'Windows',search:f('win'),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:'iOS',search:function(u){return c(u,'iphone')||c(u,'ipad');},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:'Android',search:f('android'),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:'OSX',search:f('os x'),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:'Linux',search:f('linux')},{name:'Solaris',search:f('sunos')},{name:'FreeBSD',search:f('freebsd')}];return{browsers:e,oses:o};};return{create:h,chromeFrameChecker:g};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.fred.core.SpecTester',[],function(){var m=function(s,c){var t=typeof s;if(t==='boolean'){return!!s;}else if(t==='object'){var e=s.minimum;return c.major>e.major||(c.major===e.major&&c.minor>=e.minor);}throw('invalid spec');};return{meetsSpec:m};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.fred.core.Fn',[],function(){var f=function(c,t,p){for(var i=0;i<c.length;i++){var x=c[i];if(p(x,i,c))return x;}return t;};return{findOneInArrayOr:f};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.fred.core.UaStringDetector',['ephox.fred.core.Fn'],function(c){var e=function(s,u){var f=c.findOneInArrayOr;var g=String(u).toLowerCase();return f(s,{name:undefined},function(x){return x.search(g);});};return{detect:e};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,b,c){a('ephox.fred.core.VersionDetector',[],function(){var e=function(f,g){function h(r,s){for(var i=0;i<r.length;i++){var x=r[i];if(x.test(s))return x;}return undefined;}function j(l,g){var r=h(l,g);if(!r)return{major:0,minor:0};var m=function(i){return Number(g.replace(r,'$'+i));};return{major:m(1),minor:m(2)};}var k=String(g).toLowerCase();var v=f.versionRegexes;if(!v)return{major:0,minor:0};return j(v,k);};return{detectVersion:e};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.fred.PlatformDetection',['ephox.fred.core.DeviceType','ephox.fred.core.Platform','ephox.fred.core.Result','ephox.fred.core.SearchInfo','ephox.fred.core.SpecTester','ephox.fred.core.UaStringDetector','ephox.fred.core.VersionDetector'],function(c,P,R,S,e,U,V){var f=V.detectVersion;var m=R.create;var g=e.meetsSpec;var h=U.detect;var i=function(s,o,n,p){if(!!(s[o])){if(!!(s[o][n])){return g(s[o][n],p);}else{return!!(s[o]["All"]);}}else{return false;}};var j=function(n,p){var o=p.browser;var s=p.os;return i(n,s.current,o.current,o.version);};var k=function(u,n){var s=S.create(n);var o=s.browsers;var p=s.oses;var t=h(p,u);var v=t.name;var w=f(t,u);var x=h(o,u);var y=x.name;var I=f(x,u);var J=m(p,v,w);var K=m(o,y,I);var L=c(J,K,u);var M=function(N){return i(N,v,y,I);};return{browser:K,os:J,deviceType:L,isSupported:M};};var l=function(){return k(navigator.userAgent,S.chromeFrameChecker);};return{Platform:P,detect:l,doDetect:k,isSupported:i,isSupportedPlatform:j};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.knoch.core.Bounce',['global!Array'],function(c){var e=function(f){return function(){var g=c.prototype.slice.call(arguments);var m=this;setTimeout(function(){f.apply(m,g);},0);};};return{bounce:e};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(b,r,c){b('ephox.knoch.core.FutureOps',[],function(){return function(n,g){var m=function(h){return n(function(i){g(function(a){var v=h(a);i(v);});});};var e=function(h){return n(function(i){g(function(a){h(a).get(i);});});};var f=function(h){return n(function(i){g(function(a){h.get(i);});});};return{get:g,map:m,bind:e,anonBind:f};};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(e,h,j){e('ephox.knoch.core.FutureStaticOps',['ephox.compass.Arr'],function(k){return function(n){var p=function(a){return n(function(c){c(a);});};var l=function(f){return n(function(c){var r=[];var a=0;var b=function(i){return function(v){r[i]=v;a++;if(a>=f.length){c(r);}};};if(f.length===0){c([]);}else{k.each(f,function(g,i){g.get(b(i));});}});};var m=function(a,f){return l(k.map(a,f));};var o=function(f,g,i){return n(function(r){var t=false;var u=false;var v=undefined;var w=undefined;var x=function(){if(t&&u){var c=i(v,w);r(c);}};f.get(function(a){v=a;t=true;x();});g.get(function(b){w=b;u=true;x();});});};var s=function(f,g){return function(a){return g(a).bind(f);};};return{nu:n,pure:p,par:l,mapM:m,lift2:o,compose:s};};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.knoch.future.Future',['ephox.knoch.core.Bounce','ephox.knoch.core.FutureOps','ephox.knoch.core.FutureStaticOps'],function(c,e,f){var n=function(g){var h=function(i){g(c.bounce(i));};return e(n,h);};return f(n);});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.numerosity.api.FileReader',['ephox.numerosity.core.Global'],function(c){return function(){var f=c.getOrDie('FileReader');return new f();};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,c){a('ephox.hermes.utils.ImageExtract',['ephox.compass.Arr','ephox.epithet.Id','ephox.fred.PlatformDetection','ephox.hermes.api.ImageAsset','ephox.knoch.future.Future','ephox.numerosity.api.FileReader','ephox.numerosity.api.URL','ephox.scullion.Struct'],function(f,I,P,g,h,i,U,S){var j=S.immutable('id','obj','objurl');var k=S.immutable('blob','base64');var l=function(b){return j(I.generate('image'),b,U.createObjectURL(b));};var p=P.detect();var m=function(J,K,L){if(J.length===0){L([]);return;}var M=[];var N=function(b){M.push(b);};var O=function(l){return h.nu(function(L){var b=i();b.onload=function(e){L(k(l,e.target));};b.readAsDataURL(l);});};h.mapM(J,function(l){return K(l).bind(O);}).get(function(e){f.each(e,function(k){var b=l(k.blob());var Q=g.blob(b.id(),k.blob(),b.objurl(),k.base64());N(Q);});L(M);});};var t=function(b,e,J){m(b,e,J);};var n=function(e){return e.raw().target.files||e.raw().dataTransfer.files;};var o=function(b){return b.length===1&&f.contains(b,'Files');};var s=function(b){return!f.contains(b,'text/_moz_htmlcontext');};var u=function(b){return f.contains(b,'Files');};var v=function(b){return true;};var w=function(){if(p.browser.isChrome()||p.browser.isSafari()||p.browser.isOpera()){return u;}else if(p.browser.isFirefox()){return s;}else if(p.browser.isIE()){return o;}return v;};var x=w();var y=function(b,e,J){h.mapM(b,function(K){return e(K).map(function(L){var M=I.generate('image');return g.url(M,L.src,L);});}).get(J);};return{blob:l,toAssets:t,toFiles:n,isFiles:x,fromImages:y,fromBlobs:m};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.hermes.api.ImageExtract',['ephox.hermes.utils.ImageExtract'],function(I){var t=function(c,p,e){return I.toAssets(c,p,e);};var f=function(c,p,e){return I.fromBlobs(c,p,e);};return{toAssets:t,fromBlobs:f,blob:I.blob};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.powerpaste.tinymce.ModernPowerDrop',['ephox.compass.Arr','ephox.hermes.api.ImageAsset','ephox.hermes.api.ImageExtract','ephox.sugar.api.Attr','ephox.sugar.api.Element','global!tinymce'],function(c,I,f,g,h,t){return function(i,u,s,j){var k,l=/^image\/(jpe?g|png|gif|bmp)$/i;i.on('dragstart dragend',function(e){k=e.type==='dragstart';});i.on('dragover dragend dragleave',function(e){e.preventDefault();});var m=function(e){var o=e.target.files||e.dataTransfer.files;return c.filter(o,function(v){return l.test(v.type);});};var n=function(e){return c.map(e,function(o){var v=h.fromTag('img');var w=I.cata(o,j.getLocalURL,function(x,u,y){return u;});g.set(v,'src',w);return v.dom().outerHTML;}).join('');};var p=function(e){f.toAssets(e,function(o){var v=n(o);i.insertContent(v,{merge:i.settings.paste_merge_formats!==false});j.uploadImages(o);});};i.on('drop',function(e){if(!k){if(t.dom.RangeUtils&&t.dom.RangeUtils.getCaretRangeFromPoint){var o=t.dom.RangeUtils.getCaretRangeFromPoint(e.clientX,e.clientY,i.getDoc());if(o)i.selection.setRng(o);}var v=m(e);if(v.length>0)p(v);e.preventDefault();}});};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,b,c){a('ephox.cement.api.Bundle',['ephox.compass.Arr','ephox.scullion.Struct','global!console'],function(e,S,f){var g=['officeStyles','htmlStyles','isWord','proxyBin','isInternal'];var m=function(o,h){var r={};e.each(g,function(i){var j=h[i]().or(o[i]());j.each(function(v){r[i]=v;});});return n(r);};var n=S.immutableBag([],g);return{nu:n,merge:m};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.cement.smartpaste.PasteResponse',['ephox.perhaps.Option','ephox.scullion.ADT'],function(O,c){var e=c.generate([{'error':['message']},{'paste':['elements','assets']},{'cancel':[]},{'incomplete':['elements','assets','message']}]);var f=function(s,o,h,i,j){return s.fold(o,h,i,j);};var g=function(d,n){return f(d,O.none,O.none,O.none,function(h,i,m){return f(n,O.none,function(j,k){return O.some(e.incomplete(j,k,m));},O.none,O.none);}).getOr(n);};return{error:e.error,paste:e.paste,cancel:e.cancel,incomplete:e.incomplete,cata:f,carry:g};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.cement.alien.FutureStep',['ephox.cement.api.Bundle','ephox.cement.smartpaste.PasteResponse','ephox.knoch.core.FutureOps','ephox.scullion.Struct'],function(c,P,e,S){var f=S.immutableBag(['response','bundle'],[]);var p=function(v){return s(function(l){var m=f(v);l(m);});};var g=function(l,v){l(f(v));};var h=function(l){return p({response:l.response(),bundle:l.bundle()});};var i=function(l){return p({response:P.error(l),bundle:c.nu({})});};var j=function(){return p({response:P.cancel(),bundle:c.nu({})});};var k=function(){return p({response:P.paste([],[]),bundle:c.nu({})});};var s=function(l){var m=function(n){l(n);};return e(s,m);};return{call:g,sync:s,pure:p,pass:h,done:f,error:i,initial:k,cancel:j};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,b,c){a('ephox.perhaps.Options',['ephox.perhaps.Option'],function(O){var e=function(f){var r=[];var p=function(x){r.push(x);};for(var i=0;i<f.length;i++){f[i].each(p);}return r;};var g=function(h,f){for(var i=0;i<h.length;i++){var r=f(h[i],i);if(r.isSome()){return r;}}return O.none();};var l=function(h,f){var r=[];for(var i=0;i<h.length;i++){var x=h[i];if(x.isSome()){r.push(x.getOrDie());}else{return O.none();}};return O.some(f.apply(null,r));};return{cat:e,findMap:g,liftN:l};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);E.bolt.module.api.define("global!RegExp",[],function(){return RegExp;});(function(a,r,b){a('ephox.cement.smartpaste.Inspection',['ephox.perhaps.Option','ephox.perhaps.Options','global!RegExp'],function(O,c,R){var i=function(f){return f!==undefined&&f.types!==undefined&&f.types!==null;};var g=function(f,t){return c.findMap(f,function(p){return e(t,p);});};var e=function(f,h){var p=new R(h,'i');return c.findMap(f,function(t){return t.match(p)!==null?O.some({type:t,flavor:h}):O.none();});};return{isValidData:i,getPreferredFlavor:g,getFlavor:e};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.cement.api.Adjudicator',['ephox.cement.alien.FutureStep','ephox.cement.api.Bundle','ephox.cement.smartpaste.Inspection','ephox.cement.smartpaste.PasteResponse','ephox.compass.Arr','ephox.peanut.Fun','ephox.perhaps.Option','ephox.perhaps.Options','ephox.scullion.Struct'],function(c,e,I,P,g,h,O,i,S){var t=S.immutable('steps','input','label','capture');var j=function(f,m){return i.findMap(f,function(n){return n.getAvailable(m).map(function(o){return t(n.steps(),o,n.label(),n.capture());});});};var k=function(f,m,n){var o=j(f,n);return o.getOrThunk(function(){return t(m.steps(),n,m.label(),m.capture());});};var p=function(o,f){var m=h.curry(c.pass,o);var n=function(){return f().map(function(s){var u=e.merge(o.bundle(),s.bundle());var v=P.carry(o.response(),s.response());return c.done({response:v,bundle:u});});};return P.cata(o.response(),m,n,m,n);};var l=function(s,f){var o=g.foldl(s,function(m,n){return m.bind(function(u){var v=function(){return n(f,u);};return p(u,v);});},c.initial());return o.map(function(m){return m.response();});};return{choose:k,run:l};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.plumber.tap.control.BlockControl',[],function(){var c=function(){var e=false;var i=function(){return e;};var f=function(){e=true;};var u=function(){e=false;};return{isBlocked:i,block:f,unblock:u}};return{create:c};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.plumber.tap.wrap.Tapped',[],function(){var c=function(e,i){return{control:e,instance:i}};return{create:c};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.plumber.tap.function.BlockTap',['ephox.plumber.tap.control.BlockControl','ephox.plumber.tap.wrap.Tapped'],function(c,T){var t=function(f){var e=c.create();var i=function(){if(!e.isBlocked())f.apply(null,arguments);};return T.create(e,i);};return{tap:t};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.sloth.api.Paste',['ephox.fred.PlatformDetection','ephox.peanut.Fun','global!setTimeout'],function(P,c,s){var e=P.detect();var i=function(h,t,p){t.control.block();h.dom().execCommand('paste');p();t.control.unblock();};var o=function(h,t,p){s(p,1);};var w=e.browser.isIE()&&e.browser.version.major<=10;var f=w?i:o;var g=function(h,t,p){return f(h,t,p);};return{willBlock:c.constant(w),run:g};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.cement.api.PasteBroker',['ephox.cement.api.Adjudicator','ephox.cement.smartpaste.PasteResponse','ephox.compass.Arr','ephox.peanut.Fun','ephox.plumber.tap.function.BlockTap','ephox.porkbun.Event','ephox.porkbun.Events','ephox.sloth.api.Paste'],function(c,P,e,f,g,h,i,j){return function(k,l){var m=i.create({cancel:h([]),error:h(['message']),insert:h(['elements','assets'])});var p=g.tap(function(n){if(j.willBlock()){p.control.block();n.preventDefault();}var o=c.choose(k,l,n);if(o.capture())n.preventDefault();var s=e.map(o.steps(),function(u){return u(p.control);});var t=c.run(s,o.input());t.get(function(u){P.cata(u,function(v){m.trigger.error(v);},function(v,w){m.trigger.insert(v,w);},function(){m.trigger.cancel();},function(v,w,x){m.trigger.insert(v,w);m.trigger.error(x);});});});return{paste:p.instance,isBlocked:p.control.isBlocked,destroy:f.noop,events:m.registry};};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.cement.api.PasteProcesses',['ephox.peanut.Fun'],function(c){var e=function(p){return function(f){return function(g,i,h){f.block();return p(g,i,h).map(function(j){f.unblock();return j;});};};};var n=function(p){return c.constant(p);};return{blocking:e,normal:n};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.bowerbird.api.BlobResult',['ephox.highway.Merger','ephox.scullion.ADT'],function(M,c){var e=c.generate([{none:[]},{error:['message ']},{blob:['blob']}]);var f=function(g,n,h,i){return g.fold(n,h,i);};return M.merge(e,{cata:f});});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.numerosity.api.Blob',['ephox.numerosity.core.Global'],function(c){return function(p,e){var f=c.getOrDie('Blob');return new f(p,e);};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.numerosity.api.Uint8Array',['ephox.numerosity.core.Global'],function(c){return function(e){var f=c.getOrDie('Uint8Array');return new f(e);};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.numerosity.api.Window',['ephox.numerosity.core.Global'],function(c){var e=function(h){var f=c.getOrDie('requestAnimationFrame');f(h);};var g=function(h){var f=c.getOrDie('atob');return f(h);};return{atob:g,requestAnimationFrame:e};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,b,c){a('ephox.bowerbird.codes.Base64ToBlob',['ephox.bowerbird.api.BlobResult','ephox.numerosity.api.Blob','ephox.numerosity.api.Uint8Array','ephox.numerosity.api.Window','ephox.perhaps.Option','ephox.perhaps.Result','ephox.violin.Strings','global!Array','global!Math'],function(f,g,U,W,O,R,S,h,M){var t=function(e,m){var s=1024;var l=W.atob(e);var n=l.length;var o=M.ceil(n/s);var p=new h(o);for(var r=0;r<o;++r){var u=r*s;var v=M.min(u+s,n);var w=new h(v-u);for(var x=u,i=0;x<v;++i,++x){w[i]=l[x].charCodeAt(0);}p[r]=U(w);}return g(p,{type:m});};var j=function(r){return S.startsWith(r,'data:image/')&&r.indexOf(';base64,')>'data:image/'.length;};var k=function(i){if(!j(i)){return f.none();}else{var l=i.indexOf(';');var m=i.substr('data:'.length,l-'data:'.length);var n=i.substr(l+';base64,'.length);try{var r=f.blob(t(n,m));return r;}catch(e){return f.error(e);}}};return{convert:k};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.bowerbird.api.Base64',['ephox.bowerbird.codes.Base64ToBlob'],function(c){var t=function(s){return c.convert(s);};return{toBlob:t};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,c){a('ephox.cement.step.Base64Step',['ephox.bowerbird.api.Base64','ephox.bowerbird.api.BlobResult','ephox.cement.alien.FutureStep','ephox.cement.smartpaste.PasteResponse','ephox.compass.Arr','ephox.hermes.api.ImageAsset','ephox.hermes.api.ImageExtract','ephox.peanut.Fun','ephox.perhaps.Option','ephox.scullion.Struct','ephox.sugar.api.Attr','ephox.sugar.api.Element','ephox.sugar.api.InsertAll','ephox.sugar.api.SelectorFilter'],function(e,f,g,P,h,I,j,k,O,S,l,m,n,o){var p=S.immutable('blob','image');var t=function(i,s){var x=e.toBlob(s);return f.cata(x,O.none,O.none,function(b){return O.some(p(b,i));});};var u=function(s){return s.indexOf('data:image')-1&&s.indexOf('base64')>-1;};var v=function(b){var i=m.fromTag('div');n.append(i,b);var s=o.descendants(i,'img[src]');return h.bind(s,function(x){var y=l.get(x,'src');return u(y)?t(x,y).toArray():[];});};var w=function(s,b){h.each(b,function(x,i){I.cata(x,function(y,J,K,L){var M=s[i].image();l.set(M,'src',K);},k.noop);});};return function(b){return function(i,x){return g.sync(function(y){var J=function(){g.call(y,{response:x.response(),bundle:x.bundle()});};var K=function(M){var N=v(M);var Q=h.map(N,function(s){return s.blob();});j.fromBlobs(Q,b,function(s){w(N,s);g.call(y,{response:P.paste(M,s),bundle:x.bundle()});});};var L=function(s,M,_){return M.length===0?K(s):J();};P.cata(x.response(),J,L,J,L);});};};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);E.bolt.module.api.define("global!parseInt",[],function(){return parseInt;});(function(a,r,b){a('ephox.bowerbird.codes.HexToBlob',['ephox.numerosity.api.Blob','ephox.numerosity.api.Uint8Array','global!Array','global!Math','global!String','global!parseInt'],function(c,U,e,M,S,p){var t=function(g){var j=new e(g.length/2);for(var i=0;i<g.length;i+=2){var h=g.substr(i,2);var k=M.floor(i/2);j[k]=p(h,16);}return j;};var f=function(i,g){if(i.length===0)throw'Zero length content passed to Hex conversion';var h=t(i);var j=U(h);return c([j],{type:g});};return{convert:f};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.bowerbird.core.RtfSupport',['ephox.scullion.ADT'],function(c){var e=c.generate([{'unsupported':['id','message']},{'supported':['id','contentType','blob']}]);var f=function(i,u,s){return i.fold(u,s);};return{unsupported:e.unsupported,supported:e.supported,cata:f};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.bowerbird.core.Species',['ephox.peanut.Fun','ephox.perhaps.Option'],function(c,O){var P='{\\pict{';var e='i';var S='{\\shp{';var f='s';var g=function(m,l,n){return l.indexOf(m,n);};var h=function(l,m,n,o,t){if(l===-1||m===-1)return O.none();else return O.some({start:c.constant(l),end:c.constant(m),bower:n,regex:c.constant(o),idRef:c.constant(t)});};var i=function(l,m,n){return function(){return l.substring(m,n);};};var j=function(l,m){if(m===-1)return m;var n=0;var o=l.length;var t,u;do{t=l.indexOf('{',m);u=l.indexOf('}',m);if(u>t&&t!==-1){m=t+1;++n;}else if((t>u||t<0)&&u!==-1){m=u+1;--n;}if(m>o||u===-1)return-1;}while(n>0);return m;};var p=function(l,m,n,o){var t=i(l,n,o);var u=/[^a-fA-F0-9]([a-fA-F0-9]+)\}$/;return h(n,o,t,u,e);};var s=function(l,m,n,o){var t=i(l,n,o);var u=/([a-fA-F0-9]{64,})(?:\}.*)/;return h(n,o,t,u,f);};var k=function(l,m){var n=g(P,l,m);var o=j(l,n);var t=g(S,l,m);var u=j(l,t);var v=c.curry(s,l,m,t,u);var w=c.curry(p,l,m,n,o);if(n===-1&&t===-1)return O.none();else if(n===-1)return v();else if(t===-1)return w();else if(t<n&&u>o)return w();else if(n<t&&o>u)return v();else if(n<t)return w();else if(t<n)return v();else return O.none();};return{identify:k,endBracket:j};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.bowerbird.core.Rtf',['ephox.bowerbird.codes.HexToBlob','ephox.bowerbird.core.RtfSupport','ephox.bowerbird.core.Species','ephox.perhaps.Option','ephox.perhaps.Result'],function(c,R,S,O,e){var n=function(s,o){return S.identify(s,o);};var f=function(p){if(p.indexOf('\\pngblip')>=0)return e.value('image/png');else if(p.indexOf('\\jpegblip')>=0)return e.value('image/jpeg');else return e.error('errors.imageimport.unsupported');};var i=function(s){return s.length%2===0;};var g=function(s){return s.replace(/\r/g,'').replace(/\n/g,'');};var h=function(o,p){var s=o.match(p);return s&&s[1]&&s[1].length%2===0?e.value(s[1]):e.error('errors.imageimport.invalid');};var j=function(p){var o=p.match(/\\shplid(\d+)/);return o!==null?O.some(o[1]):O.none();};var k=function(o){var p=o.bower();var s=o.regex();return j(p).map(function(t){var u=o.idRef()+t;return f(p).fold(function(v){return R.unsupported(u,v);},function(v){return h(p,s).fold(function(w){return R.unsupported(u,w);},function(w){return R.supported(u,v,c.convert(w,v));});});});};var l=function(o){var m=[];var p=function(){return o.length;};var s=function(u){var v=k(u);m=m.concat(v.toArray());return u.end()+1;};var t=0;while(t<o.length){t=n(o,t).fold(p,s);}return m;};var m=function(o){var p=g(o);return l(p);};return{nextBower:n,extractId:j,extractContentType:f,extractHex:h,images:m};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.bowerbird.api.Rtf',['ephox.bowerbird.core.Rtf','ephox.bowerbird.core.RtfSupport','ephox.perhaps.Result'],function(R,c,e){var i=function(g){return R.images(g);};var t=function(g){return c.cata(g,function(h,_){return h;},function(h,_,j){return h;});};var f=function(g){return c.cata(g,function(_,m){return e.error(m);},function(_,h,j){return e.value(j);});};return{images:i,toId:t,toBlob:f};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.cement.flash.Correlation',['ephox.bowerbird.api.Rtf','ephox.compass.Arr','ephox.hermes.api.ImageExtract','ephox.peanut.Fun','ephox.perhaps.Option','ephox.sugar.api.Attr','ephox.sugar.api.Class','global!console'],function(R,c,I,e,O,f,g,h){var j=function(i,o,_){var p=c.find(o,function(u){return R.toId(u)===i;});return O.from(p);};var k=function(i,u,o){return O.from(u[o]);};var l={local:k,code:j};var m=function(i){var u=[];var o=function(p){return!c.exists(u,function(s){return R.toId(s)===p;});};return c.bind(i,function(p){var s=R.toId(p);if(o(s)){u.push(p);return[p];}else{return[];}});};var n=function(o,p,s,t,u){var v=m(p);var w=[];var x=false;var y=c.bind(o,function(J,i){var K=f.get(J,'data-image-type');var L=f.get(J,'data-image-id');g.remove(J,'rtf-data-image');f.remove(J,'data-image-type');f.remove(J,'data-image-id');var M=l[K]!==undefined?l[K]:O.none;return M(L,v,i).fold(function(){h.log('WARNING: unable to find data for image ',J.dom());return[];},function(N){return R.toBlob(N).fold(function(P){f.set(J,'alt',u(P));x=true;return[];},function(P){w.push(J);return[P];});});});I.fromBlobs(y,s,function(J){c.each(J,function(K,i){K.fold(function(L,M,N,P){var Q=w[i];f.set(Q,'src',N);},e.noop);});t(J,x);});};return{convert:n};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);E.bolt.module.api.define("global!window",[],function(){return window;});(function(a,b,c){a('ephox.sugar.api.Css',['ephox.classify.Type','ephox.compass.Arr','ephox.compass.Obj','ephox.perhaps.Option','ephox.sugar.api.Attr','ephox.sugar.api.Body','ephox.sugar.api.Element','ephox.sugar.api.Node','ephox.violin.Strings','global!Error','global!console','global!window'],function(T,g,O,h,i,j,l,N,S,m,n,w){var o=function(e,f,v){if(!T.isString(v)){n.error('Invalid call to CSS.set. Property ',f,':: Value ',v,':: Element ',e);throw new m('CSS value must be a string: '+v);}e.style.setProperty(f,v);};var s=function(e,f,v){var k=e.dom();o(k,f,v);};var p=function(e,f){var r=e.dom();O.each(f,function(v,k){o(r,k,v);});};var t=function(e,f){var k=e.dom();var Q=w.getComputedStyle(k);var r=Q.getPropertyValue(f);var v=(r===''&&!j.inBody(e))?u(k,f):r;return v===null?undefined:v;};var u=function(e,f){return e.style.getPropertyValue(f);};var x=function(e,f){var k=e.dom();var v=u(k,f);return h.from(v).filter(function(r){return r.length>0;});};var y=function(e,f,v){var k=l.fromTag(e);s(k,f,v);var r=x(k,f);return r.isSome();};var I=function(e,f){var k=e.dom();k.style.removeProperty(f);if(i.has(e,'style')&&S.trim(i.get(e,'style'))===''){i.remove(e,'style');}};var J=function(e,f){var k=i.get(e,'style');var r=f(e);var v=k===undefined?i.remove:i.set;v(e,'style',k);return r;};var K=function(e,f){f.dom().style.cssText=e.dom().style.cssText;};var L=function(e){return e.dom().offsetWidth;};var M=function(e,f,k){x(e,k).each(function(v){if(x(f,k).isNone())s(f,k,v);});};var P=function(e,f,k){if(!N.isElement(e)||!N.isElement(f))return;g.each(k,function(r){M(e,f,r);});};return{copy:K,set:s,preserve:J,setAll:p,remove:I,get:t,getRaw:x,isValidValue:y,reflow:L,transfer:P};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.sugar.api.PredicateFind',['ephox.classify.Type','ephox.compass.Arr','ephox.peanut.Fun','ephox.perhaps.Option','ephox.sugar.api.Body','ephox.sugar.api.Compare','ephox.sugar.api.Element','ephox.sugar.impl.ClosestOrAncestor'],function(T,c,e,O,f,g,h,j){var k=function(p){return o(f.body(),p);};var l=function(i,p,t){var u=i.dom();var v=T.isFunction(t)?t:e.constant(false);while(u.parentNode){u=u.parentNode;var w=h.fromDom(u);if(p(w))return O.some(w);else if(v(w))break;}return O.none();};var m=function(i,p,t){var u=function(i){return p(i);};return j(u,l,i,p,t);};var s=function(i,p){var t=i.dom();if(!t.parentNode)return O.none();return n(h.fromDom(t.parentNode),function(x){return!g.eq(i,x)&&p(x);});};var n=function(i,p){var t=c.find(i.dom().childNodes,e.compose(p,h.fromDom));return O.from(t).map(h.fromDom);};var o=function(p,t){var u=function(v){for(var i=0;i<v.childNodes.length;i++){if(t(h.fromDom(v.childNodes[i])))return O.some(h.fromDom(v.childNodes[i]));var w=u(v.childNodes[i]);if(w.isSome())return w;}return O.none();};return u(p.dom());};return{first:k,ancestor:l,closest:m,sibling:s,child:n,descendant:o};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.sugar.api.Replication',['ephox.sugar.api.Attr','ephox.sugar.api.Element','ephox.sugar.api.Insert','ephox.sugar.api.InsertAll','ephox.sugar.api.Remove','ephox.sugar.api.Traverse'],function(c,e,I,f,R,T){var g=function(o,h){return e.fromDom(o.dom().cloneNode(h));};var s=function(o){return g(o,false);};var h=function(o){return g(o,true);};var i=function(o,t){var n=e.fromTag(t);var k=c.clone(o);c.setAll(n,k);return n;};var j=function(o,t){var n=i(o,t);var k=T.children(h(o));f.append(n,k);return n;};var m=function(o,t){var n=i(o,t);I.before(o,n);var k=T.children(o);f.append(n,k);R.remove(o);return n;};return{shallow:s,shallowAs:i,deep:h,copy:j,mutate:m};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.limbo.api.RtfImage',['ephox.perhaps.Option','ephox.sugar.api.Attr','ephox.sugar.api.Class','ephox.sugar.api.Css','ephox.sugar.api.Element','ephox.sugar.api.Node','ephox.sugar.api.PredicateFind','ephox.sugar.api.Replication','ephox.sugar.api.SelectorFilter','ephox.violin.Strings'],function(O,c,e,f,g,N,P,R,S,h){var s=function(m,n){var o=N.value(m);var p=g.fromTag('div');var t=o.indexOf(']>');p.dom().innerHTML=o.substr(t+']>'.length);return P.descendant(p,function(u){return N.name(u)===n;});};var i=function(t){return N.isComment(t)?s(t,'v:shape'):O.none();};var v=function(o){return i(o).map(function(m){var n=c.get(m,'o:spid');var p=n===undefined?c.get(m,'id'):n;var t=g.fromTag('img');e.add(t,'rtf-data-image');c.set(t,'data-image-id',p.substr('_x0000_'.length));c.set(t,'data-image-type','code');f.setAll(t,{width:f.get(m,'width'),height:f.get(m,'height')});return t;});};var l=function(o){if(N.name(o)==='img'){var m=c.get(o,'src');if(m!==undefined&&m!==null&&h.startsWith(m,'file://')){var n=R.shallow(o);var p=m.split(/[\/\\]/);var t=p[p.length-1];c.set(n,'data-image-id',t);c.remove(n,'src');c.set(n,'data-image-type','local');e.add(n,'rtf-data-image');return O.some(n);}else{return O.none();}}else{return O.none();}};var j=function(m){return k(m).length>0;};var k=function(m){return S.descendants(m,'.rtf-data-image');};return{local:l,vshape:v,find:k,exists:j,scour:i};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.cement.flash.Flash',['ephox.bowerbird.api.Rtf','ephox.cement.flash.Correlation','ephox.compass.Arr','ephox.limbo.api.RtfImage','ephox.porkbun.Event','ephox.porkbun.Events','ephox.sugar.api.Remove','ephox.sugar.api.Traverse'],function(R,c,e,f,g,h,i,T){return function(m,j){var t=j.translations;var k=h.create({error:g(['message']),insert:g(['elements','assets']),incomplete:g(['elements','assets','message'])});var l=function(n,o){var p=function(x){var y=x.hide();var I=R.images(x.rtf());var J=f.find(n);var K=j.preprocessor;c.convert(J,I,K,function(L,M){if(M){k.trigger.incomplete(T.children(n),L.concat(o),'errors.imageimport.failed');}else{k.trigger.insert(T.children(n),L.concat(o));}y();},t);};var s=function(x){var y=f.find(n);e.each(y,i.remove);k.trigger.incomplete(T.children(n),o,x);};var u=function(){var x=f.find(n);e.each(x,i.remove);k.trigger.insert(T.children(n),o);};var v=function(x){s(x.message());};if(j.allowLocalImages===true&&j.enableFlashImport===true){var w=m(j);w.events.response.bind(p);w.events.cancel.bind(u);w.events.failed.bind(v);w.events.error.bind(v);w.open();}else{s('errors.local.images.disallowed');}};return{events:k.registry,gordon:l};};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.scullion.Cell',[],function(){var c=function(i){var e=i;var g=function(){return e;};var s=function(v){e=v;};var f=function(){return c(g());};return{get:g,set:s,clone:f};};return c;});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.cement.step.FlashStep',['ephox.cement.alien.FutureStep','ephox.cement.api.Bundle','ephox.cement.flash.Flash','ephox.cement.smartpaste.PasteResponse','ephox.limbo.api.RtfImage','ephox.perhaps.Option','ephox.scullion.Cell','ephox.sugar.api.Element','ephox.sugar.api.InsertAll'],function(c,e,f,P,R,O,g,h,I){return function(m,i){var j=f(m,i);var k=g(O.none());var l=function(n){k.get().each(function(o){c.call(o,{response:n,bundle:e.nu({})});});};j.events.insert.bind(function(n){l(P.paste(n.elements(),n.assets()));});j.events.incomplete.bind(function(n){l(P.incomplete(n.elements(),n.assets(),n.message()));});j.events.error.bind(function(n){var o=n.message();var p=P.error(o);l(p);});return function(n,o){return c.sync(function(p){var s=function(){c.call(p,{response:o.response(),bundle:o.bundle()});};var t=function(u,v){k.set(O.some(p));var w=h.fromTag('div');I.append(w,u);if(R.exists(w))j.gordon(w,v);else s();};P.cata(o.response(),s,t,s,t);});};};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.cement.api.Bundles',['ephox.cement.alien.FutureStep','ephox.cement.smartpaste.PasteResponse','global!console'],function(c,P,e){var p=function(k){var l=function(n,f){return k.proxyBin().fold(function(){e.error(n);return c.pure({response:P.cancel(),bundle:{}});},f);};return{handle:l};};var m=function(f){var w=i(f);return(w&&g(f))||(!w&&h(f));};var g=function(f){return f.officeStyles().getOr(true);};var h=function(f){return f.htmlStyles().getOr(false);};var i=function(f){return f.isWord().getOr(false);};var j=function(f){return f.isInternal().getOr(false);};return{proxyBin:p,merging:m,mergeOffice:g,mergeNormal:h,isWord:i,isInternal:j};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.cement.style.Styles',['ephox.flour.style.Resolver'],function(R){var s=R.create('ephox-cement');return{resolve:s.resolve};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.cement.smartpaste.MergeSettings',['ephox.cement.style.Styles','ephox.highway.Merger','ephox.peanut.Fun','ephox.perhaps.Option','ephox.sugar.api.Class','ephox.sugar.api.Element','ephox.sugar.api.Insert'],function(S,M,c,O,e,f,I){return function(g,s){var t=s.translations;var h=function(v,s,k){k(O.some(M.merge(s,{officeStyles:v,htmlStyles:v})));};var i=function(s,k){var l=function(){w();h(false,s,k);};var m=function(){w();h(true,s,k);};var n=f.fromTag('div');e.add(n,S.resolve('styles-dialog-content'));var o=f.fromTag('p');var p=f.fromText(t('cement.dialog.paste.instructions'));I.append(o,p);I.append(n,o);var u={text:t('cement.dialog.paste.clean'),tabindex:0,className:S.resolve('clean-styles'),click:l};var v={text:t('cement.dialog.paste.merge'),tabindex:1,className:S.resolve('merge-styles'),click:m};var w=function(){y.destroy();};var x=function(){k(O.none());w();};var y=g(true);y.setTitle(t('cement.dialog.paste.title'));y.setContent(n);y.setButtons([u,v]);y.show();y.events.close.bind(x);};var j=function(o,k){var l=o?'officeStyles':'htmlStyles';var m=s[l];if(m==='clean'){h(false,s,k);}else if(m==='merge'){h(true,s,k);}else{i(s,k);}};return{get:j,destroy:c.noop};};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.cement.step.MergeStep',['ephox.cement.alien.FutureStep','ephox.cement.api.Bundle','ephox.cement.api.Bundles','ephox.cement.smartpaste.MergeSettings','ephox.cement.smartpaste.PasteResponse'],function(c,e,f,M,P){var g=function(j,k){var m=M(j,k);return function(l,n){var o=n.bundle();var p=n.response();return c.sync(function(s){m.get(f.isWord(o),function(t){var v=t.fold(function(){return{response:P.cancel(),bundle:n.bundle()};},function(u){return{response:p,bundle:e.nu({officeStyles:u.officeStyles,htmlStyles:u.htmlStyles})};});c.call(s,v);});});};};var h=function(j,k){return function(l,m){if(f.isInternal(m.bundle())){return c.pure({response:m.response(),bundle:e.nu({officeStyles:true,htmlStyles:true})});}else return g(j,k)(l,m);};};var i=function(o,j){return function(k,l){return c.pure({response:l.response(),bundle:e.nu({officeStyles:o,htmlStyles:j})});};};return{fixed:i,fromConfig:g,fromConfigIfExternal:h};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.sugar.api.Comments',['ephox.fred.PlatformDetection','ephox.peanut.Fun','ephox.sugar.api.Element','global!document'],function(P,c,f,g){var h=function(t){var e=[];while(t.nextNode()!==null)e.push(f.fromDom(t.currentNode));return e;};var i=function(t){try{return h(t);}catch(e){return[];}};var j=P.detect().browser;var k=j.isIE()||j.isSpartan()?i:h;var n=c.constant(c.constant(true));var l=function(e,m){var v=m.fold(n,function(o){return function(p){return o(p.nodeValue);};});v.acceptNode=v;var t=g.createTreeWalker(e.dom(),NodeFilter.SHOW_COMMENT,v,false);return k(t);};return{find:l};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.cement.alien.Comments',['ephox.perhaps.Option','ephox.sugar.api.Comments','ephox.violin.Strings','global!document'],function(O,c,S,e){var f=function(n){return c.find(n,O.some(function(v){return S.startsWith(v,'[if gte vml 1]');}));};return{find:f};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.cement.html.ImageReference',['ephox.cement.alien.Comments','ephox.compass.Arr','ephox.limbo.api.RtfImage','ephox.perhaps.Option','ephox.perhaps.Options','ephox.scullion.Struct','ephox.sugar.api.Attr','ephox.sugar.api.Elements','ephox.sugar.api.SelectorFilter','global!console'],function(c,e,R,O,f,S,g,h,i,j){var k=S.immutable('img','vshape');var l=function(n){var u=o(n);u._rawElement=n.dom();return u;};var m=function(v){var n=o(v);n._rawElement=v.dom();return n;};var o=function(n){return g.clone(n);};var p=function(u){var v=h.fromHtml(u);var w=e.bind(v,function(n){return i.descendants(n,'img');});var x=e.bind(v,c.find);var y=f.cat(e.map(x,R.scour));var I=e.map(w,function(n){return t(n,y);});return f.cat(I);};var t=function(n,v){var u=g.get(n,'v:shapes');var w=O.from(e.find(v,function(x){return g.get(x,'id')===u;}));if(w.isNone())j.log('WARNING: unable to find data for image',n.dom());return w.map(function(x){return s(n,x);});};var s=function(n,v){return k(l(n),m(v));};return{extract:p};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,b,c){a('ephox.cement.html.VshapeCorrelation',['ephox.classify.Type','ephox.compass.Arr','ephox.peanut.Fun','ephox.perhaps.Option','ephox.sugar.api.Attr','ephox.sugar.api.Class'],function(T,e,f,O,g,h){var i=function(l,v){var s=v.style;if(g.has(l,'width')&&g.has(l,'height')&&T.isString(s)){var r=s.match(/rotation:([^;]*)/);if(r!==null&&(r[1]==='90'||r[1]==='-90')){g.setAll(l,{width:g.get(l,'height'),height:g.get(l,'width')});}}};var t=function(l,v){var s=v['o:spid'];var n=s===undefined?v.id:s;i(l,v);h.add(l,'rtf-data-image');g.set(l,'data-image-id',n.substr('_x0000_'.length));g.set(l,'data-image-type','code');};var m=function(l,n,o){return o.img()[l]===n;};var j=function(s,l,n){var o=g.get(l,n);var p=f.curry(m,n,o);var u=e.find(s,p);return O.from(u).map(function(r){g.remove(l,n);return r;});};var k=function(s,l,n){e.each(l,function(o){j(s,o,n).each(function(p){t(o,p.vshape());});});};return{rotateImage:i,insertRtfCorrelation:k};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.sugar.impl.NodeValue',['ephox.perhaps.Option','global!Error'],function(O,c){return function(i,n){var g=function(e){if(!i(e))throw new c('Can only get '+n+' value of a '+n+' node');return f(e).getOr('');};var f=function(h){try{return i(h)?O.some(h.dom().nodeValue):O.none();}catch(e){return O.none();}};var s=function(e,v){if(!i(e))throw new c('Can only set raw '+n+' value of a '+n+' node');e.dom().nodeValue=v;};return{get:g,getOption:f,set:s};};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.sugar.api.Comment',['ephox.sugar.api.Node','ephox.sugar.impl.NodeValue'],function(N,c){var e=c(N.isComment,'comment');var g=function(h){return e.get(h);};var f=function(h){return e.getOption(h);};var s=function(h,v){e.set(h,v);};return{get:g,getOption:f,set:s};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.vogue.css.Set',['ephox.sugar.api.Insert'],function(I){var s=function(c,e,f){if(c.dom().styleSheet)c.dom().styleSheet.cssText=e;else I.append(c,f);};return{setCss:s};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.vogue.util.Regex',[],function(){var e=function(t){return t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,'\\$&');};return{escape:e};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,b,c){a('ephox.vogue.css.Url',['ephox.compass.Obj','ephox.vogue.util.Regex','global!RegExp'],function(O,R,e){var f=function(h,u,i){var r=new e('url\\(\\s*[\'"]?'+R.escape(u)+'(.*?)[\'"]?\\s*\\)','g');return h.replace(r,'url("'+i+'$1")');};var g=function(h,r){var i=h;O.each(r,function(v,k){i=f(i,k,v);});return i;};return{replace:f,replaceMany:g};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.vogue.api.DocStyle',['ephox.sugar.api.Attr','ephox.sugar.api.Element','ephox.sugar.api.Insert','ephox.sugar.api.SelectorFind','ephox.vogue.css.Set','ephox.vogue.css.Url','global!Array'],function(c,e,I,S,f,U,g){var s=function(k){var l=e.fromTag('style',k.dom());c.set(l,'type','text/css');return l;};var h=function(k,l,m){f.setCss(k,l,e.fromText(l,m.dom()));};var i=function(k,l,m){var n=s(m);var o=l===undefined?k:U.replaceMany(k,l);h(n,o,m);var p=S.descendant(m,'head').getOrDie();I.append(p,n);};var j=function(k){var l=k.dom().styleSheets;return g.prototype.slice.call(l);};return{stylesheets:j,inject:i};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.vogue.css.Rules',['ephox.compass.Arr','ephox.scullion.Struct'],function(c,S){var e=S.immutable('selector','style','raw');var f=function(s){var h=s.cssRules;return c.map(h,function(i){var j=i.selectorText;var k=i.style.cssText;if(k===undefined){throw"WARNING: Browser does not support cssText property";}return e(j,k,i.style);});};var g=function(s){return c.bind(s,f);};return{extract:f,extractAll:g};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.vogue.api.Rules',['ephox.vogue.css.Rules'],function(R){var e=function(s){return R.extract(s);};var c=function(s){return R.extractAll(s);};return{extract:e,extractAll:c};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.cement.html.TordPostprocess',['ephox.cement.html.VshapeCorrelation','ephox.compass.Arr','ephox.peanut.Fun','ephox.sugar.api.Attr','ephox.sugar.api.Comment','ephox.sugar.api.Css','ephox.sugar.api.Remove','ephox.sugar.api.SelectorFilter','ephox.sugar.api.Traverse','ephox.vogue.api.DocStyle','ephox.vogue.api.Rules'],function(V,e,f,g,h,i,R,S,T,j,k){var p=function(c,t,u,v,w){var x=S.descendants(t,'img');s(t);V.insertRtfCorrelation(u,x,v);var y=w.mergeInline()?o:n;y(c,t);};var n=f.noop;var l=function(c){var t={};e.each(c,function(u){if(c[u]!==undefined)t[u]=c[u];});return t;};var m=function(c,t){var u=e.bind(t,function(v){var w=S.descendants(c,v.selector());e.each(w,function(x){var y=l(v.raw());i.setAll(x,y);});return w;});e.each(u,function(v){g.remove(v,'class');});};var o=function(c,t){var u=j.stylesheets(c);var v=k.extractAll(u);m(t,v);};var s=function(t){var u=T.children(t);e.each(u,function(c){h.getOption(c).each(function(v){if(v==='StartFragment'||v==='EndFragment'){R.remove(c);}});});};return{doMergeInlineStyles:m,process:p};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.photon.Reader',['ephox.perhaps.Option','ephox.sugar.api.Element'],function(O,c){var i=function(f){var g=f.dom();try{var h=g.contentWindow?g.contentWindow.document:g.contentDocument;return h!==undefined&&h!==null?O.some(c.fromDom(h)):O.none();}catch(j){console.log('Error reading iframe: ',g);console.log('Error was: '+j);return O.none();}};var e=function(f){var o=i(f);return o.fold(function(){return f;},function(v){return v;});};return{doc:e};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.photon.Writer',['ephox.photon.Reader','ephox.sugar.api.Body'],function(R,c){var w=function(e,f){if(!c.inBody(e))throw'Internal error: attempted to write to an iframe that is not in the DOM';var g=R.doc(e);var h=g.dom();h.open();h.writeln(f);h.close();};return{write:w};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.sugar.impl.FilteredEvent',['ephox.peanut.Fun','ephox.sugar.api.Element'],function(c,e){var m=function(t,x,y,s,p,k,j){return{'target':c.constant(t),'x':c.constant(x),'y':c.constant(y),'stop':s,'prevent':p,'kill':k,'raw':c.constant(j)};};var h=function(j,k){return function(l){if(!j(l))return;var t=e.fromDom(l.target);var s=function(){l.stopPropagation();};var p=function(){l.preventDefault();};var n=c.compose(p,s);var o=m(t,l.clientX,l.clientY,s,p,n,l);k(o);};};var f=function(j,k,l,n,o){var w=h(l,n);j.dom().addEventListener(k,w,o);return{unbind:c.curry(u,j,k,w,o)};};var g=function(j,k,l,n){return f(j,k,l,n,false);};var i=function(j,k,l,n){return f(j,k,l,n,true);};var u=function(j,k,l,n){j.dom().removeEventListener(k,l,n);};return{bind:g,capture:i};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.sugar.api.DomEvent',['ephox.peanut.Fun','ephox.sugar.impl.FilteredEvent'],function(c,e){var f=c.constant(true);var g=function(i,j,k){return e.bind(i,j,f,k);};var h=function(i,j,k){return e.capture(i,j,f,k);};return{bind:g,capture:h};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.photon.Sandbox',['ephox.peanut.Fun','ephox.photon.Writer','ephox.sugar.api.Css','ephox.sugar.api.DomEvent','ephox.sugar.api.Element','ephox.sugar.api.Insert','ephox.sugar.api.Remove','global!setTimeout'],function(c,W,e,g,h,I,R,s){return function(u){var p=function(i,f,j){var o=h.fromTag('div');var k=h.fromTag('iframe');e.setAll(o,{display:'none'});var l=g.bind(k,'load',function(){W.write(k,i);var m=k.dom().contentWindow.document;if(m===undefined)throw"sandbox iframe load event did not fire correctly";var n=h.fromDom(m);var t=m.body;if(t===undefined)throw"sandbox iframe does not have a body";var v=h.fromDom(t);var w=f(n,v);l.unbind();R.remove(o);s(c.curry(j,w),0);});I.append(o,k);I.append(u,o);};return{play:p};};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.sugar.api.Html',['ephox.sugar.api.Element','ephox.sugar.api.Insert'],function(c,I){var g=function(f){return f.dom().innerHTML;};var s=function(f,h){f.dom().innerHTML=h;};var e=function(f){var h=c.fromTag('div');var i=c.fromDom(f.dom().cloneNode(true));I.append(h,i);return g(h);};return{get:g,set:s,getOuter:e};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.cement.html.HtmlHandler',['ephox.cement.alien.FutureStep','ephox.cement.api.Bundle','ephox.cement.html.ImageReference','ephox.cement.html.TordPostprocess','ephox.cement.smartpaste.PasteResponse','ephox.peanut.Fun','ephox.photon.Sandbox','ephox.sugar.api.Element','ephox.sugar.api.Elements','ephox.sugar.api.Html','global!document'],function(c,e,I,T,P,f,S,g,h,j,k){var l='data-textbox-image';var m=function(s){return s===undefined||s===null||s.length===0;};var n=function(i){var s=1;return i.replace(/(<img[^>]*)src=".*?"/g,function(w,x,y){return x+l+'="'+s++ +'"';});};var t=function(s,i){var w=S(g.fromDom(k.body));return function(x,y){w.play(x,function(J,K){T.process(J,K,s,l,{mergeInline:f.constant(i)});return j.get(K);},y);};};var o=function(s,i,w){return c.sync(function(x){var y=I.extract(s);var J=t(y,i);J(w,function(K){var L=h.fromHtml(K);c.call(x,{response:P.paste(L,[]),bundle:e.nu({})});});});};var p=function(){return c.pure(P.paste([],[]),{});};var u=function(s){var i=s.indexOf('</html>');return(i>-1)?s.substr(0,i+'</html>'.length):s;};var v=function(i,s,w){var x=u(i);var y=n(x);return w.cleanDocument(y,s).fold(function(){return c.pure({response:P.error('errors.paste.word.notready'),bundle:{}});},function(J){return m(J)?p():o(y,s,J);});};return{handle:v};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.cement.images.ImageHandler',['ephox.cement.alien.FutureStep','ephox.cement.api.Bundle','ephox.cement.smartpaste.PasteResponse','ephox.compass.Arr','ephox.hermes.api.ImageAsset','ephox.hermes.api.ImageExtract','ephox.sugar.api.Attr','ephox.sugar.api.Element','global!console'],function(c,e,P,f,I,g,h,i,j){var k=function(m){return f.bind(m,function(n){return I.cata(n,function(o,p,s,t){var u=i.fromTag('img');h.set(u,'src',s);return[u];},function(o,u,p){j.log('Internal error: Paste operation produced an image URL instead of a Data URI: ',u);return[];});});};var l=function(m,p){var n=f.filter(m,function(s){return s.kind==='file'&&/image/.test(s.type);});var o=f.map(n,function(s){return s.getAsFile();});return c.sync(function(s){g.toAssets(o,p,function(t){var u=k(t);c.call(s,{response:P.paste(u,t),bundle:e.nu({})});});});};return{handle:l};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.pastiche.api.HtmlPatterns',[],function(){return{validStyles:function(){return/^(mso-.*|tab-stops|tab-interval|language|text-underline|text-effect|text-line-through|font-color|horiz-align|list-image-[0-9]+|separator-image|table-border-color-(dark|light)|vert-align|vnd\..*)$/;},specialInline:function(){return/^(font|em|strong|samp|acronym|cite|code|dfn|kbd|tt|b|i|u|s|sub|sup|ins|del|var|span)$/;}};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(b,r,f){b('ephox.violin.StringMatch',[],function(){var g=function(v){return m(function(s,p,c,e,a,n){return s(v);});};var h=function(t){return m(function(s,p,c,e,a,n){return p(t);});};var i=function(v){return m(function(s,p,c,e,a,n){return c(v);});};var j=function(v){return m(function(s,p,c,e,a,n){return e(v);});};var k=function(){return m(function(s,p,c,e,a,n){return a();});};var l=function(t){return m(function(s,p,c,e,a,n){return n(t);});};var m=function(a){var c=function(s){return a(function(v){return s.toLowerCase().indexOf(v.toLowerCase())===0;},function(e){return e.test(s.toLowerCase());},function(v){return s.toLowerCase().indexOf(v.toLowerCase())>=0;},function(v){return s.toLowerCase()===v.toLowerCase();},function(){return true;},function(e){return!e.matches(s);});};return{fold:a,matches:c};};var o=function(t,s,p,c,e,a,n){return t.fold(s,p,c,e,a,n);};return{starts:g,pattern:h,contains:i,exact:j,all:k,not:l,cata:o};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.pastiche.api.RuleMatch',['ephox.peanut.Fun','ephox.sugar.api.Node','ephox.violin.StringMatch'],function(c,N,S){var k=function(e,v,f,g){var h=g.name;var i=g.condition!==undefined?g.condition:c.constant(true);var j=g.value!==undefined?g.value:S.all();return h.matches(f)&&j.matches(v)&&i(e);};var n=function(e,f){var t=N.name(e);var g=f.name;var h=f.condition!==undefined?f.condition:c.constant(true);return g.matches(t)&&h(e);};return{keyval:k,name:n};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(b,c,e){b('ephox.pastiche.cleanup.AttributeAccess',['ephox.compass.Arr','ephox.compass.Obj','ephox.peanut.Fun','ephox.sugar.api.Attr'],function(f,O,g,h){var i=function(k,p){var r={};f.each(k.dom().attributes,function(a){if(!p(a.value,a.name))r[a.name]=a.value;});return r;};var u=function(a,n,l){f.each(n,function(k){h.remove(a,k);});O.each(l,function(v,k){h.set(a,k,v);});};var j=function(a,s,_){var n=f.map(a.dom().attributes,function(k){return k.name;});if(O.size(s)!==n.length)u(a,n,s);};return{filter:i,clobber:j,scan:g.constant({})};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,b,c){a('ephox.pastiche.cleanup.StyleAccess',['ephox.compass.Arr','ephox.compass.Obj','ephox.sugar.api.Attr','ephox.sugar.api.Css','ephox.violin.Strings'],function(e,O,f,g,S){var s=function(k){var o={};var p=k!==undefined&&k!==null?k.split(';'):[];e.each(p,function(r){var t=r.split(':');if(t.length===2){o[S.trim(t[0])]=S.trim(t[1]);}});return o;};var h=function(k,p){return k.dom().style.getPropertyValue(p);};var i=function(k,p){var r={};e.each(k.dom().style,function(o){var v=h(k,o);if(!p(v,o))r[o]=v;});return r;};var j=function(k,p,v){g.set(k,p,v);};var l=function(k,o,p){var r=k.dom().getAttribute('style');var t=s(r);var u={};e.each(o,function(v){var w=t[v];if(w!==undefined&&!p(w,v))u[v]=w;});return u;};var m=function(u){var p=O.keys(u);return e.map(p,function(k){return k+': '+u[k];}).join('; ');};var n=function(o,p,u){f.set(o,'style','');var r=O.size(p);var t=O.size(u);if(r===0&&t===0)f.remove(o,'style');else if(r===0)f.set(o,'style',m(u));else{O.each(p,function(v,k){j(o,k,v);});var w=f.get(o,'style');var x=t>0?m(u)+'; ':'';f.set(o,'style',x+w);}};return{filter:i,clobber:n,scan:l};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.pastiche.cleanup.Cleaners',['ephox.pastiche.cleanup.AttributeAccess','ephox.pastiche.cleanup.StyleAccess','ephox.peanut.Fun','ephox.sugar.api.Element'],function(c,S,e,f){var s=['mso-list'];var g=function(k,p){var u=S.scan(k,s,p);var l=S.filter(k,p);S.clobber(k,l,u);};var h=function(k,p){var l=c.filter(k,p);c.clobber(k,l,{});};var v=function(k){var l=S.filter(k,e.constant(false));S.clobber(k,l,{});};var i=function(k,p){g(f.fromDom(k),p);};var j=function(k,p){h(f.fromDom(k),p);};return{style:g,attribute:h,styleDom:i,attributeDom:j,validateStyles:v};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,b,c){a('ephox.sugar.api.Classes',['ephox.compass.Arr','ephox.sugar.api.Class','global!Array'],function(e,f,g){var h=function(i,n){e.each(n,function(x){f.add(i,x);});};var j=function(i,n){e.each(n,function(x){f.remove(i,x);});};var t=function(i,n){e.each(n,function(x){f.toggle(i,x);});};var k=function(i,n){return e.forall(n,function(o){return f.has(i,o);});};var l=function(i,n){return e.exists(n,function(o){return f.has(i,o);});};var m=function(n){var o=n.dom().classList;var r=new g(o.length);for(var i=0;i<o.length;i++){r[i]=o.item(i);}return r;};return{add:h,remove:j,toggle:t,hasAll:k,hasAny:l,get:m};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.pastiche.engine.Pipeless',['ephox.compass.Arr','ephox.highway.Merger','ephox.pastiche.api.RuleMatch','ephox.pastiche.cleanup.Cleaners','ephox.peanut.Fun','ephox.sugar.api.Attr','ephox.sugar.api.Class','ephox.sugar.api.Classes','ephox.sugar.api.Remove','ephox.sugar.api.SelectorFilter'],function(c,M,R,e,f,g,h,i,j,S){var k=function(m,n,o){m(o,function(p,s){return c.exists(n,function(w){return R.keyval(o,p,s,w);});});};var l=function(m,s){var n=M.merge({styles:[],attributes:[],classes:[],tags:[]},s);var o=S.descendants(m,'*');c.each(o,function(w){k(e.style,n.styles,w);k(e.attribute,n.attributes,w);c.each(n.classes,function(x){var y=g.has(w,'class')?i.get(w):[];c.each(y,function(I){if(x.name.matches(I))h.remove(w,I);});});});var p=S.descendants(m,'*');c.each(p,function(w){var x=c.exists(n.tags,f.curry(R.name,w));if(x)j.remove(w);});};var u=function(m,s){var n=M.merge({tags:[]},s);var o=S.descendants(m,'*');c.each(o,function(p){var w=c.exists(n.tags,f.curry(R.name,p));if(w)j.unwrap(p);});};var t=function(m,s){var n=M.merge({tags:[]},s);var o=S.descendants(m,'*');c.each(o,function(p){var w=c.find(n.tags,f.curry(R.name,p));if(w!==undefined&&w!==null)w.mutate(p);});};var v=function(m){var n=S.descendants(m,'*');c.each(n,function(o){e.validateStyles(o);});};return{remover:l,unwrapper:u,transformer:t,validator:v};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.pastiche.engine.Token',['ephox.compass.Obj','ephox.sugar.api.Css','ephox.sugar.api.Element'],function(O,c,e){var S='startElement';var f='endElement';var T='text';var g='comment';var t=function(n,m,s){var o;var p;var u;var v=e.fromDom(n);switch(n.nodeType){case 1:if(m){o=f;}else{o=S;c.setAll(v,s||{});}if(n.scopeName!=="HTML"&&n.scopeName&&n.tagName&&n.tagName.indexOf(':')<=0){p=(n.scopeName+":"+n.tagName).toUpperCase();}else{p=n.tagName;}break;case 3:o=T;u=n.nodeValue;break;case 8:o=g;u=n.nodeValue;break;default:console.log("WARNING: Unsupported node type encountered: "+n.nodeType);break;}var w=function(){return n;};var x=function(){return p;};var y=function(){return o;};var I=function(){return u;};return{getNode:w,tag:x,type:y,text:I};};var h=function(m,n,s,o){var p=o.createElement(m),u="";O.each(n,function(v,w){p.setAttribute(w,v);});return t(p,false,s);};var i=function(m,n){return t(n.createElement(m),true);};var j=function(m,n){return t(n.createComment(m),false);};var k=function(m,n){return t(n.createTextNode(m));};var l=i('HTML',window.document);return{START_ELEMENT_TYPE:S,END_ELEMENT_TYPE:f,TEXT_TYPE:T,COMMENT_TYPE:g,FINISHED:l,token:t,createStartElement:h,createEndElement:i,createComment:j,createText:k};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.pastiche.engine.Serialiser',['ephox.pastiche.engine.Token'],function(T){var c=function(e){var f=e.createDocumentFragment();var i=f;var p=function(n){h(n);f=n;};var g=function(){f=f.parentNode;if(f===null)f=i;};var h=function(n){f.appendChild(n);};var j=function(t){var s=function(t){var n=t.getNode().cloneNode(false);p(n);};var k=function(t,l){var n=e.createTextNode(t.text());h(n);};switch(t.type()){case T.START_ELEMENT_TYPE:s(t);break;case T.TEXT_TYPE:k(t);break;case T.END_ELEMENT_TYPE:g();break;case T.COMMENT_TYPE:break;default:throw{message:'Unsupported token type: '+t.type()};}};return{dom:i,receive:j,label:'SERIALISER'};};return{create:c};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.pastiche.engine.Tokeniser',['ephox.pastiche.engine.Token'],function(T){var t=function(h,c){var e;c=c||window.document;e=c.createElement('div');c.body.appendChild(e);e.style.position='absolute';e.style.left='-10000px';e.innerHTML=h;nextNode=e.firstChild||T.FINISHED;var n=[];endNode=false;var g=function(j,k){if(j===T.FINISHED){return j;}else if(j){return T.token(j,k);}else{return undefined;}};var f=function(){var j=nextNode;var k=endNode;if(!endNode&&nextNode.firstChild){n.push(nextNode);nextNode=nextNode.firstChild;}else if(!endNode&&nextNode.nodeType===1){endNode=true;}else if(nextNode.nextSibling){nextNode=nextNode.nextSibling;endNode=false;}else{nextNode=n.pop();endNode=true;}if(j!==T.FINISHED&&!nextNode){c.body.removeChild(e);nextNode=T.FINISHED;}return g(j,k);};var i=function(){return nextNode!==undefined;};return{hasNext:i,next:f};};return{tokenise:t};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.pastiche.engine.Pipeline',['ephox.pastiche.engine.Serialiser','ephox.pastiche.engine.Tokeniser'],function(S,T){var c=function(f,g,s){var i,h=s;for(i=g.length-1;i>=0;i--){h=g[i](h,{},f);}return h;};var e=function(f,g,h){var s=S.create(f);var t=T.tokenise(g,f);var p=c(f,h,s);while(t.hasNext()){var i=t.next();p.receive(i);}return s.dom;};return{build:c,run:e};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.pastiche.api.HybridAction',['ephox.compass.Arr','ephox.pastiche.engine.Pipeless','ephox.pastiche.engine.Pipeline','ephox.sugar.api.Element','ephox.sugar.api.Html','ephox.sugar.api.Remove','ephox.sugar.api.Traverse'],function(c,P,e,f,g,R,T){var h=function(s){return function(k){P.remover(k,s);};};var u=function(s){return function(k){P.unwrapper(k,s);};};var t=function(s){return function(k){P.transformer(k,s);};};var v=function(){return function(k){P.validator(k);};};var p=function(k){return function(l){var m=g.get(l);var n=T.owner(l);var s=e.run(n.dom(),m,k);R.empty(l);l.dom().appendChild(s);};};var i=function(k,l,m){var n=f.fromTag('div',k.dom());n.dom().innerHTML=l;c.each(m,function(o){o(n);});return g.get(n);};var j=function(k){return k.indexOf('<o:p>')>=0||k.indexOf('p.MsoNormal, li.MsoNormal, div.MsoNormal')>=0||k.indexOf('MsoListParagraphCxSpFirst')>=0||k.indexOf('<w:WordDocument>')>=0;};return{removal:h,unwrapper:u,transformer:t,validate:v,pipeline:p,isWordContent:j,go:i};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.sugar.api.PredicateExists',['ephox.sugar.api.PredicateFind'],function(P){var c=function(p){return P.first(p).isSome();};var e=function(i,p,j){return P.ancestor(i,p,j).isSome();};var f=function(i,p,j){return P.closest(i,p,j).isSome();};var s=function(i,p){return P.sibling(i,p).isSome();};var g=function(i,p){return P.child(i,p).isSome();};var h=function(i,p){return P.descendant(i,p).isSome();};return{any:c,ancestor:e,closest:f,sibling:s,child:g,descendant:h};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.pastiche.api.RuleConditions',['ephox.compass.Arr','ephox.sugar.api.Attr','ephox.sugar.api.Html','ephox.sugar.api.Node','ephox.sugar.api.PredicateExists'],function(c,f,g,N,P){var i=function(e){return N.name(e)!=='img';};var h=function(e){var o=e.dom().attributes;var p=o!==undefined&&o!==null&&o.length>0;return N.name(e)==='span'?p:true;};var j=function(o){if(!m(o))return true;else{return h(o)&&P.descendant(o,function(e){var p=!m(e);var s=!c.contains(['font','em','strong','samp','acronym','cite','code','dfn','kbd','tt','b','i','u','s','sub','sup','ins','del','var','span'],N.name(e));return N.isText(e)||p||s;});}};var k=function(e){return N.name(e)==='ol'||N.name(e)==='ul';};var l=function(e){var s=f.get(e,'src');return(/^file:/).test(s);};var m=function(e){if(e.dom().attributes===undefined||e.dom().attributes===null)return true;return e.dom().attributes.length===0||(e.dom().attributes.length===1&&e.dom().attributes[0].name==='style');};var n=function(e){return g.get(e).length===0;};return{isNotImage:i,hasContent:j,isList:k,isLocal:l,hasNoAttributes:m,isEmpty:n};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.bud.Unicode',[],function(){var c=function(){return'\u200B';};var t=function(s){return s.replace(/\u200B/,'').trim();};var e=function(s){return s.replace(/^\s+|\s+$/g,'').replace(/\u200B/,'');};return{zeroWidth:c,trimNative:t,trimWithRegex:e};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.sugar.api.Text',['ephox.sugar.api.Node','ephox.sugar.impl.NodeValue'],function(N,c){var e=c(N.isText,'text');var g=function(h){return e.get(h);};var f=function(h){return e.getOption(h);};var s=function(h,v){e.set(h,v);};return{get:g,getOption:f,set:s};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.pastiche.api.RuleMutations',['ephox.bud.Unicode','ephox.compass.Arr','ephox.compass.Obj','ephox.perhaps.Option','ephox.sugar.api.Attr','ephox.sugar.api.Css','ephox.sugar.api.Element','ephox.sugar.api.Html','ephox.sugar.api.Insert','ephox.sugar.api.InsertAll','ephox.sugar.api.Node','ephox.sugar.api.Remove','ephox.sugar.api.Text','ephox.sugar.api.Traverse'],function(U,c,O,e,f,g,h,i,I,j,N,R,T,k){var l=function(t,s){var u=h.fromTag(t);I.before(s,u);var v=s.dom().attributes;c.each(v,function(x){u.dom().setAttribute(x.name,x.value);});var w=k.children(s);j.append(u,w);R.remove(s);return u;};var m=function(s){if(i.get(s).length===0){I.append(s,h.fromTag('br'));}};var n=function(s){return k.prevSibling(s).bind(function(t){if(N.isText(t)&&U.trimNative(T.get(t)).length===0)return n(t);return N.name(t)==='li'?e.some(t):e.none();});};var p=function(s){k.parent(s).each(function(t){var u=N.name(t);if(c.contains(['ol','ul'],u)){n(s).fold(function(){var v=h.fromTag('li');g.set(v,'list-style-type','none');I.wrap(s,v);},function(v){I.append(v,s);});}});};var o=function(s){var t=l('span',s);var u={face:'font-family',size:'font-size',color:'font-color'};var v={'font-size':{'1':'8pt','2':'10pt','3':'12pt','4':'14pt','5':'18pt','6':'24pt','7':'36pt'}};O.each(u,function(w,x){if(f.has(t,x)){var y=f.get(t,x);var J=v[w]!==undefined&&v[w][y]!==undefined?v[w][y]:y;g.set(t,w,J);f.remove(t,x);}});};return{changeTag:l,addBrTag:m,properlyNest:p,fontToSpan:o};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.pastiche.engine.Filter',['ephox.compass.Arr','ephox.pastiche.engine.Token'],function(c,T){var e=function(f,g,l){var h=function(n,s,i,_){var j=_!==undefined?_:[];var k;var m,o,p=false;var t=function(){if(g)g(N);p=false;m=[];o=[];};var u=function(O){c.each(O,function(P){n.receive(P);});};var v=function(O){if(p){o.push(O);}else{n.receive(O);}};var w=function(O){if(g)m.push(O);f(N,O);if(O===T.FINISHED){I();}};var x=function(){p=true;};var y=function(){u(m);t();};var I=function(){L();u(o);t();};var J=function(O){k=k||[];k.push(O);};var K=function(){return k&&k.length>0;};var L=function(){c.each(k||[],function(O){v(O);});M();};var M=function(){k=[];};var N={document:i||window.document,settings:s||{},emit:v,receive:w,startTransaction:x,rollback:y,commit:I,defer:J,hasDeferred:K,emitDeferred:L,dropDeferred:M,label:l};t();return N;};return h;};return{createFilter:e};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.pastiche.engine.TokenUtil',['ephox.pastiche.cleanup.StyleAccess','ephox.pastiche.engine.Token','ephox.peanut.Fun','ephox.sugar.api.Attr','ephox.sugar.api.Css','ephox.sugar.api.Element'],function(S,T,c,e,f,g){var h=function(t,p){var l=g.fromDom(t.getNode());return e.get(l,p);};var i=function(t,p){var l=g.fromDom(t.getNode());return f.get(l,p);};var j=function(t){return t.type()===T.TEXT_TYPE&&/^[\s\u00A0]*$/.test(t.text());};var k=function(t){var l=g.fromDom(t.getNode());var s=S.scan(l,['mso-list'],c.constant(false));return s['mso-list'];};return{getAttribute:h,getStyle:i,isWhitespace:j,getMsoList:k};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.pastiche.list.detect.ListSymbols',['ephox.compass.Arr','ephox.highway.Merger'],function(c,M){var e=[{regex:/^\(?[dc][\.\)]$/,type:{tag:'OL',type:'lower-alpha'}},{regex:/^\(?[DC][\.\)]$/,type:{tag:'OL',type:'upper-alpha'}},{regex:/^\(?M*(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})[\.\)]$/,type:{tag:'OL',type:'upper-roman'}},{regex:/^\(?m*(cm|cd|d?c{0,3})(xc|xl|l?x{0,3})(ix|iv|v?i{0,3})[\.\)]$/,type:{tag:'OL',type:'lower-roman'}},{regex:/^\(?[0-9]+[\.\)]$/,type:{tag:'OL'}},{regex:/^([0-9]+\.)*[0-9]+\.?$/,type:{tag:'OL',variant:'outline'}},{regex:/^\(?[a-z]+[\.\)]$/,type:{tag:'OL',type:'lower-alpha'}},{regex:/^\(?[A-Z]+[\.\)]$/,type:{tag:'OL',type:'upper-alpha'}}];var u={'\u2022':{tag:'UL',type:'disc'},'\u00B7':{tag:'UL',type:'disc'},'\u00A7':{tag:'UL',type:'square'}};var f={'o':{tag:'UL',type:'circle'},'-':{tag:'UL',type:'disc'},'\u25CF':{tag:'UL',type:'disc'},'':{tag:'UL',type:'circle'}};var g=function(t,i){if(t.variant!==undefined)return t.variant;else if(i.charAt(0)==='(')return'()';else if(i.charAt(i.length-1)===')')return')';else return'.';};var h=function(t){var n=parseInt(t,10);return isNaN(n)?{}:{start:n};};var m=function(t,i){var n=f[t]?[f[t]]:[];var s=i&&u[t]?[u[t]]:i?[{tag:'UL',variant:t}]:[];var j=c.bind(e,function(o){return o.regex.test(t)?[M.merge(o.type,h(t),{variant:g(o.type,t)})]:[];});var k=n.concat(s).concat(j);return c.map(k,function(x){return x.variant!==undefined?x:M.merge(x,{variant:t});});};return{match:m};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.pastiche.list.detect.ListGuess',['ephox.compass.Arr','ephox.pastiche.list.detect.ListSymbols','ephox.perhaps.Option','ephox.violin.Strings'],function(e,L,O,S){var g=function(h,p){var t=h?S.trim(h.text):'';var s=h?!!h.symbolFont:false;var i=L.match(t,s);var j=e.find(i,function(c){return c.tag==='UL'||(p&&f(c,p,true));});return j!==undefined?O.some(j):i.length>0?O.some(i[0]):O.none();};var f=function(t,c,i){return t===c||(t&&c&&t.tag===c.tag&&t.type===c.type&&(i||t.variant===c.variant));};return{guess:g,eqListType:f};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.pastiche.list.detect.ListTypes',['ephox.compass.Arr','ephox.pastiche.engine.Token','ephox.pastiche.engine.TokenUtil','ephox.pastiche.list.detect.ListGuess','ephox.peanut.Fun'],function(e,T,f,L,g){var v=['P'];var i=function(t){return(!e.contains(v,t.tag())||/^MsoHeading/.test(f.getAttribute(t,'class')));};var h=function(l,p,o){var m=L.guess(l,p);return m.fold(function(){return null;},function(c){if(c.tag==='OL'&&o&&i(o)){listType=null;}else{return c;}});};var j=L.eqListType;var k=function(t,s){if(t.type()==T.START_ELEMENT_TYPE){font=f.getStyle(t,'font-family');if(font){s=(font==='Wingdings'||font==='Symbol');}else if(/^(P|H[1-6]|DIV)$/.test(t.tag())){s=false;}}return s;};return{guess:h,eqListType:j,checkFont:k};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.pastiche.inspect.Microsoft',['ephox.pastiche.engine.Token','ephox.pastiche.engine.TokenUtil'],function(T,c){var i=function(s,t){var f=c.getMsoList(t);return f&&f!=='skip';};var e=function(s,t){return t.type()==T.START_ELEMENT_TYPE&&c.getMsoList(t)==='Ignore';};return{isList:i,isIgnore:e};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.pastiche.inspect.Tags',['ephox.compass.Arr','ephox.pastiche.engine.Token','ephox.violin.Strings'],function(c,T,S){var i=function(s,t){return t.type()===T.START_ELEMENT_TYPE;};var e=function(s,t){return t.type()===T.END_ELEMENT_TYPE;};var f=function(t){return function(s,m){return m.tag()===t;};};var g=function(t){return function(s,m){return f(t)(s,m)&&S.trim(m.getNode().textContent)==='';};};var h=function(t){return function(s,m){return i(s,m)&&m.tag()===t;};};var j=function(t){return function(s,m){return e(s,m)&&m.tag()===t;};};var k=function(t){return function(s,m){return i(s,m)&&c.contains(t,m.tag());};};var l=function(t){return function(s,m,t){return e(s,m)&&c.contains(t,m.tag());};};return{isStart:i,isEnd:e,isTag:f,isStartOf:h,isEndOf:j,isStartAny:k,isEndAny:l,isWhitespace:g};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.pastiche.inspect.Paragraphs',['ephox.pastiche.inspect.Microsoft','ephox.pastiche.inspect.Tags'],function(M,T){var i=function(s,t){return!s.skippedPara.get()&&T.isStart(s,t,'P')&&!M.isList(s,t);};return{isNormal:i};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.pastiche.inspect.Texts',['ephox.pastiche.engine.Token','ephox.pastiche.engine.TokenUtil','ephox.violin.Strings'],function(T,c,S){var i=function(s,t){return e(s,t)&&c.isWhitespace(t);};var e=function(s,t){return t.type()===T.TEXT_TYPE;};var f=function(v){return function(s,t){return e(s,t)&&t.text()===v;};};var m=function(v){return function(s,t){return e(s,t)&&v.test(t.text());};};var g=function(s,t){return e(s,t)&&S.trim(t.text())==='';};return{isWhitespace:i,is:e,isBlank:g,eq:f,matches:m};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.pastiche.list.stage.Handler',['ephox.peanut.Fun'],function(c){return function(p,e,l){return{pred:p,action:e,label:c.constant(l)};};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,b,c){a('ephox.pastiche.list.stage.Handlers',['ephox.compass.Arr','ephox.peanut.Fun','ephox.perhaps.Option'],function(e,f,O){var l=function(g,h){return function(i,s,t){return h(i,s,t);};};return function(n,h,g){var i=l(n+' :: FALLBACK --- ',g);var r=function(j,s,t){var k=O.from(e.find(h,function(x){return x.pred(s,t);}));var o=k.fold(f.constant(i),function(m){var p=m.label();return p===undefined?m.action:l(n+' :: '+p,m.action);});o(j,s,t);};r.toString=function(){return'Handlers for '+n;};return r;};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.pastiche.list.state.Transitions',[],function(){var n=function(c,l){if(c===undefined||l===undefined){console.trace();throw'brick';}c.nextFilter.set(l);};var s=function(l){return function(c,e,t){n(e,l);};};var g=function(c,e,t){var f=e.nextFilter.get();f(c,e,t);};var j=function(l){return function(c,e,t){n(e,l);g(c,e,t);};};var i=function(c,l){return c.nextFilter.get()===l;};return{next:n,go:g,jump:j,isNext:i,setNext:s};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.pastiche.list.stage.AfterListState',['ephox.pastiche.inspect.Paragraphs','ephox.pastiche.inspect.Texts','ephox.pastiche.list.stage.Handler','ephox.pastiche.list.stage.Handlers','ephox.pastiche.list.state.Transitions'],function(P,T,c,e,f){var g=function(s,n){var h=function(k,l,t){k.defer(t);};var i=function(k,l,t){l.openedTag.set(t);k.defer(t);f.next(l,s);};var j=function(k,l,t){n(k,l,t);};return e('AfterListState',[c(T.isBlank,h,'blank text'),c(P.isNormal,i,'normal paragraph')],j);};return{run:g};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.pastiche.inspect.States',['ephox.pastiche.engine.Token'],function(T){var i=function(s,t){return t.type()===T.END_ELEMENT_TYPE&&s.originalToken.get()&&t.tag()===s.originalToken.get().tag();};return{isCloser:i};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.pastiche.list.stage.AfterNoBulletListState',['ephox.pastiche.inspect.States','ephox.pastiche.list.stage.Handler','ephox.pastiche.list.stage.Handlers','ephox.pastiche.list.state.Transitions'],function(S,c,e,T){var f=function(g){var h=function(j,s,t){T.next(s,g);s.styleLevelAdjust.set(-1);j.emit(t);};var i=function(j,s,t){j.emit(t);};return e('AfterNoBullet',[c(S.isCloser,h,' closing open tag')],i);};return{run:f};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.pastiche.inspect.Images',['ephox.pastiche.inspect.Tags'],function(T){var i=T.isEndOf('IMG');var c=T.isStartOf('IMG');return{isStart:c,isEnd:i};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.pastiche.inspect.Markers',['ephox.pastiche.engine.Token'],function(T){var i=function(s,t){return t.tag()==='A'||t.tag()==='SPAN'||t.tag()==='STRONG';};var c=function(s,t){return t.type()===T.START_ELEMENT_TYPE&&i(s,t);};var e=function(s,t){return t.type()===T.END_ELEMENT_TYPE&&i(s,t);};return{isStart:c,isEnd:e,is:i};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.pastiche.list.state.Spans',['ephox.pastiche.list.state.Transitions'],function(T){var c=function(i,s,t){i.defer(t);f(i,s,t);};var e=function(i,s,t){i.defer(t);p(i,s,t);};var p=function(i,s,t){s.spanCount.get().push(t);};var f=function(i,s,t){s.spanCount.get().pop();};var g=function(l){return function(i,s,t){p(i,s,t);T.next(s,l);};};var h=function(l){return function(i,s,t){f(i,s,t);T.next(s,l);};};return{deferAndPush:e,deferAndPop:c,push:p,pop:f,pushThen:g,popThen:h};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.pastiche.list.stage.BeforeSpacerState',['ephox.pastiche.inspect.Images','ephox.pastiche.inspect.Markers','ephox.pastiche.list.stage.Handler','ephox.pastiche.list.stage.Handlers','ephox.pastiche.list.state.Spans','ephox.peanut.Fun'],function(I,M,c,e,S,f){var g=function(s,h,u){var i=function(j,k,t){u(j,t);};return e('BeforeSpacer',[c(M.isStart,S.pushThen(s),'start marker'),c(M.isEnd,S.popThen(h),'end marker'),c(I.isEnd,f.noop,'end image')],i);};return{run:g};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.pastiche.inspect.Comments',['ephox.pastiche.engine.Token'],function(T){var i=function(s,t){return t.type()===T.COMMENT_TYPE;};var c=function(s,t){return i(s,t)&&t.text()!=='[endif]';};var e=function(s,t){return i(s,t)&&t.text()==='[endif]';};var f=function(s,t){return i(s,t)&&t.text()==='[if !supportLists]';};return{is:i,isNotEndIf:c,isEndIf:e,isListSupport:f};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.pastiche.inspect.Logic',['ephox.compass.Arr'],function(e){var f=function(h){return function(s,t){return e.exists(h,function(c){return c(s,t);});};};var g=function(h){return function(s,t){return e.forall(h,function(c){return c(s,t);});};};return{any:f,all:g};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.pastiche.list.stage.CloseSpansState',['ephox.pastiche.inspect.Comments','ephox.pastiche.inspect.Logic','ephox.pastiche.inspect.Markers','ephox.pastiche.inspect.Tags','ephox.pastiche.inspect.Texts','ephox.pastiche.list.detect.ListTypes','ephox.pastiche.list.stage.Handler','ephox.pastiche.list.stage.Handlers','ephox.pastiche.list.state.Spans','ephox.pastiche.list.state.Transitions','ephox.peanut.Fun','ephox.perhaps.Option','ephox.perhaps.Result'],function(c,L,M,T,e,f,g,h,S,i,j,O,R){var k=function(l,u){var m=function(w){var x=w.emitter.getCurrentListType();var y=w.emitter.getCurrentLevel();var I=y==w.itemLevel.get()?x:null;return O.from(f.guess(w.bulletInfo.get(),I,w.originalToken.get()));};var o=function(w,x,y){x.emitter.openItem(x.itemLevel.get(),x.originalToken.get(),x.listType.get(),x.skippedPara.get());w.emitDeferred();while(x.spanCount.get().length>0){w.emit(x.spanCount.get().shift());}};var n=function(w,x){i.next(w,l);if(w.commentMode.get()){var y=w.indentGuesser.guessIndentLevel(x,w.originalToken.get(),w.styles,w.bulletInfo.get());w.itemLevel.set(y);}};var t=function(w,x,y){var I=m(x);return I.fold(function(){x.listType.set(null);return R.error("Unknown list type: "+x.bulletInfo.get().text+" Symbol font? "+x.bulletInfo.get().symbolFont);},function(J){x.listType.set(J);return R.value(o);});};var p=function(w,y,I){n(y,I);var J=t(w,y,I);J.fold(function(x){console.log(x);w.rollback();},function(x){x(w,y,I);w.emit(I);});};var s=function(w,y,I){n(y,I);var J=t(w,y,I);J.fold(function(x){console.log(x);w.rollback();},function(x){x(w,y,I);});};var v=[g(L.any([e.is,T.isStart]),p,'text or start tag'),g(c.isNotEndIf,p,'non-endif comment'),g(c.isEndIf,s,'endif comment'),g(M.isEnd,S.pop,'end marker'),g(T.isEnd,j.noop,'end tag')];return h('CloseSpans',v,function(w,x,y){u(w,y);});};return{run:k};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.pastiche.list.stage.FindListTypeState',['ephox.pastiche.inspect.Images','ephox.pastiche.inspect.Markers','ephox.pastiche.inspect.Texts','ephox.pastiche.list.stage.Handler','ephox.pastiche.list.stage.Handlers','ephox.pastiche.list.state.Spans','ephox.pastiche.list.state.Transitions','ephox.peanut.Fun'],function(I,M,T,c,e,S,f,g){var h=function(i,u){var j=function(m){return function(n,s,o){f.next(s,i);s.bulletInfo.set(m(s,o));};};var t=j(function(s,m){return{text:m.text(),symbolFont:s.symbolFont.get()};});var k=j(function(s,m){return{text:'\u2202',symbolFont:true};});var l=function(m,s,n){u(m,n);};return e('FindListType',[c(T.isWhitespace,g.noop,'text is whitespace'),c(T.is,t,'text'),c(M.isStart,S.push,'start marker'),c(M.isEnd,S.pop,'end marker'),c(I.isStart,k,'start image')],l);};return{run:h};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.pastiche.list.stage.ItemContentState',['ephox.pastiche.inspect.States','ephox.pastiche.list.stage.Handler','ephox.pastiche.list.stage.Handlers','ephox.pastiche.list.state.Transitions'],function(S,c,e,T){var f=function(g){var h=function(j,s,t){T.next(s,g);s.skippedPara.set(false);};var i=[c(S.isCloser,h,'Closing open tag')];return e('ItemContentState',i,function(j,s,t){j.emit(t);});};return{run:f};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.pastiche.list.state.CommentOff',['ephox.pastiche.inspect.Comments','ephox.pastiche.inspect.Texts'],function(c,T){var i=function(s,t){return!s.commentMode.get()&&T.is(s,t);};var e=function(s,t){return!s.commentMode.get()&&c.is(s,t);};return{isText:i,isComment:e};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.pastiche.list.state.CommentOn',['ephox.pastiche.engine.TokenUtil','ephox.pastiche.inspect.Comments','ephox.pastiche.inspect.Texts'],function(T,c,e){var i=function(s,t){return s.commentMode.get()&&e.is(s,t);};var f=function(s,t){return s.commentMode.get()&&c.is(s,t);};var g=function(s,t){var h=T.getAttribute(t,'style');return s.commentMode.get()&&h===""||h===null;};return{isText:i,isComment:f,isUnstyled:g};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,b,c){a('ephox.pastiche.list.stage.ListStartState',['ephox.compass.Arr','ephox.pastiche.inspect.Logic','ephox.pastiche.inspect.Microsoft','ephox.pastiche.inspect.Tags','ephox.pastiche.inspect.Texts','ephox.pastiche.list.detect.ListSymbols','ephox.pastiche.list.stage.Handler','ephox.pastiche.list.stage.Handlers','ephox.pastiche.list.state.CommentOff','ephox.pastiche.list.state.CommentOn','ephox.pastiche.list.state.Spans','ephox.pastiche.list.state.Transitions','ephox.peanut.Fun'],function(e,L,M,T,f,g,h,i,j,k,S,l,m){var n=function(o,p,u){var v=function(){return i('TESTER',[h(T.isEndOf('SPAN'),l.setNext(y),'Finishing span'),h(f.isWhitespace,m.noop,'Is whitespace')],function(r,s,t){u(r,t);});};var w=function(r,s,t){var I=s.originalToken.get();var J=s.spanCount.get();s.emitter.closeAllLists();r.emit(I);e.each(J,r.emit);r.emit(t);r.commit();s.originalToken.set(I);l.next(s,p);};var x=function(s,t){return f.is(s,t)&&g.match(t.text(),s.symbolFont.get()).length>0;};var y=function(s,t,I){if(M.isIgnore(t,I)){l.next(t,o);}var r=i('ListStartState',[h(L.all([T.isStartOf('SPAN'),k.isUnstyled]),S.pushThen(o),'unstyled span'),h(T.isStartOf('SPAN'),S.push,'starting span'),h(T.isStartOf('A'),S.push,'starting a'),h(T.isEndOf('A'),S.pop,'ending a'),h(k.isText,l.jump(o),'commentOn -> text'),h(x,l.jump(o),'mogran :: text is [1-9].'),h(f.is,w,'text'),h(j.isComment,m.noop,'commentOff -> comment'),h(T.isStartOf('IMG'),l.jump(o),'mogran :: start image tag')],function(s,t,I){u(s,I);});return r(s,t,I);};y.toString=function(){return'Handlers for ListStartState';};return y;};return{run:n};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);E.bolt.module.api.define("global!navigator",[],function(){return navigator;});(function(a,r,b){a('ephox.pastiche.inspect.Browser',['ephox.pastiche.engine.Token','ephox.pastiche.inspect.Microsoft','global!document','global!navigator'],function(T,M,c,n){var s=function(){if(n.userAgent.indexOf('Gecko')>0&&n.userAgent.indexOf('WebKit')<0)return false;var e=c.createElement('div');try{e.innerHTML='<p style="mso-list: Ignore;">&nbsp;</p>';}catch(f){return false;}var t=T.token(e.firstChild);return M.isIgnore({},t);};return{supportsCustomStyles:s};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.pastiche.list.detect.ImageList',[],function(){var i=function(s,n,c){var e=n!==undefined&&n!==null&&n.getAttribute!==undefined&&n.getAttribute!==null?n.getAttribute('alt'):'';return!!n&&n.tagName==='IMG'&&e==='*';};return{is:i};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,b,c){a('ephox.pastiche.list.detect.TextList',['ephox.pastiche.list.detect.ListTypes','ephox.violin.Strings'],function(L,S){var i=function(s,e,f){var n=e;var v=n.nodeValue;if(!S.trim(v)){n=n.parentNode.nextSibling;v=n?n.nodeValue:'';}if(!n||S.trim(n.parentNode.textContent)!=v){return false;}listType=L.guess({text:v,symbolFont:f},null,s.originalToken.get());if(listType){var r=!!n.nextSibling&&n.nextSibling.tagName==='SPAN'&&/^[\u00A0\s]/.test(n.nextSibling.firstChild.nodeValue)&&(s.openedTag.get().tag()==='P'||listType.tag==='UL');return r;}else{return false;}};return{is:i};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.pastiche.list.detect.ListDetect',['ephox.highway.Merger','ephox.pastiche.inspect.Tags','ephox.pastiche.list.detect.ImageList','ephox.pastiche.list.detect.TextList'],function(M,T,I,c){var u=function(o){var n=o.node;var e=n.style.fontFamily;return e?M.merge(o,{symbol:(e==='Wingdings'||e==='Symbol')}):o;};var h=function(n){return!!n.firstChild&&(n.firstChild.tagName==='SPAN'||n.firstChild.tagName==='A');};var f=function(n){var o=u({node:n});var e=n.childNodes.length>1&&o.node.firstChild.tagName==='A'&&o.node.firstChild.textContent==='';o=e?{node:o.node.childNodes[1],symbol:o.symbol}:o;while(h(o.node)){o=u({node:o.node.firstChild,symbol:o.symbol});}return{node:o.node.firstChild,symbol:o.symbol};};var i=function(s,t){if(!T.isStartOf('SPAN')(s,t)||!s.openedTag.get())return false;var n=s.openedTag.get().getNode();var e=f(n);var g=e.node&&e.node.nodeType===3?c:I;return g.is(s,e.node,e.symbol);};return{isUnofficialList:i};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.pastiche.inspect.Lists',['ephox.pastiche.engine.TokenUtil','ephox.pastiche.inspect.Browser','ephox.pastiche.inspect.Comments','ephox.pastiche.inspect.Microsoft','ephox.pastiche.inspect.Tags','ephox.pastiche.list.detect.ListDetect','ephox.pastiche.list.detect.ListTypes','ephox.perhaps.Option'],function(T,c,e,M,f,L,g,O){var h=function(t){var m=T.getMsoList(t);var n=/ level([0-9]+)/.exec(m);return n&&n[1]?O.some(parseInt(n[1],10)):O.none();};var i=function(s,t){return f.isStart(s,t)&&M.isList(s,t)&&t.tag()!=='LI';};var j=function(s,t){return i(s,t)&&h(t).isSome();};var k=function(s,t){return i(s,t)&&h(t).isNone();};var l=function(s,t){var m=c.supportsCustomStyles();return!m&&e.isListSupport(s,t)||L.isUnofficialList(s,t);};return{getLevel:h,isStart:i,isValidStart:j,isInvalidStart:k,isSpecial:l};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.pastiche.list.stage.NoListState',['ephox.pastiche.inspect.Lists','ephox.pastiche.inspect.Markers','ephox.pastiche.inspect.Tags','ephox.pastiche.list.stage.Handler','ephox.pastiche.list.stage.Handlers','ephox.pastiche.list.state.Spans','ephox.pastiche.list.state.Transitions'],function(L,M,T,c,e,S,f){var g=function(h){var s=function(n,o,t){var p=L.getLevel(t);p.each(function(l){o.itemLevel.set(l+o.styleLevelAdjust.get());var u=f.isNext(o,m)?n.emitDeferred:n.dropDeferred;u();f.next(o,h());n.startTransaction();o.originalToken.set(t);o.commentMode.set(false);});};var i=function(l,n,t){if(T.isStartOf('SPAN')(n,t)){S.push(l,n,t);}f.next(n,h());l.startTransaction();n.originalToken.set(n.openedTag.get());n.commentMode.set(true);n.openedTag.set(null);l.dropDeferred();};var j=function(l,n,t){if(n.openedTag.get()){n.emitter.closeAllLists();l.emitDeferred();}n.openedTag.set(t);l.defer(t);};var k=function(l,n,t){n.emitter.closeAllLists();l.emitDeferred();n.openedTag.set(null);l.emit(t);f.next(n,m);};var m=e('NoListState',[c(L.isValidStart,s,'valid list so start it'),c(L.isInvalidStart,k,'invalid list so close lists'),c(L.isSpecial,i,'special list'),c(M.isEnd,S.deferAndPop,'closing marker'),c(M.isStart,S.deferAndPush,'starting marker'),c(T.isStart,j,'starting tag')],k);return m;};return{run:g};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.pastiche.list.stage.SkipEmptyParaState',['ephox.pastiche.inspect.Browser','ephox.pastiche.inspect.Logic','ephox.pastiche.inspect.Microsoft','ephox.pastiche.inspect.Tags','ephox.pastiche.inspect.Texts','ephox.pastiche.list.detect.ListDetect','ephox.pastiche.list.stage.Handler','ephox.pastiche.list.stage.Handlers','ephox.pastiche.list.state.Spans','ephox.pastiche.list.state.Transitions'],function(c,L,M,T,e,f,g,h,S,i){var j=function(n,l){var k=function(p,t){return T.isStartOf('SPAN')(p,t)&&p.spanCount.get().length===0;};var m=function(p,t){return(c.supportsCustomStyles()||!f.isUnofficialList(p,t))&&!M.isList(p,t);};var s=function(p,t,u){p.defer(u);t.skippedPara.set(true);t.openedTag.set(null);i.next(t,l());};var o=function(p,t,u){p.defer(u);};return h('SkipEmptyPara',[g(L.all([k,m]),S.deferAndPush,'first marker or not list'),g(T.isEndOf('SPAN'),S.deferAndPop,'end span'),g(T.isEndOf('P'),s,'end p'),g(T.isEnd,i.jump(n),'end tag'),g(e.isWhitespace,o,'whitespace')],i.jump(n));};return{run:j};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.pastiche.list.stage.SpacerState',['ephox.pastiche.inspect.Markers','ephox.pastiche.inspect.Tags','ephox.pastiche.list.stage.Handler','ephox.pastiche.list.stage.Handlers','ephox.pastiche.list.state.Spans','ephox.pastiche.list.state.Transitions','ephox.peanut.Fun'],function(M,T,c,e,S,f,g){var h=function(i){return e('Spacer',[c(M.isEnd,S.popThen(i),'end marker'),c(T.isEnd,f.setNext(i),'end tag')],g.noop);};return{run:h};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.pastiche.list.emit.Emission',['ephox.scullion.Struct'],function(S){var c=S.immutable('state','result');var v=S.immutable('state','value');var s=S.immutable('level','type','types','items');return{state:s,value:v,result:c};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.pastiche.list.emit.ItemStack',['ephox.pastiche.list.emit.Emission','ephox.perhaps.Option'],function(c,O){var f=function(e){var g=e.items().slice(0);if(g.length>0&&g[g.length-1]!=='P'){var i=g[g.length-1];g[g.length-1]='P';var n=c.state(e.level(),e.type(),e.types(),g);return c.value(n,O.some(i));}else{return c.value(e,O.none());}};var s=function(e,t){var g=e.items().slice(0);var h=t!==undefined&&t!=='P'?O.some(t):O.none();h.fold(function(){g.push('P');},function(v){g.push(v);});var n=c.state(e.level(),e.type(),e.types(),g);return c.value(n,h);};return{start:s,finish:f};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.pastiche.list.emit.ListLevels',['ephox.pastiche.list.emit.Emission'],function(c){var m=function(s,p,f){var t=[];var h=s;while(p(h)){var i=f(h);h=i.state();t=t.concat(i.result());}return c.result(h,t);};var e=function(f,l,o){var p=function(s){return s.level()<l;};return m(f,p,o);};var g=function(s,l,f){var p=function(s){return s.level()>l;};return m(s,p,f);};return{moveRight:e,moveLeft:g,moveUntil:m};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.pastiche.list.emit.ListItemStyles',['ephox.pastiche.engine.TokenUtil'],function(T){var u=function(t){var l=T.getStyle(t,'margin-left');return l!==undefined&&l!=='0px'?{'margin-left':l}:{};};var f=function(t){var n={'list-style-type':'none'};return!t?n:u(t);};return{from:f};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.pastiche.list.emit.SkippedTokens',['ephox.pastiche.engine.Token','ephox.peanut.Fun'],function(T,c){var p=function(e){return[c.curry(T.createStartElement,'P',{},{}),c.curry(T.createText,'\u00A0'),c.curry(T.createEndElement,'P')];};return{para:p};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,b,c){a('ephox.pastiche.list.emit.ListTokens',['ephox.pastiche.cleanup.Cleaners','ephox.pastiche.engine.Token','ephox.pastiche.list.detect.ListTypes','ephox.pastiche.list.emit.Emission','ephox.pastiche.list.emit.ItemStack','ephox.pastiche.list.emit.ListItemStyles','ephox.pastiche.list.emit.SkippedTokens','ephox.peanut.Fun'],function(e,T,L,f,I,g,S,h){var o=function(l,t,m){var n=t.start&&t.start>1?{start:t.start}:{};var p=l.level()+1;var r=t;var u=l.types().concat([t]);var v=[h.curry(T.createStartElement,t.tag,n,m)];var w=f.state(p,r,u,l.items());return f.result(w,v);};var i=function(l){var m=l.types().slice(0);var r=[h.curry(T.createEndElement,m.pop().tag)];var n=l.level()-1;var p=m[m.length-1];var t=f.state(n,p,m,l.items());return f.result(t,r);};var s=function(l,t,m){var n=i(l);var p=m?S.para():[];var r=o(n.state(),t,t.type?{'list-style-type':t.type}:{});return f.result(r.state(),n.result().concat(p).concat(r.result()));};var j=function(l,p,t,m){var n={};var r=g.from(p);var u=l.type()&&!L.eqListType(l.type(),t)?s(l,t,m):f.result(l,[]);var w=[h.curry(T.createStartElement,'LI',n,r)];var x=I.start(u.state(),p&&p.tag());var y=x.value().map(function(v){e.styleDom(p.getNode(),h.constant(true));return[h.constant(p)];}).getOr([]);return f.result(x.state(),u.result().concat(w).concat(y));};var k=function(l){var m=h.curry(T.createEndElement,'LI');var n=I.finish(l);var r=n.value().fold(function(){return[m];},function(p){return[h.curry(T.createEndElement,p),m];});return f.result(n.state(),r);};return{open:o,openItem:j,close:i,closeItem:k};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.pastiche.list.emit.ListModel',['ephox.compass.Arr','ephox.pastiche.engine.Token','ephox.pastiche.list.emit.Emission','ephox.pastiche.list.emit.ItemStack','ephox.pastiche.list.emit.ListLevels','ephox.pastiche.list.emit.ListTokens','ephox.peanut.Fun','ephox.perhaps.Option'],function(c,T,e,I,L,f,g,O){var h=function(s){if(s.length===0)throw'Compose must have at least one element in the list';var t=s[s.length-1];var u=c.bind(s,function(v){return v.result();});return e.result(t.state(),u);};var i=function(s){var t=f.closeItem(s);var u=f.close(t.state());return h([t,u]);};var o=function(s,t,u,v){var w=s.level()===u-1&&t.type?{'list-style-type':t.type}:{};var x=f.open(s,t,w);var y=f.openItem(x.state(),x.state().level()==u?v:undefined,t);return h([x,y]);};var j=function(s,t,u,v){var w=s.level()>0?f.closeItem(s):e.result(s,[]);var x=f.openItem(w.state(),u,t,v);return h([w,x]);};var k=function(t,u,v,w){return L.moveRight(t,v,function(s){return o(s,u,v,w);});};var l=function(s,t){return L.moveLeft(s,t,i);};var m=function(s,t,u,v){var w=u>1?I.finish(s):e.value(s,O.none());var x=w.value().map(function(K){return[g.curry(T.createEndElement,K)];}).getOr([]);var y=u-w.state().level();var J=k(w.state(),t,u,v);return e.result(J.state(),x.concat(J.result()));};var n=function(s,t,u,v,w){var x=s.level()>t?l(s,t):e.result(s,[]);var y=x.state().level()===t?j(x.state(),v,u,w):m(x.state(),v,t,u);return h([x,y]);};var p=l;return{openItem:n,closeAllLists:p};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.pastiche.list.emit.Emitter',['ephox.compass.Arr','ephox.pastiche.list.emit.Emission','ephox.pastiche.list.emit.ListModel'],function(c,e,L){var i=['disc','circle','square'];var f=function(t,l){if(t.tag==='UL'){if(i[l-1]===t.type){t={tag:'UL'};}}return t;};return function(g,h){var s=e.state(0,undefined,[],[]);var j=function(n){c.each(n.result(),function(x){var t=x(h);g.emit(t);});};var k=function(){var n=L.closeAllLists(s,0);s=n.state();j(n);g.commit();};var o=function(n,p,t,u){var v={},w;if(!t)return;var x=f(t,n);var y=L.openItem(s,n,p,x,u);s=y.state();j(y);};var l=function(){return s.level();};var m=function(){return s.type();};return{closeAllLists:k,openItem:o,getCurrentListType:m,getCurrentLevel:l};};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.pastiche.list.indent.ListIndent',['ephox.compass.Arr','ephox.pastiche.engine.TokenUtil','ephox.violin.Strings','global!Math'],function(c,T,S,M){var g=function(n,p){var h,j,o=0;h=n.parentNode;while(h!==null&&h!==p.parentNode){o+=h.offsetLeft;h=h.offsetParent;}return o;};var e=function(n){if(n.ownerDocument.defaultView){return n.ownerDocument.defaultView.getComputedStyle(n,null);}return n.currentStyle||{};};var m=function(h){var j={};return function(p,k){var l,n=p+","+k;if(j.hasOwnProperty(n)){return j[n];}l=h.call(null,p,k);j[n]=l;return l;};};var f=m(function(h,j){var k,l=/([^{]+){([^}]+)}/g,n,o,p;l.lastIndex=0;while((k=l.exec(h))!==null&&!n){c.each(k[1].split(','),function(s){var t=s.indexOf('.');if(t>=0&&S.trim(s.substring(t+1))===j){n=k[2];return false;}});}if(n){o=document.createElement('p');o.setAttribute("style",n);p=e(o);return p?""+p.marginLeft:false;}return false;});var i=function(){var l;var h;var j=function(k,t,s,n){var o,p,u,v=1;if(n&&/^([0-9]+\.)+[0-9]+\.?$/.test(n.text)){return n.text.replace(/([0-9]+|\.$)/g,'').length+1;}o=h||parseInt(f(s,T.getAttribute(t,'class')));p=g(k.getNode(),t.getNode());if(!o){o=48;}else{if(l){p+=l;}else if(p===0){l=o;p+=o;}}h=o=M.min(p,o);v=M.max(1,M.floor(p/o))||1;return v;};return{guessIndentLevel:j};};return{indentGuesser:i};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.pastiche.list.state.ListStyles',['ephox.pastiche.engine.Token'],function(T){return function(){var i=false;var s="";var c=function(t){if(i&&t.type()===T.TEXT_TYPE){s+=t.text();return true;}else if(t.type()===T.START_ELEMENT_TYPE&&t.tag()==='STYLE'){i=true;return true;}else if(t.type()===T.END_ELEMENT_TYPE&&t.tag()==='STYLE'){i=false;return true;}return false;};return{check:c};};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.pastiche.list.state.ListState',['ephox.pastiche.list.emit.Emitter','ephox.pastiche.list.indent.ListIndent','ephox.pastiche.list.state.ListStyles','ephox.peanut.Fun','ephox.scullion.Cell'],function(c,L,e,f,g){var i=L.indentGuesser();var s=e();var h={getCurrentListType:function(){return l().getCurrentListType();},getCurrentLevel:function(){return l().getCurrentLevel();},closeAllLists:function(){return l().closeAllLists.apply(undefined,arguments);},openItem:function(){return l().openItem.apply(undefined,arguments);}};var l=function(){return{getCurrentListType:f.constant({}),getCurrentLevel:f.constant(1),closeAllLists:f.identity,openItem:f.identity};};return function(j){var n=g(j);var k=g(0);var o=g(null);var m=g(false);var p=g(null);var t=g(false);var u=g(null);var v=g([]);var w=g(false);var x=g(0);var y=g(undefined);var I=g([]);var J=function(K){n.set(j);k.set(0);o.set(null);m.set(false);p.set(null);t.set(false);u.set(null);v.set([]);w.set(false);x.set(0);y.set(undefined);I.set([]);_emitter=c(K,K.document);l=f.constant(_emitter);};return{reset:J,nextFilter:n,itemLevel:k,originalToken:o,commentMode:m,openedTag:p,symbolFont:t,listType:u,spanCount:v,skippedPara:w,styleLevelAdjust:x,bulletInfo:y,logger:I,emitter:h,styles:s,indentGuesser:i};};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.pastiche.filter.Lists',['ephox.pastiche.engine.Filter','ephox.pastiche.list.detect.ListTypes','ephox.pastiche.list.stage.AfterListState','ephox.pastiche.list.stage.AfterNoBulletListState','ephox.pastiche.list.stage.BeforeSpacerState','ephox.pastiche.list.stage.CloseSpansState','ephox.pastiche.list.stage.FindListTypeState','ephox.pastiche.list.stage.ItemContentState','ephox.pastiche.list.stage.ListStartState','ephox.pastiche.list.stage.NoListState','ephox.pastiche.list.stage.SkipEmptyParaState','ephox.pastiche.list.stage.SpacerState','ephox.pastiche.list.state.ListState','ephox.pastiche.list.state.Transitions'],function(c,L,e,f,g,h,i,I,j,N,S,k,l,T){var u=function(M,O){var P='Type: '+O.type()+', Tag: '+O.tag()+' Text: '+O.text();console.log('Unexpected token in list conversion: '+P,J.nextFilter.get());M.rollback();};var n=N.run(function(){return y;});var s=S.run(n,function(){return m;});var m=e.run(s,n);var o=I.run(m);var p=h.run(o,u);var t=k.run(p);var v=g.run(t,p,u);var w=i.run(v,u);var x=f.run(m);var y=j.run(w,x,u);var J=l(n);var K=function(M,O){if(J.styles&&J.styles.check(O)){return;}J.symbolFont.set(L.checkFont(O,J.symbolFont.get()));T.go(M,J,O);};return c.createFilter(K,J.reset,'lists');});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.limbo.process.Strategies',['ephox.pastiche.api.HtmlPatterns','ephox.pastiche.api.HybridAction','ephox.pastiche.api.RuleConditions','ephox.pastiche.api.RuleMutations','ephox.pastiche.filter.Lists','ephox.peanut.Fun','ephox.sugar.api.Class','ephox.sugar.api.Css','ephox.violin.StringMatch'],function(c,e,R,f,L,g,h,i,S){var u=e.unwrapper({tags:[{name:S.pattern(/^([OVWXP]|U[0-9]+|ST[0-9]+):/i)}]});var p=e.pipeline([L]);var j=e.removal({attributes:[{name:S.pattern(/^v:/)},{name:S.exact('href'),value:S.contains('#_toc')},{name:S.exact('href'),value:S.contains('#_mso')},{name:S.pattern(/^xmlns(:|$)/)},{name:S.exact('type'),condition:R.isList}]});var k=e.removal({tags:[{name:S.exact('script')},{name:S.exact('meta')},{name:S.exact('link')},{name:S.exact('style'),condition:R.isEmpty}],attributes:[{name:S.starts('on')},{name:S.exact('"')},{name:S.exact('id')},{name:S.exact('name')},{name:S.exact('lang')},{name:S.exact('language')}],styles:[{name:S.all(),value:S.pattern(/OLE_LINK/i)}]});var l=function(P){return!h.has(P,'ephox-limbo-transform');};var m=e.removal({styles:[{name:S.not(S.pattern(/width|height|list-style-type/)),condition:l},{name:S.pattern(/width|height/),condition:R.isNotImage}]});var n=e.removal({classes:[{name:S.not(S.exact('rtf-data-image'))}]});var o=e.removal({styles:[{name:S.pattern(c.validStyles())}]});var s=e.removal({classes:[{name:S.pattern(/mso/i)}]});var t=e.unwrapper({tags:[{name:S.exact('img'),condition:R.isLocal},{name:S.exact('a'),condition:R.hasNoAttributes}]});var v=e.unwrapper({tags:[{name:S.exact('a'),condition:R.hasNoAttributes}]});var w=e.removal({attributes:[{name:S.exact('style'),value:S.exact(''),debug:true}]});var x=e.removal({attributes:[{name:S.exact('class'),value:S.exact(''),debug:true}]});var y=e.unwrapper({tags:[{name:S.pattern(c.specialInline()),condition:g.not(R.hasContent)}]});var I=e.transformer({tags:[{name:S.exact('p'),mutate:f.addBrTag}]});var J=function(P){var Q=f.changeTag('span',P);h.add(Q,'ephox-limbo-transform');i.set(Q,'text-decoration','underline');};var K=e.transformer({tags:[{name:S.pattern(/ol|ul/),mutate:f.properlyNest}]});var M=e.transformer({tags:[{name:S.exact('b'),mutate:g.curry(f.changeTag,'strong')},{name:S.exact('i'),mutate:g.curry(f.changeTag,'em')},{name:S.exact('u'),mutate:J},{name:S.exact('s'),mutate:g.curry(f.changeTag,'strike')},{name:S.exact('font'),mutate:f.fontToSpan,debug:true}]});var N=e.removal({classes:[{name:S.exact('ephox-limbo-transform')}]});var O=e.removal({attributes:[{name:S.exact('href'),value:S.starts('file:///'),debug:true}]});return{unwrapWordTags:u,removeWordAttributes:j,parseLists:p,removeExcess:k,cleanStyles:m,cleanClasses:n,mergeStyles:o,mergeClasses:s,removeLocalImages:t,removeVacantLinks:v,removeEmptyStyle:w,removeEmptyClass:x,pruneInlineTags:y,addPlaceholders:I,nestedListFixes:K,inlineTagFixes:M,cleanupFlags:N,removeLocalLinks:O,none:g.noop};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.limbo.process.PasteFilters',['ephox.compass.Arr','ephox.limbo.api.RtfImage','ephox.limbo.process.Strategies','ephox.pastiche.api.HybridAction','ephox.pastiche.engine.Filter','ephox.pastiche.engine.Token','ephox.sugar.api.Element'],function(c,R,S,e,g,T,h){var i=function(p){return p.browser.isIE()&&p.browser.version.major>=11;};var t=function(f){return g.createFilter(function(l,m){var n=f(h.fromDom(m.getNode())).fold(function(){return m;},function(o){var p=o.dom();return T.token(p,m.type()===T.END_ELEMENT_TYPE,{});});l.emit(n);});};var j=function(f,m,p){var l=p.browser.isFirefox()?R.local:R.vshape;var n=i(p)?S.none:e.pipeline([t(l)]);var o=l===R.local?S.none:S.removeLocalImages;var u=f?n:S.none;return{annotate:[u],local:[o]};};var s=function(f,m,p){var l=[S.mergeStyles,S.mergeClasses];var n=[S.cleanStyles,S.cleanClasses];return m?l:n;};var w=function(f,m,p){if(!f)return[S.none];var l=[S.unwrapWordTags];var n=i(p)?[]:S.parseLists;return l.concat(n).concat([S.removeWordAttributes]);};var k=function(f,m,p){var l=j(f,m,p);return c.flatten([l.annotate,[S.inlineTagFixes],w(f,m,p),[S.nestedListFixes],[S.removeExcess],l.local,s(f,m,p),[S.removeLocalLinks,S.removeVacantLinks],[S.removeEmptyStyle],[S.removeEmptyClass],[S.pruneInlineTags],[S.addPlaceholders],[S.cleanupFlags]]);};return{derive:k};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.boss.common.TagBoundaries',[],function(){return['body','p','div','article','aside','figcaption','figure','footer','header','nav','section','ol','ul','li','table','thead','tbody','tfoot','caption','tr','td','th','h1','h2','h3','h4','h5','h6','blockquote','pre','address'];});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.boss.api.DomUniverse',['ephox.boss.common.TagBoundaries','ephox.compass.Arr','ephox.peanut.Fun','ephox.sugar.api.Attr','ephox.sugar.api.Compare','ephox.sugar.api.Css','ephox.sugar.api.Element','ephox.sugar.api.Insert','ephox.sugar.api.InsertAll','ephox.sugar.api.Node','ephox.sugar.api.PredicateFilter','ephox.sugar.api.PredicateFind','ephox.sugar.api.Remove','ephox.sugar.api.SelectorFilter','ephox.sugar.api.SelectorFind','ephox.sugar.api.Text','ephox.sugar.api.Traverse'],function(T,c,e,f,g,h,i,I,j,N,P,k,R,S,l,m,n){return function(){var o=function(v){return i.fromDom(v.dom().cloneNode(false));};var p=function(v){if(!N.isElement(v))return false;if(N.name(v)==='body')return true;return c.contains(T,N.name(v));};var s=function(v){if(!N.isElement(v))return false;return c.contains(['br','img','hr'],N.name(v));};var t=function(v,w){return v.dom().compareDocumentPosition(w.dom());};var u=function(v,w){var x=f.clone(v);f.setAll(w,x);};return{up:e.constant({selector:l.ancestor,closest:l.closest,predicate:k.ancestor,all:n.parents}),down:e.constant({selector:S.descendants,predicate:P.descendants}),styles:e.constant({get:h.get,set:h.set,remove:h.remove}),attrs:e.constant({get:f.get,set:f.set,remove:f.remove,copyTo:u}),insert:e.constant({before:I.before,after:I.after,afterAll:j.after,append:I.append,appendAll:j.append,prepend:I.prepend,wrap:I.wrap}),remove:e.constant({unwrap:R.unwrap,remove:R.remove}),create:e.constant({nu:i.fromTag,clone:o,text:i.fromText}),query:e.constant({comparePosition:t,prevSibling:n.prevSibling,nextSibling:n.nextSibling}),property:e.constant({children:n.children,name:N.name,parent:n.parent,isText:N.isText,isElement:N.isElement,getText:m.get,setText:m.set,isBoundary:p,isEmptyTag:s}),eq:g.eq,is:g.is};};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.phoenix.api.data.NamedPattern',['ephox.scullion.Struct'],function(S){return S.immutable('word','pattern');});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.phoenix.api.data.Spot',['ephox.scullion.Struct'],function(S){var p=S.immutable('element','offset');var c=S.immutable('element','deltaOffset');var e=S.immutable('element','start','finish');var f=S.immutable('begin','end');var t=S.immutable('element','text');return{point:p,delta:c,range:e,points:f,text:t};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,c){a('ephox.phoenix.extract.TypedItem',['ephox.peanut.Fun','ephox.perhaps.Option'],function(f,O){var n=f.constant(false);var y=f.constant(true);var g=function(l,u){return j(function(b,e,t){return b(l,u);});};var h=function(l,u){return j(function(b,e,t){return e(l,u);});};var i=function(l,u){return j(function(b,e,t){return t(l,u);});};var j=function(b){var e=function(){return b(y,n,n);};var t=function(){return b(O.none,O.none,function(o,u){return O.some(o);});};var l=function(o){return b(n,n,function(p,u){return u.eq(p,o);});};var m=function(){return b(f.constant(0),f.constant(1),function(o,u){return u.property().getText(o).length;});};return{isBoundary:e,fold:b,toText:t,is:l,len:m};};var k=function(s,o,b,e){return s.fold(o,b,e);};return{text:i,boundary:g,empty:h,cata:k};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.polaris.array.Boundaries',['ephox.compass.Arr','ephox.peanut.Fun'],function(c,e){var f=function(x,l,g,h){var i=c.findIndex(x,e.curry(h,l));var j=i>-1?i:0;var k=c.findIndex(x,e.curry(h,g));var m=k>-1?k+1:x.length;return x.slice(j,m);};return{boundAt:f};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.polaris.array.Slice',['ephox.compass.Arr'],function(c){var s=function(l,p){var i=c.findIndex(l,p);return l.slice(0,i);};return{sliceby:s};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.polaris.api.Splitting',['ephox.scullion.ADT'],function(c){var e=c.generate([{include:['item']},{excludeWith:['item']},{excludeWithout:['item']}]);var f=function(s,o,g,h){return s.fold(o,g,h);};return{include:e.include,excludeWith:e.excludeWith,excludeWithout:e.excludeWithout,cata:f};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,b,c){a('ephox.polaris.array.Split',['ephox.compass.Arr','ephox.polaris.api.Splitting'],function(e,S){var s=function(g,p){return f(g,function(x){return p(x)?S.excludeWithout(x):S.include(x);});};var f=function(g,p){var r=[];var h=[];e.each(g,function(x){var i=p(x);S.cata(i,function(){h.push(x);},function(){if(h.length>0)r.push(h);r.push([x]);h=[];},function(){if(h.length>0)r.push(h);h=[];});});if(h.length>0)r.push(h);return r;};return{splitby:s,splitbyAdv:f};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.polaris.api.Arrays',['ephox.polaris.array.Boundaries','ephox.polaris.array.Slice','ephox.polaris.array.Split'],function(c,S,e){var f=function(x,l,i,j){return c.boundAt(x,l,i,j);};var s=function(i,p){return e.splitby(i,p);};var g=function(i,p){return e.splitbyAdv(i,p);};var h=function(i,p){return S.sliceby(i,p);};return{splitby:s,splitbyAdv:g,sliceby:h,boundAt:f};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(c,r,f){c('ephox.phoenix.extract.TypedList',['ephox.compass.Arr','ephox.peanut.Fun','ephox.perhaps.Option','ephox.phoenix.api.data.Spot','ephox.polaris.api.Arrays'],function(g,h,O,S,j){var k=function(p){return g.foldr(p,function(b,a){return a.len()+b;},0);};var l=function(p,t){return j.sliceby(p,function(x){return x.is(t);});};var m=function(u,s){return u.fold(O.none,function(e){return O.some(S.range(e,s,s+1));},function(t){return O.some(S.range(t,s,s+u.len()));});};var n=function(p){return g.bind(p,function(x){return x.fold(h.constant([]),h.constant([]),function(i){return[i];});});};return{count:k,dropUntil:l,gen:m,justText:n};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.phoenix.extract.Extract',['ephox.compass.Arr','ephox.phoenix.api.data.Spot','ephox.phoenix.extract.TypedItem','ephox.phoenix.extract.TypedList'],function(c,S,T,e){var t=function(u,j,o){if(u.property().isText(j)){return[T.text(j,u)];}else if(u.property().isEmptyTag(j)){return[T.empty(j,u)];}else if(u.property().isElement(j)){var k=u.property().children(j);var l=u.property().isBoundary(j)?[T.boundary(j,u)]:[];var m=o!==undefined&&o(j)?[]:c.bind(k,function(n){return t(u,n,o);});return l.concat(m).concat(l);}else{return[];}};var i=function(u,j,o){var k=t(u,j,o);var l=function(j,u){return j;};return c.map(k,function(m){return m.fold(l,l,l);});};var f=function(u,j,o,k,l){var m=t(u,k,l);var p=e.dropUntil(m,j);var n=e.count(p);return S.point(k,n+o);};var g=function(u,j,o,k){return u.property().parent(j).fold(function(){return S.point(j,o);},function(p){return f(u,j,o,p,k);});};var h=function(u,j,o,p,k){return u.up().predicate(j,p).fold(function(){return S.point(j,o);},function(v){return f(u,j,o,v,k);});};return{typed:t,items:i,extractTo:h,extract:g};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.phoenix.extract.ExtractText',['ephox.compass.Arr','ephox.peanut.Fun','ephox.phoenix.extract.Extract'],function(c,e,f){var n='\n';var s=' ';var o=function(i,u){return u.property().name(i)==='img'?s:n;};var g=function(u,i,h){var j=f.typed(u,i,h);return c.map(j,function(t){return t.fold(e.constant(n),o,u.property().getText);}).join('');};return{from:g};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(c,e,g){c('ephox.polaris.parray.Generator',['ephox.compass.Arr','ephox.peanut.Fun'],function(h,i){var m=function(x,f,_){var j={len:_!==undefined?_:0,list:[]};var r=h.foldl(x,function(b,a){var k=f(a,b.len);return k.fold(i.constant(b),function(v){return{len:v.finish(),list:b.list.concat([v])};});},j);return r.list;};return{make:m};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.polaris.parray.Query',['ephox.compass.Arr','ephox.perhaps.Option'],function(c,O){var i=function(u,p){return p>=u.start()&&p<=u.finish();};var g=function(p,o){var u=c.find(p,function(x){return i(x,o);});return O.from(u);};var s=function(p,o){return c.findIndex(p,function(u){return u.start()===o;});};var t=function(p,h){var j=p[p.length-1]&&p[p.length-1].finish()===h;return j?p.length+1:-1;};var e=function(p,h,j){var k=s(p,h);var l=s(p,j);var m=l>-1?l:t(p,j);return k>-1&&m>-1?p.slice(k,m):[];};var f=function(p,h){return O.from(c.find(p,h));};return{get:g,find:f,inUnit:i,sublist:e};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.polaris.parray.Translate',['ephox.compass.Arr','ephox.highway.Merger','ephox.peanut.Fun'],function(c,M,e){var t=function(p,o){return c.map(p,function(u){return M.merge(u,{start:e.constant(u.start()+o),finish:e.constant(u.finish()+o)});});};return{translate:t};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.polaris.parray.Split',['ephox.compass.Arr','ephox.polaris.parray.Query','ephox.polaris.parray.Translate'],function(c,Q,T){var e=function(u,p,f){var m=f(u,p);return T.translate(m,u.start());};var s=function(p,f,g){if(f.length===0)return p;return c.bind(p,function(u){var h=c.bind(f,function(i){return Q.inUnit(u,i)?[i-u.start()]:[];});return h.length>0?e(u,h,g):[u];});};return{splits:s};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.polaris.api.PositionArray',['ephox.polaris.parray.Generator','ephox.polaris.parray.Query','ephox.polaris.parray.Split','ephox.polaris.parray.Translate'],function(c,Q,S,T){var g=function(i,j,_){return c.make(i,j,_);};var e=function(p,o){return Q.get(p,o);};var f=function(p,i){return Q.find(p,i);};var s=function(p,i,j){return S.splits(p,i,j);};var t=function(p,i){return T.translate(p,i);};var h=function(p,i,j){return Q.sublist(p,i,j);};return{generate:g,get:e,find:f,splits:s,translate:t,sublist:h};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.phoenix.extract.Find',['ephox.phoenix.api.data.Spot','ephox.phoenix.extract.Extract','ephox.phoenix.extract.TypedList','ephox.polaris.api.PositionArray'],function(S,c,T,P){var f=function(u,p,o,e){var g=c.typed(u,p,e);var h=P.generate(g,T.gen);var s=P.get(h,o);return s.map(function(v){return S.point(v.element(),o-v.start());});};return{find:f};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.phoenix.api.general.Extract',['ephox.phoenix.extract.Extract','ephox.phoenix.extract.ExtractText','ephox.phoenix.extract.Find'],function(c,e,f){var g=function(u,l,o){return c.typed(u,l,o);};var h=function(u,l,o){return c.items(u,l,o);};var i=function(u,l,o,m){return c.extract(u,l,o,m);};var j=function(u,l,o,p,m){return c.extractTo(u,l,o,p,m);};var k=function(u,p,o,l){return f.find(u,p,o,l);};var t=function(u,l,o){return e.from(u,l,o);};return{extract:i,extractTo:j,all:h,from:g,find:k,toText:t};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.phoenix.family.Group',['ephox.compass.Arr','ephox.phoenix.api.general.Extract','ephox.phoenix.extract.TypedItem','ephox.polaris.api.Arrays','ephox.polaris.api.Splitting'],function(c,e,T,f,S){var g=function(u,i,o){var h=c.bind(i,function(j){return e.from(u,j,o);});var s=f.splitbyAdv(h,function(j){return T.cata(j,function(){return S.excludeWithout(j);},function(){return S.excludeWith(j);},function(){return S.include(j);});});return c.filter(s,function(x){return x.length>0;});};return{group:g};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,b,c){a('ephox.phoenix.family.Parents',['ephox.compass.Arr','ephox.perhaps.Option'],function(e,O){var f=function(u,i,g){var h=[i].concat(u.up().all(i));var j=[g].concat(u.up().all(g));var r=e.find(h,function(x){return e.exists(j,function(y){return u.eq(y,x);});});return O.from(r);};return{common:f};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.phoenix.wrap.OrphanText',['ephox.compass.Arr'],function(c){var t=['table','tbody','thead','tfoot','tr','ul','ol'];return function(u){var e=u.property();var v=function(n,g){return e.parent(n).map(e.name).map(function(h){return!c.contains(g,h);}).getOr(false);};var f=function(g){return e.isText(g)&&v(g,t);};return{validateText:f};};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(c,r,e){c('ephox.phoenix.family.Range',['ephox.compass.Arr','ephox.peanut.Fun','ephox.phoenix.api.general.Extract','ephox.phoenix.family.Parents','ephox.phoenix.wrap.OrphanText'],function(f,g,h,P,O){var i=function(u,a,b){return f.findIndex(a,g.curry(u.eq,b));};var o=function(k,a,l,b,m){return a<b?k.slice(a+l,b+m):k.slice(b+m,a+l);};var j=function(u,a,b,k,l){if(u.eq(a,k))return[a];return P.common(u,a,k).fold(function(){return[];},function(p){var m=[p].concat(h.all(u,p,g.constant(false)));var s=i(u,m,a);var n=i(u,m,k);var t=s>-1&&n>-1?o(m,s,b,n,l):[];var v=O(u);return f.filter(t,v.validateText);});};return{range:j};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.phoenix.api.general.Family',['ephox.phoenix.family.Group','ephox.phoenix.family.Range'],function(c,R){var e=function(u,s,f,h,i){return R.range(u,s,f,h,i);};var g=function(u,i,o){return c.group(u,i,o);};return{range:e,group:g};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,b,c){a('ephox.polaris.string.Sanitise',[],function(){var e=function(s){var r=/^[a-zA-Z]/.test(s)?'':'e';var f=s.replace(/[^\w]/gi,'-');return r+f;};return{css:e};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.polaris.string.Split',['ephox.compass.Arr'],function(c){var s=function(v,i){if(i.length===0)return[v];var e=c.foldl(i,function(f,x){if(x===0)return f;var p=v.substring(f.prev,x);return{prev:x,values:f.values.concat([p])};},{prev:0,values:[]});var l=i[i.length-1];return l<v.length?e.values.concat(v.substring(l)):e.values;};return{splits:s};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.polaris.api.Strings',['ephox.polaris.string.Sanitise','ephox.polaris.string.Split'],function(S,c){var s=function(t,p){return c.splits(t,p);};var e=function(f){return S.css(f);};return{cssSanitise:e,splits:s};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(b,r,c){b('ephox.phoenix.search.Splitter',['ephox.compass.Arr','ephox.perhaps.Option','ephox.phoenix.api.data.Spot','ephox.polaris.api.PositionArray','ephox.polaris.api.Strings'],function(e,O,S,P,f){var s=function(u,i,p){var t=u.property().getText(i);var g=e.filter(f.splits(t,p),function(a){return a.length>0;});if(g.length<=1)return[S.range(i,0,t.length)];u.property().setText(i,g[0]);var o=P.generate(g.slice(1),function(a,j){var n=u.create().text(a);var k=S.range(n,j,j+a.length);return O.some(k);},g[0].length);var h=e.map(o,function(a){return a.element();});u.insert().afterAll(i,h);return[S.range(i,0,g[0].length)].concat(o);};return{subdivide:s};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.phoenix.search.MatchSplitter',['ephox.compass.Arr','ephox.peanut.Fun','ephox.phoenix.search.Splitter','ephox.polaris.api.PositionArray'],function(c,e,S,P){var s=function(u,l,m){var f=c.bind(m,function(j){return[j.start(),j.finish()];});var g=function(j,p){return S.subdivide(u,j.element(),p);};var h=P.splits(l,f,g);var i=function(j){var k=P.sublist(h,j.start(),j.finish());var n=c.map(k,function(p){return p.element();});var o=c.map(n,u.property().getText).join('');return{elements:e.constant(n),word:j.word,exact:e.constant(o)};};return c.map(m,i);};return{separate:s};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.polaris.pattern.Chars',['ephox.bud.Unicode','ephox.peanut.Fun'],function(U,c){var e='\\w'+'\''+'\\-'+'\\u00C0-\\u00FF'+U.zeroWidth()+'\\u2018\\u2019';var w='[^'+e+']';var f='['+e+']';return{chars:c.constant(e),wordbreak:c.constant(w),wordchar:c.constant(f)};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.polaris.pattern.Custom',['global!RegExp'],function(R){return function(c,p,s,f){var t=function(){return new R(c,f.getOr('g'));};return{term:t,prefix:p,suffix:s};};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.polaris.pattern.Unsafe',['ephox.peanut.Fun','ephox.perhaps.Option','ephox.polaris.pattern.Chars','ephox.polaris.pattern.Custom'],function(c,O,e,f){var t=function(i){return f(i,c.constant(0),c.constant(0),O.none());};var w=function(i){var g='((?:^\'?)|(?:'+e.wordbreak()+'+\'?))'+i+'((?:\'?$)|(?:\'?'+e.wordbreak()+'+))';var p=function(m){return m.length>1?m[1].length:0;};var s=function(m){return m.length>2?m[2].length:0;};return f(g,p,s,O.none());};return{token:t,word:w};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.polaris.pattern.Safe',['ephox.polaris.pattern.Unsafe'],function(U){var s=function(i){return i.replace(/[-\[\]{}()*+?.,\\\^$|#\s]/g,'\\$&');};var w=function(i){var v=s(i);return U.word(v);};var t=function(i){var v=s(i);return U.token(v);};return{sanitise:s,word:w,token:t};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.polaris.api.Pattern',['ephox.polaris.pattern.Chars','ephox.polaris.pattern.Custom','ephox.polaris.pattern.Safe','ephox.polaris.pattern.Unsafe'],function(c,e,S,U){var s=function(l){return S.word(l);};var f=function(l){return S.token(l);};var g=function(l,p,m,n){return e(l,p,m,n);};var u=function(l){return U.word(l);};var h=function(l){return U.token(l);};var i=function(l){return S.sanitise(l);};var j=function(){return c.chars();};var w=function(){return c.wordbreak();};var k=function(){return c.wordchar();};return{safeword:s,safetoken:f,custom:g,unsafeword:u,unsafetoken:h,sanitise:i,chars:j,wordbreak:w,wordchar:k};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,b,c){a('ephox.polaris.search.Find',['ephox.peanut.Fun'],function(e){var f=function(i,p){var t=p.term();var r=[];var m=t.exec(i);while(m){var s=m.index+p.prefix(m);var l=m[0].length-p.prefix(m)-p.suffix(m);r.push({start:e.constant(s),finish:e.constant(s+l)});t.lastIndex=s+l;m=t.exec(i);}return r;};return{all:f};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(c,e,f){c('ephox.polaris.search.Sleuth',['ephox.compass.Arr','ephox.highway.Merger','ephox.polaris.search.Find','global!Array'],function(g,M,h,i){var s=function(k){var r=i.prototype.slice.call(k,0);r.sort(function(a,b){if(a.start()<b.start())return-1;else if(b.start()<a.start())return 1;else return 0;});return r;};var j=function(a,b){var u=g.bind(b,function(t){var k=h.all(a,t.pattern());return g.map(k,function(r){return M.merge(t,{start:r.start,finish:r.finish});});});return s(u);};return{search:j};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.polaris.api.Search',['ephox.polaris.search.Find','ephox.polaris.search.Sleuth'],function(c,S){var f=function(i,p){return c.all(i,p);};var e=function(i,t){return S.search(i,t);};return{findall:f,findmany:e};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.phoenix.search.Searcher',['ephox.compass.Arr','ephox.perhaps.Option','ephox.phoenix.api.data.NamedPattern','ephox.phoenix.api.data.Spot','ephox.phoenix.api.general.Family','ephox.phoenix.extract.TypedList','ephox.phoenix.search.MatchSplitter','ephox.polaris.api.Pattern','ephox.polaris.api.PositionArray','ephox.polaris.api.Search'],function(c,O,N,S,e,T,M,P,f,g){var h=function(u,k){return f.generate(k,function(l,o){var m=o+u.property().getText(l).length;return O.from(S.range(l,o,m));});};var i=function(u,k,p,o){var l=e.group(u,k,o);var m=c.bind(l,function(x){var n=T.justText(x);var t=c.map(n,u.property().getText).join('');var v=g.findmany(t,p);var w=h(u,n);return M.separate(u,w,v);});return m;};var s=function(u,k,w,o){var p=c.map(w,function(l){var m=P.safeword(l);return N(l,m);});return i(u,k,p,o);};var j=function(u,k,t,o){var p=N(t,P.safetoken(t));return i(u,k,[p],o);};return{safeWords:s,safeToken:j,run:i};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.phoenix.api.general.Search',['ephox.phoenix.search.Searcher'],function(S){var c=function(u,i,p,o){return S.run(u,i,p,o);};var s=function(u,i,w,o){return S.safeWords(u,i,w,o);};var e=function(u,i,t,o){return S.safeToken(u,i,t,o);};return{safeWords:s,safeToken:e,run:c};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.phoenix.api.dom.DomSearch',['ephox.boss.api.DomUniverse','ephox.phoenix.api.general.Search'],function(c,S){var u=c();var e=function(g,p,o){return S.run(u,g,p,o);};var s=function(g,w,o){return S.safeWords(u,g,w,o);};var f=function(g,t,o){return S.safeToken(u,g,t,o);};return{safeWords:s,safeToken:f,run:e};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.sugar.api.SelectorExists',['ephox.sugar.api.SelectorFind'],function(S){var c=function(i){return S.first(i).isSome();};var e=function(i,j,k){return S.ancestor(i,j,k).isSome();};var s=function(i,j){return S.sibling(i,j).isSome();};var f=function(i,j){return S.child(i,j).isSome();};var g=function(i,j){return S.descendant(i,j).isSome();};var h=function(i,j,k){return S.closest(i,j,k).isSome();};return{any:c,ancestor:e,sibling:s,child:f,descendant:g,closest:h};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.limbo.process.Preprocessor',['ephox.compass.Arr','ephox.perhaps.Option','ephox.phoenix.api.dom.DomSearch','ephox.polaris.api.Pattern','ephox.scullion.Struct','ephox.sugar.api.Attr','ephox.sugar.api.Css','ephox.sugar.api.Element','ephox.sugar.api.Html','ephox.sugar.api.Insert','ephox.sugar.api.InsertAll','ephox.sugar.api.Node','ephox.sugar.api.SelectorExists'],function(c,O,e,P,S,f,g,h,i,I,j,N,k){var l='((([A-Za-z]{3,9}:(?:\\/\\/)?)(?:[\\-;:&=\\+\\$,\\w]+@)?[A-Za-z0-9\\.\\-]+|(?:www\\.|[\\-;:&=\\+\\$,\\w]+@)[A-Za-z0-9\\.\\-]+)(:[0-9]+)?((?:\\/[\\+~%\\/\\.\\w\\-_]*)?\\??(?:[\\-\\+=&;%@\\.\\w_]*)#?(?:[\\.\\!\\/\\\\\\w]*))?)';var m=function(s){var t=S.immutable('word','pattern');var u=P.unsafetoken(l);var v=t('__INTERNAL__',u);return e.run(s,[v]);};var n=function(s){return!k.closest(s,'a');};var w=function(s){return O.from(s[0]).filter(n).map(function(t){var u=h.fromTag('a');I.before(t,u);j.append(u,s);f.set(u,'href',i.get(u));return u;});};var o=function(s){var t=m(s);c.each(t,function(u){if(u.exact().indexOf('@')<0)w(u.elements());});};var p=function(s){c.each(s,function(t){if(N.isElement(t))g.remove(t,'position');});};return{links:o,position:p};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.limbo.api.RunPaste',['ephox.compass.Arr','ephox.limbo.process.PasteFilters','ephox.limbo.process.Preprocessor','ephox.pastiche.api.HybridAction','ephox.sugar.api.Html','ephox.sugar.api.Traverse'],function(c,P,e,g,h,T){var p=function(j){var k=T.children(j);c.each([e.links,e.position],function(f){f(k);});};var i=function(f,j,k,m,l){p(k);var n=h.get(k);var o=P.derive(l,m,j);return g.go(f,n,o);};return{go:i,preprocess:p};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.cement.pastiche.PasteTransfer',['ephox.cement.alien.FutureStep','ephox.cement.api.Bundle','ephox.cement.smartpaste.PasteResponse','ephox.fred.PlatformDetection','ephox.limbo.api.RunPaste','ephox.perhaps.Result','ephox.sugar.api.Elements','global!console'],function(c,f,P,g,R,h,i,j){var p=g.detect();var k=function(l,m,n,o){try{var s=R.go(l,p,m,n,o);var u=s!==undefined&&s!==null&&s.length>0;var v=u?i.fromHtml(s):[];return h.value(v);}catch(e){j.error(e);return h.error('errors.paste.process.failure');}};var t=function(e,l,m,n){var o=k(e,l,n,m);return o.fold(function(s){return c.error(s);},function(s){return c.sync(function(u){c.call(u,{response:P.paste(s,[]),bundle:f.nu({})});});});};return{transfer:t};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.cement.pastiche.OffscreenHandler',['ephox.cement.pastiche.PasteTransfer','ephox.compass.Arr','ephox.knoch.future.Future','ephox.perhaps.Option','ephox.sugar.api.Remove','ephox.sugar.api.Traverse'],function(P,c,e,O,R,T){var f=function(g,p,m,h){return P.transfer(g,p,h,m);};var i=function(g,h,p){var I=false;var M=true;var j=function(k,l){return(h!==undefined&&!l)?h.findClipboardTags(T.children(k)):O.none();};var t=j(p,I).getOr([]);c.each(t,R.remove);var n=e.nu(function(k){k([]);});return P.transfer(g,p,I,M,n);};return{internal:i,external:f};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.sugar.api.TextContent',[],function(){var g=function(e){return e.dom().textContent;};var s=function(e,v){e.dom().textContent=v;};return{get:g,set:s};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.cement.alien.TextToHtml',['ephox.compass.Arr','ephox.sugar.api.Element','ephox.sugar.api.Html','ephox.sugar.api.TextContent'],function(c,e,f,T){var g=function(t){var w=e.fromTag('div');T.set(w,t);return f.get(w);};var h=function(t){var i=t.trim().split(/\n{2,}|(?:\r\n){2,}/);var j=c.map(i,function(p){return p.split(/\n|\r\n/).join('<br />');});return j.length===1?j[0]:c.map(j,function(p){return'<p>'+p+'</p>';}).join('');};return{encode:g,convert:h};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.cement.plain.TextHandler',['ephox.cement.alien.FutureStep','ephox.cement.alien.TextToHtml','ephox.cement.api.Bundle','ephox.cement.smartpaste.Inspection','ephox.cement.smartpaste.PasteResponse','ephox.perhaps.Option','ephox.perhaps.Options','ephox.sugar.api.Elements','global!window'],function(c,T,e,I,P,O,f,g,w){var n=function(s){return s.length>0;};var h=function(k){if(!I.isValidData(k))return O.none();return f.findMap(k.types,function(t){return(t==='text/plain')?O.some(k.getData(t)):O.none();});};var i=function(){var k=w.clipboardData;return k!==undefined?O.some(k.getData('text')):O.none();};var p=function(k){var t=T.encode(k);var l=T.convert(t);var m=g.fromHtml(l);return P.paste(m,[]);};var j=function(k){return c.sync(function(l){var t=I.isValidData(k)?h:i;var m=t(k).filter(n).fold(P.cancel,p);c.call(l,{response:m,bundle:e.nu({})});});};return{handle:j};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.cement.step.PasteSteps',['ephox.cement.alien.FutureStep','ephox.cement.api.Bundle','ephox.cement.api.Bundles','ephox.cement.html.HtmlHandler','ephox.cement.images.ImageHandler','ephox.cement.pastiche.OffscreenHandler','ephox.cement.plain.TextHandler','ephox.cement.smartpaste.PasteResponse','ephox.fred.PlatformDetection','ephox.limbo.api.RunPaste','ephox.peanut.Fun','ephox.sugar.api.Element','ephox.sugar.api.InsertAll','ephox.sugar.api.Traverse','global!console'],function(c,e,f,g,I,O,T,P,h,R,i,j,k,l,m){var p=h.detect();var n=function(J,_,K){return T.handle(J);};var o=function(_,J){var K=function(M,N){var Q=j.fromTag('div');k.append(Q,M);R.preprocess(Q);var S=l.children(Q);return c.pure({response:P.paste(S,N),bundle:J.bundle()});};var L=i.curry(c.pass,J);return P.cata(J.response(),L,K,L,K);};var s=function(J,K){return function(_,L){var M=L.bundle();return f.proxyBin(M).handle('There was no proxy bin setup. Ensure you have run proxyStep first.',function(N){var Q=l.owner(J);return O.internal(Q,K,N);});};};var t=function(J,K){return function(L,M){var N=M.bundle();return f.proxyBin(N).handle('There was no proxy bin setup. Ensure you have run proxyStep first.',function(Q){var S=f.merging(N);var U=f.isWord(N);var V=f.isInternal(N);var W=l.owner(J);return V?O.internal(W,K,Q):O.external(W,Q,S,U);});};};var u=function(_){return function(J,K){return c.error('errors.local.images.disallowed');};};var v=function(J){return function(K,_){if(p.browser.isSafari())return c.error('safari.imagepaste');else return I.handle(K,J);};};var w=function(J){return function(K,L){var M=f.mergeOffice(L.bundle());return g.handle(K,M,J);};};var x=function(_,J){return c.cancel();};var y=function(J){return function(_,K){var L=e.merge(K.bundle(),e.nu(J));return c.pure({response:K.response(),bundle:L});};};return{plain:n,autolink:o,noImages:u,images:v,internal:s,external:t,gwt:w,setBundle:y,none:x};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.cement.api.CementConstants',['ephox.cement.style.Styles','ephox.peanut.Fun'],function(S,c){var e=S.resolve('smartpaste-eph-bin');return{binStyle:c.constant(e)};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.limbo.api.Sources',['ephox.pastiche.api.HybridAction','ephox.sugar.api.Attr','ephox.sugar.api.Html','ephox.sugar.api.PredicateExists'],function(c,e,f,P){var i=function(h){return P.descendant(h,function(j){return e.has(j,'style')?e.get(j,'style').indexOf('mso-')>-1:false;});};var o=function(h){var j=f.get(h);return c.isWordContent(j);};var g=function(p,h){var j=p.browser;var k=j.isIE()&&j.version.major>=11?i:o;return k(h);};return{isWord:g};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.cement.step.ProxyStep',['ephox.cement.alien.FutureStep','ephox.cement.api.Bundle','ephox.cement.api.CementConstants','ephox.fred.PlatformDetection','ephox.limbo.api.Sources','ephox.sugar.api.Class','ephox.sugar.api.Traverse'],function(c,e,f,P,S,g,T){var p=P.detect();return function(m,h,i,j){return function(k,l){var n=l.response();return c.sync(function(o){var s=m(i);s.events.after.bind(function(t){var u=t.container();h(u);g.add(u,f.binStyle());var v=S.isWord(p,u);var w=T.children(u);var x=j.findClipboardTags(w,v).isSome();c.call(o,{response:n,bundle:e.nu({isWord:v,isInternal:x,proxyBin:u})});});s.run();});};};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.cement.api.PasteFlavors',['ephox.cement.api.PasteProcesses','ephox.cement.smartpaste.Inspection','ephox.cement.step.Base64Step','ephox.cement.step.FlashStep','ephox.cement.step.MergeStep','ephox.cement.step.PasteSteps','ephox.cement.step.ProxyStep','ephox.fred.PlatformDetection','ephox.peanut.Fun','ephox.perhaps.Option','ephox.violin.Strings','global!window'],function(P,I,c,e,M,f,g,h,i,O,S,w){var p=h.detect();var j='image';var k='file';var l=[j,k];var m='html';var n=function(Q){return S.contains(Q,'<html')&&(S.contains(Q,'xmlns:o="urn:schemas-microsoft-com:office:office"')||S.contains(Q,'xmlns:x="urn:schemas-microsoft-com:office:excel"'));};var o=function(Q){var R=Q.clipboardData;if(!I.isValidData(R))return O.none();return I.getFlavor(R.types,m).bind(function(T){var U=R.getData(T.type);return n(U)?O.some(U):O.none();});};var s=function(Q){if(p.browser.isIE()||p.browser.isFirefox())return O.none();else if(!I.isValidData(Q.clipboardData))return O.none();else{var R=Q.clipboardData;return I.getPreferredFlavor(l,R.types).map(function(T){return R.items;});}};var t=function(Q,R){var T=I.isValidData(R.clipboardData)?R.clipboardData.types:[];return I.getFlavor(T,Q.clipboardType()).map(function(U){return R;});};var u=function(Q){if(p.browser.isIE())return O.some(w.clipboardData);else return I.isValidData(Q.clipboardData)?O.some(Q.clipboardData):O.none();};var v=function(Q,R,T,U){return{label:i.constant(Q),getAvailable:R,steps:i.constant(T),capture:i.constant(U)};};var x=function(Q,R,T,U){var V=i.curry(t,U);return v('Within Textbox.io (tables) pasting',V,[P.normal(g(R,Q,T,U)),P.normal(M.fixed(true,true)),P.normal(f.internal(T,U))],false);};var y=function(Q,R,T,U,V,W,X){return v('Outside of Textbox.io pasting (could be internal but another browser)',O.some,[P.normal(g(U,T,V,X)),P.normal(M.fromConfigIfExternal(Q,R)),P.normal(f.external(V,X)),P.blocking(e(W,R)),P.normal(c(R.preprocessor))],false);};var J=function(Q,R,T,U){return v('GWT pasting',o,[P.normal(f.setBundle({isWord:true})),P.normal(M.fromConfig(R,T)),P.normal(f.gwt(Q)),P.blocking(e(U,T))],true);};var K=function(Q){return v('Image pasting',s,[P.normal(Q.allowLocalImages===false?f.noImages(i.noop):f.images(Q.preprocessor))],true);};var L=function(){return v('Plain text pasting',u,[P.normal(f.plain),P.normal(f.autolink)],true);};var N=function(){return v('There is no valid way to paste',O.some,[P.normal(f.none)],false);};return{internal:x,pastiche:y,gwt:J,image:K,text:L,none:N};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.cement.flash.HelpCopy',['ephox.cement.style.Styles','ephox.fred.PlatformDetection','ephox.sugar.api.Attr','ephox.sugar.api.Class','ephox.sugar.api.Element','ephox.sugar.api.Html','ephox.sugar.api.InsertAll'],function(S,P,c,e,f,g,I){var m=function(){var j=P.detect();var k=j.os.isOSX();return k?['\u2318']:['Ctrl'];};var p=function(t){return f.fromHtml('<p>'+t('cement.dialog.flash.press-escape')+'</p>');};var h=function(t){var j=f.fromTag('div');e.add(j,S.resolve('flashbin-helpcopy'));var k=m();var l=f.fromHtml('<p>'+t('cement.dialog.flash.trigger-paste')+'</p>');var o=f.fromHtml('<div>'+'<span class="ephox-polish-help-kbd">'+k+'</span>'+' + '+'<span class="ephox-polish-help-kbd">V</span>'+'</div>');e.add(o,S.resolve('flashbin-helpcopy-kbd'));I.append(j,[l,o,p(t)]);return j;};var n=function(t){var j=f.fromTag('div');e.add(j,S.resolve('flashbin-helpcopy'));var k=f.fromHtml('<p>'+t('cement.dialog.flash.missing')+'</p>');I.append(j,[k,p(t)]);return j;};var i=function(t){var l=f.fromTag('div');e.add(l,S.resolve('flashbin-loading'));var s=f.fromTag('div');e.add(s,S.resolve('flashbin-loading-spinner'));var j=f.fromTag('p');var w=t('loading.wait');g.set(j,w);c.set(j,'aria-label',w);I.append(l,[s,j]);return l;};return{paste:h,noflash:n,indicator:i};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.cement.flash.FlashInfo',['ephox.cement.flash.HelpCopy','ephox.cement.style.Styles','ephox.fred.PlatformDetection','ephox.peanut.Fun','ephox.sugar.api.Class','ephox.sugar.api.Css','ephox.sugar.api.Element','ephox.sugar.api.Insert','ephox.sugar.api.InsertAll','global!navigator'],function(c,S,P,e,f,g,h,I,i,n){var p=P.detect();var j=function(){return new ActiveXObject('ShockwaveFlash.ShockwaveFlash');};var k=function(){try{var o=p.browser.isIE()?j():n.plugins['Shockwave Flash'];return o!==undefined;}catch(s){return false;}};var l=function(o,_,s,t){var u=c.noflash(t);I.append(o,u);return{reset:e.noop};};var m=function(o,s,t,u){var v=c.paste(u);var w=c.indicator(u);i.append(o,[w,v,s.element()]);var x=function(){g.setAll(w,{'height':'0','padding':'0'});};var y=function(){g.set(v,'display','block');g.set(w,'display','none');t();};var J=function(){g.set(v,'display','none');g.set(w,'display','block');g.remove(w,'height');g.remove(w,'padding');t();};s.events.spin.bind(J);s.events.reset.bind(y);s.events.hide.bind(x);return{reset:y};};return function(o,s,t){var u=h.fromTag('div');var v='flashbin-wrapper-'+(p.os.isOSX()?'cmd':'ctrl');f.add(u,S.resolve(v));var w=k()?m:l;var x=w(u,o,s,t.translations);return{element:e.constant(u),reset:x.reset};};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);E.bolt.module.api.define("global!clearInterval",[],function(){return clearInterval;});E.bolt.module.api.define("global!setInterval",[],function(){return setInterval;});(function(a,r,b){a('ephox.cement.alien.CrashMonitor',['ephox.perhaps.Option','ephox.porkbun.Event','ephox.porkbun.Events','ephox.scullion.Cell','global!clearInterval','global!setInterval'],function(O,c,e,f,g,s){var h=function(){var i=f(O.none());var j=e.create({crashed:c([]),timeout:c([])});var k=function(m,n,o){var p=n;var t=s(function(){if(p<=0){j.trigger.timeout();g(t);}else if(o()){g(t);j.trigger.crashed();}p--;},m);i.set(O.some(t));};var l=function(){i.get().each(function(t){g(t);});};return{start:k,stop:l,events:j.registry};};return{responsive:h};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.cement.alien.WaitForFlash',['ephox.classify.Type','ephox.compass.Arr','global!clearInterval','global!setInterval'],function(T,c,e,s){return function(o,f,g){var h=function(l){return c.forall(f,function(n){return T.isFunction(l[n]);});};var i=function(){var l=o.dom();if(T.isFunction(l.PercentLoaded)&&l.PercentLoaded()===100&&h(l)){k();g();}};var w=true;var j=s(i,500);var k=function(){if(w){e(j);w=false;}};return{stop:k};};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.epithet.Namespace',['ephox.epithet.Global'],function(c){var s=function(o,p){if(o[p]===undefined||o[p]===null)o[p]={};return o[p];};var n=function(e,t){var o=t||c;var p=e.split('.');for(var i=0;i<p.length;++i)o=s(o,p[i]);return o;};return{namespace:n};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.oilspill.callback.Globaliser',['ephox.epithet.Namespace'],function(N){var i=function(n){var m=N.namespace(n);m.callbacks={};var c=0;var e=function(){var h='callback_'+c;c++;return h;};var g=function(h){return n+'.callbacks.'+h;};var z=function(h,p){var j=e();m.callbacks[j]=function(){if(!p)u(j);h.apply(null,arguments);};return g(j);};var f=function(h){return z(h,false);};var p=function(h){return z(h,true);};var u=function(s){var h=s.substring(s.lastIndexOf('.')+1);if(m.callbacks[h]!==undefined)delete m.callbacks[h];};m.ephemeral=f;m.permanent=p;m.unregister=u;return m;};return{install:i};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(b,r,c){b('ephox.sugar.api.Focus',['ephox.peanut.Fun','ephox.perhaps.Option','ephox.sugar.api.Compare','ephox.sugar.api.Element','ephox.sugar.api.PredicateExists','ephox.sugar.api.Traverse','global!document'],function(f,O,g,h,P,T,i){var j=function(e){e.dom().focus();};var k=function(e){e.dom().blur();};var l=function(e){var a=T.owner(e).dom();return e.dom()===a.activeElement;};var m=function(_){var a=_!==undefined?_.dom():i;return O.from(a.activeElement).map(h.fromDom);};var n=function(e){var o=T.owner(e);var p=m(o).filter(function(a){return P.closest(a,f.curry(g.eq,e));});p.fold(function(){j(e);},f.noop);};var s=function(a){return m(T.owner(a)).filter(function(e){return a.dom().contains(e.dom());});};return{hasFocus:l,focus:j,blur:k,active:m,search:s,focusInside:n};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);E.bolt.module.api.define("global!clearTimeout",[],function(){return clearTimeout;});E.bolt.module.api.define("global!unescape",[],function(){return unescape;});(function(a,r,b){a('ephox.cement.flash.Flashbin',['ephox.cement.alien.CrashMonitor','ephox.cement.alien.WaitForFlash','ephox.cement.style.Styles','ephox.compass.Arr','ephox.compass.Obj','ephox.epithet.Id','ephox.fred.PlatformDetection','ephox.oilspill.callback.Globaliser','ephox.perhaps.Option','ephox.porkbun.Event','ephox.porkbun.Events','ephox.sugar.api.Class','ephox.sugar.api.Css','ephox.sugar.api.Element','ephox.sugar.api.Focus','ephox.sugar.api.Insert','global!clearInterval','global!clearTimeout','global!console','global!setInterval','global!setTimeout','global!unescape','global!window'],function(c,W,S,g,O,I,P,h,i,j,l,m,n,o,p,t,u,w,x,y,J,K,L){var M=h.install('ephox.flash');var N=P.detect();var Q=i.none();return function(R){var T=l.create({response:j(['rtf']),spin:j([]),cancel:j([]),error:j(['message']),reset:j([]),hide:j([]),failed:j(['message'])});var U=false;var V=o.fromTag('div');m.add(V,S.resolve('flashbin-target'));var X=c.responsive();X.events.crashed.bind(function(){T.trigger.failed('flash.crashed');});X.events.timeout.bind(function(){T.trigger.failed('flash.crashed');});var Y=function(e){J(function(){T.trigger.response(K(e));},0);};var Z=function(){X.stop();};var $=function(){f1.stop();if(U)return;U=true;try{var s=d1.dom();O.each(b1,function(v,k){var f=s[k];if(f===undefined)throw'Flash object does not have the method "'+k+'"';f.call(s,v);});T.trigger.reset();k1();h1();}catch(e){x.log('Flash dialog - Error during load: ',e);}};var _=M.permanent($);var a1=function(){X.start(1000,10,function(){return!d1.dom().setVariable;});T.trigger.spin();};var b1={'setSpinCallback':M.permanent(a1),'setPasteCallback':M.permanent(Y),'setEscapeCallback':M.permanent(T.trigger.cancel),'setErrorCallback':M.permanent(T.trigger.error),'setStartPasteCallback':M.permanent(Z)};var c1=function(){var s=R.replace(/^https?:\/\//,'//');var f='onLoad='+_;var e='    <param name="allowscriptaccess" value="always">'+'    <param name="wmode" value="opaque">'+'    <param name="FlashVars" value="'+f+'">';if(N.browser.isIE()&&N.browser.version.major===10){var k=I.generate('flash-bin');return o.fromHtml('<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" id="'+k+'">'+'<param name="movie" value="'+s+'">'+e+'</object>');}else{return o.fromHtml('<object type="application/x-shockwave-flash" data="'+s+'">'+e+'</object>');}};var d1=c1();var e1=function(){n.setAll(d1,{'width':'2px','height':'2px'});};e1();var f1=W(d1,O.keys(b1),$);t.append(V,d1);var g1=function(){return V;};var h1=function(){if(N.browser.isFirefox()){L.getSelection().removeAllRanges();}p.focus(d1);};var i1=null;var j1=function(){m.add(V,S.resolve('flash-activate'));n.remove(d1,'height');n.remove(d1,'width');T.trigger.hide();};var k1=function(){w(i1);m.remove(V,S.resolve('flash-activate'));e1();};var l1=function(){i1=J(j1,3000);T.trigger.spin();n.set(V,'display','block');h1();};var m1=function(){n.set(V,'display','none');Q.each(function(Q){g.each(Q,function(e){e.unbind();});});};var n1=function(){m1();g.each(O.values(b1),function(s){M.unregister(s);});M.unregister(_);f1.stop();};return{focus:h1,element:g1,activate:l1,deactivate:m1,destroy:n1,events:T.registry};};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.cement.flash.FlashDialog',['ephox.cement.flash.FlashInfo','ephox.cement.flash.Flashbin','ephox.porkbun.Event','ephox.porkbun.Events','ephox.sugar.api.DomEvent','ephox.sugar.api.Element','global!window'],function(c,e,f,g,h,i,w){return function(j,s){var t=s.translations;var k=g.create({response:f(['rtf','hide']),cancel:f([]),error:f(['message']),failed:f(['message'])});var o=function(){var l=e(s.swf);l.deactivate();var m=i.fromDom(w);var n=h.bind(m,'mouseup',l.focus);var p=function(){y();};var u=function(){p();k.trigger.cancel();};l.events.cancel.bind(u);l.events.response.bind(function(I){k.trigger.response(I.rtf(),p);});l.events.error.bind(function(I){p();k.trigger.error(I.message());});l.events.failed.bind(function(I){p();k.trigger.failed(I.message());});var v=j();v.setTitle(t('cement.dialog.flash.title'));var x=c(l,v.reflow,s);x.reset();v.setContent(x.element());v.events.close.bind(u);v.show();l.activate();var y=function(){n.unbind();v.destroy();l.destroy();};};return{open:o,events:k.registry};};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(c,r,e){c('ephox.fussy.api.Situ',[],function(){var f=function(j,k){return i(function(b,o,a){return o(j,k);});};var g=function(j){return i(function(b,o,a){return b(j);});};var h=function(j){return i(function(b,o,a){return a(j);});};var i=function(a){return{fold:a};};return{on:f,before:g,after:h};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.fussy.api.SelectionRange',['ephox.fussy.api.Situ','ephox.scullion.Struct','ephox.sugar.api.Element'],function(S,c,e){var f=c.immutable('start','soffset','finish','foffset');var g=c.immutable('start','soffset','finish','foffset');var w=c.immutable('start','finish');var h=function(i){var s=e.fromDom(i.startContainer);var j=e.fromDom(i.endContainer);return w(S.on(s,i.startOffset),S.on(j,i.endOffset));};return{read:f,general:g,write:w,writeFromNative:h};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.fussy.api.Supported',[],function(){var c=function(w,e){if(w.getSelection)return e(w,w.getSelection());else throw'No selection model supported.';};return{run:c};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.sugar.api.DocumentPosition',['ephox.sugar.api.Compare','ephox.sugar.api.Traverse'],function(c,T){var e=function(s,f,g,h){var i=T.owner(s);var j=i.dom().createRange();j.setStart(s.dom(),f);j.setEnd(g.dom(),h);var k=c.eq(s,g)&&f===h;return j.collapsed&&!k;};return{after:e};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.fussy.wwwc.Directions',['ephox.fussy.api.SelectionRange','ephox.sugar.api.DocumentPosition','ephox.sugar.api.Element','ephox.sugar.api.Traverse'],function(S,c,e,T){var i=function(m){return c.after(e.fromDom(m.anchorNode),m.anchorOffset,e.fromDom(m.focusNode),m.focusOffset);};var f=function(m,l){var s=e.fromDom(l.startContainer);var n=e.fromDom(l.endContainer);return i(m)?S.read(n,l.endOffset,s,l.startOffset):S.read(s,l.startOffset,n,l.endOffset);};var g=function(m){return i(m);};var h=function(s,l,m,n){return function(o){if(o.extend){o.collapse(s.dom(),l);o.extend(m.dom(),n);}else{var p=T.owner(s).dom().createRange();p.setStart(m.dom(),n);p.setEnd(s.dom(),l);o.removeAllRanges();o.addRange(p);}};};var j=function(s,l,m,n){return c.after(s,l,m,n);};var k=function(){return{flip:f,isRtl:g};};var w=function(){return{flip:h,isRtl:j};};return{read:k,write:w};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.fussy.wwwc.DomRange',['ephox.fussy.api.SelectionRange','ephox.fussy.wwwc.Directions','ephox.perhaps.Option','ephox.sugar.api.DocumentPosition','ephox.sugar.api.Element'],function(S,c,O,f,g){var h=function(w,s){var e=t(w,s.start(),s.finish());if(e.collapsed===true){var o=t(w,s.finish(),s.start());return o.collapsed===true?O.none():O.some(S.general(g.fromDom(o.endContainer),o.endOffset,g.fromDom(o.startContainer),o.startOffset));}else{return O.none();}};var i=function(w,s){var e=t(w,s.start(),s.finish());return e.collapsed===true?t(w,s.finish(),s.start()):e;};var t=function(w,s,p){var u=n(w);s.fold(function(e){u.setStartBefore(e.dom());},function(e,o){u.setStart(e.dom(),o);},function(e){u.setStartAfter(e.dom());});p.fold(function(e){u.setEndBefore(e.dom());},function(e,o){u.setEnd(e.dom(),o);},function(e){u.setEndAfter(e.dom());});return u;};var j=function(w,s){return t(w,s.start(),s.finish());};var k=function(w,s,o,e,p){var u=f.after(s,o,e,p);var v=w.document.createRange();if(u){v.setStart(e.dom(),p);v.setEnd(s.dom(),o);}else{v.setStart(s.dom(),o);v.setEnd(e.dom(),p);}return v;};var l=function(w,s){var e=j(w,s);return function(o){o.addRange(e);};};var m=function(w,s){var e=h(w,s);return e.fold(function(){return l(w,s);},function(o){return c.write().flip(o.start(),o.soffset(),o.finish(),o.foffset());});};var n=function(w){return w.document.createRange();};return{create:n,build:m,toNative:j,forceRange:i,toExactNative:k};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.fussy.search.Within',['ephox.compass.Arr','ephox.fussy.wwwc.DomRange','ephox.sugar.api.Element','ephox.sugar.api.Node','ephox.sugar.api.SelectorFilter','ephox.sugar.api.Selectors'],function(c,e,f,N,S,g){var i=function(t,j,k){t.selectNodeContents(k.dom());return t.compareBoundaryPoints(j.END_TO_START,j)<1&&t.compareBoundaryPoints(j.START_TO_END,j)>-1;};var w=function(j,k,l,s){var t=j.document.createRange();var m=g.is(k,s)?[k]:[];var n=m.concat(S.descendants(k,s));return c.filter(n,function(o){return i(t,l,o);});};var h=function(j,k,s){var l=e.forceRange(j,k);var m=f.fromDom(l.commonAncestorContainer);return N.isElement(m)?w(j,m,l,s):[];};return{find:h};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.fussy.wwwc.Prefilter',['ephox.compass.Arr','ephox.fussy.api.SelectionRange','ephox.fussy.api.Situ','ephox.sugar.api.Node'],function(c,S,e,N){var f=function(g,o){if(!c.contains(['br','img'],N.name(g)))return e.on(g,o);else return o===0?e.before(g):e.after(g);};var p=function(s){var g=s.start().fold(e.before,f,e.after);var h=s.finish().fold(e.before,f,e.after);return S.write(g,h);};return{beforeSpecial:f,preprocess:p};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.sugar.api.Fragment',['ephox.compass.Arr','ephox.sugar.api.Element','global!document'],function(c,e,f){var g=function(h,s){var i=s||f;var j=i.createDocumentFragment();c.each(h,function(k){j.appendChild(k.dom());});return e.fromDom(j);};return{fromElements:g};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,b,c){a('ephox.fussy.wwwc.WwwcModel',['ephox.fussy.api.SelectionRange','ephox.fussy.wwwc.Directions','ephox.fussy.wwwc.DomRange','ephox.fussy.wwwc.Prefilter','ephox.perhaps.Option','ephox.sugar.api.Element','ephox.sugar.api.Fragment'],function(S,f,g,P,O,h,i){var j=function(r){return function(e,s){var J=P.preprocess(r);var K=g.build(e,J);if(s!==undefined&&s!==null){s.removeAllRanges();K(s);}};};var k=function(e){return function(r,s){var J=g.create(r);J.selectNodeContents(e.dom());s.removeAllRanges();s.addRange(J);};};var n=function(e,r){var s=r.getRangeAt(0);var J=r.getRangeAt(r.rangeCount-1);var K=e.document.createRange();K.setStart(s.startContainer,s.startOffset);K.setEnd(J.endContainer,J.endOffset);return K;};var l=function(e,r){var s=h.fromDom(r.startContainer);var J=h.fromDom(r.endContainer);return f.read().isRtl(e)?f.read().flip(e,r):S.read(s,r.startOffset,J,r.endOffset);};var m=function(e,r){return r!==undefined&&r!==null&&r.rangeCount>0?O.from(n(e,r)):O.none();};var o=function(e,s){var J=m(e,s);return J.map(function(r){return l(s,r);});};var p=function(e){return function(r,s){var J=m(r,s);J.each(function(K){t(r,K,e);});};};var t=function(e,r,s){var J=i.fromElements(s,e.document);r.deleteContents();r.insertNode(J.dom());};var u=function(r,e){return function(s,J){var K=P.preprocess(r);var L=g.toNative(s,K);t(s,L,e);};};var v=function(s,r,e,J){return function(K,L){var M=g.toExactNative(K,s,r,e,J);M.deleteContents();};};var w=function(s,r,e,J){return function(K,L){var M=g.toExactNative(K,s,r,e,J);var N=M.cloneContents();return h.fromDom(N);};};var x=function(s,r,e,J){return function(K,L){var M=g.toExactNative(K,s,r,e,J);var N=M.getClientRects();var Q=N.length>0?N[0]:M.getBoundingClientRect();return Q.width>0||Q.height>0?O.some(Q):O.none();};};var y=function(e){return function(r,s){var J=g.create(r);J.selectNode(e.dom());var K=J.getBoundingClientRect();return K.width>0||K.height>0?O.some(K):O.none();};};var I=function(e,r){e.getSelection().removeAllRanges();};return{get:o,set:j,selectElementContents:k,replace:p,replaceRange:u,deleteRange:v,cloneFragment:w,rectangleAt:x,bounds:y,clearSelection:I};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.fussy.api.WindowSelection',['ephox.fussy.api.SelectionRange','ephox.fussy.api.Situ','ephox.fussy.api.Supported','ephox.fussy.search.Within','ephox.fussy.wwwc.DomRange','ephox.fussy.wwwc.WwwcModel','ephox.sugar.api.Compare','ephox.sugar.api.Element'],function(S,c,f,W,g,h,i,j){var k=function(e){return f.run(e,h.get);};var l=function(e,s){f.run(e,h.set(s));};var m=function(L,s,M,e,N){var O=S.write(c.on(s,M),c.on(e,N));l(L,O);};var n=function(e,s){f.run(e,h.selectElementContents(s));};var o=function(e,s){f.run(e,h.replace(s));};var p=function(e,s,L){f.run(e,h.replaceRange(s,L));};var t=function(L,s,M,e,N){f.run(L,h.deleteRange(s,M,e,N));};var u=function(L,s,M,e,N){return f.run(L,h.cloneFragment(s,M,e,N));};var v=function(s,L,e,M){return i.eq(s,e)&&L===M;};var w=function(L,s,M,e,N){return f.run(L,h.rectangleAt(s,M,e,N));};var x=function(e,s){return f.run(e,h.bounds(s));};var y=function(e,s,L){return W.find(e,s,L);};var I=function(L,s,M,e,N,O){var P=S.write(c.on(s,M),c.on(e,N));return y(L,P,O);};var J=function(e,s){var L=g.forceRange(e,s);return S.general(j.fromDom(L.startContainer),L.startOffset,j.fromDom(L.endContainer),L.endOffset);};var K=function(e){f.run(e,h.clearSelection);};return{get:k,set:l,setExact:m,selectElementContents:n,replace:o,replaceRange:p,deleteRange:t,isCollapsed:v,cloneFragment:u,rectangleAt:w,bounds:x,findWithin:y,findWithinExact:I,deriveExact:J,clearAll:K};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.sloth.data.Range',['ephox.peanut.Fun','ephox.sugar.api.Compare'],function(c,e){return function(s,f,g,h){var i=e.eq(s,g)&&f===h;return{startContainer:c.constant(s),startOffset:c.constant(f),endContainer:c.constant(g),endOffset:c.constant(h),collapsed:c.constant(i)};};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.sloth.api.BodySwitch',['ephox.sloth.data.Range','ephox.sugar.api.Element','ephox.sugar.api.Insert','ephox.sugar.api.Remove','ephox.sugar.api.Traverse'],function(R,c,I,e,T){return function(s){var p=c.fromTag('br');var t=function(i,o){i.dom().focus();};var g=function(o){var i=T.owner(o);return i.dom().defaultView;};var f=function(i,o){var w=g(o);w.focus();I.append(o,p);s.set(w,R(p,0,p,0));};var h=function(){e.remove(p);};return{cleanup:h,toOn:t,toOff:f};};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.sloth.api.DivSwitch',['ephox.peanut.Fun'],function(c){return function(){var t=function(g,o){g.dom().focus();};var e=function(g,o){o.dom().focus();};var f=c.identity;return{toOn:t,toOff:e,cleanup:f};};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.sloth.engine.Consolidator',['ephox.compass.Arr','ephox.sugar.api.Element','ephox.sugar.api.Insert','ephox.sugar.api.InsertAll','ephox.sugar.api.Remove','ephox.sugar.api.Traverse'],function(c,e,I,f,R,T){var g=function(i,j){T.nextSibling(i).filter(j).each(function(k){var l=T.children(k);f.append(i,l);R.remove(k);});o(i,j);};var h=function(i,j){var k=T.children(i);var w=e.fromTag('div',T.owner(i).dom());f.append(w,k);I.before(i,w);R.remove(i);};var o=function(i,j){var k=T.children(i);c.each(k,function(l){if(j(l))h(l,i);});};return{consolidate:g};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,c){a('ephox.sloth.engine.Offscreen',['ephox.epithet.Id','ephox.scullion.Struct','ephox.sloth.engine.Consolidator','ephox.sugar.api.Attr','ephox.sugar.api.Class','ephox.sugar.api.Css','ephox.sugar.api.Element','ephox.sugar.api.Html','ephox.sugar.api.Insert','ephox.sugar.api.Remove','ephox.sugar.api.SelectorFind','ephox.sugar.api.Traverse'],function(I,S,e,f,g,h,i,j,k,R,l,T){var m=I.generate('ephox-sloth-bin');return function(s){var o=i.fromTag('div');f.set(o,'contenteditable','true');g.add(o,m);h.setAll(o,{position:'absolute',left:'0px',top:'0px',width:'1px',height:'1px',overflow:'hidden',opacity:'0'});var n=function(b){R.empty(o);k.append(b,o);};var p=function(){var x=l.ancestor(o,'body');x.each(function(b){s.toOff(b,o);});};var t=function(b){return g.has(b,m);};var u=function(){e.consolidate(o,t);var b=S.immutable('elements','html','container');var x=T.children(o);var y=j.get(o);return b(x,y,o);};var v=function(){R.remove(o);};var w=function(){return o;};return{attach:n,focus:p,contents:u,container:w,detach:v};};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.sloth.api.ProxyPaste',['ephox.peanut.Fun','ephox.plumber.tap.function.BlockTap','ephox.porkbun.Event','ephox.porkbun.Events','ephox.sloth.api.Paste','ephox.sloth.engine.Offscreen','ephox.sugar.api.Traverse'],function(c,e,f,g,P,O,T){return function(s,h){var o=O(s);var p=function(){s.cleanup();var l=o.contents();o.detach();j.trigger.after(l.elements(),l.html(),o.container());};var t=e.tap(function(){j.trigger.before();o.attach(h);o.focus();P.run(T.owner(h),t,p);});var i=function(){t.instance();};var j=g.create({before:f([]),after:f(['elements','html','container'])});var k=c.noop;return{instance:c.constant(i),destroy:k,events:j.registry};};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.cement.pastiche.Proxy',['ephox.fred.PlatformDetection','ephox.fussy.api.WindowSelection','ephox.porkbun.Event','ephox.porkbun.Events','ephox.sloth.api.BodySwitch','ephox.sloth.api.DivSwitch','ephox.sloth.api.ProxyPaste','ephox.sugar.api.Node'],function(P,W,c,e,f,g,h,N){var p=P.detect();var i={set:function(w,k){W.setExact(w,k.startContainer(),k.startOffset(),k.endContainer(),k.endOffset());}};var j=function(k){var s=p.browser.isIE()&&N.name(k)!=='body'?g:f;return s(i);};return function(k){var l=e.create({after:c(['container'])});var s=j(k);var m=h(s,k);m.events.after.bind(function(o){s.toOn(k,o.container());l.trigger.after(o.container());});var n=function(){m.instance()();};return{run:n,events:l.registry};};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.sugar.api.Ready',['ephox.sugar.api.DomEvent','ephox.sugar.api.Element','global!document'],function(c,e,g){var h=function(f){if(g.readyState==='complete'||g.readyState==='interactive')f();else{var l=c.bind(e.fromDom(g),'DOMContentLoaded',function(){f();l.unbind();});}};return{execute:h};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.keurig.loader.GWTLoader',['ephox.fred.PlatformDetection','ephox.oilspill.callback.Globaliser','ephox.peanut.Fun','ephox.peanut.Thunk','ephox.perhaps.Option','ephox.photon.Writer','ephox.sugar.api.Body','ephox.sugar.api.Css','ephox.sugar.api.DomEvent','ephox.sugar.api.Element','ephox.sugar.api.Insert','ephox.sugar.api.Ready','ephox.sugar.api.Remove'],function(P,c,e,T,O,W,g,h,i,j,I,R,k){var l=c.install('ephox.keurig.init');var m=O.none();var n=P.detect();var o=n.browser;var u=(o.isIE()||n.deviceType.isiOS()||n.deviceType.isAndroid());var p=u?e.noop:T.cached(function(f){var v=j.fromTag('div');if(f===undefined)throw'baseUrl was undefined';var w=j.fromTag('iframe');h.setAll(v,{display:'none'});var x=i.bind(w,'load',function(){var y=function(s){m=O.some(s);if(!o.isSafari()){k.remove(v);}};var J=l.ephemeral(y);var K=f+'/wordimport.js';W.write(w,'<script type="text/javascript" src="'+K+'"></script>'+'<script type="text/javascript">'+'function gwtInited () {'+'parent.window.'+J+'(com.ephox.keurig.WordCleaner.cleanDocument);'+'};'+'</script>');x.unbind();});R.execute(function(){I.append(g.body(),v);I.append(v,w);});});var s=function(w,v){return m.map(function(f){return f(w,v);});};var t=function(){return m.isSome();};return{load:p,cleanDocument:s,ready:t};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.keurig.api.WordCleaner',['ephox.keurig.loader.GWTLoader'],function(c){return function(e){if(!c.ready())c.load(e);return{cleanDocument:c.cleanDocument};};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.cement.api.Cement',['ephox.cement.api.PasteBroker','ephox.cement.api.PasteFlavors','ephox.cement.flash.FlashDialog','ephox.cement.pastiche.Proxy','ephox.compass.Arr','ephox.epithet.Id','ephox.keurig.api.WordCleaner','ephox.peanut.Fun','ephox.perhaps.Option'],function(P,c,e,f,g,I,W,h,O){return function(i,j,p,k){var l=W(k.baseUrl);var m=h.curry(e,j);var n=f;var o=function(){return{clipboardType:I.generate('clipboard-type'),findClipboardTags:O.none};};var s=k.intraFlag!==undefined?k.intraFlag:o();var t=g.flatten([k.intraFlag!==undefined?[c.internal(p,n,i,s)]:[],[c.gwt(l,j,k,m)],[c.image(k)]]);var u=c.pastiche(j,k,p,n,i,m,s);return P(t,u);};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.powerpaste.settings.Defaults',[],function(){return{officeStyles:'prompt',htmlStyles:'clean'};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.powerpaste.styles.Styles',['ephox.sugar.api.Attr','ephox.sugar.api.Element','ephox.sugar.api.Insert','ephox.sugar.api.Remove','ephox.sugar.api.SelectorExists','ephox.sugar.api.SelectorFind','global!document'],function(c,e,I,R,S,f,g){var s='powerpaste-styles';var h='#'+s;var i=function(u){if(!S.any(h)){var k='<style>'+'.ephox-cement-flashbin-helpcopy-kbd '+'{font-size: 3em !important; text-align: center !important; vertical-align: middle !important; margin: .5em 0} '+'.ephox-cement-flashbin-helpcopy-kbd .ephox-polish-help-kbd '+'{font-size: 3em !important; vertical-align: middle !important;} '+'.ephox-cement-flashbin-helpcopy a '+'{text-decoration: underline} '+'.ephox-cement-flashbin-loading-spinner '+'{background-image: url('+u+') !important; width: 96px !important; height:96px !important; display: block; margin-left: auto !important; margin-right: auto !important; margin-top: 2em !important; margin-bottom: 2em !important;} '+'.ephox-cement-flashbin-loading p '+'{text-align: center !important; margin: 2em 0 !important} '+'.ephox-cement-flashbin-target '+'{height: 1px !important;} '+'.ephox-cement-flashbin-target.ephox-cement-flash-activate '+'{height: 150px !important; width: 100% !important;} '+'.ephox-cement-flashbin-target object '+'{height: 1px !important;} '+'.ephox-cement-flashbin-target.ephox-cement-flash-activate object '+'{height: 150px !important; width: 100% !important;} '+'</style>';var l=e.fromHtml(k);c.set(l,'type','text/css');c.set(l,'id',s);var m=f.first('head').getOrDie('Head element could not be found.');I.append(m,l);}};var j=function(){if(S.any(h)){var k=f.first('head').getOrDie('Head element could not be found.');var l=f.descendant(k,h).getOrDie('The style element could not be removed');R.remove(l);}};return{injectStyles:i,removeStyles:j};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.powerpaste.tinymce.ModernTinyDialog',['ephox.porkbun.Event','ephox.porkbun.Events','ephox.powerpaste.util.NodeUtil','ephox.sugar.api.Attr','ephox.sugar.api.Element','ephox.sugar.api.Insert','ephox.sugar.api.Remove','ephox.sugar.api.SelectorFind'],function(f,g,N,h,i,I,R,S){return function(j){var k=function(){var w,t="",l="",m=[],n=null;var o=g.create({close:f([])});var s=function(c){t=c;};var p=function(c){if(tinymce.Env.safari){}var e=N.nodeToString(c.dom());l=[{type:'container',html:e}];n=c;};var u=function(c){var e=[];c.forEach(function(M,O,P){e.push({text:M.text,onclick:M.click});});m=e;};var v=function(e){o.trigger.close();};var x=function(){w.off('close',v);w.close('close');};var y=function(){if(m.length===0){m=[{text:'Close',onclick:function(){w.close();}}];}var c={title:t,spacing:10,padding:10,items:l,buttons:m};w=j.windowManager.open(c);var e=i.fromDom(w.getEl());var M=S.descendant(e,'.'+h.get(n,'class')).getOrDie('We must find this element or we cannot continue');I.before(M,n);R.remove(M);w.on('close',v);};var J=function(){x();};var K=function(){x();};var L=function(){};return{events:o.registry,setTitle:s,setContent:p,setButtons:u,show:y,hide:J,destroy:K,reflow:L};};return{createDialog:k};};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,c){a('ephox.powerpaste.tinymce.ModernPowerPaste',['ephox.cement.api.Cement','ephox.compass.Arr','ephox.peanut.Fun','ephox.powerpaste.i18n.I18n','ephox.powerpaste.settings.Defaults','ephox.powerpaste.styles.Styles','ephox.powerpaste.tinymce.ErrorDialog','ephox.powerpaste.tinymce.ModernTinyDialog','ephox.powerpaste.util.NodeUtil','ephox.knoch.future.Future','ephox.sugar.api.DomEvent','ephox.sugar.api.Element','global!setTimeout','global!tinymce'],function(f,g,h,I,i,S,j,M,N,k,l,m,s,t){return function(n,u,o,p){var v,w,x,y,J;J=(o?o.swfUrl:u)+'/js';w=(o?o.swfUrl:u)+'/flash/textboxpaste.swf';x=(o?o.imgUrl:u)+'/img/spinner_96.gif';y=(o?o.cssUrl:u)+'/css/editorcss.css';n.on('init',function(e){S.injectStyles(x);n.dom.loadCSS(y);var K={baseUrl:J,swf:w,officeStyles:n.settings.powerpaste_word_import||i.officeStyles,htmlStyles:n.settings.powerpaste_html_import||i.htmlStyles,translations:I.translate,allowLocalImages:n.settings.powerpaste_allow_local_images!==false,enableFlashImport:n.settings.powerpaste_enable_flash_import!==false,preprocessor:function(b){return k.pure(b);}};var L=M(n);var O=m.fromDom(n.getBody());var P=f(O,L.createDialog,h.noop,K);P.events.cancel.bind(function(){v=null;});P.events.error.bind(function(b){v=null;if(n.notificationManager){n.notificationManager.open({text:I.translate(b.message()),type:'error'});}else{j.showDialog(n,I.translate(b.message()));}});P.events.insert.bind(function(b){var Q=g.map(b.elements(),function(T){return N.nodeToString(T.dom());}).join('');if(n.hasEventListeners('PastePostProcess')){var R=n.dom.add(n.getBody(),'div',{style:'display:none'},Q);Q=n.fire('PastePostProcess',{node:R}).node.innerHTML;n.dom.remove(R);}n.focus();s(function(){n.selection.moveToBookmark(v);v=null;n.undoManager.transact(function(){n.insertContent(Q,{merge:n.settings.paste_merge_formats!==false});N.restoreStyleAttrs(n.getBody());p.prepareImages(b.assets());});p.uploadImages(b.assets());},1);});l.bind(O,'paste',function(e){if(!v){v=n.selection.getBookmark();}P.paste(e.raw());s(function(){if(n.windowManager.windows[0]&&n.windowManager.windows[0].getEl()){n.windowManager.windows[0].getEl().focus();}},1);});});n.on('remove',function(e){if(t.editors.length===1){S.removeStyles();}});};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.powerpaste.tinymce.TinyPowerPaste',['ephox.powerpaste.imageupload.UploaderFactory','ephox.powerpaste.tinymce.LegacyPowerPaste','ephox.powerpaste.tinymce.ModernPowerDrop','ephox.powerpaste.tinymce.ModernPowerPaste','global!tinymce'],function(U,L,M,c,t){return function(s){return function(f,u){var g=function(){var e=U(f);c(f,u,s,e);if(!f.settings.powerpaste_block_drop){M(f,u,s,e);}};var h=function(){L(f,s);};if(t.Env.ie&&t.Env.ie<10){h();}else{g();}var i=function(j){f.dom.bind(j,'drop dragstart dragend dragover dragenter dragleave dragdrop draggesture',function(e){return t.dom.Event.cancel(e);});};if(f.settings.powerpaste_block_drop){f.on('init',function(e){i(f.getBody());i(f.getDoc());});}if(f.settings.paste_postprocess){f.on('PastePostProcess',function(e){f.settings.paste_postprocess.call(this,this,e);});}};};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);(function(a,r,b){a('ephox.powerpaste.PowerPastePlugin',['ephox.powerpaste.tinymce.TinyPowerPaste','global!tinymce'],function(T,t){return function(s){t.PluginManager.requireLangPack('powerpaste','ar,ca,cs,da,de,el,es,fa,fi,fr_FR,he_IL,hr,hu_HU,it,ja,kk,ko_KR,nb_NO,nl,pl,pt_BR,pt_PT,ro,ru,sk,sl_SI,sv_SE,th_TH,tr,uk,zh_CN,zh_TW');t.PluginManager.add('powerpaste',T(s));};});})(E.bolt.module.api.define,E.bolt.module.api.require,E.bolt.module.api.demand);C('ephox.powerpaste.PowerPastePlugin')();if(this.ephox&&this.ephox.bolt)this.ephox.bolt=d;})();
