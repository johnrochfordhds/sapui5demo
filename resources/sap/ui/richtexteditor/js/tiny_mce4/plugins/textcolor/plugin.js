tinymce.PluginManager.add('textcolor',function(a){var c,r;r=a.settings.textcolor_rows||5;c=a.settings.textcolor_cols||8;function g(e){var i;a.dom.getParents(a.selection.getStart(),function(j){var v;if((v=j.style[e=='forecolor'?'color':'background-color'])){i=v;}});return i;}function m(){var i,e=[],j;j=a.settings.textcolor_map||["000000","Black","993300","Burnt orange","333300","Dark olive","003300","Dark green","003366","Dark azure","000080","Navy Blue","333399","Indigo","333333","Very dark gray","800000","Maroon","FF6600","Orange","808000","Olive","008000","Green","008080","Teal","0000FF","Blue","666699","Grayish blue","808080","Gray","FF0000","Red","FF9900","Amber","99CC00","Yellow green","339966","Sea green","33CCCC","Turquoise","3366FF","Royal blue","800080","Purple","999999","Medium gray","FF00FF","Magenta","FFCC00","Gold","FFFF00","Yellow","00FF00","Lime","00FFFF","Aqua","00CCFF","Sky blue","993366","Red violet","FFFFFF","White","FF99CC","Pink","FFCC99","Peach","FFFF99","Light yellow","CCFFCC","Pale green","CCFFFF","Pale cyan","99CCFF","Light sky blue","CC99FF","Plum"];for(i=0;i<j.length;i+=2){e.push({text:j[i+1],color:'#'+j[i]});}return e;}function b(){var e=this,j,k,l,n,x,y,i,p=e._id,q=0;function s(k,t){var u=k=='transparent';return('<td class="mce-grid-cell'+(u?' mce-colorbtn-trans':'')+'">'+'<div id="'+p+'-'+(q++)+'"'+' data-mce-color="'+(k?k:'')+'"'+' role="option"'+' tabIndex="-1"'+' style="'+(k?'background-color: '+k:'')+'"'+' title="'+tinymce.translate(t)+'">'+(u?'&#215;':'')+'</div>'+'</td>');}j=m();j.push({text:tinymce.translate("No color"),color:"transparent"});l='<table class="mce-grid mce-grid-border mce-colorbutton-grid" role="list" cellspacing="0"><tbody>';n=j.length-1;for(y=0;y<r;y++){l+='<tr>';for(x=0;x<c;x++){i=y*c+x;if(i>n){l+='<td></td>';}else{k=j[i];l+=s(k.color,k.text);}}l+='</tr>';}if(a.settings.color_picker_callback){l+=('<tr>'+'<td colspan="'+c+'" class="mce-custom-color-btn">'+'<div id="'+p+'-c" class="mce-widget mce-btn mce-btn-small mce-btn-flat" '+'role="button" tabindex="-1" aria-labelledby="'+p+'-c" style="width: 100%">'+'<button type="button" role="presentation" tabindex="-1">'+tinymce.translate('Custom...')+'</button>'+'</div>'+'</td>'+'</tr>');l+='<tr>';for(x=0;x<c;x++){l+=s('','Custom color');}l+='</tr>';}l+='</tbody></table>';return l;}function d(e,v){a.undoManager.transact(function(){a.focus();a.formatter.apply(e,{value:v});a.nodeChanged();});}function f(e){a.undoManager.transact(function(){a.focus();a.formatter.remove(e,{value:null},null,true);a.nodeChanged();});}function o(e){var j=this.parent(),v;function s(v){j.hidePanel();j.color(v);d(j.settings.format,v);}function k(){j.hidePanel();j.resetColor();f(j.settings.format);}function l(i,v){i.style.background=v;i.setAttribute('data-mce-color',v);}if(tinymce.DOM.getParent(e.target,'.mce-custom-color-btn')){j.hidePanel();a.settings.color_picker_callback.call(a,function(v){var t=j.panel.getEl().getElementsByTagName('table')[0];var n,p,i;n=tinymce.map(t.rows[t.rows.length-1].childNodes,function(q){return q.firstChild;});for(i=0;i<n.length;i++){p=n[i];if(!p.getAttribute('data-mce-color')){break;}}if(i==c){for(i=0;i<c-1;i++){l(n[i],n[i+1].getAttribute('data-mce-color'));}}l(p,v);s(v);},g(j.settings.format));}v=e.target.getAttribute('data-mce-color');if(v){if(this.lastId){document.getElementById(this.lastId).setAttribute('aria-selected',false);}e.target.setAttribute('aria-selected',true);this.lastId=e.target.id;if(v=='transparent'){k();}else{s(v);}}else if(v!==null){j.hidePanel();}}function h(){var s=this;if(s._color){d(s.settings.format,s._color);}else{f(s.settings.format);}}a.addButton('forecolor',{type:'colorbutton',tooltip:'Text color',format:'forecolor',panel:{role:'application',ariaRemember:true,html:b,onclick:o},onclick:h});a.addButton('backcolor',{type:'colorbutton',tooltip:'Background color',format:'hilitecolor',panel:{role:'application',ariaRemember:true,html:b,onclick:o},onclick:h});});
