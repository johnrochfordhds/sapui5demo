tinymce.ThemeManager.add('modern',function(a){var s=this,b=a.settings,F=tinymce.ui.Factory,c=tinymce.each,D=tinymce.DOM,R=tinymce.geom.Rect,d=tinymce.ui.FloatPanel;var f={file:{title:'File',items:'newdocument'},edit:{title:'Edit',items:'undo redo | cut copy paste pastetext | selectall'},insert:{title:'Insert',items:'|'},view:{title:'View',items:'visualaid |'},format:{title:'Format',items:'bold italic underline strikethrough superscript subscript | formats | removeformat'},table:{title:'Table'},tools:{title:'Tools'}};var g="undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | "+"bullist numlist outdent indent | link image";function h(e,q){var t=[],u;if(!e){return;}c(e.split(/[ ,]/),function(v){var w;function x(){var y=a.selection;function z(A){return function(B,C){var E,i=C.parents.length;while(i--){E=C.parents[i].nodeName;if(E=="OL"||E=="UL"){break;}}v.active(B&&E==A);};}if(w=="bullist"){y.selectorChanged('ul > li',z("UL"));}if(w=="numlist"){y.selectorChanged('ol > li',z("OL"));}if(v.settings.stateSelector){y.selectorChanged(v.settings.stateSelector,function(i){v.active(i);},true);}if(v.settings.disabledStateSelector){y.selectorChanged(v.settings.disabledStateSelector,function(i){v.disabled(i);});}}if(v=="|"){u=null;}else{if(F.has(v)){v={type:v,size:q};t.push(v);u=null;}else{if(!u){u={type:'buttongroup',items:[]};t.push(u);}if(a.buttons[v]){w=v;v=a.buttons[w];if(typeof v=="function"){v=v();}v.type=v.type||'button';v.size=q;v=F.create(v);u.items.push(v);if(a.initialized){x();}else{a.on('init',x);}}}}});return{type:'toolbar',layout:'flow',items:t};}function j(e){var t=[];function q(u){if(u){t.push(h(u,e));return true;}}if(tinymce.isArray(b.toolbar)){if(b.toolbar.length===0){return;}tinymce.each(b.toolbar,function(u,i){b["toolbar"+(i+1)]=u;});delete b.toolbar;}for(var i=1;i<10;i++){if(!q(b["toolbar"+i])){break;}}if(!t.length&&b.toolbar!==false){q(b.toolbar||g);}if(t.length){return{type:'panel',layout:'stack',classes:"toolbar-grp",ariaRoot:true,ariaRemember:true,items:t};}}function k(){var e,q=[];function t(e){var y;if(e=='|'){return{text:'|'};}y=a.menuItems[e];return y;}function u(y){var z,x,A,B,C;C=tinymce.makeMap((b.removed_menuitems||'').split(/[ ,]/));if(b.menu){x=b.menu[y];B=true;}else{x=f[y];}if(x){z={text:x.title};A=[];c((x.items||'').split(/[ ,]/),function(E){var G=t(E);if(G&&!C[E]){A.push(t(E));}});if(!B){c(a.menuItems,function(E){if(E.context==y){if(E.separator=='before'){A.push({text:'|'});}if(E.prependToContext){A.unshift(E);}else{A.push(E);}if(E.separator=='after'){A.push({text:'|'});}}});}for(var i=0;i<A.length;i++){if(A[i].text=='|'){if(i===0||i==A.length-1){A.splice(i,1);}}}z.menu=A;if(!z.menu.length){return null;}}return z;}var v=[];if(b.menu){for(e in b.menu){v.push(e);}}else{for(e in f){v.push(e);}}var w=typeof b.menubar=="string"?b.menubar.split(/[ ,]/):v;for(var i=0;i<w.length;i++){var x=w[i];x=u(x);if(x){q.push(x);}}return q;}function l(e){function i(t){var q=e.find(t)[0];if(q){q.focus(true);}}a.shortcuts.add('Alt+F9','',function(){i('menubar');});a.shortcuts.add('Alt+F10','',function(){i('toolbar');});a.shortcuts.add('Alt+F11','',function(){i('elementpath');});e.on('cancel',function(){a.focus();});}function r(w,e){var i,q,t,u;function v(x){return{width:x.clientWidth,height:x.clientHeight};}i=a.getContainer();q=a.getContentAreaContainer().firstChild;t=v(i);u=v(q);if(w!==null){w=Math.max(b.min_width||100,w);w=Math.min(b.max_width||0xFFFF,w);D.setStyle(i,'width',w+(t.width-u.width));D.setStyle(q,'width',w);}e=Math.max(b.min_height||100,e);e=Math.min(b.max_height||0xFFFF,e);D.setStyle(q,'height',e);a.fire('ResizeEditor');}function m(e,i){var q=a.getContentAreaContainer();s.resizeTo(q.clientWidth+e,q.clientHeight+i);}function n(){var q;function t(){return a.contextToolbars||[];}function u(e){var i,y,E;i=tinymce.DOM.getPos(a.getContentAreaContainer());y=a.dom.getRect(e);E=a.dom.getRoot();if(E.nodeName=='BODY'){y.x-=E.ownerDocument.documentElement.scrollLeft||E.scrollLeft;y.y-=E.ownerDocument.documentElement.scrollTop||E.scrollTop;}y.x+=i.x;y.y+=i.y;return y;}function v(){c(a.contextToolbars,function(e){if(e.panel){e.panel.hide();}});}function w(e){var i,y,E,G,H,I,J;if(a.removed){return;}if(!e||!e.toolbar.panel){v();return;}J=['tc-bc','bc-tc','tl-bl','bl-tl','tr-br','br-tr'];H=e.toolbar.panel;H.show();E=u(e.element);y=tinymce.DOM.getRect(H.getEl());G=tinymce.DOM.getRect(a.getContentAreaContainer()||a.getBody());E.w=e.element.clientWidth;E.h=e.element.clientHeight;if(!a.inline){G.w=a.getDoc().documentElement.offsetWidth;}if(a.selection.controlSelection.isResizable(e.element)){E=R.inflate(E,0,8);}i=R.findBestRelativePosition(y,E,G,J);if(i){c(J.concat('inside'),function(K){H.classes.toggle('tinymce-inline-'+K,K==i);});I=R.relativePosition(y,E,i);H.moveTo(I.x,I.y);}else{c(J,function(K){H.classes.toggle('tinymce-inline-'+K,false);});H.classes.toggle('tinymce-inline-inside',true);E=R.intersect(G,E);if(E){i=R.findBestRelativePosition(y,E,G,['tc-tc','tl-tl','tr-tr']);if(i){I=R.relativePosition(y,E,i);H.moveTo(I.x,I.y);}else{H.moveTo(E.x,E.y);}}else{H.hide();}}}function x(){function e(){if(a.selection){w(C(a.selection.getNode()));}}tinymce.util.Delay.requestAnimationFrame(e);}function z(){if(!q){q=a.selection.getScrollContainer()||a.getWin();tinymce.$(q).on('scroll',x);a.on('remove',function(){tinymce.$(q).off('scroll');});}}function A(e){var i;if(e.toolbar.panel){e.toolbar.panel.show();w(e);return;}z();i=F.create({type:'floatpanel',role:'application',classes:'tinymce tinymce-inline',layout:'flex',direction:'column',align:'stretch',autohide:false,autofix:true,fixed:true,border:1,items:h(e.toolbar.items)});e.toolbar.panel=i;i.renderTo(document.body).reflow();w(e);}function B(){tinymce.each(t(),function(e){if(e.panel){e.panel.hide();}});}function C(e){var i,y,E,G=t();E=a.$(e).parents().add(e);for(i=E.length-1;i>=0;i--){for(y=G.length-1;y>=0;y--){if(G[y].predicate(E[i])){return{toolbar:G[y],element:E[i]};}}}return null;}a.on('click keyup setContent',function(e){if(e.type=='setcontent'&&!e.selection){return;}tinymce.util.Delay.setEditorTimeout(a,function(){var i;i=C(a.selection.getNode());if(i){B();A(i);}else{B();}});});a.on('blur hide',B);a.on('ObjectResizeStart',function(){var e=C(a.selection.getNode());if(e&&e.toolbar.panel){e.toolbar.panel.hide();}});a.on('nodeChange ResizeEditor ResizeWindow',x);a.on('remove',function(){tinymce.each(t(),function(e){if(e.panel){e.panel.remove();}});a.contextToolbars={};});}function o(e){var i,q;if(b.fixed_toolbar_container){q=D.select(b.fixed_toolbar_container)[0];}function t(){if(i&&i.moveRel&&i.visible()&&!i._fixed){var x=a.selection.getScrollContainer(),y=a.getBody();var z=0,A=0;if(x){var B=D.getPos(y),C=D.getPos(x);z=Math.max(0,C.x-B.x);A=Math.max(0,C.y-B.y);}i.fixed(false).moveRel(y,a.rtl?['tr-br','br-tr']:['tl-bl','bl-tl','tr-br']).moveBy(z,A);}}function u(){if(i){i.show();t();D.addClass(a.getBody(),'mce-edit-focus');}}function v(){if(i){i.hide();d.hideAll();D.removeClass(a.getBody(),'mce-edit-focus');}}function w(){if(i){if(!i.visible()){u();}return;}i=s.panel=F.create({type:q?'panel':'floatpanel',role:'application',classes:'tinymce tinymce-inline',layout:'flex',direction:'column',align:'stretch',autohide:false,autofix:true,fixed:!!q,border:1,items:[b.menubar===false?null:{type:'menubar',border:'0 0 1 0',items:k()},j(b.toolbar_items_size)]});a.fire('BeforeRenderUI');i.renderTo(q||document.body).reflow();l(i);u();n();a.on('nodeChange',t);a.on('activate',u);a.on('deactivate',v);a.nodeChanged();}b.content_editable=true;a.on('focus',function(){if(e.skinUiCss){tinymce.DOM.styleSheetLoader.load(e.skinUiCss,w,w);}else{w();}});a.on('blur hide',v);a.on('remove',function(){if(i){i.remove();i=null;}});if(e.skinUiCss){tinymce.DOM.styleSheetLoader.load(e.skinUiCss,function(){a.fire('SkinLoaded');});}return{};}function p(i){var q,t,u;function v(){return function(e){if(e.mode=='readonly'){q.find('*').disabled(true);}else{q.find('*').disabled(false);}};}if(i.skinUiCss){tinymce.DOM.styleSheetLoader.load(i.skinUiCss,function(){a.fire('SkinLoaded');});}q=s.panel=F.create({type:'panel',role:'application',classes:'tinymce',style:'visibility: hidden',layout:'stack',border:1,items:[b.menubar===false?null:{type:'menubar',border:'0 0 1 0',items:k()},j(b.toolbar_items_size),{type:'panel',name:'iframe',layout:'stack',classes:'edit-area',html:'',border:'1 0 0 0'}]});if(b.resize!==false){t={type:'resizehandle',direction:b.resize,onResizeStart:function(){var e=a.getContentAreaContainer().firstChild;u={width:e.clientWidth,height:e.clientHeight};},onResize:function(e){if(b.resize=='both'){r(u.width+e.deltaX,u.height+e.deltaY);}else{r(null,u.height+e.deltaY);}}};}if(b.statusbar!==false){q.add({type:'panel',name:'statusbar',classes:'statusbar',layout:'flow',border:'1 0 0 0',ariaRoot:true,items:[{type:'elementpath'},t]});}if(b.readonly){q.find('*').disabled(true);}a.fire('BeforeRenderUI');a.on('SwitchMode',v());q.renderBefore(i.targetNode).reflow();if(b.width){tinymce.DOM.setStyle(q.getEl(),'width',b.width);}a.on('remove',function(){q.remove();q=null;});l(q);n();return{iframeContainer:q.find('#iframe')[0].getEl(),editorContainer:q.getEl()};}s.renderUI=function(i){var q=b.skin!==false?b.skin||'lightgray':false;if(q){var t=b.skin_url;if(t){t=a.documentBaseURI.toAbsolute(t);}else{t=tinymce.baseURL+'/skins/'+q;}if(tinymce.Env.documentMode<=7){i.skinUiCss=t+'/skin.ie7.min.css';}else{i.skinUiCss=t+'/skin.min.css';}a.contentCSS.push(t+'/content'+(a.inline?'.inline':'')+'.min.css');}a.on('ProgressState',function(e){s.throbber=s.throbber||new tinymce.ui.Throbber(s.panel.getEl('body'));if(e.state){s.throbber.show(e.time);}else{s.throbber.hide();}});if(b.inline){return o(i);}return p(i);};s.resizeTo=r;s.resizeBy=m;});
