/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/gantt/drawer/Drawer","sap/gantt/misc/Utility","sap/ui/core/Core","sap/ui/thirdparty/d3"],function(D,U,C){"use strict";var S=D.extend("sap.gantt.drawer.SelectionPanel");S.prototype.drawSvg=function(t,s,d,g){this._oGanttChartWithTable=g;if(d.length==0){return null;}var a=[];for(var i=0;i<d.length;i++){if(d[i].data.__dummy&&!d[i].data.previousNodeNum&&!d[i].data.afterNodeNum){a.push(d[i]);}}var T=t.selectAll(".selectionpanel").data(a);T.enter().append("g").classed("selectionpanel",true);T.exit().remove();var b=s.selectAll(".selectionpanel").data(a);b.enter().append("g").classed("selectionpanel",true);b.exit().remove();if(!T.empty()&&!b.empty()){var c=$(s[0][0]).width();var e=$(t[0][0]).width();this._drawExpandedBackground(s,c);this._drawExpandedBackground(t,e);this._drawExpandedContent(t,e);}};S.prototype._drawExpandedBackground=function(s,w){s.selectAll(".selectionpanel").selectAll("rect").remove();s.selectAll(".selectionpanel").append("rect").classed("sapGanttExpandChartBG",true).attr("x",function(d){return 0;}).attr("y",function(d){return d.y;}).attr("height",function(d){return d.rowHeight-1;}).attr("width",function(d){return w-1;});};S.prototype._drawExpandedContent=function(s,w){s.selectAll(".selectionpanel").selectAll("g").remove();var t=this;s.selectAll(".selectionpanel").append("g").classed("sapGanttExpandChartContent",true);var g=s.selectAll(".sapGanttExpandChartContent");var f=g.filter(function(d,i){return d.index===1;});f.append("image").classed("hasTitle",function(d){return"image";}).attr("xlink:href",function(d){return d.icon;}).attr("x",function(d){if(C.getConfiguration().getRTL()===true){return w-19-16;}else{return 19;}}).attr("y",function(d){return d.y+4.25;}).attr("width",function(d){return 16;}).attr("height",function(d){return 16;});f.append("text").attr("x",function(d){if(C.getConfiguration().getRTL()===true){return w-93+56;}else{return 38;}}).attr("y",function(d){return d.y+16.5;}).attr("font-size",function(d){return"0.75em";}).text(function(d){return d.name;});f.append("g").attr("transform",function(d){var i=0,I=d.y+7;if(C.getConfiguration().getRTL()===true){i=w-93-4;}else{i=93+8;}return"translate("+i+","+I+")";});f.select("g").append("path").classed("sapGanttExpandChartCloseButton",true).attr("d","M1 0 h3 v4 h4 v3 h-4 v4 h-3 v-4 h-4 v-3 h4 v-4 z").attr("transform","rotate(45)").on("click",function(d){var a=[];a.push(d.chartScheme);var b=t._oGanttChartWithTable._oTT.getBinding("rows");var r=b.getContexts(0,b.getLength());for(var i=0;i<r.length;i++){var o=r[i].getProperty();if(o&&d.data.parentData&&o.id==d.data.parentData.id){t._oGanttChartWithTable.fireEvent("collapseDummyRow",{isExpand:false,expandedChartSchemes:a,aExpandedIndices:[i]});}}});var c=f.selectAll("path");c.select("title").remove();c.insert("title",":first-child").text(function(d){return sap.ui.getCore().getLibraryResourceBundle("sap.gantt").getText("TLTP_CLOSE");});};return S;},true);
