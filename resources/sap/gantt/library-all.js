jQuery.sap.declare('sap.gantt.library-all');if(!jQuery.sap.isDeclared('sap.gantt.GanttChartRenderer')){
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
jQuery.sap.declare('sap.gantt.GanttChartRenderer');sap.ui.define("sap/gantt/GanttChartRenderer",[],function(){"use strict";var G={};G.render=function(r,g){jQuery.sap.measure.start("GanttChartRenderer render","GanttPerf:GanttChartRenderer render function");r.write("<div");r.writeControlData(g);r.addStyle("width",g.getWidth());r.addStyle("height",g.getHeight());r.writeStyles();r.addClass("sapGanttChart");r.writeClasses();r.write(">");jQuery.sap.measure.start("GanttChartRenderer renderPaintServer","GanttPerf:GanttChartRenderer renderPaintServer part");this.renderSvgDefs(r,g);jQuery.sap.measure.end("GanttChartRenderer renderPaintServer");jQuery.sap.measure.start("GanttChartRenderer renderChartHeader","GanttPerf:GanttChartRenderer renderChartHeader part");this.renderChartHeader(r,g);jQuery.sap.measure.end("GanttChartRenderer renderChartHeader");jQuery.sap.measure.start("GanttChartRenderer renderChartBody","GanttPerf:GanttChartRenderer renderChartBody part");this.renderChartBody(r,g);jQuery.sap.measure.end("GanttChartRenderer renderChartBody");r.write("</div>");jQuery.sap.measure.end("GanttChartRenderer render");};G.renderSvgDefs=function(r,g){var s=g.getSvgDefs();if(s){r.write("<svg id='"+g.getId()+"-svg-psdef'");r.addStyle("float","left");r.addStyle("width","0px");r.addStyle("height","0px");r.writeStyles();r.write(">");r.write(s.getDefString());r.write("</svg>");}};G.renderChartHeader=function(r,g){r.write("<div id='"+g.getId()+"-header'");r.addClass("sapGanttChartHeader");r.writeClasses();r.write(">");r.write("<svg id='"+g.getId()+"-header-svg'");r.addClass("sapGanttChartHeaderSvg");r.writeClasses();r.write("></svg>");r.write("</div>");};G.renderChartBody=function(r,g){r.write("<div id='"+g.getId()+"-tt'");r.addClass("sapUiTableHScr");r.addClass("sapGanttChartTT");r.writeClasses();r.addStyle("width",g.getWidth());r.addStyle("height",g.getHeight());r.writeStyles();r.write(">");jQuery.sap.measure.start("GanttChartRenderer renderSvgDiv","GanttPerf:GanttChartRenderer renderPaintServer part");this.renderBodySvg(r,g);jQuery.sap.measure.end("GanttChartRenderer renderSvgDiv");r.renderControl(g.getAggregation("_treeTable"));r.write("</div>");};G.renderBodySvg=function(r,g){r.write("<div id='"+g.getId()+"-svg-ctn'");r.addClass("sapGanttChartSvgCtn");r.writeClasses();r.write(">");r.write("<svg id='"+g.getId()+"-svg'");r.addClass("sapGanttChartSvg");r.writeClasses();r.addStyle("height","100%");r.writeStyles();r.write(">");r.write("</svg>");r.write("</div>");};return G;},true);};if(!jQuery.sap.isDeclared('sap.gantt.GanttChartWithTableRenderer')){jQuery.sap.declare('sap.gantt.GanttChartWithTableRenderer');jQuery.sap.require('sap.ui.core.theming.Parameters');sap.ui.define("sap/gantt/GanttChartWithTableRenderer",['sap/ui/core/theming/Parameters'],function(P){"use strict";var G={};G.render=function(r,g){r.write("<div");r.writeControlData(g);r.addClass("sapUiTableHScr");r.addClass("sapGanttChartWithTable");r.writeClasses();r.addStyle("width",g.getWidth());r.addStyle("height",g.getHeight());r.writeStyles();r.write(">");if(g._oToolbar.getAllToolbarItems().length==0){g._oTT.addStyleClass("sapGanttChartColumnHeight");}else if(g._oTT.hasStyleClass("sapGanttChartColumnHeight")){g._oTT.removeStyleClass("sapGanttChartColumnHeight");}r.renderControl(g._oSplitter);r.write("</div>");};return G;},true);};if(!jQuery.sap.isDeclared('sap.gantt.config.ChartScheme')){jQuery.sap.declare('sap.gantt.config.ChartScheme');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.Element');sap.ui.define("sap/gantt/config/ChartScheme",['jquery.sap.global','sap/ui/core/Element'],function(q,E){"use strict";var C=E.extend("sap.gantt.config.ChartScheme",{metadata:{properties:{key:{type:"string",defaultValue:null},name:{type:"string",defaultValue:null},rowSpan:{type:"int",defaultValue:1},icon:{type:"sap.ui.core.URI",defaultValue:null},modeKey:{type:"string",defaultValue:sap.gantt.config.DEFAULT_MODE_KEY},backgroundColor:{type:"string",defaultValue:null},shapeKeys:{type:"array",defaultValue:[]}}}});return C;},true);};if(!jQuery.sap.isDeclared('sap.gantt.config.ColumnAttribute')){jQuery.sap.declare('sap.gantt.config.ColumnAttribute');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.Element');sap.ui.define("sap/gantt/config/ColumnAttribute",['jquery.sap.global','sap/ui/core/Element'],function(q,E){"use strict";var C=E.extend("sap.gantt.config.ColumnAttribute",{metadata:{properties:{objectTypeKey:{type:"string",defaultValue:null},attribute:{type:"string",defaultValue:null}}}});return C;},true);};if(!jQuery.sap.isDeclared('sap.gantt.config.ContainerLayout')){jQuery.sap.declare('sap.gantt.config.ContainerLayout');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.Element');jQuery.sap.require('sap.ui.core.Orientation');sap.ui.define("sap/gantt/config/ContainerLayout",['jquery.sap.global','sap/ui/core/Element','sap/ui/core/Orientation'],function(q,E,O){"use strict";var C=E.extend("sap.gantt.config.ContainerLayout",{metadata:{properties:{key:{type:"string",defaultValue:sap.gantt.config.DEFAULT_CONTAINER_SINGLE_LAYOUT_KEY},text:{type:"string",defaultValue:sap.ui.getCore().getLibraryResourceBundle("sap.gantt").getText("XLST_SINGLE_LAYOUT")},orientation:{type:"sap.ui.core.Orientation",defaultValue:O.Vertical},activeModeKey:{type:"string",defaultValue:sap.gantt.config.DEFAULT_MODE_KEY},toolbarSchemeKey:{type:"string",defaultValue:sap.gantt.config.DEFAULT_CONTAINER_TOOLBAR_SCHEME_KEY},selectionPanelSize:{type:"sap.ui.core.CSSSize",defaultValue:"30%"},ganttChartLayouts:{type:"array",defaultValue:[]}}}});return C;},true);};if(!jQuery.sap.isDeclared('sap.gantt.config.ExpandChart')){jQuery.sap.declare('sap.gantt.config.ExpandChart');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.Element');sap.ui.define("sap/gantt/config/ExpandChart",['jquery.sap.global','sap/ui/core/Element'],function(q,E){"use strict";var a=E.extend("sap.gantt.config.ExpandChart",{metadata:{properties:{icon:{type:"sap.ui.core.URI",defaultValue:null},isExpand:{type:"boolean",defaultValue:null},chartSchemeKeys:{type:"array",defaultValue:[]}}}});return a;},true);};if(!jQuery.sap.isDeclared('sap.gantt.config.GanttChartLayout')){jQuery.sap.declare('sap.gantt.config.GanttChartLayout');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.Element');sap.ui.define("sap/gantt/config/GanttChartLayout",['jquery.sap.global','sap/ui/core/Element'],function(q,E){"use strict";var G=E.extend("sap.gantt.config.GanttChartLayout",{metadata:{properties:{ganttChartSize:{type:"sap.ui.core.CSSSize",defaultValue:null},activeModeKey:{type:"string",defaultValue:sap.gantt.config.DEFAULT_MODE_KEY},hierarchyKey:{type:"string",defaultValue:sap.gantt.config.DEFAULT_HIERARCHY_KEY}}}});return G;},true);};if(!jQuery.sap.isDeclared('sap.gantt.config.Hierarchy')){jQuery.sap.declare('sap.gantt.config.Hierarchy');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.Element');sap.ui.define("sap/gantt/config/Hierarchy",['jquery.sap.global','sap/ui/core/Element'],function(q,E){"use strict";var H=E.extend("sap.gantt.config.Hierarchy",{metadata:{properties:{key:{type:"string",defaultValue:sap.gantt.config.DEFAULT_HIERARCHY_KEY},text:{type:"string",defaultValue:"Default Hierarchy"},activeModeKey:{type:"string",defaultValue:sap.gantt.config.DEFAULT_MODE_KEY},toolbarSchemeKey:{type:"string",defaultValue:sap.gantt.config.DEFAULT_GANTTCHART_TOOLBAR_SCHEME_KEY},columns:{type:"array"},expandedLevels:{type:"array"}}}});H.prototype.init=function(){this._oRb=sap.ui.getCore().getLibraryResourceBundle("sap.gantt");this.setText(this._oRb.getText("XLST_DEFAULT_HIE"));};return H;},true);};if(!jQuery.sap.isDeclared('sap.gantt.config.HierarchyColumn')){jQuery.sap.declare('sap.gantt.config.HierarchyColumn');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.Element');sap.ui.define("sap/gantt/config/HierarchyColumn",['jquery.sap.global','sap/ui/core/Element'],function(q,E){"use strict";var H=E.extend("sap.gantt.config.HierarchyColumn",{metadata:{properties:{key:{type:"string",defaultValue:null},title:{type:"string",defaultValue:null},contentType:{type:"string",defaultValue:null},sortAttribute:{type:"string",defaultValue:null},filterAttribute:{type:"string",defaultValue:null},attribute:{type:"string",defaultValue:null},attributes:{type:"array",defaultValue:[]},width:{type:"sap.ui.core.CSSSize"}}}});return H;},true);};if(!jQuery.sap.isDeclared('sap.gantt.config.Locale')){jQuery.sap.declare('sap.gantt.config.Locale');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.Element');sap.ui.define("sap/gantt/config/Locale",['jquery.sap.global','sap/ui/core/Element'],function(q,E){"use strict";var L=E.extend("sap.gantt.config.Locale",{metadata:{properties:{timeZone:{type:"string",defaultValue:"UTC"},utcdiff:{type:"string",defaultValue:"000000"},utcsign:{type:"string",defaultValue:"+"},dstHorizons:{type:"array",defaultValue:[]}}}});return L;},true);};if(!jQuery.sap.isDeclared('sap.gantt.config.Mode')){jQuery.sap.declare('sap.gantt.config.Mode');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.Element');sap.ui.define("sap/gantt/config/Mode",['jquery.sap.global','sap/ui/core/Element'],function(q,E){"use strict";var M=E.extend("sap.gantt.config.Mode",{metadata:{properties:{key:{type:"string",defaultValue:null},text:{type:"string",defaultValue:null},icon:{type:"sap.ui.core.URI",defaultValue:null},activeIcon:{type:"sap.ui.core.URL"}}}});return M;},true);};if(!jQuery.sap.isDeclared('sap.gantt.config.ObjectType')){jQuery.sap.declare('sap.gantt.config.ObjectType');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.Element');sap.ui.define("sap/gantt/config/ObjectType",['jquery.sap.global','sap/ui/core/Element'],function(q,E){"use strict";var O=E.extend("sap.gantt.config.ObjectType",{metadata:{properties:{key:{type:"string",defaultValue:null},description:{type:"string",defaultValue:null},mainChartSchemeKey:{type:"string",defaultValue:sap.gantt.config.DEFAULT_MAIN_CHART_SCHEME_KEY},expandedChartSchemeKeys:{type:"array",defaultValue:[]}}}});return O;},true);};if(!jQuery.sap.isDeclared('sap.gantt.config.Shape')){jQuery.sap.declare('sap.gantt.config.Shape');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.Element');sap.ui.define("sap/gantt/config/Shape",['jquery.sap.global','sap/ui/core/Element'],function(q,E){"use strict";var S=E.extend("sap.gantt.config.Shape",{metadata:{properties:{key:{type:"string",defaultValue:null},shapeClassName:{type:"string",defaultValue:null},shapeDataName:{type:"string",defaultValue:null},modeKeys:{type:"array",defaultValue:[]},level:{type:"string",defaultValue:null},shapeProperties:{type:"object",defaultValue:sap.gantt.config.DEFAULT_EMPTY_OBJECT},groupAggregation:{type:"array"},clippathAggregation:{type:"array"},selectedClassName:{type:"string",defaultValue:null},legend:{type:"string"}}}});S.prototype.hasShapeProperty=function(p){return this.getShapeProperties().hasOwnProperty(p);};S.prototype.getShapeProperty=function(p){return this.getShapeProperties()[p];};return S;},true);};if(!jQuery.sap.isDeclared('sap.gantt.config.TimeAxis')){jQuery.sap.declare('sap.gantt.config.TimeAxis');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.Element');sap.ui.define("sap/gantt/config/TimeAxis",['jquery.sap.global','sap/ui/core/Element'],function(q,E){"use strict";var T=E.extend("sap.gantt.config.TimeAxis",{metadata:{library:"sap.gantt",properties:{planHorizon:{type:"sap.gantt.config.TimeHorizon",defaultValue:sap.gantt.config.DEFAULT_PLAN_HORIZON},initHorizon:{type:"sap.gantt.config.TimeHorizon",defaultValue:sap.gantt.config.DEFAULT_INIT_HORIZON},zoomStrategy:{type:"object",defaultValue:sap.gantt.config.DEFAULT_TIME_ZOOM_STRATEGY},granularity:{type:"string",defaultValue:"4day"},finestGranularity:{type:"string",defaultValue:"5min"},coarsestGranularity:{type:"string",defaultValue:"1month"},rate:{type:"float",defaultValue:1}}}});return T;},true);};if(!jQuery.sap.isDeclared('sap.gantt.config.ToolbarGroup')){jQuery.sap.declare('sap.gantt.config.ToolbarGroup');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.Element');jQuery.sap.require('sap.m.OverflowToolbarPriority');sap.ui.define("sap/gantt/config/ToolbarGroup",['jquery.sap.global','sap/ui/core/Element',"sap/m/OverflowToolbarPriority"],function(q,E,O){"use strict";var T=E.extend("sap.gantt.config.ToolbarGroup",{metadata:{properties:{position:{type:"string",defaultValue:null},overflowPriority:{type:"sap.m.OverflowToolbarPriority",defaultValue:O.Low}}}});return T;},true);};if(!jQuery.sap.isDeclared('sap.gantt.config.ToolbarScheme')){jQuery.sap.declare('sap.gantt.config.ToolbarScheme');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.Element');sap.ui.define("sap/gantt/config/ToolbarScheme",['jquery.sap.global','sap/ui/core/Element'],function(q,E){"use strict";var T=E.extend("sap.gantt.config.ToolbarScheme",{metadata:{properties:{key:{type:"string",defaultValue:null},sourceSelect:{type:"sap.gantt.config.ToolbarGroup",defaultValue:null},layout:{type:"sap.gantt.config.LayoutGroup",defaultValue:null},customToolbarItems:{type:"sap.gantt.config.ToolbarGroup",defaultValue:null},expandChart:{type:"sap.gantt.config.ExpandChartGroup",defaultValue:null},expandTree:{type:"sap.gantt.config.ToolbarGroup",defaultValue:null},timeZoom:{type:"sap.gantt.config.ToolbarGroup",defaultValue:null},legend:{type:"sap.gantt.config.ToolbarGroup",defaultValue:null},settings:{type:"sap.gantt.config.SettingGroup",defaultValue:null},mode:{type:"sap.gantt.config.ModeGroup",defaultValue:null},toolbarDesign:{type:"string",defaultValue:sap.m.ToolbarDesign.Auto}}}});return T;},true);};if(!jQuery.sap.isDeclared('sap.gantt.control.AssociateContainer')){jQuery.sap.declare('sap.gantt.control.AssociateContainer');jQuery.sap.require('sap.ui.core.Control');jQuery.sap.require('sap.ui.core.Core');sap.ui.define("sap/gantt/control/AssociateContainer",["sap/ui/core/Control","sap/ui/core/Core"],function(C,a){"use strict";var A=C.extend("sap.gantt.control.AssociateContainer",{metadata:{properties:{enableRootDiv:{type:"boolean",defaultValue:false}},associations:{content:{type:"sap.ui.core.Control",multiple:false}}}});A.prototype.setContent=function(c){this.setAssociation("content",c);if(c){var o=typeof(c)==="string"?a.byId(c):c;o._oAC=this;}return this;};return A;},true);};if(!jQuery.sap.isDeclared('sap.gantt.control.AssociateContainerRenderer')){jQuery.sap.declare('sap.gantt.control.AssociateContainerRenderer');sap.ui.define("sap/gantt/control/AssociateContainerRenderer",[],function(){"use strict";var A={};A.render=function(r,c){if(c.getEnableRootDiv()){r.write("<div");r.writeControlData(c);r.addClass("sapGanttChartLayoutBG");r.writeClasses();r.addStyle("width","100%");r.addStyle("height","100%");r.addStyle("overFlow","hidden");r.writeStyles();r.write(">");}r.renderControl(sap.ui.getCore().byId(c.getContent()));if(c.getEnableRootDiv()){r.write("</div>");}};return A;},true);};if(!jQuery.sap.isDeclared('sap.gantt.control.Cell')){jQuery.sap.declare('sap.gantt.control.Cell');jQuery.sap.require('sap.ui.core.Control');jQuery.sap.require('sap.m.Label');sap.ui.define("sap/gantt/control/Cell",["sap/ui/core/Control","sap/m/Label"],function(C,L){"use strict";var a=C.extend("sap.gantt.control.Cell",{metadata:{properties:{cellCallback:{type:"object"},columnConfig:{type:"sap.gantt.config.HierarchyColumn"}}}});a.prototype.setColumnConfig=function(c){this.setProperty("columnConfig",c);if(c){var A=c.getAttributes();if(A&&A.length>0){this._oMapAttributes={};A.forEach(function(o){this._oMapAttributes[o.getObjectTypeKey()]=o.getAttribute();}.bind(this));}}return this;};a.prototype.createCellContent=function(c){var o=this.getCellCallback();if(o&&o.createCellContent){return o.createCellContent(c);}return new L();};a.prototype.updateCellContent=function(c,o,A,O,b){var d=this.getCellCallback();if(d&&d.updateCellContent){d.updateCellContent(c,o,A,O,b);}else{c.setText(o.getProperty(A));}};a.prototype._updateTableCell=function(c,o,$,A){if(!o){return;}this._oContext=o;var O=o.getProperty("type");if(this._oMapAttributes){this.updateCellContent(this._oAttributeControl,o,this._oMapAttributes[O],O,this.getColumnConfig());}else{this.updateCellContent(this._oAttributeControl,o,this.getColumnConfig().getAttribute(),O,this.getColumnConfig());}};a.prototype.getContentToRender=function(){if(!this._oAttributeControl){this._oAttributeControl=this.createCellContent(this.getColumnConfig());}return this._oAttributeControl;};return a;},true);};if(!jQuery.sap.isDeclared('sap.gantt.control.CellRenderer')){jQuery.sap.declare('sap.gantt.control.CellRenderer');sap.ui.define("sap/gantt/control/CellRenderer",[],function(){"use strict";var C={};C.render=function(r,c){var o=c.getContentToRender();if(o){r.renderControl(o);}};return C;},true);};if(!jQuery.sap.isDeclared('sap.gantt.control.ToolbarRenderer')){jQuery.sap.declare('sap.gantt.control.ToolbarRenderer');sap.ui.define("sap/gantt/control/ToolbarRenderer",[],function(){"use strict";var T={};T.render=function(r,t){var n=t.getAllToolbarItems().length;r.write("<div");r.writeControlData(t);r.addClass("sapGanttToolbar");if(n==0){r.addClass("sapGanttSkipToolbar");}r.writeClasses();r.write(">");r.renderControl(t.getAggregation("_toolbar"));r.write("</div>");};return T;},true);};if(!jQuery.sap.isDeclared('sap.gantt.def.DefBase')){jQuery.sap.declare('sap.gantt.def.DefBase');jQuery.sap.require('sap.ui.core.Element');sap.ui.define("sap/gantt/def/DefBase",["sap/ui/core/Element"],function(E){"use strict";var D=E.extend("sap.gantt.def.DefBase",{metadata:{"abstract":true,properties:{defString:{type:"string",defaultValue:null},refString:{type:"string",defaultValue:null}}}});D.prototype.getRefString=function(){var d=this.getProperty("refString");return d?d:"url(#"+this.generateRefId()+")";};D.prototype.generateRefId=function(){return this.getId();};return D;},true);};if(!jQuery.sap.isDeclared('sap.gantt.def.SvgDefs')){jQuery.sap.declare('sap.gantt.def.SvgDefs');jQuery.sap.require('sap.ui.base.ManagedObject');sap.ui.define("sap/gantt/def/SvgDefs",["sap/ui/base/ManagedObject"],function(M){"use strict";var S=M.extend("sap.gantt.def.SvgDefs",{metadata:{aggregations:{defs:{type:"sap.gantt.def.DefBase",multiple:true,visibility:"public",singularName:"def",bindable:"bindable"}}}});S.prototype.getDefString=function(){var r="<defs id='"+this.getId()+"'>",d=this.getDefs();if(d&&d.length>0){d.forEach(function(D,i){r+=D.getDefString();});}return r+"</defs>";};S.prototype.getDefNode=function(){var r={"id":this.getId(),"defNodes":[]};var d=this.getDefs();for(var i=0;i<d.length;i++){r.defNodes.push(d[i].getDefNode());}return r;};return S;},true);};if(!jQuery.sap.isDeclared('sap.gantt.def.cal.CalendarDefs')){jQuery.sap.declare('sap.gantt.def.cal.CalendarDefs');sap.ui.define("sap/gantt/def/cal/CalendarDefs",["../SvgDefs"],function(S){"use strict";var C=S.extend("sap.gantt.def.cal.CalendarDefs",{});C.prototype.getRefString=function(c){var i="";if(this.getParent()&&this.getParent().getId()){i=this.getParent().getId();}return"url(#"+i+"_"+c+")";};return C;},true);};if(!jQuery.sap.isDeclared('sap.gantt.def.filter.MorphologyFilter')){jQuery.sap.declare('sap.gantt.def.filter.MorphologyFilter');sap.ui.define("sap/gantt/def/filter/MorphologyFilter",["../DefBase"],function(D){"use strict";var M=D.extend("sap.gantt.def.filter.MorphologyFilter",{metadata:{properties:{operator:{type:"string",defaultValue:sap.gantt.def.filter.MorphologyOperator.Dilate},radius:{type:"string",defaultValue:"2,1"},colorMatrix:{type:"string",defaultValue:sap.gantt.def.filter.ColorMatrixValue.AllToWhite}}}});M.prototype.getDefString=function(){return"<filter id='"+this.getId()+"'>"+"<feMorphology in='SourceAlpha' result='morphed' operator='"+this.getOperator()+"' radius='"+this.getRadius()+"'/>"+"<feColorMatrix in='morphed' result='recolored' type='matrix' values='"+this.getColorMatrix()+"'/>"+"<feMerge>"+"<feMergeNode in='recolored'/>"+"<feMergeNode in='SourceGraphic'/>"+"</feMerge>"+"</filter>";};return M;},true);};if(!jQuery.sap.isDeclared('sap.gantt.def.gradient.LinearGradient')){jQuery.sap.declare('sap.gantt.def.gradient.LinearGradient');sap.ui.define("sap/gantt/def/gradient/LinearGradient",["../DefBase"],function(D){"use strict";var L=D.extend("sap.gantt.def.gradient.LinearGradient",{metadata:{properties:{x1:{type:"string",defaultValue:"0"},y1:{type:"string",defaultValue:"0"},x2:{type:"string",defaultValue:"100"},y2:{type:"string",defaultValue:"15"}},aggregations:{stops:{type:"sap.gantt.def.gradient.Stop",multiple:true,singularName:"stop"}}}});L.prototype.getDefString=function(){var r="<linearGradient id='"+this.getId()+"' x1='"+this.getX1()+"' y1='"+this.getY1()+"' x2='"+this.getX2()+"' y2='"+this.getY2()+"'>";var s=this.getStops();for(var i=0;i<s.length;i++){r=r.concat(s[i].getDefString());}r=r.concat("</linearGradient>");return r;};return L;},true);};if(!jQuery.sap.isDeclared('sap.gantt.def.gradient.RadialGradient')){jQuery.sap.declare('sap.gantt.def.gradient.RadialGradient');sap.ui.define("sap/gantt/def/gradient/RadialGradient",["../DefBase"],function(D){"use strict";var R=D.extend("sap.gantt.def.gradient.RadialGradient",{metadata:{properties:{cx:{type:"number",defaultValue:400},cy:{type:"number",defaultValue:200},r:{type:"number",defaultValue:300},fx:{type:"number",defaultValue:400},fy:{type:"number",defaultValue:200}},aggregations:{stops:{type:"sap.gantt.def.gradient.Stop",multiple:true,singularName:"stop"}}}});return R;},true);};if(!jQuery.sap.isDeclared('sap.gantt.def.gradient.Stop')){jQuery.sap.declare('sap.gantt.def.gradient.Stop');sap.ui.define("sap/gantt/def/gradient/Stop",["../DefBase"],function(D){"use strict";var S=D.extend("sap.gantt.def.gradient.Stop",{metadata:{properties:{offSet:{type:"string",defaultValue:"5%"},stopColor:{type:"sap.gantt.ValueSVGPaintServer",defaultValue:"#FFFFFF"}}}});S.prototype.getDefString=function(){return"<stop id='"+this.getId()+"' offset='"+this.getOffSet()+"' stop-color='"+this.getStopColor()+"' />";};return S;},true);};if(!jQuery.sap.isDeclared('sap.gantt.def.pattern.PatternBase')){jQuery.sap.declare('sap.gantt.def.pattern.PatternBase');sap.ui.define("sap/gantt/def/pattern/PatternBase",["../DefBase"],function(D){"use strict";var P=D.extend("sap.gantt.def.pattern.PatternBase",{metadata:{"abstract":true,properties:{tileWidth:{type:"int",defaultValue:8},tileHeight:{type:"int",defaultValue:8},backgroundColor:{type:"sap.gantt.ValueSVGPaintServer",defaultValue:"#fff"},backgroundFillOpacity:{type:"number",defaultValue:"1"}}}});return P;},true);};if(!jQuery.sap.isDeclared('sap.gantt.def.pattern.SlashPattern')){jQuery.sap.declare('sap.gantt.def.pattern.SlashPattern');sap.ui.define("sap/gantt/def/pattern/SlashPattern",["./PatternBase"],function(P){"use strict";var S=P.extend("sap.gantt.def.pattern.SlashPattern",{library:"sap.gantt",metadata:{properties:{path:{type:"string",defaultValue:null},stroke:{type:"sap.gantt.ValueSVGPaintServer"},strokeWidth:{type:"int",defaultValue:2}}}});S.prototype.getPath=function(){var t=this.getTileWidth();var a=this.getTileHeight();var s="";s=s.concat("M-").concat(t/4).concat(",").concat(a/4).concat(" ");s=s.concat("l").concat(t/2).concat(",-").concat(a/2).concat(" ");s=s.concat("M0").concat(",").concat(a).concat(" ");s=s.concat("l").concat(t).concat(",-").concat(a).concat(" ");s=s.concat("M").concat(t/4*3).concat(",").concat(a/4*5).concat(" ");s=s.concat("l").concat(t/2).concat(",-").concat(a/2).concat(" ");return s;};S.prototype.getDefString=function(){return"<pattern class='pattern' id='"+this.getId()+"' patternUnits='userSpaceOnUse' x='0' y='0' width='"+this.getTileWidth()+"' height='"+this.getTileHeight()+"'><rect x='0' width='"+this.getTileWidth()+"' height='"+this.getTileHeight()+"' fill='"+this.getBackgroundColor()+"' fill-opacity='"+this.getBackgroundFillOpacity()+"'></rect><path d='"+this.getPath()+"' stroke='"+this.getStroke()+"' stroke-width='"+this.getStrokeWidth()+"'></path></pattern>";};return S;},true);};if(!jQuery.sap.isDeclared('sap.gantt.drawer.Drawer')){jQuery.sap.declare('sap.gantt.drawer.Drawer');jQuery.sap.require('sap.ui.base.Object');sap.ui.define("sap/gantt/drawer/Drawer",["sap/ui/base/Object"],function(O){"use strict";var D=O.extend("sap.gantt.drawer.Drawer",{metadata:{"abstract":true}});return D;},true);};if(!jQuery.sap.isDeclared('sap.gantt.legend.LegendContainer')){jQuery.sap.declare('sap.gantt.legend.LegendContainer');jQuery.sap.require('sap.ui.core.Control');jQuery.sap.require('sap.m.NavContainer');jQuery.sap.require('sap.m.Page');jQuery.sap.require('sap.m.List');jQuery.sap.require('sap.m.StandardListItem');sap.ui.define("sap/gantt/legend/LegendContainer",["sap/ui/core/Control","sap/m/NavContainer","sap/m/Page","sap/m/List","sap/m/StandardListItem"],function(C,N,P,L,S){"use strict";var a=C.extend("sap.gantt.legend.LegendContainer",{metadata:{properties:{width:{type:"sap.ui.core.CSSSize",group:"Misc",defaultValue:"200px"},height:{type:"sap.ui.core.CSSSize",group:"Misc",defaultValue:"200px"}},aggregations:{legendSections:{type:"sap.m.Page",multiple:true,visibility:"public",singularName:"legendSection"}}}});a.prototype.init=function(){this._oRb=sap.ui.getCore().getLibraryResourceBundle("sap.gantt");this._sTitle=this._oRb.getText("LEGEND_TITLE");this._oNavContainer=new N({width:this.getWidth(),height:this.getHeight()});this._oInitNavPage=new P({title:this._oRb.getText("LEGEND_TITLE"),content:[new L()]});this._aLegendSections=[];};a.prototype.setWidth=function(w){this.setProperty("width",w,true);this._oNavContainer.setWidth(w);return this;};a.prototype.setHeight=function(h){this.setProperty("height",h,true);this._oNavContainer.setHeight(h);return this;};a.prototype.addLegendSection=function(l){if(l){if(this._aLegendSections.length==1){this._oNavContainer.insertPage(this._oInitNavPage,0);this._aLegendSections[0].setShowNavButton(true);}if(this._aLegendSections.length!==0){l.setShowNavButton(true);}l.attachNavButtonPress(this._onNavBack,this);l.setBackgroundDesign(sap.m.PageBackgroundDesign.Solid);l.setEnableScrolling(true);var s=l.getTitle();if(s!==undefined){var o=new S({title:s,type:sap.m.ListType.Navigation});o.attachPress(this._onNavToLegendSection,this);this._oInitNavPage.getContent()[0].addItem(o);}this._aLegendSections.push(l);this._oNavContainer.addPage(l);}return this;};a.prototype.insertLegendSection=function(l,i){if(l){var m=this._aLegendSections.length;if(m==1){this._oNavContainer.insertPage(this._oInitNavPage,0);this._aLegendSections[0].setShowNavButton(true);}if(m!==0){l.setShowNavButton(true);}if(i>=m){i=m;}l.attachNavButtonPress(this._onNavBack,this);l.setBackgroundDesign(sap.m.PageBackgroundDesign.Solid);l.setEnableScrolling(true);var s=l.getTitle();if(s!==undefined){var o=new S({title:s,type:sap.m.ListType.Navigation});o.attachPress(this._onNavToLegendSection,this);this._oInitNavPage.getContent()[0].insertItem(o,i);}this._oNavContainer.insertPage(l,i+1);this._aLegendSections.splice(i,0,l);}return this;};a.prototype.indexOfLegendSection=function(l){var i=jQuery.inArray(l,this._aLegendSections);return i;};a.prototype.removeLegendSection=function(p){var r;if((typeof p)==="number"){this._oNavContainer.removePage(p+1);this._oInitNavPage.getContent()[0].removeItem(p);r=this._aLegendSections.splice(p+1,1);}else if(p){this._oInitNavPage.getContent()[0].removeItem(jQuery.inArray(p,this._oNavContainer.getPages())-1);this._oNavContainer.removePage(p);r=this._aLegendSections.splice(jQuery.inArray(p,this._aLegendSections),1);}if(this._aLegendSections.length==1){if(this._oNavContainer.getCurrentPage()==this._oInitNavPage){this._oNavContainer.to(this._aLegendSections[0]);}this._aLegendSections[0].setShowNavButton(false);}return r;};a.prototype.removeAllLegendSection=function(){var r=this._aLegendSections.splice(0,this._aLegendSections.length);this._oInitNavPage.getContent()[0].removeAllItems();this._oNavContainer.removeAllPages();return r;};a.prototype.getLegendSections=function(){var p=this._oNavContainer.getPages();var t=this;return p.filter(function(v){if(v.getTitle()!==t._sTitle){return true;}});};a.prototype.getNavigationPage=function(){return this._oInitNavPage;};a.prototype.getNavigationItems=function(){return this._oInitNavPage.getContent()[0].getItems();};a.prototype.getCurrentLegendSection=function(){return this._oNavContainer.getCurrentPage();};a.prototype._onNavToLegendSection=function(e){var l=e.getSource().getTitle();for(var i=0;i<this._aLegendSections.length;i++){if(l==this._aLegendSections[i].getTitle()){this._oNavContainer.to(this._aLegendSections[i]);}}};a.prototype._onNavBack=function(e){this._oNavContainer.to(this._oInitNavPage);};return a;});};if(!jQuery.sap.isDeclared('sap.gantt.legend.LegendContainerRenderer')){jQuery.sap.declare('sap.gantt.legend.LegendContainerRenderer');sap.ui.define("sap/gantt/legend/LegendContainerRenderer",[],function(){"use strict";var L={};L.render=function(r,c){r.write("<div");r.writeControlData(c);r.writeClasses();r.addStyle("width",c.getWidth());r.addStyle("height","100%");r.writeStyles();r.write(">");r.renderControl(c._oNavContainer);r.write("</div>");};return L;},true);};if(!jQuery.sap.isDeclared('sap.gantt.legend.ListLegendRenderer')){jQuery.sap.declare('sap.gantt.legend.ListLegendRenderer');sap.ui.define("sap/gantt/legend/ListLegendRenderer",[],function(){"use strict";var L={};L.render=function(r,l){jQuery.sap.measure.start("ListLegendRenderer render","GanttPerf:ListLegendRenderer render function");r.write("<div");r.writeControlData(l);r.addStyle("width","100%");r.addStyle("height","100%");r.addStyle("position","relative");r.writeStyles();r.addClass("sapGanttListLegend");r.writeClasses();r.write(">");var s=l._aShapeInstance,a=l._getScaledLegendWidth()+"px",b=l._getScaledLegendHeight()+"px";for(var i=0;i<s.length;i++){var c=s[i].mShapeConfig.getProperty("legend");r.write("<div");r.writeAttributeEscaped("title",c);r.addClass("sapGanttLLItem");r.writeClasses();r.addStyle("height",b);r.addStyle("line-height",b);r.writeStyles();r.write(">");r.write("<svg");r.writeAttribute("id",l.getId()+"-svg-"+i);r.addStyle("width",a);r.writeStyles();r.addClass("sapGanttLLItemSvg");r.writeClasses();r.write("></svg>");r.write("<div");r.writeAttribute("id",l.getId()+"-txt-"+i);r.addClass("sapGanttLLItemTxt");r.writeClasses();r.addStyle(sap.ui.getCore().getConfiguration().getRTL()?"right":"left",a);r.addStyle("font-size",l.getFontSize()+"px");r.writeStyles();r.write(">");if(c){r.writeEscaped(c);}r.write("</div>");r.write("</div>");}jQuery.sap.measure.start("ListLegendRenderer renderPaintServer","GanttPerf:ListLegendRenderer renderPaintServer part");this.renderSvgDefs(r,l);jQuery.sap.measure.end("ListLegendRenderer renderPaintServer");jQuery.sap.measure.start("ListLegendRenderer renderSvgDiv","GanttPerf:GanttChartRenderer renderPaintServer part");jQuery.sap.measure.end("ListLegendRenderer renderSvgDiv");r.write("</div>");jQuery.sap.measure.end("ListLegendRenderer render");};L.renderSvgDefs=function(r,l){var s=l.getSvgDefs();if(s){r.write("<svg id='"+l.getId()+"-svg-psdef'");r.addStyle("float","left");r.addStyle("width","0px");r.addStyle("height","0px");r.writeStyles();r.write(">");r.write(s.getDefString());r.write("</svg>");}};L.renderSvgDiv=function(r,l){r.write("<div id='"+l.getId()+"-svg-ctn'");r.addClass("sapGanttListLegendSvgCtn");r.writeClasses();r.write(">");r.write("<svg id='"+l.getId()+"-svg'");r.addClass("sapGanttListLegendSvg");r.writeClasses();r.addStyle("height","100%");r.addStyle("width","100%");r.writeStyles();r.write(">");r.write("</svg>");r.write("</div>");};return L;},true);};if(!jQuery.sap.isDeclared('sap.gantt.misc.Format')){jQuery.sap.declare('sap.gantt.misc.Format');sap.ui.define("sap/gantt/misc/Format",[],function(){"use strict";var F=function(){throw new Error();};F.abapTimestampToDate=function(t){if(typeof t==="string"){var d=new Date(t.substr(0,4),parseInt(t.substr(4,2),0)-1,t.substr(6,2),t.substr(8,2),t.substr(10,2),t.substr(12,2));if(!jQuery.isNumeric(d.getTime())){d=new Date(t);}return d;}else if(jQuery.type(t)==="date"){return t;}return null;};F.dateToAbapTimestamp=function(d){return""+d.getFullYear()+(d.getMonth()<9?"0":"")+(d.getMonth()+1)+(d.getDate()<10?"0":"")+d.getDate()+(d.getHours()<10?"0":"")+d.getHours()+(d.getMinutes()<10?"0":"")+d.getMinutes()+(d.getSeconds()<10?"0":"")+d.getSeconds();};F.abapTimestampToTimeLabel=function(t,l){var a=sap.gantt.misc.Format._convertUTCToLocalTime(t,l);var f=sap.ui.core.format.DateFormat.getDateTimeInstance();var L=f.format(a);return L;};F._convertUTCToLocalTime=function(t,l){var a=0;if(l&&l.getUtcdiff()){var f=d3.time.format("%Y%m%d%H%M%S");a=Math.round((f.parse("20000101"+l.getUtcdiff()).getTime()-f.parse("20000101000000").getTime())/1000);if(l.getUtcsign()==="-"){a=-a;}}var u=sap.gantt.misc.Format.abapTimestampToDate(t);var b=d3.time.second.offset(u,a);var d=l.getDstHorizons();if(d.length>0){for(var i=0;i<d.length;i++){var s=sap.gantt.misc.Format.abapTimestampToDate(d[i].getStartTime());var e=sap.gantt.misc.Format.abapTimestampToDate(d[i].getEndTime());if(b>=s&&b<=e){b=d3.time.second.offset(b,60*60);}}}return b;};return F;},true);};if(!jQuery.sap.isDeclared('sap.gantt.misc.TreeTableHelper')){jQuery.sap.declare('sap.gantt.misc.TreeTableHelper');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.model.FilterProcessor');jQuery.sap.require('sap.ui.model.Filter');jQuery.sap.require('sap.ui.model.SorterProcessor');jQuery.sap.require('sap.ui.model.Sorter');jQuery.sap.require('sap.ui.model.Context');sap.ui.define("sap/gantt/misc/TreeTableHelper",["jquery.sap.global","sap/ui/model/FilterProcessor","sap/ui/model/Filter","sap/ui/model/SorterProcessor","sap/ui/model/Sorter","sap/ui/model/Context"],function(q,F,c,S,d,C){"use strict";var T=function(){};T.JSONDataKey="originJSONData";T.addDummyData=function(t,D,r){var a=[];if(r){a=t.getSelectedIndices().map(function(I){return T._buildContextMap(t,I,null,null);});}var b=this._contextIndexMap(t,D);if(b&&b.length>0){for(var i=0;i<b.length;i++){var o=b[i];this._addDummyDataToChildren(t,o);}}T._updateModalBinding(b);if(r){this._restoreSelectedIndices(t,a);}};T.removeDummyDataFromSelectedIndices=function(t,s,g){var A=t.getSelectedIndices().map(function(I){return T._buildContextMap(t,I,null,null);});s=(s||[]).sort(function(a,b){return a-b;});var e=s.map(function(I){return T._buildContextMap(t,I,null,g);});for(var i=0;i<e.length;i++){this._removeDummyDataFromSelectedIndex(t,e[i]);}T._updateModalBinding(e);this._restoreSelectedIndices(t,A);};T.isDummyRow=function(t,s){var o=t.getContextByIndex(s);if(o){var a=o.getObject();return!!a.__dummy;}else{return false;}};T.isMultipleSpanMainRow=function(t,s,r){var i;if(!r){var R=t.getRows()[s];if(R){i=R.getIndex();}else{return false;}}else{i=s;}var o=t.getContextByIndex(i);if(o){var a=o.getObject();if(a&&a.previousNodeNum!==undefined&&a.afterNodeNum!==undefined){return true;}else{return false;}}else{return false;}};T.getMultipleSpanMainRowGroupIndices=function(t,s,r){if(this.isMultipleSpanMainRow(t,s,r)){var I;if(!r){var R=t.getRows()[s];if(R){I=R.getIndex();}else{return false;}}else{I=s;}var a=t.getContextByIndex(I).getObject();var b=s-a.previousNodeNum;var e=s+a.afterNodeNum;var m=[];for(var i=b;i<=e;i++){m.push(i);}return m;}else{return null;}};T.getContextObject=function(t,s){var o=t.getContextByIndex(s);if(o){return o.getObject();}};T.toggleOpenStateWithRowIndex=function(t,s,e){var o=t.getContextByIndex(s),m=o.getModel(),a=o.getObject(),p=this._getParentBindingPath(o),P=o.getObject(p);var A=this._getBindingParameterArrayNames(t);if(e){var l=this._collectNumberOfSiblingDummyData(a,P,null);var r=this._removeSiblingDummyData(a,P,null);this._addDummyDataToChildrenInBatch(t,s,r);q.sap.log.info("Move "+l.length+" rows out to its parent level");}else{var R=this._removeChildrenDummyData(a,A,null);var i=q.inArray(a,P);P.splice.apply(P,[i+1,0].concat(R));q.sap.log.info("Move "+R.length+" rows into its children");}m.updateBindings(false);var b=t.getSelectedIndices();t.clearSelection();b.forEach(function(I){t.addSelectionInterval(I,I);});};T.filter=function(e){e.preventDefault();var t=e.getSource(),a=t.getColumns(),b=t.getBinding("rows"),m=b.getModel();t.clearSelection();T.clearAllDummyData(t);var o=e.getParameter('column'),v=e.getParameter('value');if(v){o.setFiltered(true);o.setFilterValue(v);}else{o.setFiltered(false);o.setFilterValue(null);}if(!t.data(T.JSONDataKey)){var f=m.getProperty(b.getPath());t.data(T.JSONDataKey,q.extend(true,{},f));}m.setProperty(b.getPath(),q.extend(true,{},t.data(T.JSONDataKey)),null,true);m.updateBindings(false);var u=T._getRecursiveContexts(b);var g=a.filter(function(o){return o.getFiltered();}).map(function(o){return o._getFilter();});var s=a.filter(function(o){return o.getSorted();}).map(function(o){return new d(o.getSortProperty(),o.getSortOrder()===sap.ui.table.SortOrder.Descending);});var p=[],P;if(g.length>0){p=F.apply(u,g,function(r,i){var O=r.getObject();var V=O[i];if(V!=undefined&&typeof V!=="string"&&!(V instanceof Date)){V=(V).toString();}return V;});P=T._parseDataFromContexts(t,p);m.setProperty(b.getPath(),P);m.updateBindings(false);}else{P=q.extend(true,{},t.data(T.JSONDataKey));p=u;}if(s.length>0){var h=T._getSortedRecursiveContexts(b,s,5);P=T._parseDataFromContexts(t,h);}m.setProperty(b.getPath(),P);q.sap.log.info("Table filter "+o+' value is '+v);};T._sortContexts=function(a,s){var n=q.isArray(s)?s:[s];return S.apply(a,n,function(o,p){return o.getObject()[p];});};T.sort=function(e){e.preventDefault();var o=e.getParameter('column'),s=e.getParameter('sortOrder');var t=e.getSource(),a=t.getColumns(),b=t.getBinding("rows"),m=b.getModel();t.clearSelection();T.clearAllDummyData(t);a.forEach(function(o){o.setSorted(false);o.setSortOrder(sap.ui.table.SortOrder.Ascending);});o.setSorted(true);o.setSortOrder(s);var n=new d(o.getSortProperty(),s===sap.ui.table.SortOrder.Descending);var f=T._getSortedRecursiveContexts(b,n,5);var g=this._parseDataFromContexts(t,f);m.setProperty(b.getPath(),g);};T.clearAllDummyData=function(t){var b=t.getBinding("rows"),B=b.getLength(),I=[];var a;for(var i=0;i<B;i++){if(!this.isDummyRow(t,i)){a=i;}else if(I.indexOf(a)===-1){I.push(a);}}if(I.length>0){var e=I.map(function(f){return T._buildContextMap(t,f,null);});for(var j=0;j<e.length;j++){this._removeDummyDataFromSelectedIndex(t,e[j]);}T._updateModalBinding(e);}};T._parseDataFromContexts=function(t,a){var b=t.getBinding("rows"),o=q.extend({},b.getModel().getProperty(b.getPath())),r=null,B=b.getPath();if(a.length===0){return{};}var m={aOriginPathChain:[],sHittedOnPath:null,aMappingChain:[]};var A=this._getBindingParameterArrayNames(t);for(var i=0;i<a.length;i++){var p=a[i].getPath(),R=p.replace(B,""),P=R.split("/");P.pop();var s=P.join("/");var e=q.extend({},this._getObjFromPath(o,R)),I=this._getObjFromPath(r,m[s]);if(I===null){r=this._buildDataFormOriginData(r,o,s,m);I=this._getObjFromPath(r,m[s]);}if(!m[R]){I.push(e);m.aOriginPathChain=R.split("/");m.sHittedOnPath=s;m.aMappingChain=[I.length-1];this._updateMapping(m);for(var j=0;j<A.length;j++){if(e[A[j]]){e[A[j]]=[];m.aOriginPathChain=R.split("/");m.sHittedOnPath=s;m.aMappingChain=[I.length-1];m.aOriginPathChain.push(A[j]);m.aMappingChain.push(A[j]);this._updateMapping(m);}}}}return r;};T._buildDataFormOriginData=function(t,o,p,P){var a=p.split("/");P.aOriginPathChain=q.extend([],a);var A=a.pop(),n=a.join("/"),b=q.extend({},this._getObjFromPath(o,n));P.aMappingChain.push("X");P.aMappingChain.push(A);b[A]=[];t=this._buildDataRecursive(t,o,n,b,P);this._updateMapping(P);return t;};T._buildDataRecursive=function(t,o,n,a,p){if(n===""){p.aMappingChain[0]="";if(!p[""]){p[""]="";}return a;}else{var P=n.split("/");P.pop();var s=P.join("/"),b=P.pop(),e=P.join("/"),f=q.extend({},this._getObjFromPath(o,e));var i=this._getObjFromPath(t,p[e]);if(i!==null){i[b].push(a);p.sHittedOnPath=s;p.aMappingChain[0]=i[b].length-1;return t;}else{f[b]=[];f[b].push(a);p.aMappingChain[0]="0";p.aMappingChain.unshift(b);p.aMappingChain.unshift("X");return this._buildDataRecursive(t,o,e,f,p);}}};T._updateMapping=function(p){var o="",h="";if(p.sHittedOnPath!==null){o=p.sHittedOnPath;h=p[p.sHittedOnPath];var H=h.split("/");var l=p.aOriginPathChain.length-H.length,b=H.length;for(var i=0;i<l;i++){o=o+"/"+p.aOriginPathChain[i+b];h=h+"/"+p.aMappingChain[i];p[o]=h;}}else if(p.aOriginPathChain.length===p.aMappingChain.length){for(var j=0;j<p.aMappingChain.length;j++){if(p.aMappingChain[j]!==""){o=o+"/"+p.aOriginPathChain[j];h=h+"/"+p.aMappingChain[j];p[o]=h;}}}p.aOriginPathChain=[];p.sHittedOnPath=null;p.aMappingChain=[];};T._getObjFromPath=function(o,p){if(o===null||p===undefined){return null;}else if(p==""){return o;}var P=p.split("/"),r=o,m=false;for(var i=0;i<P.length;i++){if(P[i]!==""){if(r[P[i]]!==undefined){m=true;r=r[P[i]];}else{m=false;return null;}}}if(m){return r;}else{return null;}};T._removeDummyDataFromSelectedIndex=function(t,o){var g=o.group||null;var e=o.expanded,s=o.object,p=o.parentObject;var a=this._getBindingParameterArrayNames(t);if(e){this._removeChildrenDummyData(s,a,g);}else{this._removeSiblingDummyData(s,p,g);}q.sap.log.info("Remove dummy rows for selecting row");};T._addDummyDataToChildren=function(t,o){var D=o.dummyData;D.forEach(function(i,I,A){A[I]=q.extend({__group:null},i,{__dummy:true});});var a=this._getBindingParameterArrayNames(t);var s=o.object;if(s&&s.__dummy){return;}var e=t.isExpanded(o.oldIndex);var f=D[0].__group;var b=false;a.forEach(function(n){var g=s[n];if(g&&e){var i=-1;q.each(g,function(j,k){if(k.__group===f){b=true;}if(j===0&&!!k.__dummy===false){i=0;}else if(!!k.__dummy===true){i=j;}return false;});if(i==-1||i==0){i=0;}else{i+=1;}if(!b){g.splice.apply(g,[i,0].concat(D));}}else{q.sap.log.warning("parameter "+n+" data node doesn not exist");var p=o.parentObject;var h=q.inArray(s,p);if(h>=0){var I=h+1;while(p[I]&&p[I].__dummy){if(p[I].__group===f){b=true;}I++;}if(!b){p.splice.apply(p,[I,0].concat(D));}}}});};T._addDummyDataToChildrenInBatch=function(t,s,D){var a=this._getBindingParameterArrayNames(t);var o=t.getContextByIndex(s),b=o.getObject();a.forEach(function(n){var e=b[n];if(e){e.unshift.apply(e,D);}else{q.sap.log.warning("parameter "+n+" data node doesn not exist");}});};T._getBindingParameterArrayNames=function(t){return t.getBindingInfo("rows").parameters.arrayNames;};T._getParentBindingPath=function(o){var p=o.getPath().split("/");p.pop();return p.join("/");};T._removeSiblingDummyData=function(s,p,g){var l=this._collectNumberOfSiblingDummyData(s,p,g);return p.splice(l.index+1,l.length);};T._removeChildrenDummyData=function(s,a,g){var r=[];a.forEach(function(n){var b=s[n];if(b){var i=-1,e=0;q.each(b,function(I,o){if(o.__dummy&&(o.__group===g||g===null)){if(i===-1){i=I;}e++;return true;}else if(o.__dummy){return true;}else{return false;}});if(i!==-1&&e>0){r.push.apply(r,b.splice(i,e));}}else{q.sap.log.info("NO dummy rows were found");}});return r;};T._collectNumberOfSiblingDummyData=function(s,p,g){var n=0;var f=-1;var i=q.inArray(s,p);if(i>=0){var I=i+1;var N=p[I];while(N&&N.__dummy){if(N.__group==g||g===null){n++;if(f==-1){f=I;}}I++;N=p[I];}}if(f!=-1){f-=1;}var r={index:f,length:n};return r;};T._restoreSelectedIndices=function(t,a){if(a.length===0){return;}q.sap.delayedCall(100,t,function(){t.clearSelection();a.forEach(function(o){var b=t.getBinding("rows");if(b&&b.findNode){var l=b.getLength();for(var i=0;i<l;i++){var n=b.findNode(i);if(q.sap.equal(n.context.getObject(),o.object,1)){t.addSelectionInterval(i,i);break;}}}});});};T._contextIndexMap=function(t,D){var s=Object.keys(D).map(function(k){return parseInt(k,10);}).sort(function(a,b){return a-b;});return s.map(function(i){return T._buildContextMap(t,i,D,null);});};T._buildContextMap=function(t,s,D,g){var o=t.getContextByIndex(s),m=o.getModel();var p=T._getParentBindingPath(o),P=m.getProperty(p);var e=false;var b=t.getBinding("rows");if(b.hasChildren&&b.hasChildren(o)){e=t.isExpanded(s);}var a={oldIndex:s,path:o.getPath(),object:o.getObject(),parentObject:P,context:o,expanded:e};if(D&&D[s]){a.dummyData=D[s];}if(g){a.group=g;}return a;};T._updateModalBinding=function(a){var u=false;for(var i=0;i<a.length;i++){if(u){break;}else{var o=a[i];o.context.getModel().updateBindings(false);u=true;}}};T._getRecursiveContexts=function(b){var r=[];var R=b.getRootContexts(0,b.getLength());var f=function(a){var n=[];a.forEach(function(o){n=n.concat(o);var i=b.getChildCount(o),h=i>0,e=[];if(h){e=b.getNodeContexts(o,0,i);n=n.concat(f(e));}});return n;};r=f(R);return r;};T._getSortedRecursiveContexts=function(b,s,l){l=l?l:1;var r=[];var R=b.getRootContexts(0,b.getLength());r.push(R);var g=function(j){var n=[];j.forEach(function(o){var k=b.getChildCount(o),H=k>0;if(H){var m=b.getNodeContexts(o,0,k);n=n.concat(m);}});return n;};var a=R;while(r.length<=l){var e=g(a);if(e.length===0){break;}else{r.push(e);}a=e;}var f=[];for(var i=0;i<r.length;i++){var h=T._sortContexts(r[i],s);f=f.concat(h);}return f;};return T;},true);};if(!jQuery.sap.isDeclared('sap.gantt.misc.Utility')){jQuery.sap.declare('sap.gantt.misc.Utility');sap.ui.define("sap/gantt/misc/Utility",["sap/gantt/misc/Format"],function(F){"use strict";var U={};U.assign=function(i,d){if(typeof(i)!==typeof(d)){return d;}else if((typeof i==="undefined")||i===null){return d;}else{return i;}};U.assignDeep=function(i,d){if(!i&&!d){return null;}else if(i&&!d){return i;}else if(!i&&d){return d;}else if(typeof(i)==="object"&&typeof(d)==="object"){var r=i;for(var a in d){if(typeof(r[a])!=="boolean"&&!r[a]){r[a]=d[a];}else if(typeof(d[a])==="object"&&typeof(r[a])==="object"){r[a]=this.assignDeep(r[a],d[a]);}}return r;}else{return i;}};U.generateRowUid=function(d,o,s,p){jQuery.each(d,function(k,v){v.uid=v.id;if(p){v.uid=p+"|"+v.uid;}else if(v.bindingObj&&v.bindingObj.findNode){var n=v.bindingObj.findNode(v.rowIndex);while(n.parent&&n.level>0){n=n.parent;v.uid=n.context.getObject().id+"|"+v.uid;}}v.uid="PATH:"+v.uid+"|SCHEME:"+v.chartScheme+"["+v.index+"]";for(var i=0;i<s.length;i++){var D=s[i];if(D in v.data){for(var j=0;j<v.data[D].length;j++){var a=v.data[D][j];if(a.id===undefined){a.id=j;}a.uid=v.uid+"|DATA:"+D+"["+a.id+"]";}}}});};U.generateUidByShapeDataName=function(d,s){if(s===undefined){s="relationship";}for(var i=0;i<d.length;i++){if(d[i].id===undefined){d[i].id=i;}d[i].uid="|DATA:"+s+"["+d[i].id+"]";}};U.generateObjectPathToObjectMap=function(d,m,p){var r;for(var i in d){var o=d[i],a;if(o.objectInfoRef){a=o.objectInfoRef.data.id;o=o.objectInfoRef;}else{a=o.data.id;}if(p&&p!=""){a=p.concat(".").concat(a);}m[a]=o;if(o.children&&o.children.length>0){r=this.generateObjectPathToObjectMap(o.children,m,a);}}return r;};U.getDataTypeByUid=function(u){if(u!==null&&u!==undefined){var p=new RegExp("\\|DATA:","");var s=new RegExp("\\[","");var f=p.exec(u);var l=s.exec(u);var d=null;if((f!==null)&&(l!==null)){d=u.substring(f.index+6,l.index);}if(d){return d;}else{return undefined;}}return undefined;};U.getObjectIdByUid=function(u,i){if(u!==null&&u!==undefined){var p=new RegExp("PATH:","");var s,o;if(i){s=new RegExp("\\|SCHEME:","");}else{s=new RegExp("\\|DATA:","");}var f=p.exec(u);var l=s.exec(u);if((f!==null)&&(l!==null)){o=u.substring(f.index+5,l.index);}if(o){return o;}else{return undefined;}}return undefined;};U.abapTsToDate=function(t){if(typeof t==="string"&&t.length>=6){return new Date(t.substr(0,4),parseInt(t.substr(4,2),0)-1,t.substr(6,2),t.substr(8,2),t.substr(10,2),t.substr(12,2));}return null;};U.scaleBySapUiSize=function(m,n){switch(m){case"sapUiSizeCozy":return n*1.5;case"sapUiSizeCondensed":return n*0.78;default:return n;}};U.findSapUiSizeClass=function(c){var $,a;if(c){$=c.$();}else{$=jQuery("body");}if($){a=$.closest(".sapUiSizeCompact,.sapUiSizeCondensed,.sapUiSizeCozy");if(a.hasClass("sapUiSizeCondensed")){return"sapUiSizeCondensed";}else if(a.hasClass("sapUiSizeCompact")){return"sapUiSizeCompact";}else if(a.hasClass("sapUiSizeCozy")){return"sapUiSizeCozy";}}};return U;},true);};if(!jQuery.sap.isDeclared('sap.gantt.shape.Shape')){jQuery.sap.declare('sap.gantt.shape.Shape');jQuery.sap.require('sap.ui.core.Element');jQuery.sap.require('sap.ui.core.Core');jQuery.sap.require('sap.ui.core.format.NumberFormat');sap.ui.define("sap/gantt/shape/Shape",["sap/ui/core/Element","sap/gantt/misc/Utility","sap/gantt/misc/Format","sap/ui/core/Core","sap/ui/core/format/NumberFormat"],function(E,U,F,C,N){"use strict";var S=E.extend("sap.gantt.shape.Shape",{metadata:{"abstract":true,properties:{tag:{type:"string"},category:{type:"string",defaultValue:sap.gantt.shape.ShapeCategory.InRowShape},htmlClass:{type:"string"},isDuration:{type:"boolean",defaultValue:false},time:{type:"string"},endTime:{type:"string"},title:{type:"string"},ariaLabel:{type:"string"},xBias:{type:"number",defaultValue:0},yBias:{type:"number",defaultValue:0},fill:{type:"sap.gantt.ValueSVGPaintServer"},strokeOpacity:{type:"number",defaultValue:1},fillOpacity:{type:"number",defaultValue:1},stroke:{type:"sap.gantt.ValueSVGPaintServer"},strokeWidth:{type:"number",defaultValue:2},strokeDasharray:{type:"string"},clipPath:{type:"string"},transform:{type:"string"},filter:{type:"string"},enableDnD:{type:"boolean",defaultValue:false},enableSelection:{type:"boolean",defaultValue:true},rowYCenter:{type:"number",defaultValue:7.5},rotationCenter:{type:"array"},rotationAngle:{type:"number"},isBulk:{type:"boolean",defaultValue:false},arrayAttribute:{type:"string"},timeFilterAttribute:{type:"string"},endTimeFilterAttribute:{type:"string"}},aggregations:{selectedShape:{type:"sap.gantt.shape.SelectedShape",multiple:false}}}});S.prototype.init=function(){var r=sap.ui.getCore().getLibraryResourceBundle("sap.gantt");this.setProperty("ariaLabel",r.getText("ARIA_SHAPE"));this.mShapeConfig=null;this.mLocaleConfig=null;this.mChartInstance=null;};S.prototype.getTag=function(d){return this._configFirst("tag",d);};S.prototype.getCategory=function(d){return this._configFirst("category",d);};S.prototype.getHtmlClass=function(d){return this._configFirst("htmlClass",d);};S.prototype.getIsDuration=function(d){return this._configFirst("isDuration",d);};S.prototype.getTime=function(d){return this._configFirst("time",d);};S.prototype.getEndTime=function(d){return this._configFirst("endTime",d);};S.prototype.getTitle=function(d){return this._configFirst("title",d);};S.prototype.getAriaLabel=function(d){return this._configFirst("ariaLabel",d);};S.prototype.getXBias=function(d){if(C.getConfiguration().getRTL()===true){return 0-this._configFirst("xBias",d);}else{return this._configFirst("xBias",d);}};S.prototype.getYBias=function(d){return this._configFirst("yBias",d,true);};S.prototype.getFill=function(d,r){return this._configFirst("fill",d);};S.prototype.getStrokeOpacity=function(d){return this._configFirst("strokeOpacity",d);};S.prototype.getFillOpacity=function(d){return this._configFirst("fillOpacity",d);};S.prototype.getStroke=function(d){return this._configFirst("stroke",d);};S.prototype.getStrokeWidth=function(d){return this._configFirst("strokeWidth",d,true);};S.prototype.getStrokeDasharray=function(d){return this._configFirst("strokeDasharray",d);};S.prototype.getClipPath=function(d){return this._configFirst("clipPath",d);};S.prototype.getTransform=function(d,r){if(this.mShapeConfig.hasShapeProperty("transform")){return this._configFirst("transform",d);}var R=[];this._translate(d,r,R);this._rotate(d,r,R);if(R.length>0){return R.join(" ");}};S.prototype._rotate=function(d,r,R){var c=this.getRotationCenter(d,r),n=this.getRotationAngle(d,r);if(c&&c.length===2&&n){R.push("rotate("+n+" "+c[0]+" "+c[1]+")");}};S.prototype._translate=function(d,r,R){var n=this.getXBias(d,r),a=this.getYBias(d,r);if(n||a){n=n?n:0;a=a?a:0;R.push("translate("+n+" "+a+")");}};S.prototype.getFilter=function(d){return this._configFirst("filter",d);};S.prototype.getEnableDnD=function(d){return this._configFirst("enableDnD",d);};S.prototype.getEnableSelection=function(d){return this._configFirst("enableSelection",d);};S.prototype.getRotationAngle=function(d){return this._rtlRotation(this._configFirst("rotationAngle",d));};S.prototype._rtlRotation=function(n){if(n>0||n<0){if(C.getConfiguration().getRTL()){return 360-n;}else{return n;}}};S.prototype.getRowYCenter=function(d,r){if(this.mShapeConfig.hasShapeProperty("rowYCenter")){return this._configFirst("rowYCenter",d);}if(r){return r.y+r.rowHeight/2;}else{return this.getProperty("rowYCenter");}};S.prototype.getRotationCenter=function(d,r){if(this.mShapeConfig.hasShapeProperty("rotationCenter")){return this._configFirst("rotationCenter",d);}return this._getCenter(d,r);};S.prototype._getCenter=function(d,r,e){var a=this.mChartInstance.getAxisTime();var t=e?this.getEndTime(d,r):this.getTime(d,r);if(!t){return undefined;}var n=a.timeToView(F.abapTimestampToDate(t));if(!n&&!n==0){n=a.timeToView(0);}var b=this.getRowYCenter(d,r);return[n,b];};S.prototype.getIsBulk=function(d){return this._configFirst("isBulk",d);};S.prototype.getArrayAttribute=function(d){return this._configFirst("arrayAttribute",d);};S.prototype.getTimeFilterAttribute=function(d){return this._configFirst("timeFilterAttribute",d);};S.prototype.getEndTimeFilterAttribute=function(d){return this._configFirst("endTimeFilterAttribute",d);};S.prototype._configFirst=function(a,d,s){var p=null;if(this.mShapeConfig.hasShapeProperty(a)){var c=this.mShapeConfig.getShapeProperty(a);if(typeof c==="string"){p=this._formatting(d,a,c);}else{p=c;}}else{p=this.getProperty(a);}if(s){var m=this.mChartInstance.getSapUiSizeClass();p=U.scaleBySapUiSize(m,p);}return p;};S.prototype.getShapeViewBoundary=function(){var s=this.mChartInstance._oStatusSet;if(s&&s.aViewBoundary){return s.aViewBoundary;}return null;};S.prototype._formatting=function(d,a,A){if(!A){return"";}this._attributeNameBindingMap=this._attributeNameBindingMap||{};if(!this._attributeNameBindingMap[a]){this._attributeNameBindingMap[a]=this._resolveAttributeMap(A);}return this._formatFromResolvedAttributeMap(d,a);};S.prototype._resolveAttributeMap=function(a){var r=[];var m=a.match(/[^\{\}]*(\{.*?\})?/g);m.pop();m.forEach(function(v,i,A){var o={},s=v.split("{");if(s[0].length>0){o.leadingText=s[0];}if(s[1]){s=s[1].split("}")[0].split(":");if(s[0].length>0){o.attributeName=s[0].trim().split("/");}if(s[1]){o.attributeType=s[1].trim();}}r.push(o);});return r;};S.prototype._formatFromResolvedAttributeMap=function(d,a){var A=this._attributeNameBindingMap[a],r=[],p,v;if(A){A.forEach(function(P,i){p=P.leadingText;if(P.attributeName){v=d;P.attributeName.forEach(function(s,i){v=v[s];});if(p){p=p+this._formatValue(v,P.attributeType);}else{p=this._formatValue(v,P.attributeType);}}r.push(p);}.bind(this));}if(r.length===1){return r[0];}return r.join("");};S.prototype._formatValue=function(a,t){var l=this.mLocaleConfig,r=a;switch(t){case"Number":r=this._formatNumber(a);break;case"Timestamp":if(l!=undefined){r=F.abapTimestampToTimeLabel(a,l);}break;default:if(r===undefined||r===null){r="";}break;}return r;};S.prototype._formatNumber=function(n,d){var r="";if(d!==undefined){r=N.getFloatInstance({minFractionDigits:d,maxFractionDigits:d}).format(n);}else{r=N.getFloatInstance().format(n);}return r;};return S;},true);};if(!jQuery.sap.isDeclared('sap.gantt.shape.Text')){jQuery.sap.declare('sap.gantt.shape.Text');jQuery.sap.require('sap.ui.core.Core');sap.ui.define("sap/gantt/shape/Text",["sap/gantt/shape/Shape","sap/gantt/misc/Utility","sap/gantt/misc/Format","sap/ui/core/Core"],function(S,U,F,C){"use strict";var T=S.extend("sap.gantt.shape.Text",{metadata:{properties:{tag:{type:"string",defaultValue:"text"},text:{type:"string"},x:{type:"number"},y:{type:"number"},fontSize:{type:"number",defaultValue:10},textAnchor:{type:"string",defaultValue:"start"},fontFamily:{type:"string"},wrapWidth:{type:"number",defaultValue:-1},wrapDy:{type:"number",defaultValue:20},truncateWidth:{type:"number",defaultValue:-1},ellipsisWidth:{type:"number",defaultValue:12}}}});T.prototype.getX=function(d,r){if(this.mShapeConfig.hasShapeProperty("x")){return this._configFirst("x",d);}var t=this.getTime(d,r);var a=this.mChartInstance.getAxisTime();var x=a.timeToView(F.abapTimestampToDate(t));if(isNaN(x)||!x){x=a.timeToView(0).toFixed(1);}return x;};T.prototype.getY=function(d,r){if(this.mShapeConfig.hasShapeProperty("y")){return this._configFirst("y",d);}return this.getRowYCenter(d,r)+this.getFontSize(d,r)/2;};T.prototype.getText=function(d){return this._configFirst("text",d);};T.prototype.getTextAnchor=function(d){return this._configFirst("textAnchor",d);};T.prototype.getFontSize=function(d){return this._configFirst("fontSize",d,true);};T.prototype.getWrapWidth=function(d){return this._configFirst("wrapWidth",d);};T.prototype.getWrapDy=function(d){return this._configFirst("wrapDy",d);};T.prototype.getTruncateWidth=function(d){return this._configFirst("truncateWidth",d);};T.prototype.getEllipsisWidth=function(d){return this._configFirst("ellipsisWidth",d);};return T;},true);};if(!jQuery.sap.isDeclared('sap.gantt.GanttChartContainerRenderer')){jQuery.sap.declare('sap.gantt.GanttChartContainerRenderer');jQuery.sap.require('sap.ui.core.theming.Parameters');sap.ui.define("sap/gantt/GanttChartContainerRenderer",['sap/ui/core/theming/Parameters',"sap/gantt/misc/Utility"],function(P,U){"use strict";var G={};G.render=function(r,g){jQuery.sap.measure.start("GanttChartContainerRenderer render","GanttPerf:GanttChartContainerRenderer render function");r.write("<div");r.writeControlData(g);r.addStyle("width",g.getWidth());r.addStyle("height",g.getHeight());r.writeStyles();r.addClass("sapGanttChartContainer");r.writeClasses();r.write(">");jQuery.sap.measure.start("GanttChartContainerRenderer renderPaintServer","GanttPerf:GanttChartContainerRenderer renderPaintServer part");this.renderSvgDefs(r,g);jQuery.sap.measure.end("GanttChartContainerRenderer renderPaintServer");jQuery.sap.measure.start("GanttChartContainerRenderer renderToolbar","GanttPerf:GanttChartContainerRenderer renderToolbar part");this.renderToolbar(r,g);jQuery.sap.measure.end("GanttChartContainerRenderer renderToolbar");jQuery.sap.measure.start("GanttChartContainerRenderer renderGanttCharts","GanttPerf:GanttChartContainerRenderer renderGanttCharts part");this.renderGanttCharts(r,g);jQuery.sap.measure.end("GanttChartContainerRenderer renderGanttCharts");r.write("</div>");jQuery.sap.measure.end("GanttChartContainerRenderer render");};G.renderSvgDefs=function(r,g){var s=g.getSvgDefs();if(s){r.write("<svg id='"+g.getId()+"-svg-psdef'");r.addClass("sapGanttInvisiblePaintServer");r.writeClasses();r.write(">");r.write(s.getDefString());r.write("</svg>");}};G.renderToolbar=function(r,g){r.renderControl(g._oToolbar);};G.renderGanttCharts=function(r,g){r.write("<div");r.addClass("sapGanttViewContainer");r.writeClasses();r.addStyle("width",g.getWidth());var s=g.getHeight();if(g._oToolbar.getAllToolbarItems().length>0){var c=U.findSapUiSizeClass();var t=(c==="sapUiSizeCozy")?P.get("sapGlobalToolbarCozyHeight"):P.get("sapGlobalToolbarCompactHeight");s="calc("+s+" - "+t+")";}r.addStyle("height",s);r.writeStyles();r.write(">");r.renderControl(g._oSplitter);r.write("</div>");};return G;},true);};if(!jQuery.sap.isDeclared('sap.gantt.config.ExpandChartGroup')){jQuery.sap.declare('sap.gantt.config.ExpandChartGroup');jQuery.sap.require('jquery.sap.global');sap.ui.define("sap/gantt/config/ExpandChartGroup",['jquery.sap.global','./ToolbarGroup'],function(q,T){"use strict";var E=T.extend("sap.gantt.config.ExpandChartGroup",{metadata:{properties:{expandCharts:{type:"array",defaultValue:[]},enableRichType:{type:"boolean"},showArrowText:{type:"boolean"}}}});return E;},true);};if(!jQuery.sap.isDeclared('sap.gantt.config.LayoutGroup')){jQuery.sap.declare('sap.gantt.config.LayoutGroup');jQuery.sap.require('jquery.sap.global');sap.ui.define("sap/gantt/config/LayoutGroup",['jquery.sap.global','./ToolbarGroup'],function(q,T){"use strict";var L=T.extend("sap.gantt.config.LayoutGroup",{metadata:{properties:{enableRichStyle:{type:"boolean",defaultValue:true}}}});return L;},true);};if(!jQuery.sap.isDeclared('sap.gantt.config.ModeGroup')){jQuery.sap.declare('sap.gantt.config.ModeGroup');jQuery.sap.require('jquery.sap.global');sap.ui.define("sap/gantt/config/ModeGroup",['jquery.sap.global','./ToolbarGroup'],function(q,T){"use strict";var M=T.extend("sap.gantt.config.ModeGroup",{metadata:{properties:{modeKeys:{type:"array",defaultValue:[]}}}});return M;},true);};if(!jQuery.sap.isDeclared('sap.gantt.config.SettingItem')){jQuery.sap.declare('sap.gantt.config.SettingItem');jQuery.sap.require('sap.ui.core.Element');sap.ui.define("sap/gantt/config/SettingItem",["sap/ui/core/Element","./ToolbarGroup"],function(E,T){"use strict";var S=E.extend("sap.gantt.config.SettingItem",{library:"sap.gantt",metadata:{properties:{checked:{type:"boolean",defaultValue:false},key:{type:"string",defaultValue:null},displayText:{type:"string",defaultValue:null}}}});return S;},true);};if(!jQuery.sap.isDeclared('sap.gantt.config.TimeHorizon')){jQuery.sap.declare('sap.gantt.config.TimeHorizon');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.Element');sap.ui.define("sap/gantt/config/TimeHorizon",['jquery.sap.global','sap/ui/core/Element',"sap/gantt/misc/Format"],function(q,E,F){"use strict";var T=E.extend("sap.gantt.config.TimeHorizon",{metadata:{library:"sap.gantt",properties:{startTime:{type:"string",group:"Misc",defaultValue:undefined},endTime:{type:"string",group:"Misc",defaultValue:undefined}}}});T.prototype.setStartTime=function(s){this.setProperty("startTime",this._convertTimestamp(s));};T.prototype.setEndTime=function(e){this.setProperty("endTime",this._convertTimestamp(e));};T.prototype._convertTimestamp=function(t){var r=t;if(r&&typeof r==="object"){r=F.dateToAbapTimestamp(r);}return r;};return T;},true);};if(!jQuery.sap.isDeclared('sap.gantt.control.Toolbar')){jQuery.sap.declare('sap.gantt.control.Toolbar');jQuery.sap.require('sap.ui.core.Control');jQuery.sap.require('sap.ui.core.Core');jQuery.sap.require('sap.m.OverflowToolbar');jQuery.sap.require('sap.m.OverflowToolbarLayoutData');jQuery.sap.require('sap.m.OverflowToolbarPriority');jQuery.sap.require('sap.m.ToolbarSpacer');jQuery.sap.require('sap.m.FlexBox');jQuery.sap.require('sap.m.FlexDirection');jQuery.sap.require('sap.m.FlexJustifyContent');jQuery.sap.require('sap.m.Button');jQuery.sap.require('sap.m.ButtonType');jQuery.sap.require('sap.m.SegmentedButton');jQuery.sap.require('sap.m.Select');jQuery.sap.require('sap.ui.core.Item');jQuery.sap.require('sap.m.ViewSettingsDialog');jQuery.sap.require('sap.m.ViewSettingsCustomTab');jQuery.sap.require('sap.m.PlacementType');jQuery.sap.require('sap.m.CheckBox');jQuery.sap.require('sap.ui.core.Orientation');jQuery.sap.require('sap.m.Slider');jQuery.sap.require('sap.m.Popover');sap.ui.define("sap/gantt/control/Toolbar",["sap/ui/core/Control","sap/ui/core/Core","sap/m/OverflowToolbar","sap/m/OverflowToolbarLayoutData","sap/m/OverflowToolbarPriority","sap/m/ToolbarSpacer","sap/m/FlexBox","sap/m/FlexDirection","sap/m/FlexJustifyContent","sap/m/Button","sap/m/ButtonType","sap/m/SegmentedButton","sap/m/Select","sap/ui/core/Item","sap/m/ViewSettingsDialog","sap/m/ViewSettingsCustomTab","sap/m/PlacementType","sap/m/CheckBox","sap/ui/core/Orientation","./AssociateContainer","sap/gantt/legend/LegendContainer","sap/gantt/misc/Utility","sap/m/Slider","sap/m/Popover"],function(C,a,O,b,c,T,F,d,e,B,f,S,g,h,V,k,P,l,n,A,L,U,o,p){"use strict";var q=C.extend("sap.gantt.control.Toolbar",{metadata:{properties:{width:{type:"CSSSize",defaultValue:"100%"},height:{type:"CSSSize",defaultValue:"100%"},type:{type:"string",defaultValue:sap.gantt.control.ToolbarType.Global},sourceId:{type:"string"},zoomRate:{type:"float"},zoomInfo:{type:"object"},sliderStep:{type:"int"},enableTimeScrollSync:{type:"boolean",defaultValue:true},enableRowScrollSync:{type:"boolean",defaultValue:false},enableCursorLine:{type:"boolean",defaultValue:true},enableNowLine:{type:"boolean",defaultValue:true},enableVerticalLine:{type:"boolean",defaultValue:true},modes:{type:"array",defaultValue:[sap.gantt.config.DEFAULT_MODE]},mode:{type:"string",defaultValue:sap.gantt.config.DEFAULT_MODE_KEY},toolbarSchemes:{type:"array",defaultValue:[sap.gantt.config.DEFAULT_CONTAINER_TOOLBAR_SCHEME,sap.gantt.config.DEFAULT_GANTTCHART_TOOLBAR_SCHEME,sap.gantt.config.EMPTY_TOOLBAR_SCHEME]},hierarchies:{type:"array",defaultValue:[sap.gantt.config.DEFAULT_HIERARCHY]},containerLayouts:{type:"array",defaultValue:[sap.gantt.config.DEFAULT_CONTAINER_SINGLE_LAYOUT,sap.gantt.config.DEFAULT_CONTAINER_DUAL_LAYOUT]}},aggregations:{legend:{type:"sap.ui.core.Control",multiple:false,visibility:"public"},customToolbarItems:{type:"sap.ui.core.Control",multiple:true,visibility:"public",singularName:"customToolbarItem"},_toolbar:{type:"sap.m.OverflowToolbar",multiple:false,visibility:"hidden"}},events:{sourceChange:{parameters:{id:{type:"string"}}},layoutChange:{parameters:{id:{type:"string"},value:{type:"string"}}},expandChartChange:{parameters:{action:{type:"string"},expandedChartSchemes:{type:"[]"}}},expandTreeChange:{parameters:{action:{type:"string"}}},zoomRateChange:{parameters:{zoomRate:{type:"float"}}},settingsChange:{parameters:{id:{type:"string"},value:{type:"boolean"}}},modeChange:{parameters:{mode:{type:"string"}}}}}});q.ToolbarItemPosition={Left:"Left",Right:"Right"};q.prototype.init=function(){this._oToolbar=new O({width:"auto",design:sap.m.ToolbarDesign.Auto});this.setAggregation("_toolbar",this._oToolbar,true);this._initCustomToolbarInfo();this._oModesConfigMap={};this._oModesConfigMap[sap.gantt.config.DEFAULT_MODE_KEY]=sap.gantt.config.DEFAULT_MODE;this._oToolbarSchemeConfigMap={};this._oToolbarSchemeConfigMap[sap.gantt.config.DEFAULT_CONTAINER_TOOLBAR_SCHEME_KEY]=sap.gantt.config.DEFAULT_CONTAINER_TOOLBAR_SCHEME;this._oToolbarSchemeConfigMap[sap.gantt.config.DEFAULT_GANTTCHART_TOOLBAR_SCHEME_KEY]=sap.gantt.config.DEFAULT_GANTTCHART_TOOLBAR_SCHEME;this._oToolbarSchemeConfigMap[sap.gantt.config.EMPTY_TOOLBAR_SCHEME_KEY]=sap.gantt.config.EMPTY_TOOLBAR_SCHEME;this._oHierarchyConfigMap={};this._oHierarchyConfigMap[sap.gantt.config.DEFAULT_HIERARCHY_KEY]=sap.gantt.config.DEFAULT_HIERARCHY;this._oContainerLayoutConfigMap={};this._oContainerLayoutConfigMap[sap.gantt.config.DEFAULT_CONTAINER_SINGLE_LAYOUT_KEY]=sap.gantt.config.DEFAULT_CONTAINER_SINGLE_LAYOUT;this._oContainerLayoutConfigMap[sap.gantt.config.DEFAULT_CONTAINER_DUAL_LAYOUT_KEY]=sap.gantt.config.DEFAULT_CONTAINER_DUAL_LAYOUT;this._oZoomSlider=null;this._iLastChartWidth=-1;this._iCustomItemInsertIndex=-1;this._aCustomItems=[];this._iLiveChangeTimer=-1;this._aTimers=[];this._oRb=sap.ui.getCore().getLibraryResourceBundle("sap.gantt");};q.prototype._initCustomToolbarInfo=function(){this._oItemConfiguration={Left:[],Right:[]};this._oAllCustomItems={Left:[],Right:[]};this._iCustomItemInsertIndex=-1;this._aCustomItems=[];};q.prototype.applySettings=function(s,i){if(this.getSourceId()&&this.getType()){this._resetAllCompositeControls();}var r=C.prototype.applySettings.apply(this,arguments);return r;};q.prototype.setLegend=function(i){this.setAggregation("legend",i);if(!this._oLegendPop){this._oLegendPop=new p({placement:P.Bottom,showArrow:false,showHeader:false});}if(i){this._oLegendPop.removeAllContent();this._oLegendPop.addContent(i);var j;if(a.getConfiguration().getRTL()===true){j=100;}else{var m=sap.ui.getCore().byId(i.getContent());j=100-parseInt(m.getWidth(),10);}this._oLegendPop.setOffsetX(j);}};q.prototype.setZoomInfo=function(z){if(z&&z.iChartWidth>0&&this._oZoomSlider){var m=z.determinedByChartWidth.fMinRate>z.determinedByConfig.fMinRate?z.determinedByChartWidth.fMinRate:z.determinedByConfig.fMinRate,M=z.determinedByConfig.fMaxRate,s=z.determinedByChartWidth.fSuitableRate?z.determinedByChartWidth.fSuitableRate:z.determinedByConfig.fRate;var i=s,Z=this._oZoomSlider,j=this._iLastChartWidth;Z.setMin(Math.log(m));Z.setMax(Math.log(M));var r=this.getProperty("zoomRate");if(r&&r>0){i=r;}else{if(j===-1){i=s;}else if(j!==z.iChartWidth){i=m;}i=Math.max(i,Z.getMin());i=Math.min(i,Z.getMax());this.setProperty("zoomRate",i);}this.setProperty("zoomInfo",z);Z.setValue(Math.log(i));Z.setStep((Z.getMax()-Z.getMin())/this.getSliderStep());this.fireZoomRateChange({zoomRate:i});this._iLastChartWidth=z.iChartWidth;}return this;};q.prototype.setMode=function(m){this.setProperty("mode",m);if(this._oModeSegmentButton){this._oModeSegmentButton.setSelectedButton(this._oModeButtonMap[m]);}return this;};q.prototype.setHierarchies=function(H){this.setProperty("hierarchies",H);this._oHierarchyConfigMap={};if(H){for(var i=0;i<H.length;i++){this._oHierarchyConfigMap[H[i].getKey()]=H[i];}}this._resetAllCompositeControls();return this;};q.prototype.setContainerLayouts=function(j){this.setProperty("containerLayouts",j);this._oContainerLayoutConfigMap={};if(j){for(var i=0;i<j.length;i++){this._oContainerLayoutConfigMap[j[i].getKey()]=j[i];}}this._resetAllCompositeControls();return this;};q.prototype.setModes=function(m){this.setProperty("modes",m);this._oModesConfigMap={};if(m){for(var i=0;i<m.length;i++){this._oModesConfigMap[m[i].getKey()]=m[i];}}return this;};q.prototype.setToolbarDesign=function(t){this._oToolbar.setDesign(t);return this;};q.prototype.setToolbarSchemes=function(t){this.setProperty("toolbarSchemes",t);this._oToolbarSchemeConfigMap={};if(t){for(var i=0;i<t.length;i++){this._oToolbarSchemeConfigMap[t[i].getKey()]=t[i];}}this._resetAllCompositeControls();return this;};q.prototype.setSourceId=function(s){this.setProperty("sourceId",s);this._resetAllCompositeControls();return this;};q.prototype.setType=function(t){this.setProperty("type",t);this._resetAllCompositeControls();return this;};q.prototype.addCustomToolbarItem=function(i){if(this._iCustomItemInsertIndex==-1){this._oToolbar.insertContent(i,0);this._iCustomItemInsertIndex++;}else{this._oToolbar.insertContent(i,this._iCustomItemInsertIndex+1);this._iCustomItemInsertIndex++;}this._aCustomItems.push(i);return this;};q.prototype.insertCustomToolbarItem=function(i,I){var m=this._aCustomItems.length;if(I>=m){I=m;}if(this._iCustomItemInsertIndex===-1){this._oToolbar.insertContent(i,0);this._aCustomItems.push(i);}else{this._oToolbar.insertContent(i,this._iCustomItemInsertIndex-this._aCustomItems.length+1+I);this._aCustomItems.splice(I,0,i);}this._iCustomItemInsertIndex++;return this;};q.prototype.removeCustomToolbarItem=function(v){if(this._aCustomItems.length===0){return this._aCustomItems;}if((typeof v)==="number"){var i=this._aCustomItems.length;var r=v>i?i:v;this._oToolbar.removeContent(this._iCustomItemInsertIndex-i+r+1);this._iCustomItemInsertIndex--;return this._aCustomItems.splice(r,1);}else if(v){this._oToolbar.removeContent(v);this._iCustomItemInsertIndex--;return this._aCustomItems.splice(jQuery.inArray(v,this._aCustomItems),1);}};q.prototype.removeAllCustomToolbarItems=function(){var r=[];for(var i=0;i<this._aCustomItems.length;i++){r.push(this._oToolbar.removeContent(this._aCustomItems[i]));}this._iCustomItemInsertIndex=this._iCustomItemInsertIndex-this._aCustomItems.length;this._aCustomItems.splice(0,this._aCustomItems.length);return r;};q.prototype._resetAllCompositeControls=function(){this._determineToolbarSchemeConfig(this.getSourceId());this._destroyCompositeControls();if(!this._sToolbarSchemeKey){return;}this._resolvePositions();var i,j,s=q.ToolbarItemPosition.Left,r=q.ToolbarItemPosition.Right;var t=this._oItemConfiguration[s];for(i=0;i<t.length;i++){if(t[i]){this._createCompositeControl(s,i,t[i]);}}var R=this._oItemConfiguration[r];for(i=0;i<R.length;i++){if(R[i]){this._createCompositeControl(r,i,R[i]);}}var u=function(j){if(jQuery.isArray(j)){for(var m=0;m<j.length;m++){this._oToolbar.addContent(j[m]);}}else if(j){this._oToolbar.addContent(j);}};for(i=0;i<this._oAllCustomItems[s].length;i++){j=this._oAllCustomItems[s][i];u.call(this,j);}if(this._oAllCustomItems[s].length!==0||this._oAllCustomItems[r].length!==0){this._oToolbar.addContent(new T());}for(i=this._oAllCustomItems[r].length-1;i>=0;i--){j=this._oAllCustomItems[r][i];u.call(this,j);}var z=this.getProperty("zoomInfo");if(z){this.setZoomInfo(z);}};q.prototype.getAllToolbarItems=function(){return this._oToolbar.getContent();};q.prototype._determineToolbarSchemeConfig=function(s){this._sToolbarSchemeKey=null;if(this.getType()===sap.gantt.control.ToolbarType.Global&&this._oContainerLayoutConfigMap[s]){this._sToolbarSchemeKey=this._oContainerLayoutConfigMap[s].getToolbarSchemeKey();this._sInitMode=this.getMode()!=sap.gantt.config.DEFAULT_MODE_KEY?this.getMode():this._oContainerLayoutConfigMap[s].getActiveModeKey();}else if(this.getType()===sap.gantt.control.ToolbarType.Local&&this._oHierarchyConfigMap[s]){this._sToolbarSchemeKey=this._oHierarchyConfigMap[s].getToolbarSchemeKey();this._sInitMode=this.getMode()!=sap.gantt.config.DEFAULT_MODE_KEY?this.getMode():this._oHierarchyConfigMap[s].getActiveModeKey();}this._oToolbarScheme=this._oToolbarSchemeConfigMap[this._sToolbarSchemeKey];if(this._oToolbarScheme&&this._oToolbarScheme.getProperty("toolbarDesign")){this.setToolbarDesign(this._oToolbarScheme.getProperty("toolbarDesign"));}};q.prototype._destroyCompositeControls=function(){this._oToolbar.removeAllContent();this._initCustomToolbarInfo();};q.prototype._resolvePositions=function(){if(this._oToolbarScheme){jQuery.each(this._oToolbarScheme.getMetadata().getAllProperties(),function(j){if(j!=="key"&&j!=="toolbarDesign"){var m=this._oToolbarScheme.getProperty(j);if(m){var r=this._parsePosition(m.getPosition());this._oItemConfiguration[r.position][r.idx]=$.extend({},{groupId:j},m);}}}.bind(this));var s=this._oItemConfiguration;var i=Object.keys(s);i.forEach(function(j){var m=s[j],r=[];var t=Object.keys(m).sort();t.forEach(function(u,v){r.push(m[u]);});s[j]=r;});}};q.prototype._parsePosition=function(s){return{position:s.toUpperCase().substr(0,1)==="L"?q.ToolbarItemPosition.Left:q.ToolbarItemPosition.Right,idx:parseInt(s.substr(1,s.length-1),10)};};q.prototype._createCompositeControl=function(s,i,G){var v;switch(G.groupId){case"sourceSelect":v=this._genSourceSelectGroup(G);break;case"layout":v=this._genLayoutGroup(G);break;case"expandChart":v=this._genExpandChartGroup(G);break;case"expandTree":v=this._genExpandTreeGroup(G);break;case"customToolbarItems":v=this._genCustomToolbarItemGroup(s,G);break;case"mode":v=this._genModeButtonGroup(G);break;case"timeZoom":v=this._genZoomSliderGroupControls(G);break;case"legend":v=this._genLegend(G);break;case"settings":v=this._genSettings(G);break;default:break;}if(v){this._oAllCustomItems[s]=this._oAllCustomItems[s].concat(v);}};q.prototype._genSourceSelectGroup=function(G){var s=this.getSourceId();var t=this;var i;this._oSourceSelectBox=new g({layoutData:new b({priority:G.getOverflowPriority()}),width:"200px",change:function(E){var m=E.getParameter("selectedItem");var r=m.oSourceConfig;t.fireSourceChange({id:m.getKey(),config:r});}});switch(this.getType()){case sap.gantt.control.ToolbarType.Global:i=this.getContainerLayouts();this._oSourceSelectBox.setTooltip(this._oRb.getText("TLTP_GLOBAL_HIERARCHY_RESOURCES"));break;case sap.gantt.control.ToolbarType.Local:i=this.getHierarchies();this._oSourceSelectBox.setTooltip(this._oRb.getText("TLTP_LOCAL_HIERARCHY_RESOURCES"));break;default:return null;}var j;for(var I=0;I<i.length;I++){j=new h({key:i[I].getKey(),text:i[I].getText()});j.oSourceConfig=i[I];this._oSourceSelectBox.addItem(j);if(j.getKey()===s){this._oSourceSelectBox.setSelectedItem(j);}}return this._oSourceSelectBox;};q.prototype._genLayoutGroup=function(G){if(this.getType==="LOCAL"){return null;}var t=this,H=this.getHierarchies(),j,i;this._oAddGanttChartSelect=new g({icon:"sap-icon://add",type:sap.m.SelectType.IconOnly,autoAdjustWidth:true,tooltip:this._oRb.getText("TLTP_ADD_GANTTCHART"),forceSelection:false,layoutData:new b({priority:G.getOverflowPriority()}),change:function(E){if(E.getParameter("selectedItem")){t.fireLayoutChange({id:"add",value:{hierarchyKey:E.getParameter("selectedItem").getKey(),hierarchyConfig:E.getParameter("selectedItem").data("hierarchyConfig")}});E.getSource().setSelectedItemId("");}}});if(H&&H.length>0){for(i=0;i<H.length;i++){j=new h({text:H[i].getText(),key:H[i].getKey()});j.data("hierarchyConfig",H[i]);this._oAddGanttChartSelect.addItem(j);}}this._oLessGanttChartSelect=new g({icon:"sap-icon://less",type:sap.m.SelectType.IconOnly,tooltip:this._oRb.getText("TLTP_REMOVE_GANTTCHART"),autoAdjustWidth:true,forceSelection:false,layoutData:new b({priority:G.getOverflowPriority()}),change:function(E){if(E.getParameter("selectedItem")){t.fireLayoutChange({id:"less",value:{hierarchyKey:E.getParameter("selectedItem").getKey(),hierarchyConfig:E.getParameter("selectedItem").data("hierarchyConfig"),ganttChartIndex:E.getParameter("selectedItem").data("ganttChartIndex")}});}}});this._oLessGanttChartSelect.addEventDelegate({onclick:this._fillLessGanttChartSelectItem},this);var I=this._oContainerLayoutConfigMap[this.getSourceId()].getOrientation()===n.Vertical?"sap-icon://resize-vertical":"sap-icon://resize-horizontal";this._oVHButton=new B({icon:I,tooltip:this._oRb.getText("TLTP_SWITCH_GANTTCHART"),type:G.getEnableRichStyle()?f.Emphasized:f.Default,layoutData:new b({priority:G.getOverflowPriority()}),press:function(E){switch(this.getIcon()){case"sap-icon://resize-vertical":this.setIcon("sap-icon://resize-horizontal");t.fireLayoutChange({id:"orientation",value:n.Horizontal});break;case"sap-icon://resize-horizontal":this.setIcon("sap-icon://resize-vertical");t.fireLayoutChange({id:"orientation",value:n.Vertical});break;default:break;}}});this._oLayoutButton=[this._oAddGanttChartSelect,this._oLessGanttChartSelect,this._oVHButton];return this._oLayoutButton;};q.prototype._fillLessGanttChartSelectItem=function(){var G=this.data("holder").getGanttCharts(),I;this._oLessGanttChartSelect.removeAllItems();if(G&&G.length>0){for(var i=0;i<G.length;i++){I=new h({text:this._oHierarchyConfigMap[G[i].getHierarchyKey()].getText(),key:G[i].getHierarchyKey()});I.data("hierarchyConfig",this._oHierarchyConfigMap[G[i].getHierarchyKey()]);I.data("ganttChartIndex",i);this._oLessGanttChartSelect.insertItem(I,i);}}};q.prototype._genExpandChartGroup=function(G){this._aChartExpandButtons=[];var j=function(s){this.fireExpandChartChange({isExpand:s.getSource().data("isExpand"),expandedChartSchemes:s.getSource().data("chartSchemeKeys")});};var E=G.getExpandCharts(),m;for(var i=0;i<E.length;i++){var r=E[i];m=new B({icon:r.getIcon(),tooltip:r.getTooltip(),layoutData:new b({priority:G.getOverflowPriority()}),press:j.bind(this),type:G.getEnableRichType()&&r.getIsExpand()?f.Emphasized:f.Default,customData:[new sap.ui.core.CustomData({key:"isExpand",value:r.getIsExpand()}),new sap.ui.core.CustomData({key:"chartSchemeKeys",value:r.getChartSchemeKeys()})]});if(G.getShowArrowText()){m.setText(r.getIsExpand()?"":"");}this._aChartExpandButtons.push(m);}return this._aChartExpandButtons;};q.prototype._genCustomToolbarItemGroup=function(s,G){if(this._iCustomItemInsertIndex===-1){var t=this._oAllCustomItems[s].length;if(t===0){this._iCustomItemInsertIndex=-1;}else{this._iCustomItemInsertIndex=t-1;}}return this._aCustomItems;};q.prototype._genExpandTreeGroup=function(G){var t=this;this._oTreeGroup=[new B({icon:"sap-icon://expand",tooltip:this._oRb.getText("TLTP_EXPAND"),layoutData:new b({priority:G.getOverflowPriority()}),press:function(E){t.fireExpandTreeChange({action:"expand"});}}),new B({icon:"sap-icon://collapse",tooltip:this._oRb.getText("TLTP_COLLAPSE"),layoutData:new b({priority:G.getOverflowPriority()}),press:function(E){t.fireExpandTreeChange({action:"collapse"});}})];return this._oTreeGroup;};q.prototype._genModeButtonGroup=function(G){var m=function(E){var s=E.getParameter("button");this.fireModeChange({mode:s.data("mode")});};this._oModeSegmentButton=new S({select:m.bind(this)});this._oModeButtonMap={};var j=function(i,M){if(this._oModesConfigMap[M]){var r=new B({icon:this._oModesConfigMap[M].getIcon(),activeIcon:this._oModesConfigMap[M].getActiveIcon(),tooltip:this._oModesConfigMap[M].getText(),layoutData:new b({priority:G.getOverflowPriority()}),customData:[new sap.ui.core.CustomData({key:"mode",value:M})]});this._oModeButtonMap[M]=r;this._oModeSegmentButton.addButton(r);}};jQuery.each(G.getModeKeys(),j.bind(this));if(this._sInitMode){this._oModeSegmentButton.setSelectedButton(this._oModeButtonMap[this._sInitMode]);}return this._oModeSegmentButton;};q.prototype._genZoomSliderGroupControls=function(G){var i=new b({priority:G.getOverflowPriority()});var j=function(t){return Math.pow(Math.E,t);};var m=function(t){jQuery.sap.clearDelayedCall(this._iLiveChangeTimer);this._iLiveChangeTimer=-1;var u=this.getZoomRate();this.setProperty("zoomRate",t);if(t===u){return;}this.fireZoomRateChange({zoomRate:t});jQuery.sap.log.debug("Toolbar Zoom Rate was changed, zoomRate is: "+t);};var z=new o({width:"200px",layoutData:i,liveChange:function(E){var t=j(E.getSource().getValue());jQuery.sap.clearDelayedCall(this._iLiveChangeTimer);this._iLiveChangeTimer=jQuery.sap.delayedCall(200,this,m,[t]);}.bind(this)});var Z=function(t){return function(E){var u=0.0,v=0.0;if(t){v=this._oZoomSlider.stepUp(1).getValue();}else{v=this._oZoomSlider.stepDown(1).getValue();}u=j(v);this._oZoomSlider.setValue(Math.log(u));this._iLiveChangeTimer=jQuery.sap.delayedCall(200,this,m,[u]);};};var r=new sap.m.Button({icon:"sap-icon://zoom-in",tooltip:this._oRb.getText("TLTP_SLIDER_ZOOM_IN"),layoutData:i.clone(),press:Z(true).bind(this)});var s=new B({icon:"sap-icon://zoom-out",tooltip:this._oRb.getText("TLTP_SLIDER_ZOOM_OUT"),layoutData:i.clone(),press:Z(false).bind(this)});this._oZoomSlider=z;return[r,z,s];};q.prototype._genLegend=function(G){if(!this._oLegendPop){this._oLegendPop=new p({placement:P.Bottom,showArrow:false,showHeader:false});}if(this.getLegend()){this._oLegendPop.removeAllContent();this._oLegendPop.addContent(this.getLegend());}this._oLegendButton=new B({icon:"sap-icon://legend",tooltip:this._oRb.getText("TLTP_SHOW_LEGEND"),layoutData:new b({priority:G.getOverflowPriority()}),press:function(E){var i=this._oLegendPop;if(i.isOpen()){i.close();}else{i.openBy(this._oLegendButton);}}.bind(this)});return this._oLegendButton;};q.prototype._genSettings=function(G){var s=G.getItems()||[];var t=this;var j=s.map(function(i){return new l({name:i.getKey(),text:i.getDisplayText(),tooltip:i.getTooltip(),selected:i.getChecked()}).addStyleClass("sapUiSettingBoxItem");});this._aOldSettingState=j.map(function(i){return i.getSelected();});this._setSettingItemStates(j);this._oSettingsBox=new F({direction:d.Column,items:j}).addStyleClass("sapUiSettingBox");this._oSettingsDialog=new V({title:this._oRb.getText("SETTINGS_DIALOG_TITLE"),customTabs:[new k({content:this._oSettingsBox})],confirm:function(){var m=this._oSettingsBox.getItems();var r=[];for(var i=0;i<m.length;i++){r.push({id:m[i].getName(),value:m[i].getSelected()});t._aOldSettingState[i]=m[i].getSelected();}t.aCustomSettingItems=t._getCustomSettingItems(m);this.fireSettingsChange(r);}.bind(this),cancel:function(){t._setSettingItemStates(j);t._restoreCustomOldStates(j);}});this._oSettingsButton=new B({icon:"sap-icon://action-settings",tooltip:this._oRb.getText("TLTP_CHANGE_SETTINGS"),layoutData:new b({priority:G.getOverflowPriority()}),press:function(E){this._oSettingsDialog.open();}.bind(this)});return this._oSettingsButton;};q.prototype._setSettingItemStates=function(j){for(var i=0;i<j.length;i++){switch(j[i].getName()){case sap.gantt.config.SETTING_ITEM_ENABLE_NOW_LINE_KEY:j[i].setSelected(this.getEnableNowLine());break;case sap.gantt.config.SETTING_ITEM_ENABLE_CURSOR_LINE_KEY:j[i].setSelected(this.getEnableCursorLine());break;case sap.gantt.config.SETTING_ITEM_ENABLE_VERTICAL_LINE_KEY:j[i].setSelected(this.getEnableVerticalLine());break;case sap.gantt.config.SETTING_ITEM_ENABLE_TIME_SCROLL_SYNC_KEY:j[i].setSelected(this.getEnableTimeScrollSync());break;case sap.gantt.config.SETTING_ITEM_ROW_SCROLL_SYNC_KEY:j[i].setSelected(this.getEnableRowScrollSync());break;default:this._handleCustomSettingItemStates(j[i]);break;}}};q.prototype._handleCustomSettingItemStates=function(s){if(this.aCustomSettingItems&&this.aCustomSettingItems.length>0){for(var j=0;j<this.aCustomSettingItems.length;j++){if(s.getName()===this.aCustomSettingItems[j].getName()){s.setSelected(this.aCustomSettingItems[j].getSelected());break;}}}};q.prototype._restoreCustomOldStates=function(j){var s=sap.gantt.config.DEFAULT_TOOLBAR_SETTING_ITEMS.length;for(var i=s;i<j.length;i++){j[i].setSelected(this._aOldSettingState[i]);}};q.prototype._getCustomSettingItems=function(s){var j=[];var m=sap.gantt.config.DEFAULT_TOOLBAR_SETTING_ITEMS.length;for(var i=m;i<s.length;i++){j.push(s[i]);}return j;};q.prototype.getToolbarSchemeKey=function(){return this._sToolbarSchemeKey;};q.prototype.setEnableNowLine=function(E){this.setProperty("enableNowLine",E);if(this._oSettingsBox&&this._oSettingsBox.getItems().length>0){this._setSettingItemProperties(sap.gantt.config.SETTING_ITEM_ENABLE_NOW_LINE_KEY,E);}return this;};q.prototype.setEnableCursorLine=function(E){this.setProperty("enableCursorLine",E);if(this._oSettingsBox&&this._oSettingsBox.getItems().length>0){this._setSettingItemProperties(sap.gantt.config.SETTING_ITEM_ENABLE_CURSOR_LINE_KEY,E);}return this;};q.prototype.setEnableVerticalLine=function(E){this.setProperty("enableVerticalLine",E);if(this._oSettingsBox&&this._oSettingsBox.getItems().length>0){this._setSettingItemProperties(sap.gantt.config.SETTING_ITEM_ENABLE_VERTICAL_LINE_KEY,E);}return this;};q.prototype.setEnableRowScrollSync=function(E){this.setProperty("enableRowScrollSync",E);if(this._oSettingsBox&&this._oSettingsBox.getItems().length>0){this._setSettingItemProperties(sap.gantt.config.SETTING_ITEM_ROW_SCROLL_SYNC_KEY,E);}return this;};q.prototype.setEnableTimeScrollSync=function(E){this.setProperty("enableTimeScrollSync",E);if(this._oSettingsBox&&this._oSettingsBox.getItems().length>0){this._setSettingItemProperties(sap.gantt.config.SETTING_ITEM_ENABLE_TIME_SCROLL_SYNC_KEY,E);}return this;};q.prototype._setSettingItemProperties=function(s,j){var m=this._oSettingsBox.getItems();for(var i=0;i<m.length;i++){if(m[i].getName()===s){m[i].setSelected(j);break;}}};q.prototype.exit=function(){if(this._oLegendPop){this._oLegendPop.destroy(false);}if(this._oSettingsPop){this._oSettingsPop.destroy(false);}};return q;},true);};if(!jQuery.sap.isDeclared('sap.gantt.def.cal.Calendar')){jQuery.sap.declare('sap.gantt.def.cal.Calendar');sap.ui.define("sap/gantt/def/cal/Calendar",["../DefBase","sap/gantt/misc/Format"],function(D,F){"use strict";var C=D.extend("sap.gantt.def.cal.Calendar",{metadata:{properties:{key:{type:"string",defaultValue:"calendar"},backgroundColor:{type:"sap.gantt.ValueSVGPaintServer",defaultValue:"#e5e5e5"}},aggregations:{timeIntervals:{type:"sap.gantt.def.cal.TimeInterval",multiple:true,singularName:"timeInterval",bindable:"bindable"}}}});C.prototype.getDefNode=function(){var t=this.getTimeIntervals();var s=(this.getParent()&&this.getParent().getParent())?this.getParent().getParent()._oStatusSet:null;var v=s?s.aViewBoundary:null;var T=s?s.aTimeBoundary:null;var f=t;if(T&&s){f=t.filter(function(o){var a=F.abapTimestampToDate(o.getStartTime());var e=F.abapTimestampToDate(o.getEndTime());if(s.bRTL===true){return(e<T[0]&&e>T[1])||(a>T[1]&&a<T[0]);}else{return(e<T[1]&&e>T[0])||(a>T[0]&&a<T[1]);}});}var w=(v&&v.length>1)?(v[1]-v[0]):1;var p={id:this.generateRefId(),x:0,y:0,width:w,timeIntervals:[]};for(var i=0;i<f.length;i++){var I=f[i].getDefNode();I.fill=this.getBackgroundColor();p.timeIntervals.push(I);}return p;};C.prototype.generateRefId=function(){var i=(this.getParent()&&this.getParent().getParent())?this.getParent().getParent().getId():"";return i+"_"+this.getKey();};return C;},true);};if(!jQuery.sap.isDeclared('sap.gantt.def.cal.TimeInterval')){jQuery.sap.declare('sap.gantt.def.cal.TimeInterval');jQuery.sap.require('sap.ui.core.Core');sap.ui.define("sap/gantt/def/cal/TimeInterval",["../DefBase","sap/gantt/misc/Format","sap/ui/core/Core"],function(D,F,C){"use strict";var T=D.extend("sap.gantt.def.cal.TimeInterval",{metadata:{properties:{startTime:{type:"string",group:"Misc",defaultValue:null},endTime:{type:"string",group:"Misc",defaultValue:null}}}});T.prototype.setStartTime=function(s){this.setProperty("startTime",this._convertTimestamp(s));};T.prototype.setEndTime=function(e){this.setProperty("endTime",this._convertTimestamp(e));};T.prototype._convertTimestamp=function(t){var r=t;if(r&&typeof r==="object"){r=F.dateToAbapTimestamp(r);}return r;};T.prototype.getDefNode=function(){var a=(this.getParent()&&this.getParent().getParent()&&this.getParent().getParent().getParent())?this.getParent().getParent().getParent().getAxisTime():null;var s;var w;if(a){if(C.getConfiguration().getRTL()===true){s=a.timeToView(F.abapTimestampToDate(this.getEndTime()));w=a.timeToView(F.abapTimestampToDate(this.getStartTime()))-s;}else{s=a.timeToView(F.abapTimestampToDate(this.getStartTime()));w=a.timeToView(F.abapTimestampToDate(this.getEndTime()))-s;}}return{x:s,y:0,width:w};};return T;},true);};if(!jQuery.sap.isDeclared('sap.gantt.def.pattern.BackSlashPattern')){jQuery.sap.declare('sap.gantt.def.pattern.BackSlashPattern');sap.ui.define("sap/gantt/def/pattern/BackSlashPattern",["./PatternBase"],function(P){"use strict";var B=P.extend("sap.gantt.def.pattern.BackSlashPattern",{metadata:{properties:{path:{type:"string"},stroke:{type:"sap.gantt.ValueSVGPaintServer"},strokeWidth:{type:"int",defaultValue:2}}}});B.prototype.getPath=function(){var t=this.getTileWidth();var a=this.getTileHeight();var s="";s=s.concat("M").concat(t/4).concat(",").concat(a/4*5).concat(" ");s=s.concat("l-").concat(t/2).concat(",-").concat(a/2).concat(" ");s=s.concat("M0,0").concat(" ");s=s.concat("l").concat(t).concat(",").concat(a).concat(" ");s=s.concat("M").concat(t/4*5).concat(",").concat(a/4).concat(" ");s=s.concat("l-").concat(t/2).concat(",-").concat(a/2).concat(" ");return s;};B.prototype.getDefString=function(){return"<pattern class='pattern' id='"+this.getId()+"' patternUnits='userSpaceOnUse' x='0' y='0' width='"+this.getTileWidth()+"' height='"+this.getTileHeight()+"'><rect x='0' width='"+this.getTileWidth()+"' height='"+(this.getTileHeight()+4)+"' stroke-width='"+this.getStrokeWidth()+"' fill='"+this.getBackgroundColor()+"' fill-opacity='"+this.getBackgroundFillOpacity()+"'></rect><path d='"+this.getPath()+"' stroke='"+this.getStroke()+"' stroke-width='"+this.getStrokeWidth()+"'></path></pattern>";};return B;},true);};if(!jQuery.sap.isDeclared('sap.gantt.drawer.CalendarPattern')){jQuery.sap.declare('sap.gantt.drawer.CalendarPattern');jQuery.sap.require('sap.ui.core.Core');jQuery.sap.require('sap.ui.core.format.DateFormat');jQuery.sap.require('sap.ui.thirdparty.d3');sap.ui.define("sap/gantt/drawer/CalendarPattern",["sap/ui/core/Core","sap/gantt/misc/Format","sap/ui/core/format/DateFormat","sap/gantt/drawer/Drawer","sap/ui/thirdparty/d3"],function(C,F,D,a){"use strict";var b=a.extend("sap.gantt.drawer.CalendarPattern");b.prototype.drawSvg=function(s,p,P,S,B){this._oStatusSet=S;if(P&&P.getDefNode()&&P.getDefNode().defNodes){var c=P.getDefNode();var e=p+"-calendardefs";if(!(d3.select("#"+e).empty())){jQuery("#"+e).remove();}var w=this._oStatusSet.aViewBoundary[1]-this._oStatusSet.aViewBoundary[0];if(w<0){w=this._oStatusSet.aViewBoundary[0]-this._oStatusSet.aViewBoundary[1];}var f={height:B,width:w};var g=s.select("#"+e);if(g.empty()){g=s.insert("defs",":first-child").attr("id",e);}var h=g.selectAll(".calendarPattern").data(c.defNodes);h.enter().append("pattern").attr("class","calendarPattern").attr("id",function(d){return d.id;}).attr("patternUnits","userSpaceOnUse").attr("x",0).attr("y",0).attr("width",f.width).attr("height",f.height);h.exit().remove();var i=h.selectAll("rect").data(function(){return this.parentNode.__data__.timeIntervals;});i.enter().append("rect");i.attr("x",function(d){return d.x;}).attr("y",function(d){return d.y;}).attr("width",function(d){return d.width;}).attr("height",f.height).attr("fill",function(d){return d.fill;});i.exit().remove();}};return b;},true);};if(!jQuery.sap.isDeclared('sap.gantt.drawer.CursorLine')){jQuery.sap.declare('sap.gantt.drawer.CursorLine');jQuery.sap.require('sap.ui.core.Core');jQuery.sap.require('sap.ui.Device');jQuery.sap.require('sap.ui.core.format.DateFormat');jQuery.sap.require('sap.ui.thirdparty.d3');sap.ui.define("sap/gantt/drawer/CursorLine",["sap/ui/core/Core","sap/ui/Device","sap/gantt/misc/Format","sap/ui/core/format/DateFormat","sap/gantt/drawer/Drawer","sap/ui/thirdparty/d3"],function(C,D,F,a,b){"use strict";var c=b.extend("sap.gantt.drawer.CursorLine");c.prototype.drawSvg=function(s,S,l,o){this._oLocale=l;var i=jQuery('#'+o.svgId).offset().left;var A=[];s.each(function(d,e){var f=jQuery(this),g=f.offset();A.push({x:o.x+i-g.left,y:o.y,svgId:f.attr("id"),svgHeight:f.height()});});var t=this;S.each(function(d,e){var h=t._createHeaderTopG(d3.select(this));t._drawHeaderLabel(h,A[e]);});s.each(function(d,e){var B=t._createBodyTopG(d3.select(this));t._drawCursorLine(B,A[e]);});};c.prototype._createBodyTopG=function(s){var B=s.selectAll(".cursorline-top").data(function(){return[{svgHeight:jQuery(this.parentNode).height()}];});B.enter().append("g").classed("cursorline-top",true);B.exit().remove();return B;};c.prototype._drawCursorLine=function(g,s){var p=g.selectAll("path").data(function(d){return[{svgHeight:d.svgHeight,x:s.x,y:s.y}];});p.enter().append("path").classed("sapGanttCursorLineBody",true);p.attr("d",function(d){return"M"+d.x+",0v"+d.svgHeight+"h1h-1";});p.exit().remove();};c.prototype._createHeaderTopG=function(s){var h=s.selectAll(".cursorline-header-top").data(function(){return[{svgHeight:jQuery(this.parentNode).height()}];});h.enter().append("g").classed("cursorline-header-top",true);h.exit().remove();return h;};c.prototype._drawHeaderLabel=function(g,s){var t=this;var A=this._getAxisTime(s.svgId);var r=g.selectAll("rect").data(function(d){return[{svgHeight:d.svgHeight,svgId:d.svgId,x:s.x,y:s.y}];});r.enter().append("rect").classed("sapGanttCursorLineHeader",true);r.attr("width",function(d){return 64;}).attr("height",function(d){return d.svgHeight>80?30:25;}).attr("x",function(d){return d.x-parseFloat(r.attr('width'))/2;}).attr("y",function(d){return d.svgHeight-parseFloat(r.attr('height'))-5;});r.exit().remove();var T=g.selectAll("text").data(function(d){return[{x:parseFloat(r.attr('x'))+parseFloat(r.attr('width')/2),y:parseFloat(r.attr('y'))+parseFloat(r.attr('height')/2)}];});T.enter().append("text").classed("sapGanttCursorLineLabel",true);T.attr("x",function(d){return d.x;}).attr("y",function(d){return d.y;}).text(function(d){return t._getTimeLabel(F.dateToAbapTimestamp(A.viewToTime(d.x)),t._oLocale,A);});if(D.browser.msie){T.attr("dy",".35em");}T.exit().remove();};c.prototype.destroySvg=function(s,S){s.selectAll(".cursorline-top").remove();S.selectAll(".cursorline-header-top").remove();};c.prototype._getAxisTime=function(e){var $=jQuery("#"+e);var A=null;if($&&$.control()){A=$.control()[0].getAxisTime();}return A;};c.prototype._getTimeLabel=function(t,l,A){var L=F._convertUTCToLocalTime(t,l);var d=(sap.ui.getCore().getConfiguration().getLanguage()).toLowerCase();var f=a.getDateTimeInstance({pattern:A.getZoomStrategy()[A.getCurrentTickTimeIntervalKey()].smallInterval.format},new sap.ui.core.Locale(d));return f.format(L);};return c;},true);};if(!jQuery.sap.isDeclared('sap.gantt.drawer.ListLegend')){jQuery.sap.declare('sap.gantt.drawer.ListLegend');jQuery.sap.require('sap.ui.thirdparty.d3');sap.ui.define("sap/gantt/drawer/ListLegend",["sap/gantt/drawer/Drawer","sap/gantt/misc/Utility","sap/gantt/misc/Format","sap/ui/thirdparty/d3"],function(D,U,F){"use strict";var L=D.extend("sap.gantt.drawer.ListLegend");L.prototype._drawPerTag=function(s,S){var l=S.mChartInstance;if(S.getIsDuration()){S.setTime(l.TIME_RANGE[0]);S.setEndTime(l.TIME_RANGE[1]);}else{S.setTime(l.TIME);}S.setRowYCenter(l._getScaledLegendHeight()/2);switch(S.getTag()){case"g":this._drawGroup(s,S);break;case"line":this._drawLine(s,S);break;case"rect":this._drawRect(s,S);break;case"text":this._drawText(s,S);break;case"path":this._drawPath(s,S);break;case"image":this._drawImage(s,S);break;case"polygon":this._drawPolygon(s,S);break;case"polyline":this._drawPolyline(s,S);break;case"circle":this._drawCircle(s,S);break;default:break;}};L.prototype._drawGroup=function(s,S){var g=s.append("g");var a=S.getShapes();if(a&&a.length>0){for(var i=0;i<a.length;i++){this._drawPerTag(g,a[i]);}}};L.prototype._drawLine=function(s,S){s.append("line").attr("x1",S.getX1()).attr("y1",S.getY1()).attr("x2",S.getX2()).attr("y2",S.getY2()).attr("filter",S.getFilter()).attr("aria-label",S.getAriaLabel()).attr("stroke",this.determineValue("stroke",S)).attr("stroke-width",S.getStrokeWidth()).attr("stroke-dasharray",S.getStrokeDasharray()).attr("fill-opacity",S.getFillOpacity()).attr("stroke-opacity",S.getStrokeOpacity()).attr("transform",S.getTransform());};L.prototype._drawRect=function(s,S){s.append("rect").attr("x",S.getX()).attr("y",S.getY()).attr("width",S.getWidth()).attr("height",S.getHeight()).attr("fill",this.determineValue("fill",S)).attr("rx",S.getRx()).attr("ry",S.getRy()).attr("filter",S.getFilter()).attr("stroke",this.determineValue("stroke",S)).attr("stroke-width",S.getStrokeWidth()).attr("stroke-dasharray",S.getStrokeDasharray()).attr("fill-opacity",S.getFillOpacity()).attr("stroke-opacity",S.getStrokeOpacity()).attr("aria-label",S.getAriaLabel()).attr("transform",S.getTransform());};L.prototype._drawText=function(s,S){s.append("text").attr("x",S.getX()).attr("y",S.getRowYCenter()).attr("text-anchor","middle").attr("font-size",S.getFontSize()).attr("fill",this.determineValue("fill",S)).attr("filter",S.getFilter()).attr("stroke",this.determineValue("stroke",S)).attr("stroke-width",S.getStrokeWidth()).attr("alignment-baseline","central").attr("font-family",S.getFontFamily()).text(S.getText()).attr("transform",S.getTransform());};L.prototype._drawPath=function(s,S){function o(){if(S.getIsClosed()){return S.getFillOpacity();}}function O(){if(S.getIsClosed()){return S.getStrokeOpacity();}}s.append("path").attr("d",S.getD()).attr("fill",this.determineValue("fill",S)).attr("stroke",this.determineValue("stroke",S)).attr("stroke-width",S.getStrokeWidth()).attr("stroke-dasharray",S.getStrokeDasharray()).attr("fill-opacity",o()).attr("stroke-opacity",O()).attr("filter",S.getFilter()).attr("aria-label",S.getAriaLabel()).attr("transform",S.getTransform());};L.prototype._drawImage=function(s,S){s.append("image").attr("xlink:href",S.getImage()).attr("x",S.getX()-S.getWidth()/2).attr("y",S.getY()).attr("width",S.getWidth()).attr("height",S.getHeight()).attr("filter",S.getFilter()).attr("aria-label",S.getAriaLabel()).attr("transform",S.getTransform());};L.prototype._drawPolygon=function(s,S){s.append("polygon").attr("fill",this.determineValue("fill",S)).attr("points",S.getPoints()).attr("stroke-width",S.getStrokeWidth()).attr("stroke",this.determineValue("stroke",S)).attr("filter",S.getFilter()).attr("aria-label",S.getAriaLabel()).attr("transform",S.getTransform());};L.prototype._drawPolyline=function(s,S){s.append("polyline").attr("fill",this.determineValue("fill",S)).attr("points",S.getPoints()).attr("stroke-width",S.getStrokeWidth()).attr("stroke",this.determineValue("stroke",S)).attr("filter",S.getFilter()).attr("aria-label",S.getAriaLabel()).attr("transform",S.getTransform());};L.prototype._drawCircle=function(s,S){s.append("circle").attr("fill",this.determineValue("fill",S)).attr("stroke-width",S.getStrokeWidth()).attr("stroke",this.determineValue("stroke",S)).attr("filter",S.getFilter()).attr("aria-label",S.getAriaLabel()).attr("cx",S.getCx()).attr("cy",S.getCy()).attr("r",S.getR()).attr("transform",S.getTransform());};L.prototype.determineValue=function(a,s){var A=null;if(a==="fill"){A=s.getFill();}else if(a==="stroke"){A=s.getStroke();}return sap.gantt.ValueSVGPaintServer.normalize(A);};return L;},true);};if(!jQuery.sap.isDeclared('sap.gantt.drawer.NowLine')){jQuery.sap.declare('sap.gantt.drawer.NowLine');jQuery.sap.require('sap.ui.thirdparty.d3');sap.ui.define("sap/gantt/drawer/NowLine",["sap/gantt/misc/Utility","./Drawer","sap/ui/thirdparty/d3"],function(U,D){"use strict";var l=8;var N=D.extend("sap.gantt.drawer.NowLine",{constructor:function(a){this.oAxisTime=a;}});N.prototype.drawSvg=function(g,G){this.destroySvg(g,G);var n=this.oAxisTime.timeToView(new Date());var c=jQuery(g.node()).width();if(n>c){return;}var C=g,o=G;var s={x:n,y:jQuery(G.node()).height()};this._drawHeaderTriangle(s,o);this._drawBodyStaightLine(s,C);};N.prototype._drawHeaderTriangle=function(s,p){var h=l/2,t=Math.sqrt(l*l-h*h);var T=[s,{x:s.x-h,y:s.y-t},{x:s.x+h,y:s.y-t},s];var L=d3.svg.line().x(function(d){return d.x;}).y(function(d){return d.y;}).interpolate("linera");p.append("g").classed("sapGanttNowLineHeaderSvgPath",true).append("path").attr("d",L(T));};N.prototype._drawBodyStaightLine=function(s,p){var n=p.selectAll(".sapGanttNowLineBodySvgLine").data(function(){var w=jQuery(window).height();return[{x1:s.x,y1:0,x2:s.x,y2:s.y+w}];});n.enter().append("g").classed("sapGanttNowLineBodySvgLine",true);var o=n.selectAll("g").data(function(d){return[d];});o.enter().append("line");o.attr("x1",function(d){return d.x1;}).attr("y1",function(d){return d.y1;}).attr("x2",function(d){return d.x2;}).attr("y2",function(d){return d.y2;});o.exit().remove();};N.prototype.destroySvg=function(g,G){if(g&&G){g.selectAll(".sapGanttNowLineBodySvgLine").remove();G.selectAll(".sapGanttNowLineHeaderSvgPath").remove();}};return N;},true);};if(!jQuery.sap.isDeclared('sap.gantt.drawer.SelectionPanel')){jQuery.sap.declare('sap.gantt.drawer.SelectionPanel');jQuery.sap.require('sap.ui.core.Core');jQuery.sap.require('sap.ui.thirdparty.d3');sap.ui.define("sap/gantt/drawer/SelectionPanel",["sap/gantt/drawer/Drawer","sap/gantt/misc/Utility","sap/ui/core/Core","sap/ui/thirdparty/d3"],function(D,U,C){"use strict";var S=D.extend("sap.gantt.drawer.SelectionPanel");S.prototype.drawSvg=function(t,s,d,g){this._oGanttChartWithTable=g;if(d.length==0){return null;}var a=[];for(var i=0;i<d.length;i++){if(d[i].data.__dummy&&!d[i].data.previousNodeNum&&!d[i].data.afterNodeNum){a.push(d[i]);}}var T=t.selectAll(".selectionpanel").data(a);T.enter().append("g").classed("selectionpanel",true);T.exit().remove();var b=s.selectAll(".selectionpanel").data(a);b.enter().append("g").classed("selectionpanel",true);b.exit().remove();if(!T.empty()&&!b.empty()){var c=$(s[0][0]).width();var e=$(t[0][0]).width();this._drawExpandedBackground(s,c);this._drawExpandedBackground(t,e);this._drawExpandedContent(t,e);}};S.prototype._drawExpandedBackground=function(s,w){s.selectAll(".selectionpanel").selectAll("rect").remove();s.selectAll(".selectionpanel").append("rect").classed("sapGanttExpandChartBG",true).attr("x",function(d){return 0;}).attr("y",function(d){return d.y;}).attr("height",function(d){return d.rowHeight-1;}).attr("width",function(d){return w-1;});};S.prototype._drawExpandedContent=function(s,w){s.selectAll(".selectionpanel").selectAll("g").remove();var t=this;s.selectAll(".selectionpanel").append("g").classed("sapGanttExpandChartContent",true);var g=s.selectAll(".sapGanttExpandChartContent");var f=g.filter(function(d,i){return d.index===1;});f.append("image").classed("hasTitle",function(d){return"image";}).attr("xlink:href",function(d){return d.icon;}).attr("x",function(d){if(C.getConfiguration().getRTL()===true){return w-19-16;}else{return 19;}}).attr("y",function(d){return d.y+4.25;}).attr("width",function(d){return 16;}).attr("height",function(d){return 16;});f.append("text").attr("x",function(d){if(C.getConfiguration().getRTL()===true){return w-93+56;}else{return 38;}}).attr("y",function(d){return d.y+16.5;}).attr("font-size",function(d){return"0.75em";}).text(function(d){return d.name;});f.append("g").attr("transform",function(d){var i=0,I=d.y+7;if(C.getConfiguration().getRTL()===true){i=w-93-4;}else{i=93+8;}return"translate("+i+","+I+")";});f.select("g").append("path").classed("sapGanttExpandChartCloseButton",true).attr("d","M1 0 h3 v4 h4 v3 h-4 v4 h-3 v-4 h-4 v-3 h4 v-4 z").attr("transform","rotate(45)").on("click",function(d){var a=[];a.push(d.chartScheme);var b=t._oGanttChartWithTable._oTT.getBinding("rows");var r=b.getContexts(0,b.getLength());for(var i=0;i<r.length;i++){var o=r[i].getProperty();if(o&&d.data.parentData&&o.id==d.data.parentData.id){t._oGanttChartWithTable.fireEvent("collapseDummyRow",{isExpand:false,expandedChartSchemes:a,aExpandedIndices:[i]});}}});var c=f.selectAll("path");c.select("title").remove();c.insert("title",":first-child").text(function(d){return sap.ui.getCore().getLibraryResourceBundle("sap.gantt").getText("TLTP_CLOSE");});};return S;},true);};if(!jQuery.sap.isDeclared('sap.gantt.drawer.ShapeCrossRow')){jQuery.sap.declare('sap.gantt.drawer.ShapeCrossRow');jQuery.sap.require('sap.ui.thirdparty.d3');sap.ui.define("sap/gantt/drawer/ShapeCrossRow",["sap/gantt/drawer/Drawer","sap/gantt/misc/Utility","sap/ui/thirdparty/d3"],function(D,U){"use strict";var S=D.extend("sap.gantt.drawer.ShapeCrossRow");S.prototype.drawSvg=function(s,o,a,A){this._oAxisTime=a;this._oAxisOrdinal=A;var b=s.select("."+o.getId()+"-top");if(b.empty()){b=s.append("g").classed(o.getId()+"-top",true);}var r=[];for(var i in o.dataSet){r.push(o.dataSet[i].shapeData[0]);}var c=b.selectAll("."+o.getId()).data(r);this._drawPath(c,o);this._drawInsertTitle(c,o);};S.prototype._drawPath=function(s,o){var f=this._findObjectInfo;var t=this;s.enter().append("path").classed(o.getId(),true);s.classed("hasTitle",function(d){return o.getTitle(d,f(this,o,t))?true:false;}).classed("enableSelected",function(d){return o.getEnableSelection(d,f(this,o,t))?true:false;}).attr("d",function(d){return o.getD(d,f(this,o,t));}).attr("fill",function(d){if(o.getIsClosed(d,f(this,o,t))){return o.getFill(d,f(this,o,t));}}).attr("stroke",function(d){return o.getStroke(d,f(this,o,t));}).attr("stroke-width",function(d){return o.getStrokeWidth(d,f(this,o,t));}).attr("stroke-dasharray",function(d){return o.getStrokeDasharray(d,f(this,o,t));}).attr("fill-opacity",function(d){if(o.getIsClosed(d,f(this,o,t))){return o.getFillOpacity(d,f(this,o,t));}}).attr("stroke-opacity",function(d){if(o.getIsClosed(d,f(this,o,t))){return o.getStrokeOpacity(d,f(this,o,t));}});s.exit().remove();};S.prototype._drawInsertTitle=function(s,o){var f=this._findObjectInfo;var t=this;s.select("title").remove();s.insert("title",":first-child").text(function(d){return o.getTitle(d,f(this,o,t));});};S.prototype._findObjectInfo=function(n,s,t,i){var r=n.__data__;var R=r;if(i){R=r.data.rawData;}var a={from:{objectInfo:R.fromObject.objectInfoRef?R.fromObject.objectInfoRef:R.fromObject,shapeRawData:R.fromShapeRawData},to:{objectInfo:R.toObject.objectInfoRef?R.toObject.objectInfoRef:R.toObject,shapeRawData:R.toShapeRawData}};return a;};S.prototype.destroySvg=function(s,o){};S.prototype.generateRelationshipDataSet=function(s,o,n,a,r,A,b){var R=r;var c=[];if(R!==undefined&&R.length>0){var d;var e;for(e in o){if(o[e].getCategory(null,A,b)===sap.gantt.shape.ShapeCategory.Relationship){d=o[e];break;}}if(d){var f={};for(e in o){if(o[e].dataSet&&o[e].dataSet!=""&&o[e].mShapeConfig.getShapeDataName()!=sap.gantt.shape.ShapeCategory.Relationship){U.generateObjectPathToObjectMap(o[e].dataSet,f,null);}}U.generateObjectPathToObjectMap(n,f,null);var g;var h;for(var i=0;i<R.length;i++){g=R[i];h=g;var j=d.getFromObjectPath(h,null);var k=f[j];var l=d.getFromShapeId(h,null);var m=d.getFromDataId(h,null);if(!k){continue;}var F=o[l].mShapeConfig.getShapeDataName();var p=this._findShapeDataFromRowObjectByShapeDataName(k,m,F);if(!p){continue;}var t=d.getToObjectPath(h,null);var q=f[t];var u=d.getToShapeId(h,null);var v=d.getToDataId(h,null);if(!q){continue;}var T=o[u].mShapeConfig.getShapeDataName();var w=this._findShapeDataFromRowObjectByShapeDataName(q,v,T);if(!w){continue;}h.fromObject=k;h.toObject=q;h.fromShapeRawData=p;h.toShapeRawData=w;var x={"shapeData":[g]};c.push(x);}}}return c;};S.prototype._findShapeDataFromRowObjectByShapeDataName=function(r,s,a){var o,b;if(r.shapeData){b=r.shapeData;}else if(r.data&&r.data[a]){b=r.data[a];}else if(r.data){b=r.data;}else{b=r;}for(var i=0;i<b.length;i++){if(b[i].id!==undefined&&b[i].id==s){o=b[i];break;}}if(o==undefined&&b.length>0){o=b[0];}return o;};return S;},true);};if(!jQuery.sap.isDeclared('sap.gantt.drawer.ShapeInRow')){jQuery.sap.declare('sap.gantt.drawer.ShapeInRow');jQuery.sap.require('sap.ui.thirdparty.d3');sap.ui.define("sap/gantt/drawer/ShapeInRow",["sap/gantt/drawer/Drawer","sap/gantt/misc/Utility","sap/gantt/misc/Format","sap/ui/thirdparty/d3"],function(D,U,F){"use strict";var S=D.extend("sap.gantt.drawer.ShapeInRow",{constructor:function(){this._mValueColors={};}});S.prototype.drawSvg=function(s,o,a,A,b){this._oAxisTime=a;this._oAxisOrdinal=A;this._oStatusSet=b;var c=s.select("."+o.getId()+"-top");if(c.empty()){c=s.append("g").classed(o.getId()+"-top",true);}var r=c.selectAll("."+o.getId()+"-row").data(o.dataSet);r.enter().append("g").classed(o.getId()+"-row",true);r.exit().remove();if(!r.empty()){this._recursiveDraw(r,o);}};S.prototype._recursiveDraw=function(g,s,a){var t=this;var b=g.selectAll("."+s.getId()).data(function(d){return t._bindRowData(d,a,this,s);});this._drawPerTag(b,s);this._drawInsertTitle(g,s);};S.prototype._bindRowData=function(d,s,n,o){var v=this._oStatusSet&&this._oStatusSet.aViewBoundary?this._oStatusSet.aViewBoundary:undefined;var a=o.getIsBulk();var f,i;if(d){var r=[];if(d.shapeData){if(!(d.shapeData instanceof Array)){r=r.concat(d.shapeData);}else{for(i=0;i<d.shapeData.length;i++){if(d.shapeData[i]){f={};f.oShape=o;f.objectInfo=d.objectInfoRef;f.dShapeData=d.shapeData[i];f.aViewRange=v;if(!a&&(v!==undefined)&&this._filterDataVisibleRange(f)){continue;}r=r.concat(d.shapeData[i]);}}}}else if(s&&d[s]){if(d[s].length){for(i=0;i<d[s].length;i++){f={};f.oShape=o;f.objectInfo=d.objectInfoRef;f.dShapeData=d[s][i];f.aViewRange=v;if(!a&&(v!==undefined)&&this._filterDataVisibleRange(f)){continue;}r.push(d[s][i]);}}else{r.push(d[s]);}}else if(d){r=r.concat(d);}if(o.filterValidData&&(r.length>0)){r=o.filterValidData(r);}return r;}};S.prototype._filterDataVisibleRange=function(f){var a=this._oAxisTime;var A=this._oAxisOrdinal;var v=f.aViewRange;var i=f.oShape.getIsDuration(f.dShapeData);if(i){var s=a.timeToView(F.abapTimestampToDate(f.oShape.getTime(f.dShapeData,undefined,a,A,f.objectInfo)));var e=a.timeToView(F.abapTimestampToDate(f.oShape.getEndTime(f.dShapeData,undefined,a,A,f.objectInfo)));if(this._oStatusSet.bRTL===true){return(e>v[1])||(s<v[0]);}else{return(e<v[0])||(s>v[1]);}}else{var t=a.timeToView(F.abapTimestampToDate(f.oShape.getTime(f.dShapeData,undefined,a,A,f.objectInfo)));return(t>v[1])||(t<v[0]);}return false;};S.prototype._drawPerTag=function(s,o){switch(o.getTag()){case"g":this._drawGroup(s,o);break;case"line":this._drawLine(s,o);break;case"rect":this._drawRect(s,o);break;case"text":this._drawText(s,o);break;case"path":this._drawPath(s,o);break;case"clippath":this._drawClipPath(s,o);break;case"image":this._drawImage(s,o);break;case"polygon":this._drawPolygon(s,o);break;case"polyline":this._drawPolyline(s,o);break;case"circle":this._drawCircle(s,o);break;default:break;}};S.prototype._drawGroup=function(s,o){var f=this._findObjectInfo;s.enter().append("g").classed(o.getId(),true);s.classed("hasTitle",function(d){return o.getTitle(d,f(this,o))?true:false;});s.exit().remove();var a=o.getShapes();if(a&&a.length>0){for(var i=0;i<a.length;i++){this._recursiveDraw(s,a[i],a[i].mShapeConfig.getShapeDataName());}}};S.prototype._drawLine=function(s,o){var f=this._findObjectInfo;s.enter().append("line").classed(o.getId(),true);s.classed("hasTitle",function(d){return o.getTitle(d,f(this,o))?true:false;}).attr("x1",function(d){return o.getX1(d,f(this,o));}).attr("y1",function(d){return o.getY1(d,f(this,o));}).attr("x2",function(d){return o.getX2(d,f(this,o));}).attr("y2",function(d){return o.getY2(d,f(this,o));}).attr("filter",function(d){return o.getFilter(d,f(this,o));}).attr("transform",function(d){return o.getTransform(d,f(this,o));}).attr("aria-label",function(d){return o.getAriaLabel(d,f(this,o));}).attr("stroke",this.determineValue("stroke",o)).attr("stroke-width",function(d){return o.getStrokeWidth(d,f(this,o));}).attr("stroke-dasharray",function(d){return o.getStrokeDasharray(d,f(this,o));}).attr("fill-opacity",function(d){return o.getFillOpacity(d,f(this,o));}).attr("stroke-opacity",function(d){return o.getStrokeOpacity(d,f(this,o));});s.exit().remove();};S.prototype._drawRect=function(s,o){var f=this._findObjectInfo;s.enter().append("rect").classed(o.getId(),true);s.classed("hasTitle",function(d){return o.getTitle(d,f(this,o))?true:false;}).classed("sapGanttExpandChartBG",function(d){return o.getHtmlClass(d,f(this,o))?true:false;}).classed("enableClone",function(d){return o.getEnableDnD(d,f(this,o))?true:false;}).attr("x",function(d){return o.getX(d,f(this,o));}).attr("y",function(d){return o.getY(d,f(this,o));}).attr("width",function(d){return o.getWidth(d,f(this,o));}).attr("height",function(d){return o.getHeight(d,f(this,o));}).attr("fill",this.determineValue("fill",o)).attr("rx",function(d){return o.getRx(d,f(this,o));}).attr("ry",function(d){return o.getRy(d,f(this,o));}).attr("filter",function(d){return o.getFilter(d,f(this,o));}).attr("transform",function(d){return o.getTransform(d,f(this,o));}).attr("stroke",this.determineValue("stroke",o)).attr("stroke-width",function(d){return o.getStrokeWidth(d,f(this,o));}).attr("stroke-dasharray",function(d){return o.getStrokeDasharray(d,f(this,o));}).attr("fill-opacity",function(d){return o.getFillOpacity(d,f(this,o));}).attr("stroke-opacity",function(d){return o.getStrokeOpacity(d,f(this,o));}).attr("clip-path",function(d){return o.getClipPath(d,f(this,o));}).attr("aria-label",function(d){return o.getAriaLabel(d,f(this,o));});s.exit().remove();};S.prototype._drawText=function(s,o){var f=this._findObjectInfo;var t=this;s.enter().append("text").classed(o.getId(),true);s.classed("sapGanttShapeSvgText",true).classed("hasTitle",function(d){return o.getTitle(d,f(this,o))?true:false;}).attr("x",function(d){return o.getX(d,f(this,o));}).attr("y",function(d){return o.getY(d,f(this,o));}).attr("text-anchor",function(d){return o.getTextAnchor(d,f(this,o));}).attr("font-size",function(d){return o.getFontSize(d,f(this,o));}).attr("fill",this.determineValue("fill",o)).attr("filter",function(d){return o.getFilter(d,f(this,o));}).attr("transform",function(d){return o.getTransform(d,f(this,o));}).attr("stroke",this.determineValue("stroke",o)).attr("stroke-width",function(d){return o.getStrokeWidth(d,f(this,o));}).text(function(d){return o.getText(d,f(this,o));}).each(function(d){var a=d3.select(this);a.selectAll("tspan").remove();var n=o.getWrapWidth(d,f(this,o));var b=o.getTruncateWidth(d,f(this,o));if(b>-1){t._textTruncate(d,a,b,o.getEllipsisWidth(d,f(this,o)));}else if(n>-1){t._textWrap(d,this,n,o.getWrapDy(d,f(this,o)));}});s.exit().remove();};S.prototype._textTruncate=function(d,s,n,a){var b=s.node().getComputedTextLength();if(b>n){var t=s.text(),c,e;if(a>-1&&a<n){e=true;c=n-a;}else{e=false;c=n;}while((b>c&&t.length>0)){t=t.slice(0,-1);s.text(t);b=s.node().getComputedTextLength();}if(e){if(sap.ui.Device.browser.name==="cr"){s.append("tspan").text("...").attr("textLength",s.node().getComputedTextLength()).attr("lengthAdjust","spacingAndGlyphs");}else{s.append("tspan").text("...").attr("textLength",a).attr("lengthAdjust","spacingAndGlyphs");}}}};S.prototype._textWrap=function(d,s,n,a){};S.prototype._drawPath=function(s,o){var f=this._findObjectInfo;s.enter().append("path").classed(o.getId(),true);s.classed("hasTitle",function(d){return o.getTitle(d,f(this,o))?true:false;}).attr("d",function(d){return o.getD(d,f(this,o));}).attr("fill",this.determineValue("fill",o)).attr("stroke",this.determineValue("stroke",o)).attr("stroke-width",function(d){return o.getStrokeWidth(d,f(this,o));}).attr("stroke-dasharray",function(d){return o.getStrokeDasharray(d,f(this,o));}).attr("fill-opacity",function(d){if(o.getIsClosed(d,f(this,o))){return o.getFillOpacity(d,f(this,o));}}).attr("stroke-opacity",function(d){if(o.getIsClosed(d,f(this,o))){return o.getStrokeOpacity(d,f(this,o));}}).attr("transform",function(d){return o.getTransform(d,f(this,o));}).attr("filter",function(d){return o.getFilter(d,f(this,o));}).attr("aria-label",function(d){return o.getAriaLabel(d,f(this,o));});s.exit().remove();};S.prototype._drawClipPath=function(s,o){var f=this._findObjectInfo;s.enter().append("clipPath").classed(o.getId(),true);s.selectAll("path").remove();s.attr("id",function(d){return o.getHtmlClass(d,f(this,o));});s.append("path").attr("d",function(d){return o.getPaths()[0].getD(d,f(this,o));});s.exit().remove();};S.prototype._drawImage=function(s,o){var f=this._findObjectInfo;s.enter().append("image").classed(o.getId(),true);s.classed("hasTitle",function(d){return o.getTitle(d,f(this,o))?true:false;}).attr("xlink:href",function(d){return o.getImage(d,f(this,o));}).attr("x",function(d){return o.getX(d,f(this,o));}).attr("y",function(d){return o.getY(d,f(this,o));}).attr("width",function(d){return o.getWidth(d,f(this,o));}).attr("height",function(d){return o.getHeight(d,f(this,o));}).attr("filter",function(d){return o.getFilter(d,f(this,o));}).attr("transform",function(d){return o.getTransform(d,f(this,o));}).attr("aria-label",function(d){return o.getAriaLabel(d,f(this,o));});s.exit().remove();};S.prototype._drawPolygon=function(s,o){var f=this._findObjectInfo;s.enter().append("polygon").classed(o.getId(),true);s.classed("hasTitle",function(d){return o.getTitle(d,f(this,o))?true:false;}).attr("fill",this.determineValue("fill",o)).attr("fill-opacity",function(d){return o.getFillOpacity(d,f(this,o));}).attr("points",function(d){return o.getPoints(d,f(this,o));}).attr("stroke-width",function(d){return o.getStrokeWidth(d,f(this,o));}).attr("stroke",this.determineValue("stroke",o)).attr("filter",function(d){return o.getFilter(d,f(this,o));}).attr("transform",function(d){return o.getTransform(d,f(this,o));}).attr("aria-label",function(d){return o.getAriaLabel(d,f(this,o));});s.exit().remove();};S.prototype._drawPolyline=function(s,o){var f=this._findObjectInfo;s.enter().append("polyline").classed(o.getId(),true);s.classed("hasTitle",function(d){return o.getTitle(d,f(this,o))?true:false;}).attr("fill",this.determineValue("fill",o)).attr("fill-opacity",function(d){return o.getFillOpacity(d,f(this,o));}).attr("points",function(d){return o.getPoints(d,f(this,o));}).attr("stroke-width",function(d){return o.getStrokeWidth(d,f(this,o));}).attr("stroke",this.determineValue("stroke",o)).attr("filter",function(d){return o.getFilter(d,f(this,o));}).attr("transform",function(d){return o.getTransform(d,f(this,o));}).attr("aria-label",function(d){return o.getAriaLabel(d,f(this,o));});s.exit().remove();};S.prototype._drawCircle=function(s,o){var f=this._findObjectInfo;s.enter().append("circle").classed(o.getId(),true);s.classed("hasTitle",function(d){return o.getTitle(d,f(this,o))?true:false;}).attr("fill",this.determineValue("fill",o)).attr("fill-opacity",function(d){return o.getFillOpacity(d,f(this,o));}).attr("stroke-width",function(d){return o.getStrokeWidth(d,f(this,o));}).attr("stroke",this.determineValue("stroke",o)).attr("filter",function(d){return o.getFilter(d,f(this,o));}).attr("transform",function(d){return o.getTransform(d,f(this,o));}).attr("aria-label",function(d){return o.getAriaLabel(d,f(this,o));}).attr("cx",function(d){return o.getCx(d,f(this,o));}).attr("cy",function(d){return o.getCy(d,f(this,o));}).attr("r",function(d){return o.getR(d,f(this,o));});s.exit().remove();};S.prototype._drawInsertTitle=function(g,s){var f=this._findObjectInfo;var a=g.selectAll("."+s.getId()+".hasTitle");a.select("title").remove();a.insert("title",":first-child").text(function(d){return s.getTitle(d,f(this,s));});};S.prototype._findObjectInfo=function(n,s,i){var t=n;while(!t.__data__.objectInfoRef){t=t.parentNode;}return t.__data__.objectInfoRef;};S.prototype.determineValue=function(a,s){var t=this;return function(d){var A=null;if(a==="fill"){A=s.getFill(d,t._findObjectInfo(this,s));}else if(a==="stroke"){A=s.getStroke(d,t._findObjectInfo(this,s));}var f=t._mValueColors[A];if(A&&!f){f=sap.gantt.ValueSVGPaintServer.normalize(A);t._mValueColors[A]=f;}return f;};};S.prototype.destroySvg=function(s,o){};return S;},true);};if(!jQuery.sap.isDeclared('sap.gantt.drawer.VerticalLine')){jQuery.sap.declare('sap.gantt.drawer.VerticalLine');jQuery.sap.require('sap.ui.thirdparty.d3');sap.ui.define("sap/gantt/drawer/VerticalLine",["sap/gantt/misc/Utility","./Drawer","sap/ui/thirdparty/d3"],function(U,D){"use strict";var V=D.extend("sap.gantt.drawer.VerticalLine",{constructor:function(a){this.oAxisTime=a;}});V.prototype.drawSvg=function(g){var c=jQuery(g.node()),C=c.width(),w=document.body.clientHeight;var I=this.oAxisTime.getCurrentTickTimeIntervalKey();var t=this.oAxisTime.getTickTimeIntervalLabel(I,null,[0,C]);var T=t[1];var p="";for(var i=0;i<T.length;i++){p+=" M"+" "+(T[i].value-1/2)+" 0"+" L"+" "+(T[i].value-1/2)+" "+(w);}if(p){g.selectAll(".sapGanttChartVerticalLine").remove();var $=jQuery(g.select("rect").node());var s=$.attr("class")?$.attr("class").split(" ")[0]:"";if(sap.ui.getCore().byId(s)&&sap.ui.getCore().byId(s).getMetadata().getName()==="sap.gantt.shape.ext.RowBackgroundRectangle"){g.select("g").append("g").classed("sapGanttChartVerticalLine",true).append("path").attr("d",p);}else{g.insert("g",":first-child").classed("sapGanttChartVerticalLine",true).append("path").attr("d",p);}}};V.prototype.destroySvg=function(g){if(g){g.selectAll(".sapGanttChartVerticalLine").remove();}};return V;},true);};if(!jQuery.sap.isDeclared('sap.gantt.library')){jQuery.sap.declare('sap.gantt.library');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.library');jQuery.sap.require('sap.ui.base.DataType');sap.ui.define("sap/gantt/library",['jquery.sap.global','sap/ui/core/library','sap/gantt/misc/Utility','sap/ui/base/DataType'],function(q,l,U,D){"use strict";sap.ui.getCore().initLibrary({name:"sap.gantt",dependencies:["sap.ui.core","sap.ui.layout","sap.ui.table","sap.m","sap.ui.unified"],types:["sap.gantt.control.ToolbarType","sap.gantt.SelectionMode","sap.gantt.shape.ShapeCategory","sap.gantt.def.filter.MorphologyOperator","sap.gantt.def.filter.ColorMatrixValue"],interfaces:["sap.gantt.GanttChartBase"],controls:["sap.gantt.control.Toolbar","sap.gantt.GanttChart","sap.gantt.GanttChartWithTable","sap.gantt.GanttChartContainer"],elements:["sap.gantt.config.TimeHorizon","sap.gantt.config.TimeAxis","sap.gantt.config.ToolbarGroup","sap.gantt.config.Mode","sap.gantt.config.ModeGroup","sap.gantt.config.LayoutGroup","sap.gantt.config.ExpandChart","sap.gantt.config.ExpandChartGroup","sap.gantt.config.ToolbarScheme","sap.gantt.config.Hierarchy","sap.gantt.config.HierarchyColumn","sap.gantt.config.ColumnAttribute","sap.gantt.config.GanttChartLayout","sap.gantt.config.ContainerLayout","sap.gantt.config.SettingItem","sap.gantt.config.SettingGroup","sap.gantt.config.ObjectType","sap.gantt.config.ChartScheme","sap.gantt.config.Locale","sap.gantt.config.Shape"],noLibraryCSS:false,version:"1.36.8"});this._oRb=sap.ui.getCore().getLibraryResourceBundle("sap.gantt");sap.gantt.SelectionMode={MultiWithKeyboard:"MultiWithKeyboard",Multiple:"Multiple",Single:"Single",None:"None"};sap.gantt.control.ToolbarType={Global:"GLOBAL",Local:"LOCAL"};sap.gantt.ValueSVGPaintServer=D.createType('sap.gantt.ValueSVGPaintServer',{isValid:function(v){var V=sap.m.ValueCSSColor.isValid(v);if(!V){V=/(?:url\(['|"]?)(.*?)(?:['|"]?\))|^[@|#](.*?)$|initial|transparent|none|inherit/.test(v);}return V;}},D.getType('string'));sap.gantt.ValueSVGPaintServer.setNormalizer(function(v){q.sap.require("sap.ui.core.theming.Parameters");if(!v){return v;}if(v.substr(0,1)==="@"){v=v.substring(1);}var r=sap.ui.core.theming.Parameters.get(v)||v;return r;});sap.gantt.shape.ShapeCategory={InRowShape:"inRowShape",Relationship:"relationship"};sap.gantt.def.filter.MorphologyOperator={Dilate:"dilate",Erode:"erode"};sap.gantt.def.filter.ColorMatrixValue={AllToWhite:"-1 0 0 0 1, 0 -1 0 0 1, 0 0 -1 0 1, 0 0 0 1 0",AllToBlack:"-1 0 0 0 0, 0 -1 0 0 0, 0 0 -1 0 0, 0 0 0 1 0"};sap.gantt.config.TimeUnit={minute:"d3.time.minute",hour:"d3.time.hour",day:"d3.time.day",week:"d3.time.week",month:"d3.time.month",year:"d3.time.year"};sap.gantt.config.DEFAULT_PLAN_HORIZON=new sap.gantt.config.TimeHorizon({startTime:new Date((new Date()).getTime()-31536000000),endTime:new Date((new Date()).getTime()+31536000000)});sap.gantt.config.DEFAULT_INIT_HORIZON=new sap.gantt.config.TimeHorizon({startTime:new Date((new Date()).getTime()-2628000000),endTime:new Date((new Date()).getTime()+2628000000)});sap.gantt.config.DEFAULT_TIME_ZOOM_STRATEGY={"5min":{innerInterval:{unit:sap.gantt.config.TimeUnit.minute,span:5,range:90},largeInterval:{unit:sap.gantt.config.TimeUnit.day,span:1,format:"cccc dd.M.yyyy"},smallInterval:{unit:sap.gantt.config.TimeUnit.minute,span:5,format:"HH:mm"}},"10min":{innerInterval:{unit:sap.gantt.config.TimeUnit.minute,span:10,range:90},largeInterval:{unit:sap.gantt.config.TimeUnit.day,span:1,format:"cccc dd.M.yyyy"},smallInterval:{unit:sap.gantt.config.TimeUnit.minute,span:10,format:"HH:mm"}},"15min":{innerInterval:{unit:sap.gantt.config.TimeUnit.minute,span:15,range:90},largeInterval:{unit:sap.gantt.config.TimeUnit.day,span:1,format:"cccc dd.M.yyyy"},smallInterval:{unit:sap.gantt.config.TimeUnit.minute,span:15,format:"HH:mm"}},"30min":{innerInterval:{unit:sap.gantt.config.TimeUnit.minute,span:30,range:90},largeInterval:{unit:sap.gantt.config.TimeUnit.day,span:1,format:"cccc dd.M.yyyy"},smallInterval:{unit:sap.gantt.config.TimeUnit.minute,span:30,format:"HH:mm"}},"1hour":{innerInterval:{unit:sap.gantt.config.TimeUnit.hour,span:1,range:90},largeInterval:{unit:sap.gantt.config.TimeUnit.day,span:1,format:"cccc dd.M.yyyy"},smallInterval:{unit:sap.gantt.config.TimeUnit.hour,span:1,format:"HH:mm"}},"2hour":{innerInterval:{unit:sap.gantt.config.TimeUnit.hour,span:2,range:90},largeInterval:{unit:sap.gantt.config.TimeUnit.day,span:1,format:"cccc dd.M.yyyy"},smallInterval:{unit:sap.gantt.config.TimeUnit.hour,span:2,format:"HH:mm"}},"4hour":{innerInterval:{unit:sap.gantt.config.TimeUnit.hour,span:4,range:90},largeInterval:{unit:sap.gantt.config.TimeUnit.day,span:1,format:"cccc dd.M.yyyy"},smallInterval:{unit:sap.gantt.config.TimeUnit.hour,span:4,format:"HH:mm"}},"6hour":{innerInterval:{unit:sap.gantt.config.TimeUnit.hour,span:6,range:90},largeInterval:{unit:sap.gantt.config.TimeUnit.day,span:1,format:"cccc dd.M.yyyy"},smallInterval:{unit:sap.gantt.config.TimeUnit.hour,span:6,format:"HH:mm"}},"12hour":{innerInterval:{unit:sap.gantt.config.TimeUnit.hour,span:12,range:90},largeInterval:{unit:sap.gantt.config.TimeUnit.day,span:1,format:"cccc dd.M.yyyy"},smallInterval:{unit:sap.gantt.config.TimeUnit.hour,span:12,format:"HH:mm"}},"1day":{innerInterval:{unit:sap.gantt.config.TimeUnit.day,span:1,range:90},largeInterval:{unit:sap.gantt.config.TimeUnit.month,span:1,format:"MMMM yyyy"},smallInterval:{unit:sap.gantt.config.TimeUnit.day,span:1,format:sap.ui.getCore().getConfiguration().getRTL()?".d.M":"d.M."}},"2day":{innerInterval:{unit:sap.gantt.config.TimeUnit.day,span:2,range:90},largeInterval:{unit:sap.gantt.config.TimeUnit.month,span:1,format:"MMMM yyyy"},smallInterval:{unit:sap.gantt.config.TimeUnit.day,span:2,format:sap.ui.getCore().getConfiguration().getRTL()?".d.M":"d.M."}},"4day":{innerInterval:{unit:sap.gantt.config.TimeUnit.day,span:4,range:90},largeInterval:{unit:sap.gantt.config.TimeUnit.month,span:1,format:"MMMM yyyy"},smallInterval:{unit:sap.gantt.config.TimeUnit.day,span:4,format:sap.ui.getCore().getConfiguration().getRTL()?".d.M":"d.M."}},"1week":{innerInterval:{unit:sap.gantt.config.TimeUnit.week,span:1,range:90},largeInterval:{unit:sap.gantt.config.TimeUnit.month,span:1,format:"MMMM yyyy"},smallInterval:{unit:sap.gantt.config.TimeUnit.week,span:1,format:sap.ui.getCore().getConfiguration().getRTL()?".d.M":"d.M."}},"2week":{innerInterval:{unit:sap.gantt.config.TimeUnit.week,span:2,range:90},largeInterval:{unit:sap.gantt.config.TimeUnit.month,span:1,format:"MMMM yyyy"},smallInterval:{unit:sap.gantt.config.TimeUnit.week,span:2,format:sap.ui.getCore().getConfiguration().getRTL()?".d.M":"d.M."}},"1month":{innerInterval:{unit:sap.gantt.config.TimeUnit.month,span:1,range:90},largeInterval:{unit:sap.gantt.config.TimeUnit.month,span:6,format:"MMMM yyyy"},smallInterval:{unit:sap.gantt.config.TimeUnit.month,span:1,format:sap.ui.getCore().getConfiguration().getRTL()?".d.M":"d.M."}},"2month":{innerInterval:{unit:sap.gantt.config.TimeUnit.month,span:2,range:90},largeInterval:{unit:sap.gantt.config.TimeUnit.month,span:6,format:"MMMM yyyy"},smallInterval:{unit:sap.gantt.config.TimeUnit.month,span:2,format:sap.ui.getCore().getConfiguration().getRTL()?".d.M":"d.M."}},"4month":{innerInterval:{unit:sap.gantt.config.TimeUnit.month,span:4,range:90},largeInterval:{unit:sap.gantt.config.TimeUnit.year,span:1,format:"yyyy"},smallInterval:{unit:sap.gantt.config.TimeUnit.month,span:4,format:"MMMM"}},"6month":{innerInterval:{unit:sap.gantt.config.TimeUnit.month,span:6,range:90},largeInterval:{unit:sap.gantt.config.TimeUnit.year,span:1,format:"yyyy"},smallInterval:{unit:sap.gantt.config.TimeUnit.month,span:6,format:"MMMM"}},"1year":{innerInterval:{unit:sap.gantt.config.TimeUnit.year,span:1,range:90},largeInterval:{unit:sap.gantt.config.TimeUnit.year,span:10,format:"yyyy"},smallInterval:{unit:sap.gantt.config.TimeUnit.year,span:1,format:"MMMM"}},"2year":{innerInterval:{unit:sap.gantt.config.TimeUnit.year,span:2,range:90},largeInterval:{unit:sap.gantt.config.TimeUnit.year,span:10,format:"yyyy"},smallInterval:{unit:sap.gantt.config.TimeUnit.year,span:2,format:"MMMM"}},"5year":{innerInterval:{unit:sap.gantt.config.TimeUnit.year,span:5,range:90},largeInterval:{unit:sap.gantt.config.TimeUnit.year,span:10,format:"yyyy"},smallInterval:{unit:sap.gantt.config.TimeUnit.year,span:5,format:"MMMM"}}};sap.gantt.config.DEFAULT_TIME_AXIS=new sap.gantt.config.TimeAxis();sap.gantt.config.DEFAULT_MODE_KEY="sap_mode";sap.gantt.config.DEFAULT_MODE=new sap.gantt.config.Mode({key:sap.gantt.config.DEFAULT_MODE_KEY,text:this._oRb.getText("TLTP_DEFAULT"),icon:"sap-icon://status-positive"});sap.gantt.config.DEFAULT_MODES=[sap.gantt.config.DEFAULT_MODE];sap.gantt.config.DEFAULT_CHART_SCHEME_KEY="sap_main";sap.gantt.config.DEFAULT_CHART_SCHEME=new sap.gantt.config.ChartScheme({key:sap.gantt.config.DEFAULT_CHART_SCHEME_KEY,name:"Default",rowSpan:1});sap.gantt.config.DEFAULT_CHART_SCHEMES=[sap.gantt.config.DEFAULT_CHART_SCHEME];sap.gantt.config.DEFAULT_OBJECT_TYPE_KEY="sap_object";sap.gantt.config.DEFAULT_OBJECT_TYPE=new sap.gantt.config.ObjectType({key:sap.gantt.config.DEFAULT_OBJECT_TYPE_KEY,description:"Default",mainChartSchemeKey:sap.gantt.config.DEFAULT_CHART_SCHEME_KEY});sap.gantt.config.DEFAULT_OBJECT_TYPES=[sap.gantt.config.DEFAULT_OBJECT_TYPE];sap.gantt.config.SETTING_ITEM_ENABLE_NOW_LINE_KEY="sap_enableNowLine";sap.gantt.config.SETTING_ITEM_ENABLE_NOW_LINE=new sap.gantt.config.SettingItem({key:sap.gantt.config.SETTING_ITEM_ENABLE_NOW_LINE_KEY,checked:true,displayText:this._oRb.getText("XCKL_NOW_LINE"),tooltip:this._oRb.getText("TLTP_NOW_LINE")});sap.gantt.config.SETTING_ITEM_ENABLE_CURSOR_LINE_KEY="sap_enableCursorLine";sap.gantt.config.SETTING_ITEM_ENABLE_CURSOR_LINE=new sap.gantt.config.SettingItem({key:sap.gantt.config.SETTING_ITEM_ENABLE_CURSOR_LINE_KEY,checked:true,displayText:this._oRb.getText("XCKL_CURSOR_LINE"),tooltip:this._oRb.getText("TLTP_CURSOR_LINE")});sap.gantt.config.SETTING_ITEM_ENABLE_VERTICAL_LINE_KEY="sap_enableVerticalLine";sap.gantt.config.SETTING_ITEM_ENABLE_VERTICAL_LINE=new sap.gantt.config.SettingItem({key:sap.gantt.config.SETTING_ITEM_ENABLE_VERTICAL_LINE_KEY,checked:true,displayText:this._oRb.getText("XCKL_VERTICAL_LINE"),tooltip:this._oRb.getText("TLTP_VERTICAL_LINE")});sap.gantt.config.SETTING_ITEM_ENABLE_TIME_SCROLL_SYNC_KEY="sap_enableTimeScrollSync";sap.gantt.config.SETTING_ITEM_ENABLE_TIME_SCROLL_SYNC=new sap.gantt.config.SettingItem({key:sap.gantt.config.SETTING_ITEM_ENABLE_TIME_SCROLL_SYNC_KEY,checked:true,displayText:this._oRb.getText("XCKL_TIME_SCROLL_SYNC"),tooltip:this._oRb.getText("TLTP_TIME_SCROLL_SYNC")});sap.gantt.config.SETTING_ITEM_ROW_SCROLL_SYNC_KEY="sap_enableRowScrollSync";sap.gantt.config.SETTING_ITEM_ROW_SCROLL_SYNC=new sap.gantt.config.SettingItem({key:sap.gantt.config.SETTING_ITEM_ROW_SCROLL_SYNC_KEY,checked:false,displayText:this._oRb.getText("XCKL_ROW_SCROLL_SYNC"),tooltip:this._oRb.getText("TLTP_ROW_SCROLL_SYNC")});sap.gantt.config.DEFAULT_TOOLBAR_SETTING_ITEMS=[sap.gantt.config.SETTING_ITEM_ENABLE_NOW_LINE,sap.gantt.config.SETTING_ITEM_ENABLE_CURSOR_LINE,sap.gantt.config.SETTING_ITEM_ENABLE_VERTICAL_LINE,sap.gantt.config.SETTING_ITEM_ENABLE_TIME_SCROLL_SYNC,sap.gantt.config.SETTING_ITEM_ROW_SCROLL_SYNC];sap.gantt.config.EMPTY_TOOLBAR_SCHEME_KEY="sap_empty_toolbar";sap.gantt.config.EMPTY_TOOLBAR_SCHEME=new sap.gantt.config.ToolbarScheme({key:sap.gantt.config.EMPTY_TOOLBAR_SCHEME_KEY,customToolbarItems:new sap.gantt.config.ToolbarGroup({position:"L1",overflowPriority:sap.m.OverflowToolbarPriority.High})});sap.gantt.config.DEFAULT_CONTAINER_TOOLBAR_SCHEME_KEY="sap_container_toolbar";sap.gantt.config.DEFAULT_CONTAINER_TOOLBAR_SCHEME=new sap.gantt.config.ToolbarScheme({key:sap.gantt.config.DEFAULT_CONTAINER_TOOLBAR_SCHEME_KEY,customToolbarItems:new sap.gantt.config.ToolbarGroup({position:"L1",overflowPriority:sap.m.OverflowToolbarPriority.High}),timeZoom:new sap.gantt.config.ToolbarGroup({position:"R2",overflowPriority:sap.m.OverflowToolbarPriority.NeverOverflow}),settings:new sap.gantt.config.SettingGroup({position:"R1",overflowPriority:sap.m.OverflowToolbarPriority.Low,items:sap.gantt.config.DEFAULT_TOOLBAR_SETTING_ITEMS})});sap.gantt.config.DEFAULT_GANTTCHART_TOOLBAR_SCHEME_KEY="sap_ganttchart_toolbar";sap.gantt.config.DEFAULT_GANTTCHART_TOOLBAR_SCHEME=new sap.gantt.config.ToolbarScheme({key:sap.gantt.config.DEFAULT_GANTTCHART_TOOLBAR_SCHEME_KEY,customToolbarItems:new sap.gantt.config.ToolbarGroup({position:"L2",overflowPriority:sap.m.OverflowToolbarPriority.High}),expandTree:new sap.gantt.config.ToolbarGroup({position:"L3",overflowPriority:sap.m.OverflowToolbarPriority.Low})});sap.gantt.config.DEFAULT_GANTTCHART_TOOLBAR_SCHEMES=[sap.gantt.config.DEFAULT_GANTTCHART_TOOLBAR_SCHEME,sap.gantt.config.EMPTY_TOOLBAR_SCHEME];sap.gantt.config.DEFAULT_CONTAINER_TOOLBAR_SCHEMES=[sap.gantt.config.DEFAULT_CONTAINER_TOOLBAR_SCHEME,sap.gantt.config.EMPTY_TOOLBAR_SCHEME];sap.gantt.config.DEFAULT_HIERARCHY_KEY="sap_hierarchy";sap.gantt.config.DEFAULT_HIERARCHY=new sap.gantt.config.Hierarchy();sap.gantt.config.DEFAULT_HIERARCHYS=[sap.gantt.config.DEFAULT_HIERARCHY];sap.gantt.config.DEFAULT_CONTAINER_SINGLE_LAYOUT_KEY="sap_container_layout_single";sap.gantt.config.DEFAULT_CONTAINER_SINGLE_LAYOUT=new sap.gantt.config.ContainerLayout({key:sap.gantt.config.DEFAULT_CONTAINER_SINGLE_LAYOUT_KEY,text:this._oRb.getText("XLST_SINGLE_LAYOUT"),toolbarSchemeKey:sap.gantt.config.DEFAULT_CONTAINER_TOOLBAR_SCHEME_KEY,ganttChartLayouts:[new sap.gantt.config.GanttChartLayout({activeModeKey:sap.gantt.config.DEFAULT_MODE_KEY,hierarchyKey:sap.gantt.config.DEFAULT_HIERARCHY_KEY})]});sap.gantt.config.DEFAULT_CONTAINER_DUAL_LAYOUT_KEY="sap_container_layout_dual";sap.gantt.config.DEFAULT_CONTAINER_DUAL_LAYOUT=new sap.gantt.config.ContainerLayout({key:sap.gantt.config.DEFAULT_CONTAINER_DUAL_LAYOUT_KEY,text:this._oRb.getText("XLST_DUAL_LAYOUT"),toolbarSchemeKey:sap.gantt.config.DEFAULT_CONTAINER_TOOLBAR_SCHEME_KEY,ganttChartLayouts:[new sap.gantt.config.GanttChartLayout({activeModeKey:sap.gantt.config.DEFAULT_MODE_KEY,hierarchyKey:sap.gantt.config.DEFAULT_HIERARCHY_KEY}),new sap.gantt.config.GanttChartLayout({activeModeKey:sap.gantt.config.DEFAULT_MODE_KEY,hierarchyKey:sap.gantt.config.DEFAULT_HIERARCHY_KEY})]});sap.gantt.config.DEFAULT_CONTAINER_LAYOUTS=[sap.gantt.config.DEFAULT_CONTAINER_SINGLE_LAYOUT,sap.gantt.config.DEFAULT_CONTAINER_DUAL_LAYOUT];sap.gantt.config.DEFAULT_LOCALE_CET=new sap.gantt.config.Locale({timeZone:"CET",utcdiff:"000000",utcsign:"+"});sap.gantt.config.DEFAULT_EMPTY_OBJECT={};return sap.gantt;});};if(!jQuery.sap.isDeclared('sap.gantt.misc.AxisOrdinal')){jQuery.sap.declare('sap.gantt.misc.AxisOrdinal');jQuery.sap.require('sap.ui.thirdparty.d3');sap.ui.define("sap/gantt/misc/AxisOrdinal",["sap/gantt/misc/Utility","sap/ui/thirdparty/d3"],function(){"use strict";var A=function(a,s,n,b,c,d,e,f){this.elementArray=a;this.scaleArray=s;this.padding=sap.gantt.misc.Utility.assign(f,0);this.zoomRate=sap.gantt.misc.Utility.assign(d,1);this.zoomOrigin=sap.gantt.misc.Utility.assign(e,0);this.viewRangeStart=sap.gantt.misc.Utility.assign(b,0);this.viewBandWidth=n;this.viewRangeEnd=c;this.scale=d3.scale.ordinal();this._createScale();};A.prototype.CONSTANT={C_SEPARATOR:"_@@_",C_MESSAGE:{ARGUMENT_ERROR:"AxisOrdinal: Argument Error!"}};A.prototype._createScale=function(){if(typeof(this.viewBandWidth)!=="undefined"){this.viewRangeEnd=undefined;this.scale.domain(this._calculateInternalValuesByElements()).rangeRoundBands(this._calculateViewRangeByViewBandWidth());}else if(typeof(this.viewRangeEnd)!=="undefined"){this.viewBandWidth=undefined;this.scale.domain(this._calculateInternalValuesByElements()).rangeRoundBands([this.viewRangeStart,this.viewRangeEnd]);}else{}};A.prototype._calculateInternalValuesByElements=function(){var v=[];for(var i=0;i<this.scaleArray.length;i++){var a=this.elementArray[i]+this.CONSTANT.C_SEPARATOR;for(var j=0;j<this.scaleArray[i];j++){v.push(a+j);}}return v;};A.prototype._calculateViewRangeByViewBandWidth=function(){var v=0;for(var i=0;i<this.scaleArray.length;i++){v+=this.scaleArray[i]*this.viewBandWidth;}return[this.viewRangeStart,this.viewRangeStart+v];};A.prototype.elementToView=function(e){return(this.scale(e+this.CONSTANT.C_SEPARATOR+0)+this.padding-this.zoomOrigin)*this.zoomRate;};A.prototype.viewToElement=function(v){var c=v/this.zoomRate+this.zoomOrigin;var h=0;var t=this.elementArray.length-1;while(h<t){var m=Math.ceil((h+t)/2);var a=this.scale(this.elementArray[m]+this.CONSTANT.C_SEPARATOR+0);if(c<a){t=m-1;}else{h=m;}}var r=this.elementArray[h];var b=this.scale(r+this.CONSTANT.C_SEPARATOR+0);if(c<b+this.padding||c>=b+this.scale.rangeBand()*this.scaleArray[h]){return undefined;}return r;};A.prototype.viewToElementIndex=function(v){var c=v/this.zoomRate+this.zoomOrigin;var h=0;var t=this.elementArray.length-1;while(h<t){var m=Math.ceil((h+t)/2);var a=this.scale(this.elementArray[m]+this.CONSTANT.C_SEPARATOR+0);if(c<a){t=m-1;}else{h=m;}}var r=this.elementArray[h];var b=this.scale(r+this.CONSTANT.C_SEPARATOR+0);if(c<b+this.padding||c>=b+this.scale.rangeBand()*this.scaleArray[h]){return-1;}return h;};A.prototype.viewToBandIndex=function(v){var c=v/this.zoomRate+this.zoomOrigin;var i=this._calculateInternalValuesByElements();var h=0;var t=i.length-1;while(h<t){var m=Math.ceil((h+t)/2);var a=this.scale(i[m]);if(c<a){t=m-1;}else{h=m;}}var r=this.scale(i[h]);if(c<r+this.padding||c>=r+this.scale.rangeBand()){return-1;}return h;};A.prototype.viewToRowIndex=function(v,m){var c=v/this.zoomRate+this.zoomOrigin;var h=0;var a=this._calculateViewRangeByViewBandWidth();if(c<=a[1]&&c>=a[0]){return this.viewToBandIndex(v);}else{var i=this._calculateInternalValuesByElements();if(jQuery.isNumeric(m)&&m>i.length){var b=parseInt((v-a[1]-a[0])/this.viewBandWidth,10);var r=b+i.length;h=r;}else{return-1;}}return h;};A.prototype.setElements=function(e,s){this.elementArray=e;this.scaleArray=s;this._createScale();return this;};A.prototype.getElementArray=function(){return this.elementArray;};A.prototype.getScaleArray=function(){return this.scaleArray;};A.prototype.setViewRangeStart=function(v){this.viewBandWidth=undefined;this.viewRangeStart=sap.gantt.misc.Utility.assign(v,0);this.scale.rangeRoundBands([this.viewRangeStart,this.viewRangeEnd]);return this;};A.prototype.setViewRangeEnd=function(v){this.viewBandWidth=undefined;this.viewRangeEnd=v;this.scale.rangeRoundBands([this.viewRangeStart,this.viewRangeEnd]);return this;};A.prototype.getViewRange=function(){var v=this.scale.rangeExtent();return[(v[0]-this.zoomOrigin)*this.zoomRate,(v[1]-this.zoomOrigin)*this.zoomRate];};A.prototype.setViewBandWidth=function(v){this.viewRangeEnd=undefined;this.viewBandWidth=v;this.scale.rangeRoundBands(this._calculateViewRangeByViewBandWidth());return this;};A.prototype.getViewBandWidth=function(){return this.scale.rangeBand()*this.zoomRate;};A.prototype.setZoomRate=function(z){this.zoomRate=sap.gantt.misc.Utility.assign(z,1);return this;};A.prototype.getZoomRate=function(){return this.zoomRate;};A.prototype.setZoomOrigin=function(z){this.zoomOrigin=sap.gantt.misc.Utility.assign(z,0);return this;};A.prototype.getZoomOrigin=function(){return this.zoomOrigin;};A.prototype.clone=function(){return new A(this.elementArray.slice(0),this.scaleArray.slice(0),this.viewBandWidth,this.viewRangeStart,this.viewRangeEnd,this.zoomRate,this.zoomOrigin,this.padding);};return A;},true);};if(!jQuery.sap.isDeclared('sap.gantt.misc.AxisTime')){jQuery.sap.declare('sap.gantt.misc.AxisTime');jQuery.sap.require('sap.ui.base.Object');jQuery.sap.require('sap.ui.thirdparty.d3');sap.ui.define("sap/gantt/misc/AxisTime",["sap/ui/base/Object","sap/gantt/misc/Utility","sap/ui/thirdparty/d3"],function(B){"use strict";var A=function(t,v,z,a,b,l,R,Z){this.scale=d3.time.scale().domain(t).range(v).clamp(false);this.timeRange=t;this.viewRange=v;this.zoomRate=sap.gantt.misc.Utility.assign(z,1);this.zoomOrigin=sap.gantt.misc.Utility.assign(a,0);this.viewOffset=sap.gantt.misc.Utility.assign(b,0);this.locale=l;var c=sap.ui.getCore().getConfiguration().getLanguage();this.language=c.toLowerCase();if(l&&l.getUtcdiff()){var f=d3.time.format("%Y%m%d%H%M%S");this.timeZoneOffset=Math.round((f.parse("20000101"+l.getUtcdiff()).getTime()-f.parse("20000101000000").getTime())/1000);if(l.getUtcsign()==="-"){this.timeZoneOffset=-this.timeZoneOffset;}}this.RTL=R;this._oZoomStrategy=Z?Z:sap.gantt.config.DEFAULT_TIME_ZOOM_STRATEGY;};A.prototype.CONSTANT={C_SEPARATOR:"_@@_",C_MESSAGE:{ARGUMENT_ERROR:"AxisOrdinal: Argument Error!"}};A.prototype.timeToView=function(t){if(this.RTL!==true){return Math.round((this.scale(t)-this.zoomOrigin)*this.zoomRate-this.viewOffset);}else{return Math.round(this.viewRange[1]*this.zoomRate-(((this.scale(t)+this.zoomOrigin)*this.zoomRate)+this.viewOffset));}};A.prototype.viewToTime=function(v){if(this.RTL!==true){return this.scale.invert((v+this.viewOffset)/this.zoomRate+this.zoomOrigin);}else{return this.scale.invert(this.viewRange[1]-(v+this.viewOffset)/this.zoomRate-this.zoomOrigin);}};A.prototype.setTimeRange=function(t){this.timeRange=t;this.scale.domain(t);return this;};A.prototype.getTimeRange=function(){return this.scale.domain();};A.prototype.setViewRange=function(v){this.viewRange=v;this.scale.range(v);return this;};A.prototype.getViewRange=function(){var r=this.scale.range();return[Math.round((r[0]-this.zoomOrigin)*this.zoomRate-this.viewOffset),Math.round((r[1]-this.zoomOrigin)*this.zoomRate-this.viewOffset)];};A.prototype.getZoomStrategy=function(){return this._oZoomStrategy;};A.prototype.setZoomRate=function(z){this.zoomRate=sap.gantt.misc.Utility.assign(z,1);return this;};A.prototype.getZoomRate=function(){return this.zoomRate;};A.prototype.setZoomOrigin=function(z){this.zoomOrigin=sap.gantt.misc.Utility.assign(z,0);return this;};A.prototype.getZoomOrigin=function(){return this.zoomOrigin;};A.prototype.setViewOffset=function(v){this.viewOffset=sap.gantt.misc.Utility.assign(v,0);return this;};A.prototype.getViewOffset=function(){return this.viewOffset;};A.prototype.setLocale=function(l){this.locale=l;if(l&&l.getUtcdiff()){var f=d3.time.format("%Y%m%d%H%M%S");this.timeZoneOffset=Math.round((f.parse("20000101"+l.getUtcdiff()).getTime()-f.parse("20000101000000").getTime())/1000);if(l.getUtcsign()==="-"){this.timeZoneOffset=-this.timeZoneOffset;}}return this;};A.prototype.getLocale=function(){return this.locale;};A.prototype.clone=function(){return new A([new Date(this.timeRange[0].valueOf()),new Date(this.timeRange[1].valueOf())],this.viewRange.slice(0),this.zoomRate,this.zoomOrigin,this.viewOffset,this.locale,this.RTL);};A.prototype.getCurrentTickTimeIntervalLevel=function(){var s=d3.time.format("%Y%m%d%H%M%S").parse("20000101000000");var a=this.scale(s);var c=0;for(var i in this._oZoomStrategy){var b=this._oZoomStrategy[i].innerInterval;var e=this.scale(jQuery.sap.getObject(b.unit).offset(s,b.span));var r=(e-a)*this.zoomRate;if(r>b.range){return c;}c++;}return c-1;};A.prototype.getCurrentTickTimeIntervalKey=function(){var s=d3.time.format("%Y%m%d%H%M%S").parse("20000101000000");var a=this.scale(s);var c;for(var i in this._oZoomStrategy){var b=this._oZoomStrategy[i].innerInterval;var e=this.scale(jQuery.sap.getObject(b.unit).offset(s,b.span));var r=(e-a)*this.zoomRate;if(r>b.range){c=i;break;}}return c;};A.prototype.getNowLabel=function(){var d=new Date();var u=new Date(d.getTime()+(d.getTimezoneOffset()*60000));var v=this.timeToView(u);var l=d3.time.second.offset(u,this.timeZoneOffset);var a=this.getTimeLabel(this.language,this._oZoomStrategy[this.getCurrentTickTimeIntervalKey()].smallInterval.format,l);return[{"date":l,"value":Math.round(v),"label":a}];};A.prototype.getTickTimeIntervalLabel=function(l,t,v){var i;var a=l;if(typeof l==="number"){var c=0;for(i in this._oZoomStrategy){if(c===l){a=i;break;}c++;}}var p,b;var e=null;if(this.locale&&this.locale.getDstHorizons().length>0){e=this.locale.getDstHorizons();}var f=d3.time.format("%Y%m%d%H%M%S");var g=[];if(e){for(i=0;i<e.length;i++){g[i]={};p=e[i].getStartTime();b=e[i].getEndTime();g[i].startDate=f.parse(p);g[i].endDate=f.parse(b);}}var h=this.timeZoneOffset?[d3.time.second.offset(this.timeRange[0],this.timeZoneOffset),d3.time.second.offset(this.timeRange[1],this.timeZoneOffset)]:this.timeRange;var j=new sap.gantt.misc.AxisTime(h,this.viewRange,this.zoomRate,this.zoomOrigin,this.viewOffset,null,this.RTL);var k=null;var m=null;var n=null;var o=null;var q=null;var r=null;var u=null;var w=[];var x=[];var y=null;if(t){r=this.timeZoneOffset?d3.time.second.offset(t[0],this.timeZoneOffset):t[0];u=this.timeZoneOffset?d3.time.second.offset(t[1],this.timeZoneOffset):t[1];k=this.timeZoneOffset?[d3.time.second.offset(t[0],this.timeZoneOffset),d3.time.second.offset(t[1],this.timeZoneOffset)]:t;m=[this.timeToView(t[0]),this.timeToView(t[1])];if(g&&g.length){this._calculateTimeRange(g,r,u,w);}y=this._calculateScale(w,x,k,m,false);}else if(v){r=this.timeZoneOffset?d3.time.second.offset(this.viewToTime(v[0]),this.timeZoneOffset):this.viewToTime(v[0]);u=this.timeZoneOffset?d3.time.second.offset(this.viewToTime(v[1]),this.timeZoneOffset):this.viewToTime(v[1]);k=[r,u];m=v;if(g.length){this._calculateTimeRange(g,r,u,w);}y=this._calculateScale(w,x,k,m,false);}else{r=h[0];u=h[1];k=h;m=this.viewRange;if(g.length){this._calculateTimeRange(g,r,u,w);}y=this._calculateScale(w,x,k,m,h);}x=y.viewRangeSet;n=y.visibleScale;o=y.dstScale;q=y.normalScale;var z=[];var C,D,E,F;var G=this._oZoomStrategy[a].largeInterval;var H=this._oZoomStrategy[a].smallInterval;var I,J;if(G){var K=[];var L=[];var M=[];if(!(n instanceof Array)){K[0]=n.ticks(jQuery.sap.getObject(G.unit).range,G.span);}else{for(I=0;I<o.length;I++){L[I]=o[I].ticks(jQuery.sap.getObject(G.unit).range,G.span);M[I]=q[I].ticks(jQuery.sap.getObject(G.unit).range,G.span);}for(I=0;I<n.length;I++){K[I]=n[I].ticks(jQuery.sap.getObject(G.unit).range,G.span);}}var N=[];if(K[0]!==null){for(I=0;I<K.length;I++){for(J=0;J<K[I].length;J++){C=K[I][J];E=j.timeToView(C);F=this.getTimeLabel(this.language,G.format,C);N.push({"date":C,"value":Math.round(E),"label":F});}}}if(L[0]!==null){for(I=0;I<L.length;I++){for(J=0;J<L[I].length;J++){C=L[I][J];D=M[I][J];E=j.timeToView(d3.time.second.offset(C.getTime(),-60*60));F=this.getTimeLabel(this.language,G.format,C);N.push({"date":C,"value":Math.round(E),"label":F});}}}z.push(N);}else{z.push([]);}if(H){var O=[];var P=[];var Q=[];if(!(n instanceof Array)){Q[0]=n.ticks(jQuery.sap.getObject(H.unit).range,H.span);}else{for(I=0;I<o.length;I++){O[I]=o[I].ticks(jQuery.sap.getObject(H.unit).range,H.span);P[I]=q[I].ticks(jQuery.sap.getObject(H.unit).range,H.span);}for(I=0;I<n.length;I++){Q[I]=n[I].ticks(jQuery.sap.getObject(H.unit).range,H.span);}}var R=[];if(Q[0]){for(I=0;I<Q.length;I++){for(J=0;J<Q[I].length;J++){C=Q[I][J];var S;var T=false;if(g.length){for(var d=0;d<g.length;d++){if(C.getTime()===g[d].startDate.getTime()){S=d3.time.second.offset(C.getTime(),60*60);if((J===Q[I].length-1)&&(a==="1hour"||a==="30min"||a==="15min"||a==="10min"||a==="5min")){T=true;}}if((J===Q[I].length-1)&&(C.getTime()===d3.time.second.offset(g[d].endDate.getTime(),60*60).getTime())){S=d3.time.second.offset(C.getTime(),-60*60);}}}E=j.timeToView(C);if(T){break;}else if(S){F=this.getTimeLabel(this.language,H.format,S);S=null;}else{F=this.getTimeLabel(this.language,H.format,C);}R.push({"date":C,"value":Math.round(E),"label":F});}}}if(O[0]){for(I=0;I<O.length;I++){for(J=0;J<O[I].length;J++){C=O[I][J];D=P[I][J];var U;var V=false;if((J===O[I].length-1)&&(a==="1hour"||a==="30min"||a==="15min"||a==="10min"||a==="5min")){if(w.length>0){for(var W=0;W<w.length;W++){if((!w[W].haveDST)&&(D.getTime()===w[W].range[0].getTime())){V=true;}}}}if(g.length){for(var s=0;s<g.length;s++){if(C.getTime()===g[s].startDate.getTime()){U=d3.time.second.offset(C.getTime(),60*60);}if((J===O[I].length-1)&&(C.getTime()===d3.time.second.offset(g[s].endDate.getTime(),60*60).getTime())){U=d3.time.second.offset(C.getTime(),-60*60);}}}if(a!=="1hour"&&a!=="30min"&&a!=="15min"&&a!=="10min"&&a!=="5min"){E=j.timeToView(d3.time.second.offset(C.getTime(),-60*60));}else{E=j.timeToView(D);}if(V){break;}else if(U){F=this.getTimeLabel(this.language,H.format,U);U=null;}else{F=this.getTimeLabel(this.language,H.format,C);}R.push({"date":C,"value":Math.round(E),"label":F});}}}z.push(R);}else{z.push([]);}return z;};A.prototype._calculateScale=function(a,v,b,c,l){var d=null;var e=[];var n=[];if(a.length){d=[];var f=0;var g=0;for(var t=0;t<a.length;t++){v[t]=[this.timeToView(a[t].range[0]),this.timeToView(a[t].range[1])];if(a[t].haveDST){e[f]=new sap.gantt.misc.AxisTime(a[t].dstRange,v[t],this.zoomRate,this.zoomOrigin,this.viewOffset,null,this.RTL).scale;n[f]=new sap.gantt.misc.AxisTime(a[t].range,v[t],this.zoomRate,this.zoomOrigin,this.viewOffset,null,this.RTL).scale;f++;}else{d[g]=new sap.gantt.misc.AxisTime(a[t].range,v[t],this.zoomRate,this.zoomOrigin,this.viewOffset,null,this.RTL).scale;g++;}}}else if(l){d=new sap.gantt.misc.AxisTime(l,this.viewRange,this.zoomRate,this.zoomOrigin,this.viewOffset,null,this.RTL).scale;}else{d=new sap.gantt.misc.AxisTime(b,c,this.zoomRate,this.zoomOrigin,this.viewOffset,null,this.RTL).scale;}var r={"viewRangeSet":v,"visibleScale":d,"dstScale":e,"normalScale":n};return r;};A.prototype._calculateTimeRange=function(d,s,e,a){if(d.length){var b=s;var c=e;var f=[];var g=[];var h,i;h=d[0].startDate;i=d[0].endDate;this._calculateRangeItem(h,i,b,c,f,g);if(d.length>1){for(var j=1;j<d.length;j++){if(f.length){var r=[];for(var k in f){r.push(f[k]);}f=[];for(var t=0;t<r.length;t++){h=d[j].startDate;i=d[j].endDate;b=r[t].range[0];c=r[t].range[1];this._calculateRangeItem(h,i,b,c,f,g);}}}}for(var l in g){a.push(g[l]);}for(var m in f){a.push(f[m]);}}};A.prototype._calculateRangeItem=function(d,a,s,e,t,b){var r=null;if(s<d){if(e<a){if(e>d){r={};r.haveDST=false;r.range=[s,d];t.push(r);r={};r.haveDST=true;r.range=[d,e];r.dstRange=[d3.time.second.offset(d.getTime(),60*60),d3.time.second.offset(e,60*60)];b.push(r);}else{r={};r.haveDST=false;r.range=[s,e];t.push(r);}}else{r={};r.haveDST=false;r.range=[s,d];t.push(r);r={};r.haveDST=true;r.range=[d,a];r.dstRange=[d3.time.second.offset(d.getTime(),60*60),d3.time.second.offset(a.getTime(),60*60)];b.push(r);r={};r.haveDST=false;r.range=[a,e];t.push(r);}}else if(s>=d){if(s<a){if(e<=a){r={};r.haveDST=true;r.range=[s,e];r.dstRange=[d3.time.second.offset(s,60*60),d3.time.second.offset(e,60*60)];b.push(r);}else{r={};r.haveDST=true;r.range=[s,a];r.dstRange=[d3.time.second.offset(s,60*60),d3.time.second.offset(a.getTime(),60*60)];b.push(r);r={};r.haveDST=false;r.range=[a,e];t.push(r);}}else{r={};r.haveDST=false;r.range=[s,e];t.push(r);}}};A.prototype.getTimeLabel=function(l,f,d){var F=sap.ui.core.format.DateFormat.getDateTimeInstance({pattern:f},new sap.ui.core.Locale(l));return F.format(d);};return A;},true);};if(!jQuery.sap.isDeclared('sap.gantt.shape.Circle')){jQuery.sap.declare('sap.gantt.shape.Circle');sap.ui.define("sap/gantt/shape/Circle",["sap/gantt/shape/Shape"],function(S){"use strict";var C=S.extend("sap.gantt.shape.Circle",{metadata:{properties:{tag:{type:"string",defaultValue:"circle"},cx:{type:"number"},cy:{type:"number"},r:{type:"number",defaultValue:5}}}});C.prototype.init=function(){var r=sap.ui.getCore().getLibraryResourceBundle("sap.gantt");this.setProperty("ariaLabel",r.getText("ARIA_CIRCLE"));};C.prototype.getCx=function(d,r){if(this.mShapeConfig.hasShapeProperty("cx")){return this._configFirst("cx",d);}return this.getRotationCenter(d,r)[0];};C.prototype.getCy=function(d,r){if(this.mShapeConfig.hasShapeProperty("cy")){return this._configFirst("cy",d);}return this.getRowYCenter(d,r);};C.prototype.getR=function(d){return this._configFirst("r",d,true);};return C;},true);};if(!jQuery.sap.isDeclared('sap.gantt.shape.ClipPath')){jQuery.sap.declare('sap.gantt.shape.ClipPath');sap.ui.define("sap/gantt/shape/ClipPath",["sap/gantt/shape/Shape"],function(S){"use strict";var C=S.extend("sap.gantt.shape.ClipPath",{metadata:{properties:{tag:{type:"string",defaultValue:"clippath"}},aggregations:{paths:{type:"sap.gantt.shape.Path",multiple:true,singularName:"path"}}}});return C;},true);};if(!jQuery.sap.isDeclared('sap.gantt.shape.Group')){jQuery.sap.declare('sap.gantt.shape.Group');sap.ui.define("sap/gantt/shape/Group",["sap/gantt/shape/Shape"],function(S){"use strict";var G=S.extend("sap.gantt.shape.Group",{metadata:{properties:{tag:{type:"string",defaultValue:"g"},RLSAnchors:{type:"array"}},aggregations:{shapes:{type:"sap.gantt.shape.Shape",multiple:true,singularName:"shape"}}}});G.prototype.getRLSAnchors=function(d){return this._configFirst("RLSAnchors",d);};return G;},true);};if(!jQuery.sap.isDeclared('sap.gantt.shape.Image')){jQuery.sap.declare('sap.gantt.shape.Image');jQuery.sap.require('sap.ui.core.Core');sap.ui.define("sap/gantt/shape/Image",["sap/gantt/shape/Shape","sap/gantt/misc/Utility","sap/gantt/misc/Format","sap/ui/core/Core"],function(S,U,F,C){"use strict";var I=S.extend("sap.gantt.shape.Image",{metadata:{properties:{tag:{type:"string",defaultValue:"image"},image:{type:"string"},x:{type:"number"},y:{type:"number"},width:{type:"number",defaultValue:20},height:{type:"number",defaultValue:20}}}});I.prototype.init=function(){var r=sap.ui.getCore().getLibraryResourceBundle("sap.gantt");this.setProperty("ariaLabel",r.getText("ARIA_IMAGE"));};I.prototype.getX=function(d,r){if(this.mShapeConfig.hasShapeProperty("x")){return this._configFirst("x",d);}var n,a=this.mChartInstance.getAxisTime();if(C.getConfiguration().getRTL()){if(this.getIsDuration(d,r)===true){n=a.timeToView(F.abapTimestampToDate(this.getEndTime(d,r)));}else{n=a.timeToView(F.abapTimestampToDate(this.getTime(d,r)));}return(n?n:0)-this.getWidth(d,r);}else{n=a.timeToView(F.abapTimestampToDate(this.getTime(d,r)));return n?n:0;}};I.prototype.getY=function(d,r){if(this.mShapeConfig.hasShapeProperty("y")){return this._configFirst("y",d);}return this.getRowYCenter(d,r)-this.getHeight(d,r)/2;};I.prototype.getImage=function(d){return this._configFirst("image",d);};I.prototype.getWidth=function(d){return this._configFirst("width",d,true);};I.prototype.getHeight=function(d){return this._configFirst("height",d,true);};return I;},true);};if(!jQuery.sap.isDeclared('sap.gantt.shape.Line')){jQuery.sap.declare('sap.gantt.shape.Line');sap.ui.define("sap/gantt/shape/Line",["sap/gantt/shape/Shape","sap/gantt/misc/Utility","sap/gantt/misc/Format"],function(S,U,F){"use strict";var L=S.extend("sap.gantt.shape.Line",{metadata:{properties:{tag:{type:"string",defaultValue:"line"},isDuration:{type:"boolean",defaultValue:true},x1:{type:"number"},y1:{type:"number"},x2:{type:"number"},y2:{type:"number"}}}});L.prototype.init=function(){var r=sap.ui.getCore().getLibraryResourceBundle("sap.gantt");this.setProperty("ariaLabel",r.getText("ARIA_LINE"));};L.prototype.getX1=function(d,r){if(this.mShapeConfig.hasShapeProperty("x1")){return this._configFirst("x1",d);}return this.mChartInstance.getAxisTime().timeToView(F.abapTimestampToDate(this.getTime(d,r)));};L.prototype.getY1=function(d,r){if(this.mShapeConfig.hasShapeProperty("y1")){return this._configFirst("y1",d,true);}return this.getRowYCenter(d,r);};L.prototype.getX2=function(d,r){if(this.mShapeConfig.hasShapeProperty("x2")){return this._configFirst("x2",d);}return this.mChartInstance.getAxisTime().timeToView(F.abapTimestampToDate(this.getEndTime(d,r)));};L.prototype.getY2=function(d,r){if(this.mShapeConfig.hasShapeProperty("y2")){return this._configFirst("y2",d,true);}return this.getRowYCenter(d,r);};return L;},true);};if(!jQuery.sap.isDeclared('sap.gantt.shape.Path')){jQuery.sap.declare('sap.gantt.shape.Path');sap.ui.define("sap/gantt/shape/Path",["sap/gantt/shape/Shape","sap/gantt/misc/Utility"],function(S,U){"use strict";var P=S.extend("sap.gantt.shape.Path",{metadata:{properties:{tag:{type:"string",defaultValue:"path"},isClosed:{type:"boolean",defaultValue:false},fill:{type:"string",defaultValue:"none"},d:{type:"string"}}}});P.prototype.init=function(){var r=sap.ui.getCore().getLibraryResourceBundle("sap.gantt");this.setProperty("ariaLabel",r.getText("ARIA_PATH"));};P.prototype.getD=function(d,r){if(this.mShapeConfig.hasShapeProperty("d")){return this._configFirst("d",d);}var c=this._getCenter(d,r),i=this.getIsDuration(d,r),m=this.mChartInstance.getSapUiSizeClass();var n=U.scaleBySapUiSize(m,7.5);if(i){var e=this._getCenter(d,r,true);n=(e[0]-c[0])/2;}return"M "+c[0]+" "+c[1]+" c 0,"+-n+" "+n+","+-n+" "+n+",0 c 0,"+n+" "+n+","+n+" "+n+",0";};P.prototype.getIsClosed=function(d){return this._configFirst("isClosed",d);};return P;},true);};if(!jQuery.sap.isDeclared('sap.gantt.shape.Polygon')){jQuery.sap.declare('sap.gantt.shape.Polygon');sap.ui.define("sap/gantt/shape/Polygon",["sap/gantt/shape/Shape","sap/gantt/misc/Utility"],function(S,U){"use strict";var P=S.extend("sap.gantt.shape.Polygon",{metadata:{properties:{tag:{type:"string",defaultValue:"polygon"},points:{type:"string"}}}});P.prototype.init=function(){var r=sap.ui.getCore().getLibraryResourceBundle("sap.gantt");this.setProperty("ariaLabel",r.getText("ARIA_POLYGON"));};P.prototype.getPoints=function(d,r){if(this.mShapeConfig.hasShapeProperty("points")){return this._configFirst("points",d);}var m=this.mChartInstance.getSapUiSizeClass();var c=this.getRotationCenter(d,r),n=U.scaleBySapUiSize(m,8),a=U.scaleBySapUiSize(m,4),b=U.scaleBySapUiSize(m,4*Math.sqrt(3)),R=[];R.push([c[0]-b,c[1]-a].join(","));R.push([c[0],c[1]-n].join(","));R.push([c[0]+b,c[1]-a].join(","));R.push([c[0]+b,c[1]+a].join(","));R.push([c[0],c[1]+n].join(","));R.push([c[0]-b,c[1]+a].join(","));return R.join(" ");};return P;},true);};if(!jQuery.sap.isDeclared('sap.gantt.shape.Polyline')){jQuery.sap.declare('sap.gantt.shape.Polyline');sap.ui.define("sap/gantt/shape/Polyline",["sap/gantt/shape/Shape","sap/gantt/misc/Utility"],function(S,U){"use strict";var P=S.extend("sap.gantt.shape.Polyline",{metadata:{properties:{tag:{type:"string",defaultValue:"polyline"},fill:{type:"string",defaultValue:"none"},points:{type:"string"}}}});P.prototype.init=function(){var r=sap.ui.getCore().getLibraryResourceBundle("sap.gantt");this.setProperty("ariaLabel",r.getText("ARIA_CIRCLE"));};P.prototype.getPoints=function(d,r){if(this.mShapeConfig.hasShapeProperty("points")){return this._configFirst("points",d);}var c=this.getRotationCenter(d,r),R=[];var m=this.mChartInstance.getSapUiSizeClass();R.push([c[0]-15,c[1]].join(","));R.push([c[0]-10,c[1]].join(","));R.push([c[0]-5,c[1]-U.scaleBySapUiSize(m,7.5)].join(","));R.push([c[0]+5,c[1]+U.scaleBySapUiSize(m,7.5)].join(","));R.push([c[0]+10,c[1]].join(","));R.push([c[0]+15,c[1]].join(","));return R.join(" ");};return P;},true);};if(!jQuery.sap.isDeclared('sap.gantt.shape.Rectangle')){jQuery.sap.declare('sap.gantt.shape.Rectangle');jQuery.sap.require('sap.ui.core.Core');sap.ui.define("sap/gantt/shape/Rectangle",["sap/gantt/shape/Shape","sap/gantt/misc/Utility","sap/gantt/misc/Format","sap/ui/core/Core"],function(S,U,F,C){"use strict";var R=S.extend("sap.gantt.shape.Rectangle",{metadata:{properties:{tag:{type:"string",defaultValue:"rect"},isDuration:{type:"boolean",defaultValue:true},x:{type:"number"},y:{type:"number"},width:{type:"number"},height:{type:"number",defaultValue:15},rx:{type:"string",defaultValue:"1"},ry:{type:"string",defaultValue:"1"}}}});R.prototype.init=function(){var r=sap.ui.getCore().getLibraryResourceBundle("sap.gantt");this.setProperty("ariaLabel",r.getText("ARIA_RECTANGLE"));};R.prototype.getX=function(d,r){if(this.mShapeConfig.hasShapeProperty("x")){return this._configFirst("x",d);}var n;var a=this.getStrokeWidth(d,r);var A=this.mChartInstance.getAxisTime();if(C.getConfiguration().getRTL()){n=A.timeToView(F.abapTimestampToDate(this.getEndTime(d,r)));}else{n=A.timeToView(F.abapTimestampToDate(this.getTime(d,r)));}return(n?n:0)+(a?a:0)/2;};R.prototype.getY=function(d,r){if(this.mShapeConfig.hasShapeProperty("y")){return this._configFirst("y",d,true);}return this.getRowYCenter(d,r)-this.getHeight(d,r)/2-this.getStrokeWidth(d,r)/2;};R.prototype.getWidth=function(d,r){if(this.mShapeConfig.hasShapeProperty("width")){return this._configFirst("width",d);}var n,s=this.getStrokeWidth(d,r),a=this.getTime(d,r),e=this.getEndTime(d,r),A=this.mChartInstance.getAxisTime();if(C.getConfiguration().getRTL()){n=A.timeToView(F.abapTimestampToDate(a))-A.timeToView(F.abapTimestampToDate(e))-s-1;}else{n=A.timeToView(F.abapTimestampToDate(e))-A.timeToView(F.abapTimestampToDate(a))-s-1;}if(n===0||n<0||!n){n=1;}return n;};R.prototype.getHeight=function(d){return this._configFirst("height",d,true);};R.prototype.getRx=function(d){return this._configFirst("rx",d);};R.prototype.getRy=function(d){return this._configFirst("ry",d);};return R;},true);};if(!jQuery.sap.isDeclared('sap.gantt.shape.SelectedShape')){jQuery.sap.declare('sap.gantt.shape.SelectedShape');jQuery.sap.require('sap.ui.core.Core');sap.ui.define("sap/gantt/shape/SelectedShape",["sap/gantt/shape/Path","sap/gantt/misc/Utility","sap/gantt/misc/Format","sap/ui/core/Core"],function(P,U,F,C){"use strict";var S=P.extend("sap.gantt.shape.SelectedShape",{metadata:{properties:{fill:{type:"string",defaultValue:"none"},fillOpacity:{type:"float",defaultValue:0},strokeOpacity:{type:"float",defaultValue:0},height:{type:"int",defaultValue:15}}}});S.prototype.getD=function(d,R){var s,x,a,y,b;var p="";var c=this.getParent().getTag();switch(c){case"rect":case"image":s=this.getStrokeWidth(d,R);x=this.getParent().getX(d,R)-s/2;y=this.getParent().getY(d,R)-s/2;a=x+this.getParent().getWidth(d,R)+s;b=y+this.getParent().getHeight(d)+s;p="M "+x+" "+y+" L "+a+" "+y+" L "+a+" "+b+" L "+x+" "+b+" z";break;case"line":s=this.getStrokeWidth(d,R);x=this.getParent().getX1(d,R)-s/2;y=this.getParent().getY1(d,R)-s/2;a=this.getParent().getX2(d,R)+s;b=this.getParent().getY2(d,R)+s;p="M "+x+" "+y+" L "+a+" "+y+" L "+a+" "+b+" L "+x+" "+b+" z";break;case"path":p=this.getParent().getD(d,R);break;case"clippath":p=this.getParent().getPaths()[0].getD(d,R);break;case"polygon":case"polyline":var j=this.getParent().getPoints(d,R);var k=j.split(" ");if(k!==undefined&&k[0]==""){k.splice(0,1);}if(k!==undefined&&k.length>1){p="M ";var l;for(var i in k){l=k[i].split(",");if(k[i]!==""&&l.length>1){if(i==k.length-1){if(c==="polygon"){p=p+l[0]+" "+l[1]+" z";}else{p=p+l[0]+" "+l[1];}}else{p=p+l[0]+" "+l[1]+" L ";}}}}break;case"circle":var m,n,r;m=this.getParent().getCx(d,R);n=this.getParent().getCy(d,R);r=this.getParent().getR(d);p="M "+m+" "+n+" A "+r+" "+r+", 0, 1, 1, "+m+" "+n;break;case"text":break;default:var w;var e=this.getParent().getStrokeWidth(d,R);s=this.getStrokeWidth(d,R);var f=this.getParent().getTime(d,R);var g=this.getParent().getEndTime(d,R);var A=this.getParent().mChartInstance.getAxisTime();var h=this.getHeight(d)+s;if(C.getConfiguration().getRTL()){x=A.timeToView(F.abapTimestampToDate(g));a=A.timeToView(F.abapTimestampToDate(f));}else{x=A.timeToView(F.abapTimestampToDate(f));a=A.timeToView(F.abapTimestampToDate(g));}if(this.getParent().mShapeConfig.hasShapeProperty("y")){y=this.getParent()._configFirst("y",d)-s/2;}else{y=this.getParent().getRowYCenter(d,R)-h/2-s/2;}if(this.getParent().mShapeConfig.hasShapeProperty("width")){w=this.getParent()._configFirst("width",d)+s;}else{w=a-x-e-1+s;}if(w===0||w<0||!w){w=2;}a=x+w;b=y+h;p="M "+x+" "+y+" L "+a+" "+y+" L "+a+" "+b+" L "+x+" "+b+" z";break;}return p;};S.prototype.getStroke=function(d,r){return"red";};S.prototype.getFill=function(d,r){return"none";};S.prototype.getStrokeWidth=function(d,r){var s=this.getParent().getStrokeWidth(d,r);return s?s:2;};S.prototype.getTransform=function(d,r){return this.getParent().getTransform(d,r);};S.prototype.getEnableDnD=function(d,r){return false;};S.prototype.getEnableSelection=function(d,r){return false;};S.prototype.getHeight=function(d){return this._configFirst("height",d,true);};return S;},true);};if(!jQuery.sap.isDeclared('sap.gantt.shape.cal.Calendar')){jQuery.sap.declare('sap.gantt.shape.cal.Calendar');sap.ui.define("sap/gantt/shape/cal/Calendar",["sap/gantt/shape/Rectangle"],function(R){"use strict";var C=R.extend("sap.gantt.shape.cal.Calendar",{metadata:{properties:{isBulk:{type:"boolean",defaultValue:true},enableSelection:{type:"boolean",defaultValue:false},calendarName:{type:"string",defaultValue:"nwt"}}}});C.prototype.init=function(){var r=sap.ui.getCore().getLibraryResourceBundle("sap.gantt");this.setProperty("ariaLabel",r.getText("ARIA_CALENDAR"));};C.prototype.getCalendarName=function(d){return this._configFirst("calendarName",d);};C.prototype.getIsBulk=function(d){if(this.mShapeConfig.isBulk){return this._configFirst("isBulk",d);}return true;};C.prototype.getEnableSelection=function(d){if(this.mShapeConfig.enableSelection){return this._configFirst("enableSelection",d);}return false;};C.prototype.getX=function(d){if(this.mShapeConfig.x){return this._configFirst("x",d);}return this.mChartInstance._oStatusSet.aViewBoundary[0];};C.prototype.getY=function(d,r){if(this.mShapeConfig.y){return this._configFirst("y",d);}return r.y;};C.prototype.getWidth=function(d){if(this.mShapeConfig.width){return this._configFirst("width",d);}var s=this.mChartInstance._oStatusSet;if(s){return s.aViewBoundary[1]-s.aViewBoundary[0];}else{return 0;}};C.prototype.getHeight=function(d,r){if(this.mShapeConfig.height){return this._configFirst("height",d);}return r.rowHeight;};C.prototype.getFill=function(d,r){if(this.mShapeConfig.hasShapeProperty("fill")){return this._configFirst("fill",d);}var c=this.getCalendarName(d,r);var p=this.mChartInstance.getCalendarDef();if(p){return p.getRefString(c);}};return C;},true);};if(!jQuery.sap.isDeclared('sap.gantt.shape.ext.Chevron')){jQuery.sap.declare('sap.gantt.shape.ext.Chevron');jQuery.sap.require('sap.ui.core.Core');sap.ui.define("sap/gantt/shape/ext/Chevron",["sap/gantt/shape/Path","sap/gantt/misc/Utility","sap/gantt/misc/Format","sap/ui/core/Core"],function(P,U,F,C){"use strict";var a=P.extend("sap.gantt.shape.ext.Chevron",{metadata:{properties:{isClosed:{type:"boolean",defaultValue:true},isDuration:{type:"boolean",defaultValue:true},headLength:{type:"number",defaultValue:5},tailLength:{type:"number",defaultValue:5},height:{type:"number",defaultValue:15}}}});a.prototype.init=function(){this._isRTL=C.getConfiguration().getRTL();var r=sap.ui.getCore().getLibraryResourceBundle("sap.gantt");this.setProperty("ariaLabel",r.getText("ARIA_CHEVRON"));};a.prototype.getD=function(d,r){if(this.mShapeConfig.hasShapeProperty("d")){return this._configFirst("d",d);}var n=this.getHeight(d,r);var b=this.getHeadLength(d,r),c=this.getTailLength(d,r),n=this.getHeight(d,r),A=this.mChartInstance.getAxisTime();var e=A.timeToView(F.abapTimestampToDate(this.getTime(d,r)));var f=A.timeToView(F.abapTimestampToDate(this.getEndTime(d,r)));if(e<0){e=A.timeToView(0);}if(f<0){f=A.timeToView(0);}var g=this.getRowYCenter(d,r);return this.getDString({nStartOriginalX:e,nEndOriginalX:f,nTailLength:c,nHeadLength:b,nHeight:n,nRowYCenter:g});};a.prototype.getDString=function(c){var n=c.nHeight/2;if(this._isRTL){var b=c.nStartOriginalX-c.nTailLength;var d=c.nStartOriginalX-c.nEndOriginalX-c.nHeadLength;var d=(d>0)?d:1;var r="m "+b+" "+c.nRowYCenter+" l "+c.nTailLength+" -"+n+" l -"+d+" "+0+" l -"+c.nHeadLength+" "+n+" l "+c.nHeadLength+" "+n+" l "+d+" "+0+" z";}else{var b=c.nStartOriginalX+c.nTailLength;var d=c.nEndOriginalX-c.nStartOriginalX-c.nHeadLength;var d=(d>0)?d:1;var r="m "+b+" "+c.nRowYCenter+" l -"+c.nTailLength+" -"+n+" l "+d+" "+0+" l "+c.nHeadLength+" "+n+" l -"+c.nHeadLength+" "+n+" l -"+d+" "+0+" z";}return r;};a.prototype.getHeadLength=function(d){return this._configFirst("headLength",d,true);};a.prototype.getTailLength=function(d){return this._configFirst("tailLength",d,true);};a.prototype.getHeight=function(d){return this._configFirst("height",d,true);};return a;},true);};if(!jQuery.sap.isDeclared('sap.gantt.shape.ext.Cursor')){jQuery.sap.declare('sap.gantt.shape.ext.Cursor');sap.ui.define("sap/gantt/shape/ext/Cursor",["sap/gantt/shape/Path"],function(P){"use strict";var C=P.extend("sap.gantt.shape.ext.Cursor",{metadata:{properties:{isClosed:{type:"boolean",defaultValue:true},length:{type:"number",defaultValue:10},width:{type:"number",defaultValue:5},pointHeight:{type:"number",defaultValue:5}}}});C.prototype.init=function(){var r=sap.ui.getCore().getLibraryResourceBundle("sap.gantt");this.setProperty("ariaLabel",r.getText("ARIA_CURSOR"));};C.prototype.getD=function(d,r){if(this.mShapeConfig.hasShapeProperty("d")){return this._configFirst("d",d);}var n=this.getPointHeight(d,r);var a=this.getWidth(d,r);var b=this.getLength(d,r);var c=b/2;var e=this.getRotationCenter(d,r);return"M "+e.join(" ")+" m "+-c+" "+-(a+n)/2+" l "+b+" 0 l 0 "+a+" l -"+c+" "+n+" l -"+c+" -"+n+" z";};C.prototype.getLength=function(d){return this._configFirst("length",d,true);};C.prototype.getWidth=function(d){return this._configFirst("width",d,true);};C.prototype.getPointHeight=function(d){return this._configFirst("pointHeight",d,true);};return C;},true);};if(!jQuery.sap.isDeclared('sap.gantt.shape.ext.Diamond')){jQuery.sap.declare('sap.gantt.shape.ext.Diamond');sap.ui.define("sap/gantt/shape/ext/Diamond",["sap/gantt/shape/Path"],function(P){"use strict";var D=P.extend("sap.gantt.shape.ext.Diamond",{metadata:{properties:{isClosed:{type:"boolean",defaultValue:true},verticalDiagonal:{type:"number",defaultValue:12},horizontalDiagonal:{type:"number",defaultValue:12}}}});D.prototype.init=function(){var r=sap.ui.getCore().getLibraryResourceBundle("sap.gantt");this.setProperty("ariaLabel",r.getText("ARIA_DIAMOND"));};D.prototype.getD=function(d,r){if(this.mShapeConfig.hasShapeProperty("d")){return this._configFirst("d",d);}var h=this.getVerticalDiagonal(d,r)/2;var a=this.getHorizontalDiagonal(d,r)/2;var c=this.getRotationCenter(d,r);return"M "+c.join(" ")+" m "+-a+" 0"+" l "+a+" -"+h+" l "+a+" "+h+" l -"+a+" "+h+" z";};D.prototype.getVerticalDiagonal=function(d){return this._configFirst("verticalDiagonal",d,true);};D.prototype.getHorizontalDiagonal=function(d){return this._configFirst("horizontalDiagonal",d,true);};return D;},true);};if(!jQuery.sap.isDeclared('sap.gantt.shape.ext.Pentangle')){jQuery.sap.declare('sap.gantt.shape.ext.Pentangle');sap.ui.define("sap/gantt/shape/ext/Pentangle",["sap/gantt/shape/Polygon","sap/gantt/misc/Utility"],function(P,U){"use strict";var a=P.extend("sap.gantt.shape.ext.Pentangle",{metadata:{properties:{radius:{type:"number",defaultValue:10},radius2:{type:"number",defaultValue:undefined}}}});a.prototype.init=function(){var r=sap.ui.getCore().getLibraryResourceBundle("sap.gantt");this.setProperty("ariaLabel",r.getText("ARIA_PENTANGLE"));};a.prototype.getRadius=function(d){return this._configFirst("radius",d,true);};a.prototype.getRadius2=function(d,r){if(this.mShapeConfig.hasShapeProperty("radius2")){return this._configFirst("radius2",d,true);}var D=this.getProperty("radius2");if(D||D===0){var m=this.mChartInstance.getSapUiSizeClass();return U.scaleBySapUiSize(m,D);}else{return this.calRadius2ByGoldenRatio(this.getRadius(d,r));}};a.prototype.calRadius2ByGoldenRatio=function(n){return n*Math.cos(2*Math.PI/5)/Math.cos(Math.PI/5);};a.prototype.getPoints=function(d,r){if(this.mShapeConfig.hasShapeProperty("points")){return this._configFirst("points",d);}var c=this.getRotationCenter(d,r);var n=this.getRadius(d,r);var b=this.getRadius2(d,r);var p=this._generatePentaclePoints(c,n,b);return p.join("");};a.prototype._generatePentaclePoints=function(c,n,b){var p={},d=[],e=Math.PI/5,f=0;for(var i=0;i<10;i++){f=e*i;p.x=this._getPointX(c[0],(i%2==0)?n:b,f);p.y=this._getPointY(c[1],(i%2==0)?n:b,f);d.push(" "+p.x+","+p.y);}return d;};a.prototype._getPointX=function(n,b,c){return n+(b*Math.sin(c));};a.prototype._getPointY=function(n,b,c){return n-(b*Math.cos(c));};return a;},true);};if(!jQuery.sap.isDeclared('sap.gantt.shape.ext.RowBackgroundRectangle')){jQuery.sap.declare('sap.gantt.shape.ext.RowBackgroundRectangle');jQuery.sap.require('sap.ui.core.Core');sap.ui.define("sap/gantt/shape/ext/RowBackgroundRectangle",["sap/gantt/shape/Rectangle","sap/gantt/misc/Utility","sap/ui/core/Core"],function(R,U,C){"use strict";var a=R.extend("sap.gantt.shape.ext.RowBackgroundRectangle",{metadata:{properties:{isBulk:{type:"boolean",defaultValue:true},enableSelection:{type:"boolean",defaultValue:false}}}});a.prototype.getFill=function(d,r){if(this.mShapeConfig.hasShapeProperty("fill")){return this._configFirst("fill",d);}var c=this.mChartInstance._oChartSchemesConfigMap;var o=(c&&c[r.chartScheme])?c[r.chartScheme]:undefined;if(o&&o.getBackgroundColor()){return o.getBackgroundColor();}return"none";};a.prototype.getStrokeWidth=function(d,r){if(this.mShapeConfig.hasShapeProperty("strokeWidth")){return this._configFirst("strokeWidth",d);}return 0;};a.prototype.getX=function(d,r){if(this.mShapeConfig.hasShapeProperty("x")){return this._configFirst("x",d);}var v=this.getShapeViewBoundary();if(v){return v[0];}return 0;};a.prototype.getY=function(d,r){if(this.mShapeConfig.hasShapeProperty("y")){return this._configFirst("y",d);}return r.y+1;};a.prototype.getWidth=function(d,r){if(this.mShapeConfig.hasShapeProperty("width")){return this._configFirst("width",d);}var v=this.getShapeViewBoundary();if(v){return v[1]-v[0];}return 0;};a.prototype.getHeight=function(d,r){if(this.mShapeConfig.hasShapeProperty("height")){return this._configFirst("height",d);}return r.rowHeight-1;};a.prototype.filterValidData=function(r){if(r.length>0){var c=this.mChartInstance;var o=c._oChartSchemesConfigMap;var O=c._oObjectTypesConfigMap;return $.grep(r,function(v,i){var b;if(v.__group){b=(o&&o[v.__group])?o[v.__group]:undefined;}else{var d=(O&&O[v.type])?O[v.type]:undefined;if(d){b=(o&&o[d.getMainChartSchemeKey()])?o[d.getMainChartSchemeKey()]:undefined;}}if(b&&b.getBackgroundColor()){return v;}});}return r;};a.prototype.getHtmlClass=function(d,r){if(C.getConfiguration().getTheme()==="sap_hcb"){return true;}return false;};return a;},true);};if(!jQuery.sap.isDeclared('sap.gantt.shape.ext.Triangle')){jQuery.sap.declare('sap.gantt.shape.ext.Triangle');sap.ui.define("sap/gantt/shape/ext/Triangle",["sap/gantt/shape/Path"],function(P){"use strict";var T=P.extend("sap.gantt.shape.ext.Triangle",{metadata:{properties:{isClosed:{type:"boolean",defaultValue:true},base:{type:"number",defaultValue:10},height:{type:"number",defaultValue:10},distanceOfyAxisHeight:{type:"number",defaultValue:5}}}});T.prototype.init=function(){var r=sap.ui.getCore().getLibraryResourceBundle("sap.gantt");this.setProperty("ariaLabel",r.getText("ARIA_TRIANGLE"));};T.prototype.getD=function(d,r){if(this.mShapeConfig.hasShapeProperty("d")){return this._configFirst("d",d);}var n=this.getBase(d,r);var a=this.getHeight(d,r);var b=this.getDistanceOfyAxisHeight(d,r);var c=this.getHeight(d,r)/2;var C=this.getRotationCenter(d,r);return"M "+C.join(" ")+" m 0 "+c+" l -"+b+" 0 l "+b+" -"+a+" l "+Number(n-b)+" "+a+" l -"+Number(n-b)+" 0 z";};T.prototype.getBase=function(d){return this._configFirst("base",d,true);};T.prototype.getHeight=function(d){return this._configFirst("height",d,true);};T.prototype.getDistanceOfyAxisHeight=function(d){return this._configFirst("distanceOfyAxisHeight",d,true);};return T;},true);};if(!jQuery.sap.isDeclared('sap.gantt.shape.ext.rls.Relationship')){jQuery.sap.declare('sap.gantt.shape.ext.rls.Relationship');jQuery.sap.require('sap.ui.core.Core');sap.ui.define("sap/gantt/shape/ext/rls/Relationship",["sap/gantt/shape/Path","sap/ui/core/Core"],function(P,C){"use strict";var R=P.extend("sap.gantt.shape.ext.rls.Relationship",{metadata:{properties:{htmlClass:{type:"string",defaultValue:"relationshipLine"},category:{type:"string",defaultValue:sap.gantt.shape.ShapeCategory.Relationship},isClosed:{type:"boolean",defaultValue:true},isDuration:{type:"boolean",defaultValue:false},stroke:{type:"string",defaultValue:"#000000"},fill:{type:"string",defaultValue:"#000000"},type:{type:"number",defaultValue:0},fromObjectPath:{type:"string"},fromShapeId:{type:"string"},fromDataId:{type:"string"},toObjectPath:{type:"string"},toShapeId:{type:"string"},toDataId:{type:"string"},showStart:{type:"boolean",defaultValue:false},showEnd:{type:"boolean",defaultValue:true},lShapeforTypeFS:{type:"boolean",defaultValue:true},minXLen:{type:"number",defaultValue:10},arrowSideLength:{type:"number",defaultValue:5}},aggregations:{selectedShape:{type:"sap.gantt.shape.ext.rls.SelectedRelationship",multiple:false}}}});R.prototype.init=function(){this._isRTL=C.getConfiguration().getRTL();var r=sap.ui.getCore().getLibraryResourceBundle("sap.gantt");this.setProperty("ariaLabel",r.getText("ARIA_RELATIONSHIP"));};R.prototype.TYPE={fftype:0,fstype:1,sftype:2,sstype:3};R.prototype.getType=function(d){return this._configFirst("type",d);};R.prototype.getFromObjectPath=function(d){return this._configFirst("fromObjectPath",d);};R.prototype.getFromShapeId=function(d){return this._configFirst("fromShapeId",d);};R.prototype.getFromDataId=function(d){return this._configFirst("fromDataId",d);};R.prototype.getToObjectPath=function(d){return this._configFirst("toObjectPath",d);};R.prototype.getToShapeId=function(d){return this._configFirst("toShapeId",d);};R.prototype.getToDataId=function(d){return this._configFirst("toDataId",d);};R.prototype.getLShapeforTypeFS=function(d){return this._configFirst("lShapeforTypeFS",d);};R.prototype.getHtmlClass=function(d){return this._configFirst("htmlClass",d);};R.prototype.getShowStart=function(d){return this._configFirst("showStart",d);};R.prototype.getShowEnd=function(d){return this._configFirst("showEnd",d);};R.prototype.getD=function(d,r){var s=this.getShowEnd(d,r);var a=this.getShowStart(d,r);var x,y,b,c;var t;try{t=window.parseInt(this.getType(d,r));}catch(e){jQuery.sap.log.warning("invalid relationship type");}var l=this.getLShapeforTypeFS(d,r);var I=this.mChartInstance._getIdByShapeId(this.getFromShapeId(d,r.from.objectInfo.objectInfoRef));var p=sap.ui.getCore().byId(I).getRLSAnchors(r.from.shapeRawData,r.from.objectInfo);I=this.mChartInstance._getIdByShapeId(this.getToShapeId(d,r.from.objectInfo.objectInfoRef));var o=sap.ui.getCore().byId(I).getRLSAnchors(r.to.shapeRawData,r.to.objectInfo,l);if(this._isRTL){if(t===this.TYPE.fftype){x=p.startPoint.x;y=p.startPoint.y;b=o.startPoint.x;c=o.startPoint.y;}else if(t===this.TYPE.fstype){x=p.startPoint.x;y=p.startPoint.y;b=o.endPoint.x;c=o.endPoint.y;}else if(t===this.TYPE.sftype){x=p.endPoint.x;y=p.endPoint.y;b=o.startPoint.x;c=o.startPoint.y;}else if(t===this.TYPE.sstype){x=p.endPoint.x;y=p.endPoint.y;b=o.endPoint.x;c=o.endPoint.y;}}else if(t===this.TYPE.fftype){x=p.endPoint.x;y=p.endPoint.y;b=o.endPoint.x;c=o.endPoint.y;}else if(t===this.TYPE.fstype){x=p.endPoint.x;y=p.endPoint.y;b=o.startPoint.x;c=o.startPoint.y;}else if(t===this.TYPE.sftype){x=p.startPoint.x;y=p.startPoint.y;b=o.endPoint.x;c=o.endPoint.y;}else if(t===this.TYPE.sstype){x=p.startPoint.x;y=p.startPoint.y;b=o.startPoint.x;c=o.startPoint.y;}var S="";if(a){var f=this._calculateSquareCoordinate(t,x,y);S=S.concat("M").concat(f[0].x).concat(",").concat(f[0].y).concat(" ");var g=f.length;for(var i=1;i<g;i++){S=S.concat("L").concat(f[i].x).concat(",").concat(f[i].y).concat(" ");}}var h=this._calculateLineCoordinate(l,t,x,b,y,c,r.from.objectInfo,o.startPoint.height);S=S.concat("M").concat(h[0].x).concat(",").concat(h[0].y).concat(" ");var m=h.length;for(var j=0;j<m;j++){S=S.concat("L").concat(h[j].x).concat(",").concat(h[j].y).concat(" ");S=S.concat("M").concat(h[j].x).concat(",").concat(h[j].y).concat(" ");}if(s){var n=this._calculateArrowCoordinate(l,t,x,b,y,c,o.startPoint.height);var q=n.length;for(var k=0;k<q;k++){S=S.concat("L").concat(n[k].x).concat(",").concat(n[k].y).concat(" ");}}S=S.concat("Z");return S;};R.prototype._calculateSquareCoordinate=function(t,x,y){var s=[];if(t===this.TYPE.fftype||t===this.TYPE.fstype){if(this._isRTL){s=[x,y-2,x-3,y-2,x-3,y+1.5,x,y+1.5,x,y-2];}else{s=[x-1,y-2,x-1+3,y-2,x-1+3,y+1.5,x-1,y+1.5,x-1,y-2];}}else if(this._isRTL){s=[x-1,y-2,x-1+3,y-2,x-1+3,y+1.5,x-1,y+1.5,x-1,y-2];}else{s=[x,y-2,x-3,y-2,x-3,y+1.5,x,y+1.5,x,y-2];}var o=[];var a=s.length;for(var i=0;i<a;){o[o.length]={"x":s[i++],"y":s[i++]};}return o;};R.prototype._calculateLineCoordinate=function(l,t,x,a,y,b,f,s){var d=[];var r,c;if(y===b){d=d.concat([x,y,a,b]);}else{var k=this.getMinXLen();if(t===this.TYPE.fftype){if(this._isRTL){d=d.concat([x,y,Math.min(x,a)-k,y,Math.min(x,a)-k,b,a,b]);}else{d=d.concat([x-1,y,Math.max(x,a)+k,y,Math.max(x,a)+k,b,a,b]);}}else if(t===this.TYPE.fstype){if(l){if(this._isRTL){if(x>a){if(y<b){b=b-s/2;}else{b=b+s/2;}d=d.concat([x+1,y,a,y,a,b]);}else if(y<b){c=f.y+f.rowHeight;d=d.concat([x+1,y,x-k,y,x-k,c,a+k,c,a+k,b,a,b]);}else if(y>b){r=f.y;d=d.concat([x+1,y,x-k,y,x-k,r,a+k,r,a+k,b,a,b]);}}else if(x<=a){if(y<b){b=b-s/2;}else{b=b+s/2;}d=d.concat([x-1,y,a,y,a,b]);}else if(y<b){c=f.y+f.rowHeight;d=d.concat([x-1,y,x+k,y,x+k,c,a-k,c,a-k,b,a,b]);}else if(y>b){r=f.y;d=d.concat([x-1,y,x+k,y,x+k,r,a-k,r,a-k,b,a,b]);}}else if(this._isRTL){if(x-k>a){d=d.concat([x-1,y,x+k,y,x+k,b,a,b]);}else if(y<b){c=f.y+f.rowHeight;d=d.concat([x+1,y,x-k,y,x-k,c,a+k,c,a+k,b,a,b]);}else if(y>b){r=f.y-f.rowHeight;d=d.concat([x+1,y,x-k,y,x-k,r,a+k,r,a+k,b,a,b]);}}else if(x+k<=a){d=d.concat([x-1,y,x+k,y,x+k,b,a,b]);}else if(y<b){c=f.y+f.rowHeight;d=d.concat([x-1,y,x+k,y,x+k,c,a-k,c,a-k,b,a,b]);}else if(y>b){r=f.y-f.rowHeight;d=d.concat([x-1,y,x+k,y,x+k,r,a-k,r,a-k,b,a,b]);}}else if(t===this.TYPE.sftype){if(this._isRTL){if(x<a-k){d=d.concat([x,y,x+k,y,x+k,b,a,b]);}else if(y<b){c=f.y+f.rowHeight;d=d.concat([x,y,x+k,y,x+k,c,a-k,c,a-k,b,a,b]);}else if(y>b){r=f.y;d=d.concat([x,y,x+k,y,x+k,r,a-k,r,a-k,b,a,b]);}}else if(x>=a+k){d=d.concat([x,y,x-k,y,x-k,b,a,b]);}else if(y<b){c=f.y+f.rowHeight;d=d.concat([x,y,x-k,y,x-k,c,a+k,c,a+k,b,a,b]);}else if(y>b){r=f.y;d=d.concat([x,y,x-k,y,x-k,r,a+k,r,a+k,b,a,b]);}}else if(t===this.TYPE.sstype){if(this._isRTL){d=d.concat([x-1,y,Math.max(x,a)+k,y,Math.max(x,a)+k,b,a,b]);}else{d=d.concat([x,y,Math.min(x,a)-k,y,Math.min(x,a)-k,b,a,b]);}}}var o=[];var e=d.length;for(var i=0;i<e;){o[o.length]={"x":d[i++],"y":d[i++]};}return o;};R.prototype._calculateArrowCoordinate=function(l,t,x,a,y,b,s){var c=[];var d=this.getArrowSideLength();if(t===this.TYPE.fftype||t===this.TYPE.sftype){if(this._isRTL){c=[a-d*Math.pow(3,1/2)/2,b-d/2,a-d*Math.pow(3,1/2)/2,b+d/2];}else{c=[a+d*Math.pow(3,1/2)/2,b-d/2,a+d*Math.pow(3,1/2)/2,b+d/2];}}else if(t===this.TYPE.sstype){if(this._isRTL){c=[a+d*Math.pow(3,1/2)/2,b-d/2,a+d*Math.pow(3,1/2)/2,b+d/2];}else{c=[a-d*Math.pow(3,1/2)/2,b-d/2,a-d*Math.pow(3,1/2)/2,b+d/2];}}else if(l){if(this._isRTL){if(x>a){if(y<b){b=b-s/2;}else if(y>b){b=b+s/2;}else{}if(y<b){c=[a+d/2,b-d*Math.pow(3,1/2)/2,a-d/2,b-d*Math.pow(3,1/2)/2];}else if(y==b){c=[a+d*Math.pow(3,1/2)/2,b-d/2,a+d*Math.pow(3,1/2)/2,b+d/2];}else{c=[a+d/2,b+d*Math.pow(3,1/2)/2,a-d/2,b+d*Math.pow(3,1/2)/2];}}else{c=[a+d*Math.pow(3,1/2)/2,b-d/2,a+d*Math.pow(3,1/2)/2,b+d/2];}}else if(x<=a){if(y<b){b=b-s/2;}else if(y>b){b=b+s/2;}else{}if(y<b){c=[a-d/2,b-d*Math.pow(3,1/2)/2,a+d/2,b-d*Math.pow(3,1/2)/2];}else if(y==b){c=[a-d*Math.pow(3,1/2)/2,b-d/2,a-d*Math.pow(3,1/2)/2,b+d/2];}else{c=[a-d/2,b+d*Math.pow(3,1/2)/2,a+d/2,b+d*Math.pow(3,1/2)/2];}}else{c=[a-d*Math.pow(3,1/2)/2,b-d/2,a-d*Math.pow(3,1/2)/2,b+d/2];}}else if(this._isRTL){c=[a+d*Math.pow(3,1/2)/2,b-d/2,a+d*Math.pow(3,1/2)/2,b+d/2];}else{c=[a-d*Math.pow(3,1/2)/2,b-d/2,a-d*Math.pow(3,1/2)/2,b+d/2];}var o=[];var e=c.length;for(var i=0;i<e;){o[o.length]={"x":c[i++],"y":c[i++]};}return o;};return R;},true);};if(!jQuery.sap.isDeclared('sap.gantt.shape.ext.rls.SelectedRelationship')){jQuery.sap.declare('sap.gantt.shape.ext.rls.SelectedRelationship');sap.ui.define("sap/gantt/shape/ext/rls/SelectedRelationship",["sap/gantt/shape/ext/rls/Relationship"],function(R){"use strict";var S=R.extend("sap.gantt.shape.ext.rls.SelectedRelationship",{metadata:{properties:{stroke:{type:"string"},strokeWidth:{type:"int"}}}});S.prototype.getStroke=function(d){return"red";};S.prototype.getFill=function(d){return"red";};S.prototype.getStrokeWidth=function(d){return 2;};return S;},true);};if(!jQuery.sap.isDeclared('sap.gantt.shape.ext.ubc.UbcBorderPath')){jQuery.sap.declare('sap.gantt.shape.ext.ubc.UbcBorderPath');sap.ui.define("sap/gantt/shape/ext/ubc/UbcBorderPath",["sap/gantt/misc/Utility","sap/gantt/misc/Format","sap/gantt/shape/Path"],function(U,F,P){"use strict";var a=P.extend("sap.gantt.shape.ext.ubc.UbcBorderPath",{});a.prototype.getEnableSelection=function(d,r){if(this.mShapeConfig.hasShapeProperty("enableSelection")){return this._configFirst("enableSelection",d);}return false;};a.prototype.getD=function(d,r){if(this.mShapeConfig.hasShapeProperty("d")){return this._configFirst("d",d);}var b=d.period;var p="";if(b.length>0){var m=this._getMaxTotalRevised(d);var c=this._getMaxY(d,r);var e=r.rowHeight-1;var A=this.mChartInstance.getAxisTime();for(var i=0;i<b.length;i++){var x,f,y,g;x=A.timeToView(F.abapTimestampToDate(b[i].start_date)).toFixed(1);if(i<b.length-1){f=A.timeToView(F.abapTimestampToDate(b[i+1].start_date)).toFixed(1);}else{f=A.timeToView(F.abapTimestampToDate(b[i].start_date)).toFixed(1);}if(isNaN(x)||!x){x=A.timeToView(0).toFixed(1);}if(isNaN(f)||!f){x=A.timeToView(0).toFixed(1);}y=c-b[i].demand/m*e;y=y.toFixed(1);if(y<r.y){y=r.y;}if(i<b.length-1){g=c-b[i+1].demand/m*e;}else{f=A.timeToView(F.abapTimestampToDate(b[i].start_date)).toFixed(1);g=c-b[i].demand/m*e;}g=g.toFixed(1);if(g<r.y){g=r.y;}p+=" M "+x+" "+y+"L"+f+" "+y;p+=" M "+f+" "+y+"L"+f+" "+g;}}return p;};a.prototype.getStroke=function(d,r){if(this.mShapeConfig.hasShapeProperty("stroke")){return this._configFirst("stroke",d);}return"blue";};a.prototype.getStrokeWidth=function(d,r){if(this.mShapeConfig.hasShapeProperty("strokeWidth")){return this._configFirst("strokeWidth",d);}return 0.3;};a.prototype._getMaxY=function(d,r){var t=r.y;var b=r.rowHeight-1;var m=t+b;return m;};a.prototype._getMaxTotalRevised=function(d){var m=this._getMaxTotal(d);var b=m+this._getmaxExceedCap(d);return b;};a.prototype._getMaxTotal=function(d){var m=Math.max.apply(Math,d.period.map(function(o){return o.supply;}));if(m<=0){m=1;}return m;};a.prototype._getmaxExceedCap=function(d){var m=this._getMaxTotal(d);var b=25;if(this.mShapeConfig.hasShapeProperty("maxExceedCapacity")){b=this._configFirst("maxExceedCapacity",d);}return m*b/100;};return a;},true);};if(!jQuery.sap.isDeclared('sap.gantt.shape.ext.ubc.UbcPolygon')){jQuery.sap.declare('sap.gantt.shape.ext.ubc.UbcPolygon');sap.ui.define("sap/gantt/shape/ext/ubc/UbcPolygon",["sap/gantt/misc/Utility","sap/gantt/shape/Polygon"],function(U,P){"use strict";var a=P.extend("sap.gantt.shape.ext.ubc.UbcPolygon",{metadata:{"abstract":true}});a.prototype.getEnableSelection=function(d,r){if(this.mShapeConfig.hasShapeProperty("enableSelection")){return this._configFirst("enableSelection",d);}return false;};a.prototype._getMaxY=function(d,r){var t=r.y;var b=r.rowHeight-1;var m=t+b;return m;};a.prototype._getMaxTotal=function(d){var m=Math.max.apply(Math,d.period.map(function(o){return o.supply;}));if(m<=0){m=1;}return m;};a.prototype._getmaxExceedCap=function(d,t){var m;if(t){m=t;}else{m=this._getMaxTotal(d);}var b=25;if(this.mShapeConfig.hasShapeProperty("maxExceedCapacity")){b=this._configFirst("maxExceedCapacity",d);}return m*b/100;};a.prototype._getMaxTotalRevised=function(d){var m=this._getMaxTotal(d);var b=this._getmaxExceedCap(d,m)+m;return b;};return a;},true);};if(!jQuery.sap.isDeclared('sap.gantt.shape.ext.ubc.UbcShortageCapacityPolygon')){jQuery.sap.declare('sap.gantt.shape.ext.ubc.UbcShortageCapacityPolygon');sap.ui.define("sap/gantt/shape/ext/ubc/UbcShortageCapacityPolygon",["sap/gantt/misc/Utility","sap/gantt/misc/Format","sap/gantt/shape/ext/ubc/UbcPolygon"],function(U,F,a){"use strict";var b=a.extend("sap.gantt.shape.ext.ubc.UbcShortageCapacityPolygon",{});b.prototype.getFill=function(d,r){if(this.mShapeConfig.hasShapeProperty("fill")){return this._configFirst("fill",d);}return"#FF0000";};b.prototype.getStroke=function(d,r){if(this.mShapeConfig.hasShapeProperty("stroke")){return this._configFirst("stroke",d);}return"#CAC7BA";};b.prototype.getStrokeWidth=function(d,r){if(this.mShapeConfig.hasShapeProperty("strokeWidth")){return this._configFirst("strokeWidth",d);}return 0.3;};b.prototype.getPoints=function(d,r){if(this.mShapeConfig.hasShapeProperty("points")){return this._configFirst("points",d);}var o="";var m=this._getMaxY(d,r);var t=r.y;var c=this._getMaxTotalRevised(d);var e=r.rowHeight-1;var f=d.period;var A=this.mChartInstance.getAxisTime();for(var i=0;i<f.length;i++){var p=f[i];var x,g;x=A.timeToView(F.abapTimestampToDate(p.start_date)).toFixed(1);if(i<f.length-1){g=A.timeToView(F.abapTimestampToDate(f[i+1].start_date)).toFixed(1);}else{g=A.timeToView(F.abapTimestampToDate(f[i].start_date)).toFixed(1);}if(isNaN(x)||!x){x=A.timeToView(0).toFixed(1);}if(isNaN(g)||!x){g=A.timeToView(0).toFixed(1);}if(i===0){o+=x+","+m+" ";}var h=m;if(p.demand>p.supply){if(p.demand/c>1){h=t;}else{h=m-p.demand/c*e;}}h=h.toFixed(1);o+=x+","+h+" ";o+=g+","+h+" ";if(i===f.length-1){o+=x+","+h+" ";o+=x+","+m+" ";}}return o;};return b;},true);};if(!jQuery.sap.isDeclared('sap.gantt.shape.ext.ubc.UbcTooltipRectangle')){jQuery.sap.declare('sap.gantt.shape.ext.ubc.UbcTooltipRectangle');sap.ui.define("sap/gantt/shape/ext/ubc/UbcTooltipRectangle",["sap/gantt/misc/Utility","sap/gantt/misc/Format","sap/gantt/shape/Rectangle"],function(U,F,R){"use strict";var a=R.extend("sap.gantt.shape.ext.ubc.UbcTooltipRectangle",{});a.prototype.init=function(){this._oRb=sap.ui.getCore().getLibraryResourceBundle("sap.gantt");};a.prototype.getEnableSelection=function(d,r){if(this.mShapeConfig.hasShapeProperty("enableSelection")){return this._configFirst("enableSelection",d);}return false;};a.prototype.getX=function(d,r){if(this.mShapeConfig.hasShapeProperty("x")){return this._configFirst("x",d);}var A=this.mChartInstance.getAxisTime();var x=A.timeToView(F.abapTimestampToDate(d.start_date)).toFixed(1);if(isNaN(x)||!x){x=this.axisTime.timeToView(0).toFixed(1);}return x;};a.prototype.getY=function(d,r){if(this.mShapeConfig.hasShapeProperty("y")){return this._configFirst("y",d);}return r.y;};a.prototype.getWidth=function(d,r){if(this.mShapeConfig.hasShapeProperty("width")){return this._configFirst("width",d);}var w,s,e;var A=this.mChartInstance.getAxisTime();s=A.timeToView(F.abapTimestampToDate(d.start_date)).toFixed(1);e=A.timeToView(F.abapTimestampToDate(d.end_date)).toFixed(1);if(isNaN(s)||!s){s=this.axisTime.timeToView(0).toFixed(1);}if(isNaN(e)||!e){e=this.axisTime.timeToView(0).toFixed(1);}w=(e-s>0)?(e-s):(s-e);if((w===0)||isNaN(w)){w=1;}return w;};a.prototype.getHeight=function(d,r){if(this.mShapeConfig.hasShapeProperty("height")){return this._configFirst("height",d);}return r.rowHeight-1;};a.prototype.getStrokeOpacity=function(d,r){if(this.mShapeConfig.hasShapeProperty("strokeOpacity")){return this._configFirst("strokeOpacity",d);}return 0;};a.prototype.getFillOpacity=function(d,r){if(this.mShapeConfig.hasShapeProperty("fillOpacity")){return this._configFirst("fillOpacity",d);}return 0;};a.prototype.getTitle=function(d,r){if(this.mShapeConfig.hasShapeProperty("title")){return this._configFirst("title",d);}var b=this._oRb.getText("TLTP_CAPACITY",[d.supply,d.demand]);if(d.demand>d.supply){b+=this._oRb.getText("TLTP_OVER_CAPACITY",[d.demand-d.supply]);}return b;};return a;},true);};if(!jQuery.sap.isDeclared('sap.gantt.shape.ext.ubc.UbcUnderCapacityZonePolygon')){jQuery.sap.declare('sap.gantt.shape.ext.ubc.UbcUnderCapacityZonePolygon');sap.ui.define("sap/gantt/shape/ext/ubc/UbcUnderCapacityZonePolygon",["sap/gantt/misc/Utility","sap/gantt/misc/Format","sap/gantt/shape/ext/ubc/UbcPolygon"],function(U,F,a){"use strict";var b=a.extend("sap.gantt.shape.ext.ubc.UbcUnderCapacityZonePolygon",{});b.prototype.getFill=function(d,r){if(this.mShapeConfig.hasShapeProperty("fill")){return this._configFirst("fill",d);}return"#40d44c";};b.prototype.getPoints=function(d,r){if(this.mShapeConfig.hasShapeProperty("points")){return this._configFirst("points",d);}var o="";var m=this._getMaxY(d,r);var c=this._getMaxTotalRevised(d);var e=r.rowHeight-1;var f=d.period;var A=this.mChartInstance.getAxisTime();for(var i=0;i<f.length;i++){var p=f[i];var x,g;x=A.timeToView(F.abapTimestampToDate(p.start_date)).toFixed(1);if(i<f.length-1){g=A.timeToView(F.abapTimestampToDate(f[i+1].start_date)).toFixed(1);}else{g=A.timeToView(F.abapTimestampToDate(f[i].start_date)).toFixed(1);}if(isNaN(x)||!x){x=A.timeToView(0).toFixed(1);}if(isNaN(g)||!x){g=A.timeToView(0).toFixed(1);}if(i===0){o+=x+","+m+" ";}var h=m-p.supply/c*e;h=h.toFixed(1);o+=x+","+h+" ";o+=g+","+h+" ";if(i===f.length-1){o+=x+","+h+" ";o+=x+","+m+" ";}}return o;};return b;},true);};if(!jQuery.sap.isDeclared('sap.gantt.shape.ext.ubc.UbcUsedPolygon')){jQuery.sap.declare('sap.gantt.shape.ext.ubc.UbcUsedPolygon');sap.ui.define("sap/gantt/shape/ext/ubc/UbcUsedPolygon",["sap/gantt/misc/Utility","sap/gantt/misc/Format","sap/gantt/shape/ext/ubc/UbcPolygon"],function(U,F,a){"use strict";var b=a.extend("sap.gantt.shape.ext.ubc.UbcUsedPolygon",{});b.prototype.getFill=function(d,r){if(this.mShapeConfig.hasShapeProperty("fill")){return this._configFirst("fill",d);}return"#CAC7BA";};b.prototype.getPoints=function(d,r){if(this.mShapeConfig.hasShapeProperty("points")){return this._configFirst("points",d);}var u="";var m=this._getMaxY(d,r);var c=this._getMaxTotalRevised(d);var e=r.rowHeight-1;var f=d.period;var A=this.mChartInstance.getAxisTime();for(var i=0;i<f.length;i++){var p=f[i];var x,g;var h;x=A.timeToView(F.abapTimestampToDate(p.start_date)).toFixed(1);if(i<f.length-1){g=A.timeToView(F.abapTimestampToDate(f[i+1].start_date)).toFixed(1);}else{g=A.timeToView(F.abapTimestampToDate(f[i].start_date)).toFixed(1);}if(isNaN(x)||!x){x=A.timeToView(0).toFixed(1);}if(isNaN(g)||!x){g=A.timeToView(0).toFixed(1);}if(i===0){u+=x+","+m+" ";}if(p.demand>=p.supply){h=m-p.supply/c*e;}else{h=m-p.demand/c*e;}h=h.toFixed(1);u+=x+","+h+" ";u+=g+","+h+" ";if(i===f.length-1){u+=x+","+h+" ";u+=x+","+m+" ";}}return u;};return b;},true);};if(!jQuery.sap.isDeclared('sap.gantt.shape.ext.ubc.UtilizationBarChart')){jQuery.sap.declare('sap.gantt.shape.ext.ubc.UtilizationBarChart');sap.ui.define("sap/gantt/shape/ext/ubc/UtilizationBarChart",["sap/gantt/shape/Group"],function(G){"use strict";var U=G.extend("sap.gantt.shape.ext.ubc.UtilizationBarChart",{});U.prototype.getEnableSelection=function(d,r){if(this.mShapeConfig.hasShapeProperty("enableSelection")){return this._configFirst("enableSelection",d);}return false;};U.prototype.filterValidData=function(d){if(!d){return[];}var f=[];for(var i=0;i<d.length;i++){var a=this.getIsBulk(d[i]);var A=this.getArrayAttribute(d[i]);var t=this.getTimeFilterAttribute(d[i]);var e=this.getEndTimeFilterAttribute(d[i]);var T=this.mChartInstance._oStatusSet.aTimeBoundary;var o=jQuery.extend(true,{},d[i]);if(a&&A&&t&&e){var s=null;var b=null;var S=this.getShapes();var c=[];for(var j=0;j<S.length;j++){var g=S[j].mShapeConfig.getShapeDataName();if(g&&(jQuery.inArray(g,c)==-1)){c.push(g);}}for(var h in o){if((jQuery.type(o[h])=="object")&&o[h][A]&&o[h][A].length>0){s=this._binarySearchElement(T[0],o[h][A],t,e);b=this._binarySearchElement(T[1],o[h][A],t,e,s);if(s!==null&&b!==null&&s<=b){o[h][A]=o[h][A].slice(s,b+2);for(var k=0;k<c.length;k++){if(h!==c[k]&&(jQuery.type(o[c[k]])=="array")&&o[c[k]].length>0){o[c[k]]=o[c[k]].slice(s,b+1);}}}break;}}}f.push(o);}return f;};U.prototype._binarySearchElement=function(v,a,t,e,l){var b=0;var h=a.length-1;if(l&&l<h){b=l;}var m;while(b<=h){m=Math.floor((b+h)/2);var s=sap.gantt.misc.Utility.abapTsToDate(a[m][t]);var c=sap.gantt.misc.Utility.abapTsToDate(a[m][e]);if(s<=v&&v<=c){return m;}else if(c<v){b=m+1;}else if(s>v){h=m-1;}}return m;};return U;},true);};if(!jQuery.sap.isDeclared('sap.gantt.shape.ext.ulc.UlcBorderPath')){jQuery.sap.declare('sap.gantt.shape.ext.ulc.UlcBorderPath');sap.ui.define("sap/gantt/shape/ext/ulc/UlcBorderPath",["sap/gantt/shape/Path","sap/gantt/misc/Utility","sap/gantt/misc/Format"],function(P,U,F){"use strict";var a=P.extend("sap.gantt.shape.ext.ulc.UlcBorderPath",{});a.prototype.getD=function(d,r){if(this.mShapeConfig.hasShapeProperty("d")){return this._configFirst("d",d);}var b="";if(d.values){for(var i=0;i<d.values.length;i++){var A=this.mChartInstance.getAxisTime();var x=A.timeToView(F.abapTimestampToDate(d.values[i].from));var c=A.timeToView(F.abapTimestampToDate(d.values[i].to));var e=d.values[i].value;if(isNaN(e)){e=0;}var m=25;if(this.mShapeConfig.hasShapeProperty("maxVisibleRatio")){m=this._configFirst("maxVisibleRatio",d);}if(e>(100+m)){e=100+m;}var y=r.y+r.rowHeight-r.rowHeight*(e/(100+m));var l=r.y+r.rowHeight;b=b+(d.values[i].firstOne?" M "+x+" "+l:"")+" L "+x+" "+y+" L "+c+" "+y+(d.values[i].lastOne?" L "+c+" "+l:"");}}return b===""?"M 0 0":b;};a.prototype.getStroke=function(d,r){if(this.mShapeConfig.hasShapeProperty("stroke")){return this._configFirst("stroke",d);}var u;if(this.mShapeConfig.hasShapeProperty("utilizationCurves")){u=this._configFirst("utilizationCurves",d);return u[d.dimension].color;}};a.prototype.getStrokeWidth=function(d,r){if(this.mShapeConfig.hasShapeProperty("strokeWidth")){return this._configFirst("strokeWidth",d);}return 1;};return a;},true);};if(!jQuery.sap.isDeclared('sap.gantt.shape.ext.ulc.UlcClipPath')){jQuery.sap.declare('sap.gantt.shape.ext.ulc.UlcClipPath');sap.ui.define("sap/gantt/shape/ext/ulc/UlcClipPath",["sap/gantt/shape/ClipPath"],function(C){"use strict";var U=C.extend("sap.gantt.shape.ext.ulc.UlcClipPath",{});U.prototype.getHtmlClass=function(d,r){if(this.mShapeConfig.hasShapeProperty("htmlClass")){return this._configFirst("htmlClass",d);}var u=r.uid;var p=new RegExp("\\[|\\]|:|\\|","g");var n=u.replace(p,"_");return n+"_"+d.id+"_"+d.dimension;};return U;},true);};if(!jQuery.sap.isDeclared('sap.gantt.shape.ext.ulc.UlcClipingPath')){jQuery.sap.declare('sap.gantt.shape.ext.ulc.UlcClipingPath');sap.ui.define("sap/gantt/shape/ext/ulc/UlcClipingPath",["sap/gantt/shape/Path","sap/gantt/misc/Utility","sap/gantt/misc/Format"],function(P,U,F){"use strict";var a=P.extend("sap.gantt.shape.ext.ulc.UlcClipingPath",{});a.prototype.getD=function(d,r){if(this.mShapeConfig.hasShapeProperty("d")){return this._configFirst("d",d);}var b="";if(d.values){for(var i=0;i<d.values.length;i++){var A=this.mChartInstance.getAxisTime();var x=A.timeToView(F.abapTimestampToDate(d.values[i].from));var c=A.timeToView(F.abapTimestampToDate(d.values[i].to));var e=d.values[i].value;if(isNaN(e)){e=0;}var m=25;if(this.mShapeConfig.hasShapeProperty("maxVisibleRatio")){m=this._configFirst("maxVisibleRatio",d);}if(e>(100+m)){e=100+m;}var y=r.y+r.rowHeight-r.rowHeight*(e/(100+m));var l=r.y+r.rowHeight;b=b+(d.values[i].firstOne?" M "+x+" "+l:"")+" L "+x+" "+y+" L "+c+" "+y+(d.values[i].lastOne?" L "+c+" "+l:"");}}return b===""?"M 0 0":b;};return a;},true);};if(!jQuery.sap.isDeclared('sap.gantt.shape.ext.ulc.UlcDimension')){jQuery.sap.declare('sap.gantt.shape.ext.ulc.UlcDimension');sap.ui.define("sap/gantt/shape/ext/ulc/UlcDimension",["sap/gantt/shape/Group"],function(G){"use strict";var U=G.extend("sap.gantt.shape.ext.ulc.UlcDimension",{});return U;},true);};if(!jQuery.sap.isDeclared('sap.gantt.shape.ext.ulc.UlcMiddleLine')){jQuery.sap.declare('sap.gantt.shape.ext.ulc.UlcMiddleLine');sap.ui.define("sap/gantt/shape/ext/ulc/UlcMiddleLine",["sap/gantt/shape/Line"],function(L){"use strict";var U=L.extend("sap.gantt.shape.ext.ulc.UlcMiddleLine",{});U.prototype.getX1=function(d,r){if(this.mShapeConfig.hasShapeProperty("x1")){return this._configFirst("x1",d);}var v=this.mChartInstance._oStatusSet?this.mChartInstance._oStatusSet.aViewBoundary:[];if(v.length>0){return v[0];}return 0;};U.prototype.getY1=function(d,r){if(this.mShapeConfig.hasShapeProperty("y1")){return this._configFirst("y1",d);}var m=25;if(this.mShapeConfig.hasShapeProperty("maxVisibleRatio")){m=this._configFirst("maxVisibleRatio",d);}return r.y+r.rowHeight*(50+m)/(100+m);};U.prototype.getX2=function(d,r){if(this.mShapeConfig.hasShapeProperty("x2")){return this._configFirst("x2",d);}var v=this.mChartInstance._oStatusSet?this.mChartInstance._oStatusSet.aViewBoundary:[];if(v.length>0){return v[1];}return 0;};U.prototype.getY2=function(d,r){if(this.mShapeConfig.hasShapeProperty("y2")){return this._configFirst("y2",d);}return this.getY1(d,r);};U.prototype.getStrokeDasharray=function(d,r){if(this.mShapeConfig.hasShapeProperty("strokeDasharray")){return this._configFirst("strokeDasharray",d);}return"5,5";};U.prototype.getStroke=function(d){if(this.mShapeConfig.hasShapeProperty("stroke")){return this._configFirst("stroke",d);}return"#CAC7BA";};U.prototype.getStrokeWidth=function(d){if(this.mShapeConfig.hasShapeProperty("strokeWidth")){return this._configFirst("strokeWidth",d);}return 1;};return U;},true);};if(!jQuery.sap.isDeclared('sap.gantt.shape.ext.ulc.UlcRectangle')){jQuery.sap.declare('sap.gantt.shape.ext.ulc.UlcRectangle');sap.ui.define("sap/gantt/shape/ext/ulc/UlcRectangle",["sap/gantt/shape/Rectangle"],function(R){"use strict";var U=R.extend("sap.gantt.shape.ext.ulc.UlcRectangle",{metadata:{"abstract":true}});U.prototype.getX=function(d,r){if(this.mShapeConfig.hasShapeProperty("x")){return this._configFirst("x",d);}var v=this.getShapeViewBoundary();if(v){return v[0];}return 0;};U.prototype.getY=function(d,r){if(this.mShapeConfig.hasShapeProperty("y")){return this._configFirst("y",d);}return r.y;};U.prototype.getWidth=function(d,r){if(this.mShapeConfig.hasShapeProperty("width")){return this._configFirst("width",d);}var v=this.getShapeViewBoundary();if(v){return v[1]-v[0];}return 0;};U.prototype.getHeight=function(d,r){if(this.mShapeConfig.hasShapeProperty("height")){return this._configFirst("height",d);}var m=25;if(this.mShapeConfig.hasShapeProperty("maxVisibleRatio")){m=this._configFirst("maxVisibleRatio",d);}return r.rowHeight*m/(100+m);};return U;},true);};if(!jQuery.sap.isDeclared('sap.gantt.shape.ext.ulc.UlcTooltipRectangle')){jQuery.sap.declare('sap.gantt.shape.ext.ulc.UlcTooltipRectangle');sap.ui.define("sap/gantt/shape/ext/ulc/UlcTooltipRectangle",["sap/gantt/shape/ext/ulc/UlcRectangle","sap/gantt/misc/Utility","sap/gantt/misc/Format"],function(U,a,F){"use strict";var b=U.extend("sap.gantt.shape.ext.ulc.UlcTooltipRectangle",{});b.prototype.getTitle=function(d,r){if(this.mShapeConfig.hasShapeProperty("title")){return this._configFirst("title",d);}var c="";var u;if(this.mShapeConfig.hasShapeProperty("utilizationCurves")){u=this._configFirst("utilizationCurves",d);}if(d){for(var e in u){if(d[u[e].ratioAttribute]||d[u[e].ratioAttribute]===0){if(d[u[e].ratioAttribute].previous!==undefined){c+=u[e].name+"\t"+d[u[e].ratioAttribute].previous+"-"+d[u[e].ratioAttribute].next+"%"+"\n";}else{c+=u[e].name+"\t"+d[u[e].ratioAttribute].value+"%"+"\n";}}}}return c;};b.prototype.getX=function(d,r){if(this.mShapeConfig.hasShapeProperty("x")){return this._configFirst("x",d);}var A=this.mChartInstance.getAxisTime();return A.timeToView(F.abapTimestampToDate(d.from));};b.prototype.getWidth=function(d,r){if(this.mShapeConfig.hasShapeProperty("width")){return this._configFirst("width",d);}var A=this.mChartInstance.getAxisTime();return Math.abs(A.timeToView(F.abapTimestampToDate(d.to))-A.timeToView(F.abapTimestampToDate(d.from)));};b.prototype.getHeight=function(d,r){if(this.mShapeConfig.hasShapeProperty("height")){return this._configFirst("height",d);}return r.rowHeight;};b.prototype.getStrokeOpacity=function(d,r){if(this.mShapeConfig.hasShapeProperty("strokeOpacity")){return this._configFirst("strokeOpacity",d);}return 0;};b.prototype.getFillOpacity=function(d,r){if(this.mShapeConfig.hasShapeProperty("fillOpacity")){return this._configFirst("fillOpacity",d);}return 0;};return b;},true);};if(!jQuery.sap.isDeclared('sap.gantt.shape.ext.ulc.UlcUnderClipRectangle')){jQuery.sap.declare('sap.gantt.shape.ext.ulc.UlcUnderClipRectangle');sap.ui.define("sap/gantt/shape/ext/ulc/UlcUnderClipRectangle",["sap/gantt/shape/ext/ulc/UlcRectangle"],function(U){"use strict";var a=U.extend("sap.gantt.shape.ext.ulc.UlcUnderClipRectangle",{});a.prototype.getY=function(d,r){if(this.mShapeConfig.hasShapeProperty("y")){return this._configFirst("y",d);}var m=25;if(this.mShapeConfig.hasShapeProperty("maxVisibleRatio")){m=this._configFirst("maxVisibleRatio",d);}return r.y+r.rowHeight*m/(100+m);};a.prototype.getHeight=function(d,r){if(this.mShapeConfig.hasShapeProperty("height")){return this._configFirst("height",d);}var m=25;if(this.mShapeConfig.hasShapeProperty("maxVisibleRatio")){m=this._configFirst("maxVisibleRatio",d);}return r.rowHeight-r.rowHeight*m/(100+m);};a.prototype.getFill=function(d,r){if(this.mShapeConfig.hasShapeProperty("fill")){return this._configFirst("fill",d);}return"#F2F2F2";};a.prototype.getStrokeOpacity=function(d,r){if(this.mShapeConfig.hasShapeProperty("strokeOpacity")){return this._configFirst("strokeOpacity",d);}return 0.3;};a.prototype.getFillOpacity=function(d,r){if(this.mShapeConfig.hasShapeProperty("fillOpacity")){return this._configFirst("fillOpacity",d);}return 0.3;};a.prototype.getClipPath=function(d,r){if(this.mShapeConfig.hasShapeProperty("clipPath")){return this._configFirst("clipPath",d);}var u=r.uid;var p=new RegExp("\\[|\\]|:|\\|","g");var n=u.replace(p,"_");return"url(#"+n+"_"+d.id+"_"+d.dimension+")";};return a;},true);};if(!jQuery.sap.isDeclared('sap.gantt.shape.ext.ulc.UtilizationLineChart')){jQuery.sap.declare('sap.gantt.shape.ext.ulc.UtilizationLineChart');sap.ui.define("sap/gantt/shape/ext/ulc/UtilizationLineChart",["sap/gantt/shape/Group"],function(G){"use strict";var U=G.extend("sap.gantt.shape.ext.ulc.UtilizationLineChart",{});U.prototype.getEnableSelection=function(d,r){if(this.mShapeConfig.hasShapeProperty("enableSelection")){return this._configFirst("enableSelection",d);}return false;};return U;},true);};if(!jQuery.sap.isDeclared('sap.gantt.GanttChartBase')){jQuery.sap.declare('sap.gantt.GanttChartBase');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.Control');sap.ui.define("sap/gantt/GanttChartBase",['jquery.sap.global','./library','sap/ui/core/Control',"./misc/Utility","./config/TimeHorizon"],function(q,l,C,U,T){"use strict";var G=C.extend("sap.gantt.GanttChartBase",{metadata:{"abstract":true,library:"sap.gantt",properties:{width:{type:"sap.ui.core.CSSSize",defaultValue:"100%"},height:{type:"sap.ui.core.CSSSize",defaultValue:"100%"},enableCursorLine:{type:"boolean",defaultValue:true},enableNowLine:{type:"boolean",defaultValue:true},enableVerticalLine:{type:"boolean",defaultValue:true},timeZoomRate:{type:"float",defaultValue:1},mode:{type:"string",defaultValue:sap.gantt.config.DEFAULT_MODE_KEY},selectionMode:{type:"sap.gantt.SelectionMode",defaultValue:sap.gantt.SelectionMode.MultiWithKeyboard},selectionPanelSize:{type:"sap.ui.core.CSSSize",defaultValue:"30%"},hierarchyKey:{type:"string",defaultValue:sap.gantt.config.DEFAULT_HIERARCHY_KEY},svgDefs:{type:"sap.gantt.def.SvgDefs",defaultValue:null},timeAxis:{type:"sap.gantt.config.TimeAxis",defaultValue:sap.gantt.config.DEFAULT_TIME_AXIS},modes:{type:"array",defaultValue:sap.gantt.config.DEFAULT_MODES},toolbarSchemes:{type:"array",defaultValue:sap.gantt.config.DEFAULT_GANTTCHART_TOOLBAR_SCHEMES},hierarchies:{type:"array",defaultValue:sap.gantt.config.DEFAULT_HIERARCHYS},objectTypes:{type:"array",defaultValue:sap.gantt.config.DEFAULT_OBJECT_TYPES},chartSchemes:{type:"array",defaultValue:sap.gantt.config.DEFAULT_CHART_SCHEMES},locale:{type:"sap.gantt.config.Locale",defaultValue:sap.gantt.config.DEFAULT_LOCALE_CET},shapeDataNames:{type:"array",defaultValue:[]},shapes:{type:"array",defaultValue:[]}},aggregations:{rows:{type:"sap.ui.core.Control",multiple:true,singularName:"row",bindable:"bindable",visibility:"public"},relationships:{type:"sap.ui.core.Control",multiple:true,bindable:"bindable",visibility:"public"},calendarDef:{type:"sap.gantt.def.cal.CalendarDefs",multiple:false,bindable:"bindable",visibility:"public"}},events:{ganttChartSwitchRequested:{parameters:{hierarchyKey:{type:"string"}}},splitterResize:{parameters:{id:{type:"string"},oldSizes:{type:"int[]"},newSizes:{type:"int[]"},zoomInfo:{type:"object"}}},horizontalScroll:{parameters:{scrollSteps:{type:"int"}}},verticalScroll:{parameters:{scrollSteps:{type:"int"}}},chartMouseOver:{parameters:{objectInfo:{type:"object"},leadingRowInfo:{type:"object"},timestamp:{type:"string"},svgId:{type:"string"},svgCoordinate:{type:"int[]"},effectingMode:{type:"string"},originEvent:{type:"object"}}},chartDoubleClick:{parameters:{objectInfo:{type:"object"},leadingRowInfo:{type:"object"},timestamp:{type:"string"},svgId:{type:"string"},svgCoordinate:{type:"int[]"},effectingMode:{type:"string"},originEvent:{type:"object"}}},chartRightClick:{parameters:{objectInfo:{type:"object"},leadingRowInfo:{type:"object"},timestamp:{type:"string"},svgId:{type:"string"},svgCoordinate:{type:"int[]"},effectingMode:{type:"string"},originEvent:{type:"object"}}},chartDragEnter:{parameters:{originEvent:{type:"object"}}},chartDragLeave:{parameters:{originEvent:{type:"object"},draggingSource:{type:"object"}}},rowSelectionChange:{parameters:{originEvent:{type:"object"}}},relationshipSelectionChange:{parameters:{originEvent:{type:"object"}}},shapeSelectionChange:{parameters:{originEvent:{type:"object"}}},shapeDragEnd:{parameters:{originEvent:{type:"object"},sourceShapeData:{type:"object[]"},sourceSvgId:{type:"string"},targetData:{type:"object[]"},targetSvgId:{type:"string"}}}}}});G.getMetadata().getAllAggregations()["rows"]._doesNotRequireFactory=true;G.getMetadata().getAllAggregations()["relationships"]._doesNotRequireFactory=true;G.prototype.notifySourceChange=function(){};return G;},true);};if(!jQuery.sap.isDeclared('sap.gantt.GanttChartContainer')){jQuery.sap.declare('sap.gantt.GanttChartContainer');jQuery.sap.require('sap.ui.core.Control');jQuery.sap.require('sap.ui.layout.Splitter');jQuery.sap.require('sap.ui.layout.SplitterLayoutData');jQuery.sap.require('sap.ui.core.Orientation');sap.ui.define("sap/gantt/GanttChartContainer",["sap/ui/core/Control","sap/ui/layout/Splitter","sap/ui/layout/SplitterLayoutData","sap/ui/core/Orientation","./legend/LegendContainer","./control/Toolbar","./control/AssociateContainer","./config/TimeHorizon","./misc/Utility"],function(C,S,a,O,L,T,A,b,U){"use strict";var G=C.extend("sap.gantt.GanttChartContainer",{metadata:{library:"sap.gantt",properties:{width:{type:"sap.ui.core.CSSSize",defaultValue:"100%"},height:{type:"sap.ui.core.CSSSize",defaultValue:"100%"},enableTimeScrollSync:{type:"boolean",defaultValue:true},enableRowScrollSync:{type:"boolean",defaultValue:false},enableCursorLine:{type:"boolean",defaultValue:true},enableNowLine:{type:"boolean",defaultValue:true},enableVerticalLine:{type:"boolean",defaultValue:true},svgDefs:{type:"sap.gantt.def.SvgDefs",defaultValue:null},modes:{type:"array",defaultValue:sap.gantt.config.DEFAULT_MODES},toolbarSchemes:{type:"array",defaultValue:sap.gantt.config.DEFAULT_CONTAINER_TOOLBAR_SCHEMES},hierarchies:{type:"array",defaultValue:sap.gantt.config.DEFAULT_HIERARCHYS},containerLayouts:{type:"array",defaultValue:sap.gantt.config.DEFAULT_CONTAINER_LAYOUTS},containerLayoutKey:{type:"string",defaultValue:sap.gantt.config.DEFAULT_CONTAINER_SINGLE_LAYOUT_KEY},sliderStep:{type:"int",defaultValue:10}},aggregations:{legendContainer:{type:"sap.gantt.legend.LegendContainer",multiple:false,visibility:"public"},customToolbarItems:{type:"sap.ui.core.Control",multiple:true,visibility:"public",singularName:"customToolbarItem",bindable:"bindable"},ganttCharts:{type:"sap.gantt.GanttChartBase",multiple:true,visibility:"public",singularName:"ganttChart",bindable:"bindable"},_toolbar:{type:"sap.gantt.control.Toolbar",multiple:false,visibility:"hidden"}},events:{ganttChartChangeRequested:{parameters:{action:{type:"string"},ganttChartIndex:{type:"int"},hierarchyKey:{type:"string"},oldHierarchyKey:{type:"string"},containerLayoutKey:{type:"string"}}},customSettingChange:{parameters:{id:{type:"string"},value:{type:"boolean"}}}}}});G.prototype.init=function(){jQuery.sap.measure.start("GanttChartContainer Init","GanttPerf:GanttChartContainer Init function");this._bInitHorizonApplied=false;this._oToolbar=new T({type:sap.gantt.control.ToolbarType.Global,sourceId:sap.gantt.config.DEFAULT_CONTAINER_SINGLE_LAYOUT_KEY});this._oToolbar.setSliderStep(this.getSliderStep());this.setAggregation("_toolbar",this._oToolbar);this._oToolbar.attachSourceChange(this._onToolbarSourceChange,this);this._oToolbar.attachLayoutChange(this._onToolbarLayoutChange,this);this._oToolbar.attachExpandChartChange(this._onToolbarExpandChartChange,this);this._oToolbar.attachZoomRateChange(this._onToolbarZoomRateChange,this);this._oToolbar.attachSettingsChange(this._onToolbarSettingsChange,this);this._oToolbar.data("holder",this);this._oSplitter=new S({width:"100%",height:"100%",orientation:O.Vertical});this._oModesConfigMap={};this._oModesConfigMap[sap.gantt.config.DEFAULT_MODE_KEY]=sap.gantt.config.DEFAULT_MODE;this._oToolbarSchemeConfigMap={};this._oToolbarSchemeConfigMap[sap.gantt.config.DEFAULT_CONTAINER_TOOLBAR_SCHEME_KEY]=sap.gantt.config.DEFAULT_CONTAINER_TOOLBAR_SCHEME;this._oToolbarSchemeConfigMap[sap.gantt.config.DEFAULT_GANTTCHART_TOOLBAR_SCHEME_KEY]=sap.gantt.config.DEFAULT_GANTTCHART_TOOLBAR_SCHEME;this._oToolbarSchemeConfigMap[sap.gantt.config.EMPTY_TOOLBAR_SCHEME_KEY]=sap.gantt.config.EMPTY_TOOLBAR_SCHEME;this._oHierarchyConfigMap={};this._oHierarchyConfigMap[sap.gantt.config.DEFAULT_HIERARCHY_KEY]=sap.gantt.config.DEFAULT_HIERARCHY;this._oContainerLayoutConfigMap={};this._oContainerLayoutConfigMap[sap.gantt.config.DEFAULT_CONTAINER_SINGLE_LAYOUT_KEY]=sap.gantt.config.DEFAULT_CONTAINER_SINGLE_LAYOUT;this._oContainerLayoutConfigMap[sap.gantt.config.DEFAULT_CONTAINER_DUAL_LAYOUT_KEY]=sap.gantt.config.DEFAULT_CONTAINER_DUAL_LAYOUT;jQuery.sap.measure.end("GanttChartContainer Init");};G.prototype.applySettings=function(s,o){var r=C.prototype.applySettings.apply(this,arguments);if(this.getContainerLayouts()&&this.getContainerLayoutKey()){this.switchOrientation(null,true);}return r;};G.prototype.setModes=function(m){this.setProperty("modes",m);this._oToolbar.setModes(m);this._oModesConfigMap={};if(m){for(var i=0;i<m.length;i++){this._oModesConfigMap[m[i].getKey()]=m[i];}}return this;};G.prototype.setSliderStep=function(s){this.setProperty("sliderStep",s);this._oToolbar.setSliderStep(s);return this;};G.prototype.setToolbarSchemes=function(t){this.setProperty("toolbarSchemes",t);this._oToolbar.setToolbarSchemes(t);this._oToolbarSchemeConfigMap={};if(t){for(var i=0;i<t.length;i++){this._oToolbarSchemeConfigMap[t[i].getKey()]=t[i];}}return this;};G.prototype.setHierarchies=function(h){this.setProperty("hierarchies",h);this._oToolbar.setHierarchies(h);this._oHierarchyConfigMap={};if(h){for(var i=0;i<h.length;i++){this._oHierarchyConfigMap[h[i].getKey()]=h[i];}}return this;};G.prototype.setContainerLayouts=function(c){this.setProperty("containerLayouts",c);this._oToolbar.setContainerLayouts(c);this._oContainerLayoutConfigMap={};if(c){for(var i=0;i<c.length;i++){this._oContainerLayoutConfigMap[c[i].getKey()]=c[i];}}if(this.getContainerLayoutKey()){this.switchOrientation(null,true);}return this;};G.prototype.setEnableCursorLine=function(e){this.setProperty("enableCursorLine",e);var g=this.getGanttCharts();for(var i=0;i<g.length;i++){g[i].setEnableCursorLine(e);}this.getAggregation("_toolbar").setEnableCursorLine(e);return this;};G.prototype.setEnableNowLine=function(e){this.setProperty("enableNowLine",e);var g=this.getGanttCharts();for(var i=0;i<g.length;i++){g[i].setEnableNowLine(e);}this.getAggregation("_toolbar").setEnableNowLine(e);return this;};G.prototype.setEnableVerticalLine=function(e){this.setProperty("enableVerticalLine",e);var g=this.getGanttCharts();for(var i=0;i<g.length;i++){g[i].setEnableVerticalLine(e);}this.getAggregation("_toolbar").setEnableVerticalLine(e);return this;};G.prototype.setEnableTimeScrollSync=function(e){this.setProperty("enableTimeScrollSync",e);var g=this.getGanttCharts();for(var i=0;i<g.length;i++){g[i].detachHorizontalScroll(this._onGanttChartHSBScroll,this);if(e){g[i].attachHorizontalScroll(this._onGanttChartHSBScroll,this);}}this.getAggregation("_toolbar").setEnableTimeScrollSync(e);return this;};G.prototype.setEnableRowScrollSync=function(e){this.setProperty("enableRowScrollSync",e);var g=this.getGanttCharts();for(var i=0;i<g.length;i++){g[i].detachVerticalScroll(this._onGanttChartVSBScroll,this);if(e){g[i].attachVerticalScroll(this._onGanttChartVSBScroll,this);}}this.getAggregation("_toolbar").setEnableRowScrollSync(e);return this;};G.prototype.setContainerLayoutKey=function(c){if(this.getProperty("containerLayoutKey")===c){return this;}this.setProperty("containerLayoutKey",c);this._oToolbar.setSourceId(c);if(this.getContainerLayouts()){this.switchOrientation(null,true);}return this;};G.prototype.setLegendContainer=function(l){this.setAggregation("legendContainer",l);if(l){this._oToolbar.setLegend(new A({content:l.getId()}));}return this;};G.prototype.addCustomToolbarItem=function(c){this._oToolbar.addCustomToolbarItem(c);};G.prototype.insertCustomToolbarItem=function(c,i){this._oToolbar.insertCustomToolbarItem(c,i);};G.prototype.removeCustomToolbarItem=function(c){this._oToolbar.removeCustomToolbarItem(c);};G.prototype.removeAllCustomToolbarItems=function(){this._oToolbar.removeAllCustomToolbarItems();};G.prototype.addGanttChart=function(g){this.addAggregation("ganttCharts",g);if(g){this._insertGanttChart(g);}};G.prototype.insertGanttChart=function(g,i){this.insertAggregation("ganttCharts",g,i);if(g){this._insertGanttChart(g,i);}};G.prototype.removeGanttChart=function(g){this._removeGanttChart(g);this.removeAggregation("ganttCharts",g);};G.prototype.removeAllGanttCharts=function(){var g=this.getGanttCharts();for(var i=0;i<g.length;i++){this._removeGanttChart(g[i]);}this.removeAllAggregation("ganttCharts");};G.prototype._insertGanttChart=function(g,i){jQuery.sap.measure.start("GanttChartContainer _insertGanttChart","GanttPerf:GanttChartContainer _insertGanttChart function");if(!g){return;}var o=new A({content:g.getId(),layoutData:new a({size:"auto"})});if(i!==0&&!i){this._oSplitter.addContentArea(o);}else{this._oSplitter.insertContentArea(o,i);}var c=this._oContainerLayoutConfigMap[this.getContainerLayoutKey()];var s=c.getSelectionPanelSize()?c.getSelectionPanelSize():"Auto";g.setSelectionPanelSize(s);if(this.getEnableTimeScrollSync()){g.attachHorizontalScroll(this._onGanttChartHSBScroll,this);}if(this.getEnableRowScrollSync()){g.attachVerticalScroll(this._onGanttChartVSBScroll,this);}g.attachSplitterResize(this._onViewSplitterResize,this);g.attachGanttChartSwitchRequested(this._onGanttChartSwitchRequested,this);g.attachChartDragEnter(this._onChartDragEnter,this);g.attachChartDragLeave(this._onChartDragLeave,this);g.attachShapeDragEnd(this._onChartDragEnd,this);jQuery.sap.measure.end("GanttChartContainer _insertGanttChart");};G.prototype._removeGanttChart=function(g){var o=g;if((typeof g)==="number"){o=this.getGanttCharts()[g];}if(o){this._oSplitter.removeContentArea(o._oAC);o.detachHorizontalScroll(this._onGanttChartHSBScroll,this);o.detachVerticalScroll(this._onGanttChartVSBScroll,this);o.detachSplitterResize(this._onViewSplitterResize,this);o.detachGanttChartSwitchRequested(this._onGanttChartSwitchRequested,this);o.detachChartDragEnter(this._onChartDragEnter,this);o.detachChartDragLeave(this._onChartDragLeave,this);o.detachShapeDragEnd(this._onChartDragEnd,this);}};G.prototype.onBeforeRendering=function(){this._detachEvents();this._oToolbar.setEnableTimeScrollSync(this.getEnableTimeScrollSync());this._oToolbar.setEnableRowScrollSync(this.getEnableRowScrollSync());this._oToolbar.setEnableCursorLine(this.getEnableCursorLine());this._oToolbar.setEnableNowLine(this.getEnableNowLine());this._oToolbar.setEnableVerticalLine(this.getEnableVerticalLine());var g=this.getGanttCharts();for(var i=0;i<g.length;i++){var o=g[i];o.setEnableCursorLine(this.getEnableCursorLine());o.setEnableNowLine(this.getEnableNowLine());o.setEnableVerticalLine(this.getEnableVerticalLine());}};G.prototype._detachEvents=function(){};G.prototype.onAfterRendering=function(){this._attachEvents();};G.prototype._attachEvents=function(){};G.prototype._detachToolbarEvents=function(){this._oToolbar.detachSourceChange(this._onToolbarSourceChange,this);this._oToolbar.detachLayoutChange(this._onToolbarLayoutChange,this);this._oToolbar.detachExpandChartChange(this._onToolbarExpandChartChange,this);this._oToolbar.detachZoomRateChange(this._onToolbarZoomRateChange,this);this._oToolbar.detachSettingsChange(this._onToolbarSettingsChange,this);};G.prototype._onGanttChartHSBScroll=function(e){var l=e.getParameters().leftOffsetRate;var g=this.getGanttCharts();for(var i=0;i<g.length;i++){if(e.oSource.getId()===g[i].getId()){continue;}g[i].jumpToPosition(l);}};G.prototype._onGanttChartVSBScroll=function(e){var n=e.getParameters().scrollSteps;var g=this.getGanttCharts();for(var i=0;i<g.length;i++){if(e.oSource.getId()===g[i].getId()){continue;}var N=g[i]._oTC||g[i]._oTT;N._oVSb.setScrollPosition(n);}};G.prototype._onViewSplitterResize=function(e){if(this._oSplitter.getOrientation()===O.Vertical){this._syncSelectionPanelSizeBetweenViews(e);this._oToolbar.setZoomInfo(e.getParameter("zoomInfo"));}};G.prototype._syncSelectionPanelSizeBetweenViews=function(e){var g=this.getGanttCharts();for(var i=0;i<g.length;i++){if(e.oSource.getId()===g[i].getId()){continue;}g[i].setSelectionPanelSize(e.getParameter("newSizes")[0]+"px",true);}};G.prototype._onGanttChartSwitchRequested=function(e){e.getSource().notifySourceChange();this.fireGanttChartChangeRequested({action:"switchGanttChart",hierarchyKey:e.getParameter("hierarchyKey"),oldHierarchyKey:e.getParameter("oldHierarchyKey"),ganttChartIndex:this.getGanttCharts().indexOf(e.getSource())});};G.prototype._onToolbarLayoutChange=function(e){var E=e.getParameter("id");var o=e.getParameter("value");switch(E){case"orientation":this.switchOrientation(o);break;case"add":this.fireGanttChartChangeRequested({action:"addGanttChart",hierarchyKey:o.hierarchyKey});this._updateGanttChartSize();break;case"less":this.fireGanttChartChangeRequested({action:"lessGanttChart",hierarchyKey:o.hierarchyKey,ganttChartIndex:o.ganttChartIndex});this._updateGanttChartSize();break;default:break;}};G.prototype._updateGanttChartSize=function(){var c=this._oSplitter.getContentAreas();for(var l=0;l<c.length;l++){if(c[l].getLayoutData()){if(c[l].getLayoutData().getSize()==="auto"){c[l].getLayoutData().setSize("100%");}c[l].getLayoutData().setSize("auto");}}};G.prototype._onToolbarSourceChange=function(e){var g=this.getGanttCharts();for(var i=0;i<g.length;i++){g[i].notifySourceChange();}this.setContainerLayoutKey(e.getParameter("id"));this.fireGanttChartChangeRequested({action:"switchContainerLayout",containerLayoutKey:e.getParameter("id")});};G.prototype._onToolbarExpandChartChange=function(e){var g=this.getGanttCharts();for(var i=0;i<g.length;i++){g[i].expandChartChange(e);}};G.prototype._onToolbarZoomRateChange=function(e){var g=this.getGanttCharts();var i,o;for(i=0;i<g.length;i++){o=g[i];o.setTimeZoomRate(e.getParameter("zoomRate"));}if(this._bInitHorizonApplied){return;}this._bInitHorizonApplied=true;for(i=0;i<g.length;i++){o=g[i];o.jumpToPosition();}};G.prototype._onChartDragEnter=function(e){var s=e.getParameter("originEvent");var g=e.getSource();if(s.button==0&&s.buttons!==0&&this._oDraggingSource!==undefined){g.setDraggingData(this._oDraggingSource);this._oDraggingSource=undefined;}else{this._oDraggingSource=undefined;g.setDraggingData(this._oDraggingSource);}};G.prototype._onChartDragLeave=function(e){var p=e.getParameters();if(p.draggingSource!==undefined){this._oDraggingSource=p.draggingSource;}else{this._oDraggingSource=undefined;}};G.prototype._onChartDragEnd=function(e){this._oDraggingSource=undefined;};G.prototype._onToolbarSettingsChange=function(e){var p=e.getParameters();for(var i=0;i<p.length;i++){switch(p[i].id){case sap.gantt.config.SETTING_ITEM_ENABLE_TIME_SCROLL_SYNC_KEY:if(this.getEnableTimeScrollSync()!==p[i].value){this.setEnableTimeScrollSync(p[i].value);}break;case sap.gantt.config.SETTING_ITEM_ROW_SCROLL_SYNC_KEY:if(this.getEnableRowScrollSync()!==p[i].value){this.setEnableRowScrollSync(p[i].value);}break;case sap.gantt.config.SETTING_ITEM_ENABLE_CURSOR_LINE_KEY:if(this.getEnableCursorLine()!==p[i].value){this.setEnableCursorLine(p[i].value);}break;case sap.gantt.config.SETTING_ITEM_ENABLE_NOW_LINE_KEY:if(this.getEnableNowLine()!==p[i].value){this.setEnableNowLine(p[i].value);}break;case sap.gantt.config.SETTING_ITEM_ENABLE_VERTICAL_LINE_KEY:if(this.getEnableVerticalLine()!==p[i].value){this.setEnableVerticalLine(p[i].value);}break;default:this.fireCustomSettingChange(p[i]);}}};G.prototype.switchOrientation=function(o,r){var s=this._oSplitter.getOrientation()===O.Horizontal?O.Vertical:O.Horizontal;s=o?o:s;if(r){var c=this.getContainerLayoutKey();if(this._oContainerLayoutConfigMap[c]){s=this._oContainerLayoutConfigMap[c].getOrientation();}}else{this._resetSplitterLayoutData(s);}this._oSplitter.setOrientation(s);return this;};G.prototype._resetSplitterLayoutData=function(o){var s;var g=this.getGanttCharts();var c=this._oSplitter.getContentAreas();for(var l=0;l<c.length;l++){if(c[l].getLayoutData()){if(c[l].getLayoutData().getSize()==="auto"){c[l].getLayoutData().setSize("100%");}c[l].getLayoutData().setSize("auto");}}for(var i=0;i<g.length;i++){s=g[i]._oSplitter;var d=s.getContentAreas();for(var j=0;j<d.length;j++){if(d[j].getLayoutData()){if(o===O.Vertical){if(j==0&&d.length>1){d[j].getLayoutData().setSize("30%");}else{d[j].getLayoutData().setSize("auto");}}else{d[j].getLayoutData().setSize("auto");}}}}};G.prototype.getToolbarSchemeKey=function(){return this._oToolbar.getToolbarSchemeKey();};G.prototype.selectShapes=function(g,I,c){var d=this.getGanttCharts(),r=false,o;if(g!=undefined&&g<d.length){o=d[g];r=o.selectShapes(I,c);}else{for(var i=0;i<d.length;i++){o=d[i];if(o.selectShapes(I,c)){r=true;}}}return r;};G.prototype.deselectShapes=function(g,i){var c=this.getGanttCharts(),r=false,o;if(g!=undefined&&g<this.getGanttCharts().length){o=this.getGanttCharts()[g];r=o.deselectShapes(i);}else{for(var d in c){o=c[d];if(o.deselectShapes(i)){r=true;}}}return r;};G.prototype.selectRelationships=function(g,I,c){var d=this.getGanttCharts(),r=false,o;if(g!=undefined&&g<d.length){o=d[g];r=o.selectRelationships(I,c);}else{for(var i=0;i<d.length;i++){o=d[i];if(o.selectRelationships(I,c)){r=true;}}}return r;};G.prototype.deselectRelationships=function(g,I){var c=this.getGanttCharts(),r=false,o;if(g!=undefined&&g<c.length){o=c[g];r=o.deselectRelationships(I);}else{for(var i=0;i<c.length;i++){o=c[i];if(o.deselectRelationships(I)){r=true;}}}return r;};G.prototype.selectRows=function(g,I,c){var r=false,d=this.getGanttCharts(),o;if(g!=undefined&&g<d.length){o=d[g];r=o.selectRows(I,c);}else{for(var i=0;i<d.length;i++){o=d[i];if(o.selectRows(I,c)){r=true;}}}return r;};G.prototype.deselectRows=function(g,I){var r=false,c=this.getGanttCharts(),o;if(g!=undefined&&g<c.length){o=c[g];r=o.deselectRows(I);}else{for(var i=0;i<c.length;i++){o=c[i];if(o.deselectRows(I)){r=true;}}}return r;};G.prototype.selectRowsAndShapes=function(g,I,c){var r=false,d=this.getGanttCharts(),o;if(g!=undefined&&g<d.length){o=d[g];r=o.selectRowsAndShapes(I,c);}else{for(var i=0;i<d.length;i++){o=d[i];if(o.selectRowsAndShapes(I,c)){r=true;}}}return r;};G.prototype.getSelectedShapes=function(g){var r=[],c=this.getGanttCharts(),o,s;if(g!=undefined&&g<c.length){o=c[g];s=o.getSelectedShapes();if(s!==undefined){r.push({"ganttChartIndex":g,"selectedShapes":s});}}else{for(var i=0;i<c.length;i++){o=c[i];s=o.getSelectedShapes();if(s!==undefined){r.push({"ganttChartIndex":i,"selectedShapes":s});}}}return r;};G.prototype.getSelectedRows=function(g){var r=[],c=this.getGanttCharts(),o,R;if(g!=undefined&&g<c.length){o=c[g];R=o.getSelectedRows();if(R!==undefined&&R.length>0){r.push({"ganttChartIndex":g,"selectedRows":R});}}else{for(var i=0;i<c.length;i++){o=c[i];R=o.getSelectedRows();if(R!==undefined){r.push({"ganttChartIndex":i,"selectedRows":R});}}}return r;};G.prototype.getSelectedRelationships=function(g){var r=[],c=this.getGanttCharts(),o,R;if(g!=undefined&&g<c.length){o=c[g];R=o.getSelectedRelationships();if(R!==undefined){r.push({"ganttChartIndex":g,"selectedRelationships":R});}}else{for(var i=0;i<c.length;i++){o=c[i];R=o.getSelectedRelationships();if(R!==undefined){r.push({"ganttChartIndex":i,"selectedRelationships":R});}}}return r;};G.prototype.getAllSelections=function(g){var r=[],c=this.getGanttCharts(),o,s;if(g!=undefined&&g<c.length){o=c[g];s=o.getAllSelections();if(s!==undefined){r.push({"ganttChartIndex":g,"allSelection":s});}}else{for(var i=0;i<c.length;i++){o=c[i];s=o.getAllSelections();if(s!==undefined){r.push({"ganttChartIndex":i,"allSelection":s});}}}return r;};G.prototype.exit=function(){this._detachEvents();this._oToolbar.destroy();this._oSplitter.destroy();};return G;},true);};if(!jQuery.sap.isDeclared('sap.gantt.config.SettingGroup')){jQuery.sap.declare('sap.gantt.config.SettingGroup');sap.ui.define("sap/gantt/config/SettingGroup",["./ToolbarGroup","./SettingItem"],function(T,S){"use strict";var a=T.extend("sap.gantt.config.SettingGroup",{library:"sap.gantt",metadata:{properties:{items:{type:"array",defaultValue:sap.gantt.config.DEFAULT_TOOLBAR_SETTING_ITEMS}}}});return a;},true);};if(!jQuery.sap.isDeclared('sap.gantt.legend.LegendBase')){jQuery.sap.declare('sap.gantt.legend.LegendBase');jQuery.sap.require('sap.ui.core.Control');jQuery.sap.require('sap.ui.thirdparty.d3');sap.ui.define("sap/gantt/legend/LegendBase",["sap/ui/core/Control","sap/gantt/misc/Utility","../misc/AxisTime","sap/ui/thirdparty/d3"],function(C,U,A){"use strict";var L=C.extend("sap.gantt.legend.LegendBase",{metadata:{abstract:true,properties:{svgDefs:{type:"array"},legendWidth:{type:"number",defaultValue:32},legendHeight:{type:"number",defaultValue:32},fontSize:{type:"number",defaultValue:16}}}});L.prototype.TIME_RANGE=["20160101000000","20160103000000"];L.prototype.TIME="20160102000000";L.prototype.init=function(){this._aTimeRange=[d3.time.format("%Y%m%d%H%M%S").parse(this.TIME_RANGE[0]),d3.time.format("%Y%m%d%H%M%S").parse(this.TIME_RANGE[1])];};L.prototype.getAxisTime=function(){return this._oAxisTime;};L.prototype.onBeforeRendering=function(){this._sUiSizeMode=U.findSapUiSizeClass();this._aViewRange=[0,this._getScaledLegendWidth()];this._oAxisTime=new A(this._aTimeRange,this._aViewRange);};L.prototype._getScaledLegendWidth=function(){return U.scaleBySapUiSize(this.getSapUiSizeClass(),this.getLegendWidth());};L.prototype._getScaledLegendHeight=function(){return U.scaleBySapUiSize(this.getSapUiSizeClass(),this.getLegendHeight());};L.prototype.getSapUiSizeClass=function(){return this._sUiSizeMode;};return L;},true);};if(!jQuery.sap.isDeclared('sap.gantt.legend.ListLegend')){jQuery.sap.declare('sap.gantt.legend.ListLegend');sap.ui.define("sap/gantt/legend/ListLegend",["./LegendBase","sap/gantt/drawer/ListLegend","sap/gantt/drawer/CalendarPattern"],function(L,a,C){"use strict";var b=L.extend("sap.gantt.legend.ListLegend",{metadata:{properties:{shapes:{type:"array"}}}});b.prototype.init=function(){L.prototype.init.apply(this,arguments);this._oListLegendDrawer=new a();};b.prototype.onAfterRendering=function(){for(var i=0;i<this._aShapeInstance.length;i++){var s=this._aShapeInstance[i];var S=d3.select("#"+this.getId()+"-svg-"+i);this._oListLegendDrawer._drawPerTag(S,s);}};b.prototype.setShapes=function(s){if(s&&s.length>0){this._aShapeInstance=this._instantShape(s);this.setProperty("shapes",s);}return this;};b.prototype._instantShape=function(s){var r=[];for(var i=0;i<s.length;i++){if(s[i].getShapeClassName()){var S=this._instantiateCustomerClass(s[i].getShapeClassName(),i,s[i]);if(s[i].getClippathAggregation()&&s[i].getClippathAggregation()instanceof Array){var p=this._instantShape(s[i].getClippathAggregation());r=r.concat(p);}else if(s[i].getGroupAggregation()&&s[i].getGroupAggregation()instanceof Array){var A=this._instantShape(s[i].getGroupAggregation());for(var k=0;k<A.length;k++){S.addShape(A[k]);}}if(this._isProperShape(S)){r.push(S);}}}return r;};b.prototype._isProperShape=function(s){if(s instanceof sap.gantt.shape.cal.Calendar){jQuery.sap.log.warning("Calendar is not proper shape","key '"+s.mShapeConfig.getKey()+"'","ListLegend");return false;}else if(s.getTag()=="clippath"){return false;}else{return true;}};b.prototype._instantiateCustomerClass=function(c,s,S){var d=jQuery.sap.getObject(c);if(!d){jQuery.sap.require(c);d=jQuery.sap.getObject(c);}var o=new d();o.mShapeConfig=S;o.mChartInstance=this;return o;};return b;},true);};if(!jQuery.sap.isDeclared('sap.gantt.shape.ext.ubc.UbcOverCapacityZonePolygon')){jQuery.sap.declare('sap.gantt.shape.ext.ubc.UbcOverCapacityZonePolygon');sap.ui.define("sap/gantt/shape/ext/ubc/UbcOverCapacityZonePolygon",["sap/gantt/misc/Utility","sap/gantt/shape/ext/ubc/UbcPolygon"],function(U,a){"use strict";var b=a.extend("sap.gantt.shape.ext.ubc.UbcOverCapacityZonePolygon",{});b.prototype.getFill=function(d,r){if(this.mShapeConfig.hasShapeProperty("fill")){return this._configFirst("fill",d);}var c,p;if(this.mShapeConfig.hasShapeProperty("backgroundColor")){c=this._configFirst("backgroundColor",d);}if(this.mShapeConfig.hasShapeProperty("pattern")){p=this._configFirst("pattern",d);}var P;if(c&&p){P="pattern_"+p+"_"+(c.indexOf("#")==0?c.substring(1,c.length):c);}if(P&&sap.ui.getCore().byId(P)){return sap.ui.getCore().byId(P).getRefString();}};b.prototype.getStroke=function(d,r){if(this.mShapeConfig.hasShapeProperty("stroke")){return this._configFirst("stroke",d);}return"#CAC7BA";};b.prototype.getStrokeWidth=function(d,r){if(this.mShapeConfig.hasShapeProperty("strokeWidth")){return this._configFirst("strokeWidth",d);}return 0.3;};b.prototype.getPoints=function(d,r){if(this.mShapeConfig.hasShapeProperty("points")){return this._configFirst("points",d);}var o="";var v=this.getShapeViewBoundary();if(v){o=v[0]+","+r.y+" "+(v[1]-v[0])+","+r.y+" "+(v[1]-v[0])+","+(r.y+r.rowHeight)+" "+v[0]+","+(r.y+r.rowHeight);return o;}};return b;},true);};if(!jQuery.sap.isDeclared('sap.gantt.shape.ext.ulc.UlcOverCapacityZoneRectangle')){jQuery.sap.declare('sap.gantt.shape.ext.ulc.UlcOverCapacityZoneRectangle');sap.ui.define("sap/gantt/shape/ext/ulc/UlcOverCapacityZoneRectangle",["sap/gantt/shape/ext/ulc/UlcRectangle"],function(U){"use strict";var a=U.extend("sap.gantt.shape.ext.ulc.UlcOverCapacityZoneRectangle",{});a.prototype.getFill=function(d,r){if(this.mShapeConfig.hasShapeProperty("fill")){return this._configFirst("fill",d);}var c,p;if(this.mShapeConfig.hasShapeProperty("backgroundColor")){c=this._configFirst("backgroundColor",d);}if(this.mShapeConfig.hasShapeProperty("pattern")){p=this._configFirst("pattern",d);}var P;if(c&&p){P="pattern_"+p+"_"+(c.indexOf("#")==0?c.substring(1,c.length):c);}if(P&&sap.ui.getCore().byId(P)){return sap.ui.getCore().byId(P).getRefString();}return"#F6F6F6";};a.prototype.getStroke=function(d,r){if(this.mShapeConfig.hasShapeProperty("stroke")){return this._configFirst("stroke",d);}return"#CAC7BA";};a.prototype.getStrokeWidth=function(d,r){if(this.mShapeConfig.hasShapeProperty("strokeWidth")){return this._configFirst("strokeWidth",d);}return 0;};return a;},true);};if(!jQuery.sap.isDeclared('sap.gantt.shape.ext.ulc.UlcOverClipRectangle')){jQuery.sap.declare('sap.gantt.shape.ext.ulc.UlcOverClipRectangle');sap.ui.define("sap/gantt/shape/ext/ulc/UlcOverClipRectangle",["sap/gantt/shape/ext/ulc/UlcRectangle"],function(U){"use strict";var a=U.extend("sap.gantt.shape.ext.ulc.UlcOverClipRectangle",{});a.prototype.getFill=function(d,r){if(this.mShapeConfig.hasShapeProperty("fill")){return this._configFirst("fill",d);}return"#FF0000";};a.prototype.getClipPath=function(d,r){if(this.mShapeConfig.hasShapeProperty("clipPath")){return this._configFirst("clipPath",d);}var u=r.uid;var p=new RegExp("\\[|\\]|:|\\|","g");var n=u.replace(p,"_");return"url(#"+n+"_"+d.id+"_"+d.dimension+")";};return a;},true);};if(!jQuery.sap.isDeclared('sap.gantt.GanttChart')){jQuery.sap.declare('sap.gantt.GanttChart');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.Core');jQuery.sap.require('sap.ui.table.TreeTable');jQuery.sap.require('sap.ui.table.Row');jQuery.sap.require('sap.ui.core.theming.Parameters');jQuery.sap.require('sap.ui.thirdparty.d3');sap.ui.define("sap/gantt/GanttChart",['jquery.sap.global',"sap/gantt/GanttChartBase","sap/ui/core/Core","sap/ui/table/TreeTable","sap/ui/table/Row","sap/gantt/misc/Utility",'sap/ui/core/theming/Parameters',"sap/gantt/shape/SelectedShape","sap/gantt/shape/ext/rls/SelectedRelationship","sap/gantt/drawer/ShapeInRow","sap/gantt/drawer/ShapeCrossRow","sap/gantt/drawer/CursorLine","sap/gantt/drawer/NowLine","sap/gantt/drawer/VerticalLine","sap/gantt/drawer/CalendarPattern","sap/gantt/misc/AxisTime","sap/gantt/misc/AxisOrdinal","sap/gantt/misc/Format","sap/gantt/misc/TreeTableHelper","sap/ui/thirdparty/d3"],function(q,G,C,T,R,U,P,S,a,b,c,e,N,V,f,A,h,F,l){"use strict";var n=G.extend("sap.gantt.GanttChart",{metadata:{aggregations:{_treeTable:{type:"sap.ui.table.TreeTable",multiple:false,visibility:"hidden"}}}});n.prototype.init=function(){q.sap.measure.start("GanttChart init","GanttPerf:GanttChart init function");this._oTT=new T({visibleRowCountMode:"Auto",minAutoRowCount:1,selectionBehavior:sap.ui.table.SelectionBehavior.RowOnly,selectionMode:sap.ui.table.SelectionMode.Multi,columnHeaderVisible:false});this._oTT.addColumn(new sap.ui.table.Column());this.setAggregation("_treeTable",this._oTT);this._oTT._oHSb.detachScroll(this._oTT.onhscroll,this._oTT);this._oTT._oHSb.attachScroll(this._onHSbScroll,this);this._oTT._oVSb.detachScroll(this._oTT.onvscroll,this._oTT);this._oTT._oVSb.attachScroll(this._onVSbScroll,this);this._oTT.attachEvent("_rowsUpdated",this._onTTRowUpdate.bind(this));this._oTT.addEventDelegate({onAfterRendering:this._onTTRowUpdate},this);this._oTT.attachEvent("_rowSelectionChange",this._onRowSelectionChange.bind(this));this._oTT.attachRowSelectionChange(this._onRowSelectionChange,this);this._oTT.addEventDelegate({onAfterRendering:this._updateCSSForDummyRow},this);this._oShapeInRowDrawer=new b();this._oShapeCrossRowDrawer=new c();this._oCursorLineDrawer=new e();this._oCalendarPatternDrawer=new f();this._oAxisTime=undefined;this._oAxisOrdinal=undefined;this._aShapeData=undefined;this._aShapeInstance=undefined;this._oShapeInstance=undefined;this._oZoom={base:{}};this._oDataNamePerType={};this._fLeftOffsetRate=0.0;this._oStatusSet=null;this._nLowerRange=0;this._nUpperRange=0;this._aSelectedRelationships=undefined;this._oSelectedShapes={};this._aSelectedShapeUids=[];this._iMouseDown=0;this._bMouseDown=false;this._bDragging=false;this._oDraggingData=undefined;this._lastHoverRowIndex=undefined;this._oChartSchemesConfigMap={};this._oChartSchemesConfigMap[sap.gantt.config.DEFAULT_CHART_SCHEME_KEY]=sap.gantt.config.DEFAULT_CHART_SCHEME;this._oObjectTypesConfigMap={};this._oObjectTypesConfigMap[sap.gantt.config.DEFAULT_OBJECT_TYPE_KEY]=sap.gantt.config.DEFAULT_OBJECT_TYPE;this._fExtendFactor=0.382;this._calZoomFromTimeAxisConfig(sap.gantt.config.DEFAULT_TIME_AXIS);this._createAxisTime(sap.gantt.config.DEFAULT_TIME_AXIS);this._mDrawDelayMS=500;this._mTimeouts={};q.sap.measure.end("GanttChart init");};n.prototype.setTimeAxis=function(t){this.setProperty("timeAxis",t,true);this._calZoomFromTimeAxisConfig(t);this._createAxisTime(t);this._oStatusSet=null;this._draw(true);return this;};n.prototype.setLocale=function(L){this.setProperty("locale",L,true);this._oAxisTime.setLocale(L);this._drawShapes();this._drawSelectedShapes();return this;};n.prototype.setChartSchemes=function(d){this.setProperty("chartSchemes",d,true);this._oChartSchemesConfigMap={};if(d){for(var i=0;i<d.length;i++){this._oChartSchemesConfigMap[d[i].getKey()]=d[i];}}this._drawShapes();this._drawSelectedShapes();return this;};n.prototype.setObjectTypes=function(o){this.setProperty("objectTypes",o,true);this._oObjectTypesConfigMap={};if(o){for(var i=0;i<o.length;i++){this._oObjectTypesConfigMap[o[i].getKey()]=o[i];}}this._drawShapes();this._drawSelectedShapes();return this;};n.prototype.setSelectionMode=function(s){this.setProperty("selectionMode",s);if(this._oTT){if(s==sap.gantt.SelectionMode.MultiWithKeyboard){this._oTT.setSelectionMode(sap.ui.table.SelectionMode.Multi);}else if(s==sap.gantt.SelectionMode.Multiple){this._oTT.setSelectionMode(sap.ui.table.SelectionMode.MultiToggle);}else if(s==sap.gantt.SelectionMode.Single){this._oTT.setSelectionMode(sap.ui.table.SelectionMode.Single);}else{this._oTT.setSelectionMode(sap.ui.table.SelectionMode.None);}}return this;};n.prototype._calZoomFromTimeAxisConfig=function(t){if(!t){return;}this._oZoom.base.sGranularity=t.getGranularity();var g=t.getZoomStrategy()[this._oZoom.base.sGranularity];this._oZoom.determinedByConfig={fRate:1};var o=t.getZoomStrategy()[t.getFinestGranularity()];var d=t.getZoomStrategy()[t.getCoarsestGranularity()];var s=d3.time.format("%Y%m%d%H%M%S").parse("20000101000000");var B=q.sap.getObject(g.innerInterval.unit).offset(s,g.innerInterval.span);this._oZoom.base.fScale=this._calZoomScale(s,B,g.innerInterval.range);var m=q.sap.getObject(o.innerInterval.unit).offset(s,o.innerInterval.span);var M=this._calZoomScale(s,m,o.innerInterval.range*4);var i=q.sap.getObject(d.innerInterval.unit).offset(s,d.innerInterval.span);var j=this._calZoomScale(s,i,d.innerInterval.range);this._oZoom.determinedByConfig.fMaxRate=this._oZoom.base.fScale/M;this._oZoom.determinedByConfig.fMinRate=this._oZoom.base.fScale/j;};n.prototype._calZoomScale=function(s,E,L){return(E.valueOf()-s.valueOf())/L;};n.prototype._createAxisTime=function(o){var s=o.getZoomStrategy();var H=d3.time.format("%Y%m%d%H%M%S").parse(o.getPlanHorizon().getStartTime());var d=d3.time.format("%Y%m%d%H%M%S").parse(o.getPlanHorizon().getEndTime());var g=d.valueOf()-H.valueOf();var i=s[o.getGranularity()];var j=q.sap.getObject(i.innerInterval.unit).offset(H,i.innerInterval.span).valueOf()-H.valueOf();this._oAxisTime=new A([H,d],[0,Math.ceil(g*i.innerInterval.range/j)],o.getRate(),null,null,this.getLocale(),C.getConfiguration().getRTL(),o.getZoomStrategy());this._nLowerRange=this._oAxisTime.getViewRange()[0];this._nUpperRange=Math.ceil(this._oAxisTime.getViewRange()[1]);};n.prototype.setShapes=function(s){this.setProperty("shapes",s,true);if(s&&s.length>0){this._oShapesConfigMap={};for(var i=0;i<s.length;i++){this._oShapesConfigMap[s[i].getKey()]=s[i];}this._parseAndSortShape(this._oShapesConfigMap);this._drawShapes();this._drawSelectedShapes();}return this;};n.prototype._parseAndSortShape=function(s,t){var r=[];var d,o,g,m,p,u;for(var i in s){d=t?t:i;o={};if(s[i].getShapeClassName()){o=this._instantiateCustomerClass(s[i].getShapeClassName(),i,s[i],d);var v=o.getCategory(null,this._oAxisTime,this._oAxisOrdinal);if(!t){u=s[i].getSelectedClassName();if(!u){if(v==sap.gantt.shape.ShapeCategory.Relationship){u="sap.gantt.shape.ext.rls.SelectedRelationship";g=new a();}else{u="sap.gantt.shape.SelectedShape";}}g=this._instantiateCustomerClass(u,"selected"+i,s[i],d);o.setAggregation("selectedShape",g);}if(s[i].getGroupAggregation()&&s[i].getGroupAggregation()instanceof Array){m=this._parseAndSortShape(s[i].getGroupAggregation(),d);for(var k=0;k<m.length;k++){o.addShape(m[k]);}}else if(s[i].getClippathAggregation()&&s[i].getClippathAggregation()instanceof Array){p=this._parseAndSortShape(s[i].getClippathAggregation(),d);for(var j=0;j<p.length;j++){o.addPath(p[j]);}}}r.push(o);}if(t){return r;}else{r.sort(function(x,y){var z=q.isNumeric(x.mShapeConfig.getLevel())?x.mShapeConfig.getLevel():99;var B=q.isNumeric(y.mShapeConfig.getLevel())?y.mShapeConfig.getLevel():99;return B-z;});this._aShapeInstance=r;var w={};q.each(this._aShapeInstance,function(K,x){w[x.mShapeConfig.getKey()]=x;});this._oShapeInstance=w;}};n.prototype._instantiateCustomerClass=function(s,d,o,t){var g=q.sap.getObject(s);if(!g){q.sap.require(s);g=q.sap.getObject(s);}var i=new g();var j=t;if(j===undefined){j=d;}this._storeCustomerClassId(d,i.getId(),t);i.mLocaleConfig=this.getLocale();i.mShapeConfig=o;i.mChartInstance=this;return i;};n.prototype._storeCustomerClassId=function(s,i,t){if(!this._customerClassIds){this._customerClassIds={};}if(this._oShapesConfigMap[s]){this._customerClassIds[s]={"classId":i,"topShapeId":t};}else{var d=t+"_"+s;this._customerClassIds[d]={"classId":i,"topShapeId":t};}};n.prototype._getIdByShapeId=function(s){if(this._customerClassIds&&this._customerClassIds[s]){return this._customerClassIds[s].classId;}return null;};n.prototype._getShapeIdById=function(s){if(this._customerClassIds){for(var d in this._customerClassIds){var o=this._customerClassIds[d];if(o.classId===s){return{"shapeId":d,"topShapeId":o.topShapeId};}}}return null;};n.prototype._genShapeConfig=function(s,p){var o={},d;if(s!==null&&s!==undefined){o.shapeId=s;}if(p.data){o.data=p.data;}if(p.level){o.level=p.level;}if(p.draw){d=p.draw;}else{d=p;}for(var i in d){if(i!=="class"){o[i]=d[i];}}return o;};n.prototype.calculateZoomInfoFromChartWidth=function(i){var t=this.getTimeAxis();var p=t.getPlanHorizon();var I=t.getInitHorizon();this._oZoom.determinedByChartWidth={};if(p){var m=this._calZoomScale(F.abapTimestampToDate(p.getStartTime()),F.abapTimestampToDate(p.getEndTime()),i);this._oZoom.determinedByChartWidth.fMinRate=this._oZoom.base.fScale/m;}if(I&&I.getStartTime()&&I.getEndTime()){var s=this._calZoomScale(F.abapTimestampToDate(I.getStartTime()),F.abapTimestampToDate(I.getEndTime()),i);this._oZoom.determinedByChartWidth.fSuitableRate=this._oZoom.base.fScale/s;}this._oZoom.iChartWidth=i;return this._oZoom;};n.prototype.setTimeZoomRate=function(t){this.setProperty("timeZoomRate",t,true);this._oAxisTime.setZoomRate(t);this._oAxisTime.setViewOffset(0);this._oStatusSet=null;this._nLowerRange=this._oAxisTime.getViewRange()[0];this._nUpperRange=Math.ceil(this._oAxisTime.getViewRange()[1]);this._draw(true);return this;};n.prototype.getBaseRowHeight=function(){if(this._oTT.getRows()[0]&&this._oTT.getRows()[0].getDomRef()){return this._oTT.getRows()[0].getDomRef().scrollHeight;}};n.prototype.updateRelationships=function(r){var B=this.getBinding("relationships");if(B){var d=B.getContexts(0,0);if(d&&d.length>0){this._aRelationshipsContexts=d;}}};n.prototype.addRelationship=function(r){q.sap.log.error("The control manages the relationships aggregation. The method \"addRelationship\" cannot be used programmatically!");};n.prototype.insertRelationship=function(i,r){q.sap.log.error("The control manages the relationships aggregation. The method \"insertRelationship\" cannot be used programmatically!");};n.prototype.removeRelationship=function(r){q.sap.log.error("The control manages the relationships aggregation. The method \"removeRelationship\" cannot be used programmatically!");};n.prototype.getRelationships=function(){q.sap.log.error("The control manages the relationships aggregation. The method \"getRelationships\" cannot be used programmatically!");};n.prototype.destroyRelationships=function(){q.sap.log.error("The control manages the relationships aggregation. The method \"destroyRelationships\" cannot be used programmatically!");};n.prototype.indexOfRelationship=function(r){q.sap.log.error("The control manages the relationships aggregation. The method \"indexOfRelationship\" cannot be used programmatically!");};n.prototype.removeAllRelationships=function(){q.sap.log.error("The control manages the relationships aggregation. The method \"removeAllRelationships\" cannot be used programmatically!");};n.prototype._bindAggregation=function(s,B){if(s=="rows"&&B){var m=this.getModel(B.model);var o=this.getBindingContext(B.model);if(o&&m){B.path=m.resolve(B.path,o);}this._oTT.bindRows(B);}else{return sap.ui.core.Control.prototype._bindAggregation.apply(this,arguments);}};n.prototype.onBeforeRendering=function(){this._detachEvents();this._updateModelForMultiMainRow();};n.prototype._updateModelForMultiMainRow=function(){var B=this._oTT.getBinding("rows");if(!B||B.getLength()===0){return;}var r=B.getContexts(0,B.getLength());var o={},d=1,m,t=r[0].getProperty("type");if(t&&this._oObjectTypesConfigMap[t]){m=this._oObjectTypesConfigMap[t].getProperty("mainChartSchemeKey");if(m&&this._oChartSchemesConfigMap[m]){d=this._oChartSchemesConfigMap[m].getProperty("rowSpan");}}if(d==1||d==undefined){return;}for(var i=0;i<r.length;i++){var g=r[i].getProperty();if(l.isDummyRow(this._oTT,i)){continue;}if(i<r.length-1){if(l.isDummyRow(this._oTT,i+1)){continue;}}g.previousNodeNum=0;g.afterNodeNum=d-1;var D={"chartScheme":m,"mainRowId":g.id};var k=[];for(var j=1;j<d;j++){var p=q.extend(true,{},D);p.previousNodeNum=j;p.afterNodeNum=d-j-1;k.push(p);}o[i]=k;}if(!$.isEmptyObject(o)){l.addDummyData(this._oTT,o,false);}};n.prototype._detachEvents=function(){q("#"+this.getId()+"-svg-ctn").unbind("mousemove",this._onSvgCtnMouseMove);q("#"+this.getId()+"-svg-ctn").unbind("mouseleave",this._onSvgCtnMouseLeave);q("#"+this.getId()+"-svg-ctn").unbind("mousedown",this._onSvgCtnMouseDown);q("#"+this.getId()+"-svg-ctn").unbind("mouseenter",this._onSvgCtnMouseEnter);q("#"+this.getId()+"-svg-ctn").unbind("mouseup",this._onSvgCtnMouseUp);};n.prototype.onAfterRendering=function(){this._attachEvents();};n.prototype._attachEvents=function(){var d=q("#"+this.getId()+"-svg-ctn");d.bind("mousemove",this._onSvgCtnMouseMove.bind(this));d.bind("mouseleave",this._onSvgCtnMouseLeave.bind(this));d.bind("mousedown",this._onSvgCtnMouseDown.bind(this));d.bind("mouseenter",this._onSvgCtnMouseEnter.bind(this));d.bind("mouseup",this._onSvgCtnMouseUp.bind(this));};n.prototype.expandChartChange=function(d,E,g){if(E.length<0){return;}q.sap.measure.start("GanttChart expandChartChange","GanttPerf:GanttChart expandChartChange function");var s=(g&&g.length>0)?g:this._oTT.getSelectedIndices();var k;if(d){for(k=0;k<E.length;k++){var j=E[k];var m;if(this._oChartSchemesConfigMap[j]&&this._oChartSchemesConfigMap[j].getModeKey()){m=this._oChartSchemesConfigMap[j].getModeKey();}else{m=this.getMode();}var o={};for(var i=0;i<s.length;i++){if(l.isDummyRow(this._oTT,s[i])){continue;}var p=l.getContextObject(this._oTT,s[i]);var D={"__group":E[k],"parentData":p,"parentRefId":p.id};if(this._oObjectTypesConfigMap[p.type]&&this._oObjectTypesConfigMap[p.type].getExpandedChartSchemeKeys().length>0){var v=this._oObjectTypesConfigMap[p.type].getExpandedChartSchemeKeys();if($.inArray(j,v)>-1){var r,t=1;var u=this._collectDataNameForValidChartScheme(j,m);if(u){r=u.drawData;t=u.rowSpan;var w=this._insertExpandedRowsToTT(s[i],r,D,t);if(w&&w.length>0){o[s[i]]=w;}}}}}if(!$.isEmptyObject(o)){l.addDummyData(this._oTT,o,true);}}}else{for(k=0;k<E.length;k++){l.removeDummyDataFromSelectedIndices(this._oTT,s,E[k]);}}q.sap.measure.end("GanttChart expandChartChange");};n.prototype._collectDataNameForValidChartScheme=function(s,m){if(this._oChartSchemesConfigMap[s]){var d=[],r;var g=this._oChartSchemesConfigMap[s].getShapeKeys();r=this._oChartSchemesConfigMap[s].getRowSpan();var t=this;q.each(g,function(k,v){if(t._oShapesConfigMap[v]){var M=t._oShapesConfigMap[v].getModeKeys();if((M&&M.length>0&&$.inArray(m,M)>-1)||M.length==0||m==sap.gantt.config.DEFAULT_MODE_KEY){d.push(t._oShapesConfigMap[v].getShapeDataName());}}});if(d.length>0&&r>=1){return{"drawData":d,"rowSpan":r};}}};n.prototype._insertExpandedRowsToTT=function(s,d,D,r){var o=l.getContextObject(this._oTT,s);if(d&&d.length>0){var g=1,H=false;$.each(d,function(m,p){if(o[p]&&o[p].length>0){H=true;for(var i=0;i<o[p].length;i++){if(o[p][i].rowIndex!==undefined&&o[p][i].rowIndex>g){g=o[p][i].rowIndex;}}}});if(!H){return[];}var j=[],k,t;if(g>1&&r==1){for(k=0;k<g;k++){t=q.extend(true,{},D);t.index=k+1;j.push(t);}}else{D.index=1;for(k=0;k<r;k++){t=q.extend(true,{},D);j.push(t);}}return j;}return[];};n.prototype._composeParameterForClickPosition=function(d){var s=q("#"+this.getId()+"-svg");var o=this._getSvgCoodinateByDiv(s[0],d.pageX,d.pageY);var x=d.pageX-s.offset().left||d.offsetX;var y=d.pageY-s.offset().top||d.offsetY;if(!this._oAxisOrdinal){return;}var r,i=this._oAxisOrdinal.viewToRowIndex(y,this._oTT.getVisibleRowCount())+this._oTT.getFirstVisibleRow();var L,g=i;if(l.isMultipleSpanMainRow(this._oTT,i)){var m=l.getMultipleSpanMainRowGroupIndices(this._oTT,i);g=m[0];}if(g!==i){L=l.getContextObject(this._oTT,g);}var j=this._oAxisTime.viewToTime(x);r=l.getContextObject(this._oTT,i);var p={"startTime":j,"svgPoint":o,"leadingRowNum":g,"leadingRowInfo":L,"rowIndex":i,"rowInfo":r};return p;};n.prototype.getAllSelections=function(){var s=this.getSelectedRows();var d=this.getSelectedShapes();var g=this.getSelectedRelationships();var i={"rows":s,"shapes":d,"relationships":g};return i;};n.prototype.getSelectedRows=function(){var s=[];var d=this._oTT.getFirstVisibleRow();var g=this._oTT.getSelectedIndices();for(var i=0;i<g.length;i++){var r=g[i]-d;if(r>-1&&this._aShapeData[r]!==undefined){s.push(this._aShapeData[r]);}}return s;};n.prototype.getSelectedShapes=function(){var s=this._oSelectedShapes;return s;};n.prototype.getSelectedRelationships=function(){return this._aSelectedRelationships;};n.prototype.selectShapes=function(I,d){var i,j,s,o;var g=false;if(this._aSelectedShapeUids===undefined){this._aSelectedShapeUids=[];}if(I===undefined||I.length<1){if(d&&this._aSelectedShapeUids.length>0){this._oSelectedShapes={};this._aSelectedShapeUids=[];g=true;}}else if(d){this._oSelectedShapes={};this._aSelectedShapeUids=[];for(i=0;i<I.length;i++){s=this._getShapeDataById(I[i],false);for(j=0;j<s.length;j++){o=s[j];if(this._judgeEnableSelection(o)){var u=this._selectShape(o);if(u){g=true;}}}}}else{for(i=0;i<I.length;i++){s=this._getShapeDataById(I[i],false);for(j=0;j<s.length;j++){o=s[j];if(q.inArray(o.uid,this._aSelectedShapeUids)>-1){continue;}else if(this._judgeEnableSelection(o)&&this._selectShape(o)){g=true;}}}}if(g){this._drawSelectedShapes();}return g;};n.prototype.deselectShapes=function(I){var s=false;for(var i=0;i<I.length;i++){var d=this._getShapeDataById(I[i]);var u;for(var j=0;j<d.length;j++){u=this._deselectShape(d[j]);if(u){s=true;}}}if(s){this._drawSelectedShapes();}return s;};n.prototype.selectRowsAndShapes=function(I,d){var s=false;var r=this.selectRows(I,d);if(d){this._oSelectedShapes={};this._aSelectedShapeUids=[];}if(this._aSelectedShapeUids===undefined){this._aSelectedShapeUids=[];}for(var g in I){var j=I[g];var o=this._getRowById(j);if(o!==undefined){for(var k in o.data){if(o.data[k]instanceof Array){for(var i=0;i<o.data[k].length;i++){var m=o.data[k][i];if(q.inArray(m.uid,this._aSelectedShapeUids)<0){this._selectShape(m);s=true;}}}}}}if(s){this._drawSelectedShapes();}else if(r){s=true;}return s;};n.prototype.selectRelationships=function(I,d){var i,r;var s=false;if(this._aSelectedRelationships===undefined){this._aSelectedRelationships=[];}if(I===undefined||I.length<1){if(d&&this._aSelectedRelationships.length>0){this._aSelectedRelationships=[];s=true;}}else if(d){if(I.length==this._aSelectedRelationships.length){for(i=0;i<I.length;i++){r=this._getShapeDataById(I[i],true)[0];if(r!==undefined&&q.inArray(r,this._aSelectedRelationships)>=0){continue;}else{s=true;break;}}}this._aSelectedRelationships=[];for(i=0;i<I.length;i++){r=this._getShapeDataById(I[i],true)[0];if(r!==undefined&&r!==null&&this._judgeEnableSelection(r)){this._aSelectedRelationships.push(r);s=true;}}}else{for(i=0;i<I.length;i++){r=this._getShapeDataById(I[i],true)[0];if(r===undefined||q.inArray(r,this._aSelectedRelationships)>=0){continue;}else if(this._judgeEnableSelection(r)){this._aSelectedRelationships.push(r);s=true;}}}if(s){this._drawSelectedShapes();}return s;};n.prototype.deselectRelationships=function(I){var s=false;var u=[];if(I!==undefined){for(var i=0;i<I.length;i++){var d=this._getUidById(I[i],true)[0];if(d!==undefined){u.push(d);}}}for(var j in this._aSelectedRelationships){var o=this._aSelectedRelationships[j];if(q.inArray(o.uid,u)>-1){var g=this._aSelectedRelationships.indexOf(o);this._aSelectedRelationships.splice(g,1);s=true;}}if(s){this._drawSelectedShapes();}return s;};n.prototype.selectRows=function(I,d){var s=false;var v=this._oTT.getRows();var g=this._oTT.getSelectedIndices();if(d&&g.length>0){this._oTT.clearSelection();s=true;}for(var i in v){var r=d3.select("#"+v[i].getId());var j=parseInt(r.attr("data-sap-ui-rowindex"),10);var o=this._aShapeData[j];if(o!==undefined&&q.inArray(o.data.id,I)>-1){if(q.inArray(j,g)<0){var k=this._oTT.getSelectionMode();if(k===sap.ui.table.SelectionMode.Multi){this._oTT.addSelectionInterval(j,j);}else{this._oTT.setSelectedIndex(j);}s=true;}}}return s;};n.prototype.deselectRows=function(I){var s=false;var d=this._oTT.getSelectedIndices();var v=this._oTT.getRows();for(var i in d){var g=d[i];var r=d3.select("#"+v[g].getId());var j=parseInt(r.attr("data-sap-ui-rowindex"),10);var o=this._aShapeData[j];if(q.inArray(o.data.id,I)){d.splice(g,1);this._oTT.removeSelectionInterval(g,1);s=true;}}return s;};n.prototype._isRelationship=function(s){if(this._getShapeDataNameByUid(s)===sap.gantt.shape.ShapeCategory.Relationship){return true;}return false;};n.prototype._onRowSelectionChange=function(E){var d=E.getParameter("rowIndices"),g=this._oTT.getSelectedIndices(),s=[],D=[];for(var i=0;i<d.length;i++){if(g.indexOf(d[i])===-1){D.push(d[i]);}else{s.push(d[i]);}}var t=this._oTT;var u=function(r,k){for(var j=0;j<r.length;j++){if(l.isMultipleSpanMainRow(t,r[j],true)){var M=l.getMultipleSpanMainRowGroupIndices(t,r[j],true);var o=M[0],L=M[M.length-1];for(var m=0;m<M.length;m++){if(k&&g.indexOf(M[m])===-1){t.addSelectionInterval(o,L);}else if(!k&&g.indexOf(M[m])!==-1){t.removeSelectionInterval(o,L);}}}}};u(s,true);u(D,false);this.fireRowSelectionChange({originEvent:E});};n.prototype._selectionChange=function(s,d,g,o){if(this._aSelectedRelationships==undefined){this._aSelectedRelationships=[];}if(this._aSelectedShapeUids==undefined){this._aSelectedShapeUids=[];}var i=false;var r=false;var t=s.uid;var j=this._isRelationship(t);if((d&&this.getSelectionMode()===sap.gantt.SelectionMode.MultiWithKeyboard)||this.getSelectionMode()===sap.gantt.SelectionMode.Multiple){if(!j){if(this._aSelectedShapeUids!==undefined&&q.inArray(t,this._aSelectedShapeUids)>-1){if(!this._bDragging){i=this._deselectShape(s);}}else{i=this._selectShape(s);}}else{if(q.inArray(s,this._aSelectedRelationships)<0){this._aSelectedRelationships.push(s);}else{var k=this._aSelectedRelationships.indexOf(s);this._aSelectedRelationships.splice(k,1);}r=true;}}else if(!j){if((q.inArray(t,this._aSelectedShapeUids)<0||this._aSelectedShapeUids.length>1)&&!this._bDragging){this._oSelectedShapes={};this._aSelectedShapeUids=[];i=true;}if(q.inArray(t,this._aSelectedShapeUids)<0){var u=this._selectShape(s);if(!i&&u){i=true;}}if(this._aSelectedRelationships.length>0){this._aSelectedRelationships=[];r=true;}}else{if((q.inArray(s,this._aSelectedRelationships)<0)||this._aSelectedRelationships.length>1){this._aSelectedRelationships=[];this._aSelectedRelationships.push(s);r=true;}if(this._aSelectedShapeUids!==undefined&&this._aSelectedShapeUids.length>0){this._oSelectedShapes={};this._aSelectedShapeUids=[];i=true;}}if(i||r){this._drawSelectedShapes();}return{shapeSelectionChange:i,relationshipSelectionChange:r};};n.prototype._setSelectedStatusToData=function(){for(var r in this._aShapeData){var o=this._aShapeData[r];for(var s in o.data){var d=o.data[s];if(d instanceof Array){for(var I=0;I<d.length;I++){var g=d[I];if(q.inArray(g.uid,this._aSelectedShapeUids)>-1){g.selected=true;}else{g.selected=false;}}}}}for(var i in this._aRelationships){this._aRelationships[i].selected=false;if(this._aSelectedRelationships!==undefined&&this._aSelectedRelationships.length>0){for(var j in this._aSelectedRelationships){if(this._aRelationships[i].uid===this._aSelectedRelationships[j].uid){this._aRelationships[i].selected=true;}}}}};n.prototype._setSelectedStatusFromData=function(s){this._oSelectedShapes={};this._aSelectedShapeUids=[];for(var r in this._aShapeData){var o=this._aShapeData[r];for(var d in o.data){var g=o.data[d];if(g instanceof Array&&q.inArray(d,s)>-1){for(var i=0;i<g.length;i++){var k=g[i];if(k.selected){if(this._oSelectedShapes[d]===undefined){this._oSelectedShapes[d]=[];}this._oSelectedShapes[d].push({"shapeUid":k.uid,"shapeData":k,"objectInfoRef":o});this._aSelectedShapeUids.push(k.uid);}}}}}this._aSelectedRelationships=[];for(var j in this._aRelationships){if(this._aRelationships[j].selected){this._aSelectedRelationships.push(this._aRelationships[j]);}}};n.prototype._syncTTSelection=function(d){q.sap.measure.start("GanttChart syncTTSelection","GanttPerf:GanttChart syncTTSelection function");var x=d.clientX;var y=d.clientY;var s=d.shiftKey;var g=d.ctrlKey;var i=q("#"+this.getId()+"-svg")[0];var o=this._getSvgCoodinateByDiv(i,x,y);var r=parseInt(this._oAxisOrdinal.viewToBandIndex(o.y),10);if(r<0){return false;}var v=this._oTT.getRows();var I,j=d3.select("#"+v[r].getId());if(r<v.length&&j&&j.attr("data-sap-ui-rowindex")){I=this._oTT.getFirstVisibleRow()+parseInt(j.attr("data-sap-ui-rowindex"),10);}if(l.isDummyRow(this._oTT,I)&&l.getContextObject(this._oTT,I).__group!==undefined){return false;}var k=this._oTT.getSelectionMode();if(I>=0&&k!==sap.ui.table.SelectionMode.None){if(k===sap.ui.table.SelectionMode.Single){if(!this._oTT.isIndexSelected(I)){this._oTT.setSelectedIndex(I);}else{this._oTT.clearSelection();}}else{if(k===sap.ui.table.SelectionMode.Multi&&this.getSelectionMode===sap.gantt.SelectionMode.Multiple){g=true;}if(s){var m=this._oTT.getSelectedIndex();if(m>=0){if(m<I){this._oTT.addSelectionInterval(m,I);}else{this._oTT.addSelectionInterval(I,m);}}else{this._oTT.setSelectedIndex(I);}}else if(!this._oTT.isIndexSelected(I)){if(g){this._oTT.addSelectionInterval(I,I);}else{this._oTT.clearSelection();this._oTT.setSelectedIndex(I);}}else if(g){this._oTT.removeSelectionInterval(I,I);}else if(this._oTT.getSelectedIndices().length>1){this._oTT.clearSelection();this._oTT.setSelectedIndex(I);}}}q.sap.measure.end("GanttChart syncTTSelection");};n.prototype._setEventStatus=function(E){switch(E){case"dragEnter":this._bDragging=true;break;case"mouseDown":this._bMouseDown=true;this._bDragging=false;break;case"shapeDragging":this._bDragging=true;break;case"mouseUp":this._bMouseDown=false;break;case"shapeDragEnd":this._bDragging=false;this._oDraggingData=undefined;break;case"dragLeave":this._iMouseDown=0;this._bMouseDown=false;this._bDragging=false;break;default:break;}};n.prototype._onShapeDragStart=function(E){var s=q("#"+this.getId()+"-svg");var o=d3.select(E.target).data()[0];var d=E.target.getAttribute("class").split(" ")[0];if(o!==undefined&&q.inArray(o.uid,this._aSelectedShapeUids)>-1&&this._judgeEnableDnD(o,d)){var r=this._getRowByShapeUid(o.uid);var x=E.pageX-s.offset().left||E.offsetX;var y=E.pageY-s.offset().top||E.offsetY;var g,j;if(E.target.getAttribute("x")&&E.target.getAttribute("width")){g=parseInt(E.target.getAttribute("x"),10);j=parseInt(E.target.getAttribute("width"),10);}else if(o.startTime){var k=this._oAxisTime.timeToView(F.abapTimestampToDate(o.startTime));var m=this._oAxisTime.timeToView(F.abapTimestampToDate(o.endTime));if(C.getConfiguration().getRTL()){g=m;j=(k-m)>0?(k-m):1;}else{g=k;j=(m-k)>0?(m-k):1;}}else{g=x;j=1;}var D={"x":x,"y":y,"shapeX":g,"shapeWidth":j};var p=[];p.push({"shapeData":o,"objectInfo":r});for(var t in this._oSelectedShapes){var u=this._oSelectedShapes[t];if(u!==undefined){for(var i in u){if(u[i].shapeUid!==o.uid&&this._judgeEnableDnD(u[i].shapeData)){p.push({"shapeData":u[i].shapeData,"objectInfo":u[i].objectInfoRef});}}}}this._oDraggingData={"sourceShapeData":p,"dragStartPoint":D,"sourceSvgId":this.getId(),"targetSvgId":this.getId(),"domObject":d3.select(E.target)[0][0]};this._oDraggingData.fDragHandler=this._onShapeDrag.bind(this);q(document.body).bind("mousemove",this._oDraggingData.fDragHandler);this._oDraggingData.fDragEndHandler=this._onShapeDragEnd.bind(this);q(document.body).bind("mouseup",this._oDraggingData.fDragEndHandler);}};n.prototype._onShapeDrag=function(E){if(E.button!==0||E.buttons===0||E.ctrlKey){return false;}var d=d3.select("#activtityDragDrop");var i=d[0];if(this._oDraggingData===undefined){if(!d.empty()){d.remove();}}else{var j=this._oDraggingData.sourceShapeData.length;var s=this._oDraggingData.dragStartPoint.shapeX;var k=this._oDraggingData.dragStartPoint.x;if(d.empty()||i===null){i=d3.select("body").append("div").attr("id","activtityDragDrop").style("position","absolute").style("z-index","999");var m=this._oDraggingData.domObject.cloneNode();var w=d3.select(m).attr("width");var o=d3.select(m).attr("height");var p=12;var g=i.append("svg").attr("id","activtityDragDropSvg").attr("width",w).attr("height",o).append("g").attr("id","activtityDragDropSvgGroup");var r=d3.select(this._oDraggingData.domObject.cloneNode()).classed("shadow",true).attr("fill-opacity","0.5").attr("x",0).attr("y",0);g.node().appendChild(r.node());g.append("text").attr("x",w/2-p/2).attr("y",o-p/2+4).attr("fill","blue").attr("font-size",12).text(function(){return j;});}var t=s+(E.pageX-k);var u=E.pageY;d3.select("#activtityDragDrop").style("left",t+4+"px");d3.select("#activtityDragDrop").style("top",u+4+"px");q(document.body).addClass("sapGanttDraggingCursor");this._setEventStatus("shapeDragging");this._iMouseDown=0;}};n.prototype._onShapeDragEnd=function(E){var d=d3.select("#activtityDragDrop");if(!d.empty()){d.remove();}if(this._bDragging&&this._oDraggingData!==undefined){var t=this.getId()+"-svg";this._collectDraggingShapeData(this._oDraggingData,E);this.fireShapeDragEnd({originEvent:E,sourceSvgId:this._oDraggingData.sourceSvgId,targetSvgId:t,sourceShapeData:this._oDraggingData.sourceShapeData,targetData:this._oDraggingData.targetData});}if(this._oDraggingData!==undefined){q(document.body).unbind("mousemove",this._oDraggingData.fDragHandler);q(document.body).unbind("mouseup",this._oDraggingData.fDragEndHandler);}q(document.body).removeClass("sapGanttDraggingCursor");this._setEventStatus("shapeDragEnd");};n.prototype._collectDraggingShapeData=function(d,E){var s=q("#"+this.getId()+"-svg");var x=E.pageX-s.offset().left||E.offsetX;var g=d.dragStartPoint.x;var D=parseInt(x,10)-parseInt(g,10);var i=parseInt(d.dragStartPoint.shapeX,10)+D;var j=i+parseInt(d.dragStartPoint.shapeWidth,10);var k,m;if(C.getConfiguration().getRTL()===true){k=F.dateToAbapTimestamp(this._oAxisTime.viewToTime(j));m=F.dateToAbapTimestamp(this._oAxisTime.viewToTime(i));}else{k=F.dateToAbapTimestamp(this._oAxisTime.viewToTime(i));m=F.dateToAbapTimestamp(this._oAxisTime.viewToTime(j));}var p=this._composeParameterForClickPosition(E);var r=p.rowInfo;d.targetData={"mouseTimestamp":{startTime:k,endTime:m},"mode":this.getMode(),"objectInfo":r};};n.prototype.setDraggingData=function(d){this._oDraggingData=d;if(this._oDraggingData!==undefined){this._oDraggingData.targetSvgId=this.getId();q(document.body).unbind("mousemove",this._oDraggingData.fDragHandler);q(document.body).unbind("mouseup",this._oDraggingData.fDragEndHandler);this._oDraggingData.fDragHandler=this._onShapeDrag.bind(this);this._oDraggingData.fDragEndHandler=this._onShapeDragEnd.bind(this);q(document.body).bind("mousemove",this._oDraggingData.fDragHandler);q(document.body).bind("mouseup",this._oDraggingData.fDragEndHandler);this._setEventStatus("dragEnter");}};n.prototype._onSvgCtnMouseEnter=function(E){if(E.currentTarget.id===(this.getId()+'-svg-ctn')&&E.button===0&&E.buttons!==0){this.fireChartDragEnter({originEvent:E});}};n.prototype._onSvgCtnMouseMove=function(E){var s=q("#"+this.getId()+"-svg");var o=this._getSvgCoodinateByDiv(s[0],E.pageX,E.pageY);if(this.getEnableCursorLine()){this._oCursorLineDrawer.drawSvg(d3.selectAll(".sapGanttChartSvg"),d3.selectAll(".sapGanttChartHeaderSvg"),this.getLocale(),o);}var p=this._composeParameterForClickPosition(E);var r=p?p.rowIndex:-1;var d=d3.select(E.target).data()[0];if(r>-1&&((d!==undefined&&d.uid!==this._lastHoverShapeUid)||(d===undefined&&this._lastHoverShapeUid!==undefined)||r!==this._lastHoverRowIndex)){this.fireChartMouseOver({objectInfo:p.rowInfo,leadingRowInfo:p.leadingRowInfo,timestamp:p.startTime.getTime(),svgId:this.getId()+"-svg",svgCoordinate:p.svgPoint,effectingMode:this.getMode(),originEvent:E});if(d!==undefined){this._lastHoverShapeUid=d.uid;}else{this._lastHoverShapeUid=undefined;}}if(r>-1&&r!==this._lastHoverRowIndex){var t=this._oTT;var g=q(t.getDomRef());var H=g.find(".sapUiTableRowHvr");var j=g.find(".sapUiTableTr")[r];if(this._oTT.getRows()[r]){var k=this._oTT.getRows()[r].getIndex();var m=l.getContextObject(this._oTT,k);if(H.length>0){for(var i=0;i<H.length;i++){if(q.inArray("sapUiTableTr",H[i].classList)>-1){q(H[i]).mouseleave();}}}if(!l.isDummyRow(this._oTT,k)||m.__group===undefined||m.__group===null){q(j).mouseenter();this._lastHoverRowIndex=r;}}}};n.prototype._onSvgCtnMouseLeave=function(E){if(E.currentTarget.id===(this.getId()+'-svg-ctn')&&this._bDragging&&this._oDraggingData!==undefined){this._oDraggingData.targetSvgId=undefined;this.fireChartDragLeave({originEvent:E,draggingSource:this._oDraggingData});this._setEventStatus("dragLeave");}if(this.getEnableCursorLine()){this._oCursorLineDrawer.destroySvg(d3.selectAll(".sapGanttChartSvg"),d3.selectAll(".sapGanttChartHeaderSvg"));}var t=this._oTT;var d=q(t.getDomRef());var H=d.find(".sapUiTableRowHvr");if(H.length>0){for(var i=0;i<H.length;i++){if(q.inArray("sapUiTableTr",H[i].classList)>-1){q(H[i]).mouseleave();}}}this._lastHoverShapeUid=undefined;this._lastHoverRowIndex=-1;};n.prototype._onSvgCtnMouseDown=function(E){if(E.button==0){var s=d3.select(E.target).data()[0];var d;if(E.target.getAttribute("class")){d=E.target.getAttribute("class").split(" ")[0];}if(d&&s&&this._judgeEnableSelection(s,d)){this._oLastSelectedShape=s;this._onShapeDragStart(E);E.preventDefault();}this._iMouseDown++;this._setEventStatus("mouseDown");}};n.prototype._onSvgCtnMouseUp=function(d){if(d.button==2){var p=this._composeParameterForClickPosition(d);this.fireChartRightClick({objectInfo:p.rowInfo,leadingRowInfo:p.leadingRowInfo,timestamp:p.startTime.getTime(),svgId:this.getId()+"-svg",svgCoordinate:p.svgPoint,effectingMode:this.getMode(),originEvent:d});}else if(d.button==0&&!this._bDragging&&this._bMouseDown){this._onSvgCtnClick(d);}};n.prototype._onSvgCtnClick=function(E){var s=d3.select(E.target).data()[0];var d;if(E.target.getAttribute("class")){d=E.target.getAttribute("class").split(" ")[0];}var g={};if(s!==undefined&&this._judgeEnableSelection(s,d)&&this._oLastSelectedShape!==undefined&&this._oLastSelectedShape.uid===s.uid){g=this._selectionChange(s,E.ctrlKey,E.shiftKey,E);}else if(this.getSelectionMode()===sap.gantt.SelectionMode.MultiWithKeyboard){this._syncTTSelection(E);this._oLastSelectedShape=undefined;}else{if(this._aSelectedShapeUids!==undefined&&this._aSelectedShapeUids.length>0){this._oSelectedShapes={};this._aSelectedShapeUids=[];g.shapeSelectionChange=true;}if(this._aSelectedRelationships.length>0){this._aSelectedRelationships=[];g.relationshipSelectionChange=true;}if(g.shapeSelectionChange||g.relationshipSelectionChange){this._drawSelectedShapes();}}if(!E.ctrlKey&&!E.shiftKey){var t=this;setTimeout(function(){if(t._iMouseDown>1){var p=t._composeParameterForClickPosition(E);t.fireChartDoubleClick({objectInfo:p.rowInfo,leadingRowInfo:p.leadingRowInfo,timestamp:p.startTime.getTime(),svgId:t.getId()+"-svg",svgCoordinate:p.svgPoint,effectingMode:t.getMode(),originEvent:E});}t._iMouseDown=0;t._setEventStatus("mouseUp");this._oLastSelectedShape=undefined;},300);}else{this._iMouseDown=0;this._setEventStatus("mouseUp");this._oLastSelectedShape=undefined;}if(g.shapeSelectionChange){this.fireShapeSelectionChange({originEvent:E});}if(g.relationshipSelectionChange){this.fireRelationshipSelectionChange({originEvent:E});}};n.prototype._onHSbScroll=function(E){var d=this._oTT._oHSb.getScrollPosition();this.updateLeftOffsetRate(d);this._draw(false);this.fireHorizontalScroll({scrollSteps:d,leftOffsetRate:this._fLeftOffsetRate});};n.prototype._onVSbScroll=function(E){this.fireVerticalScroll({scrollSteps:this._oTT._oVSb.getScrollPosition()});this._oTT.setFirstVisibleRow(this._oTT._oVSb.getScrollPosition()||0,true);};n.prototype._hSbScrollLeft=function(d){var g=q("#"+this.getId()+"-svg-ctn");var i=q("#"+this.getId()+"-header");var j;if(C.getConfiguration().getRTL()===true){j=this._oStatusSet.aViewBoundary[1]-i.width()-d;if(j<0){j=0;}}else{j=d;}if(C.getConfiguration().getRTL()===true&&sap.ui.Device.browser.name==="ff"){g.scrollLeftRTL(j);i.scrollLeftRTL(j);}else{g.scrollLeft(j);i.scrollLeft(j);}};n.prototype.updateLeftOffsetRate=function(d,g){var i=g?g:parseInt(this._oTT._oHSb.getContentSize(),0);var j=q("#"+this.getId()+"-svg-ctn").width();if(i-j!==0){if(C.getConfiguration().getRTL()===true){this._fLeftOffsetRate=(i-d-j)/(i-j);}else{this._fLeftOffsetRate=d/(i-j);}this._fLeftOffsetRate=this._fLeftOffsetRate<0?0:this._fLeftOffsetRate;this._fLeftOffsetRate=this._fLeftOffsetRate>1?1:this._fLeftOffsetRate;}return this._fLeftOffsetRate;};n.prototype.jumpToPosition=function(v){if(!isNaN(v)&&!(v instanceof Date)){this._fLeftOffsetRate=v;this._draw(false);return;}var d,g;var i=q("#"+this.getId()+"-svg-ctn").width();if(!i||i<=0){return;}if(v instanceof Date){d=v;}else{var t=this.getTimeAxis();var I=t.getInitHorizon();if(!I||!I.getStartTime()||!I.getEndTime()){return;}d=F.abapTimestampToDate(I.getStartTime());var s=this._calZoomScale(F.abapTimestampToDate(I.getStartTime()),F.abapTimestampToDate(I.getEndTime()),i);var j=this._oZoom.base.fScale/s;this.setTimeZoomRate(j);}var k=this._nUpperRange-this._nLowerRange;if(!k||k<=0){return;}if(C.getConfiguration().getRTL()===true){g=k-this._oAxisTime.timeToView(d)-this._oAxisTime.getViewOffset();g=g<0?0:g;}else{g=this._oAxisTime.timeToView(d)+this._oAxisTime.getViewOffset();}this.updateLeftOffsetRate(g,k);this._draw(false);};n.prototype._onTTRowUpdate=function(){this._syncSvgHeightWithTT();this._syncSvgDataWithTT();this._prepareRelationshipDataFromModel();this._draw(true);};n.prototype._updateDataString=function(){var s=JSON.stringify(this._aShapeData,function(k,v){if(k==="bindingObj"||k==="contextObj"){return undefined;}return v;});if(this._sShapeData&&s===this._sShapeData){this._sShapeData=s;return false;}else{this._sShapeData=s;return true;}};n.prototype._syncSvgHeightWithTT=function(){var d=this.$().find(".sapGanttChartSvgCtn");d.height(this.$().find(".sapUiTableCCnt").height());};n.prototype._syncSvgDataWithTT=function(){var B=this._oTT.getBinding("rows");var j=B.getMetadata().getName()==="sap.ui.model.json.JSONTreeBinding";var i=this._oTT.getFirstVisibleRow();var v=this._oTT.getVisibleRowCount();this._aShapeData=[];this._aNonVisibleShapeData=[];var _=[];var d=[];var g=[i,i+v-1];if(j){g=this._prepareVerticalDrawingRange();B.getContexts(0,0);if(i>0){_=this._getDrawingData([0,i-1]);}d=this._getDrawingData([i+v,B.getLength()-1]);B.getContexts(g[0],g[1]);this._aShapeData=this._getDrawingData(g);}else{if(this._aRelationshipsContexts&&this._aRelationshipsContexts.length>0){if(i>0){_=this._createShapeDataFromRowContexts(B.getContexts(0,i));}d=this._createShapeDataFromRowContexts(B.getContexts(i+v,B.getLength()));}var r=B.getContexts(i,v);this._aShapeData=this._createShapeDataFromRowContexts(r);}this._aNonVisibleShapeData=_.concat(d);var s=this.getShapeDataNames();if(s&&s.length>0){U.generateRowUid(this._aShapeData,this._oObjectTypesConfigMap,s);U.generateRowUid(this._aNonVisibleShapeData,this._oObjectTypesConfigMap,s);this._setSelectedStatusFromData(s);}else{q.sap.log.error("Missing configuration for shapeDataNames.");}var k=this.getBaseRowHeight();this._oAxisOrdinal=this._createAxisOrdinal(this._aShapeData,k,(g[0]-i)*k);this._cacheObjectPosition(this._aShapeData,this._oAxisOrdinal);this._cacheObjectPosition(_,this._oAxisOrdinal,true);this._cacheObjectPosition(d,this._oAxisOrdinal,false);if(!this._aVisibleRange||this._aVisibleRange[0]!==g[0]||this._aVisibleRange[1]!==g[1]){this._aVisibleRange=g;return true;}return false;};n.prototype._createShapeDataFromRowContexts=function(r){var s=this.getShapeDataNames();var B=this._oTT.getBinding("rows");var m=B.getModel();var d=[];for(var i=0;i<r.length;i++){if(r[i]!=undefined){for(var j=0;j<s.length;j++){var g=s[j];var o=r[i].getProperty(g);var p;if(o){for(var k=0;k<o.length;k++){var t=o[k];p=m.getData("/"+t);d.push({"bindingObj":B,"contextObj":r[i],"data":r[i].getObject(),"shapeData":[p],"id":p.id,"shapeName":g,"rowIndex":i});}}}}}return d;};n.prototype._cacheObjectPosition=function(o,d,g){if(o&&o.length>0){if(g===true){for(var i=0;i<o.length;i++){o[i].y=-100;o[i].rowHeight=d.getViewBandWidth();}}else if(g===false){for(var j=0;j<o.length;j++){o[j].y=d.getViewRange()[1]+100;o[j].rowHeight=d.getViewBandWidth();}}else{for(var k=0;k<o.length;k++){o[k].y=d.elementToView(o[k].uid);if(k>0){o[k-1].rowHeight=o[k].y-o[k-1].y;}}o[o.length-1].rowHeight=d.getViewRange()[1]-o[o.length-1].y;}}};n.prototype._prepareRelationshipDataFromModel=function(){this._aRelationships=[];if(this._aRelationshipsContexts){for(var i=0;i<this._aRelationshipsContexts.length;i++){var r=this._aRelationshipsContexts[i].getObject();if(r!==undefined){this._aRelationships.push(r);}}}U.generateUidByShapeDataName(this._aRelationships,"relationship");};n.prototype._createAxisOrdinal=function(s,B,d){var r=s.map(function(o){return o.uid;});var g=s.map(function(o){if(o.rowSpan){return o.rowSpan;}else{return 1;}});return new h(r,g,B,d);};n.prototype.getShapeData=function(r){return this._aShapeData;};n.prototype._getDrawingData=function(r){var i,j,k,o;var B=this._oTT.getBinding("rows");var d=[];for(i=r[0];i<=r[1];i++){o=l.getContextObject(this._oTT,i);if(!o){continue;}if(l.isDummyRow(this._oTT,i)&&((d.length>0&&d[d.length-1].chartScheme&&d[d.length-1].chartScheme===o.__group&&d[d.length-1].index===o.index)||o.chartScheme)){continue;}if(o.__group){var m;if(this._oChartSchemesConfigMap[o.__group]&&this._oChartSchemesConfigMap[o.__group].getModeKey()&&this._oChartSchemesConfigMap[o.__group].getModeKey()!==sap.gantt.config.DEFAULT_MODE_KEY){m=this._oChartSchemesConfigMap[o.__group].getModeKey();}else{m=this.getMode();}var s=this._collectDataNameForValidChartScheme(o.__group,m);var p=o.parentData?o.parentData:null;if(o.index&&p&&s&&s.drawData){for(j=0;j<s.drawData.length;j++){if(!p[s.drawData[j]]){continue;}o[s.drawData[j]]=[];for(k=0;k<p[s.drawData[j]].length;k++){if(!p[s.drawData[j]][k].rowIndex||o.index===p[s.drawData[j]][k].rowIndex){o[s.drawData[j]].push(p[s.drawData[j]][k]);}}}}d.push({"bindingObj":B,"data":o,"id":p.id,"rowSpan":s.rowSpan,"chartScheme":o.__group,"rowIndex":i,"index":o.index,"icon":this._oChartSchemesConfigMap[o.__group].getIcon(),"closeIcon":"./image/closeChart.png","name":this._oChartSchemesConfigMap[o.__group].getName()});}else{var g=1;var t=this._oObjectTypesConfigMap[o.type]?this._oObjectTypesConfigMap[o.type].getMainChartSchemeKey():sap.gantt.config.DEFAULT_CHART_SCHEME_KEY;if(o.type){var u=this._oChartSchemesConfigMap[t];if(u){g=u.getRowSpan();}}d.push({"bindingObj":B,"contextObj":this._oTT.getContextByIndex(i),"data":o,"id":o.id,"rowSpan":g,"chartScheme":t,"rowIndex":i,"index":0});}}return d;};n.prototype._prepareVerticalDrawingRange=function(){var d=this._oTT.getBinding("rows").getLength()-1;if(d<0){return[0,-1];}var g=this._oTT.getFirstVisibleRow();var j=g+this._oTT.getVisibleRowCount()-1;var k=g;var m=j<d?j:d;var i,o,p,r;for(i=g;i>=0;i--){if(!l.isDummyRow(this._oTT,i)){break;}r=l.getContextObject(this._oTT,i);if(r&&r.previousNodeNum){k=i-r.previousNodeNum;continue;}if(!r||!r.index||r.index<0){break;}if(!p){o=r.__group;p=r.index;}else if(o===r.__group&&p===r.index){k=i;}else{break;}}p=undefined;for(i=j;i<=d;i++){r=l.getContextObject(this._oTT,i);if(r&&r.afterNodeNum){m=i+r.afterNodeNum;continue;}if(!l.isDummyRow(this._oTT,i)){break;}if(!r||!r.index||r.index<0){break;}if(!p){o=r.__group;p=r.index;}else if(o===r.__group&&p===r.index){m=i;}else{break;}}return[k,m];};n.prototype._prepareHorizontalDrawingRange=function(){var d=this._nUpperRange-this._nLowerRange;var g=q("#"+this.getId()+"-svg-ctn").width();if(!this._oStatusSet){this._updateScrollWidth();}var i=Math.ceil((this._fLeftOffsetRate?this._fLeftOffsetRate:0)*(d-g));if(this._oStatusSet){if((g>=d||(this._oStatusSet.aViewBoundary[0]<=i-this._oStatusSet.nOffset&&this._oStatusSet.aViewBoundary[1]>=i+g-this._oStatusSet.nOffset))){if(!this._mTimeouts._drawSvg){this._scrollSvg();}return false;}}var j=g*(1+this._fExtendFactor*2);var k=i-g*this._fExtendFactor;if(k<this._nLowerRange){j+=k;k=0;}if(k+j>this._nUpperRange){j=this._nUpperRange-k;}this._oAxisTime.setViewOffset(k);this._oStatusSet={nWidth:j,nOffset:k,nScrollLeft:i,aViewBoundary:[0,j],aTimeBoundary:[this._oAxisTime.viewToTime(0),this._oAxisTime.viewToTime(j)],bRTL:C.getConfiguration().getRTL()};return true;};n.prototype._draw=function(d){if(!this._prepareHorizontalDrawingRange()&&!d){return;}var t=this;this._mTimeouts._drawSvg=this._mTimeouts._drawSvg||window.setTimeout(function(){t._drawSvg();t._mDrawDelayMS=0;},this._mDrawDelayMS);};n.prototype._updateScrollWidth=function(){var d=100000;var g=this._nUpperRange-this._nLowerRange;var i=g>d?d:g;if(i+"px"!==this._oTT._oHSb.getContentSize()){this._oTT._oHSb.setContentSize(i+"px").bind(this._oTT.getDomRef());}};n.prototype._updateScrollLeft=function(){var d=parseInt(this._oTT._oHSb.getContentSize(),0);var g=q("#"+this.getId()+"-svg-ctn").width();var i=Math.ceil((this._fLeftOffsetRate?this._fLeftOffsetRate:0)*(d-g));if(C.getConfiguration().getRTL()===true){i=d-i-g;}if(Math.abs(this._oTT._oHSb.getScrollPosition()-i)>1){this._oTT._oHSb.setScrollPosition(i);}};n.prototype._scrollSvg=function(){var d=q("#"+this.getId()+"-svg");var g=q("#"+this.getId()+"-header-svg");if(this._oStatusSet.nWidth!==d.width()){d.width(this._oStatusSet.nWidth);}if(this._oStatusSet.nWidth!==g.width()){g.width(this._oStatusSet.nWidth);}var i=this._nUpperRange-this._nLowerRange;var j=q("#"+this.getId()+"-svg-ctn").width();var k=Math.ceil((this._fLeftOffsetRate?this._fLeftOffsetRate:0)*(i-j));this._hSbScrollLeft(k-this._oStatusSet.nOffset);};n.prototype._drawSvg=function(){q.sap.measure.start("GanttChart _drawSvg","GanttPerf:GanttChart _drawSvg function");this._updateScrollLeft();this._scrollSvg();this._sUiSizeMode=U.findSapUiSizeClass(this);this._drawCalendarPattern();this._drawHeader();this._drawNowLine();this._drawVerticalLine();this._drawShapes();this._drawSelectedShapes();this.fireEvent("_shapesUpdated",{aSvg:q("#"+this.getId()+"-svg")});this._updateCSSForDummyRow();delete this._mTimeouts._drawSvg;q.sap.measure.end("GanttChart _drawSvg");};n.prototype._drawHeader=function(){var g=q(this.getDomRef()).find(".sapGanttChartHeader");var j=g.height();var H=d3.select(q(this.getDomRef()).find(".sapGanttChartHeaderSvg").get(0));H.attr("height",j);var k=j/5*2;var m=j/5*4;var o=j/5*4;var L=this.getAxisTime().getTickTimeIntervalLabel(this.getAxisTime().getCurrentTickTimeIntervalKey(),null,[0,this._oStatusSet.nWidth]);H.selectAll("g").remove();var p=H.append("g");p.selectAll("label0").data(L[0]).enter().append("text").classed("sapGanttTimeHeaderSvgText0",true).text(function(d){return d.label;}).attr("x",function(d){return d.value;}).attr("y",function(d){return k;});p.selectAll("label1").data(L[1]).enter().append("text").classed("sapGanttTimeHeaderSvgText1",true).text(function(d){return d.label;}).attr("x",function(d){return d.value+(C.getConfiguration().getRTL()?-5:5);}).attr("y",function(d){return o;});var s="";for(var i=0;i<L[1].length;i++){var r=L[1][i];if(r){s+=" M"+" "+(r.value-1/2)+" "+m+" L"+" "+(r.value-1/2)+" "+j;}}p.append("path").classed("sapGanttTimeHeaderSvgPath",true).attr("d",s);};n.prototype._drawCalendarPattern=function(){var g=d3.select("#"+this.getId()+"-svg");this._oCalendarPatternDrawer.drawSvg(g,this.getId(),this.getCalendarDef(),this._oStatusSet,this.getBaseRowHeight());};n.prototype._drawNowLine=function(){this._oNowlineDrawer=new N(this._oAxisTime);var g=d3.select("#"+this.getId()+"-header-svg"),d=d3.select("#"+this.getId()+"-svg");if(this.getEnableNowLine()){this._oNowlineDrawer.drawSvg(d,g);}else{this._oNowlineDrawer.destroySvg(d,g);}};n.prototype._drawVerticalLine=function(){this._oVerticalLineDrawer=new V(this.getAxisTime());var g=d3.select("#"+this.getId()+"-svg");if(this.getEnableVerticalLine()){this._oVerticalLineDrawer.drawSvg(g);}else{this._oVerticalLineDrawer.destroySvg(g);}};n.prototype._drawShapes=function(){var s=d3.select("#"+this.getId()+"-svg");if(!this._oTT||!this._oTT.getRows()||this._oTT.getRows().length<=0){return;}if(this._aShapeData&&this._aShapeInstance&&this._aShapeInstance.length>0){this._collectDataPerShapeId();var r=[];for(var i=0;i<this._aShapeInstance.length;i++){switch(this._aShapeInstance[i].getCategory(null,this._oAxisTime,this._oAxisOrdinal)){case sap.gantt.shape.ShapeCategory.InRowShape:this._oShapeInRowDrawer.drawSvg(s,this._aShapeInstance[i],this._oAxisTime,this._oAxisOrdinal,this._oStatusSet);break;case sap.gantt.shape.ShapeCategory.Relationship:if(this._judgeDisplayableOfRLS(this._aShapeInstance[i])){r=this._oShapeCrossRowDrawer.generateRelationshipDataSet(s,this._oShapeInstance,this._aNonVisibleShapeData,this.getShapeDataNames(),this._aRelationships,this._oAxisTime,this._oAxisOrdinal);}this._aShapeInstance[i].dataSet=r;this._oShapeCrossRowDrawer.drawSvg(s,this._aShapeInstance[i],this._oAxisTime,this._oAxisOrdinal);break;default:break;}}}};n.prototype._drawSelectedShapes=function(){if(!this._oTT||!this._oTT.getRows()||this._oTT.getRows().length<=0){return;}var s=d3.select("#"+this.getId()+"-svg");this._setSelectedStatusToData();this._collectSelectedDataPerShapeId();for(var d in this._oShapeInstance){var o=this._oShapeInstance[d].getAggregation("selectedShape");var g=o.getCategory(null,this._oAxisTime,this._oAxisOrdinal);switch(g){case sap.gantt.shape.ShapeCategory.InRowShape:this._oShapeInRowDrawer.drawSvg(s,o,this._oAxisTime,this._oAxisrdinal,this._oStatusSet);break;case sap.gantt.shape.ShapeCategory.Relationship:var r=this._oShapeCrossRowDrawer.generateRelationshipDataSet(s,this._oShapeInstance,this._aNonVisibleShapeData,this.getShapeDataNames(),this._aSelectedRelationships,this._oAxisTime,this._oAxisOrdinal);o.dataSet=r;this._oShapeCrossRowDrawer.drawSvg(s,o,this._oAxisTime,this._oAxisOrdinal);break;default:break;}}};n.prototype._collectDataPerShapeId=function(){var j=(this._oTT.getBinding("rows").getMetadata().getName()==="sap.ui.model.json.JSONTreeBinding");var r,s;for(var d in this._oShapeInstance){var g=this._oShapeInstance[d].mShapeConfig.getShapeDataName();this._oShapeInstance[d].dataSet=[];for(var i=0;i<this._aShapeData.length;i++){r=this._aShapeData[i];if(r.isBlank){continue;}if(!g){this._oShapeInstance[d].dataSet.push({"objectInfoRef":r,"shapeData":r.data});continue;}if(!this._judgeDisplayableByShapeId(r,d)){continue;}if(j){s=r.data[g];}else if(g==r.shapeName){s=[r.data];}else{continue;}if(s){this._oShapeInstance[d].dataSet.push({"objectInfoRef":r,"shapeData":s});}}}};n.prototype._collectSelectedDataPerShapeId=function(){for(var s in this._oShapeInstance){var d=this._oShapeInstance[s].mShapeConfig.getShapeDataName();var o=this._oShapeInstance[s].getAggregation("selectedShape");var g=o.getCategory(null,this._oAxisTime,this._oAxisOrdinal);o.dataSet=[];if(g==sap.gantt.shape.ShapeCategory.Relationship){var k=[];for(var j in this._aSelectedRelationships){var r=this._aSelectedRelationships[j];if(this._getShapeDataById(r.id,true)!==undefined){k.push(r);}}o.dataSet.push({"shapeData":k});}else if(this._oSelectedShapes[d]!==undefined){for(var i in this._oSelectedShapes[d]){var m=this._oSelectedShapes[d][i];var p=this._getRowByShapeUid(m.shapeUid);if(p!==undefined&&p!==null&&this._judgeDisplayableByShapeId(p,s)){m.objectInfoRef=p;o.dataSet.push({"objectInfoRef":m.objectInfoRef,"shapeData":[m.shapeData]});}}}}};n.prototype._judgeDisplayableByShapeId=function(r,s){var d,o,g,m;if(r.data.__group){d=r.data.__group;}else{d=this._oObjectTypesConfigMap[r.data.type]?this._oObjectTypesConfigMap[r.data.type].getMainChartSchemeKey():sap.gantt.config.DEFAULT_CHART_SCHEME_KEY;}o=this._oChartSchemesConfigMap[d];if(o==undefined){return false;}g=o.getShapeKeys();m=o.getModeKey()!==sap.gantt.config.DEFAULT_MODE_KEY?o.getModeKey():this.getMode();if(d!==sap.gantt.config.DEFAULT_CHART_SCHEME_KEY&&g.indexOf(s)<0||m!==sap.gantt.config.DEFAULT_MODE_KEY&&this._oShapesConfigMap[s].getModeKeys()&&this._oShapesConfigMap[s].getModeKeys().length>0&&this._oShapesConfigMap[s].getModeKeys().indexOf(m)<0||!r.data){return false;}return true;};n.prototype._judgeDisplayableOfRLS=function(s){var d=this._oShapesConfigMap[s.mShapeConfig.getKey()]?this._oShapesConfigMap[s.mShapeConfig.getKey()].getModeKeys():[];if(q.inArray(this.getMode(),d)<0&&this.getMode()!==sap.gantt.config.DEFAULT_MODE_KEY){return false;}return true;};n.prototype._getShapeDataNameByUid=function(s){var d;if(s!==undefined){var g="|DATA:";if(s.split(g)[1]){d=s.split(g)[1].split("[")[0];}else{d=sap.gantt.shape.ShapeCategory.Relationship;}}return d;};n.prototype._getUidById=function(I,r){var u=[];if(r){for(var i in this._aRelationships){var o=this._aRelationships[i];if(o.id==I){u.push(o.uid);break;}}}else{q.each(this._aShapeData,function(k,v){var d=v;for(var s in d.data){if(d.data[s]instanceof Array){for(var i in d.data[s]){if(d.data[s][i].id==I){u.push(d.data[s][i].uid);}}}}});}return u;};n.prototype._getShapeDataByUid=function(u,r){if(r){for(var i in this._aRelationships){var o=this._aRelationships[i];if(o.uid===u){return o;}}}else{var d=this._getRowByShapeUid(u);var s=this._getShapeDataNameByUid(u);if(d!==undefined&&d.data[s]!==undefined){for(var j=0;j<d.data[s].length;j++){var g=d.data[s][j];if(g.uid==u){return g;}}}}return undefined;};n.prototype._getShapeDataById=function(I,r){var s=[];var u=this._getUidById(I,r);for(var i in u){var o=this._getShapeDataByUid(u[i],r);if(o!==undefined){s.push(o);}}return s;};n.prototype._getRowByShapeUid=function(s){var r;var d=this._getShapeDataNameByUid(s);var j=(this._oTT.getBinding("rows").getMetadata().getName()==="sap.ui.model.json.JSONTreeBinding");q.each(this._aShapeData,function(k,v){var g=v;if(j&&g.data[d]){for(var i=0;i<g.data[d].length;i++){if(g.data[d][i].uid==s){r=g;return false;}}}else if(g.data.uid===s){r=g;return false;}});return r;};n.prototype._getRowById=function(r){var d;q.each(this._aShapeData,function(k,v){var g=v;if(g.data.id==r){d=g;return false;}});return d;};n.prototype._getSvgCoodinateByDiv=function(o,x,y){var d=o.createSVGPoint();d.x=x;d.y=y;d=d.matrixTransform(o.getScreenCTM().inverse());d.svgHeight=o.height.baseVal.value;d.svgId=this.getId()+"-svg";return d;};n.prototype._getTopShapeInstance=function(s,d){if(d!==undefined){var o=this._getShapeIdById(d);if(o!==undefined&&o!==null){if(o.topShapeId!==undefined){return this._oShapeInstance[o.topShapeId];}else{return this._oShapeInstance[o.shapeId];}}}else{var g=this._getShapeDataNameByUid(s.uid);for(var i in this._oShapeInstance){var j=this._oShapeInstance[i].mShapeConfig.getShapeDataName();if(g===j){var t=this._customerClassIds[i].topShapeId;if(t!==undefined){return this._oShapeInstance[t];}else{return this._oShapeInstance[i];}}}}return undefined;};n.prototype._judgeEnableSelection=function(s,d){if(s===undefined){return false;}var t=this._getTopShapeInstance(s,d);if(t!==undefined){return t.getEnableSelection(s);}return false;};n.prototype._judgeEnableDnDByUid=function(s){if(s===undefined||s==null){return false;}var o;if(this._isRelationship(s)){o=this._getShapeDataByUid(s,true);}else{o=this._getShapeDataByUid(s,false);}return this._judgeEnableDnD(o);};n.prototype._judgeEnableDnD=function(s,d){if(s===undefined){return false;}var t=this._getTopShapeInstance(s,d);if(t!==undefined){return t.getEnableDnD(s);}return false;};n.prototype._selectShape=function(s){var r=this._getRowByShapeUid(s.uid);if(r==undefined){return false;}if(this._aSelectedShapeUids===undefined){this._aSelectedShapeUids=[];}var d=this._getShapeDataNameByUid(s.uid);if(this._oSelectedShapes[d]!==undefined&&this._oSelectedShapes[d]!==null){var g=this._oSelectedShapes[d];if(q.inArray(s.uid,this._aSelectedShapeUids)>-1){return false;}else{this._aSelectedShapeUids.push(s.uid);g.push({"shapeUid":s.uid,"shapeData":s,"objectInfoRef":r});return true;}}else{this._aSelectedShapeUids.push(s.uid);this._oSelectedShapes[d]=[];this._oSelectedShapes[d].push({"shapeUid":s.uid,"shapeData":s,"objectInfoRef":r});return true;}};n.prototype._deselectShape=function(s){var d=this._getShapeDataNameByUid(s.uid);if(q.inArray(s.uid,this._aSelectedShapeUids)>-1){var I=this._aSelectedShapeUids.indexOf(s.uid);this._aSelectedShapeUids.splice(I,1);var g=this._oSelectedShapes[d];for(var i in g){if(g[i].shapeUid===s.uid){g.splice(i,1);break;}}return true;}return false;};n.prototype._updateCSSForDummyRow=function(){var r=this._oTT.getRows();var d=this._oTT.$().find(".sapUiTableRowHdrScr").children();for(var i=0;i<r.length;i++){var o=r[i];var g=o.getIndex();if(g!==-1&&l.isMultipleSpanMainRow(this._oTT,i)){var j=l.getContextObject(this._oTT,g);if(j.afterNodeNum>0){r[i].$().addClass("sapGanttTrNoBorder");$(d[i]).addClass("sapGanttTHeaderNoBorder");}else{r[i].$().removeClass("sapGanttTrNoBorder");$(d[i]).removeClass("sapGanttTHeaderNoBorder");}}else{r[i].$().removeClass("sapGanttTrNoBorder");$(d[i]).removeClass("sapGanttTHeaderNoBorder");}}};n.prototype.getAxisOrdinal=function(){return this._oAxisOrdinal;};n.prototype.getAxisTime=function(){return this._oAxisTime;};n.prototype.ondblclick=function(E){return null;};n.prototype.onclick=function(E){return null;};n.prototype.getSapUiSizeClass=function(){return this._sUiSizeMode;};n.prototype.exit=function(){this._detachEvents();};return n;},true);};if(!jQuery.sap.isDeclared('sap.gantt.GanttChartWithTable')){jQuery.sap.declare('sap.gantt.GanttChartWithTable');jQuery.sap.require('sap.ui.table.Column');jQuery.sap.require('sap.ui.table.TreeTable');jQuery.sap.require('sap.ui.core.ScrollBar');jQuery.sap.require('sap.ui.layout.Splitter');jQuery.sap.require('sap.ui.layout.SplitterLayoutData');jQuery.sap.require('sap.ui.thirdparty.d3');sap.ui.define("sap/gantt/GanttChartWithTable",["sap/gantt/GanttChartBase","sap/ui/table/Column","sap/ui/table/TreeTable","sap/ui/core/ScrollBar","sap/ui/layout/Splitter","sap/ui/layout/SplitterLayoutData","sap/gantt/GanttChart","sap/gantt/control/Cell","sap/gantt/control/Toolbar","sap/gantt/control/AssociateContainer","sap/gantt/drawer/SelectionPanel","./misc/TreeTableHelper","sap/gantt/misc/Utility","sap/gantt/misc/AxisOrdinal","sap/ui/thirdparty/d3"],function(G,C,T,S,a,b,c,d,e,A,f,g,U,h){"use strict";var k=G.extend("sap.gantt.GanttChartWithTable",{metadata:{properties:{cellCallback:{type:"object"},fixedColumnCount:{type:"int"}},aggregations:{customToolbarItems:{type:"sap.ui.core.Control",multiple:true,visibility:"public",singularName:"customToolbarItem",bindable:"bindable"},columns:{type:"sap.ui.table.Column",multiple:true,visibility:"public",singularName:"column"},_selectionPanel:{type:"sap.ui.table.TreeTable",multiple:false,visibility:"hidden"},_chart:{type:"sap.gantt.GanttChart",multiple:false,visibility:"hidden"}}}});k.prototype.init=function(){jQuery.sap.measure.start("GanttChartWithTable Init","GanttPerf:GanttChartWithTable Init function");this._oGanttChart=new c();this.setAggregation("_chart",this._oGanttChart);this._oGanttChartCnt=new A({enableRootDiv:true,content:this._oGanttChart});this._oTC=this._oGanttChart._oTT;this._oTT=new T({visibleRowCountMode:"Auto",minAutoRowCount:1,fixedColumnCount:this.getFixedColumnCount(),selectionBehavior:sap.ui.table.SelectionBehavior.Row,selectionMode:sap.ui.table.SelectionMode.Multi});this._oTT.attachFilter(function(E){if(this.canExpandGanttChart()){g.filter(E);}}.bind(this));this._oTT.attachSort(function(E){if(this.canExpandGanttChart()){g.sort(E);}}.bind(this));this._oTT.attachToggleOpenState(function(E){var B=this.getBinding();if(B&&B.getModel()instanceof sap.ui.model.json.JSONModel){var s=E.getSource(),i=E.getParameter("expanded"),r=E.getParameter("rowIndex"),o=B.getContextByIndex(r);if(B.hasChildren&&B.hasChildren(o)){g.toggleOpenStateWithRowIndex(s,r,i);}}});this.setAggregation("_selectionPanel",this._oTT);this._oToolbar=new e({type:sap.gantt.control.ToolbarType.Local,sourceId:sap.gantt.config.DEFAULT_HIERARCHY_KEY});this._oToolbar.data("holder",this);this._oToolbar.attachSourceChange(this._onToolbarSourceChange,this);this._oToolbar.attachExpandTreeChange(this._onToolbarExpandTreeChange,this);this._oToolbar.attachModeChange(this._onToolbarModeChange,this);this._oTT.addExtension(this._oToolbar);this._oSelectionPanelCnt=new A({enableRootDiv:true,content:this._oTT,layoutData:new b({size:"30%"})});this._oSplitter=new a({width:"100%",height:"100%",orientation:sap.ui.core.Orientation.Horizontal,contentAreas:[this._oSelectionPanelCnt,this._oGanttChartCnt]}).addStyleClass("sapGanttViewSplitterH");this._oSplitter.attachResize(this._onSplitterResize,this);this._oTC._oHSb.attachScroll(this._onChartHSbScroll,this);this._oTC._oVSb.attachScroll(this._onChartVSbScroll,this);this._oTT._oVSb.attachScroll(this._onSelectionPanelVSbScroll,this);this._oGanttChart.attachRowSelectionChange(this._onRowSelectionChange,this);this._oGanttChart.attachShapeSelectionChange(this._onShapeSelectionChange,this);this._oGanttChart.attachChartMouseOver(this._onChartMouseOver,this);this._oGanttChart.attachRelationshipSelectionChange(this._onRelationshipSelectionChange,this);this._oGanttChart.attachChartDoubleClick(this._onDoubleClick,this);this._oGanttChart.attachChartRightClick(this._onRightClick,this);this._oGanttChart.attachEvent("_shapesUpdated",this._onChartShapesUpdated,this);this._oGanttChart.attachChartDragEnter(this._onChartDragEnter,this);this._oGanttChart.attachChartDragLeave(this._onChartDragLeave,this);this._oGanttChart.attachShapeDragEnd(this._onShapeDragEnd,this);this._oModesConfigMap={};this._oModesConfigMap[sap.gantt.config.DEFAULT_MODE_KEY]=sap.gantt.config.DEFAULT_MODE;this._oToolbarSchemeConfigMap={};this._oToolbarSchemeConfigMap[sap.gantt.config.DEFAULT_GANTTCHART_TOOLBAR_SCHEME_KEY]=sap.gantt.config.DEFAULT_GANTTCHART_TOOLBAR_SCHEME;this._oToolbarSchemeConfigMap[sap.gantt.config.EMPTY_TOOLBAR_SCHEME_KEY]=sap.gantt.config.EMPTY_TOOLBAR_SCHEME;this._oHierarchyConfigMap={};this._oHierarchyConfigMap[sap.gantt.config.DEFAULT_HIERARCHY_KEY]=sap.gantt.config.DEFAULT_HIERARCHY;this._oDefaultExpansionStatus={};this._oTT.addEventDelegate({onAfterRendering:this._appendMaskSvg},this);this._oTT.addEventDelegate({onAfterRendering:this._updateCSSForDummyRow},this);this._oSelectionPanelDrawer=new f();this.attachEvent("collapseDummyRow",this._onRowCollapse);this._oGanttChartSchemesConfigMap={};this._oGanttChartSchemesConfigMap[sap.gantt.config.DEFAULT_CHART_SCHEME_KEY]=sap.gantt.config.DEFAULT_CHART_SCHEME;this._oObjectTypesConfigMap={};this._oObjectTypesConfigMap[sap.gantt.config.DEFAULT_OBJECT_TYPE_KEY]=sap.gantt.config.DEFAULT_OBJECT_TYPE;this._oShapesConfigMap={};jQuery.sap.measure.end("GanttChartWithTable Init");};k.prototype.setFixedColumnCount=function(F){this.setProperty("fixedColumnCount",F);this._oTT.setFixedColumnCount(F);return this;};k.prototype.setTimeAxis=function(t){this.setProperty("timeAxis",t);this._oGanttChart.setTimeAxis(t);return this;};k.prototype.setMode=function(m){this.setProperty("mode",m);this._oGanttChart.setMode(m);this._oToolbar.setMode(m);return this;};k.prototype.setModes=function(m){this.setProperty("modes",m);this._oToolbar.setModes(m);this._oGanttChart.setModes(m);this._oModesConfigMap={};if(m){for(var i=0;i<m.length;i++){this._oModesConfigMap[m[i].getKey()]=m[i];}}return this;};k.prototype.setSelectionMode=function(s){this.setProperty("selectionMode",s);if(this._oTT){if(s==sap.gantt.SelectionMode.None){this._oTT.setSelectionMode(sap.ui.table.SelectionMode.None);this._oTT.setSelectionBehavior(sap.ui.table.SelectionBehavior.RowOnly);}else if(s==sap.gantt.SelectionMode.MultiWithKeyboard){this._oTT.setSelectionMode(sap.ui.table.SelectionMode.Multi);this._oTT.setSelectionBehavior(sap.ui.table.SelectionBehavior.Row);}else{if(s==sap.gantt.SelectionMode.Single){this._oTT.setSelectionMode(sap.ui.table.SelectionMode.Single);}else{this._oTT.setSelectionMode(sap.ui.table.SelectionMode.MultiToggle);}this._oTT.setSelectionBehavior(sap.ui.table.SelectionBehavior.RowSelector);}}if(this._oGanttChart){this._oGanttChart.setSelectionMode(s);}return this;};k.prototype.setToolbarSchemes=function(t){this.setProperty("toolbarSchemes",t);this._oToolbar.setToolbarSchemes(t);this._oToolbarSchemeConfigMap={};if(t){for(var i=0;i<t.length;i++){this._oToolbarSchemeConfigMap[t[i].getKey()]=t[i];}}return this;};k.prototype.setHierarchyKey=function(H){this.setProperty("hierarchyKey",H);this._oToolbar.setSourceId(H);this._hierarchyChange();return this;};k.prototype.setHierarchies=function(H){this.setProperty("hierarchies",H);this._oToolbar.setHierarchies(H);this._oGanttChart.setHierarchies(H);this._oHierarchyConfigMap={};if(H){for(var i=0;i<H.length;i++){this._oHierarchyConfigMap[H[i].getKey()]=H[i];}}this._hierarchyChange();return this;};k.prototype.setCalendarDef=function(o){this.setAggregation("calendarDef",o);var p=o.getBindingInfo("defs");if(p){p.templateShareable=true;}this._oGanttChart.setCalendarDef(o.clone());return this;};k.prototype._hierarchyChange=function(){var H=this.getHierarchyKey();if(H&&this._oHierarchyConfigMap[H]){if(this._oHierarchyConfigMap[H].getColumns()&&this._oHierarchyConfigMap[H].getColumns().length>0){this._buildColumnFromCellCallback();}var m=this.getMode();if(m===sap.gantt.config.DEFAULT_MODE_KEY&&this._oHierarchyConfigMap[this.getHierarchyKey()]){m=this._oHierarchyConfigMap[this.getHierarchyKey()].getActiveModeKey();}this.setMode(m);this.setSelectionMode(this.getSelectionMode());}};k.prototype._buildColumnFromCellCallback=function(){this._oTT.removeAllColumns();var H,j;H=this._oHierarchyConfigMap[this.getHierarchyKey()];if(H){j=H.getColumns();}if(j){for(var i=0;i<j.length;i++){var o=new C({label:j[i].getTitle(),sortProperty:j[i].getSortAttribute(),filterProperty:j[i].getFilterAttribute(),width:j[i].getWidth(),template:new d({cellCallback:this.getCellCallback(),columnConfig:j[i]})});this._oTT.addColumn(o);}}this._oTT._bCallUpdateTableCell=true;};k.prototype.setObjectTypes=function(o){this.setProperty("objectTypes",o);this._oGanttChart.setObjectTypes(o);this._oObjectTypesConfigMap={};if(o){for(var i=0;i<o.length;i++){this._oObjectTypesConfigMap[o[i].getKey()]=o[i];}}return this;};k.prototype.setChartSchemes=function(j){this.setProperty("chartSchemes",j);this._oGanttChart.setChartSchemes(j);this._oGanttChartSchemesConfigMap={};if(j){for(var i=0;i<j.length;i++){this._oGanttChartSchemesConfigMap[j[i].getKey()]=j[i];}}return this;};k.prototype.setShapeDataNames=function(s){this.setProperty("shapeDataNames",s);this._oGanttChart.setShapeDataNames(s);return this;};k.prototype.setLocale=function(l){this.setProperty("locale",l);this._oGanttChart.setLocale(l);return this;};k.prototype.setShapes=function(s){this.setProperty("shapes",s);this._oGanttChart.setShapes(s);this._oShapesConfigMap={};if(s){for(var i=0;i<s.length;i++){this._oShapesConfigMap[s[i].getKey()]=s[i];}}return this;};k.prototype.setSvgDefs=function(s){this.setProperty("svgDefs",s);this._oGanttChart.setSvgDefs(s);return this;};k.prototype.setEnableCursorLine=function(E){this.setProperty("enableCursorLine",E);this._oGanttChart.setEnableCursorLine(E);this._oToolbar.setEnableCursorLine(E);return this;};k.prototype.setEnableNowLine=function(E){this.setProperty("enableNowLine",E);this._oGanttChart.setEnableNowLine(E);this._oToolbar.setEnableNowLine(E);return this;};k.prototype.setEnableVerticalLine=function(E){this.setProperty("enableVerticalLine",E);this._oGanttChart.setEnableVerticalLine(E);this._oToolbar.setEnableVerticalLine(E);return this;};k.prototype.setTimeZoomRate=function(t){this.setProperty("timeZoomRate",t);this._oGanttChart.setTimeZoomRate(t);return this;};k.prototype.addRelationship=function(r){this._oGanttChart.addRelationship(r);};k.prototype.insertRelationship=function(i,r){this._oGanttChart.insertRelationship(i,r);};k.prototype.removeRelationship=function(r){this._oGanttChart.removeRelationship(r);};k.prototype.getRelationships=function(){this._oGanttChart.getRelationships();};k.prototype.destroyRelationships=function(){this._oGanttChart.destroyRelationships();};k.prototype.indexOfRelationship=function(r){this._oGanttChart.indexOfRelationship(r);};k.prototype.removeAllRelationships=function(){this._oGanttChart.removeAllRelationships();};k.prototype.updateRelationships=function(r){this._oGanttChart.updateRelationships(r);};k.prototype.setSelectionPanelSize=function(s,i){this.setProperty("selectionPanelSize",s,i);this._oSelectionPanelCnt.setLayoutData(new b({size:s}));return this;};k.prototype.addCustomToolbarItem=function(o){this._oToolbar.addCustomToolbarItem(o);};k.prototype.insertCustomToolbarItem=function(o,i){this._oToolbar.insertCustomToolbarItem(o,i);};k.prototype.removeCustomToolbarItem=function(o){this._oToolbar.removeCustomToolbarItem(o);};k.prototype.removeAllCustomToolbarItems=function(){this._oToolbar.removeAllCustomToolbarItems();};k.prototype.addColumn=function(o){this._oTT.addColumn(o);};k.prototype.insertColumn=function(o,i){this._oTT.insertColumn(o,i);};k.prototype.removeColumn=function(o){this._oTT.removeColumn(o);};k.prototype.removeAllColumns=function(){this._oTT.removeAllColumns();};k.prototype.getColumns=function(){return this._oTT.getColumns();};k.prototype._bindAggregation=function(n,B){var m,o;if(n=="rows"&&B){m=this.getModel(B.model);o=this.getBindingContext(B.model);if(o&&m){B.path=m.resolve(B.path,o);}this._oTT.bindRows(B);this._oGanttChart.bindRows(B);this._oTC.updateRows=this._updateRows.bind(this);}else if(n=="relationships"&&B){m=this.getModel(B.model);o=this.getBindingContext(B.model);if(o&&m){B.path=m.resolve(B.path,o);}this._oGanttChart.bindRelationships(B);}else{return sap.ui.core.Control.prototype._bindAggregation.apply(this,arguments);}};k.prototype._updateRows=function(){sap.ui.table.Table.prototype.updateRows.apply(this._oTT,arguments);sap.ui.table.Table.prototype.updateRows.apply(this._oTC,arguments);};k.prototype._detachToolbarEvents=function(){this._oToolbar.detachSourceChange(this._onToolbarSourceChange,this);this._oToolbar.detachExpandTreeChange(this._onToolbarExpandTreeChange,this);};k.prototype.onAfterRendering=function(){this._attachEvents();this._oTT._oHSb.setContentSize(this._oTT.$().find(".sapUiTableCtrlScroll").width()+"px");};k.prototype._attachEvents=function(){var D={onAfterRendering:this._onTTandTCafterRendering};this._oTT.removeEventDelegate(D);this._oTT.addEventDelegate(D,this);this._oTC.removeEventDelegate(D);this._oTC.addEventDelegate(D,this);};k.prototype._onRowSelectionChange=function(E){this.fireRowSelectionChange({originEvent:E.getParameter("originEvent")});this._oTT._oSelection.fireSelectionChanged();};k.prototype._onChartMouseOver=function(E){var p=E.getParameters();this.fireChartMouseOver({objectInfo:p.objectInfo,leadingRowInfo:p.leadingRowInfo,timestamp:p.timestamp,svgId:p.svgId,svgCoordinate:p.svgCoordinate,effectingMode:p.effectingMode,originEvent:p.originEvent});};k.prototype._onShapeSelectionChange=function(E){this.fireShapeSelectionChange({originEvent:E.getParameter("originEvent")});};k.prototype._onRelationshipSelectionChange=function(E){this.fireRelationshipSelectionChange({originEvent:E.getParameter("originEvent")});};k.prototype._onDoubleClick=function(E){var p=E.getParameters();this.fireChartDoubleClick({objectInfo:p.objectInfo,leadingRowInfo:p.leadingRowInfo,timestamp:p.timestamp,svgId:p.svgId,svgCoordinate:p.svgCoordinate,effectingMode:p.effectingMode,originEvent:p.originEvent});};k.prototype._onRightClick=function(E){var p=E.getParameters();this.fireChartRightClick({objectInfo:p.objectInfo,leadingRowInfo:p.leadingRowInfo,timestamp:p.timestamp,svgId:p.svgId,svgCoordinate:p.svgCoordinate,effectingMode:p.effectingMode,originEvent:p.originEvent});};k.prototype._onChartDragEnter=function(E){this.fireChartDragEnter({originEvent:E.getParameter("originEvent")});};k.prototype._onChartDragLeave=function(E){this.fireChartDragLeave({originEvent:E.getParameter("originEvent"),draggingSource:E.getParameter("draggingSource")});};k.prototype._onShapeDragEnd=function(E){var p=E.getParameters();this.fireShapeDragEnd({originEvent:p.originEvent,sourceShapeData:p.sourceShapeData,targetData:p.targetData,sourceSvgId:p.sourceSvgId,targetSvgId:p.targetSvgId});};k.prototype._onChartHSbScroll=function(E){var n=this._oTC._oHSb.getScrollPosition();this.fireHorizontalScroll({scrollSteps:n,leftOffsetRate:this._oGanttChart.updateLeftOffsetRate(n)});};k.prototype._onChartVSbScroll=function(E){this.fireVerticalScroll({scrollSteps:this._oTC._oVSb.getScrollPosition()});this._oTT.setFirstVisibleRow(this._oTC._oVSb.getScrollPosition()||0,true);};k.prototype._onChartShapesUpdated=function(E){this._appendMaskSvg();this._updateCSSForDummyRow();this.fireEvent("_shapesUpdated",{aSvg:E.mParameters.aSvg});};k.prototype._onSelectionPanelVSbScroll=function(E){this._oTC._oVSb.setScrollPosition(this._oTT.getFirstVisibleRow());};k.prototype._onSplitterResize=function(E){var p=E.getParameters();p.zoomInfo=this._oGanttChart.calculateZoomInfoFromChartWidth(p.newSizes[1]);this.fireSplitterResize(p);};k.prototype._onToolbarSourceChange=function(E){var o=this.getHierarchyKey();this.setHierarchyKey(E.getParameter("id"));this.notifySourceChange();this.fireGanttChartSwitchRequested({hierarchyKey:E.getParameter("id"),oldHierarchyKey:o});};k.prototype._onToolbarExpandTreeChange=function(E){var s=E.getParameter("action");if(s){var j=this._oTT.getSelectedIndices();for(var i=j.length-1;i>-1;i--){this._oTT[s](j[i]);j=this._oTT.getSelectedIndices();}}};k.prototype._onToolbarModeChange=function(E){var B=this.getBinding("mode");if(B){B.setValue(E.getParameter("mode"));}this.setMode(E.getParameter("mode"));};k.prototype.expandChartChange=function(E){var p=E.getParameters();this._oGanttChart.expandChartChange(p.isExpand,p.expandedChartSchemes,p.aExpandedIndices);};k.prototype.getBaseRowHeight=function(){if(this._oTT.getRows()[0]){return this._oTT.getRows()[0].getDomRef().scrollHeight;}};k.prototype._onTTandTCafterRendering=function(E){var t=this._oTT;var l=jQuery(t.getDomRef());var o=this._oTC;var m=jQuery(o.getDomRef());var O=t.getId();var s=o.getId();var n=E.srcControl;var I,p;if(n===t){o.setRowHeight(this.getBaseRowHeight());I=s;p=o;l.find(".sapUiTableRowHdr").hover(function(v){var w=v.type,x=l.find(".sapUiTableRowHdr").index(this),y;if(g.isMultipleSpanMainRow(t,x,false)){var z=g.getMultipleSpanMainRowGroupIndices(t,x,false);for(var i=0;i<z.length;i++){y=t.getRows()[z[i]];if(y){jQuery(y.getDomRef()).trigger(w,[t.getId()]);}}}else{y=o.getRows()[x];if(y){jQuery(y.getDomRef()).trigger(w,[t.getId()]);}}});}else if(n===o){I=O;p=t;m.find(".sapUiTableRowHdr").hover(function(v){var w=v.type,x=m.find(".sapUiTableRowHdr").index(this),y;if(g.isMultipleSpanMainRow(o,x)){var z=g.getMultipleSpanMainRowGroupIndices(o,x);for(var i=0;i<z.length;i++){y=o.getRows()[z[i]];if(y){jQuery(y.getDomRef()).trigger(w,[o.getId()]);}}}else{y=t.getRows()[x];if(y){jQuery(y.getDomRef()).trigger(w,[o.getId()]);}}});}var q=function(v,F,M){var w=v.type;var x=jQuery(this).control(0);var y=n.indexOfRow(x);if(M===undefined&&g.isMultipleSpanMainRow(n,y,false)){var z=g.getMultipleSpanMainRowGroupIndices(n,y,false);if(F!==I){if(F===s&&w!=="mouseleave"){var B=p.getRows()[y];if(B){jQuery(B.getDomRef()).trigger(w,[n.getId()],true);}}else{for(var i=0;i<z.length;i++){var D=n.getRows()[z[i]];var H=p.getRows()[z[i]];if(D&&H){jQuery(D.getDomRef()).trigger(w,[p.getId()],true);jQuery(H.getDomRef()).trigger(w,[n.getId()],true);}}}}}else if(F!==I){if(y>-1){x=p.getRows()[y];if(x){jQuery(x.getDomRef()).trigger(w,[n.getId()],true);}}}};var r=n.getRows();var R=r.length;var j=0;for(j=0;j<R;j++){var u=jQuery(r[j].getDomRef());if(jQuery._data(u[0],"events")===undefined||jQuery._data(u[0],"events").mouseover.length<2){u.mouseenter(q);u.mouseleave(q);}}this._expandDefaultLevel();};k.prototype._onRowCollapse=function(E){this.expandChartChange(E);};k.prototype.getToolbarSchemeKey=function(){return this._oToolbar.getToolbarSchemeKey();};k.prototype.jumpToPosition=function(D){this._oGanttChart.jumpToPosition(D);};k.prototype.selectShapes=function(i,j){return this._oGanttChart.selectShapes(i,j);};k.prototype.deselectShapes=function(i){return this._oGanttChart.deselectShapes(i);};k.prototype.selectRelationships=function(i,j){return this._oGanttChart.selectRelationships(i,j);};k.prototype.deselectRelationships=function(i){return this._oGanttChart.deselectRelationships(i);};k.prototype.selectRows=function(i,j){return this._oGanttChart.selectRows(i,j);};k.prototype.deselectRows=function(i){return this._oGanttChart.deselectRows(i);};k.prototype.selectRowsAndShapes=function(i,I){return this._oGanttChart.selectRowsAndShapes(i,I);};k.prototype.getAllSelections=function(){return this._oGanttChart.getAllSelections();};k.prototype.getSelectedShapes=function(){var s=this._oGanttChart.getSelectedShapes();return s;};k.prototype.getSelectedRows=function(){var s=this._oGanttChart.getSelectedRows();return s;};k.prototype.getSelectedRelationships=function(){var s=this._oGanttChart.getSelectedRelationships();return s;};k.prototype.setDraggingData=function(D){this._oGanttChart.setDraggingData(D);};k.prototype._updateCSSForDummyRow=function(){var r=this._oTT.getRows();var R=this._oTT.$().find(".sapUiTableRowHdrScr").children();for(var i=0;i<r.length;i++){var o=r[i];var j=o.getIndex();if(j!==-1&&g.isMultipleSpanMainRow(this._oTT,i)){var l=g.getContextObject(this._oTT,j);if(l.afterNodeNum>0){r[i].$().addClass("sapGanttTrNoBorder");$(R[i]).addClass("sapGanttTHeaderNoBorder");}else{r[i].$().removeClass("sapGanttTrNoBorder");$(R[i]).removeClass("sapGanttTHeaderNoBorder");}}else{r[i].$().removeClass("sapGanttTrNoBorder");$(R[i]).removeClass("sapGanttTHeaderNoBorder");}}};k.prototype._drawSelectionPanel=function(){var t=d3.select("#"+this.getId()+"-spm-svg-table");var s=d3.select("#"+this.getId()+"-spm-svg-selection");var D=this._oGanttChart.getShapeData();if(D!==undefined){this._oSelectionPanelDrawer.drawSvg(t,s,D,this);}};k.prototype._appendMaskSvg=function(){var i=this.$().find("#"+this.getId()+"-spm-svg-table-ctn");var j=this.$().find("#"+this.getId()+"-spm-svg-slecetion-ctn");if(i.length==0&&j.length==0){i=$("<div id='"+this.getId()+"-spm-svg-table-ctn' class='sapGanttChartSPMSvgCtn' >"+"<svg id='"+this.getId()+"-spm-svg-table' class='sapGanttSPMaskSvg'>"+"</svg>"+"</div>");j=$("<div id='"+this.getId()+"-spm-svg-slecetion-ctn' class='sapGanttChartSPMSvgCtn' >"+"<svg id='"+this.getId()+"-spm-svg-selection' class='sapGanttSPMaskSvg'>"+"</svg>"+"</div>");this._oTT.$().find("table").parent().append(i);this._oTT.$().find("table").parent().parent().prev().append(j);}$(i).attr("style",this._oTT.$().find("table").attr("style"));this._drawSelectionPanel();};k.prototype.getAxisOrdinal=function(){return this._oGanttChart.getAxisOrdinal();};k.prototype.getAxisTime=function(){return this._oGanttChart.getAxisTime();};k.prototype._expandDefaultLevel=function(){var E;var H=this.getHierarchyKey();if(this._oDefaultExpansionStatus){if(this._oDefaultExpansionStatus[H]===true){return;}}if(this._oHierarchyConfigMap[H]&&this._oHierarchyConfigMap[H].getExpandedLevels()){E=this._oHierarchyConfigMap[this.getHierarchyKey()].getExpandedLevels();var B=this._oTT.getBinding("rows");var t=B.getModel().getObject(B.getPath());var l=0;var r=0;var m=[];var n=this._oTT.getBindingInfo("rows").parameters.arrayNames;var I;var o=function(N){for(var i=0;i<n.length;i++){if(N[n[i]]){return true;}}return false;};if(E.length<=0){this._oDefaultExpansionStatus[H]=true;return;}else{var p=function(i,N){if(l>E.length){if(l===(E.length+1)){r++;}return;}if(o(N)===true){if(!($.inArray(N.type,E[l])>-1)){if(m){m.push(r);}else{m=[r];}}r++;if(l<=E.length){l++;for(var j=0;j<n.length;j++){if(N[n[j]]){jQuery.each(N[n[j]],p);}}l--;}}else{r++;}};var q=function(){B.detachChange(q,this);for(var i=0;i<n.length;i++){if(t[n[i]]){jQuery.each(t[n[i]],p);}}B.getContexts(this._oTT.getFirstVisibleRow(),0);for(I=0;I<m.length;I++){this._oTT.collapse(m[I]);}};B.attachChange(q,this);this._oTT.expandToLevel(E.length);}}this._oDefaultExpansionStatus[H]=true;};k.prototype.canExpandGanttChart=function(){var i=false;var s=this.getHierarchyKey(),j=this.getHierarchies(),l=this.getToolbarSchemes();var F=j.filter(function(H){return H.getKey()===s;})||[];F.forEach(function(H){i=l.filter(function(p){return p.getKey()===H.getToolbarSchemeKey();}).some(function(t){return t.getExpandChart();});});var o=this.getParent();if(!i&&o.getToolbarSchemes){var L=o.getContainerLayoutKey(),m=o.getContainerLayouts(),n=m.filter(function(I){return I.getKey()===L;})||[];n.forEach(function(p){i=o.getToolbarSchemes().filter(function(I){return I.getKey()===n[0].getToolbarSchemeKey();}).some(function(I){return I.getExpandChart();});});}return i;};k.prototype.expand=function(r){this._oTT.expand(r);return this;};k.prototype.collapse=function(r){this._oTT.collapse(r);return this;};k.prototype.setSelectedIndex=function(r){this._oTT.setSelectedIndex(r);return this;};k.prototype.getSelectedIndex=function(){return this._oTT.getSelectedIndex();};k.prototype.getFirstVisibleRow=function(){return this._oTT.getFirstVisibleRow();};k.prototype.setFirstVisibleRow=function(r){this._oTT.setFirstVisibleRow(r);return this;};k.prototype.getVisibleRowCount=function(){return this._oTT.getVisibleRowCount();};k.prototype.getRows=function(){return this._oTT.getRows();};k.prototype.exit=function(){this._detachToolbarEvents();this._oSplitter.destroy();};G.prototype.notifySourceChange=function(){this._oTT.data(g.JSONDataKey,null);};return k;},true);};if(!jQuery.sap.isDeclared('sap.gantt.legend.DimensionLegend')){jQuery.sap.declare('sap.gantt.legend.DimensionLegend');sap.ui.define("sap/gantt/legend/DimensionLegend",["./LegendBase"],function(L){"use strict";var D=L.extend({metadata:{properties:{shape:{type:"sap.gantt.config.Shape"},xDimension:{type:"string"},yDimension:{type:"string"},xDomain:{type:"array"},yDomain:{type:"array"}}}});return D;},true);};
