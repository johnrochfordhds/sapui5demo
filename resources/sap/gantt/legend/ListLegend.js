/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.define(["./LegendBase","sap/gantt/drawer/ListLegend","sap/gantt/drawer/CalendarPattern"],function(L,a,C){"use strict";var b=L.extend("sap.gantt.legend.ListLegend",{metadata:{properties:{shapes:{type:"array"}}}});b.prototype.init=function(){L.prototype.init.apply(this,arguments);this._oListLegendDrawer=new a();};b.prototype.onAfterRendering=function(){for(var i=0;i<this._aShapeInstance.length;i++){var s=this._aShapeInstance[i];var S=d3.select("#"+this.getId()+"-svg-"+i);this._oListLegendDrawer._drawPerTag(S,s);}};b.prototype.setShapes=function(s){if(s&&s.length>0){this._aShapeInstance=this._instantShape(s);this.setProperty("shapes",s);}return this;};b.prototype._instantShape=function(s){var r=[];for(var i=0;i<s.length;i++){if(s[i].getShapeClassName()){var S=this._instantiateCustomerClass(s[i].getShapeClassName(),i,s[i]);if(s[i].getClippathAggregation()&&s[i].getClippathAggregation()instanceof Array){var p=this._instantShape(s[i].getClippathAggregation());r=r.concat(p);}else if(s[i].getGroupAggregation()&&s[i].getGroupAggregation()instanceof Array){var A=this._instantShape(s[i].getGroupAggregation());for(var k=0;k<A.length;k++){S.addShape(A[k]);}}if(this._isProperShape(S)){r.push(S);}}}return r;};b.prototype._isProperShape=function(s){if(s instanceof sap.gantt.shape.cal.Calendar){jQuery.sap.log.warning("Calendar is not proper shape","key '"+s.mShapeConfig.getKey()+"'","ListLegend");return false;}else if(s.getTag()=="clippath"){return false;}else{return true;}};b.prototype._instantiateCustomerClass=function(c,s,S){var d=jQuery.sap.getObject(c);if(!d){jQuery.sap.require(c);d=jQuery.sap.getObject(c);}var o=new d();o.mShapeConfig=S;o.mChartInstance=this;return o;};return b;},true);
