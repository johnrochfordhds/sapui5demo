/*!
 * SAP APF Analysis Path Framework
 *
 * (c) Copyright 2012-2014 SAP SE. All rights reserved
 */
jQuery.sap.require("sap.apf.modeler.ui.utils.textPoolHelper");jQuery.sap.require("sap.apf.modeler.ui.utils.nullObjectChecker");jQuery.sap.require("sap.apf.modeler.ui.utils.viewValidator");(function(){"use strict";var p,t,c,C,T,o,v;var n=new sap.apf.modeler.ui.utils.NullObjectChecker();function _(h){var i=h.byId("idCategoryTitle");var j=new sap.apf.modeler.ui.utils.TextPoolHelper(T);var D={oTranslationFormat:sap.apf.modeler.ui.utils.TranslationFormatMap.CATEGORY_TITLE,type:"text"};j.setAutoCompleteOn(i,D);}function a(h){h.byId("idCategoryBasicData").setTitle(t("categoryData"));h.byId("idCategoryTitleLabel").setText(t("categoryTitle"));h.byId("idCategoryTitle").setPlaceholder(t("newCategory"));h.byId("idTotalStepsLabel").setText(t("totalSteps"));}function b(h){var s;if(p&&p.arguments&&p.arguments.categoryId){o=C.getCategory(p.arguments.categoryId);}if(!n.checkIsNotUndefined(o)){s=C.setCategory();o=C.getCategory(s);d(h);}}function d(h,i){var j={id:o.getId(),icon:"sap-icon://open-folder"};if(i){delete j.icon;j.name=i;}h.getView().getViewData().updateSelectedNode(j);}function e(h,i){var s=t("category")+": "+i;h.getView().getViewData().updateTitleAndBreadCrumb(s);}function f(h){if(!n.checkIsNotNullOrUndefinedOrBlank(C.getCategory(p.arguments.categoryId))){return;}if(n.checkIsNotNullOrUndefinedOrBlank(o.labelKey)&&T.get(o.labelKey)){h.byId("idCategoryTitle").setValue(T.get(o.labelKey).TextElementDescription);}else{h.byId("idCategoryTitle").setValue(o.getId());}}function g(h){var i=C.getCategoryStepAssignments(o.getId()).length;h.byId("idTotalSteps").setValue(i);}sap.ui.controller("sap.apf.modeler.ui.controller.category",{onInit:function(){var h=this;var V=h.getView().getViewData();t=V.getText;p=V.oParams;c=V.oConfigurationHandler;T=c.getTextPool();C=V.oConfigurationEditor;if(!C){c.loadConfiguration(p.arguments.configId,function(i){C=i;});}v=new sap.apf.modeler.ui.utils.ViewValidator(h.getView());a(h);_(h);b(h);h.setDetailData();v.addField("idCategoryTitle");},setDetailData:function(){var h=this;f(h);g(h);},handleChangeDetailValue:function(E){var h=this,s,i;var j=h.byId("idCategoryTitle").getValue().trim();var k=sap.apf.modeler.ui.utils.TranslationFormatMap.CATEGORY_TITLE;if(n.checkIsNotNullOrUndefinedOrBlank(j)){s=T.setText(j,k);i={labelKey:s};C.setCategory(i,o.getId());d(h,j);e(h,j);}C.setIsUnsaved();},updateSubViewInstancesOnReset:function(h){C=h;o=C.getCategory(o.getId());},getValidationState:function(){return v.getValidationState();},onExit:function(){v=null;}});})();
