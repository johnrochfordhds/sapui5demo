/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
sap.ui.jsview("sap.apf.ui.reuse.view.carousel",{getStepGallery:function(){var s=this.oController.stepGalleryView;return s;},getChartToolbar:function(){return this.oController.oStepToolbar;},carouselContent:function(c){jQuery.sap.require('sap.apf.ui.controls.draggableCarousel.DraggableCarousel');var s=this;this.oController=c;this.stepViews=[];var v=this.getViewData().oInject;s.oCoreApi=v.oCoreApi;s.oUiApi=v.uiApi;var a=new sap.ui.core.Icon({src:"sap-icon://arrow-bottom"}).addStyleClass('downArrow');var b=document.createElement('div');b.innerHTML=sap.ui.getCore().getRenderManager().getHTML(a);var r=new sap.ui.core.Icon({src:"sap-icon://sys-cancel-2",size:"20px",tooltip:this.oCoreApi.getTextNotHtmlEncoded("deleteStep")}).addStyleClass('removeIcon');var d=document.createElement('div');d.innerHTML=sap.ui.getCore().getRenderManager().getHTML(r);var h=jQuery(window).height()-sap.apf.ui.utils.CONSTANTS.carousel.SCROLLCONTAINER+"px";var w="320px";window.onresize=function(){var h=jQuery(window).height()-sap.apf.ui.utils.CONSTANTS.carousel.SCROLLCONTAINER+"px";jQuery('.DnD-container').css({"height":jQuery(window).height()-sap.apf.ui.utils.CONSTANTS.carousel.DNDBOX+"px"});jQuery(".scrollContainerEle").css("height",h);};this.dndBox=new sap.apf.ui.controls.draggableCarousel.DraggableCarousel({containerHeight:jQuery(window).height()-sap.apf.ui.utils.CONSTANTS.carousel.DNDBOX+"px",containerWidth:w,blockHeight:sap.apf.ui.utils.CONSTANTS.thumbnailDimensions.STEP_HEIGHT,blockWidth:sap.apf.ui.utils.CONSTANTS.thumbnailDimensions.STEP_WIDTH,blockMargin:sap.apf.ui.utils.CONSTANTS.thumbnailDimensions.STEP_MARGIN,separatorHeight:sap.apf.ui.utils.CONSTANTS.thumbnailDimensions.SEPARATOR_HEIGHT,removeIconHeight:sap.apf.ui.utils.CONSTANTS.thumbnailDimensions.REMOVE_ICON_HEIGHT,separator:b,removeIcon:d,onBeforeDrag:function(f){return;},onAfterDrop:c.moveStep.bind(c),onAfterRemove:c.removeStep.bind(c),onAfterSelect:function(i){if(jQuery(this).attr("drag-state")==="true"){s.getStepView(i).oController.setActiveStep(i);}else{c.showStepGallery();}}});var u=this.createId("dnd-Holder");this.oHtml=new sap.ui.core.HTML({content:"<div id = '"+jQuery.sap.encodeHTML(u)+"'></div>",sanitizeContent:true,afterRendering:function(){s.dndBox.placeAt(u);jQuery(s.dndBox.eleRefs.blocks[0]).height("80px");}});var e;this.addButton=new sap.m.Button({text:s.oCoreApi.getTextNotHtmlEncoded("add-step"),width:"100%",icon:"sap-icon://add",press:function(f){c.showStepGallery();}});e=document.createElement('div');e.setAttribute('class','addStepBtnHolder');jQuery(e).html(jQuery(sap.ui.getCore().getRenderManager().getHTML(this.addButton)).attr("tabindex",-1));this.dndBox.addBlock({blockElement:e,dragState:false,dropState:false,removable:false});this.up=new sap.m.Button({icon:"sap-icon://arrow-top",tooltip:this.oCoreApi.getTextNotHtmlEncoded("moveStepUp"),press:function(){var f=s.oCoreApi.getSteps().indexOf(s.oCoreApi.getActiveStep());if(f!==0){var n=f-1;var g=s.oUiApi.getAnalysisPath().getCarousel().dndBox.swapBlocks(f,n);if(g){s.oUiApi.getAnalysisPath().getCarousel().getController().moveStep(f,n);}}}});this.down=new sap.m.Button({icon:"sap-icon://arrow-bottom",tooltip:this.oCoreApi.getTextNotHtmlEncoded("moveStepDown"),press:function(){var f=s.oCoreApi.getSteps().indexOf(s.oCoreApi.getActiveStep());if(f!==(s.oCoreApi.getSteps().length-1)){var n=f+1;var g=s.oUiApi.getAnalysisPath().getCarousel().dndBox.swapBlocks(f,n);if(g){s.oUiApi.getAnalysisPath().getCarousel().getController().moveStep(f,n);}}}});this.oCarousel=new sap.m.ScrollContainer({content:this.oHtml,height:h,horizontal:false,vertical:true}).addStyleClass("scrollContainerEle");return this.oCarousel;},getControllerName:function(){return"sap.apf.ui.reuse.controller.carousel";},createContent:function(c){var a=this.carouselContent(c);return a;},getStepView:function(s){return this.stepViews[s];}});
