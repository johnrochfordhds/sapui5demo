/*!
* SAP APF Analysis Path Framework
*
* (c) Copyright 2012-2014 SAP SE. All rights reserved
*/
sap.ui.controller("sap.apf.modeler.ui.controller.titleBreadCrumb",{setTitleForDetailPage:function(f){var c=this;c.byId("IdFormTitle").setText(f);}});sap.ui.controller("sap.apf.modeler.ui.controller.toolbar",{onInit:function(){this.oCoreApi=this.getView().getViewData().oConfigListInstance.oCoreApi;this.oConfigListInstance=this.getView().getViewData().oConfigListInstance;this._setDisplayText();},_setDisplayText:function(){this.byId("idAddButton").setText(this.oCoreApi.getText("addButton"));this.byId("idCopyButton").setText(this.oCoreApi.getText("copyButton"));this.byId("idDeleteButton").setText(this.oCoreApi.getText("deleteButton"));},enableCopyDeleteButton:function(){if(!this.byId("idCopyButton").getEnabled()){this.byId("idCopyButton").setEnabled(true);}if(!this.byId("idDeleteButton").getEnabled()){this.byId("idDeleteButton").setEnabled(true);}},disableCopyDeleteButton:function(){if(this.byId("idCopyButton").getEnabled()){this.byId("idCopyButton").setEnabled(false);}if(this.byId("idDeleteButton").getEnabled()){this.byId("idDeleteButton").setEnabled(false);}},_setAddMenuText:function(){sap.ui.core.Fragment.byId("idAddMenuFragment","idNewConfig").setText(this.oCoreApi.getText("newConfiguration"));sap.ui.core.Fragment.byId("idAddMenuFragment","idNewFacetFilter").setText(this.oCoreApi.getText("newFacetFilter"));sap.ui.core.Fragment.byId("idAddMenuFragment","idNewCategory").setText(this.oCoreApi.getText("newCategory"));sap.ui.core.Fragment.byId("idAddMenuFragment","idNewNavigationTarget").setText(this.oCoreApi.getText("newNavigationTarget"));sap.ui.core.Fragment.byId("idAddMenuFragment","idStep").setText(this.oCoreApi.getText("step"));sap.ui.core.Fragment.byId("idAddMenuFragment","idNewStep").setText(this.oCoreApi.getText("newStep"));sap.ui.core.Fragment.byId("idAddMenuFragment","idExistingStep").setText(this.oCoreApi.getText("existingStep"));sap.ui.core.Fragment.byId("idAddMenuFragment","idNewRepresentation").setText(this.oCoreApi.getText("newRepresentation"));},_setExistingStepDialogText:function(){sap.ui.core.Fragment.byId("idExistingStepDialogFragment","idExistingStepDialog").setTitle(this.oCoreApi.getText("existingStepDialogTitle"));},_enableDisableAddMenuItems:function(s,a){var A=a.getItems();var n;if(this.oConfigListInstance.configurationHandler.getList().length===0||s===null){n="default";}else{n=s.nodeObjectType;}var m={};m["default"]=1;m[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION]=4;m[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.FACETFILTER]=4;m[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY]=5;m[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP]=6;m[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.REPRESENTATION]=6;m[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.NAVIGATIONTARGET]=4;A.forEach(function(M,i){if(i<m[n]){M.setEnabled(true);}else{M.setEnabled(false);}});},_handlePressAddButton:function(e){var s;var S=this,i=true;if(this.oConfigListInstance.getView().byId("idConfigDetailData").getContent().length>=1){s=(typeof this.oConfigListInstance.getView().byId("idConfigDetailData").getContent()[0].getController==="function")?this.oConfigListInstance.getView().byId("idConfigDetailData").getContent()[0].getController():undefined;}e.getSource().$().blur();var n=sap.apf.modeler.ui.utils.navigationHandler.getInstance();if(s!==undefined){i=typeof s.getValidationState==="function"?s.getValidationState.call(s):true;}var c=this.oConfigListInstance.configEditor?jQuery.extend(true,{},this.oConfigListInstance.configEditor):undefined;this.oConfigListInstance.bIsSaved=c?c.isSaved():undefined;var a=false;var o=this.oConfigListInstance.oTreeInstance.getAPFTreeNodeContext(this.oConfigListInstance.oTreeInstance.getSelection());var A=e.getSource();var b=function(){if(!this.addMenu){this.addMenu=new sap.ui.xmlfragment("idAddMenuFragment","sap.apf.modeler.ui.fragment.addMenu",this);this.getView().addDependent(this.addMenu);this._setAddMenuText();}var d=sap.ui.core.Popup.Dock;this._enableDisableAddMenuItems(o,this.addMenu);this.addMenu.open(false,A,d.BeginTop,d.BeginBottom,A);};if(!i){n.throwMandatoryPopup(S.oConfigListInstance,{yes:function(){var p=S.oConfigListInstance.oTreeInstance.getParentNodeContext(o);S.oConfigListInstance.configEditor=S.oConfigListInstance.configurationHandler.restoreMemorizedConfiguration(p.configId);if(S.oConfigListInstance.bIsSaved===false&&S.oConfigListInstance.configEditor){S.oConfigListInstance.configEditor.setIsUnsaved();}var N=S.oConfigListInstance._navMandatoryResetState(S.oConfigListInstance);if(!N.isNewView){b.call(S);}}});a=true;}if(!a){b.call(S);}},_handleAddMenuItemPress:function(e){var i=this.addMenu.getItems();var a=e.getParameters("item");var n;var N={"idAddMenuFragment--idNewFacetFilter":sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.FACETFILTER,"idAddMenuFragment--idNewCategory":sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY,"idAddMenuFragment--idNewStep":sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP,"idAddMenuFragment--idNewRepresentation":sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.REPRESENTATION,"idAddMenuFragment--idNewConfig":sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION,"idAddMenuFragment--idNewNavigationTarget":sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.NAVIGATIONTARGET,"default":sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION};i.forEach(function(I){if(I.getId()===a.id){n=N[I.getId()];}else if(I.getSubmenu()){I.getSubmenu().getItems().forEach(function(I){if(I.getId()===a.id){n=N[I.getId()];}});}});if(a.id==="idAddMenuFragment--idExistingStep"){this._handleAddExistingStepPress();}else if(a.id!=="idAddMenuFragment--idStep"&&n!==undefined){this.oConfigListInstance.oTreeInstance.addNodeInTree(n);}},_copyConfiguration:function(c,n){var C=this.oConfigListInstance.configurationHandler.getConfiguration(c);var o={},a;o.AnalyticalConfiguration=C.AnalyticalConfiguration;o.name="< "+C.AnalyticalConfigurationName+" >";o.Application=C.Application;o.type=sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION;o.bIsLoaded=false;o.bToggleState=false;o.isSelected=true;o.expanded=true;o.selectable=true;o.hasExpander=true;this.oConfigListInstance.oModel.getData().aConfigDetails.push(o);this.oConfigListInstance.oModel.updateBindings();a=this.oConfigListInstance.oTreeInstance.getModel().getContext(n);this.oConfigListInstance.selectedNode=this.oConfigListInstance.oTreeInstance.getNodeByContext(a);this.oConfigListInstance.modelUpdateDeferred[this.oConfigListInstance.oModel.getData().aConfigDetails.length-1]=new jQuery.Deferred();var b={appId:this.oConfigListInstance.appId,configId:c};sap.ui.core.UIComponent.getRouterFor(this.oConfigListInstance).navTo(o.type,b,true);},_handlePressCopyButton:function(e){var s;var S=this,a=true;if(this.oConfigListInstance.getView().byId("idConfigDetailData").getContent().length>=1){s=(typeof this.oConfigListInstance.getView().byId("idConfigDetailData").getContent()[0].getController==="function")?this.oConfigListInstance.getView().byId("idConfigDetailData").getContent()[0].getController():undefined;}e.getSource().$().blur();var n=sap.apf.modeler.ui.utils.navigationHandler.getInstance();if(s!==undefined){a=typeof s.getValidationState==="function"?s.getValidationState.call(s):true;}var c=this.oConfigListInstance.configEditor?jQuery.extend(true,{},this.oConfigListInstance.configEditor):undefined;this.oConfigListInstance.bIsSaved=c?c.isSaved():undefined;var b=false;var d=function(){var C=this;var h=this.oTreeInstance.getAPFTreeNodeContext(this.oTreeInstance.getSelection()||this.selectedNode);this.selectedNode=this.oTreeInstance.getSelection()||this.selectedNode;var k,l,m,p,O,q,r,t,u,v,w;m=h.nodeContext;switch(h.nodeObjectType){case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.FACETFILTER:var F=this.oCoreApi.getText("copyOf")+"  "+h.nodeTitle;var x=this.configEditor.copyFacetFilter(h.nodeAPFId);var y=this.configEditor.getFacetFilter(x);var T=sap.apf.modeler.ui.utils.TranslationFormatMap.FACETFILTER_LABEL;var z=this.oTextPool.setText(F,T);y.setLabelKey(z);O=m.split("/");q=O[2];r=O[6];var A=this.oModel.getData().aConfigDetails[q].configData[0].filters[r];A.isSelected=false;var B=jQuery.extend(true,{},A);B.id=x;B.name="< "+F+" >";B.isSelected=true;p=this.oModel.getData().aConfigDetails[q].configData[0].filters.length;this.oModel.getData().aConfigDetails[q].configData[0].filters.push(B);O[6]=p;l=O.join("/");break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY:var D=this.oCoreApi.getText("copyOf")+"  "+h.nodeTitle;var E=this.configEditor.copyCategory(h.nodeAPFId);var G=sap.apf.modeler.ui.utils.TranslationFormatMap.CATEGORY_TITLE;var H=this.oTextPool.setText(D,G);var I={labelKey:H};this.configEditor.setCategory(I,E);O=m.split("/");q=O[2];t=O[6];var N=[];var J=this.configEditor.getSteps();J.forEach(function(x1){if(C.configEditor.getCategoriesForStep(x1.getId())[0]===E){N.push(x1.getId());}});var K=this.oModel.getData().aConfigDetails[q].configData[1].categories[t];K.isSelected=false;var L=jQuery.extend(true,{},K);if(L.steps){for(var i=0;i<L.steps.length;i++){L.steps[i].id=N[i];var M=C.configEditor.getStep(N[i]);var P=M.getRepresentations();if(L.steps[i].representations){for(var j=0;j<L.steps[i].representations.length;j++){L.steps[i].representations[j].id=P[j].getId();}}}}L.id=E;L.name="< "+D+" >";L.isSelected=true;p=this.oModel.getData().aConfigDetails[q].configData[1].categories.length;this.oModel.getData().aConfigDetails[q].configData[1].categories.push(L);O[6]=p;l=O.join("/");break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.NAVIGATIONTARGET:var Q=this.oCoreApi.getText("copyOf")+"  "+h.nodeTitle;var R=this.configEditor.copyNavigationTarget(h.nodeAPFId);O=m.split("/");q=O[2];u=O[6];var U=this.oModel.getData().aConfigDetails[q].configData[2].navTargets[u];U.isSelected=false;var V=jQuery.extend(true,{},U);V.id=R;V.name="< "+Q+" >";V.isSelected=true;p=this.oModel.getData().aConfigDetails[q].configData[2].navTargets.length;this.oModel.getData().aConfigDetails[q].configData[2].navTargets.push(V);O[6]=p;l=O.join("/");break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP:var W=this.oCoreApi.getText("copyOf")+"  "+h.nodeTitle;var X=this.configEditor.copyStep(h.nodeAPFId);var Y=this.configEditor.getCategoriesForStep(X);var Z=this.configEditor.getStep(X);var $=sap.apf.modeler.ui.utils.TranslationFormatMap.STEP_TITLE;var _=this.oTextPool.setText(W,$);Z.setTitleId(_);O=m.split("/");q=O[2];t=O[6];v=O[8];var a1=this.oModel.getData().aConfigDetails[q].configData[1].categories[t].steps[v];a1.isSelected=false;var b1=jQuery.extend(true,{},a1);P=Z.getRepresentations();b1.id=X;b1.name="< "+W+" >";if(b1.representations){for(j=0;j<b1.representations.length;j++){b1.representations[j].id=P[j].getId();}}p=this.oModel.getData().aConfigDetails[q].configData[1].categories[t].steps.length;O[8]=p;l=O.join("/");for(var c1=0;c1<Y.length;c1++){var d1=jQuery.extend(true,{},b1);var e1={arguments:{configId:S.oConfigListInstance.configId,categoryId:Y[c1]}};var f1=S.oConfigListInstance.getSPathFromURL(e1).sPath.split("/");var g1=f1[6];this.oModel.getData().aConfigDetails[q].configData[1].categories[g1].steps.push(d1);}this.oModel.getData().aConfigDetails[q].configData[1].categories[t].steps[p].isSelected=true;break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.REPRESENTATION:O=m.split("/");q=O[2];t=O[6];v=O[8];w=O[10];var h1=this.oModel.getData().aConfigDetails[q].configData[1].categories[t].steps[v].id;var i1=this.configEditor.getStep(h1);var j1=this.configEditor.getCategoriesForStep(h1);this.oModel.getData().aConfigDetails[q].configData[1].categories[t].steps[v].representations[w].isSelected=false;var k1=this.oModel.getData().aConfigDetails[q].configData[1].categories[t].steps[v].representations[w];var l1=jQuery.extend(true,{},k1);var m1=i1.copyRepresentation(l1.id);l1.id=m1;p=this.oModel.getData().aConfigDetails[q].configData[1].categories[t].steps[v].representations.length;O[10]=p;l=O.join("/");for(var n1=0;n1<j1.length;n1++){var o1=jQuery.extend(true,{},l1);var p1={arguments:{configId:S.oConfigListInstance.configId,categoryId:j1[n1],stepId:h1}};var q1=S.oConfigListInstance.getSPathFromURL(p1).sPath.split("/");var r1=q1[6];var s1=q1[8];this.oModel.getData().aConfigDetails[q].configData[1].categories[r1].steps[s1].representations.push(o1);}this.oModel.getData().aConfigDetails[q].configData[1].categories[t].steps[v].representations[p].isSelected=true;break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION:var t1=this.oCoreApi.getText("copyOf")+"  "+h.nodeTitle;O=m.split("/");q=O[2];var u1=this.oModel.getData().aConfigDetails[q];u1.isSelected=false;O[2]=this.oModel.getData().aConfigDetails.length;l=O.join("/");this.configurationHandler.copyConfiguration(h.nodeAPFId,function(x1){var y1={AnalyticalConfigurationName:t1};var z1=C.configurationHandler.setConfiguration(y1,x1);C.configTitle=t1;C.configurationHandler.loadConfiguration(z1,function(A1){var t1=C.configTitle;var B1=sap.apf.modeler.ui.utils.TranslationFormatMap.APPLICATION_TITLE;var C1=C.configurationHandler.getTextPool().setText(t1,B1);A1.setApplicationTitle(C1);});S._copyConfiguration(x1,l);});break;default:break;}if(h.nodeObjectType!==sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION){this.oModel.updateBindings();k=this.oTreeInstance.getModel().getContext(l);this.selectedNode=this.oTreeInstance.getNodeByContext(k);var v1=this.oTreeInstance.getAPFTreeNodeContext(this.selectedNode);var w1=this.oTreeInstance.getParentNodeContext(v1);this.navigateToDifferntView(w1,v1);this.configEditor.setIsUnsaved();}};var f=function(){var h=new sap.m.Label().addStyleClass("noConfigSelected");h.setText(S.oConfigListInstance.oCoreApi.getText("noConfigSelected"));h.placeAt(S.oConfigListInstance.byId("idConfigDetailData"));S.oConfigListInstance.toolbarController.disableCopyDeleteButton();S.oConfigListInstance._enableDisableExportAndExecuteButton();};var o;if(!a){n.throwMandatoryPopup(S.oConfigListInstance,{yes:function(){var h=S.oConfigListInstance.oTreeInstance.getAPFTreeNodeContext(S.oConfigListInstance.oTreeInstance.getSelection());var p=S.oConfigListInstance.oTreeInstance.getParentNodeContext(h);S.oConfigListInstance.bIsDifferntConfig=S.oConfigListInstance.oTreeInstance.isConfigurationSwitched(S.oConfigListInstance.oPreviousSelectedNode,S.oConfigListInstance.selectedNode);S.oConfigListInstance.configEditor=S.oConfigListInstance.configurationHandler.restoreMemorizedConfiguration(p.configId);if(S.oConfigListInstance.bIsSaved===false&&S.oConfigListInstance.configEditor){S.oConfigListInstance.configEditor.setIsUnsaved();}if(S.oConfigListInstance.bIsDifferntConfig===false){var s=(typeof S.oConfigListInstance.getView().byId("idConfigDetailData").getContent()[0].getController==="function")?S.oConfigListInstance.getView().byId("idConfigDetailData").getContent()[0].getController():undefined;var i=S.oConfigListInstance._isNewSubView(s.getView().getViewData().oParams);if(!i){d.call(S.oConfigListInstance);S.oConfigListInstance._navHandleExpandDelete.call(S.oConfigListInstance,S.oConfigListInstance.oSelectedNodeDetails,p);}else{S.oConfigListInstance.handleConfirmDeletion();}}else{var N=S.oConfigListInstance._navMandatoryResetState(S.oConfigListInstance);if(!N.isNewView){if(N.bIsSaved===false){o(S.oConfigListInstance);}else{d.call(S.oConfigListInstance);}}}}});b=true;}var g;if(s.getView().getViewData().oParams.name==="configuration"){g=true;}o=function(h){n.throwLossOfDataPopup(h,{yes:function(i){S.oConfigListInstance._navSaveState(function(){i(function(j){if(S.oConfigListInstance.selectedNode){var B=S.oConfigListInstance.selectedNode.getBindingContext().sPath;var C=B.split("/");var k=C[2];}S.oConfigListInstance.oModel.getData().aConfigDetails[k].AnalyticalConfiguration=S.oConfigListInstance.configId;S.oConfigListInstance.oModel.updateBindings();d.call(S.oConfigListInstance);});});},no:function(){var h={appId:S.oConfigListInstance.appId,configId:S.oConfigListInstance.configId};var s=(typeof S.oConfigListInstance.getView().byId("idConfigDetailData").getContent()[0].getController==="function")?S.oConfigListInstance.getView().byId("idConfigDetailData").getContent()[0].getController():undefined;var g=(s.getView().getViewData().oParams.name==="configuration")?true:false;if(S.oConfigListInstance.configId.indexOf(sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.ISNEWCONFIG)===0){S.oConfigListInstance._navHandleExpandDelete.call(S.oConfigListInstance,{},h,g);S.oConfigListInstance.clearTitleAndBreadCrumb();S.oConfigListInstance.byId("idConfigDetailData").removeAllContent();f();}else{S.oConfigListInstance._navConfigResetState(S.oConfigListInstance,function(){d.call(S.oConfigListInstance);});}}});};if(S.oConfigListInstance.bIsSaved===false&&a&&g){o(S.oConfigListInstance);b=true;}if(!b){d.call(S.oConfigListInstance);}},_handlePressDeleteButton:function(e){var d;var s=this.oConfigListInstance.oTreeInstance.getAPFTreeNodeContext(this.oConfigListInstance.oTreeInstance.getSelection());var n=this.oCoreApi.getText(s.nodeObjectType);e.getSource().$().blur();if(s.nodeObjectType===sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP){d=this.oCoreApi.getText("confirmStepDeletion",[s.nodeTitle]);}else{d=this.oCoreApi.getText("confirmDeletion",[n,s.nodeTitle]);}this._openDeleteConfirmationDialog(d);},_openDeleteConfirmationDialog:function(d){var s=this;var c=jQuery.extend(s.oConfigListInstance,{closeDialog:s.closeDialog.bind(s)});if(!this.confirmationDialog){this.confirmationDialog=sap.ui.xmlfragment("idConfigConfirmationDialogFragment","sap.apf.modeler.ui.fragment.confirmationDialog",c);this.getView().addDependent(this.confirmationDialog);this._setConfirmationDialogText();}var a=new sap.m.Label();a.addStyleClass("dialogText");a.setText(d);this.confirmationDialog.removeAllContent();this.confirmationDialog.addContent(a);jQuery.sap.syncStyleClass("sapUiSizeCompact",this.getView(),this.confirmationDialog);this.confirmationDialog.open();},closeDialog:function(){if(this.confirmationDialog&&this.confirmationDialog.isOpen()){this.confirmationDialog.close();}},_setConfirmationDialogText:function(){sap.ui.core.Fragment.byId("idConfigConfirmationDialogFragment","idDeleteConfirmation").setTitle(this.oCoreApi.getText("confirmation"));sap.ui.core.Fragment.byId("idConfigConfirmationDialogFragment","idDeleteButton").setText(this.oCoreApi.getText("deleteButton"));sap.ui.core.Fragment.byId("idConfigConfirmationDialogFragment","idCancelButtonDialog").setText(this.oCoreApi.getText("cancel"));},_handlePressMoveUpButton:function(){this.bIsDown=false;var s=this.oConfigListInstance.oTreeInstance.getSelection();if(s!==null){var a=this.oConfigListInstance.oTreeInstance.getAPFTreeNodeContext(s);if(a!==undefined){this._moveUpOrDown(a,this.bIsDown);}}},_handlePressMoveDownButton:function(){this.bIsDown=true;var s=this.oConfigListInstance.oTreeInstance.getSelection();if(s!==null){var a=this.oConfigListInstance.oTreeInstance.getAPFTreeNodeContext(s);if(a!==undefined){this._moveUpOrDown(a,this.bIsDown);}}},_moveUpOrDown:function(s,i){var a=s.nodeObjectType;var b=s.nodeAPFId;var n=s.nodeContext;var c=n.split('/')[2];var o,d,t,T,l;var S=false;var e=n.split('/')[n.split('/').length-1];switch(a){case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.FACETFILTER:o=this.oConfigListInstance.oModel.getData().aConfigDetails[c].configData[0].filters;l=o.length;if(i){if(parseInt(e,10)!==(l-1)){this.oConfigListInstance.configEditor.moveFacetFilterUpOrDown(b,1);d=parseInt(e,10)+1;S=true;}}else{if(parseInt(e,10)!==0){this.oConfigListInstance.configEditor.moveFacetFilterUpOrDown(b,-1);d=parseInt(e,10)-1;S=true;}}break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY:o=this.oConfigListInstance.oModel.getData().aConfigDetails[c].configData[1].categories;l=o.length;if(i){if(parseInt(e,10)!==(l-1)){this.oConfigListInstance.configEditor.moveCategoryUpOrDown(b,1);d=parseInt(e,10)+1;S=true;}}else{if(parseInt(e,10)!==0){this.oConfigListInstance.configEditor.moveCategoryUpOrDown(b,-1);d=parseInt(e,10)-1;S=true;}}break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.NAVIGATIONTARGET:o=this.oConfigListInstance.oModel.getData().aConfigDetails[c].configData[2].navTargets;l=o.length;if(i){if(parseInt(e,10)!==(l-1)){this.oConfigListInstance.configEditor.moveNavigationTargetUpOrDown(b,1);d=parseInt(e,10)+1;S=true;}}else{if(parseInt(e,10)!==0){this.oConfigListInstance.configEditor.moveNavigationTargetUpOrDown(b,-1);d=parseInt(e,10)-1;S=true;}}break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP:var f=n.split('/')[6];var g=this.oConfigListInstance.oModel.getData().aConfigDetails[c].configData[1].categories[f];o=g.steps;l=o.length;if(i){if(parseInt(e,10)!==(l-1)){this.oConfigListInstance.configEditor.moveCategoryStepAssignmentUpOrDown(g.id,b,1);d=parseInt(e,10)+1;S=true;}}else{if(parseInt(e,10)!==0){this.oConfigListInstance.configEditor.moveCategoryStepAssignmentUpOrDown(g.id,b,-1);d=parseInt(e,10)-1;S=true;}}break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.REPRESENTATION:var h=this.oConfigListInstance.oTreeInstance.getSelection();var j=sap.ui.getCore().byId(h.getId());var k=j.getParent();var m=this.oConfigListInstance.oTreeInstance.getAPFTreeNodeContext(k).nodeAPFId;var p=this.oConfigListInstance.configEditor.getStep(m);f=n.split('/')[6];var q=n.split('/')[8];o=this.oConfigListInstance.oModel.getData().aConfigDetails[c].configData[1].categories[f].steps[q].representations;l=o.length;if(i){if(parseInt(e,10)!==(l-1)){p.moveRepresentationUpOrDown(b,1);d=parseInt(e,10)+1;S=true;}}else{if(parseInt(e,10)!==0){p.moveRepresentationUpOrDown(b,-1);d=parseInt(e,10)-1;S=true;}}break;default:break;}if(S){t=o[e];T=o[d];o[d]=t;o[e]=T;this.oConfigListInstance.oModel.updateBindings();this.oConfigListInstance.configEditor.setIsUnsaved();}},_handleAddExistingStepPress:function(){var s=this;var a=this.oConfigListInstance.oTreeInstance.getAPFTreeNodeContext(this.oConfigListInstance.oTreeInstance.getSelection());var c=this.oConfigListInstance.oTreeInstance.getParentNodeContext(a).categoryId;var S=this.oConfigListInstance.configEditor.getStepsNotAssignedToCategory(c);var b;var d=[];S.forEach(function(e){var o={};var f=s.oConfigListInstance.configEditor.getStep(e);b=s.oConfigListInstance.oTextPool.get(f.getTitleId()).TextElementDescription;o.id=e;o.name=b;d.push(o);});var m=new sap.ui.model.json.JSONModel({existingStepData:d});if(!this.addExistingStepDialog){this.addExistingStepDialog=sap.ui.xmlfragment("idExistingStepDialogFragment","sap.apf.modeler.ui.fragment.existingStepDialog",this);this._setExistingStepDialogText();}this.getView().addDependent(this.addExistingStepDialog);this.addExistingStepDialog.setModel(m);this.addExistingStepDialog.open();},_handleExistingStepDialogOK:function(e){var n=sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP;var s=e.getParameters("listItem").selectedItems;var a=s.length;var b=this.oConfigListInstance.oTreeInstance.getAPFTreeNodeContext(this.oConfigListInstance.oTreeInstance.getSelection());var c=this.oConfigListInstance.oTreeInstance.getParentNodeContext(b).categoryId;var E=[];for(var i=0;i<a;i++){var p=e.getParameters("selectedItems").selectedContexts[i].sPath.split('/')[2];var o=e.getSource().getModel().getData().existingStepData[p];var d=this.oConfigListInstance.configEditor.getStep(o.id);this.oConfigListInstance.configEditor.addCategoryStepAssignment(c,o.id);var r=d.getRepresentations();var f=r.length;var R=[];for(var j=0;j<f;j++){var g={};g.id=r[j].getId();g.name=r[j].getRepresentationType();g.icon=this._getRepresentationIcon(g.name);R.push(g);}var S={};S.step=o;S.representations=R;S.noOfReps=f;E.push(S);}if(a!==0){var h={noOfSteps:a,aExistingStepsToBeAdded:E};this.oConfigListInstance.oTreeInstance.addNodeInTree(n,h);}},_getRepresentationIcon:function(r){var i;var R=this.oCoreApi.getRepresentationTypes();for(var a=0;a<R.length;a++){if(r===R[a].id){i=R[a].picture;break;}}return i;},_handleExistingStepDialogSearch:function(e){var v=e.getParameter("value");var f=new sap.ui.model.Filter("name",sap.ui.model.FilterOperator.Contains,v);var b=e.getSource().getBinding("items");b.filter([f]);},_handleExistingStepDialogClose:function(e){if(this.addExistingStepDialog){e.getSource().getBinding("items").filter([]);}}});
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
sap.ui.controller("sap.apf.ui.reuse.controller.analysisPath",{refreshAnalysisPath:function(){this.getView().getCarousel().getController().refreshCarousel();},isOpenPath:false,isNewPath:false,bIsBackNavigation:false,onInit:function(){this.oCoreApi=this.getView().getViewData().oCoreApi;this.oUiApi=this.getView().getViewData().uiApi;if(sap.ui.Device.system.desktop){this.getView().addStyleClass("sapUiSizeCompact");}},refresh:function(n){var v=this.getView().oCarousel;var s=v.stepViews;var i;if(n!==-1){for(i=n;i<s.length;i++){var S={};S=s[i];if(S!==undefined){S.oThumbnailChartLayout.setBusy(true);}}}var a=this.oCoreApi.getSteps().indexOf(this.oCoreApi.getActiveStep());if(a>n){var c=this.oUiApi.getStepContainer();c.vLayout.setBusy(true);}if(!this.oCoreApi.isDirty()&&this.oCoreApi.getSteps().length!==0){this.oCoreApi.setDirtyState(true);this.setPathTitle();}},setPathTitle:function(){var p=this.oCoreApi.getPathName();if(p.length==0){p=this.oCoreApi.getTextNotHtmlEncoded("unsaved");}if(this.oCoreApi.isDirty()){p='*'+p;}this.oUiApi.getAnalysisPath().oSavedPathName.setTitle(p);},callBackForUpdatePath:function(c,s){var n=this.oCoreApi.getSteps().indexOf(c);if(n===0){this.refreshAnalysisPath();}this.updateCurrentStep(c,n,s);},callBackForUpdatePathAndSetLastStepAsActive:function(c,s){var n=this.oCoreApi.getSteps().indexOf(c);if(n===0){var S=this.oCoreApi.getSteps()[this.oCoreApi.getSteps().length-1];this.oCoreApi.setActiveStep(S);this.refreshAnalysisPath();}this.updateCurrentStep(c,n,s);this.oUiApi.getLayoutView().setBusy(false);},updateCurrentStep:function(c,n,s){var i=this.oUiApi.getAnalysisPath().getController().isOpenPath;var a=this.oCoreApi.getSteps().indexOf(this.oCoreApi.getActiveStep());var b=(n===a);this.drawThumbnail(n,s||i);if(b){this.drawMainChart(s);}if(this.oUiApi.getAnalysisPath().getController().isOpenPath&&(this.oCoreApi.getSteps().indexOf(c)===(this.oCoreApi.getSteps().length-1))){this.oUiApi.getLayoutView().setBusy(false);this.oUiApi.getAnalysisPath().getController().isOpenPath=false;}if(this.oUiApi.getAnalysisPath().getController().bIsBackNavigation&&(this.oCoreApi.getSteps().indexOf(c)===(this.oCoreApi.getSteps().length-1))){this.oUiApi.getLayoutView().setBusy(false);this.oUiApi.getAnalysisPath().getController().bIsBackNavigation=false;}this.oUiApi.getAnalysisPath().getController().isNewPath=false;},drawMainChart:function(s){var c=this.oUiApi.getStepContainer();c.getController().drawStepContent(s);},drawThumbnail:function(n,s){var S=this.getView().getCarousel().getStepView(n);S.getController().drawThumbnailContent(s);}});sap.ui.controller("sap.apf.ui.reuse.controller.carousel",{onAfterRendering:function(){if(this.oCoreApi.getSteps().length<1){jQuery(".DnD-separator").hide();}this.oViewData=this.getView().getViewData().oInject;this.oUiApi=this.oViewData.uiApi;jQuery(this.oUiApi.getStepContainer().getDomRef()).hide();if(jQuery("#"+this.initialText.getId()).length===0){jQuery('#'+this.oUiApi.getStepContainer().getId()).parent().append(sap.ui.getCore().getRenderManager().getHTML(this.initialText));}if(this.oUiApi.getAnalysisPath().getController().isOpenPath){jQuery(".initialText").remove();}},onInit:function(){if(sap.ui.Device.system.desktop){this.getView().addStyleClass("sapUiSizeCompact");}var v=this.getView().getViewData().oInject;this.oCoreApi=v.oCoreApi;this.oUiApi=v.uiApi;this.stepGalleryView=sap.ui.view({type:sap.ui.core.mvc.ViewType.JS,viewName:"sap.apf.ui.reuse.view.stepGallery",viewData:v});this.initialText=new sap.m.Label({text:v.oCoreApi.getTextNotHtmlEncoded('initialText')}).addStyleClass('initialText');},showStepGallery:function(){this.stepGalleryView.oController.openHierarchicalSelectDialog();},onBeforeRendering:function(){this.oUiApi.getLayoutView().getController().addMasterFooterContentLeft(this.getView().up);this.oUiApi.getLayoutView().getController().addMasterFooterContentLeft(this.getView().down);},getStepData:function(s){var S=this;var f=s;var o={};o.index=this.oCoreApi.getSteps().indexOf(s);o.title=this.oCoreApi.getTextNotHtmlEncoded(f.title);o.thumbnail=this.getThumbnailDataset(s);return o;},refreshCarousel:function(){if(this.oCoreApi.getSteps().length>this.getView().stepViews.length){this.addStep(this.oCoreApi.getSteps());}},addStep:function(s){this.oViewData=this.getView().getViewData().apfInstance;if(s instanceof Array){if(this.oUiApi.getAnalysisPath().getController().isOpenPath||this.oUiApi.getAnalysisPath().getController().bIsBackNavigation){var i;for(i=0;i<s.length;i++){this.addStep(s[i]);}return;}else{this.addStep(s[this.oCoreApi.getSteps().length-1]);return;}}var a=new sap.ui.view({viewName:"sap.apf.ui.reuse.view.step",type:sap.ui.core.mvc.ViewType.JS,viewData:this.getView().getViewData().oInject});var j=new sap.ui.model.json.JSONModel();a.setModel(j);var b=this.getStepData(s);j.setData(b);this.getView().stepViews.push(a);var c=document.createElement('div');c.innerHTML=sap.ui.getCore().getRenderManager().getHTML(a);var d=this.getView().dndBox;var e=d.eleRefs.blocks.length-1;jQuery(".initialText").remove();jQuery(this.oUiApi.getStepContainer().getDomRef()).show();jQuery(".DnD-separator").show();var f=this.Step?this.Step.categories[0].id:undefined;if(f==="initial"){d.insertBlock({blockElement:c,dragState:false,dropState:false,removable:false},e);}else{d.insertBlock({blockElement:c},e);}if(b.index===this.oCoreApi.getSteps().indexOf(this.oCoreApi.getActiveStep())){a.toggleActiveStep();}a.rerender();this.oUiApi.getLayoutView().setBusy(true);},moveStep:function(d,a){var c=this.oUiApi.getAnalysisPath().getCarousel();if(d===a){return;}c.stepViews=(function(e,f,t){var g=Math.abs(t-f);var h=(t-f)>0?1:-1;var i;while(g--){i=e[f];e[f]=e[f+h];e[f+h]=i;f=f+h;}return e;})(c.stepViews,d,a);this.oUiApi.getAnalysisPath().getController().refresh(Math.min(d,a));var b=this.oCoreApi.getSteps()[d];this.oCoreApi.moveStepToPosition(b,a,this.oUiApi.getAnalysisPath().getController().callBackForUpdatePath.bind(this.oUiApi.getAnalysisPath().getController()));},removeStep:function(r){var c=this.oUiApi.getAnalysisPath().getCarousel();c.stepViews.splice(r,1);var s=c.stepViews.length;var a=this.oCoreApi.getSteps().indexOf(this.oCoreApi.getActiveStep());if(s>0){if(r===a){var n;var b;if(a===0){n=a;b=c.stepViews[n];b.toggleActiveStep();this.oCoreApi.setActiveStep(this.oCoreApi.getSteps()[n+1]);}else{n=a-1;b=c.stepViews[n];b.toggleActiveStep();this.oCoreApi.setActiveStep(this.oCoreApi.getSteps()[n]);}}}else{jQuery(".DnD-separator").hide();jQuery(this.oUiApi.getStepContainer().getDomRef()).hide();this.oUiApi.getStepContainer().getStepToolbar().chartToolbar.removeAllCharts();jQuery('#'+this.oUiApi.getStepContainer().getId()).parent().append(sap.ui.getCore().getRenderManager().getHTML(this.initialText));}var d=this.oCoreApi.getSteps()[r];if(d.getSelectedRepresentation().chart){d.getSelectedRepresentation().chart.removeEventDelegate(this.oUiApi.getStepContainer().getController().fnSetHeightAndWidth);this.oUiApi.getStepContainer().getController().fnSetHeightAndWidth=null;this.oUiApi.getStepContainer().getController().setHeightAndWidth=null;}this.oUiApi.getStepContainer().getController().representationInstance=null;this.oUiApi.getStepContainer().getController().currentSelectedRepresentationId=null;this.oUiApi.getAnalysisPath().getController().refresh(r);this.oCoreApi.removeStep(d,this.oUiApi.getAnalysisPath().getController().callBackForUpdatePath.bind(this.oUiApi.getAnalysisPath().getController()));this.oUiApi.getLayoutView().getController().enableDisableOpenIn();},removeAllSteps:function(){var r=0;var i;var d=this.getView().dndBox;var c=this.oUiApi.getAnalysisPath().getCarousel();var s=c.stepViews.length;function C(){}for(i=1;i<=s;i++){d.removeBlock(r,C);var a=this.oCoreApi.getSteps()[i-1];if(a.getSelectedRepresentation().chart){a.getSelectedRepresentation().chart.removeEventDelegate(this.oUiApi.getStepContainer().getController().fnSetHeightAndWidth);this.oUiApi.getStepContainer().getController().fnSetHeightAndWidth=null;this.oUiApi.getStepContainer().getController().setHeightAndWidth=null;}this.oUiApi.getStepContainer().getController().representationInstance=null;this.oUiApi.getStepContainer().getController().currentSelectedRepresentationId=null;c.stepViews.splice(r,1);}jQuery(".DnD-separator").hide();this.oUiApi.getStepContainer().getStepToolbar().chartToolbar.removeAllCharts();this.oUiApi.getLayoutView().getController().enableDisableOpenIn();},getThumbnailDataset:function(s){var S=this;var t=["leftUpper","rightUpper","leftLower","rightLower"];var T=s.thumbnail;var o=s.getSelectedRepresentationInfo().thumbnail;var r={};t.forEach(function(a){var h=o&&o[a];h=h&&!S.oCoreApi.isInitialTextKey(o[a]);var H=T&&T[a];H=H&&!S.oCoreApi.isInitialTextKey(T[a]);if(h){r[a]=S.oCoreApi.getTextNotHtmlEncoded(o[a]);return;}else if(H){r[a]=S.oCoreApi.getTextNotHtmlEncoded(T[a]);return;}});return r;}});sap.ui.controller("sap.apf.ui.reuse.controller.deleteAnalysisPath",{onInit:function(){this.oCoreApi=this.getView().getViewData().oInject.oCoreApi;this.oUiApi=this.getView().getViewData().oInject.uiApi;this.oSerializationMediator=this.getView().getViewData().oInject.oSerializationMediator;},openPathGallery:function(){var p=new sap.ui.model.json.JSONModel();p.setData(this.getView().getViewData().jsonData);this.oDialog=this.getView().getContent()[0];this.oDialog.getContent()[0].setModel(p);this.oDialog.open();},handleDeleteOfDialog:function(e){var s=this;var p=e.getParameter("listItem").getProperty('title');var l={item:e.getParameter("listItem"),list:s.getView().getContent()[0].getContent()[0],guid:s.getGuidForPath(p,this.getView().getViewData().jsonData.GalleryElements),sPathName:p};s.oUiApi.getAnalysisPath().getToolbar().getController().getConfirmDelDialog(l);},getGuidForPath:function(p,v){var i;for(i=0;i<v.length;i++){var d=v[i];if(d.AnalysisPathName===p){return d.guid;}}},deleteSavedPath:function(p,i){var s=this;var g=i.guid;var a=p;var m;var c=s.oUiApi.getAnalysisPath().oSavedPathName.getTitle();s.oSerializationMediator.deletePath(g,function(r,b,d){if(d===undefined&&(typeof r==="object")){i.list.removeItem(i.item);i.list.rerender();s.oCoreApi.readPaths(function(r,b,d){if(d===undefined&&(typeof r==="object")){var n=r.paths.length;if(n===0){jQuery(".pathText").removeClass("pathTextDontShow");jQuery(".pathText").addClass("pathTextShow");}}else{m=s.oCoreApi.createMessageObject({code:"6005",aParameters:[a]});m.setPrevious(d);s.oCoreApi.putMessage(m);}});}else{m=s.oCoreApi.createMessageObject({code:"6009",aParameters:["delete",a]});m.setPrevious(d);s.oCoreApi.putMessage(m);}});if(c===a){s.oUiApi.getAnalysisPath().getToolbar().getController().resetAnalysisPath();}}});sap.ui.controller("sap.apf.ui.reuse.controller.layout",{onInit:function(){this.oCoreApi=this.getView().getViewData().oCoreApi;this.oUiApi=this.getView().getViewData().uiApi;this.oNavigationHandler=this.getView().getViewData().oNavigationHandler;var a;if(this.oCoreApi.getApplicationConfigProperties()){a=this.oCoreApi.getApplicationConfigProperties().appName;}this.applicationTitle=this.oCoreApi.getTextNotHtmlEncoded(a);this.getView().byId("applicationPage").setTitle(this.applicationTitle);var m=this.oUiApi.getNotificationBar();this.getView().byId("applicationPage").addContent(m);var c=m.initializeHandler;this.oCoreApi.setCallbackForMessageHandling(c.bind(m));this.loadLayout();},loadLayout:function(){if(sap.ui.Device.system.desktop){this.getView().addStyleClass("sapUiSizeCompact");}var c=this.oUiApi.getStepContainer();var a=this.oUiApi.getAnalysisPath();this.getView().byId("applicationPage").setTitle(this.applicationTitle);this.getView().byId("masterFooter").addStyleClass("applicationFooter");this.getView().byId("detailFooter").addStyleClass("applicationFooter");this.getView().byId("stepContainer").addContent(c);this.getView().byId("analysisPath").addContent(a);this.addOpenInButton();},onAfterRendering:function(){var s=this;var a=new sap.m.Button({text:this.oCoreApi.getTextNotHtmlEncoded("showAnalyticalPath"),press:function(){s.getView().byId("applicationView").showMaster();},lite:true,type:"Transparent"});this.getView().byId("applicationView").attachAfterMasterClose(function(){s.getView().byId("detailFooter").removeContentLeft(a);s.addDetailFooterContentLeft(a);});this.getView().byId("applicationView").attachAfterMasterOpen(function(){if(s.getView().byId('detailFooter')){s.getView().byId("detailFooter").removeAllContentLeft();}});if(this.getView().byId("applicationView").isMasterShown()===false){this.addDetailFooterContentLeft(a);}},hideMaster:function(){if(sap.ui.Device.system.phone||sap.ui.Device.system.tablet){this.getView().byId("applicationView").hideMaster();if(sap.ui.Device.system.phone){this.getView().byId("applicationView").toDetail(this.getView().byId("stepContainer").getId());}}},showMaster:function(){this.getView().byId("applicationView").showMaster();},addMasterFooterContentLeft:function(c){this.getView().byId("masterFooter").addContentLeft(c);},addMasterFooterContentRight:function(c){if(this.getView().byId("masterFooter").getContentRight().length===0){this.getView().byId("masterFooter").insertContentRight(c);}else{this.addMasterFooterContent(c);}},addMasterFooterContent:function(c){var s=this;if(this.oActionListPopover===undefined){this.oActionListPopover=new sap.m.Popover({showHeader:false,placement:sap.m.PlacementType.Top});}if(typeof c.getWidth==="function"){c.setWidth("100%");}if(this.footerContentButton===undefined){this.getView().byId("masterFooter").getContentRight()[0].setWidth("71%");this.footerContentButton=new sap.m.Button({text:'...',press:function(e){s.oActionListPopover.openBy(e.getSource());},lite:true,type:"Transparent"});}this.oActionListPopover.addContent(c);this.getView().byId("masterFooter").insertContentRight(this.footerContentButton,1);},addDetailFooterContentLeft:function(c){this.getView().byId("detailFooter").addContentLeft(c);},addFacetFilter:function(f){this.getView().byId("subHeader").addItem(f);},enableDisableOpenIn:function(){var s=this;var n=this.oNavigationHandler.getNavigationTargets();n.then(function(a){if(s.oCoreApi.getActiveStep()){var g=function(){return s.oCoreApi.getActiveStep().getAssignedNavigationTargets().length===0?0:s.oCoreApi.getActiveStep().getAssignedNavigationTargets().length;};var b=s.oCoreApi.getActiveStep().getAssignedNavigationTargets()===undefined?0:g();if(b!==0||a.global.length!==0){s.openInBtn.setEnabled(true);}else if(b===0&&a.global.length===0){s.openInBtn.setEnabled(false);}}else{if(a.global.length===0){s.openInBtn.setEnabled(false);}else{s.openInBtn.setEnabled(true);}}s.openInBtn.rerender();});},addOpenInButton:function(){var s=this;if(this.oNavListPopover===undefined){this.oNavListPopover=new sap.m.Popover({showHeader:false,placement:sap.m.PlacementType.Top});}this.openInBtn=new sap.m.Button({text:this.oCoreApi.getTextNotHtmlEncoded("openIn"),type:"Transparent",enabled:false,press:function(e){s.oNavTargetsView=sap.ui.view({viewName:"sap.apf.ui.reuse.view.navigationTarget",type:sap.ui.core.mvc.ViewType.JS,viewData:{oNavigationHandler:s.oNavigationHandler,oNavListPopover:s.oNavListPopover,oOpenInButtonEventSource:e.getSource(),oUiApi:s.oUiApi}});}});this.getView().byId("detailFooter").insertContentRight(this.openInBtn,1);this.enableDisableOpenIn();},doOkOnNavAnalysisPath:function(){var s=this;var t=this.oUiApi.getAnalysisPath().getToolbar();this.oCoreApi.readPaths(function(r,m,a){var S=true;var p=r.paths;if(m!==undefined){t.maxNumberOfSteps=m.getEntityTypeMetadata().maximumNumberOfSteps;t.maxNumberOfPaths=m.getEntityTypeMetadata().maxOccurs;}if(a===undefined&&(typeof r==="object")){t.getController().getSaveDialog(S,function(){window.history.go(-1);},p);}else{var M=s.oCoreApi.createMessageObject({code:"6005",aParameters:[]});M.setPrevious(a);s.oCoreApi.putMessage(M);}});},handleNavBack:function(){var s=this;if(s.oUiApi.getAnalysisPath().oSavedPathName.getTitle().slice(0,1)==="*"&&s.oCoreApi.getSteps().length!==0){var n=new sap.ui.jsfragment("sap.apf.ui.reuse.fragment.newMessageDialog",this);s.getView().byId("idYesButton").attachPress(function(){n.close();s.doOkOnNavAnalysisPath();});s.getView().byId("idNoButton").attachPress(function(){n.close();window.history.go(-1);});var c=new sap.m.Button(s.createId("idCancelButton"),{text:s.oCoreApi.getTextNotHtmlEncoded("cancel"),press:function(){n.close();}});n.addButton(c);if(sap.ui.Device.system.desktop){n.addStyleClass("sapUiSizeCompact");}n.open();}else{window.history.go(-1);}}});sap.ui.controller("sap.apf.ui.reuse.controller.messageHandler",{onInit:function(){this.oCoreApi=this.getView().getViewData().oCoreApi;this.oUiApi=this.getView().getViewData().uiApi;if(sap.ui.Device.system.desktop){this.getView().addStyleClass("sapUiSizeCompact");}},showMessage:function(m){var t=m.getMessage();var c=m.getCode();var s=m.getSeverity();var d=m.getTimestampAsdateObject();var M=new sap.ui.core.Message({text:t,timestamp:d});var f=sap.apf.core.constants.message.severity.fatal;var w=sap.apf.core.constants.message.severity.warning;var a=sap.apf.core.constants.message.severity.technError;var e=sap.apf.core.constants.message.severity.error;var b=this;switch(s){case f:M.setLevel(sap.ui.core.MessageType.Error);this.oUiApi.getLayoutView().setBusy(false);b.showDialog(t,c);break;case w:M.setLevel(sap.ui.core.MessageType.Warning);break;case e:this.oUiApi.getLayoutView().setBusy(false);M.setLevel(sap.ui.core.MessageType.Error);break;case a:break;default:jQuery.sap.log.error("Error type not defined");break;}if(s===f||s===w||s===e){jQuery.sap.require("sap.m.MessageToast");sap.m.MessageToast.show(M.getText(),{duration:3000,width:"40%",my:"center bottom",at:"center bottom",of:window,offset:"0 -50",collision:"fit fit",onClose:null,autoClose:true,animationTimingFunction:"ease",animationDuration:2000});}},showDialog:function(t){var s=this;var b=this.oCoreApi.getTextNotHtmlEncoded("application-logout");var d=this.oCoreApi.getTextNotHtmlEncoded("fatal-error");var l=this.oCoreApi.getLogMessages();var a=false;var i;for(i=0;i<l.length;i++){if(l[i].search(5021)!==-1){a=true;break;}}if(a===true){t=this.oCoreApi.getTextNotHtmlEncoded("application-reload");b=this.oCoreApi.getTextNotHtmlEncoded("reload-button");d=this.oCoreApi.getTextNotHtmlEncoded("sessionTimeout");}var D;for(i=0;i<l.length;i++){if(D){D=D+"\n"+l[i];}else{D=l[i];}}var I=false;s.fnClose=function(){I=true;if(window.location.hash){window.location.hash="";}};sap.ca.ui.message.showMessageBox({type:sap.ca.ui.message.Type.ERROR,message:t,details:D},s.fnClose);}});
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP SE. All rights reserved
 */
sap.ui.controller("sap.apf.ui.reuse.controller.navigationTarget",{onInit:function(){this.oNavigationHandler=this.getView().getViewData().oNavigationHandler;if(sap.ui.Device.system.desktop){this.getView().addStyleClass("sapUiSizeCompact");}},handleNavigation:function(s){this.oNavigationHandler.navigateToApp(s);}});
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
sap.ui.controller("sap.apf.ui.reuse.controller.pathGallery",{onInit:function(){this.oCoreApi=this.getView().getViewData().oInject.oCoreApi;this.oUiApi=this.getView().getViewData().oInject.uiApi;this.oSerializationMediator=this.getView().getViewData().oInject.oSerializationMediator;if(sap.ui.Device.system.desktop){this.getView().addStyleClass("sapUiSizeCompact");}},openPathGallery:function(){if(this.oDialog){this.oDialog.destroy();}this.oDialog=new sap.ui.jsfragment("sap.apf.ui.reuse.fragment.pathGallery",this);var m=new sap.ui.model.json.JSONModel();var j=this.getPathGalleryData();m.setData(j);this.oDialog.setModel(m);if(sap.ui.Device.system.desktop){this.oDialog.addStyleClass("sapUiSizeCompact");}this.oDialog.open();},getPathGalleryData:function(){var s=this;var a=this.getView().getViewData()?this.getView().getViewData().jsonData:{};var f=function(){var c={"steps":s.oCoreApi.getStepTemplates()};return c;};if(a.GalleryElements.length!==0){var b=a.GalleryElements;var c=f();var i,j,k,d;for(i=0;i<b.length;i++){for(j=0;j<b[i].StructuredAnalysisPath.steps.length;j++){for(k=0;k<c.steps.length;k++){var e=b[i].StructuredAnalysisPath.steps[j].stepId;var g=b[i].StructuredAnalysisPath.steps[j].selectedRepresentationId;if(e===c.steps[k].id){for(d in c.steps[k].getRepresentationInfo()){if(g===c.steps[k].getRepresentationInfo()[d].representationId){a.GalleryElements[i].StructuredAnalysisPath.steps[j].imgSrc=c.steps[k].getRepresentationInfo()[d].picture;a.GalleryElements[i].StructuredAnalysisPath.steps[j].title=s.oCoreApi.getTextNotHtmlEncoded(c.steps[k].title.key);}}}}}}}return a;},openPath:function(p,g,a){var s=this;var m;var c=s.oUiApi.getAnalysisPath().getCarousel();this.oUiApi.getAnalysisPath().getCarousel().oController.removeAllSteps();s.oSerializationMediator.openPath(g,(function(s){return function(r,e,b){if(b===undefined&&(typeof r==="object")){s.oUiApi.getAnalysisPath().getController().isOpenPath=true;s.oUiApi.contextChanged();s.oUiApi.getAnalysisPath().getController().refresh(-1);s.oCoreApi.updatePath(s.oUiApi.getAnalysisPath().getController().callBackForUpdatePath.bind(s.oUiApi.getAnalysisPath().getController()));s.oCoreApi.setDirtyState(false);s.oUiApi.getAnalysisPath().getController().setPathTitle();if(s.oDialog!==undefined){s.oDialog.close();}c.rerender();s.oUiApi.getLayoutView().setBusy(false);}else{m=s.oCoreApi.createMessageObject({code:"6008",aParameters:[p]});m.setPrevious(b);s.oUiApi.getLayoutView().setBusy(false);s.oCoreApi.putMessage(m);}};}(this)),a);}});sap.ui.controller("sap.apf.ui.reuse.controller.step",{setActiveStep:function(i){var o=this.oCoreApi.getActiveStep();var a=this.oCoreApi.getSteps().indexOf(o);if(a===i){return;}var b=this.oCoreApi.getSteps()[i];this.oCoreApi.setActiveStep(b);this.oUiApi.getAnalysisPath().getController().drawMainChart();var s=this.oUiApi.getAnalysisPath().getCarousel().stepViews[i];s.toggleActiveStep();},bindEvts:function(){var s=this;var c=this.oUiApi.getAnalysisPath().getCarousel();var a=this.getView().oVChartTiltleLayout;a.attachBrowserEvent('click',function(){var b=c.stepViews.indexOf(s.getView());s.setActiveStep(b);s.oUiApi.getLayoutView().getController().enableDisableOpenIn();});},onAfterRendering:function(){this.bindEvts();this.oUiApi.getLayoutView().getController().enableDisableOpenIn();},onInit:function(){this.oCoreApi=this.getView().getViewData().oCoreApi;this.oUiApi=this.getView().getViewData().uiApi;this.isSwitched=false;if(sap.ui.Device.system.desktop){this.getView().addStyleClass("sapUiSizeCompact");}},drawThumbnailContent:function(d){var v=this.getView();var i=this.oUiApi.getAnalysisPath().getCarousel().stepViews.indexOf(v);if(this.representationInstance!==undefined){if(this.representationInstance!==this.oCoreApi.getSteps()[i].getSelectedRepresentation().type){this.isSwitched=true;}}this.representationInstance=this.oCoreApi.getSteps()[i].getSelectedRepresentation().type;if(this.oCoreApi.getSteps()[i].getSelectedRepresentation().toggleInstance!==undefined){this.bToggleInstanceExists=true;}if(this.isSwitched===true||d===undefined||d===true||this.bToggleInstanceExists===true){this.isSwitched=false;v.oThumbnailChartLayout.removeAllItems();var s=this.oCoreApi.getSteps()[i];var c;if(s.getSelectedRepresentation().bIsAlternateView){if(s.getSelectedRepresentation().toggleInstance!==undefined){var a=s.getSelectedRepresentation().getData();var m=s.getSelectedRepresentation().getMetaData();s.getSelectedRepresentation().toggleInstance.setData(a,m);c=s.getSelectedRepresentation().toggleInstance.getThumbnailContent();}else{s.getSelectedRepresentation().toggleInstance=this.oUiApi.getStepContainer().getController().createAlternateRepresentation(i);c=s.getSelectedRepresentation().toggleInstance.getThumbnailContent();}}else{c=s.getSelectedRepresentation().getThumbnailContent();}var o=new sap.m.VBox({}).addStyleClass("overlayThumbnailWrapper");v.oThumbnailChartLayout.addItem(c);v.oThumbnailChartLayout.addItem(o);var C=this.oUiApi.getAnalysisPath().getCarousel().getController();var t=C.getThumbnailDataset(s);v.getModel().getData().thumbnail=t;v.getModel().updateBindings();v.oThumbnailChartLayout.rerender();v.oThumbnailChartLayout.setBusy(false);}else{v.oThumbnailChartLayout.setBusy(false);}}});sap.ui.controller("sap.apf.ui.reuse.controller.stepContainer",{onInit:function(){this.oCoreApi=this.getView().getViewData().oCoreApi;this.oUiApi=this.getView().getViewData().uiApi;if(sap.ui.Device.system.desktop){this.getView().addStyleClass("sapUiSizeCompact");}},drawSelectionContainer:function(){this.getView().getStepToolbar().getController().showSelectionCount();},resizeContent:function(){if(this.oCoreApi.getActiveStep()){if(this.oCoreApi.getActiveStep().getSelectedRepresentation().type===sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION){this.drawStepContent();var s=((window.innerHeight-jQuery('.tableWithoutHeaders').offset().top)-20)+"px";jQuery('.tableWithoutHeaders').css({"height":s});}else{this.drawStepContent();}}},onAfterRendering:function(){var s=this;var t;jQuery(window).resize(function(){clearTimeout(t);t=setTimeout(function(){s.resizeContent();},500);});},getCurrentRepresentation:function(){return this.representationInstance;},drawRepresentation:function(){var s=this;var a=this.oCoreApi.getActiveStep();if(a.getSelectedRepresentation().bIsAlternateView===undefined||a.getSelectedRepresentation().bIsAlternateView===false){this.representationInstance=a.getSelectedRepresentation();}else{this.representationInstance=a.getSelectedRepresentation().toggleInstance;var d=a.getSelectedRepresentation().getData(),m=a.getSelectedRepresentation().getMetaData();this.representationInstance.setData(d,m);}var l=a.longTitle&&!this.oCoreApi.isInitialTextKey(a.longTitle.key)?a.longTitle:undefined;var t=l||a.title;var S=this.oCoreApi.getTextNotHtmlEncoded(t);var c=this.representationInstance.getMainContent(S);var b=this.getView().getStepToolbar().chartToolbar.getId();this.setHeightAndWidth=function(){var e;var f;if(jQuery("#"+b).length!==0){e=jQuery("#"+b+" > div:first-child > div:nth-child(2)").offset().top;f=jQuery("#"+b+" > div:first-child > div:nth-child(2)").width();}else{e="0";f=jQuery(window).width();}var g=s.getView().getStepToolbar().chartToolbar.getFullScreen()?(jQuery(window).height()-e):(jQuery(window).height()-e)-jQuery(".applicationFooter").height();var h=f;if(s.oCoreApi.getActiveStep().getSelectedRepresentation().bIsAlternateView||s.oCoreApi.getActiveStep().getSelectedRepresentation().type===sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION){c.getContent()[0].setHeight((g-5)+"px");c.getContent()[0].setWidth(h+"px");}else if(s.oCoreApi.getActiveStep().getSelectedRepresentation().type===sap.apf.ui.utils.CONSTANTS.representationTypes.GEO_MAP){var i=(jQuery(c.getContent())[0]);i.style.height=g+"px";i.style.width=h+"px";c.setContent(i.outerHTML);}else{c.setHeight(g+"px");c.setWidth(h+"px");}};c.getIcon=function(){return;};c.getLabel=function(){return;};this.fnSetHeightAndWidth={onBeforeRendering:function(){s.setHeightAndWidth();}};c.addEventDelegate(this.fnSetHeightAndWidth);this.getView().getStepToolbar().getController().drawRepresentation(c);},createAlternateRepresentation:function(I){var s=this;var a=function(b){var e=b.dimensions;var m=s.oCoreApi.getSteps()[I].getSelectedRepresentation().getMetaData();if(m===undefined){return b;}var i;for(i=0;i<e.length;i++){var S=m.getPropertyMetadata(e[i].fieldName).hasOwnProperty('text');if(S){var n={};n.fieldName=m.getPropertyMetadata(e[i].fieldName).text;b.dimensions.push(n);}}b.isAlternateRepresentation=true;return b;};var A=s.oCoreApi.getSteps()[I];var c=A.getSelectedRepresentation();var p=jQuery.extend(true,{},c.getParameter());delete p.alternateRepresentationTypeId;delete p.alternateRepresentationType;p=a(p);this.newToggleInstance=this.oCoreApi.createRepresentation(c.getParameter().alternateRepresentationType.constructor,p);var d=c.getData();var m=c.getMetaData();if(d!==undefined&&m!==undefined){this.newToggleInstance.setData(d,m);}this.newToggleInstance.adoptSelection(c);return this.newToggleInstance;},isActiveStepChanged:function(){var a;if(this.currentActiveStepIndex===undefined){this.currentActiveStepIndex=this.oCoreApi.getSteps().indexOf(this.oCoreApi.getActiveStep());a=true;}else if(this.currentActiveStepIndex!==this.oCoreApi.getSteps().indexOf(this.oCoreApi.getActiveStep())){this.currentActiveStepIndex=this.oCoreApi.getSteps().indexOf(this.oCoreApi.getActiveStep());a=true;}else{a=false;}return a;},isSelectedRepresentationChanged:function(){var s;if(this.currentSelectedRepresentationId===undefined||this.currentSelectedRepresentationId===null){this.currentSelectedRepresentationId=this.oCoreApi.getActiveStep().getSelectedRepresentationInfo().representationId;s=true;}else if(this.currentSelectedRepresentationId!==this.oCoreApi.getActiveStep().getSelectedRepresentationInfo().representationId){this.currentSelectedRepresentationId=this.oCoreApi.getActiveStep().getSelectedRepresentationInfo().representationId;s=true;}else if(this.getCurrentRepresentation().type!==this.oCoreApi.getActiveStep().getSelectedRepresentation().type){this.currentSelectedRepresentationId=this.oCoreApi.getActiveStep().getSelectedRepresentationInfo().representationId;s=true;}else{s=false;}return s;},drawStepContent:function(d){var n=this.oCoreApi.getSteps().indexOf(this.oCoreApi.getActiveStep());var t=this.oUiApi.getAnalysisPath().getCarousel().getStepView(n).oThumbnailChartLayout.isBusy();var i=this.oUiApi.getAnalysisPath().getController().isOpenPath;var a=this.oUiApi.getAnalysisPath().getController().isNewPath;if(t){this.getView().vLayout.setBusy(true);return;}var A=this.isActiveStepChanged();var s=this.isSelectedRepresentationChanged();var r=(d===undefined||d===true);if(r||A||s||i||a){this.drawRepresentation();}else{if(this.oCoreApi.getSteps().length>=1){this.drawSelectionContainer();}}if(this.getView().vLayout.isBusy()){this.getView().vLayout.removeAllContent();this.getView().vLayout.addContent(this.getView().stepLayout);this.getView().vLayout.setBusy(false);}this.getView().vLayout.setBusy(false);}});sap.ui.controller("sap.apf.ui.reuse.controller.toolbar",{resetAnalysisPath:function(){this.oUiApi.getAnalysisPath().getCarousel().getController().removeAllSteps();this.oCoreApi.resetPath();this.oUiApi.getAnalysisPath().getController().isNewPath=true;this.oStartFilterHandler.resetAll();this.oUiApi.contextChanged(true);this.oUiApi.getAnalysisPath().getController().refreshAnalysisPath();this.oCoreApi.setDirtyState(false);this.oCoreApi.setPathName('');this.oUiApi.getAnalysisPath().getController().setPathTitle();this.oUiApi.getAnalysisPath().getCarousel().rerender();},onInit:function(){this.view=this.getView();if(sap.ui.Device.system.desktop){this.view.addStyleClass("sapUiSizeCompact");}this.oViewData=this.getView().getViewData();this.oCoreApi=this.oViewData.oCoreApi;this.oSerializationMediator=this.oViewData.oSerializationMediator;this.oUiApi=this.oViewData.uiApi;this.oStartFilterHandler=this.oViewData.oStartFilterHandler;this.oPrintHelper=new sap.apf.ui.utils.PrintHelper(this.oViewData);this.bIsPathGalleryWithDelete=false;this.oPathGalleryDialog={};},addCompactStyleClassForDialog:function(d){if(sap.ui.Device.system.desktop){d.addStyleClass("sapUiSizeCompact");}},onSaveAndSaveAsPress:function(s){var a=this;if(a.oCoreApi.getSteps().length!==0){a.oUiApi.getLayoutView().setBusy(true);a.oCoreApi.readPaths(function(r,m,b){var p=r.paths;if(m!==undefined){a.getView().maxNumberOfSteps=m.getEntityTypeMetadata().maximumNumberOfSteps;a.getView().maxNumberOfPaths=m.getEntityTypeMetadata().maxOccurs;}if(b===undefined&&(typeof r==="object")){a.getSaveDialog(s,function(){},p);}else{var M=a.oCoreApi.createMessageObject({code:"6005",aParameters:[]});M.setPrevious(b);a.oCoreApi.putMessage(M);}a.oUiApi.getLayoutView().setBusy(false);});}else{a.getDialogForNoPathAdded();}},openPathGallery:function(I){var j={};var s=this;var i,m;s.oCoreApi.readPaths(function(d,a,b){if(b===undefined&&(typeof d==="object")){var g=d.paths;for(i=0;i<g.length;i++){var n=g[i].StructuredAnalysisPath.steps.length;var u=g[i].LastChangeUTCDateTime;var c=/\d+/g;var t=parseInt(u.match(c)[0],10);var e=((new Date(t)).toString()).split(' ');var f=e[1]+"-"+e[2]+"-"+e[3];g[i].title=g[i].AnalysisPathName;g[i].guid=g[i].AnalysisPath;g[i].StructuredAnalysisPath.noOfSteps=n;g[i].description=f+"  -   ("+s.oCoreApi.getTextNotHtmlEncoded("no-of-steps",[n])+")";g[i].summary=g[i].AnalysisPathName+"- ("+f+") - ("+s.oCoreApi.getTextNotHtmlEncoded("no-of-steps",[n])+")";}j={GalleryElements:g};if(I){s.openSavedPathGallery(j,s,"deleteAnalysisPath");}else{s.openSavedPathGallery(j,s,"pathGallery");}s.oUiApi.getLayoutView().setBusy(false);}else{m=s.oCoreApi.createMessageObject({code:"6005",aParameters:[]});m.setPrevious(b);s.oCoreApi.putMessage(m);s.oUiApi.getLayoutView().setBusy(false);}});},openSavedPathGallery:function(j,c,v){if(!c.oPathGalleryDialog[v]){c.oPathGalleryDialog[v]=new sap.ui.view({type:sap.ui.core.mvc.ViewType.JS,viewName:"sap.apf.ui.reuse.view."+v,viewData:{oInject:c.oViewData}});}c.oPathGalleryDialog[v].getViewData().jsonData=j;var p=c.oPathGalleryDialog[v].getController().oDialog;if((!p)||(p&&!p.isOpen())){c.oPathGalleryDialog[v].getController().openPathGallery();}},doPrint:function(){var p=this.oPrintHelper;p.doPrint();},getSaveDialog:function(s,r,p){var a=this;var h=this.oCoreApi.getTextNotHtmlEncoded("saveName");var b=this.oUiApi.getAnalysisPath().oSavedPathName.getTitle();var m=new sap.ui.model.json.JSONModel();m.setData(p);if(b){if(this.oCoreApi.isDirty()){b=b.split('*')[1];}}this.oInput=new sap.m.Input({type:sap.m.InputType.Text,placeholder:h,showSuggestion:true,suggestionItems:{path:"/",template:new sap.ui.core.Item({text:"{AnalysisPathName}",additionalText:"{AnalysisPath}"}),showValueHelp:true,valueHelpRequest:function(e){var c=function(e){var S=e.getParameter("selectedItem");if(S){input.setValue(S.getTitle());}e.getSource().getBinding("items").filter([]);};}}}).addStyleClass("saveStyle");this.oInput.setModel(m);if(!s){this.oInput.destroySuggestionItems();}this.oInput.attachEvent("click",function(e){jQuery(e.currentTarget).attr('value','');});this.oInput.attachLiveChange(function(d){var v=this.getValue();var c=a.saveDialog;var e=new RegExp("[*]","g");if(v===""){c.getBeginButton().setEnabled(false);}if((v.match(e)!==null)){c.getBeginButton().setEnabled(false);c.setSubHeader(new sap.m.Bar({contentMiddle:new sap.m.Text({text:this.oCoreApi.getTextNotHtmlEncoded('invalid-entry')})}));this.setValueState(sap.ui.core.ValueState.Error);return false;}else{c.getBeginButton().setEnabled(true);c.destroySubHeader();this.setValueState(sap.ui.core.ValueState.None);}if(v.trim()!==""){c.getBeginButton().setEnabled(true);c.destroySubHeader();}else{c.getBeginButton().setEnabled(false);c.setSubHeader(new sap.m.Bar({contentMiddle:new sap.m.Text({text:a.oCoreApi.getTextNotHtmlEncoded('enter-valid-path-name')})}));}});if(b!==(a.oCoreApi.getTextNotHtmlEncoded("unsaved"))){this.oInput.setValue(b);}this.analysisPathName=(a.oInput.getValue()).trim();if(a.saveDialog===undefined||a.saveDialog&&a.saveDialog.bIsDestroyed){a.saveDialog=new sap.m.Dialog({type:sap.m.DialogType.Standard,title:a.oCoreApi.getTextNotHtmlEncoded("save-analysis-path"),beginButton:new sap.m.Button({text:a.oCoreApi.getTextNotHtmlEncoded("ok"),enabled:false,press:function(){a.saveDialog.getBeginButton().setEnabled(false);a.saveDialog.getEndButton().setEnabled(false);var c=(a.oInput.getValue()).trim();a.saveAnalysisPath(c,r,s);a.saveDialog.close();}}),endButton:new sap.m.Button({text:a.oCoreApi.getTextNotHtmlEncoded("cancel"),press:function(){a.saveDialog.close();}}),afterClose:function(){a.oUiApi.getLayoutView().setBusy(false);a.saveDialog.destroy();}});a.saveDialog.addContent(this.oInput);this.addCompactStyleClassForDialog(a.saveDialog);if(this.oInput.getValue()===b){a.saveDialog.getBeginButton().setEnabled(true);}}if(a.oCoreApi.getSteps().length>=1){if(!s&&b===(a.oCoreApi.getTextNotHtmlEncoded("unsaved"))){if(!a.saveDialog||(a.saveDialog&&!a.saveDialog.isOpen()))a.saveDialog.open();}else if(s){if(!a.saveDialog||(a.saveDialog&&!a.saveDialog.isOpen()))a.saveDialog.open();}else{a.saveAnalysisPath(b,r,s);}}},doOkOnNewAnalysisPath:function(){var s=this;this.isOpen=false;s.oCoreApi.readPaths(function(r,m,a){var S=true;var p=r.paths;if(m!==undefined){s.getView().maxNumberOfSteps=m.getEntityTypeMetadata().maximumNumberOfSteps;s.getView().maxNumberOfPaths=m.getEntityTypeMetadata().maxOccurs;}if(a===undefined&&(typeof r==="object")){s.getSaveDialog(S,function(){s.resetAnalysisPath();},p);}else{var M=s.oCoreApi.createMessageObject({code:"6005",aParameters:[]});M.setPrevious(a);s.oCoreApi.putMessage(M);}});},doOkOnOpenAnalysisPath:function(i){var s=this;this.isOpen=true;this.bIsPathGalleryWithDelete=i;s.oCoreApi.readPaths(function(r,m,a){var S=true;var p=r.paths;if(m!==undefined){s.getView().maxNumberOfSteps=m.getEntityTypeMetadata().maximumNumberOfSteps;s.getView().maxNumberOfPaths=m.getEntityTypeMetadata().maxOccurs;}if(a===undefined&&(typeof r==="object")){s.getSaveDialog(S,function(){return;},p);}else{var M=s.oCoreApi.createMessageObject({code:"6005",aParameters:[]});M.setPrevious(a);s.oCoreApi.putMessage(M);}});},getNewAnalysisPathDialog:function(){var s=this;if(this.oCoreApi.isDirty()&&s.oCoreApi.getSteps().length!==0){s.newDialog=new sap.m.Dialog({type:sap.m.DialogType.Standard,title:s.oCoreApi.getTextNotHtmlEncoded("newPath"),content:new sap.m.Text({text:s.oCoreApi.getTextNotHtmlEncoded("analysis-path-not-saved")}).addStyleClass("textStyle"),beginButton:new sap.m.Button({text:s.oCoreApi.getTextNotHtmlEncoded("yes"),press:function(){s.doOkOnNewAnalysisPath();s.newDialog.close();}}),endButton:new sap.m.Button({text:s.oCoreApi.getTextNotHtmlEncoded("no"),press:function(){s.resetAnalysisPath();s.newDialog.close();}}),afterClose:function(){s.oUiApi.getLayoutView().setBusy(false);s.newDialog.destroy();}});this.addCompactStyleClassForDialog(s.newDialog);s.newDialog.open();}else{this.resetAnalysisPath();}},getOpenDialog:function(i){var s=this;s.newOpenDilog=new sap.m.Dialog({type:sap.m.DialogType.Standard,title:s.oCoreApi.getTextNotHtmlEncoded("newPath"),content:new sap.m.Text({text:s.oCoreApi.getTextNotHtmlEncoded("analysis-path-not-saved")}).addStyleClass("textStyle"),beginButton:new sap.m.Button({text:s.oCoreApi.getTextNotHtmlEncoded("yes"),press:function(){s.doOkOnOpenAnalysisPath(s.bIsPathGalleryWithDelete);s.newOpenDilog.close();}}),endButton:new sap.m.Button({text:s.oCoreApi.getTextNotHtmlEncoded("no"),press:function(){s.resetAnalysisPath();s.openPathGallery(s.bIsPathGalleryWithDelete);s.newOpenDilog.close();}}),afterClose:function(){s.oUiApi.getLayoutView().setBusy(false);s.newOpenDilog.destroy();}});this.addCompactStyleClassForDialog(s.newOpenDilog);s.newOpenDilog.open();},getConfirmDelDialog:function(l){var s=this;var p=l.sPathName;s.delConfirmDialog=new sap.m.Dialog({type:sap.m.DialogType.Standard,title:s.oCoreApi.getTextNotHtmlEncoded("delPath"),content:new sap.m.Text({text:s.oCoreApi.getTextNotHtmlEncoded("do-you-want-to-delete-analysis-path",["'"+p+"'"])}).addStyleClass("textStyle"),beginButton:new sap.m.Button({text:s.oCoreApi.getTextNotHtmlEncoded("yes"),press:function(){s.oUiApi.getAnalysisPath().getPathGalleryWithDeleteMode().getController().deleteSavedPath(p,l);s.delConfirmDialog.close();}}),endButton:new sap.m.Button({text:s.oCoreApi.getTextNotHtmlEncoded("no"),press:function(){s.delConfirmDialog.close();}}),afterClose:function(){s.oUiApi.getLayoutView().setBusy(false);s.delConfirmDialog.destroy();}});this.addCompactStyleClassForDialog(s.delConfirmDialog);s.delConfirmDialog.open();},getConfirmDialog:function(p){var s=this;var o=p||{};var a={success:o.success||function(){return;},fail:o.fail||function(){return;},msg:o.msg||""};s.confirmDialog=new sap.m.Dialog({title:s.oCoreApi.getTextNotHtmlEncoded("caution"),type:sap.m.DialogType.Standard,content:new sap.m.Text({text:a.msg}).addStyleClass("textStyle"),beginButton:new sap.m.Button({text:s.oCoreApi.getTextNotHtmlEncoded("yes"),press:function(){s.overWriteAnalysisPath();s.confirmDialog.close();}}),endButton:new sap.m.Button({text:s.oCoreApi.getTextNotHtmlEncoded("no"),press:function(){var S=true;var d=s.oInput.getModel().getData();s.getSaveDialog(S,function(){return;},d);s.confirmDialog.close();}}),afterClose:function(){s.oUiApi.getLayoutView().setBusy(false);s.confirmDialog.destroy();}});this.addCompactStyleClassForDialog(s.confirmDialog);s.confirmDialog.open();},getErrorMessageDialog:function(m){var s=this;s.errorMsgDialog=new sap.m.Dialog({title:s.oCoreApi.getTextNotHtmlEncoded("error"),type:sap.m.DialogType.Message,content:new sap.m.Text({text:m}).addStyleClass("textStyle"),beginButton:new sap.m.Button({text:s.oCoreApi.getTextNotHtmlEncoded("ok"),press:function(){var f=function(){return;};if(f){setTimeout(function(){s.callbackforSave(f);},200);}s.errorMsgDialog.close();}}),afterClose:function(){s.oUiApi.getLayoutView().setBusy(false);s.errorMsgDialog.destroy();}});this.addCompactStyleClassForDialog(s.errorMsgDialog);s.errorMsgDialog.open();},callbackforSave:function(f){f();},onOpenPathGallery:function(i){if(this.oCoreApi.isDirty()&&this.oCoreApi.getSteps().length!==0){this.getOpenDialog(i);}else{this.openPathGallery(i);}this.isOpen=false;},saveAnalysisPath:function(a,f,s){var b=this;this.saveCallback=f;this.analysisPathName=a;this.aData=b.oInput.getModel().getData();var c=false;this.guid="";var d=b.oCoreApi.getSteps();if(this.aData.length>this.getView().maxNumberOfPaths){this.getErrorMessageDialog(b.oCoreApi.getTextNotHtmlEncoded("no-of-paths-exceeded"));return false;}else if(d.length>this.getView().maxNumberOfSteps){this.getErrorMessageDialog(b.oCoreApi.getTextNotHtmlEncoded("no-of-steps-exceeded"));return false;}var i;for(i=0;i<this.aData.length;i++){var e=this.aData[i].AnalysisPathName;if(this.analysisPathName===e){c=true;this.guid=this.aData[i].AnalysisPath;break;}}if(!c){b.oSerializationMediator.savePath(b.analysisPathName,function(r,m,g){if(g===undefined&&(typeof r==="object")){b.oCoreApi.setDirtyState(false);b.oUiApi.getAnalysisPath().getController().setPathTitle();var h=b.oCoreApi.getTextNotHtmlEncoded("path-saved-successfully",["'"+b.analysisPathName+"'"]);b.getSuccessToast(b.analysisPathName,h);if(typeof b.saveCallback==="function"){b.saveCallback();}}else{var M=b.oCoreApi.createMessageObject({code:"6006",aParameters:[b.analysisPathName]});M.setPrevious(g);b.oCoreApi.putMessage(M);}});}else{var p;if(this.oCoreApi.isDirty()&&this.oCoreApi.getSteps().length!==0){p=b.oUiApi.getAnalysisPath().oSavedPathName.getTitle().slice(1,b.oUiApi.getAnalysisPath().oSavedPathName.getTitle().length);}else{p=b.oUiApi.getAnalysisPath().oSavedPathName.getTitle();}if(!s&&p===b.analysisPathName){b.overWriteAnalysisPath();}else{this.getConfirmDialog({msg:b.oCoreApi.getTextNotHtmlEncoded("path-exists",["'"+b.analysisPathName+"'"])});}c=false;}},getSuccessToast:function(p,m){var s=this;var a=m;sap.m.MessageToast.show(a,{width:"20em"});if(s.isOpen&&s.bIsPathGalleryWithDelete){s.openPathGallery(s.bIsPathGalleryWithDelete);}else if(s.isOpen){s.openPathGallery();}},overWriteAnalysisPath:function(){var s=this;var p=this.analysisPathName;var g=this.guid;s.oSerializationMediator.savePath(g,p,function(r,m,a){if(a===undefined&&(typeof r==="object")){s.oCoreApi.setDirtyState(false);s.oUiApi.getAnalysisPath().getController().setPathTitle();var b=s.oCoreApi.getTextNotHtmlEncoded("path-updated-successfully",["'"+p+"'"]);if(s.saveDialog&&s.saveDialog.isOpen()){s.saveDialog.close();}s.getSuccessToast(p,b);if(typeof s.saveCallback==="function"){s.saveCallback();}}else{var M=s.oCoreApi.createMessageObject({code:"6007",aParameters:[p]});M.setPrevious(a);s.oCoreApi.putMessage(M);}});},getDialogForNoPathAdded:function(){var s=this;var m=s.oCoreApi.getTextNotHtmlEncoded("noStepInPath");s.noPathAddedDialog=new sap.m.Dialog({title:s.oCoreApi.getTextNotHtmlEncoded("alert"),type:sap.m.DialogType.Message,contentWidth:jQuery(window).height()*0.2+"px",contentHeight:jQuery(window).height()*0.2+"px",content:new sap.m.Text({text:m}).addStyleClass("textStyle"),beginButton:new sap.m.Button({text:s.oCoreApi.getTextNotHtmlEncoded("ok"),press:function(){s.noPathAddedDialog.close();}}),afterClose:function(){s.oUiApi.getLayoutView().setBusy(false);s.noPathAddedDialog.destroy();}});this.addCompactStyleClassForDialog(s.noPathAddedDialog);s.noPathAddedDialog.open();}});
/*!
 * SAP APF Analysis Path Framework
 *
 * (c) Copyright 2012-2014 SAP SE. All rights reserved
 */
sap.ui.jsfragment("sap.apf.ui.reuse.fragment.newMessageDialog",{createContent:function(c){var y=new sap.m.Button(c.createId("idYesButton"),{text:c.oCoreApi.getTextNotHtmlEncoded("yes")});var n=new sap.m.Button(c.createId("idNoButton"),{text:c.oCoreApi.getTextNotHtmlEncoded("no")});var a=new sap.m.Dialog(c.createId("idNewDialog"),{type:sap.m.DialogType.Standard,title:c.oCoreApi.getTextNotHtmlEncoded("newPath"),content:new sap.m.Text({text:c.oCoreApi.getTextNotHtmlEncoded("analysis-path-not-saved")}).addStyleClass("textStyle"),buttons:[y,n],afterClose:function(){a.destroy();}});return a;}});
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
sap.ui.jsfragment("sap.apf.ui.reuse.fragment.pathGallery",{createContent:function(c){var s=this;this.contentWidth=jQuery(window).height()*0.6+"px";this.contentHeight=jQuery(window).height()*0.6+"px";this.oCoreApi=c.oCoreApi;this.oUiApi=c.oUiApi;var p=new sap.m.List().bindItems({path:'/GalleryElements',template:new sap.m.StandardListItem({title:'{title}',tooltip:'{title}',description:'{description}',type:"Navigation",press:function(e){var B=e.getSource().getBindingContext();d.setBindingContext(B);d.setTitle(e.getSource().getTitle());s.oPathGalleryNavContainer.to(s.oPathGalleryNavContainer.getPages()[1]);}})});var a=new sap.m.List().bindItems({path:'StructuredAnalysisPath/steps',template:new sap.m.StandardListItem({title:'{title}',tooltip:'{title}',type:"Active",icon:'{imgSrc}',press:function(e){s.oUiApi.getLayoutView().setBusy(true);var f=e.getSource().getBindingContext().sPath.split('/');var g=this.getModel().getData().GalleryElements[f[2]].AnalysisPathName;var h=this.getModel().getData().GalleryElements[f[2]].AnalysisPath;var i=f[5];c.openPath(g,h,i);s.oUiApi.getLayoutView().setBusy(false);}})});var o=function(e){var l=[];var S=e.getSource().getValue();var L=s.pathGalleryHierarchicalDialog.getContent()[0].getCurrentPage().getContent()[0];if(S&&S.length>0){var f=new sap.ui.model.Filter("title",sap.ui.model.FilterOperator.Contains,S);l.push(f);}var g=L.getBinding("items");g.filter(l);};var b=new sap.m.Page({title:s.oCoreApi.getTextNotHtmlEncoded("select-analysis-path"),subHeader:new sap.m.Bar({contentLeft:[new sap.m.SearchField({enableFilterMode:true,liveChange:o})]}),content:p});var d=new sap.m.Page({subHeader:new sap.m.Bar({contentLeft:[new sap.m.SearchField({enableFilterMode:true,liveChange:o})]}),content:a,showNavButton:true,navButtonPress:function(){s.oPathGalleryNavContainer.back();}});this.oPathGalleryNavContainer=new sap.m.NavContainer({pages:[b,d]});this.oPathGalleryNavContainer.setModel(c.getView().getModel());s.pathGalleryHierarchicalDialog=new sap.m.Dialog({contentWidth:s.contentWidth,contentHeight:s.contentHeight,showHeader:false,content:[this.oPathGalleryNavContainer],endButton:new sap.m.Button({text:s.oCoreApi.getTextNotHtmlEncoded("cancel"),press:function(){s.pathGalleryHierarchicalDialog.close();}}),afterClose:function(){s.pathGalleryHierarchicalDialog.destroy();}});return this.pathGalleryHierarchicalDialog;}});
/*!
 * SAP APF Analysis Path Framework
 *
 * (c) Copyright 2012-2014 SAP SE. All rights reserved
 */
sap.ui.jsfragment("sap.apf.ui.reuse.fragment.selectionDisplay",{createContent:function(c){this.oController=c;this.contentWidth=jQuery(window).height()*0.6+"px";this.contentHeight=jQuery(window).height()*0.6+"px";var s=this;this.oCoreApi=c.oCoreApi;this.oUiApi=c.oUiApi;var a=new sap.m.Button({text:s.oCoreApi.getTextNotHtmlEncoded("close"),press:function(){s.selectionDisplayDialog.close();s.selectionDisplayDialog.destroy();}});var A=this.oCoreApi.getActiveStep();var b=A.getSelectedRepresentation();var d=typeof b.getSelections==="function"?b.getSelections():undefined;var e=b.getMetaData().getPropertyMetadata(b.getParameter().requiredFilters[0]).label;var m=new sap.ui.model.json.JSONModel();if(d!==undefined){var D={selectionData:d};var f=new sap.m.List({items:{path:"/selectionData",template:new sap.m.StandardListItem({title:"{text}"})}});m.setSizeLimit(b.getSelections().length);m.setData(D);f.setModel(m);s.selectionDisplayDialog=new sap.m.Dialog({title:this.oCoreApi.getTextNotHtmlEncoded("selected-required-filter",[e])+" ("+d.length+")",contentWidth:s.contentWidth,contentHeight:s.contentHeight,buttons:[a],content:[f],afterClose:function(){s.selectionDisplayDialog.destroy();}});return s.selectionDisplayDialog;}}});
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
sap.ui.jsfragment("sap.apf.ui.reuse.fragment.stepGallery",{createContent:function(c){var s=this;this.contentWidth=jQuery(window).height()*0.6+"px";this.contentHeight=jQuery(window).height()*0.6+"px";this.oCoreApi=c.oCoreApi;this.oUiApi=c.oUiApi;var a=new sap.m.List().bindItems({path:'/GalleryElements',template:new sap.m.StandardListItem({title:'{title}',tooltip:'{title}',type:"Navigation",press:function(E){var B=E.getSource().getBindingContext();g.setBindingContext(B);g.setTitle(E.getSource().getTitle());s.oStepGalleryNavContainer.to(s.oStepGalleryNavContainer.getPages()[1]);}})});var b=new sap.m.List().bindItems({path:'stepTemplates',template:new sap.m.StandardListItem({title:'{title}',tooltip:'{title}',type:"Navigation",press:function(E){var B=E.getSource().getBindingContext();h.setBindingContext(B);h.setTitle(E.getSource().getTitle());s.oStepGalleryNavContainer.to(s.oStepGalleryNavContainer.getPages()[2]);if(sap.ui.Device.system.desktop){var r=s.oStepGalleryNavContainer.getPages()[2].getContent()[0].getItems();r.forEach(function(i){i.addStyleClass("repItem");});}}})});var o=function(E){s.oUiApi.getLayoutView().setBusy(true);var i=E.getSource().getBindingContext().sPath.split('/');var j=i[2];var k=i[4];var r=i[6];var l=c.getStepDetails(j,k);c.onStepPress(l.id,l.representationtypes[r].representationId);};var A=sap.ui.Device.system.desktop?false:true;var d=new sap.m.List().bindItems({path:'representationtypes',template:new sap.m.StandardListItem({title:'{title}',adaptTitleSize:A,icon:'{picture}',tooltip:'{title}',type:"Active",press:o}).bindProperty("description","sortDescription",function(v){if(v===undefined||v===null){return null;}return s.oCoreApi.getTextNotHtmlEncoded("sortBy")+": "+v;})});var e=function(E){var l=[];var S=E.getSource().getValue();var L=s.oStepGalleryHierarchicalDialog.getContent()[0].getCurrentPage().getContent()[0];if(S&&S.length>0){var F=new sap.ui.model.Filter("title",sap.ui.model.FilterOperator.Contains,S);l.push(F);}var i=L.getBinding("items");i.filter(l);};var f=new sap.m.Page({title:s.oCoreApi.getTextNotHtmlEncoded("category"),subHeader:new sap.m.Bar({contentLeft:[new sap.m.SearchField({enableFilterMode:true,liveChange:e})]}),content:a});var g=new sap.m.Page({subHeader:new sap.m.Bar({contentLeft:[new sap.m.SearchField({enableFilterMode:true,liveChange:e})]}),content:b,showNavButton:true,navButtonPress:function(){s.oStepGalleryNavContainer.back();}});var h=new sap.m.Page({subHeader:new sap.m.Bar({contentLeft:[new sap.m.SearchField({enableFilterMode:true,liveChange:e})]}),content:d,showNavButton:true,navButtonPress:function(){s.oStepGalleryNavContainer.back();}});this.oStepGalleryNavContainer=new sap.m.NavContainer({pages:[f,g,h]});this.oStepGalleryNavContainer.setModel(c.getView().getModel());this.oStepGalleryHierarchicalDialog=new sap.m.Dialog({contentWidth:s.contentWidth,contentHeight:s.contentHeight,showHeader:false,content:[this.oStepGalleryNavContainer],endButton:new sap.m.Button({text:s.oCoreApi.getTextNotHtmlEncoded("cancel"),press:function(){s.oStepGalleryHierarchicalDialog.close();s.oStepGalleryHierarchicalDialog.destroy();}}),afterClose:function(){s.oStepGalleryHierarchicalDialog.destroy();}});return this.oStepGalleryHierarchicalDialog;}});sap.ui.jsview("sap.apf.ui.reuse.view.analysisPath",{getCarousel:function(){return this.oCarousel;},getToolbar:function(){return this.oActionListItem;},getPathGallery:function(){return this.pathGallery;},getPathGalleryWithDeleteMode:function(){return this.deleteAnalysisPath;},getControllerName:function(){return"sap.apf.ui.reuse.controller.analysisPath";},createContent:function(c){var s=this;this.oController=c;this.oActionListPopover=new sap.m.Popover({showHeader:false,placement:sap.m.PlacementType.Bottom,contentWidth:"150px"});var v=this.getViewData();s.oCoreApi=v.oCoreApi;s.oUiApi=v.uiApi;this.oActionListItem=sap.ui.view({viewName:"sap.apf.ui.reuse.view.toolbar",type:sap.ui.core.mvc.ViewType.JS,viewData:v}).addStyleClass("toolbarView");this.oActionListPopover.addContent(this.oActionListItem);this.oSavedPathName=new sap.m.ObjectHeader({title:this.oCoreApi.getTextNotHtmlEncoded("unsaved"),showTitleSelector:true,condensed:true,titleSelectorPress:function(e){s.oActionListPopover.openBy(e.getParameter("domRef"));}}).addStyleClass("sapApfObjectHeader");this.oCarousel=new sap.ui.view({type:sap.ui.core.mvc.ViewType.JS,viewName:"sap.apf.ui.reuse.view.carousel",viewData:{analysisPath:s,oInject:v}});this.pathGallery=new sap.ui.view({type:sap.ui.core.mvc.ViewType.JS,viewName:"sap.apf.ui.reuse.view.pathGallery",viewData:{oInject:v}});this.deleteAnalysisPath=new sap.ui.view({type:sap.ui.core.mvc.ViewType.JS,viewName:"sap.apf.ui.reuse.view.deleteAnalysisPath",viewData:{oInject:v}});this.oAnalysisPath=new sap.ui.layout.VerticalLayout({content:[s.oContentTitle,s.oSavedPathName,s.oCarousel],width:'100%'});return this.oAnalysisPath;}});sap.ui.jsview("sap.apf.ui.reuse.view.carousel",{getStepGallery:function(){var s=this.oController.stepGalleryView;return s;},getChartToolbar:function(){return this.oController.oStepToolbar;},carouselContent:function(c){jQuery.sap.require('sap.apf.ui.controls.draggableCarousel.DraggableCarousel');var s=this;this.oController=c;this.stepViews=[];var v=this.getViewData().oInject;s.oCoreApi=v.oCoreApi;s.oUiApi=v.uiApi;var a=new sap.ui.core.Icon({src:"sap-icon://arrow-bottom"}).addStyleClass('downArrow');var b=document.createElement('div');b.innerHTML=sap.ui.getCore().getRenderManager().getHTML(a);var r=new sap.ui.core.Icon({src:"sap-icon://sys-cancel-2",size:"20px",tooltip:this.oCoreApi.getTextNotHtmlEncoded("deleteStep")}).addStyleClass('removeIcon');var d=document.createElement('div');d.innerHTML=sap.ui.getCore().getRenderManager().getHTML(r);var h=jQuery(window).height()-sap.apf.ui.utils.CONSTANTS.carousel.SCROLLCONTAINER+"px";var w="320px";window.onresize=function(){var h=jQuery(window).height()-sap.apf.ui.utils.CONSTANTS.carousel.SCROLLCONTAINER+"px";jQuery('.DnD-container').css({"height":jQuery(window).height()-sap.apf.ui.utils.CONSTANTS.carousel.DNDBOX+"px"});jQuery(".scrollContainerEle").css("height",h);};this.dndBox=new sap.apf.ui.controls.draggableCarousel.DraggableCarousel({containerHeight:jQuery(window).height()-sap.apf.ui.utils.CONSTANTS.carousel.DNDBOX+"px",containerWidth:w,blockHeight:sap.apf.ui.utils.CONSTANTS.thumbnailDimensions.STEP_HEIGHT,blockWidth:sap.apf.ui.utils.CONSTANTS.thumbnailDimensions.STEP_WIDTH,blockMargin:sap.apf.ui.utils.CONSTANTS.thumbnailDimensions.STEP_MARGIN,separatorHeight:sap.apf.ui.utils.CONSTANTS.thumbnailDimensions.SEPARATOR_HEIGHT,removeIconHeight:sap.apf.ui.utils.CONSTANTS.thumbnailDimensions.REMOVE_ICON_HEIGHT,separator:b,removeIcon:d,onBeforeDrag:function(f){return;},onAfterDrop:c.moveStep.bind(c),onAfterRemove:c.removeStep.bind(c),onAfterSelect:function(i){if(jQuery(this).attr("drag-state")==="true"){s.getStepView(i).oController.setActiveStep(i);}else{c.showStepGallery();}}});var u=this.createId("dnd-Holder");this.oHtml=new sap.ui.core.HTML({content:"<div id = '"+jQuery.sap.encodeHTML(u)+"'></div>",sanitizeContent:true,afterRendering:function(){s.dndBox.placeAt(u);jQuery(s.dndBox.eleRefs.blocks[0]).height("80px");}});var e;this.addButton=new sap.m.Button({text:s.oCoreApi.getTextNotHtmlEncoded("add-step"),width:"100%",icon:"sap-icon://add",press:function(f){c.showStepGallery();}});e=document.createElement('div');e.setAttribute('class','addStepBtnHolder');jQuery(e).html(jQuery(sap.ui.getCore().getRenderManager().getHTML(this.addButton)).attr("tabindex",-1));this.dndBox.addBlock({blockElement:e,dragState:false,dropState:false,removable:false});this.up=new sap.m.Button({icon:"sap-icon://arrow-top",tooltip:this.oCoreApi.getTextNotHtmlEncoded("moveStepUp"),press:function(){var f=s.oCoreApi.getSteps().indexOf(s.oCoreApi.getActiveStep());if(f!==0){var n=f-1;var g=s.oUiApi.getAnalysisPath().getCarousel().dndBox.swapBlocks(f,n);if(g){s.oUiApi.getAnalysisPath().getCarousel().getController().moveStep(f,n);}}}});this.down=new sap.m.Button({icon:"sap-icon://arrow-bottom",tooltip:this.oCoreApi.getTextNotHtmlEncoded("moveStepDown"),press:function(){var f=s.oCoreApi.getSteps().indexOf(s.oCoreApi.getActiveStep());if(f!==(s.oCoreApi.getSteps().length-1)){var n=f+1;var g=s.oUiApi.getAnalysisPath().getCarousel().dndBox.swapBlocks(f,n);if(g){s.oUiApi.getAnalysisPath().getCarousel().getController().moveStep(f,n);}}}});this.oCarousel=new sap.m.ScrollContainer({content:this.oHtml,height:h,horizontal:false,vertical:true}).addStyleClass("scrollContainerEle");return this.oCarousel;},getControllerName:function(){return"sap.apf.ui.reuse.controller.carousel";},createContent:function(c){var a=this.carouselContent(c);return a;},getStepView:function(s){return this.stepViews[s];}});sap.ui.jsview("sap.apf.ui.reuse.view.deleteAnalysisPath",{getControllerName:function(){return"sap.apf.ui.reuse.controller.deleteAnalysisPath";},createContent:function(c){var a=jQuery(window).height()*0.6+"px";var b=jQuery(window).height()*0.6+"px";var l=jQuery(window).height()*0.55+"px";var d=jQuery(window).height()*0.55+"px";this.oCoreApi=this.getViewData().oInject.oCoreApi;this.oUiApi=this.getViewData().oInject.uiApi;var s=this;var e=new sap.m.List({width:l,height:d,mode:sap.m.ListMode.Delete,items:{path:"/GalleryElements",template:new sap.m.StandardListItem({title:"{AnalysisPathName}",description:"{description}",tooltip:"{AnalysisPathName}"})},"delete":c.handleDeleteOfDialog.bind(c)});var D=new sap.m.Dialog({title:s.oCoreApi.getTextNotHtmlEncoded("select-analysis-path"),contentWidth:a,contentHeight:b,content:e,leftButton:new sap.m.Button({text:s.oCoreApi.getTextNotHtmlEncoded("close"),press:function(){D.close();s.oUiApi.getLayoutView().setBusy(false);}})});if(sap.ui.Device.system.desktop){this.addStyleClass("sapUiSizeCompact");D.addStyleClass("sapUiSizeCompact");}return D;}});(function(){'use strict';sap.ui.jsview("sap.apf.ui.reuse.view.facetFilter",{getControllerName:function(){return"sap.apf.ui.reuse.controller.facetFilter";},createContent:function(c){var f;var C=this.getViewData().oCoreApi;var a=this.getViewData().aConfiguredFilters;var F=[];a.forEach(function(b){f=new sap.m.FacetFilterList({title:C.getTextNotHtmlEncoded(b.getLabel()),multiSelect:b.isMultiSelection(),key:b.getPropertyName(),growing:false,listClose:c.onListClose.bind(c)});F.push(f);});F.forEach(function(b){b.bindItems("/",new sap.m.FacetFilterItem({key:'{key}',text:'{text}',selected:'{selected}'}));var m=new sap.ui.model.json.JSONModel([]);b.setModel(m);});var o=new sap.m.FacetFilter(c.createId("idAPFFacetFilter"),{type:"Simple",showReset:true,showPopoverOKButton:true,lists:F,reset:c.onResetPress.bind(c)});if(sap.ui.Device.system.desktop){o.addStyleClass("facetfilter");}return o;}});}());sap.ui.jsview("sap.apf.ui.reuse.view.messageHandler",{initializeHandler:function(m){this.getController().showMessage(m);},getControllerName:function(){return"sap.apf.ui.reuse.controller.messageHandler";},createContent:function(c){jQuery.sap.require("sap.m.MessageToast");jQuery.sap.require("sap.ca.ui.message.message");}});
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP SE. All rights reserved
 */
sap.ui.jsview("sap.apf.ui.reuse.view.navigationTarget",{getControllerName:function(){return"sap.apf.ui.reuse.controller.navigationTarget";},createContent:function(c){var v=this.getViewData();this.oNavListPopover=v.oNavListPopover;this.oOpenInButtonEventSource=v.oOpenInButtonEventSource;this.oNavigationHandler=v.oNavigationHandler;this.oUiApi=v.oUiApi;this.oController=c;this.oUiApi.getLayoutView().byId("applicationPage").setBusy(true);var n=this.oNavigationHandler.getNavigationTargets();n.then(this._prepareActionListModel.bind(this),function(){this.oUiApi.getLayoutView().byId("applicationPage").setBusy(false);});},_prepareActionListModel:function(n){var a=[];var b=[];n.global.forEach(function(t){a.push(t);});n.stepSpecific.forEach(function(t){b.push(t);});this.oNavListPopover.removeAllContent();var g,s;var c=this;if(b.length!==0){var m=new sap.ui.model.json.JSONModel();var d={navTargets:b};s=new sap.m.List({items:{path:"/navTargets",template:new sap.m.StandardListItem({title:"{text}",type:sap.m.ListType.Navigation,press:function(E){var f=E.getSource().getBindingContext().getObject().id;c.oController.handleNavigation(f);}})}});m.setData(d);s.setModel(m);var e=new sap.ui.core.HTML({content:'<hr class="lineSeparator">',sanitizeContent:true});this.oNavListPopover.addContent(s);this.oNavListPopover.addContent(e);}if(a.length!==0){var M=new sap.ui.model.json.JSONModel();var D={navTargets:a};g=new sap.m.List({items:{path:"/navTargets",template:new sap.m.StandardListItem({title:"{text}",type:sap.m.ListType.Navigation,press:function(E){var f=E.getSource().getBindingContext().getObject().id;c.oController.handleNavigation(f);}})}});M.setData(D);g.setModel(M);this.oNavListPopover.addContent(g);}this.oUiApi.getLayoutView().byId("applicationPage").setBusy(false);this.oNavListPopover.openBy(this.oOpenInButtonEventSource);}});
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
sap.ui.jsview("sap.apf.ui.reuse.view.pathGallery",{getControllerName:function(){return"sap.apf.ui.reuse.controller.pathGallery";},createContent:function(c){this.viewData=this.getViewData();}});sap.ui.jsview("sap.apf.ui.reuse.view.step",{getControllerName:function(){return"sap.apf.ui.reuse.controller.step";},stepContent:function(){this.oCoreApi=this.getViewData().oCoreApi;this.oUiApi=this.getViewData().uiApi;this.oTopLayout=new sap.m.FlexBox({items:[new sap.m.Text({text:'{/thumbnail/leftUpper}',tooltip:'{/thumbnail/leftUpper}',wrapping:true,maxLines:2,textAlign:sap.ui.core.TextAlign.Left}).addStyleClass("thumbanilText"),new sap.m.Text({text:'{/thumbnail/rightUpper}',tooltip:'{/thumbnail/rightUpper}',wrapping:true,maxLines:2,textAlign:sap.ui.core.TextAlign.Right}).addStyleClass("thumbanilText")],alignItems:sap.m.FlexAlignItems.Start,justifyContent:sap.m.FlexJustifyContent.SpaceBetween}).addStyleClass("topLayout");this.oThumbnailChartLayout=new sap.m.VBox({height:"80px"}).addStyleClass('ChartArea');this.oThumbnailChartLayout.setBusy(true);this.oBottomLayout=new sap.m.FlexBox({items:[new sap.m.Text({text:'{/thumbnail/leftLower}',tooltip:'{/thumbnail/leftLower}',wrapping:true,maxLines:2,textAlign:sap.ui.core.TextAlign.Left}).addStyleClass("thumbanilText"),new sap.m.Text({text:'{/thumbnail/rightLower}',tooltip:'{/thumbnail/rightLower}',wrapping:true,maxLines:2,textAlign:sap.ui.core.TextAlign.Right}).addStyleClass("thumbanilText")],alignItems:sap.m.FlexAlignItems.Start,justifyContent:sap.m.FlexJustifyContent.SpaceBetween}).addStyleClass("bottomLayout");this.oThumbnailVLayout=new sap.m.VBox({items:[this.oTopLayout,this.oThumbnailChartLayout,this.oBottomLayout],height:"130px"}).addStyleClass('stepThumbnail');this.oStepTitle=new sap.m.Text({text:'{/title}',textAlign:sap.ui.core.TextAlign.Center,wrapping:true,width:"200px"});this.oVChartLayout=new sap.m.VBox({items:[this.oThumbnailVLayout,this.oStepTitle],width:"200px"}).addStyleClass("sapApfStepLayout");var h=new sap.m.VBox({items:[]}).addStyleClass("block-overlay-container");var s=this;h.addEventDelegate({onAfterRendering:function(){var a=new sap.m.Button({text:s.oCoreApi.getTextNotHtmlEncoded("showAnalyticalPath"),press:function(){s.oUiApi.getLayoutView().byId("detailFooter").removeAllContentLeft();s.oUiApi.getLayoutView().byId("applicationView").backToTopMaster();},lite:true,type:"Transparent"});jQuery(h.getDomRef()).on("mouseenter",function(){jQuery(this).addClass("sapThemeBarBG");jQuery(this).css({"opacity":"0.3"});});jQuery(h.getDomRef()).on("touchstart",function(e){var t=e.timeStamp,b=$(this).data('lastTouch')||t,d=t-b,f=e.originalEvent.touches.length;$(this).data('lastTouch',t);if(!d||d>500||f>1){return;}e.preventDefault();$(this).trigger('click').trigger('click');jQuery(this).addClass("sapThemeBarBG");jQuery(this).css({"opacity":"0"});});jQuery(h.getDomRef()).on("mouseleave",function(){jQuery(this).removeClass("sapThemeBarBG");jQuery(this).css({"opacity":"1"});});jQuery(h.getDomRef()).on("touchend touchmove",function(){jQuery(this).removeClass("sapThemeBarBG");jQuery(this).css({"opacity":"0"});});if(sap.ui.Device.system.phone){jQuery(h.getDomRef()).on("tap",function(){s.oUiApi.getLayoutView().getController().hideMaster();s.oUiApi.getLayoutView().byId("detailFooter").removeContentLeft(a);s.oUiApi.getLayoutView().getController().addDetailFooterContentLeft(a);s.oUiApi.getStepContainer().getController().drawStepContent();});}}});this.oVChartTiltleLayout=new sap.m.VBox({items:[h,this.oVChartLayout],width:"200px"}).addStyleClass("sapUiTableCCnt");return this.oVChartTiltleLayout;},createContent:function(c){var s=this.stepContent();return s;},toggleActiveStep:function(){var a=this.oUiApi.getAnalysisPath().getCarousel().stepViews;for(var i in a){if(a[i].oThumbnailVLayout.hasStyleClass('sapThemeBaseBG-asBackgroundColor')){a[i].oThumbnailVLayout.removeStyleClass('sapThemeBaseBG-asBackgroundColor');a[i].oStepTitle.removeStyleClass('activeStepTitle');a[i].oThumbnailVLayout.removeStyleClass('activeStepThumbnail');break;}}this.oThumbnailVLayout.addStyleClass('sapThemeBaseBG-asBackgroundColor');this.oStepTitle.addStyleClass('activeStepTitle');this.oThumbnailVLayout.addStyleClass('activeStepThumbnail');}});sap.ui.jsview("sap.apf.ui.reuse.view.stepContainer",{getStepToolbar:function(){return this.oStepToolbar;},getControllerName:function(){return"sap.apf.ui.reuse.controller.stepContainer";},createContent:function(c){var v=this.getViewData();this.oStepToolbar=sap.ui.view({viewName:"sap.apf.ui.reuse.view.stepToolbar",type:sap.ui.core.mvc.ViewType.JS,viewData:v});this.stepLayout=new sap.ui.layout.VerticalLayout({content:[this.oStepToolbar],width:"100%"});this.vLayout=new sap.ui.layout.VerticalLayout({content:this.stepLayout,width:"100%"});this.vLayout.setBusy(true);return this.vLayout;}});sap.ui.jsview("sap.apf.ui.reuse.view.stepGallery",{getControllerName:function(){return"sap.apf.ui.reuse.controller.stepGallery";},createContent:function(c){this.oController=c;}});sap.ui.jsview("sap.apf.ui.reuse.view.stepToolbar",{getControllerName:function(){return"sap.apf.ui.reuse.controller.stepToolbar";},createContent:function(c){this.chartToolbar=new sap.ca.ui.charts.ChartToolBar({showLegend:true,showFullScreen:true});return this.chartToolbar;}});sap.ui.jsview("sap.apf.ui.reuse.view.toolbar",{getControllerName:function(){return"sap.apf.ui.reuse.controller.toolbar";},createContent:function(c){this.maxNumberOfSteps=32;this.maxNumberOfPaths=255;var s=this;var v=this.getViewData();s.oCoreApi=v.oCoreApi;s.oUiApi=v.uiApi;var t=new sap.m.StandardListItem({icon:'sap-icon://add-product',type:sap.m.ListType.Active,title:s.oCoreApi.getTextNotHtmlEncoded("new"),press:function(){s.getParent().close();s.oUiApi.getLayoutView().setBusy(true);c.getNewAnalysisPathDialog();s.oUiApi.getLayoutView().setBusy(false);}});var T=new sap.m.StandardListItem({icon:"sap-icon://open-folder",type:sap.m.ListType.Active,title:s.oCoreApi.getTextNotHtmlEncoded("open"),press:function(){c.bIsPathGalleryWithDelete=false;s.oUiApi.getLayoutView().setBusy(true);s.getParent().close();c.onOpenPathGallery(c.bIsPathGalleryWithDelete);}});var o=new sap.m.StandardListItem({icon:"sap-icon://save",type:sap.m.ListType.Active,title:s.oCoreApi.getTextNotHtmlEncoded("save"),press:function(){s.getParent().close();c.onSaveAndSaveAsPress(false);}});var a=new sap.m.StandardListItem({icon:"sap-icon://save",type:sap.m.ListType.Active,title:s.oCoreApi.getTextNotHtmlEncoded("saveAs"),press:function(){s.getParent().close();c.onSaveAndSaveAsPress(true);}});var b=new sap.m.StandardListItem({icon:"sap-icon://delete",type:sap.m.ListType.Active,title:s.oCoreApi.getTextNotHtmlEncoded("delete"),press:function(){c.bIsPathGalleryWithDelete=true;s.getParent().close();s.oUiApi.getLayoutView().setBusy(true);c.onOpenPathGallery(c.bIsPathGalleryWithDelete);}});var d=new sap.m.StandardListItem({icon:"sap-icon://print",type:sap.m.ListType.Active,title:s.oCoreApi.getTextNotHtmlEncoded("print"),press:function(){s.getParent().close();c.doPrint();}});this.oActionListItem=new sap.m.List({items:[t,T,o,a,b,d]});return this.oActionListItem;}});jQuery.sap.declare('sap.apf.library-all');jQuery.sap.declare('sap.apf.modeler.ui.controller.titleBreadCrumb.controller');jQuery.sap.declare('sap.apf.modeler.ui.controller.toolbar.controller');jQuery.sap.declare('sap.apf.ui.reuse.controller.analysisPath.controller');jQuery.sap.declare('sap.apf.ui.reuse.controller.carousel.controller');jQuery.sap.declare('sap.apf.ui.reuse.controller.deleteAnalysisPath.controller');jQuery.sap.declare('sap.apf.ui.reuse.controller.layout.controller');jQuery.sap.declare('sap.apf.ui.reuse.controller.messageHandler.controller');jQuery.sap.declare('sap.apf.ui.reuse.controller.navigationTarget.controller');jQuery.sap.declare('sap.apf.ui.reuse.controller.pathGallery.controller');jQuery.sap.declare('sap.apf.ui.reuse.controller.step.controller');jQuery.sap.declare('sap.apf.ui.reuse.controller.stepContainer.controller');jQuery.sap.declare('sap.apf.ui.reuse.controller.toolbar.controller');jQuery.sap.declare('sap.apf.ui.reuse.fragment.newMessageDialog.fragment');jQuery.sap.declare('sap.apf.ui.reuse.fragment.pathGallery.fragment');jQuery.sap.declare('sap.apf.ui.reuse.fragment.selectionDisplay.fragment');jQuery.sap.declare('sap.apf.ui.reuse.fragment.stepGallery.fragment');jQuery.sap.declare('sap.apf.ui.reuse.view.analysisPath.view');jQuery.sap.declare('sap.apf.ui.reuse.view.carousel.view');jQuery.sap.declare('sap.apf.ui.reuse.view.deleteAnalysisPath.view');jQuery.sap.declare('sap.apf.ui.reuse.view.facetFilter.view');jQuery.sap.declare('sap.apf.ui.reuse.view.messageHandler.view');jQuery.sap.declare('sap.apf.ui.reuse.view.navigationTarget.view');jQuery.sap.declare('sap.apf.ui.reuse.view.pathGallery.view');jQuery.sap.declare('sap.apf.ui.reuse.view.step.view');jQuery.sap.declare('sap.apf.ui.reuse.view.stepContainer.view');jQuery.sap.declare('sap.apf.ui.reuse.view.stepGallery.view');jQuery.sap.declare('sap.apf.ui.reuse.view.stepToolbar.view');jQuery.sap.declare('sap.apf.ui.reuse.view.toolbar.view');if(!jQuery.sap.isDeclared('sap.apf.core.constants')){jQuery.sap.declare('sap.apf.core.constants');jQuery.sap.require('sap.ui.model.FilterOperator');(function(){'use strict';sap.apf.core.constants=sap.apf.core.constants||{};sap.apf.core.constants.filterMethodTypes={selectionAsArray:'saa',filter:'f'};sap.apf.core.constants.FilterOperators=sap.ui.model.FilterOperator;sap.apf.core.constants.BooleFilterOperators={AND:"and",OR:"or",NOT:"not"};sap.apf.core.constants.aSelectOpt=[sap.apf.core.constants.FilterOperators.EQ,sap.apf.core.constants.FilterOperators.NE,sap.apf.core.constants.FilterOperators.GT,sap.apf.core.constants.FilterOperators.LT,sap.apf.core.constants.FilterOperators.GE,sap.apf.core.constants.FilterOperators.LE,sap.apf.core.constants.FilterOperators.BT,sap.apf.core.constants.FilterOperators.StartsWith,sap.apf.core.constants.FilterOperators.Contains,sap.apf.core.constants.FilterOperators.EndsWith];sap.apf.core.constants.resourceLocation={applicationMessageDefinitionLocation:"applicationMessageDefinitionLocation",applicationMessageTextBundle:"applicationMessageTextBundle",apfUiTextBundle:"apfUiTextBundle",applicationUiTextBundle:"applicationUiTextBundle",analyticalConfigurationLocation:"analyticalConfigurationLocation"};sap.apf.core.constants.message={};sap.apf.core.constants.message.severity={fatal:"fatal",warning:"warning",error:"error",technError:"technError"};sap.apf.core.constants.message.code={suppressFurtherException:"APFapf1972",errorCheck:"5100",errorCheckWarning:"5101",errorCheckConfiguration:"5102",errorCheckConfigurationWarning:"5103",errorExitTriggered:"5300",errorUnknown:"9000",errorLoadConfig:"9001",errorStopProcessing:"9002",errorStartUp:"9003",errorLoadingRessource:"9007",wrongRessourcePath:"9008",missingAnalyticalConfig:"9009",errorLoadingAnalyticalConfig:"9010",errorInAnalyticalConfig:"9011",warningAnalyticalConfig:"9012"};sap.apf.core.constants.eventTypes={contextChanged:"contextChanged",printTriggered:"printTriggered",format:"format"};sap.apf.core.constants.configurationObjectTypes={facetFilter:"facetFilter"};sap.apf.core.constants.entitySets={application:'ApplicationQueryResults',configuration:'AnalyticalConfigurationQueryResults',texts:'TextElementQueryResults',logicalSystem:"SAPClientQuery",analysisPath:"AnalysisPathQueryResults",smartBusiness:"EVALUATIONS"};sap.apf.core.constants.modelerPersistenceServiceRoot="/sap/hba/r/apf/core/odata/modeler/AnalyticalConfiguration.xsodata";sap.apf.core.constants.developmentLanguage="";sap.apf.core.constants.textKeyForInitialText="00000000000000000000000000000000";sap.apf.core.constants.representationMetadata={kind:{XAXIS:"xAxis",XAXIS2:"xAxis2",YAXIS:"yAxis",YAXIS2:"yAxis2",BUBBLEWIDTH:"bubbleWidth",BUBBLEHEIGHT:"bubbleHeight",SECTORSIZE:"sectorSize",LEGEND:"legend",SECTORCOLOR:"sectorColor",REGIONCOLOR:"regionColor",REGIONSHAPE:"regionShape",COLUMN:"column"},labelDisplayOptions:{KEY:"key",TEXT:"text",KEY_AND_TEXT:"keyAndText"}};sap.apf.core.constants.vizFrame={feedItemTypes:{CATEGORYAXIS:"categoryAxis",CATEGORYAXIS2:"categoryAxis2",COLOR:"color",VALUEAXIS:"valueAxis",VALUEAXIS2:"valueAxis2",BUBBLEHEIGHT:"bubbleHeight",BUBBLEWIDTH:"bubbleWidth",SIZE:"size",SHAPE:"shape",TIMEAXIS:"timeAxis"}};sap.apf.core.constants.applicationConfiguration={applicationConfigPath:"config/applicationConfiguration.json"};}());};if(!jQuery.sap.isDeclared('sap.apf.core.entityTypeMetadata')){jQuery.sap.declare("sap.apf.core.entityTypeMetadata");(function(){'use strict';sap.apf.core.EntityTypeMetadata=function(m,e,M){this.type='entityTypeMetadata';this.getPropertyMetadata=function(p){var r;r=M.getPropertyMetadata(e,p);if(!r){r={dataType:{}};}return r;};this.getEntityTypeMetadata=function(){return M.getEntityTypeAnnotations(e);};function c(){m.check(e&&typeof e==='string','sap.apf.core.entityTypeMetadata: incorrect value for parameter sEntityType');m.check(M&&M.type&&M.type==="metadata",'sap.apf.core.entityTypeMetadata: incorrect value for parameter oMetadata');}c();};}());};if(!jQuery.sap.isDeclared('sap.apf.core.messageDefinition')){jQuery.sap.declare("sap.apf.core.messageDefinition");sap.apf.core.messageDefinition=[{code:"3001",severity:"technError",text:"Text is not available for the following key: {0}"},{code:"5001",severity:"technError",text:"Request {3} to server failed with http status code {0}, http error message {1}, and server response {2}."},{code:"5002",severity:"error",description:"Error in OData request; update of analysis step {0} failed.",key:"5002"},{code:"5004",severity:"fatal",description:"Request with ID {0} does not exist in the analytical content configuration.",key:"5004"},{code:"5005",severity:"technError",text:"Required property {1} is missing in the filter of the OData request for entity type {0}."},{code:"5006",severity:"technError",text:"Inconsistency in data model; non-filterable property {1} is set as required filter for entity type {0}."},{code:"5015",severity:"fatal",description:"Service for request {0} is not defined in the analytical content configuration.",key:"5015"},{code:"5016",severity:"technError",text:"Mandatory parameter key property {0} is missing in filter."},{code:"5018",severity:"fatal",description:"Metadata request {0} failed.",key:"5018"},{code:"5019",severity:"technError",text:"System query option $orderby for property {1} removed from OData request for entity type {0}."},{code:"5020",severity:"fatal",description:"Analytical content configuration is not available.",key:"5020"},{code:"5021",severity:"error",description:"Error during server request; session timeout occurred.",key:"5021"},{code:"5022",severity:"fatal",description:"Analytical configuration with ID {0} is not available.",key:"5022"},{code:"5023",severity:"fatal",description:"Texts could not be loaded for Analytical configuration with ID {0}.",key:"5023"},{code:"5024",severity:"fatal",description:"URL Parameter for Analytical Configuration ID must contain the ID of the application and the ID of the Analytical configuration seperated by a dot.",key:"5024"},{code:"5025",severity:"fatal",description:"Value for SAP client has not been provided at startup of the application.",key:"5025"},{code:"5026",severity:"fatal",description:"Logical system cannot be determined for SAP client {0}. ",key:"5026"},{code:"5027",severity:"technError",text:"Inconsistent parameters; analysis path cannot be saved. Path ID: {0}, path name: {1}, callback function {2}"},{code:"5028",severity:"technError",text:"Binding with ID {0} contains a representation without ID."},{code:"5029",severity:"technError",text:"Binding with ID {0} contains a duplicated representation ID."},{code:"5030",severity:"technError",text:"Constructor property of representation type ID {0} does not contain a module path to a valid function."},{code:"5031",severity:"technError",text:"Argument for method 'setApplicationMessageCallback' is not a function."},{code:"5032",severity:"technError",text:"System query option {1} unknown in request for entity type {0}."},{code:"5033",severity:"technError",text:"Unsupported type {0} in configuration object provided."},{code:"5034",severity:"technError",text:"Facet filter configuration attribute 'property' missing."},{code:"5035",severity:"technError",text:"Function module path contained in property preselectionFuntion of facet filter ID {0} does not contain a valid function."},{code:"5036",severity:"technError",text:"Start paramater step id {0} is not existing."},{code:"5037",severity:"technError",text:"Start paramater representation id {0} is not existing."},{code:"5038",severity:"technError",text:"Environment for sap.ushell.Container is not existing."},{code:"5039",severity:"technError",text:"Error while pushing content to the ushell container"},{code:"5040",severity:"technError",text:"Error while fetching content from the ushell container"},{code:"5100",severity:"fatal",description:"Unexpected internal error: {0}. Contact SAP.",key:"5100"},{code:"5101",severity:"technError",text:"Unexpected internal error: {0}. Contact SAP."},{code:"5102",severity:"fatal",description:"Wrong definition in analytical content configuration: {0}",key:"5102"},{code:"5103",severity:"technError",text:"Wrong definition in analytical content configuration: {0}"},{code:"5104",severity:"technError",text:"Wrong filter mapping definition in analytical content configuration"},{code:"5200",severity:"technError",text:"Server error during processing of path: {0} {1}"},{code:"5201",severity:"error",description:"Unknown server error.",key:"5201"},{code:"5202",severity:"technError",text:"Persistence service call returned '405 - Method not allowed'."},{code:"5203",severity:"technError",text:"Bad request; data is structured incorrectly."},{code:"5204",severity:"error",description:"Error during server request; maximum number of analysis steps exceeded.",key:"5204"},{code:"5205",severity:"error",description:"Error during server request; maximum number of analysis paths exceeded.",key:"5205"},{code:"5206",severity:"error",description:"Access forbidden; insufficient privileges",key:"5206"},{code:"5207",severity:"error",description:"Inserted value too large; probably maximum length of analysis path name exceeded",key:"5207"},{code:"5208",severity:"error",description:"Error during path persistence; request to server can not be proceed due to invalid ID.",key:"5208"},{code:"5210",severity:"error",description:"Error during opening of analysis path; see log.",key:"5210"},{code:"5211",severity:"error",description:"Server response contains undefined path objects.",key:"5211"},{code:"5212",severity:"error",description:"Metadata file of application {0} could not be accessed.",key:"5212"},{code:"5213",severity:"error",description:"Text file of application {0} could not be accessed.",key:"5213"},{code:"5300",severity:"fatal",description:"You must log out of the application due to a critical error.",key:"5300"},{code:"5301",severity:"warning",description:"Add or update path filter API method called with unsupported filter; See sap.apf.api documentation",key:"5301"},{code:"6001",severity:"fatal",description:"Missing {0} in the configuration; contact your administrator.",key:"6001"},{code:"6000",severity:"error",description:"Data is not available for the {0} step.",key:"6000"},{code:"6002",severity:"error",description:"Missing {0} for {1} in the configuration; contact your administrator.",key:"6002"},{code:"6003",severity:"error",description:"Missing {0} in the configuration; contact your administrator.",key:"6001"},{code:"6004",severity:"technError",text:"Metadata not available for step {0}."},{code:"6005",severity:"error",description:"Server request failed. Unable to read paths.",key:"6005"},{code:"6006",severity:"error",description:"Server request failed. Unable to save path {0}.",key:"6006"},{code:"6007",severity:"error",description:"Server request failed. Unable to update path {0}.",key:"6007"},{code:"6008",severity:"error",description:"Server request failed. Unable to open path {0}.",key:"6008"},{code:"6009",severity:"error",description:"Server request failed. Unable to delete path {0}.",key:"6009"},{code:"6010",severity:"technError",description:"Data is not available for filter {0}",key:"6010"},{code:"6011",severity:"fatal",description:"Smart Business service failed.Please try later",key:"6011"},{code:"7000",severity:"error",description:"Missing {0} in the configuration; contact your administrator.",key:"6001"}];};if(!jQuery.sap.isDeclared('sap.apf.core.messageObject')){jQuery.sap.declare("sap.apf.core.messageObject");(function(){'use strict';sap.apf.core.MessageObject=function(c){var C=c.code;var p=c.aParameters||[];var o=c.oCallingObject;var m="";var s="";var P;var d=new Date();var r=c.rawText;this.type="messageObject";this.getCode=function(){return C;};this.setCode=function(a){C=a;};this.hasRawText=function(){return(r!==undefined);};this.getRawText=function(){return r;};this.getMessage=function(){return m;};this.setMessage=function(t){m=t;};this.setSeverity=function(a){s=a;};this.getSeverity=function(){return s;};this.setPrevious=function(a){P=a;};this.getPrevious=function(){return P;};this.getCallingObject=function(){return o;};this.getParameters=function(){return p;};this.getStack=function(){if(this.stack){return this.stack;}return"";};this.getTimestamp=function(){return d.getTime();};this.getTimestampAsdateObject=function(){return d;};this.getJQueryVersion=function(){return jQuery().jquery;};this.getSapUi5Version=function(){return sap.ui.version;};};sap.apf.core.MessageObject.prototype=new Error();sap.apf.core.MessageObject.prototype.constructor=sap.apf.core.MessageObject;}());};if(!jQuery.sap.isDeclared('sap.apf.core.metadataFactory')){jQuery.sap.declare("sap.apf.core.metadataFactory");(function(){'use strict';sap.apf.core.MetadataFactory=function(i){this.type="metadataFactory";var t=this;var m=i.messageHandler;var c=i.configurationFactory;var H=i.hashtable;var M=i.metadata;var E=i.entityTypeMetadata;var a=i.metadataFacade;delete i.metadata;delete i.entityTypeMetadata;delete i.metadataFacade;delete i.metadataProperty;delete i.configurationFactory;var o=new H(m);this.getMetadata=function(A){var b;if(o.hasItem(A)===false){b=new M(i,A);if(!b.failed){o.setItem(A,{metadata:b});}else{return undefined;}}return o.getItem(A).metadata;};this.getEntityTypeMetadata=function(A,e){var b;var d=this.getMetadata(A);b=o.getItem(A).entityTypes;if(!b){b=new H(m);o.getItem(A).entityTypes=b;}if(!b.getItem(e)){b.setItem(e,new E(m,e,d));}return b.getItem(e);};this.getMetadataFacade=function(A){return new a({messageHandler:m,metadataProperty:sap.apf.core.MetadataProperty,metadataFactory:t},A);};this.getServiceDocuments=function(){return c.getServiceDocuments();};this.getEntitySets=function(s){var b=this.getMetadata(s);return b.getEntitySets();};};}());};if(!jQuery.sap.isDeclared('sap.apf.core.metadataProperty')){jQuery.sap.declare("sap.apf.core.metadataProperty");(function(){'use strict';sap.apf.core.MetadataProperty=function(a){var t=this;var k=false;var p=false;this.isKey=function(){return k;};this.isParameterEntitySetKeyProperty=function(){return p;};this.getAttribute=function(n){if(typeof this[n]!=="function"){return this[n];}};function b(n,v){switch(n){case"isKey":if(v===true){k=true;}break;case"isParameterEntitySetKeyProperty":if(v===true){p=true;}break;default:if(typeof t[n]!=="function"){t[n]=v;}}return t;}function i(){for(var n in a){switch(n){case"dataType":for(var d in a.dataType){b(d,a.dataType[d]);}break;default:b(n,a[n]);}}}i();};}());};if(!jQuery.sap.isDeclared('sap.apf.core.path')){jQuery.sap.declare("sap.apf.core.path");(function(){'use strict';sap.apf.core.Path=function(I){this.type="path";var m=I.messageHandler;var c=I.coreApi;var t=this;var s=[];var a=[];var n=0;this.destroy=function(){a=[];s.forEach(function(f){f.destroy();});s=[];t=undefined;};this.getSteps=function(){return jQuery.extend(true,[],s);};this.addStep=function(S,f){s.push(S);t.update(f);};this.makeStepActive=function(S){var f=this.stepIsInPath(S);m.check(f,"An unknown step can't be an active step.",sap.apf.core.constants.message.code.errorCheckWarning);if(f){if(this.stepIsActive(S)===false){a.push(S);}}};this.makeStepInactive=function(S){var f=this.stepIsActive(S);m.check(f,"Only an active step can be removed from the active steps.",sap.apf.core.constants.message.code.errorCheckWarning);if(f){var i=jQuery.inArray(S,a);a.splice(i,1);}};this.stepIsActive=function(S){var i=jQuery.inArray(S,a);if(i>=0){return true;}return false;};this.stepIsInPath=function(S){var i=jQuery.inArray(S,s);if(i>=0){return true;}return false;};this.getActiveSteps=function(){return jQuery.extend(true,[],a);};this.getCumulativeFilterUpToActiveStep=function(){var f=jQuery.Deferred();c.getCumulativeFilter().done(function(C){var o=C.copy();var i,l=s.length;for(i=0;i<l;i++){o=o.addAnd(s[i].getFilter());if(t.stepIsActive(s[i])){f.resolve(o);return;}}f.resolve(o);});return f.promise();};this.moveStepToPosition=function(S,f,h){var i=jQuery.inArray(S,s);var j=f;m.check(typeof f==="number"&&f>=0&&f<s.length,"Path: moveStepToPosition invalid argument for nPosition");m.check(i>=0&&i<s.length,"Path: moveStepToPosition invalid step");if(i===f){return;}s.splice(i,1);s.splice(j,0,S);this.update(h);};this.removeStep=function(S,f){var h=this.stepIsInPath(S);var i=this.stepIsActive(S);var j=jQuery.inArray(S,s);m.check(h,"Path: remove step - invalid step");s.splice(j,1);if(i){this.makeStepInactive(S);}this.update(f);S.destroy();};this.update=function(S){if(!s[0]){return;}var f;var C=s[0];c.getCumulativeFilter().done(function(o){var h=o.copy();n++;f=n;C.update(h,i);function i(r,k){var l=jQuery.inArray(C,s);var M;if(f===n){if(r instanceof Error){var p=l+1;M=m.createMessageObject({code:"5002",aParameters:[p],callingObject:C});M.setPrevious(r);m.putMessage(M);C.setData({data:[],metadata:undefined},h);S(C,true);l++;C=s[l];while(C){C.setData({data:[],metadata:undefined},h);S(C,true);l++;C=s[l];}return;}if(!k){C.setData(r,h);}S(C,!k);if(f!==n){return;}C.determineFilter(h.copy(),j);}}function j(F){var k=jQuery.inArray(C,s);h.addAnd(F);C=s[k+1];if(C){C.update(h,i);}else{h=undefined;}}});};this.serialize=function(){return{path:{steps:b(),indicesOfActiveSteps:g()}};};this.deserialize=function(S){d(S.path.steps,this);e(S.path.indicesOfActiveSteps,this);};function g(){var f=[];for(var i=0;i<s.length;i++){for(var j=0;j<a.length;j++){if(s[i]===a[j]){f.push(i);}}}return f;}function b(){var S=[];for(var i=0;i<s.length;i++){S.push(s[i].serialize());}return S;}function d(S,C){var f=C.update;C.update=function(){};var i=0;for(i=0;i<S.length;i++){c.createStep(S[i].stepId);}for(i=0;i<s.length;i++){s[i].deserialize(S[i]);}C.update=f;}function e(f,C){for(var i=0;i<f.length;i++){var h=f[i];C.makeStepActive(s[h]);}}};}());};if(!jQuery.sap.isDeclared('sap.apf.core.persistence')){jQuery.sap.declare("sap.apf.core.persistence");(function(){'use strict';sap.apf.core.Persistence=function(I){var t=this;var l;this.createPath=function(n,C,E){var R;var S=I.coreApi.serializePath();if(E){S.filterIdHandler=E.filterIdHandler;S.startFilterHandler=E.startFilterHandler;}var o=d(S);h().then(function(l){R={data:{AnalysisPath:"",AnalysisPathName:n,LogicalSystem:l,ApplicationConfigurationURL:I.coreApi.getApplicationConfigurationURL(),SerializedAnalysisPath:JSON.stringify(S),StructuredAnalysisPath:JSON.stringify(o)},method:"POST"};if(I.coreApi.getStartParameterFacade().getAnalyticalConfigurationId()){R.data.AnalyticalConfiguration=I.coreApi.getStartParameterFacade().getAnalyticalConfigurationId().configurationId;}s(R,i.bind(t));},function(m){C({oResponse:undefined,status:"failed"},{},m);});function i(j,k,m){if(m){C({oResponse:j,status:"failed"},k,m);}else{I.messageHandler.check(j&&j.data&&j.statusCode===201&&j.statusText==="Created","Persistence create Path - proper response");C({AnalysisPath:j.data.AnalysisPath,status:"successful"},k,m);}}};this.readPaths=function(C){var R={method:"GET"};s(R,j.bind(this));function j(o,E,m){if(!m&&o&&o.data&&o.data.results){for(var i in o.data.results){o.data.results[i].StructuredAnalysisPath=JSON.parse(o.data.results[i].StructuredAnalysisPath);}}else if(!m||o.statusCode!==200||o.statusText!=="OK"){m=I.messageHandler.createMessageObject({code:'5211'});}if(m){C({oResponse:o,status:"failed"},E,m);}else{C({paths:o.data.results,status:"successful"},E,m);}}};this.deletePath=function(A,C){var R={method:"DELETE"};s(R,i.bind(this),A);function i(o,E,m){if((o.statusCode!==204||o.statusText!=="No Content")&&(!m)){m=I.messageHandler.createMessageObject({code:5201});m.setPrevious(I.messageHandler.createMessageObject({code:5200,aParameters:[o.statusCode,o.statusText]}));}if(m){C({oResponse:o,status:"failed"},E,m);}else{C({status:"successful"},E,m);}}};this.modifyPath=function(A,n,C,E){var S=I.coreApi.serializePath();if(E){S.filterIdHandler=E.filterIdHandler;S.startFilterHandler=E.startFilterHandler;}var o=d(S);h().then(function(l){var i={data:{AnalysisPathName:n,LogicalSystem:l,ApplicationConfigurationURL:I.coreApi.getApplicationConfigurationURL(),SerializedAnalysisPath:JSON.stringify(S),StructuredAnalysisPath:JSON.stringify(o)},method:"PUT"};s(i,R.bind(this),A);},function(m){C({oResponse:undefined,status:"failed"},{},m);});function R(i,j,m){if((i.statusCode!==204||i.statusText!=="No Content")&&(!m)){m=I.messageHandler.createMessageObject({code:5201});m.setPrevious(I.messageHandler.createMessageObject({code:5200,aParameters:[i.statusCode,i.statusText]}));}if(m){C({oResponse:i,status:"failed"},j,m);}else{C({AnalysisPath:A,status:"successful"},j,m);}}};this.openPath=function(A,C,n){var R={method:"GET"};s(R,i.bind(this),A);function i(o,E,m){var M;if(!m&&o&&o.statusCode===200&&o.data&&o.data.SerializedAnalysisPath){o.data.SerializedAnalysisPath=JSON.parse(o.data.SerializedAnalysisPath);m=a(o.data,n);}if(m){M=I.messageHandler.createMessageObject({code:'5210'});M.setPrevious(m);I.messageHandler.putMessage(M);}if(M){C({oResponse:o,status:"failed"},E,M);}else{C({path:o.data,status:"successful"},E,M);}}};function s(R,L,A){var S=function(D,o){L(o,e(),undefined);};var E=function(o){var m;if(o.messageObject&&o.messageObject.getCode&&o.messageObject.getCode()===5021){L(o,e(),o.messageObject);return;}var i=c(o.response.body);if(i!==undefined){m=I.messageHandler.createMessageObject({code:i});}if(o.response.body.match("274")){m=I.messageHandler.createMessageObject({code:'5207'});}if(o.response.statusCode===400){m=I.messageHandler.createMessageObject({code:'5203'});}if(o.response.statusCode===403){m=I.messageHandler.createMessageObject({code:'5206'});}if(o.response.statusCode===405){m=I.messageHandler.createMessageObject({code:'5202'});}if(o.response.statusCode===404){m=I.messageHandler.createMessageObject({code:'5208'});}if(!m&&o.response.statusCode===500){m=I.messageHandler.createMessageObject({code:'5200',aParameters:[o.response.statusCode,o.response.statusText]});}if(!m){m=I.messageHandler.createMessageObject({code:'5201'});}I.messageHandler.putMessage(m);L(o,e(),m);};var u=I.coreApi.getPersistenceConfiguration().path.service+"/"+I.coreApi.getPersistenceConfiguration().path.entitySet;R.headers={"x-csrf-token":I.coreApi.getXsrfToken(I.coreApi.getPersistenceConfiguration().path.service)};switch(R.method){case"GET":if(!R.data&&A){R.requestUri=u+"('"+A+"')";I.coreApi.odataRequest(R,S,E);}else if(!R.data&&!A){g().then(function(i){R.requestUri=u+i;I.coreApi.odataRequest(R,S,E);},function(m){L({},e(),m);});}break;case"POST":if(R.data&&!A){R.requestUri=u;}I.coreApi.odataRequest(R,S,E);break;case"DELETE":if(!R.data&&A){R.requestUri=u+"('"+A+"')";}I.coreApi.odataRequest(R,S,E);break;case"PUT":if(R.data&&A){R.requestUri=u+"('"+A+"')";}I.coreApi.odataRequest(R,S,E);break;default:I.coreApi.odataRequest(R,S,E);break;}}function g(){var i=jQuery.Deferred();h().then(function(l){var j="";if(I.coreApi.getStartParameterFacade().getAnalyticalConfigurationId()){j="AnalyticalConfiguration%20eq%20'"+I.coreApi.getStartParameterFacade().getAnalyticalConfigurationId().configurationId+"'%20and%20";}var u="?$select=AnalysisPath,AnalysisPathName,StructuredAnalysisPath,CreationUTCDateTime,LastChangeUTCDateTime&$filter=("+j+"LogicalSystem%20eq%20'"+l+"'%20and%20"+"ApplicationConfigurationURL%20eq%20'"+I.coreApi.getApplicationConfigurationURL()+"')"+"&$orderby=LastChangeUTCDateTime%20desc";i.resolve(u);},function(m){i.fail(m);});return i.promise();}function c(E){var i=E.match("52[0-9]{2}");if(i){return i[0];}return undefined;}function a(R,n){var p;var m;function i(){I.messageHandler.putMessage=p;}function j(){p=I.messageHandler.putMessage;I.messageHandler.putMessage=function(m){var k=I.messageHandler.getConfigurationByCode(m.getCode());if(k&&k.severity&&k.severity==="warning"){return;}throw m;};}if(n!==undefined){R.SerializedAnalysisPath.path.indicesOfActiveSteps[0]=n;}I.coreApi.resetPath(true);j();try{I.coreApi.deserializePath(R.SerializedAnalysisPath);}catch(E){I.coreApi.restoreOriginalPath();m=b(E);}finally{i();}return m;}function b(E){var m;if(E.type&&E.type==="messageObject"){m=E;}else{m=new sap.apf.core.MessageObject({code:sap.apf.core.constants.message.code.errorUnknown});m.setSeverity(sap.apf.core.constants.message.severity.error);m.setMessage("Unknown exception caught "+E.message);}return m;}function d(S){var j=[];var k=S.path.steps;var m;for(var i in k){j.push({stepId:k[i].stepId,selectedRepresentationId:k[i].binding.selectedRepresentationId});}m={steps:j,indexOfActiveStep:S.path.indicesOfActiveSteps[0]};return m;}function e(){var C=I.coreApi.getPersistenceConfiguration();var E=I.coreApi.getEntityTypeMetadata(C.path.service,C.path.entitySet);return E;}function f(C){var T=C&&C.getFilterTermsForProperty('SAPClient');if(T===undefined||T.length!==1){return undefined;}return T[0].getValue();}function r(i,j){var m=I.messageHandler;var k=I.coreApi.getPersistenceConfiguration().logicalSystem;if(!k){l=j;i.resolve(j);return i.promise();}var S=k.service;var E=k.entitySet||k.entityType;if(S===null){l=j;i.resolve(j);return i.promise();}if(E===undefined){E=sap.apf.core.constants.entitySets.logicalSystem;}var F=new sap.apf.core.utils.Filter(m,"SAPClient",'eq',j);var u=I.coreApi.getUriGenerator().getAbsolutePath(S);u=u+I.coreApi.getUriGenerator().buildUri(m,E,['LogicalSystem'],F,undefined,undefined,undefined,undefined,undefined,'Results');var R={requestUri:u,method:"GET",headers:{"x-csrf-token":I.coreApi.getXsrfToken(S)}};var o=function(D){var p;if(D&&D.results&&D.results instanceof Array&&D.results.length===1&&D.results[0].LogicalSystem){l=D.results[0].LogicalSystem;i.resolve(l);}else{p=m.createMessageObject({code:"5026",aParameters:[j]});i.fail(p);}};var n=function(p){var q=m.createMessageObject({code:"5026",aParameters:[j]});if(p.messageObject!==undefined&&p.messageObject.type==="messageObject"){q.setPrevious(p.messageObject);}i.fail(q);};I.coreApi.odataRequest(R,o,n);}function h(){var i=jQuery.Deferred();if(l){i.resolve(l);return i.promise();}var j=I.coreApi.getStartParameterFacade().getSapClient();if(j){r(i,j);return i.promise();}I.coreApi.getCumulativeFilter().done(function(C){j=f(C);if(!j){i.resolve('');}else{r(i,j);}});return i.promise();}};}());};if(!jQuery.sap.isDeclared('sap.apf.core.representationTypes')){jQuery.sap.declare("sap.apf.core.representationTypes");(function(){'use strict';sap.apf.core.representationTypes=function(){return[{"type":"representationType","id":"ColumnChart","constructor":"sap.apf.ui.representations.columnChart","picture":"sap-icon://bar-chart","label":{"type":"label","kind":"text","key":"ColumnChart"},"metadata":{"dimensions":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.XAXIS,"min":"1","max":"*"},{"kind":sap.apf.core.constants.representationMetadata.kind.LEGEND,"min":"0","max":"*"}]},"measures":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.YAXIS,"min":"1","max":"*"}]}}},{"type":"representationType","id":"BarChart","constructor":"sap.apf.ui.representations.barChart","picture":"sap-icon://horizontal-bar-chart","label":{"type":"label","kind":"text","key":"BarChart"},"metadata":{"dimensions":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.XAXIS,"min":"1","max":"*"},{"kind":sap.apf.core.constants.representationMetadata.kind.LEGEND,"min":"0","max":"*"}]},"measures":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.YAXIS,"min":"1","max":"*"}]}}},{"type":"representationType","id":"LineChart","constructor":"sap.apf.ui.representations.lineChart","picture":"sap-icon://line-chart","label":{"type":"label","kind":"text","key":"LineChart"},"metadata":{"dimensions":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.XAXIS,"min":"1","max":"*"},{"kind":sap.apf.core.constants.representationMetadata.kind.LEGEND,"min":"0","max":"*"}]},"measures":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.YAXIS,"min":"1","max":"*"}]}}},{"type":"representationType","id":"LineChartWithTwoVerticalAxes","constructor":"sap.apf.ui.representations.lineChartWithTwoVerticalAxes","picture":"sap-icon://line-chart-dual-axis","label":{"type":"label","kind":"text","key":"LineChartWithTwoVerticalAxes"},"metadata":{"dimensions":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.XAXIS,"min":"1","max":"*"},{"kind":sap.apf.core.constants.representationMetadata.kind.LEGEND,"min":"0","max":"*"}]},"measures":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.YAXIS,"min":"1","max":"*"},{"kind":sap.apf.core.constants.representationMetadata.kind.YAXIS2,"min":"1","max":"*"}]}}},{"type":"representationType","id":"LineChartWithTimeAxis","constructor":"sap.apf.ui.representations.lineChartWithTimeAxis","picture":"sap-icon://line-charts","label":{"type":"label","kind":"text","key":"LineChartWithTimeAxis"},"metadata":{"dimensions":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.XAXIS,"min":"1","max":"1"},{"kind":sap.apf.core.constants.representationMetadata.kind.LEGEND,"min":"0","max":"*"}]},"measures":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.YAXIS,"min":"1","max":"*"}]}}},{"type":"representationType","id":"PieChart","constructor":"sap.apf.ui.representations.pieChart","picture":"sap-icon://pie-chart","label":{"type":"label","kind":"text","key":"PieChart"},"metadata":{"dimensions":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.SECTORCOLOR,"min":"1","max":"*"}]},"measures":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.SECTORSIZE,"min":"1","max":"1"}]}}},{"type":"representationType","id":"ScatterPlotChart","constructor":"sap.apf.ui.representations.scatterPlotChart","picture":"sap-icon://scatter-chart","label":{"type":"label","kind":"text","key":"ScatterPlotChart"},"metadata":{"dimensions":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.REGIONCOLOR,"min":"1","max":"*"},{"kind":sap.apf.core.constants.representationMetadata.kind.REGIONSHAPE,"min":"0","max":"*"}]},"measures":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.XAXIS,"min":"1","max":"1"},{"kind":sap.apf.core.constants.representationMetadata.kind.YAXIS,"min":"1","max":"1"}]},"sortable":false}},{"type":"representationType","id":"BubbleChart","constructor":"sap.apf.ui.representations.bubbleChart","picture":"sap-icon://bubble-chart","label":{"type":"label","kind":"text","key":"BubbleChart"},"metadata":{"dimensions":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.REGIONCOLOR,"min":"1","max":"*"},{"kind":sap.apf.core.constants.representationMetadata.kind.REGIONSHAPE,"min":"0","max":"*"}]},"measures":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.XAXIS,"min":"1","max":"1"},{"kind":sap.apf.core.constants.representationMetadata.kind.YAXIS,"min":"1","max":"1"},{"kind":sap.apf.core.constants.representationMetadata.kind.BUBBLEWIDTH,"min":"1","max":"1"},{"kind":sap.apf.core.constants.representationMetadata.kind.BUBBLEHEIGHT,"min":"0","max":"1"}]},"sortable":false}},{"type":"representationType","id":"StackedColumnChart","constructor":"sap.apf.ui.representations.stackedColumnChart","picture":"sap-icon://vertical-stacked-chart","label":{"type":"label","kind":"text","key":"StackedColumnChart"},"metadata":{"dimensions":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.XAXIS,"min":"1","max":"*"},{"kind":sap.apf.core.constants.representationMetadata.kind.LEGEND,"min":"0","max":"*"}]},"measures":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.YAXIS,"min":"1","max":"*"}]}}},{"type":"representationType","id":"StackedBarChart","constructor":"sap.apf.ui.representations.stackedBarChart","picture":"sap-icon://horizontal-stacked-chart","label":{"type":"label","kind":"text","key":"StackedBarChart"},"metadata":{"dimensions":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.XAXIS,"min":"1","max":"*"},{"kind":sap.apf.core.constants.representationMetadata.kind.LEGEND,"min":"0","max":"*"}]},"measures":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.YAXIS,"min":"1","max":"*"}]}}},{"type":"representationType","id":"PercentageStackedColumnChart","constructor":"sap.apf.ui.representations.percentageStackedColumnChart","picture":"sap-icon://full-stacked-column-chart","label":{"type":"label","kind":"text","key":"PercentageStackedColumnChart"},"metadata":{"dimensions":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.XAXIS,"min":"1","max":"*"},{"kind":sap.apf.core.constants.representationMetadata.kind.LEGEND,"min":"0","max":"*"}]},"measures":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.YAXIS,"min":"1","max":"*"}]}}},{"type":"representationType","id":"PercentageStackedBarChart","constructor":"sap.apf.ui.representations.percentageStackedBarChart","picture":"sap-icon://full-stacked-chart","label":{"type":"label","kind":"text","key":"PercentageStackedBarChart"},"metadata":{"dimensions":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.XAXIS,"min":"1","max":"*"},{"kind":sap.apf.core.constants.representationMetadata.kind.LEGEND,"min":"0","max":"*"}]},"measures":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.YAXIS,"min":"1","max":"*"}]}}},{"type":"representationType","id":"HeatmapChart","constructor":"sap.apf.ui.representations.heatmapChart","picture":"sap-icon://heatmap-chart","label":{"type":"label","kind":"text","key":"HeatmapChart"},"metadata":{"dimensions":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.XAXIS,"min":"1","max":"*"},{"kind":sap.apf.core.constants.representationMetadata.kind.XAXIS2,"min":"0","max":"*"}]},"measures":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.SECTORCOLOR,"min":"1","max":"1"}]}}},{"type":"representationType","id":"TableRepresentation","constructor":"sap.apf.ui.representations.table","picture":"sap-icon://table-chart","label":{"type":"label","kind":"text","key":"TableRepresentation"},"metadata":{"properties":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.COLUMN,"min":"1","max":"*"}]}}},{"type":"representationType","id":"ColumnChartSorted","constructor":"sap.apf.ui.representations.columnChart","picture":"sap-icon://vertical-bar-chart","label":{"type":"label","kind":"text","key":"ColumnChartSorted"}},{"type":"representationType","id":"ColumnChartClustered","constructor":"sap.apf.ui.representations.columnChart","picture":"sap-icon://bar-chart","label":{"type":"label","kind":"text","key":"ColumnChartClustered"}},{"type":"representationType","id":"ColumnChartClusteredSorted","constructor":"sap.apf.ui.representations.columnChart","picture":"sap-icon://vertical-bar-chart-2","label":{"type":"label","kind":"text","key":"ColumnChartClusteredSorted"}},{"type":"representationType","id":"StackedColumnSorted","constructor":"sap.apf.ui.representations.stackedColumnChart","picture":"sap-icon://upstacked-chart","label":{"type":"label","kind":"text","key":"StackedColumnSorted"}}];};}());};if(!jQuery.sap.isDeclared('sap.apf.core.utils.checkForTimeout')){jQuery.sap.declare('sap.apf.core.utils.checkForTimeout');(function(){'use strict';sap.apf.core.utils.checkForTimeout=function(s){var a;var m;var r=false;if(s&&s.headers&&s.headers['x-sap-login-page']){r=true;}if(s&&s.getResponseHeader&&s.getResponseHeader('x-sap-login-page')!==null){r=true;}if(s&&s.status){a=s.status;}if(s&&s.response&&s.response.statusCode){a=s.response.statusCode;}if(a===303||a===401||a===403||r){m=new sap.apf.core.MessageObject({code:"5021"});}return m;};}());};if(!jQuery.sap.isDeclared('sap.apf.core.utils.fileExists')){jQuery.sap.declare('sap.apf.core.utils.fileExists');(function(){'use strict';sap.apf.core.utils.FileExists=function(){var f={};this.check=function(u){if(f[u]!==undefined){return f[u];}var F=false;jQuery.ajax({url:u,type:"HEAD",success:function(d,s,j){var m=sap.apf.core.utils.checkForTimeout(j);if(m===undefined){F=true;}else{F=false;}},error:function(){F=false;},async:false});f[u]=F;return F;};};}());};if(!jQuery.sap.isDeclared('sap.apf.core.utils.uriGenerator')){jQuery.sap.declare("sap.apf.core.utils.uriGenerator");(function(){'use strict';sap.apf.core.utils.uriGenerator={};sap.apf.core.utils.uriGenerator.getAbsolutePath=function(p){if(p.slice(-1)==='/'){return p;}return p+"/";};sap.apf.core.utils.uriGenerator.getODataPath=function(p){var s=p.split('/');var i;var S=[];for(i=0;i<s.length;i++){if(s[i]!==""){S.push(s[i]);}}var r='';var l=S.length-1;for(i=0;i<l;i++){r=r+'/'+S[i];}return r+'/';};sap.apf.core.utils.uriGenerator.addRelativeToAbsoluteURL=function(a,r){var b=a.split('/');var c=r.split('/');c.forEach(function(p){if(p==='..'){b.pop();}else if(p!='.'){b.push(p);}});return b.join('/');};sap.apf.core.utils.uriGenerator.getBaseURLOfComponent=function(c){var b=c.split('.');b.pop();var a=b.join('.');return jQuery.sap.getModulePath(a);};sap.apf.core.utils.uriGenerator.getApfLocation=function(){return jQuery.sap.getModulePath("sap.apf")+'/';};sap.apf.core.utils.uriGenerator.buildUri=function(m,e,s,f,p,a,P,F,b,n){var r="";r+=e;r+=c(p,n);r=r+"?";r+=d(s);r+=g(f,b);r+=h(a,s);r+=j(P);r+=k(F);return r;function c(p,n){var r='';var i=false;var l;for(l in p){if(!i){r+='(';i=true;}else{r+=',';}r+=l.toString()+'='+p[l];}if(i){r+=')/';}r+=n||'';return r;}function d(s){if(!s[0]){return'';}var i;var R="$select=";for(i in s){R+=jQuery.sap.encodeURL(sap.apf.utils.escapeOdata(s[i]));if(i<s.length-1){R+=",";}}return R;}function g(f,b){if(!(f&&f instanceof sap.apf.core.utils.Filter)){return'';}var i=f.toUrlParam({formatValue:b});if(i===""||i==='()'){return'';}return'&$filter='+i;}function h(a,s){var o='';var S='';var i;if(!a){return'';}switch(true){case jQuery.isArray(a):for(i=0;i<a.length;i++){S=l(a[i],s);if(o.length>0&&S.length>0){o+=',';}o+=S;}break;case jQuery.isPlainObject(a):o+=l(a,s);break;case typeof a==='string':o+=l({property:a},s);break;}if(o.length>0){return"&$orderby="+o;}return'';function l(O,s){var v='';if(jQuery.inArray(O.property,s)>-1){v+=O.property;if(O.descending===true){v+=' desc';}else{v+=' asc';}}else{m.putMessage(m.createMessageObject({code:'5019',aParameters:[e,O.property]}));}return jQuery.sap.encodeURL(v);}}function j(P){function l(P){var o,i;o=Object.getOwnPropertyNames(P);for(i=0;i<o.length;i++){if(o[i]!=='top'&&o[i]!=='skip'&&o[i]!=='inlineCount'){m.putMessage(m.createMessageObject({code:'5032',aParameters:[e,o[i]]}));}}}var r='';if(!P){return r;}l(P);if(P.top){r+='&$top='+P.top;}if(P.skip){r+='&$skip='+P.skip;}if(P.inlineCount===true){r+='&$inlinecount=allpages';}return r;}function k(F){if(!F){F='json';}return'&$format='+F;}};}());};if(!jQuery.sap.isDeclared('sap.apf.library')){jQuery.sap.declare("sap.apf.library");jQuery.sap.require('sap.ui.core.Core');jQuery.sap.require('sap.ui.core.library');jQuery.sap.require('sap.ca.ui.library');jQuery.sap.require('sap.m.library');jQuery.sap.require('sap.ui.layout.library');jQuery.sap.require('sap.ushell.library');jQuery.sap.require('sap.viz.library');sap.ui.getCore().initLibrary({name:"sap.apf",dependencies:["sap.ui.core","sap.ca.ui","sap.m","sap.ui.layout","sap.ushell","sap.viz"],types:[],interfaces:[],controls:[],elements:[],noLibraryCSS:true,version:"1.36.10"});};if(!jQuery.sap.isDeclared('sap.apf.modeler.core.configurationObjects')){
/*!
 * SAP APF Analysis Path Framework
 *
 * (c) Copyright 2012-2014 SAP SE. All rights reserved
 */
jQuery.sap.declare("sap.apf.modeler.core.configurationObjects");(function(){'use strict';sap.apf.modeler.core.ConfigurationObjects=function(i){var t=this;var H,a,p,m;if(i.constructor.hashtable){H=i.constructor.hashtable;}if(i.instance.textPool){a=i.instance.textPool;}if(i.instance.persistenceProxy){p=i.instance.persistenceProxy;}if(i.instance.messageHandler){m=i.instance.messageHandler;}function c(j,k){var P=[];if(k){P.push(k);}m.putMessage(m.createMessageObject({code:j,aParameters:P}));}function b(l){var r=l&&l.type&&l.type==="label"&&l.kind&&l.kind==="text"&&l.key&&typeof l.key==="string";if(!r){c(11030,l.key);}return r;}this.serializeLabelKey=function(j){return{type:"label",kind:"text",key:a.getPersistentKey(j)};};this.serializeAndAddThumbnail=function(j,k){var l=j.getLeftLowerCornerTextKey();var n=j.getLeftUpperCornerTextKey();var r=j.getRightUpperCornerTextKey();var o=j.getRightLowerCornerTextKey();var q={type:"thumbnail"};if(n){q.leftUpper=this.serializeLabelKey(n);}if(l){q.leftLower=this.serializeLabelKey(l);}if(r){q.rightUpper=this.serializeLabelKey(r);}if(o){q.rightLower=this.serializeLabelKey(o);}if(q.leftLower||q.leftUpper||q.rightLower||q.rightUpper){k.thumbnail=q;}};this.serializeCategory=function(j,k){var T=a.get(j.labelKey);var l=[];if(k){k.forEach(function(o){l.push({type:"step",id:o});});}var n=(T&&T.TextElementDescription)||"";return{type:"category",description:n,id:j.getId(),label:t.serializeLabelKey(j.labelKey),steps:l};};this.validateCategory=function(j){var r=j&&j.type&&j.type==="category"&&j.id&&j.steps&&b(j.label);if(r){j.steps.forEach(function(o){if(!o.type||o.type!=="step"||!o.id){r=false;}});}if(!r){c(11031,j.id);}return r;};this.validateRequest=function(r){var j=r&&r.id&&r.type==="request"&&r.service&&typeof r.service==="string"&&((r.entityType&&typeof r.entityType==="string")||(r.entitySet&&typeof r.entitySet==="string"))&&r.selectProperties&&r.selectProperties&&r.selectProperties instanceof Array&&r.selectProperties.length>=0;if(!j){c(11032,r.id);}return j;};this.validateBinding=function(j){var r=j&&j.id&&j.type==="binding"&&j.requiredFilters&&j.requiredFilters instanceof Array&&j.requiredFilters.length>=0&&j.representations&&j.representations instanceof Array;if(!r){c(11033,j.id);}return r;};this.validateFacetFilter=function(j){var r=j&&j.id&&j.property&&j.type==="facetFilter";if(!r){c(11034,j.id);}return r;};this.validateNavigationTarget=function(n){var r=n&&n.id&&n.semanticObject&&n.action&&n.type==="navigationTarget"&&n.hasOwnProperty("isStepSpecific");if(!r){c(11040,n.id);}return r;};this.validateStep=function(j){var r=j&&j.id&&j.type==="step"&&b(j.title)&&b(j.longTitle)&&j.hasOwnProperty("navigationTargets");if(!r){c(11035,j.id);}return r;};this.validateConfiguration=function(j){var r=j&&j.applicationTitle&&j.applicationTitle.key&&typeof j.applicationTitle.key==='string'&&j.steps&&j.steps instanceof Array&&j.steps.length>=0&&j.requests&&j.requests instanceof Array&&j.requests.length>=0&&j.bindings&&j.bindings instanceof Array&&j.bindings.length>=0&&j.representationTypes&&j.representationTypes instanceof Array&&j.representationTypes.length>=0&&j.facetFilters&&j.facetFilters instanceof Array&&j.facetFilters.length>=0&&j.categories&&j.categories instanceof Array&&j.categories.length>=0;if(!r){c(11036);}return r;};function s(j){var r=[];var k,l;var n,o;var q;var u;var v;var w;var x=j.getRepresentations();x.forEach(function(y){k=[];l=y.getDimensions();l.forEach(function(z){var A={fieldName:z};if(y.getDimensionKind(z)){A.kind=y.getDimensionKind(z);}if(y.getDimensionTextLabelKey(z)){A.fieldDesc={type:'label',kind:'text',key:y.getDimensionTextLabelKey(z)};}if(y.getLabelDisplayOption(z)){A.labelDisplayOption=y.getLabelDisplayOption(z);}k.push(A);});n=[];o=y.getMeasures();o.forEach(function(z){var A={fieldName:z};if(y.getMeasureKind(z)){A.kind=y.getMeasureKind(z);}if(y.getMeasureTextLabelKey(z)){A.fieldDesc={type:'label',kind:'text',key:y.getMeasureTextLabelKey(z)};}n.push(A);});q=[];y.getProperties().forEach(function(z){var A={fieldName:z};if(y.getPropertyKind(z)){A.kind=y.getPropertyKind(z);}if(y.getPropertyTextLabelKey(z)){A.fieldDesc={type:'label',kind:'text',key:y.getPropertyTextLabelKey(z)};}q.push(A);});u=[];y.getOrderbySpecifications().forEach(function(z){u.push({property:z.property,ascending:z.ascending});});v={id:y.getId(),representationTypeId:y.getRepresentationType(),parameter:{dimensions:k,measures:n,properties:q,alternateRepresentationTypeId:y.getAlternateRepresentationType()}};if(y.getWidthProperties()){v.parameter.width=y.getWidthProperties();}if(u.length>0){v.parameter.orderby=u;}w=y.getTopN();if(w&&w>0){v.parameter.top=w;}t.serializeAndAddThumbnail(y,v);r.push(v);});return r;}this.serializeBinding=function(j,k){var l="binding-for-"+j.getId();var T=a.get(j.getTitleId());var n=(T&&T.TextElementDescription)||"";k.bindings.push({type:"binding",id:l,stepDescription:n,requiredFilters:j.getFilterProperties(),representations:s(j)});return l;};this.serializeRequest=function(j,k){var r;var l="request-for-"+j.getId();r={type:"request",id:l,service:j.getService(),entitySet:j.getEntitySet(),selectProperties:j.getSelectProperties()};k.requests.push(r);return l;};this.serializeFilterMappingRequest=function(o,j){var r="request-for-FilterMapping"+o.getId();var k={type:"request",id:r,service:o.getFilterMappingService(),entitySet:o.getFilterMappingEntitySet(),selectProperties:o.getFilterMappingTargetProperties()};j.requests.push(k);return r;};this.serializeStep=function(j,k){var r=t.serializeRequest(j,k);var l=t.serializeBinding(j,k);var T=a.get(j.getTitleId());var n=(T&&T.TextElementDescription)||"";var o=j.getLongTitleId();var q;var u={type:"step",description:n,request:r,binding:l,id:j.getId(),title:t.serializeLabelKey(j.getTitleId()),navigationTargets:[]};if(j.getFilterMappingService()){u.filterMapping={requestForMappedFilter:t.serializeFilterMappingRequest(j,k),target:j.getFilterMappingTargetProperties(),keepSource:j.getFilterMappingKeepSource()?"true":"false"};}q=j.getTopN();if(q){u.topNSettings=q;}if(o!==""&&o!==undefined){u.longTitle=t.serializeLabelKey(j.getLongTitleId());}this.serializeAndAddThumbnail(j,u);j.getNavigationTargets().forEach(function(v){u.navigationTargets.push({type:"navigationTarget",id:v});});return u;};this.serializeFacetFilter=function(j,k){var r,l,v;if(j.getServiceOfFilterResolution()){r=o("FilterResolution",j,k);}if(j.getUseSameRequestForValueHelpAndFilterResolution()){l=r;}else if(j.getServiceOfValueHelp()){l=o("ValueHelp",j,k);}var T=a.get(j.getLabelKey());var n=(T&&T.TextElementDescription)||"";if(j.getValueList().length>0){v=j.getValueList();}return{type:"facetFilter",description:n,id:j.getId(),alias:j.getAlias(),property:j.getProperty(),multiSelection:j.isMultiSelection()+"",preselectionFunction:j.getPreselectionFunction(),preselectionDefaults:j.getPreselectionDefaults(),valueList:v,label:t.serializeLabelKey(j.getLabelKey()),invisible:!j.isVisible(),filterResolutionRequest:r,valueHelpRequest:l,hasAutomaticSelection:j.getAutomaticSelection()+"",useSameRequestForValueHelpAndFilterResolution:j.getUseSameRequestForValueHelpAndFilterResolution()+""};function o(q,j,k){var u;var w;var x;var y;switch(q){case"ValueHelp":w=j.getServiceOfValueHelp();x=j.getEntitySetOfValueHelp();y=j.getSelectPropertiesOfValueHelp();break;case"FilterResolution":w=j.getServiceOfFilterResolution();x=j.getEntitySetOfFilterResolution();y=j.getSelectPropertiesOfFilterResolution();break;}var z=q+"-request-for-"+j.getId();u={type:"request",id:z,service:w,entitySet:x,selectProperties:y};k.requests.push(u);return z;}};this.serializeNavigationTarget=function(n,j){var r={type:"navigationTarget",id:n.getId(),semanticObject:n.getSemanticObject(),action:n.getAction(),isStepSpecific:n.isStepSpecific()};if(n.getFilterMappingService()){r.filterMapping={requestForMappedFilter:t.serializeFilterMappingRequest(n,j),target:n.getFilterMappingTargetProperties()};}return r;};this.serializeConfiguration=function(j){var k={analyticalConfigurationName:j.getConfigurationName(),applicationTitle:t.serializeLabelKey(j.getApplicationTitle()),steps:[],requests:[],bindings:[],representationTypes:[],categories:[],facetFilters:[],navigationTargets:[]};var l={requests:k.requests,bindings:k.bindings};j.getCategories().forEach(function(n){var o=j.getCategoryStepAssignments(n.getId());k.categories.push(t.serializeCategory(n,o));});j.getSteps().forEach(function(n){var o=t.serializeStep(n,l);k.steps.push(o);});j.getFacetFilters().forEach(function(n){var o=t.serializeFacetFilter(n,l);k.facetFilters.push(o);});j.getNavigationTargets().forEach(function(n){var o=t.serializeNavigationTarget(n,l);k.navigationTargets.push(o);});return k;};function d(j,k){var l=j.thumbnail;if(!l){return;}if(l.leftLower){k.setLeftLowerCornerTextKey(l.leftLower.key);}if(l.leftUpper){k.setLeftUpperCornerTextKey(l.leftUpper.key);}if(l.rightLower){k.setRightLowerCornerTextKey(l.rightLower.key);}if(l.rightUpper){k.setRightUpperCornerTextKey(l.rightUpper.key);}}function e(j,r,k){var l=k.createStepWithId(j.id);var n=k.getStep(l);var o=r.getItem(j.request);if(o.entityType){o.entitySet=o.entityType;delete o.entityType;}if(o.service){k.registerService(o.service);}n.setService(o.service);n.setEntitySet(o.entitySet);n.setTitleId(j.title.key);if(j.longTitle&&j.longTitle.key){n.setLongTitleId(j.longTitle.key);}if(j.navigationTargets){j.navigationTargets.forEach(function(u){n.addNavigationTarget(u.id);});}d(j,n);o.selectProperties.forEach(function(u){n.addSelectProperty(u);});var q=r.getItem(j.binding);q.requiredFilters.forEach(function(u){n.addFilterProperty(u);});q.representations.forEach(function(u){var v;var w=n.getRepresentation(n.createRepresentation().getId());w.setRepresentationType(u.representationTypeId);w.setAlternateRepresentationType(u.parameter.alternateRepresentationTypeId);u.parameter.dimensions.forEach(function(x){w.addDimension(x.fieldName);if(x.fieldDesc){w.setDimensionTextLabelKey(x.fieldName,x.fieldDesc.key);}if(x.kind){w.setDimensionKind(x.fieldName,x.kind);}if(x.labelDisplayOption){w.setLabelDisplayOption(x.fieldName,x.labelDisplayOption);}});u.parameter.measures.forEach(function(x){w.addMeasure(x.fieldName);if(x.fieldDesc){w.setMeasureTextLabelKey(x.fieldName,x.fieldDesc.key);}if(x.kind){w.setMeasureKind(x.fieldName,x.kind);}});if(u.parameter.properties){u.parameter.properties.forEach(function(x){w.addProperty(x.fieldName);if(x.fieldDesc){w.setPropertyTextLabelKey(x.fieldName,x.fieldDesc.key);}if(x.kind){w.setPropertyKind(x.fieldName,x.kind);}});}if(u.parameter.width){for(v in u.parameter.width){if(u.parameter.width.hasOwnProperty(v)){w.setWidthProperty(v,u.parameter.width[v]);}}}if(u.parameter.orderby&&!u.parameter.topN){u.parameter.orderby.forEach(function(x){w.addOrderbySpec(x.property,x.ascending);});}d(u,w);});if(j.filterMapping){h(j.filterMapping,n,r);}if(j.topNSettings){n.setTopN(j.topNSettings.top,j.topNSettings.orderby);}}function f(j,r,k){var l=k.createFacetFilterWithId(j.id);var n=k.getFacetFilter(l);n.setLabelKey(j.label.key);n.setAlias(j.alias);n.setProperty(j.property);if(j.preselectionFunction&&j.preselectionFunction!==""){n.setPreselectionFunction(j.preselectionFunction);}else{n.setPreselectionDefaults(j.preselectionDefaults);}if(j.valueList){n.setValueList(j.valueList);}if(j.useSameRequestForValueHelpAndFilterResolution&&j.useSameRequestForValueHelpAndFilterResolution==="true"){n.setUseSameRequestForValueHelpAndFilterResolution(true);}else{n.setUseSameRequestForValueHelpAndFilterResolution(false);}if(j.multiSelection==="true"){n.setMultiSelection(true);}if(j.invisible===true){n.setInvisible();}if(j.hasAutomaticSelection==="true"){n.setAutomaticSelection(true);}else{n.setAutomaticSelection(false);}if(j.valueHelpRequest){var o=r.getItem(j.valueHelpRequest);if(o.entityType){o.entitySet=o.entityType;delete o.entityType;}if(o.service){k.registerService(o.service);n.setServiceOfValueHelp(o.service);}if(o.entitySet){n.setEntitySetOfValueHelp(o.entitySet);}o.selectProperties.forEach(function(u){n.addSelectPropertyOfValueHelp(u);});}if(j.filterResolutionRequest){var q=r.getItem(j.filterResolutionRequest);if(q.entityType){q.entitySet=q.entityType;delete q.entityType;}if(q.service){k.registerService(q.service);n.setServiceOfFilterResolution(q.service);}if(q.entitySet){n.setEntitySetOfFilterResolution(q.entitySet);}q.selectProperties.forEach(function(u){n.addSelectPropertyOfFilterResolution(u);});}}function g(j,r,k){var l=k.createNavigationTargetWithId(j.id);var n=k.getNavigationTarget(l);n.setSemanticObject(j.semanticObject);n.setAction(j.action);if(j.isStepSpecific===true){n.setStepSpecific();}else{n.setGlobal();}if(j.filterMapping){h(j.filterMapping,n,r);}}function h(j,k,r){var l=r.getItem(j.requestForMappedFilter);if(l.entityType){l.entitySet=l.entityType;delete l.entityType;}k.setFilterMappingService(l.service);k.setFilterMappingEntitySet(l.entitySet);j.target.forEach(function(n){k.addFilterMappingTargetProperty(n);});if(j.hasOwnProperty("keepSource")){if(j.keepSource==="true"){k.setFilterMappingKeepSource(true);}else{k.setFilterMappingKeepSource(false);}}}this.mapToDesignTime=function(r,j){j.setApplicationTitle(r.getItem('applicationTitle').key);r.getSteps().forEach(function(k){e(k,r,j);});r.getCategories().forEach(function(k){j.createCategoryWithId({labelKey:k.label.key},k.id);k.steps.forEach(function(l){j.addCategoryStepAssignment(k.id,l.id);});});r.getFacetFilters().forEach(function(k){f(k,r,j);});r.getNavigationTargets().forEach(function(n){g(n,r,j);});};this.loadAllConfigurations=function(j,k){var l=new sap.apf.core.utils.Filter(m,'Application','eq',j);p.readCollection("configuration",function(r,n,o){k(r,n,o);},undefined,undefined,l,true);};this.getTextKeysFromAllConfigurations=function(j,k){this.loadAllConfigurations(j,function(l,n,o){var q=new H(m);if(o){k(undefined,o);return;}l.forEach(function(r){var u=JSON.parse(r.SerializedAnalyticalConfiguration);var v=sap.apf.modeler.core.ConfigurationObjects.getTextKeysFromConfiguration(u);v.forEach(function(w){q.setItem(w,w);});});k(q,undefined);});};};sap.apf.modeler.core.ConfigurationObjects.deepDataCopy=function deepDataCopy(i){var r;if(!i){r=i;}else if(i.copy&&typeof i.copy==="function"){r=i.copy();}else if(i&&typeof i==="object"){if(i instanceof Array){r=[];i.forEach(function(a){r.push(deepDataCopy(a));});}else{r={};for(var a in i){if(!i.hasOwnProperty(a)){continue;}r[a]=deepDataCopy(i[a]);}}}else{r=i;}return r;};sap.apf.modeler.core.ConfigurationObjects.getTextKeysFromConfiguration=function getTextKeysFromConfiguration(c){var r=[];if(!c){return;}if(c.type&&c.type==="label"&&c.kind&&c.kind==="text"&&c.key){return[c.key];}for(var i in c){if(typeof c[i]!=="object"||!c.hasOwnProperty(i)){continue;}Array.prototype.push.apply(r,getTextKeysFromConfiguration(c[i]));}return r;};}());};if(!jQuery.sap.isDeclared('sap.apf.modeler.core.elementContainer')){jQuery.sap.declare("sap.apf.modeler.core.elementContainer");(function(){'use strict';sap.apf.modeler.core.ElementContainer=function(n,E,i,d){var e,a,r=new RegExp("^"+n+"-([123456789]\\d*)$"),b=new RegExp("^"+n);var t=this;i.instance.messageHandler.check(n!==undefined,"ElementContainer: Element has been created without name");if(!d){e=new i.constructor.hashtable(i.instance.messageHandler);a=0;}else{e=d.elements;a=d.elementCounter;}this.generateId=function(){return n+"-"+(++a);};this.createElement=function(f){var g;g=t.generateId();return c(f,g);};this.createElementWithProposedId=function(f,p){function g(k){var m=r.exec(k);if(m){var l=parseInt(m[1],10);if(l>a){a=l;}}}var h;var j=e.getItem(p);if(j){return t.createElement(f);}h=c(f,p);g(p);return h;};this.removeElement=function(f){return e.removeItem(f);};this.getElement=function(f){return e.getItem(f);};this.updateElement=function(f,g){i.instance.messageHandler.check(f!==undefined,"ElementContainer: Element has been updated with undefined elementId");if((!g.getId)||g.getId()!==f){g.getId=function(){return f;};}e.setItem(f,g);return f;};this.setElement=function(f,g){var h;if(g){if(!(e.getItem(g))){i.instance.messageHandler.putMessage(i.instance.messageHandler.createMessageObject({code:'11006',aParameters:[g]}));return undefined;}t.updateElement(g,f);return g;}h=t.createElement(f);return h.getId();};this.getElements=function(){var l=[];e.forEachOrdered(function(f,g){l.push(g);});return l;};this.moveUpOrDown=function(f,g){return e.moveUpOrDown(f,g);};this.moveBefore=function(f,m){return e.moveBefore(f,m);};this.moveToEnd=function(f){return e.moveToEnd(f);};this.copyElement=function(f){var g,h,j;g=e.getItem(f);if(!g){return;}j=t.generateId();if(g.copy&&typeof g.copy==="function"){h=g.copy(j);}else{h=sap.apf.modeler.core.ConfigurationObjects.deepDataCopy(g);}h.getId=function(){return j;};e.setItem(j,h);return j;};this.copy=function(f){var g={elements:new i.constructor.hashtable(i.instance.messageHandler),elementCounter:a};var h;var j;e.getKeysOrdered().forEach(function(k){h=e.getItem(k);j=sap.apf.modeler.core.ConfigurationObjects.deepDataCopy(h);if(f&&k.indexOf(n)===0){k=k.replace(b,f);}i.instance.messageHandler.check(k!==undefined,"ElementContainer: Element has been created without name in copy - 1");if(typeof j==="object"&&j.getId&&typeof j.getId==="function"){j.getId=function(){return k;};}g.elements.setItem(k,j);});i.instance.messageHandler.check(n!==undefined||f!==undefined,"ElementContainer: Element has been created without name in copy 2");return new sap.apf.modeler.core.ElementContainer((f||n),E,i,g);};function c(f,g){var h;i.instance.messageHandler.check(g!==undefined,"ElementContainer: Element has been created with undefined id");if(typeof E==='function'){if(E!==sap.apf.modeler.core.ElementContainer){h=new E(g,i);}else{h=new E(g,undefined,i);}}else{h={};}h.getId=function(){return g;};if(f){h=jQuery.extend(h,f);}e.setItem(g,h);return h;}};}());};if(!jQuery.sap.isDeclared('sap.apf.modeler.core.facetFilter')){jQuery.sap.declare("sap.apf.modeler.core.facetFilter");(function(){'use strict';sap.apf.modeler.core.FacetFilter=function(f,a,d){var r,s,b,m,l,p,v,c,e,g,h,j=true,k,n,u;if(!d){r={forValueHelp:{service:undefined,entitySet:undefined},forFilterResolution:{service:undefined,entitySet:undefined}};s=new a.constructor.elementContainer("SelectPropertyValueHelp",undefined,a);b=new a.constructor.elementContainer("SelectPropertyFilterResolution",undefined,a);m={};l={};p=[];k=false;u=false;}else{r=d.request;s=d.selectPropertyForValueHelp;b=d.selectPropertyForFilterResolution;m=d.metadata;l=d.label;h=d.preselectionFunction;p=d.preselectionDefaults;v=d.valueList;c=d.property;e=d.alias;g=d.labelKey;n=d.invisible;k=d.isMultiSelectionActive;j=d.hasAutomaticSelection;u=d.useSameRequestForValueHelpAndFilterResolution;}this.getId=function(){return f;};this.setMultiSelection=function(i){k=i;};this.isMultiSelection=function(){return k;};this.setInvisible=function(){n=true;};this.setVisible=function(){n=undefined;};this.isVisible=function(){return!n;};this.setAlias=function(i){e=i;};this.getAlias=function(){return e;};this.setAutomaticSelection=function(i){a.instance.messageHandler.check(typeof i==="boolean","facetFilter wrong input for setAutomaticSelection");j=i;if(j){this.removePreselectionFunction();this.removePreselectionDefaults();}};this.getAutomaticSelection=function(){return j;};this.setPreselectionFunction=function(i){h=i;j=false;this.removePreselectionDefaults();};this.getPreselectionFunction=function(){return h;};this.removePreselectionFunction=function(){h=undefined;};this.setPreselectionDefaults=function(i){p=i;j=false;this.removePreselectionFunction();};this.getPreselectionDefaults=function(){return p;};this.removePreselectionDefaults=function(){p=[];};this.setValueList=function(o){var q=jQuery.isArray(o);if(q&&o.length>0&&t(o)){v=jQuery.extend([],o);}else if(q&&o.length==0){v=undefined;}function t(w){for(var i=0,x=w.length;i<x;i++){if(typeof w[i]!='string'){return false;}}return true;}};this.getValueList=function(){if(!v){return[];}return jQuery.extend([],v);};this.setLabelKey=function(i){g=i;};this.getLabelKey=function(){return g;};this.setProperty=function(i){c=i;};this.getProperty=function(){return c;};this.setUseSameRequestForValueHelpAndFilterResolution=function(O){var t=this;if(O){var i=this.getServiceOfValueHelp();this.setServiceOfFilterResolution(i);var o=this.getEntitySetOfValueHelp();this.setEntitySetOfFilterResolution(o);var q=this.getSelectPropertiesOfFilterResolution();q.forEach(function(c){t.removeSelectPropertyOfFilterResolution(c);});q=this.getSelectPropertiesOfValueHelp();q.forEach(function(c){t.addSelectPropertyOfFilterResolution(c);});}u=O;};this.getUseSameRequestForValueHelpAndFilterResolution=function(){return u;};this.setServiceOfValueHelp=function(i){r.forValueHelp.service=i;if(u){r.forFilterResolution.service=i;}};this.getServiceOfValueHelp=function(){return r.forValueHelp.service;};this.setEntitySetOfValueHelp=function(i){r.forValueHelp.entitySet=i;if(u){r.forFilterResolution.entitySet=i;}};this.getEntitySetOfValueHelp=function(){return r.forValueHelp.entitySet;};this.getSelectPropertiesOfValueHelp=function(){var i=[];var o;o=s.getElements();o.forEach(function(q){i.push(q.getId());});return i;};this.removeSelectPropertyOfValueHelp=function(i){s.removeElement(i);if(u){b.removeElement(i);}};this.addSelectPropertyOfValueHelp=function(i){s.createElementWithProposedId(undefined,i);if(u){b.createElementWithProposedId(undefined,i);}};this.setServiceOfFilterResolution=function(i){if(u){return;}r.forFilterResolution.service=i;};this.getServiceOfFilterResolution=function(){return r.forFilterResolution.service;};this.setEntitySetOfFilterResolution=function(i){if(u){return;}r.forFilterResolution.entitySet=i;};this.getEntitySetOfFilterResolution=function(){return r.forFilterResolution.entitySet;};this.getSelectPropertiesOfFilterResolution=function(){var i=[];var o;o=b.getElements();o.forEach(function(q){i.push(q.getId());});return i;};this.removeSelectPropertyOfFilterResolution=function(i){if(u){return;}b.removeElement(i);};this.addSelectPropertyOfFilterResolution=function(i){if(u){return;}b.createElementWithProposedId(undefined,i);};this.copy=function(i){var o={request:r,selectPropertyForValueHelp:s,selectPropertyForFilterResolution:b,metadata:m,label:l,preselectionFunction:h,preselectionDefaults:p,valueList:v,property:c,alias:e,labelKey:g,invisible:n,isMultiSelectionActive:k,hasAutomaticSelection:j};var d=sap.apf.modeler.core.ConfigurationObjects.deepDataCopy(o);return new sap.apf.modeler.core.FacetFilter((i||this.getId()),a,d);};};}());};if(!jQuery.sap.isDeclared('sap.apf.modeler.core.lazyLoader')){jQuery.sap.declare("sap.apf.modeler.core.lazyLoader");(function(){'use strict';sap.apf.modeler.core.LazyLoader=function(a,l,d){var H=a.constructor.hashtable;var o={id:null,instance:null,messageObject:null,isInitializing:false,callbacksFromAsyncGet:new H(a.instance.messageHandler)},b=null;if(d){o.id=d.id;o.instance=d.instance;}this.type="lazyLoader";this.getId=function(){return o.id;};this.getInstance=function(){return o.instance;};this.isInitializing=function(){return o.isInitializing;};this.reset=function(){b=o.instance;o={id:null,instance:null,messageObject:null,isInitializing:false,callbacksFromAsyncGet:new H(a.instance.messageHandler)};};this.asyncGetInstance=function(i,e){function p(g){if(g===null){return undefined;}return g;}var f;if(!i){return;}if(o.id&&i!==o.id){this.reset();}if(o.id&&(o.instance||o.messageObject)){f=p(o.messageObject);e(o.instance,f,o.id);return;}m(e);if(!o.isInitializing){o.isInitializing=true;o.id=i;l(i,c,b);}};function c(i,e,f){if(i!==o.id){return;}o.isInitializing=false;if(!f){o.instance=e;}else{o.messageObject=f;}o.callbacksFromAsyncGet.each(function(k,g){g.forEach(function(h){h(o.instance,f,o.id);});});o.callbacksFromAsyncGet=null;}function m(e){var i;var f,g;g=o.callbacksFromAsyncGet.getItem(e);if(!g){o.callbacksFromAsyncGet.setItem(e,[e]);return;}f=false;for(i=0;i<g.length;i++){if(g[i]===e){f=true;break;}}if(!f){g.push(e);}}};}());};if(!jQuery.sap.isDeclared('sap.apf.modeler.core.messageDefinition')){
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
jQuery.sap.declare("sap.apf.modeler.core.messageDefinition");sap.apf.modeler.core.messageDefinition=[{code:"11005",severity:"technError",text:"Bad HTTP request returned status code {0} with status text {1}."},{code:"11006",severity:"technError",text:"Unknown identifier: {0}"},{code:"11007",severity:"technError",text:"Cannot export unsaved configuration. Configuration ID: {0}"},{code:"11008",severity:"error",description:"Format information is missing at least for text element {0} - please edit the exported text property file manually",key:"11008"},{code:"11009",severity:"error",description:"Application id {0} cannot be used as translation uuid in text property file - please edit the exported text property file manually",key:"11009"},{code:"11010",severity:"error",description:"Imported text property file does not contain the APF application id - expected an entry like #ApfApplicationId=543EC63F05550175E10000000A445B6D.",key:"11010"},{code:"11011",severity:"error",description:"Expected a valid text entry <key>=<value> in line {0}, but could not find - key must be in valid guid format.",key:11011},{code:"11012",severity:"error",description:"No valid text entry <key>=<value> in line {0}, key is not in valid guid format like 543EC63F05550175E10000000A445B6D.",key:11012},{code:"11013",severity:"technError",text:"Metadata request {3} to server failed with http status code {0}, http error message {1}, and server response {2}",key:"11013"},{code:"11014",severity:"error",description:"ApfApplicationId in line {0} has invalid format - a valid application id looks like 543EC63F05550175E10000000A445B6D.",key:"11014"},{code:"11015",severity:"error",description:"Date in line {0} has invalid format.",key:"11015"},{code:"11016",severity:"error",description:"Sorting options must be supplied when setting top n",key:"11016"},{code:"11020",severity:"error",description:"Text property has invalid format and cannot be imported - see previous messages for details",key:"11020"},{code:"11021",severity:"error",description:"ApfApplicationId {0} referenced in the text property is not yet existing - please load one configuration of the application before importing the texts.",key:"11021"},{code:"11030",severity:"error",description:"Label {0} is not valid",key:"11030"},{code:"11031",severity:"error",description:"Category {0} is not valid",key:"11031"},{code:"11032",severity:"error",description:"Request {0} is not valid",key:"11032"},{code:"11033",severity:"error",description:"Binding {0} is not valid",key:"11033"},{code:"11034",severity:"error",description:"Facet filter {0} is not valid",key:"11034"},{code:"11035",severity:"error",description:"Step {0} is not valid",key:"11035"},{code:"11036",severity:"error",description:"Configuration is not valid",key:"11036"},{code:"11037",severity:"error",description:"Invalid application guid {0}",key:"11037"},{code:"11038",severity:"error",description:"Invalid configuration guid {0}",key:"11038"},{code:"11039",severity:"error",description:"Invalid text guid {0}",key:"11039"},{code:"11040",severity:"error",description:"Navigation target {0} is not valid",key:"11040"},{code:"11041",severity:"technError",text:"Network service for retrieving semantic objects failed - see console."},{code:"11042",severity:"technError",text:"Error occurred when retrieving actions for semantic object - see console."},{code:"11500",severity:"error",description:"An error occurred while attempting to save the application.",key:"11500"},{code:"11501",severity:"error",description:"An error occurred while attempting to delete the application.",key:"11501"},{code:"11502",severity:"error",description:"An error occurred while importing the configuration.",key:"11502"},{code:"11503",severity:"error",description:"An error occurred while importing the text properties file.",key:"11503"},{code:"11504",severity:"error",description:"An error occurred while retrieving the semantic objects available.",key:"11504"},{code:"11505",severity:"error",description:"An error occurred while retrieving the actions for the given semantic object.",key:"11505"}];};if(!jQuery.sap.isDeclared('sap.apf.modeler.core.navigationTarget')){
/*!
 * SAP APF Analysis Path Framework
 *
 * (c) Copyright 2012-2015 SAP SE. All rights reserved
 */
jQuery.sap.declare("sap.apf.modeler.core.navigationTarget");(function(){'use strict';sap.apf.modeler.core.NavigationTarget=function(n,i,d){var s,a,b=false,r,t;if(d){s=d.semObject;a=d.actn;b=d.isStepSpecific;r=d.requestForFilterMapping;t=d.targetPropertiesForFilterMapping;}else{r={};t=new i.constructor.elementContainer("TargetPropertyForFilterMapping",undefined,i);}this.getId=function(){return n;};this.setSemanticObject=function(c){s=c;};this.getSemanticObject=function(){return s;};this.setAction=function(c){a=c;};this.getAction=function(){return a;};this.isGlobal=function(){return!b;};this.isStepSpecific=function(){return b;};this.setGlobal=function(){b=false;};this.setStepSpecific=function(){b=true;};this.setFilterMappingService=function(c){r.service=c;};this.getFilterMappingService=function(){return r.service;};this.setFilterMappingEntitySet=function(e){r.entitySet=e;};this.getFilterMappingEntitySet=function(){return r.entitySet;};this.addFilterMappingTargetProperty=function(p){t.createElementWithProposedId(undefined,p);};this.getFilterMappingTargetProperties=function(){var p=[];var c=t.getElements();c.forEach(function(e){p.push(e.getId());});return p;};this.removeFilterMappingTargetProperty=function(p){t.removeElement(p);};this.copy=function(c){var e={semObject:s,actn:a,isStepSpecific:b,requestForFilterMapping:r,targetPropertiesForFilterMapping:t};var d=sap.apf.modeler.core.ConfigurationObjects.deepDataCopy(e);return new sap.apf.modeler.core.NavigationTarget((c||this.getId()),i,d);};};}());};if(!jQuery.sap.isDeclared('sap.apf.modeler.core.registryWrapper')){
/*!
 * SAP APF Analysis Path Framework
 *
 * (c) Copyright 2012-2014 SAP SE. All rights reserved
 */
jQuery.sap.declare("sap.apf.modeler.core.registryWrapper");(function(){'use strict';sap.apf.modeler.core.RegistryWrapper=function(h){function g(t){var r=[];if(h.getNumberOfItems()!==0){h.each(function(i,e){if(e.type===t){r.push(e);}});}return r;}this.getItem=function(k){return h.getItem(k);};this.getSteps=function(){return g("step");};this.getCategories=function(){return g("category");};this.getFacetFilters=function(){return g("facetFilter");};this.getNavigationTargets=function(){return g("navigationTarget");};};}());};if(!jQuery.sap.isDeclared('sap.apf.modeler.core.representation')){jQuery.sap.declare("sap.apf.modeler.core.representation");(function(){'use strict';sap.apf.modeler.core.Representation=function(r,i,d){var a,b,w,c,m,p,l,e,f,g,o,t;if(!d){w={};c=new i.constructor.elementContainer("dimension",undefined,i);m=new i.constructor.elementContainer("measure",undefined,i);p=new i.constructor.elementContainer("property",undefined,i);o=new i.constructor.elementContainer("orderBy",undefined,i);}else{a=d.representationTypeId;b=d.alternateRepresentationTypeId;w=d.width;c=d.dimensions;m=d.measures;p=d.properties;l=d.leftUpperCornerTextKey;e=d.rightUpperCornerTextKey;f=d.leftLowerCornerTextKey;g=d.rightLowerCornerTextKey;o=d.orderByProperties;t=d.topN;}this.getId=function(){return r;};this.setRepresentationType=function(h){a=h;};this.getRepresentationType=function(){return a;};this.setAlternateRepresentationType=function(h){b=h;};this.getAlternateRepresentationType=function(){return b;};this.getDimensions=function(){var h=[];c.getElements().forEach(function(j){h.push(j.propertyName);});return h;};this.addDimension=function(h,j){var k;if(c.getElement(h)){return null;}k={propertyName:h,textLabelKey:j};return c.createElementWithProposedId(k,h).getId();};this.removeDimension=function(h){c.removeElement(h);};this.setDimensionKind=function(h,k){var j=c.getElement(h);if(j){j.kind=k;}};this.getDimensionKind=function(h){var j=c.getElement(h);if(j){return j.kind;}return undefined;};this.setDimensionTextLabelKey=function(h,j){var k=c.getElement(h);if(k){k.textLabelKey=j;}};this.getDimensionTextLabelKey=function(h){var j=c.getElement(h);if(j){return j.textLabelKey;}return undefined;};this.setLabelDisplayOption=function(h,j){var k=c.getElement(h);if(k){k.labelDisplayOption=j;}};this.getLabelDisplayOption=function(h){var j=c.getElement(h);if(j&&j.labelDisplayOption){return j.labelDisplayOption;}return undefined;};this.getMeasures=function(){var h=[];m.getElements().forEach(function(j){h.push(j.propertyName);});return h;};this.addMeasure=function(h){var j;if(m.getElement(h)){return null;}j={propertyName:h};return m.createElementWithProposedId(j,h).getId();};this.removeMeasure=m.removeElement;this.setMeasureTextLabelKey=function(h,j){var k=m.getElement(h);if(k){k.textLabelKey=j;}};this.getMeasureTextLabelKey=function(h){var j=m.getElement(h);if(j){return j.textLabelKey;}return undefined;};this.setMeasureKind=function(h,k){var j=m.getElement(h);if(j){j.kind=k;}};this.getMeasureKind=function(h){var j=m.getElement(h);if(j){return j.kind;}return undefined;};this.setWidthProperty=function(h,j){w[h]=j;};this.getWidthProperties=function(){return w;};this.getProperties=function(){var h=[];p.getElements().forEach(function(j){h.push(j.propertyName);});return h;};this.addProperty=function(h,j){if(p.getElement(h)){return null;}return p.createElementWithProposedId({propertyName:h,textLabelKey:j},h).getId();};this.removeProperty=function(h){p.removeElement(h);};this.setPropertyKind=function(h,k){var j=p.getElement(h);if(j){j.kind=k;}};this.getPropertyKind=function(h){var j=p.getElement(h);if(j){return j.kind;}return undefined;};this.setPropertyTextLabelKey=function(h,j){var k=p.getElement(h);if(k){k.textLabelKey=j;}};this.getPropertyTextLabelKey=function(h){var j=p.getElement(h);if(j){return j.textLabelKey;}return undefined;};this.setLeftUpperCornerTextKey=function(h){l=h;};this.getLeftUpperCornerTextKey=function(){return l;};this.setRightUpperCornerTextKey=function(h){e=h;};this.getRightUpperCornerTextKey=function(){return e;};this.setLeftLowerCornerTextKey=function(h){f=h;};this.getLeftLowerCornerTextKey=function(){return f;};this.setRightLowerCornerTextKey=function(h){g=h;};this.getRightLowerCornerTextKey=function(){return g;};this.setTopN=function(h){t=h;};this.getTopN=function(){return t;};this.addOrderbySpec=function(h,j){var k;k=o.getElement(h);if(k){k.ascending=j;return k;}k={property:h,ascending:j};return o.createElementWithProposedId(k,h).getId();};this.removeOrderbySpec=function(h){o.removeElement(h);};this.removeAllOrderbySpecs=function(){var h=this.getOrderbySpecifications();h.forEach(function(j){o.removeElement(j.property);});};this.getOrderbySpecifications=function(){var h=[];o.getElements().forEach(function(j){h.push({property:j.property,ascending:j.ascending});});return h;};this.copy=function(n){var h={representationTypeId:a,alternateRepresentationTypeId:b,width:w,dimensions:c,measures:m,properties:p,leftUpperCornerTextKey:l,rightUpperCornerTextKey:e,leftLowerCornerTextKey:f,rightLowerCornerTextKey:g,orderByProperties:o,topN:t};var d=sap.apf.modeler.core.ConfigurationObjects.deepDataCopy(h);return new sap.apf.modeler.core.Representation((n||this.getId()),i,d);};};}());};if(!jQuery.sap.isDeclared('sap.apf.modeler.core.step')){jQuery.sap.declare("sap.apf.modeler.core.step");(function(){'use strict';sap.apf.modeler.core.Step=function(s,a,d){var r,b,c,f,e,g,t,n,k,h,l,j,m,o,p,q,u;u=a.instance.messageHandler;if(!d){r=new a.constructor.elementContainer(s+"-Representation",a.constructor.representation,a);b={};c=new a.constructor.elementContainer("SelectProperty",undefined,a);f=new a.constructor.elementContainer("FilterProperty",undefined,a);e={};g=new a.constructor.elementContainer("SelectPropertyForFilterMapping",undefined,a);t=new a.constructor.elementContainer("TargetPropertyForFilterMapping",undefined,a);k=false;n=new a.constructor.elementContainer("NavigationTarget",undefined,a);}else{r=d.representationContainer;b=d.request;c=d.selectProperties;f=d.filterProperties;e=d.requestForFilterMapping;g=d.selectPropertiesForFilterMapping;t=d.targetPropertiesForFilterMapping;k=d.keepSourceForFilterMapping;n=d.navigationTargets;h=d.titleId;l=d.longTitleId;j=d.leftUpperCornerTextKey;m=d.rightUpperCornerTextKey;o=d.leftLowerCornerTextKey;p=d.rightLowerCornerTextKey;q=d.topNSettings;}this.getId=function(){return s;};this.setTopN=function(i,w){if(w&&w instanceof Array&&w.length>0){this.resetTopN();q={};q.top=i;q.orderby=w;}else{u.putMessage(u.createMessageObject({code:11016}));return;}r.getElements().forEach(function(x){x.setTopN(i);q.orderby.forEach(function(w){x.addOrderbySpec(w.property,w.ascending);});});};this.setTopNValue=function(i){if(!q){q={};}q.top=i;if(q.orderby){v();}};this.setTopNSortProperties=function(i){if(!q){q={};}q.orderby=i;if(q.top){v();}};function v(){r.getElements().forEach(function(i){i.setTopN(q.top);i.removeAllOrderbySpecs();q.orderby.forEach(function(w){i.addOrderbySpec(w.property,w.ascending);});});}this.getTopN=function(){if(q&&q.top>0){if(jQuery.isArray(q.orderby)){var c=this.getSelectProperties();var i;for(i=q.orderby.length-1;i>=0;i--){if(jQuery.inArray(q.orderby[i].property,c)<0){q.orderby.splice(i,1);v();}}}return jQuery.extend({},true,q);}};this.resetTopN=function(){q=undefined;r.getElements().forEach(function(i){if(i.getTopN()){i.setTopN(undefined);}});};this.getService=function(){return b.service;};this.setService=function(i){b.service=i;};this.getEntitySet=function(){return b.entitySet;};this.setEntitySet=function(i){b.entitySet=i;};this.setTitleId=function(i){h=i;};this.getTitleId=function(){return h;};this.setLongTitleId=function(i){l=i;};this.getLongTitleId=function(){return l;};this.getSelectProperties=function(){var i=[];var w=c.getElements();w.forEach(function(x){i.push(x.getId());});return i;};this.addSelectProperty=function(i){c.createElementWithProposedId(undefined,i);};this.removeSelectProperty=function(i){c.removeElement(i);};this.getFilterProperties=function(){var i=[];var w=f.getElements();w.forEach(function(x){i.push(x.getId());});return i;};this.addFilterProperty=function(i){return f.createElementWithProposedId(undefined,i).getId();};this.removeFilterProperty=function(i){f.removeElement(i);};this.setFilterMappingService=function(i){e.service=i;};this.getFilterMappingService=function(){return e.service;};this.setFilterMappingEntitySet=function(i){e.entitySet=i;};this.getFilterMappingEntitySet=function(){return e.entitySet;};this.addFilterMappingTargetProperty=function(i){t.createElementWithProposedId(undefined,i);};this.getFilterMappingTargetProperties=function(){var i=[];var w=t.getElements();w.forEach(function(x){i.push(x.getId());});return i;};this.removeFilterMappingTargetProperty=function(i){t.removeElement(i);};this.addNavigationTarget=function(i){n.createElementWithProposedId(undefined,i);};this.getNavigationTargets=function(){var i=[];var w=n.getElements();w.forEach(function(x){i.push(x.getId());});return i;};this.removeNavigationTarget=function(i){n.removeElement(i);};this.setFilterMappingKeepSource=function(i){k=i;};this.getFilterMappingKeepSource=function(){return k;};this.getRepresentations=r.getElements;this.getRepresentation=r.getElement;this.createRepresentation=function(i){var w=r.createElement(i);if(q&&q.top){w.setTopN(q.top);q.orderby.forEach(function(x){w.addOrderbySpec(x.property,x.ascending);});}return w;};this.removeRepresentation=r.removeElement;this.copyRepresentation=r.copyElement;this.moveRepresentationBefore=function(i,w){return r.moveBefore(i,w);};this.moveRepresentationUpOrDown=function(i,w){return r.moveUpOrDown(i,w);};this.moveRepresentationToEnd=function(i){return r.moveToEnd(i);};this.setLeftUpperCornerTextKey=function(i){j=i;};this.getLeftUpperCornerTextKey=function(){return j;};this.setRightUpperCornerTextKey=function(i){m=i;};this.getRightUpperCornerTextKey=function(){return m;};this.setLeftLowerCornerTextKey=function(i){o=i;};this.getLeftLowerCornerTextKey=function(){return o;};this.setRightLowerCornerTextKey=function(i){p=i;};this.getRightLowerCornerTextKey=function(){return p;};this.copy=function(i){var w={request:b,selectProperties:c,filterProperties:f,requestForFilterMapping:e,selectPropertiesForFilterMapping:g,targetPropertiesForFilterMapping:t,navigationTargets:n,keepSourceForFilterMapping:k,titleId:h,longTitleId:l,leftUpperCornerTextKey:j,rightUpperCornerTextKey:m,leftLowerCornerTextKey:o,rightLowerCornerTextKey:p,topNSettings:q};var d=sap.apf.modeler.core.ConfigurationObjects.deepDataCopy(w);d.representationContainer=r.copy(i+"-Representation");return new sap.apf.modeler.core.Step((i||this.getId()),a,d);};};}());};if(!jQuery.sap.isDeclared('sap.apf.modeler.core.textHandler')){jQuery.sap.declare("sap.apf.modeler.core.textHandler");(function(){'use strict';sap.apf.modeler.core.TextHandler=function(){var b,B;this.getMessageText=function(r,p){return this.getText(r,p);};this.getText=function(r,p){var t;t=B.getText(r,p);if(t!==r){return t;}return b.getText(r,p);};function i(){var u;var I=sap.ui.getCore().getConfiguration().getOriginInfo();var m=jQuery.sap.getModulePath("sap.apf");u=m+'/modeler/resources/i18n/texts.properties';B=jQuery.sap.resources({url:u,includeInfo:I});u=m+'/resources/i18n/apfUi.properties';b=jQuery.sap.resources({url:u,includeInfo:I});}i();};}());};if(!jQuery.sap.isDeclared('sap.apf.modeler.ui.controller.catalogService.controller')){
/*!
 * SAP APF Analysis Path Framework
 *
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
jQuery.sap.declare('sap.apf.modeler.ui.controller.catalogService.controller');jQuery.sap.require('sap.ui.core.mvc.Controller');jQuery.sap.require('sap.ui.model.Filter');jQuery.sap.require('sap.ui.model.FilterOperator');sap.ui.define("sap/apf/modeler/ui/controller/catalogService.controller",["sap/ui/core/mvc/Controller","sap/ui/model/Filter","sap/ui/model/FilterOperator"],function(C,F,a){"use strict";function _(c){var s=c.getView().getViewData().getCalatogServiceUri();return new sap.ui.model.odata.ODataModel(s,true);}function b(c){var t=c.getView().getViewData().oTextReader;var s=c.byId("idGatewayCatalogListDialog");s.setTitle(t("selectService"));s.setNoDataText(t("noDataText"));}return C.extend("sap.apf.modeler.ui.controller.catalogService",{handleSearch:function(e){var c=this;var s=e.getParameter("value").trim();var u=s.toUpperCase();var l=s.toLowerCase();var f=[new F("TechnicalServiceName",a.Contains,u),new F("TechnicalServiceName",a.Contains,l)];var o=new F(f,false);var S=c.byId("idGatewayCatalogListDialog");S.getBinding("items").filter(o);},onInit:function(){var c=this;var d=_(c);var s=c.byId("idGatewayCatalogListDialog");b(c);s.setModel(d);s.open();},handleConfirm:function(e){var c=this,s=e.getParameter('selectedItem').getProperty('title');var S=c.byId("idGatewayCatalogListDialog");var p=c.getView().getViewData().parentControl;S.getBinding("items").filter([]);p.fireEvent("selectService",[s]);c.byId("idGatewayCatalogListDialog").destroy();c.getView().destroy();},handleCancel:function(){var c=this;c.byId("idGatewayCatalogListDialog").destroy();c.getView().destroy();},handleFormatting:function(s){var c,S=s.split("/");c=(S.indexOf(jQuery(location)[0].host)+1);return('/'+S.slice(c,S.length).join("/"));}});});};if(!jQuery.sap.isDeclared('sap.apf.modeler.ui.utils.APFRouter')){
/*!
 * SAP APF Analysis Path Framework
 *
 * (c) Copyright 2012-2014 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.apf.modeler.ui.utils.APFRouter');sap.apf.modeler.ui.utils.APFRouter={patternMatch:function(c){this.params={};var s=this;sap.ui.core.UIComponent.getRouterFor(c).attachRoutePatternMatched(function(e){s.params={name:e.getParameter("name"),arguments:e.getParameter("arguments")};if(s.params.name!=="applicationList"){var C=c.oCoreApi;c.appId=s.params.arguments.appId;c.configId=s.params.arguments.configId;C.getApplicationHandler(function(a){c.applicationHandler=a;c.appName=a.getApplication(c.appId).ApplicationName;var t=c.byId("idConfigTitleMaster").getText();if(t===""||s.params.name==="configurationList"){c.setConfigListMasterTitle(c.appName);c.oTreeInstance.setApplicationId(s.params.arguments.appId);}C.getConfigurationHandler(c.appId,function(b){c.configurationHandler=b;c.oTextPool=c.configurationHandler.getTextPool();if(c.configurationHandler.getList().length>c.getView().getModel().getData().aConfigDetails.length){c.createConfigList();if(s.params.name==="configurationList"){c.updateConfigListView();}}if(c.configurationHandler.getList().length===0&&(c.configId===undefined)){c.oTreeInstance.addNodeInTree(sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION);var d=c.oTreeInstance.getNodes();var n=d[d.length-1];c.oTreeInstance.setSelectedNode(n);}if(c.configId!==undefined){var E=b.getConfiguration(c.configId);if(E){b.loadConfiguration(c.configId,function(f){c.configEditor=f;var p=c.getSPathForConfig(c.configId);if(c.oModel.getData().aConfigDetails[p.split('/')[2]].bIsLoaded===false){c.updateTree();if(s.params.name!=="navigationTarget"){s.setCurrentSelectionState(s.params,c);}}else{s.setCurrentSelectionState(s.params,c);}});}else{s.setCurrentSelectionState(s.params,c);}}});});}});},setCurrentSelectionState:function(p,c){var v=c.getSPathFromURL(p);if(p.name!=="configurationList"){if(v&&v.objectType){c.updateSubView(p);if(v.sPath){c.setSelectionOnTree(v.sPath);}c.updateTitleAndBreadCrumb();}else{c.showNoConfigSelectedText();c.removeSelectionOnTree();}}}};};if(!jQuery.sap.isDeclared('sap.apf.modeler.ui.utils.constants')){
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
jQuery.sap.declare('sap.apf.modeler.ui.utils.constants');sap.apf.modeler.ui.utils.CONSTANTS={configurationObjectTypes:{CONFIGURATION:"configuration",FACETFILTER:"facetFilter",CATEGORY:"category",STEP:"step",REPRESENTATION:"representation",NAVIGATIONTARGET:"navigationTarget",ISNEWCONFIG:"apf1972-"}};};if(!jQuery.sap.isDeclared('sap.apf.modeler.ui.utils.helper')){
/*!
 * SAP APF Analysis Path Framework
 *
 * (c) Copyright 2012-2014 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.apf.modeler.ui.utils.helper');sap.apf.modeler.ui.utils.helper={onResize:function(c){jQuery(window).resize(function(){c();});},applySize:function(w,h,c,o){var a,b;if(h!==undefined){if(h.getDomRef!==undefined){b=jQuery(h.getDomRef()).height();}else if(jQuery.isNumeric(h)){b=h;}else{b=jQuery(h).height();}}if(w!==undefined){if(w.getDomRef!==undefined){a=jQuery(h.getDomRef()).width();}else if(jQuery.isNumeric(w)){a=w;}else{b=jQuery(w).width();}}var d=(c.getDomRef!==undefined)?jQuery(c.getDomRef()):jQuery(c);var e=(o===undefined)?0:(o.offsetHeight||0);var f=(o===undefined)?0:(o.offsetWidth||0);d.css({height:(h===undefined)?"100%":b+e+"px",width:(w===undefined)?"100%":a+f+"px"});}};};if(!jQuery.sap.isDeclared('sap.apf.modeler.ui.utils.navigationHandler')){jQuery.sap.declare('sap.apf.modeler.ui.utils.navigationHandler');sap.apf.modeler.ui.utils.navigationHandler=(function(){var i,d={};var t=function(l,m){b(l,{isSwitchConfiguration:true},m);};var a=function(l,m){_(l,{isValidationCheck:true},m);};var _=function(l,s,m){var C=l.oCoreApi;var n=C.getText("mandatoryField");var o=Object.keys(s)[0];var p={_handleValidationNavigation:f,_handlePreventNavigation:j,configListInstance:l,callback:m};p[o]=s[o];d.oConfirmValidationDialog=sap.ui.xmlfragment("idMandatoryValidationDialogFragement","sap.apf.modeler.ui.fragment.mandatoryDialog",p);l.getView().addDependent(d.oConfirmValidationDialog);e(C,"validationDialog");var v=new sap.m.Label();v.addStyleClass("dialogText");v.setText(n);d.oConfirmValidationDialog.removeAllContent();d.oConfirmValidationDialog.addContent(v);d.oConfirmValidationDialog.attachAfterClose(function(){d.oConfirmValidationDialog.destroy();});d.oConfirmValidationDialog.open();};var b=function(l,s,m){var C=l.oCoreApi;var n=C.getText("unsavedConfiguration");var o=Object.keys(s)[0];var p={_handleNavigationWithSave:g,_handleNavigateWithoutSave:h,_handlePreventNavigation:j,configListInstance:l,callback:m};p[o]=s[o];d.oConfirmNavigationDialog=sap.ui.xmlfragment("idMessageDialogFragment","sap.apf.modeler.ui.fragment.messageDialog",p);l.getView().addDependent(d.oConfirmNavigationDialog);e(C,"naviagtionDialog");var q=new sap.m.Label();q.addStyleClass("dialogText");q.setText(n);d.oConfirmNavigationDialog.removeAllContent();d.oConfirmNavigationDialog.addContent(q);d.oConfirmNavigationDialog.attachAfterClose(function(){d.oConfirmNavigationDialog.destroy();});d.oConfirmNavigationDialog.open();};var c=function(d){d.close();};var e=function(C,l){if(l==="naviagtionDialog"){sap.ui.core.Fragment.byId("idMessageDialogFragment","idMessageDialog").setTitle(C.getText("warning"));sap.ui.core.Fragment.byId("idMessageDialogFragment","idYesButton").setText(C.getText("yes"));sap.ui.core.Fragment.byId("idMessageDialogFragment","idNoButton").setText(C.getText("no"));sap.ui.core.Fragment.byId("idMessageDialogFragment","idCancelButton").setText(C.getText("cancel"));}else if(l==="validationDialog"){sap.ui.core.Fragment.byId("idMandatoryValidationDialogFragement","idMandatoryValidationDialog").setTitle(C.getText("warning"));sap.ui.core.Fragment.byId("idMandatoryValidationDialogFragement","idYesButton").setText(C.getText("yes"));sap.ui.core.Fragment.byId("idMandatoryValidationDialogFragement","idNoButton").setText(C.getText("no"));}};var f=function(){var l=this.callback;c(d.oConfirmValidationDialog);if(typeof l.yes==="function"){l.yes();}};var g=function(){var l=this.configListInstance;var m=this.callback;var s=function(m){l.configEditor.save(function(n,o,p){l.configId=n;l.configurationHandler.memorizeConfiguration(n);if(p===undefined){if(typeof m==="function"){m();}var q=l.oCoreApi.getText("successOnSave");sap.m.MessageToast.show(q,{width:"20em"});}else{var M=l.oCoreApi.createMessageObject({code:"12000"});M.setPrevious(p);l.oCoreApi.putMessage(M);var r=l.oCoreApi.getText("errorOnSave");sap.m.MessageToast.show(r,{width:"20em"});}});};c(d.oConfirmNavigationDialog);if(typeof m.yes==="function"){m.yes(s);}};var h=function(){var l=this.configListInstance;var m=this.callback;c(d.oConfirmNavigationDialog);l.configurationHandler.resetConfiguration(l.configId);if(typeof m.no==="function"){m.no();}};var j=function(){var l=this.isValidationCheck;var m=this.callback;if(!l){c(d.oConfirmNavigationDialog);}else{c(d.oConfirmValidationDialog);}if(typeof m.cancel==="function"){m.cancel();}else if(typeof m.no==="function"&&l){m.no();}};var k=function(){return{throwLossOfDataPopup:t,throwMandatoryPopup:a};};return{getInstance:function(){return i||(i=k());}};}());};if(!jQuery.sap.isDeclared('sap.apf.modeler.ui.utils.nullObjectChecker')){
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
jQuery.sap.declare('sap.apf.modeler.ui.utils.nullObjectChecker');(function(){'use strict';sap.apf.modeler.ui.utils.NullObjectChecker=function(){sap.apf.modeler.ui.utils.NullObjectChecker.prototype.checkIsNotUndefined=function(o){if(o===undefined){return false;}return true;};sap.apf.modeler.ui.utils.NullObjectChecker.prototype.checkIsNotNull=function(o){if(o===null){return false;}return true;};sap.apf.modeler.ui.utils.NullObjectChecker.prototype.checkIsNotBlank=function(o){if((o instanceof Array)&&o.length===0){return false;}if((o instanceof Object)&&(Object.keys(o).length===0)){return false;}if(o===""){return false;}return true;};sap.apf.modeler.ui.utils.NullObjectChecker.prototype.checkIsNotNullOrBlank=function(o){return(this.checkIsNotNull(o)&&this.checkIsNotBlank(o));};sap.apf.modeler.ui.utils.NullObjectChecker.prototype.checkIsNotNullOrUndefined=function(o){return(this.checkIsNotNull(o)&&this.checkIsNotUndefined(o));};sap.apf.modeler.ui.utils.NullObjectChecker.prototype.checkIsNotUndefinedOrBlank=function(o){return(this.checkIsNotUndefined(o)&&this.checkIsNotBlank(o));};sap.apf.modeler.ui.utils.NullObjectChecker.prototype.checkIsNotNullOrUndefinedOrBlank=function(o){return(this.checkIsNotNull(o)&&this.checkIsNotUndefined(o)&&this.checkIsNotBlank(o));};};})();};if(!jQuery.sap.isDeclared('sap.apf.modeler.ui.utils.optionsValueModelBuilder')){jQuery.sap.declare('sap.apf.modeler.ui.utils.optionsValueModelBuilder');(function(){'use strict';sap.apf.modeler.ui.utils.OptionsValueModelBuilder=function(){var D=500;var n=new sap.apf.modeler.ui.utils.NullObjectChecker();sap.apf.modeler.ui.utils.OptionsValueModelBuilder.prototype.prepareModel=function(o,l){var m;if(!n.checkIsNotNullOrUndefined(l)){l=D;}m=new sap.ui.model.json.JSONModel();m.setSizeLimit(l);m.setData({Objects:o});return m;};sap.apf.modeler.ui.utils.OptionsValueModelBuilder.prototype.convert=function(a,l){var o=[],b;if(!n.checkIsNotNullOrUndefinedOrBlank(a)){return;}a.forEach(function(v){if(!n.checkIsNotNullOrUndefined(v)){return;}b={};b.key=v;b.name=v;o.push(b);});return sap.apf.modeler.ui.utils.OptionsValueModelBuilder.prototype.prepareModel(o,l);};};})();};if(!jQuery.sap.isDeclared('sap.apf.modeler.ui.utils.staticValuesBuilder')){jQuery.sap.declare('sap.apf.modeler.ui.utils.staticValuesBuilder');(function(){'use strict';sap.apf.modeler.ui.utils.staticValuesBuilder=function(t){sap.apf.modeler.ui.utils.staticValuesBuilder.prototype.getNavTargetTypeData=function(){var a=[t("globalNavTargets"),t("stepSpecific")];return a;};};})();};if(!jQuery.sap.isDeclared('sap.apf.modeler.ui.utils.textPoolHelper')){jQuery.sap.declare('sap.apf.modeler.ui.utils.textPoolHelper');sap.apf.modeler.ui.utils.TextPoolHelper=function(t){this.oTextPool=t;};sap.apf.modeler.ui.utils.TextPoolHelper.prototype={setAutoCompleteOn:function(i,d){i.setShowSuggestion(true);var s=[];if(d.type==="text"){var e=this._getSuggestionItems(d.oTranslationFormat);e.forEach(function(t){var o={};o.suggetionText=t.TextElementDescription;s.push(o);});}else if(d.type==="service"){var E=d.oConfigurationEditor.getAllServices();E.forEach(function(a){var o={};o.suggetionText=a;s.push(o);});}var I=i.getModel();var m=I||new sap.ui.model.json.JSONModel({});if(!m.getData().suggestions){m.getData().suggestions=s;}if(!I){i.setModel(m);}i.bindAggregation("suggestionItems",{path:"/suggestions",template:new sap.ui.core.Item({text:"{suggetionText}"})});i.attachSuggest(this._handleSuggestion);},_handleSuggestion:function(e){var v=e.getParameter("suggestValue");var f=new sap.ui.model.Filter("suggetionText",sap.ui.model.FilterOperator.Contains,v);e.getSource().getBinding("suggestionItems").filter([f]);},_getSuggestionItems:function(t){return this.oTextPool.getTextsByTypeAndLength(t.TextElementType,t.MaximumLength);}};sap.apf.modeler.ui.utils.TranslationFormatMap={APPLICATION_TITLE:{TextElementType:"XTIT",MaximumLength:250},CATEGORY_TITLE:{TextElementType:"XTIT",MaximumLength:60},FACETFILTER_LABEL:{TextElementType:"XFLD",MaximumLength:50},STEP_TITLE:{TextElementType:"XTIT",MaximumLength:100},STEP_LONG_TITLE:{TextElementType:"XTIT",MaximumLength:200},STEP_CORNER_TEXT:{TextElementType:"XFLD",MaximumLength:25},REPRESENTATION_LABEL:{TextElementType:"XTIT",MaximumLength:80},REPRESENTATION_CORNER_TEXT:{TextElementType:"XFLD",MaximumLength:25}};};if(!jQuery.sap.isDeclared('sap.apf.modeler.ui.utils.viewValidator')){jQuery.sap.declare('sap.apf.modeler.ui.utils.viewValidator');(function(){'use strict';var n=new sap.apf.modeler.ui.utils.NullObjectChecker();sap.apf.modeler.ui.utils.ViewValidator=function(v){this.aFieldIds=[];this.oView=v;};sap.apf.modeler.ui.utils.ViewValidator.prototype.constructor=sap.apf.modeler.ui.utils.ViewValidator;function s(f){var i=true;if((typeof f)!=='string'){i=false;}return i;}function c(C,f){var i=true;if(!C.oView.byId(f)){i=false;}return i;}sap.apf.modeler.ui.utils.ViewValidator.prototype.addFields=function(f){if(!n.checkIsNotNullOrUndefinedOrBlank(f)){return;}var a,l=f.length;for(a=0;a<l;a++){if(s(f[a])&&c(this,f[a])&&this.aFieldIds.indexOf(f[a])===-1){this.aFieldIds.push(f[a]);}}};sap.apf.modeler.ui.utils.ViewValidator.prototype.addField=function(f){if(!n.checkIsNotNullOrUndefinedOrBlank(f)){return;}if(s(f)&&c(this,f)&&this.aFieldIds.indexOf(f)===-1){this.aFieldIds.push(f);}};sap.apf.modeler.ui.utils.ViewValidator.prototype.removeFields=function(f){var i=-1;var a,l=f.length;if(n.checkIsNotNullOrUndefinedOrBlank(f)===false){return;}if(n.checkIsNotNullOrUndefinedOrBlank(this.aFieldIds)===false){return;}for(a=0;a<l;a++){i=this.aFieldIds.indexOf(f[a]);if(s(f[a])&&c(this,f[a])&&i!==-1){this.aFieldIds.splice(i,1);}}};sap.apf.modeler.ui.utils.ViewValidator.prototype.removeField=function(f){var i=-1;if(n.checkIsNotNullOrUndefinedOrBlank(f)===false){return;}if(n.checkIsNotNullOrUndefinedOrBlank(this.aFieldIds)===false){return;}i=this.aFieldIds.indexOf(f);if(s(f)&&c(this,f)&&i!==-1){this.aFieldIds.splice(i,1);}};sap.apf.modeler.ui.utils.ViewValidator.prototype.getFields=function(){return this.aFieldIds;};sap.apf.modeler.ui.utils.ViewValidator.prototype.getView=function(){return this.oView;};sap.apf.modeler.ui.utils.ViewValidator.prototype.clearFields=function(){var l=this.aFieldIds.length;this.aFieldIds.splice(0,l);};sap.apf.modeler.ui.utils.ViewValidator.prototype.getValidationState=function(){var v=true,i;for(i=0;i<this.aFieldIds.length;i++){if(this.oView.byId(this.aFieldIds[i])instanceof sap.m.MultiComboBox){v=(this.oView.byId(this.aFieldIds[i]).getSelectedKeys().length>=1)?true:false;}else if(this.oView.byId(this.aFieldIds[i])instanceof sap.m.Input){if(this.oView.byId(this.aFieldIds[i])instanceof sap.m.MultiInput){v=(this.oView.byId(this.aFieldIds[i]).getTokens().length>=1)?true:false;}else{v=(this.oView.byId(this.aFieldIds[i]).getValue().trim()!=="")?true:false;}}else if(this.oView.byId(this.aFieldIds[i])instanceof sap.m.ComboBox){v=(this.oView.byId(this.aFieldIds[i]).getValue().trim()!=="")?true:false;}else if(this.oView.byId(this.aFieldIds[i])instanceof sap.m.Select){v=(this.oView.byId(this.aFieldIds[i]).getSelectedKey().length>=1)?true:false;}if(v===false){break;}}return v;};})();};if(!jQuery.sap.isDeclared('sap.apf.ui.controls.draggableCarousel.DraggableCarousel')){jQuery.sap.declare("sap.apf.ui.controls.draggableCarousel.DraggableCarousel");(function(u){"use strict";var a,b;var d=(function(){var i=navigator.maxTouchPoints;var c='ontouchstart'in window?true:false;a=c||i;if('onclick'in window){b=true;}})();sap.apf.ui.controls.draggableCarousel.DraggableCarousel=function(o){var c=o||{};this.eleRefs={blocks:[],containerEle:o.containerEle};this._editState=c.editable===u?true:c.editable;this._dragState=this._editState;this._removeState=this._editState;this.styles={containerHeight:c.containerHeight,containerWidth:c.containerWidth,blockHeight:c.blockHeight,blockWidth:c.blockWidth,blockMargin:c.blockMargin,separatorHeight:c.separatorHeight,removeIconHeight:c.removeIconHeight};this.elems={separator:c.separator,removeIcon:c.removeIcon};this.callbacks={onBeforeDrag:c.onBeforeDrag,onAfterDrop:c.onAfterDrop,onAfterRemove:c.onAfterRemove,onAfterSelect:c.onAfterSelect};this.eleRefs.containerEle=this._drawSkeleton();this._initDimensions();this._isMouseDown=false;};sap.apf.ui.controls.draggableCarousel.DraggableCarousel.prototype={_initDimensions:function(){var m=this.styles.blockMargin;this._blockMargin=parseInt(m.replace("px"),10);var B=this.styles.blockHeight;this._blockHeight=parseInt(B.replace("px"),10);this._blockTotalHeight=this._blockHeight+(2*this._blockMargin);this._separatorHeight=0;if(this.elems.separator!==u){var s=this.styles.separatorHeight;this._separatorHeight=parseInt(s.replace("px"),10);}this._mFactor=this._blockTotalHeight+this._separatorHeight;},_drawSkeleton:function(){var c;if(this.eleRefs.containerEle===u){c=document.createElement('div');}else{c=this.eleRefs.containerEle;}c.style.cssText+=this._getContainerStyles();c.classList.add('DnD-container');var s=this;var t=function(e){s._onMouseUp(e,s);};if(a){document.addEventListener("touchend",t);}if(b){document.addEventListener("mouseup",t);}return c;},_getBlockWrapper:function(c){var f=c.blockElement;var g=this.eleRefs.blocks;var h=c.dragState===u?true:c.dragState;var i=c.dropState===u?true:c.dropState;var r=c.removable===u?true:c.removable;var j=document.createElement('div');j.style.cssText+=this._getBlockStyles();j.setAttribute('class','DnD-block');j.setAttribute('drag-state',h);j.setAttribute('drop-state',i);if(r){var k=this._getRemoveIconEle();j.appendChild(k);}var s=this;var t=function(e){s._onMouseDown(e,s,this);};if(a){j.addEventListener("touchstart",t);}if(b){j.addEventListener("mousedown",t);}var l=function(e){window.clearTimeout(s._TIMEOUTID);};if(a){j.addEventListener("touchmove",l);}if(b){j.addEventListener("mousemove",l);}this._keypress(j,13,function(m,e){var n=g.indexOf(m);s.callbacks.onAfterSelect.apply(m,[n]);});this._keypress(j,32,function(m,e){var n=g.indexOf(m);s.callbacks.onAfterSelect.apply(m,[n]);});this._keypress(j,36,function(m,e){jQuery(g).removeAttr("tabindex");jQuery(g).attr("tabindex",-1);jQuery(g[0]).attr("tabindex",0);jQuery(g[0]).focus();});this._keypress(j,35,function(m,e){jQuery(g).removeAttr("tabindex");jQuery(g).attr("tabindex",-1);jQuery(g[g.length-1]).attr("tabindex",0);jQuery(g[g.length-1]).focus();});if(r===true){this._keypress(j,46,function(m,e){var n=g.indexOf(m);s.removeBlock(n,s.callbacks.onAfterRemove);s._grouping(g);jQuery(g).parent().wrap("<div>").find("[tabindex='0']").focus();});}j.appendChild(f);return j;},_getSeparatorEle:function(){var s=document.createElement('div');s.style.cssText+=this._getSeparatorStyles();s.setAttribute('class','DnD-separator');s.innerHTML=this.elems.separator.outerHTML;return s;},_getRemoveIconEle:function(){var r=this.elems.removeIcon;var c=document.createElement('div');c.style.cssText+=this._getRemoveIconStyles();c.setAttribute('class','DnD-removeIconWrapper');c.innerHTML=r.outerHTML;var s=this;var t=function(e){s._onRemoveBlock(e,s,this);};if(a){c.addEventListener("touchstart",t);}if(b){c.addEventListener("mousedown",t);}return c;},addBlock:function(c){if(c instanceof Array){var i;for(i=0;i<c.length;i++){this.addBlock(c[i]);}return;}var e=this._getBlockWrapper(c);var f=this.eleRefs.blocks.length;var g=this.eleRefs.blocks;var y=f*this._mFactor;e.style.cssText=e.style.cssText+this._getTransformCss(y);this.eleRefs.blocks.push(e);var h=this.eleRefs.containerEle;h.appendChild(e);this._setHorizontalBlockMargin();if(this.elems.separator!==u){var s=this._getSeparatorEle();var j=y+this._blockHeight+2*this._blockMargin;s.style.cssText=s.style.cssText+this._getTransformCss(j);h.appendChild(s);}this._grouping(g);},swapBlocks:function(f,t){var c=this.eleRefs.blocks[f];var e=this.eleRefs.blocks[t];if((c.getAttribute('drag-state')!=="true"&&c.getAttribute('drop-state')!=="true")||(e.getAttribute('drag-state')!=="true"&&e.getAttribute('drop-state')!=="true")){return false;}var g=f*this._mFactor;var h=t*this._mFactor;var i=h;var j=i+this._blockHeight+(2*this._blockMargin);var k=document.getElementsByClassName('scrollContainerEle')[0]?document.getElementsByClassName('scrollContainerEle')[0]:this.eleRefs.containerEle;var s=k.scrollTop;if((f>t)&&i<k.scrollTop){s=i;}if((f<t)&&j-k.offsetHeight>k.scrollTop){s=j-k.offsetHeight;}var p;var l=40;var m=window.setInterval(function(){k.scrollTop+=(s-k.scrollTop)/l;if(k.scrollTop===p){window.clearInterval(m);}p=k.scrollTop;},1000/60);this._setTransformYValue(c,h);this._setTransformYValue(e,g);this._swapArray(this.eleRefs.blocks,f,t);return true;},insertBlock:function(c,e){var f=this.eleRefs.blocks;f.push({});var i;for(i=f.length-1;i>e;i--){f[i]=f[i-1];var g=i*this._mFactor;this._setTransformYValue(f[i],g);}var h=this._getBlockWrapper(c);f[i]=h;var y=e*this._mFactor;h.style.cssText=h.style.cssText+this._getTransformCss(y);var j=this.eleRefs.containerEle;j.appendChild(h);this._setHorizontalBlockMargin();if(this.elems.separator!==u){var s=this._getSeparatorEle();var k=y+this._blockHeight+2*this._blockMargin;s.style.cssText=s.style.cssText+this._getTransformCss(k);j.appendChild(s);}this._grouping(f);},removeBlock:function(c,e){var f=this.eleRefs.blocks;var g=this.eleRefs.containerEle;var i;var r=f[c];g.removeChild(r);for(i=c;i<f.length-1;i++){f[i]=f[i+1];var y=i*this._mFactor;this._setTransformYValue(f[i],y);}f.pop();if(this.elems.separator!==u){var s=g.querySelectorAll('.DnD-separator');var l=s[s.length-1];g.removeChild(l);}e.apply(g,[c]);this._grouping(f);},placeAt:function(i){var e=document.getElementById(i);e.appendChild(this.eleRefs.containerEle);this._setHorizontalBlockMargin();},getEditable:function(){return this._editState;},setEditable:function(e){this._editState=e;this._setDragState(e);this._setRemoveState(e);},_setDragState:function(c){this._dragState=c;},_setRemoveState:function(r){this._removeState=r;var c=this.eleRefs.containerEle.querySelectorAll('.DnD-removeIconWrapper');var e;if(r){e="display : block";}else{e="display : none";}var i;for(i=0;i<c.length;i++){c[i].style.cssText+=e;}},_getContainerStyles:function(){var s=["height : ",this.styles.containerHeight,";width : ",this.styles.containerWidth,"; position : relative"].join("");return s;},_getBlockStyles:function(){if(this.styles.horizontalBlockMargin===u){var c=this.eleRefs.containerEle.clientWidth;var e=this.eleRefs.blocks[0]===u?0:this.eleRefs.blocks[0].clientWidth;this.styles.horizontalBlockMargin=((c-e)/2)+"px";}var s=["height : ",this.styles.blockHeight,";width : ",this.styles.blockWidth,";margin : ",this.styles.blockMargin," ",this.styles.horizontalBlockMargin,";position : absolute"].join("");return s;},_getSeparatorStyles:function(){var s=["height : ",this.styles.separatorHeight,";width : 100%",";position : absolute"].join("");return s;},_getRemoveIconStyles:function(){var s=["height : ",this.styles.removeIconHeight,";width : ",this.styles.removeIconHeight,";float : right",";margin : -10px -13px -10px 0",";z-index : 2",";position : relative",";cursor : pointer"].join("");if(this._removeState){s+=";display : block";}else{s+=";display : none";}return s;},_getTransformCss:function(y){var Y=y+"px";var t=["transform","-webkit-transform","-moz-transform","-ms-transform","-o-transform"];var c="";var i;for(i=0;i<t.length;i++){c+=t[i]+": translate3d(0px,"+Y+", 0px); ";}return c;},_setTransformYValue:function(e,y){var v=[{"WebkitTransform":"-webkit-transform"},{"MozTransform":"-moz-transform"},{"MsTransform":"-ms-transform"},{"OTransform":"-o-transform"}];var t="transform";var i;for(i=0;i<v.length;i++){if(e.style.hasOwnProperty(Object.keys(v[i])[0])){t=v[i][Object.keys(v[i])[0]];}}var Y=y+'px';e.style.cssText=e.style.cssText+" "+t+": translate3d(0px,"+Y+", 0px);";},_setHorizontalBlockMargin:function(){var c=this.eleRefs.blocks;var e=this.eleRefs.containerEle;var f=c[0]===u?0:jQuery(c[0]).width();var g=jQuery(e).width();this.styles.horizontalBlockMargin=((g-f)/2)+"px";var m=this.styles.horizontalBlockMargin;[].forEach.call(c,function(h){h.style.cssText+="margin-right : "+m+";margin-left : "+m;});},_onMouseDown:function(e,c,f){c._isMouseDown=true;c._TIMEOUTID=window.setTimeout(function(){if(c._isMouseDown){c._onDragStart(e,c,f);}},500);},_onMouseUp:function(e,c){c._isMouseDown=false;if(c._dragEle!==u&&c._dragEle.ele!==u){c._onDrop(e,c);}},_onDragStart:function(e,c,f){if(!c._dragState||f.getAttribute('drag-state')!=='true'){return;}c._dragIndex=c.eleRefs.blocks.indexOf(f);var y=c._dragIndex*c._mFactor;var g=document.getElementsByClassName('scrollContainerEle')[0]?document.getElementsByClassName('scrollContainerEle')[0]:c.eleRefs.containerEle;c._containerEleOffsetHeight=g.offsetHeight;c._containerEleScrollHeight=g.scrollHeight;c._blockEleOffsetHeight=f.offsetHeight;c._containerEleScrollTop=g.scrollTop;var h=y+c._blockMargin;var i=h+c._blockHeight;if(h<c._containerEleScrollTop){g.scrollTop=h;c._containerEleScrollTop=Math.max(0,h);}if(i-c._containerEleOffsetHeight>g.scrollTop){g.scrollTop=i-c._containerEleOffsetHeight;c._containerEleScrollTop=Math.min(c._containerEleScrollHeight-c._containerEleOffsetHeight,i-c._containerEleOffsetHeight);}c._diffTop=e.pageY-y+c._containerEleScrollTop;c._dragEle={ele:f,pos:{y:y}};c.callbacks.onBeforeDrag.apply(f,[c._dragIndex]);c._dragEle.ele.className=c._dragEle.ele.className+" "+"DnD-drag";var t=function(e){if(c._dragEle.ele!==u){e.preventDefault();c._onDrag(e,c);e.stopPropagation();}};if(a){document.addEventListener("touchmove",t);}if(b){document.addEventListener("mousemove",t);}},_onDrag:function(e,c){var f=document.getElementsByClassName('scrollContainerEle')[0]?document.getElementsByClassName('scrollContainerEle')[0]:c.eleRefs.containerEle;var y=e.pageY-c._diffTop+c._containerEleScrollTop;var g=y+c._blockMargin;var h=g+c._blockHeight;var j=((e.pageY-c._diffTop)>c._prevPageY);var k=((e.pageY-c._diffTop)<c._prevPageY);c._prevPageY=(e.pageY-c._diffTop);if(k&&(g<c._containerEleScrollTop)){f.scrollTop=g;c._containerEleScrollTop=Math.max(0,g);y=e.pageY-c._diffTop+c._containerEleScrollTop;}if(j&&((h-c._containerEleOffsetHeight)>c._containerEleScrollTop)){f.scrollTop=h-c._containerEleOffsetHeight;c._containerEleScrollTop=Math.min(c._containerEleScrollHeight-c._containerEleOffsetHeight,h-c._containerEleOffsetHeight);y=e.pageY-c._diffTop+c._containerEleScrollTop;}c._setTransformYValue(c._dragEle.ele,y);var l=y;var m=y+c._blockEleOffsetHeight;var n=c._dragEle.pos.y-(c._mFactor-(c._blockHeight/2));var o=(c._dragEle.pos.y+c._blockEleOffsetHeight)+(c._mFactor-(c._blockHeight/2));var p=c._dragEle.pos.y;var q=p/(c._mFactor);var r=c.eleRefs.blocks;var s=-1,t=r.length;var i,v;for(i=q-1;i>=0;i--){v=r[i];if(v.getAttribute('drop-state')==='true'){s=i;break;}}for(i=q+1;i<r.length;i++){v=r[i];if(v.getAttribute('drop-state')==='true'){t=i;break;}}n=c._dragEle.pos.y-((q-s)*c._mFactor-(c._blockHeight/2));o=(c._dragEle.pos.y+c._blockEleOffsetHeight)+((t-q)*c._mFactor-(c._blockHeight/2));var w;var S=false;if(l<n){S=true;w=s;}else if(m>o){S=true;w=t;}if(S&&(w>=0)&&(w<=r.length-1)){c._dragEle.pos.y=w*(c._mFactor);var x=r[w];if(x!==u){c._setTransformYValue(x,p);c._swapArray(r,q,w);}}},_onDrop:function(e,c){c._dragEle.ele.className=c._dragEle.ele.className.replace(" DnD-drag","");var f=c.eleRefs.containerEle.querySelectorAll('.DnD-drag');var i;for(i=0;i<f.length;i++){f[i].className=f[i].className.replace(" DnD-drag","");}var g=c._dragEle.pos.y;c._dropIndex=g/(c._mFactor);c._setTransformYValue(c._dragEle.ele,g);c.callbacks.onAfterDrop.apply(c._dragEle.ele,[c._dragIndex,c._dropIndex]);c._dragEle={};},_onRemoveBlock:function(e,c,r){e.stopPropagation();var f=r.parentElement;var g=c.eleRefs.blocks.indexOf(f);c.removeBlock(g,c.callbacks.onAfterRemove);},_swapArray:function(c,f,t){var e=c[f];c[f]=c[t];c[t]=e;return c;},_grouping:function(c){var f=c;var g=(c.length>2)?c.length-2:0;jQuery(f).removeAttr("tabindex");jQuery(f).attr("tabindex",-1);jQuery(f[g]).attr("tabindex",0);this._keypress(f,38,function(h,e){var i=f.indexOf(h);if(i===0){return;}jQuery(f).removeAttr("tabindex");jQuery(f).attr("tabindex",-1);jQuery(f[i-1]).attr("tabindex",0);jQuery(f[i-1]).focus();});this._keypress(f,40,function(h,e){var i=f.indexOf(h);if(i===f.length-1){return;}jQuery(f).removeAttr("tabindex");jQuery(f).attr("tabindex",-1);jQuery(f[i+1]).attr("tabindex",0);jQuery(f[i+1]).focus();});},_keypress:function(c,k,f){jQuery(c).keydown(function(e){var g=e.keyCode||e.which;if(g===k){f(this,e);return false;}});}};}(undefined));};if(!jQuery.sap.isDeclared('sap.apf.ui.representations.representationInterface')){
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.apf.ui.representations.representationInterface');(function(){'use strict';sap.apf.ui.representations.RepresentationInterfaceProxy=function(c,u){this.type='RepresentationInterfaceProxy';this.putMessage=function(m){return c.putMessage(m);};this.createMessageObject=function(C){return c.createMessageObject(C);};this.getActiveStep=function(){return c.getActiveStep();};this.setActiveStep=function(s){return c.setActiveStep(s);};this.getTextNotHtmlEncoded=function(l,p){return c.getTextNotHtmlEncoded(l,p);};this.updatePath=function(s){return c.updatePath(s);};this.createFilter=function(){return c.createFilter();};this.selectionChanged=function(r){return u.selectionChanged(r);};this.getEventCallback=function(e){return u.getEventCallback(e);};};sap.apf.ui.representations.representationInterface=function(d,c){this.setData=function(m,D){};this.getSelectionAsArray=function(){return[0,2];};this.adoptSelection=function(s){};this.getFilterMethodType=function(){return sap.apf.constants.filterMethodTypes.selectionAsArray;};this.getRequestOptions=function(){return{};};this.getParameter=function(){var p={dimensions:[],measures:[]};return p;};this.getMainContent=function(){var u={};return u;};this.getThumbnailContent=function(){var u={};return u;};this.getPrintContent=function(){var u={};return u;};this.getTooltipContent=function(){var u={};return u;};this.removeAllSelection=function(){};this.serialize=function(){var s={};return s;};this.deserialize=function(s){};this.getAlternateRepresentation=function(){return this.oAlternateRepresentation;};this.getMetaData=function(){return this.metadata;};this.getData=function(){return this.aDataResponse;};};}());};if(!jQuery.sap.isDeclared('sap.apf.ui.representations.utils.UI5ChartHelper')){jQuery.sap.declare("sap.apf.ui.representations.utils.UI5ChartHelper");sap.apf.ui.representations.utils.UI5ChartHelper=function(a,p){var s=this;this.parameter=p;this.classifiedData=[];this.extendedDataSet=[];this.fieldKeysLookup={};this.displayNameLookup={};this.fieldNameLookup={};this.filterLookup={};this.datasetObj={};this.cachedSelection=[];this.filterValues=[];this.dataAlreadySorted=false;this.init=function(D,m,i,o,f){this.metadata=m;this.formatter=f;b.bind(this)(m,D);c.bind(this)(D);d.bind(this)(i,o);if(this.parameter.requiredFilters!==undefined&&this.parameter.requiredFilters.length!==0){v();}};var v=function(){s.filterValues=s.filterValues.filter(function(f){for(var i=0;i<s.extendedDataResponse.length;i++){var h=0;for(var j=0;j<s.parameter.requiredFilters.length;j++){if(f[j]===s.extendedDataResponse[i][s.parameter.requiredFilters[j]]){h=h+1;}}if(h===s.parameter.requiredFilters.length){return true;}else if(i===s.extendedDataResponse.length-1){return false;}}});s.cachedSelection=e();};var b=function(m,D){var f=this.parameter.dimensions.concat(this.parameter.measures);var r=[];var h=function(l){var n=0;for(var i=0;i<f.length;i++){if(f[i].fieldName===l){n++;}}return(n===0?false:true);};if(this.parameter.requiredFilters){this.parameter.requiredFilters.forEach(function(l){if(!h(l)){var n={fieldName:l};r.push(n);}});}if(r.length!==0){f=f.concat(r);}for(var i=0;i<f.length;i++){var j=f[i];var k=j.fieldName;this.displayNameLookup[k]={};if(m!==undefined){if(m.getPropertyMetadata(k)["aggregation-role"]==="dimension"){this.displayNameLookup[k].DISPLAY_NAME=m.getPropertyMetadata(k).label||m.getPropertyMetadata(k).name;this.displayNameLookup[k].VALUE="formatted_"+k;}else{this.displayNameLookup[k].DISPLAY_NAME=m.getPropertyMetadata(k).label||m.getPropertyMetadata(k).name;this.displayNameLookup[k].VALUE=k;}if(j.fieldDesc!==undefined&&a.getTextNotHtmlEncoded(j.fieldDesc).length){this.displayNameLookup[k].DISPLAY_NAME=a.getTextNotHtmlEncoded(j.fieldDesc);}if(m.getPropertyMetadata(k).unit!==undefined){var u=m.getPropertyMetadata(k).unit;var U;if(D!==undefined&&D.length!==0){U=D[0][u];this.displayNameLookup[k].DISPLAY_NAME=this.displayNameLookup[k].DISPLAY_NAME+' ('+U+')';}}}this.fieldNameLookup[this.displayNameLookup[k].DISPLAY_NAME]={};this.fieldNameLookup[this.displayNameLookup[k].DISPLAY_NAME].FIELD_NAME=k;this.fieldNameLookup[this.displayNameLookup[k].DISPLAY_NAME].VALUE=this.displayNameLookup[k].VALUE;}};var c=function(D){function f(w){var x=this.parameter.dimensions,y;for(y=0;y<x.length;y++){if(x[y].fieldName===w){return x[y].labelDisplayOption;}}}function h(l){var n=this.metadata.getPropertyMetadata(l).text;if(this.extendedDataResponse[i][n]){var T={text:this.extendedDataResponse[i][n],key:this.extendedDataResponse[i][l]};return this.formatter.getFormattedValueForTextProperty(l,T);}return this.formatter.getFormattedValue(l,this.extendedDataResponse[i][l]);}this.extendedDataResponse=jQuery.extend([],true,D);var i,j,k;if(this.extendedDataResponse.length!==0){for(i=0;i<this.extendedDataResponse.length;i++){for(k=0;k<this.parameter.measures.length;k++){if(this.extendedDataResponse[i][this.parameter.measures[k].fieldName]!==null){this.extendedDataResponse[i][this.parameter.measures[k].fieldName]=parseFloat(this.extendedDataResponse[i][this.parameter.measures[k].fieldName]);}}for(j=0;j<Object.keys(this.displayNameLookup).length;j++){var l=Object.keys(this.displayNameLookup)[j];var m=(this.displayNameLookup[l].VALUE.search('formatted_')!==-1);if(m){var L=f.call(this,l);var t=this.metadata.getPropertyMetadata(l).hasOwnProperty('text');if(L===sap.apf.core.constants.representationMetadata.labelDisplayOptions.TEXT){var n=this.metadata.getPropertyMetadata(l).text;this.extendedDataResponse[i][this.displayNameLookup[l].VALUE]=this.extendedDataResponse[i][n]||"";}if((!t&&L===undefined)||L===sap.apf.core.constants.representationMetadata.labelDisplayOptions.KEY){this.extendedDataResponse[i][this.displayNameLookup[l].VALUE]=this.formatter.getFormattedValue(l,this.extendedDataResponse[i][l]);}if((t&&L===undefined)||L===sap.apf.core.constants.representationMetadata.labelDisplayOptions.KEY_AND_TEXT){this.extendedDataResponse[i][this.displayNameLookup[l].VALUE]=h.call(this,l);}}}var o="";for(j=0;j<this.parameter.dimensions.length;j++){var q=this.displayNameLookup[this.parameter.dimensions[j].fieldName].VALUE;this.extendedDataResponse[i][q]=this.extendedDataResponse[i][q]===null?this.extendedDataResponse[i][q]:this.extendedDataResponse[i][q].toString();o=o+this.extendedDataResponse[i][q];this.filterLookup[o]=[];if(this.parameter.requiredFilters){for(k=0;k<this.parameter.requiredFilters.length;k++){var r={};r.id=this.extendedDataResponse[i][this.parameter.requiredFilters[k]];r.text=this.extendedDataResponse[i][this.displayNameLookup[this.parameter.requiredFilters[k]].VALUE];this.filterLookup[o].push(r);}}}}}else{var u={};for(k=0;k<this.parameter.measures.length;k++){u[s.displayNameLookup[this.parameter.measures[k].fieldName].VALUE]=undefined;}for(j=0;j<this.parameter.dimensions.length;j++){u[s.displayNameLookup[this.parameter.dimensions[j].fieldName].VALUE]=undefined;}this.extendedDataResponse.push(u);}};var d=function(I,D){var o=this.extendedDataResponse;var m=new sap.ui.model.json.JSONModel();m.setData({data:o});var i;for(i=0;i<this.parameter.dimensions.length;i++){this.parameter.dimensions[i].name=this.displayNameLookup[this.parameter.dimensions[i].fieldName].DISPLAY_NAME;this.parameter.dimensions[i].value='{'+this.displayNameLookup[this.parameter.dimensions[i].fieldName].VALUE+'}';this.parameter.dimensions[i].kind=this.parameter.dimensions[i].kind?this.parameter.dimensions[i].kind:undefined;}s.measureAxisType=I;for(i=0;i<this.parameter.measures.length;i++){this.parameter.measures[i].name=this.displayNameLookup[this.parameter.measures[i].fieldName].DISPLAY_NAME;this.parameter.measures[i].value='{'+this.displayNameLookup[this.parameter.measures[i].fieldName].VALUE+'}';this.parameter.measures[i].kind=this.parameter.measures[i].kind?this.parameter.measures[i].kind:undefined;}var P={dimensions:this.parameter.dimensions,measures:this.parameter.measures};var f=D.getDataset(P);if(this.metadata!==undefined){for(i=0;i<this.parameter.dimensions.length;i++){var M=this.metadata.getPropertyMetadata(this.parameter.dimensions[i].fieldName);if(M.isCalendarYearMonth==="true"){if(this.parameter.dimensions.length>1){f.data.sorter=new sap.ui.model.Sorter(this.parameter.dimensions[0].fieldName,false);}}}}this.datasetObj=f;};this.getDataset=function(){return new sap.viz.ui5.data.FlattenedDataset(this.datasetObj);};this.getModel=function(){var o=this.extendedDataResponse;var m=new sap.ui.model.json.JSONModel();m.setData({data:o});return m;};this.getFilterCount=function(){return this.filterValues.length;};this.getFilters=function(){var f=Object.keys(this.filterLookup);var F=[];var s=this;var h=function(k){for(var i=0;i<f.length;i++){var l={};var m=f[i];for(var j=0;j<s.filterLookup[m].length;j++){if(k===s.filterLookup[m][j].id){l.id=k;l.text=s.filterLookup[m][j].text;F.push(l);return;}}}};for(var i=0;i<this.filterValues.length;i++){h(this.filterValues[i][0]);}return F;};this.getSelectionFromFilter=function(){if(this.parameter.requiredFilters===undefined||this.parameter.requiredFilters.length===0){return[];}var h=e();return h;};this.getHighlightPointsFromSelectionEvent=function(f){var h=[];var n=[];h=g(f,this.cachedSelection);for(var i=0;i<h.length;i++){var k=h[i];if(this.parameter.measures.length===1){var m=this.displayNameLookup[this.parameter.measures[0].fieldName].DISPLAY_NAME;if(k.data[m]===undefined||k.data[m]===null){continue;}}var l="";for(var j=0;j<this.parameter.dimensions.length;j++){var o=this.displayNameLookup[this.parameter.dimensions[j].fieldName].DISPLAY_NAME;l=l+k.data[o];}var q=this.filterLookup[l];var r=this.filterValues.filter(function(t){var u=0;for(var i=0;i<s.parameter.requiredFilters.length;i++){if(t[i]===q[i].id){u=u+1;}else{break;}}if(u===s.parameter.requiredFilters.length){return true;}else if(i===s.parameter.requiredFilters.length){return false;}});if(r.length===0){var M=q.map(function(t){return t.id;});this.filterValues.push(M);}}n=e();this.cachedSelection=n;return n;};var g=function(f,n){var h=f.filter(function(k){for(var i=0;i<n.length;i++){var l=0;for(var j=0;j<Object.keys(k.data).length;j++){if(n[i].data[Object.keys(k.data)[j]]===k.data[Object.keys(k.data)[j]]){l=l+1;}else{break;}}if(l===Object.keys(k.data).length){return false;}else if(j===Object.keys(k.data).length){return true;}}return true;});return h;};this.getFilterFromSelection=function(n){var r=[];var i;for(i=0;i<s.filterValues.length;i++){r.push(s.filterValues[i][0]);}if(n&&n.length>0){n.forEach(function(j){s.filterValues.push([j]);});r=r.concat(n);}var f=a.createFilter();var E=f.getOperators().EQ;var F;var A=f.getTopAnd().addOr('exprssionOr');for(i=0;i<r.length;i++){var h=this.metadata.getPropertyMetadata(s.parameter.requiredFilters[0]).dataType.type;if(h==="Edm.Int32"){r[i]=r[i]===null?r[i]:parseFloat(r[i]);}F={id:r[i],name:s.parameter.requiredFilters[0],operator:E,value:r[i]};A.addExpression(F);}return f;};var e=function(){var r=[];r[0]=[];var i,j,k,l;for(i=0;i<s.filterValues.length;i++){r[0].push(s.filterValues[i][0]);}var n=[];for(i=0;i<s.extendedDataResponse.length;i++){var f=s.extendedDataResponse[i];for(j=0;j<r[0].length;j++){var h=0;for(k=0;k<r.length;k++){if(f[s.parameter.requiredFilters[k]]===r[k][j]){h=h+1;}}if(h===r.length){var m={data:{}};var o;var q;for(k=0;k<s.parameter.dimensions.length;k++){var t=s.parameter.dimensions[k].name;var u=s.fieldNameLookup[t].VALUE;m.data[t]=f[u];}if(!s.measureAxisType){var w;var x;for(l=0;l<s.parameter.measures.length;l++){var y=jQuery.extend(true,{},m);w=s.parameter.measures[l].name;x=s.fieldNameLookup[w].VALUE;y.data[w]=f[x]===null?f[x]:parseFloat(f[x]);n.push(y);}}else{for(k=0;k<s.parameter.measures.length;k++){o=s.parameter.measures[k].name;q=s.fieldNameLookup[o].VALUE;m.data[o]=f[q]===null?f[q]:parseFloat(f[q]);}n.push(m);}}}}return n;};this.getHighlightPointsFromDeselectionEvent=function(f){var i,j;var h=g(this.cachedSelection,f);for(i=0;i<h.length;i++){var k=h[i];var l="";for(j=0;j<this.parameter.dimensions.length;j++){var m=this.displayNameLookup[this.parameter.dimensions[j].fieldName].DISPLAY_NAME;l=l+k.data[m];}var n=this.filterLookup[l];this.filterValues=this.filterValues.filter(function(q,r){var t=0;for(var i=0;i<n.length;i++){if(n[i].id===q[i]){t=t+1;}}if(t===n.length){return false;}else{return true;}});}var o=e();this.cachedSelection=o;return o;};this.destroy=function(){if(s.formatter){s.formatter.destroy();s.formatter=null;}s.metadata=null;s.extendedDataResponse=null;};};};if(!jQuery.sap.isDeclared('sap.apf.ui.representations.utils.vizDatasetHelper')){jQuery.sap.declare("sap.apf.ui.representations.utils.vizDatasetHelper");sap.apf.ui.representations.utils.VizDatasetHelper=function(i){var g=function(k){var n;var s=sap.apf.core.constants.representationMetadata.kind;if(!i){if(k===s.LEGEND){n=2;}else if(k===s.XAXIS||k===s.SECTORCOLOR){n=1;}}else{if(k===s.REGIONCOLOR){n=1;}else if(k===s.REGIONSHAPE){n=2;}}return n;};this.getDataset=function(p){this.parameter=p;var d=[];var m=[];this.parameter.dimensions.forEach(function(a,b){if(a.kind!==undefined){d[b]={name:a.name,value:'{'+a.value+'}',axis:g(a.kind)};}else{d[b]={name:a.name,value:'{'+a.value+'}',axis:b===0?1:2};}});this.parameter.measures.forEach(function(a,b){var A;if(i){A=sap.apf.ui.utils.CONSTANTS.axisTypes.GROUP;}else{A=sap.apf.ui.utils.CONSTANTS.axisTypes.AXIS;}if(a.kind!==undefined){m[b]={name:a.name,value:'{'+a.value+'}'};var s=sap.apf.core.constants.representationMetadata.kind;switch(a.kind){case s.XAXIS:m[b][A]=1;break;case s.YAXIS:if(!i){m[b][A]=1;}else{m[b][A]=2;}break;case s.SECTORSIZE:m[b][A]=1;break;case s.BUBBLEWIDTH:m[b][A]=3;break;case s.BUBBLEHEIGHT:m[b][A]=4;break;default:break;}}else{m[b]={name:a.name,value:'{'+a.value+'}'};m[b][A]=b+1;}});var f={dimensions:d,measures:m,data:{path:"/data"}};return f;};};};if(!jQuery.sap.isDeclared('sap.apf.ui.representations.utils.vizFrameDatasetHelper')){jQuery.sap.declare("sap.apf.ui.representations.utils.vizFrameDatasetHelper");sap.apf.ui.representations.utils.vizFrameDatasetHelper=function(){this.getDataset=function(p){var f,i,a,b;f=jQuery.extend(true,{},p);for(i=0;i<f.dimensions.length;i++){for(a in f.dimensions[i]){if(((a!=='name')&&(a!=='value')&&(a!=='dataType'))){delete f.dimensions[i][a];}}}for(i=0;i<f.measures.length;i++){for(b in f.measures[i]){if(((b!=='name')&&(b!=='value'))){delete f.measures[i][b];}}}f.data={path:"/data"};return f;};};};if(!jQuery.sap.isDeclared('sap.apf.ui.utils.constants')){jQuery.sap.declare("sap.apf.ui.utils.constants");sap.apf.ui.utils.CONSTANTS={step:{OPEN_OVERLAY_IMAGE_HEIGHT:15,DROP_MARKER_HEIGHT:1},representationTypes:{FORM_REPRESENTATION:"FormRepresentation",TABLE_REPRESENTATION:"TableRepresentation",COLUMN_CHART:"ColumnChart",LINE_CHART:"LineChart",PIE_CHART:"PieChart",GEO_MAP:"GeoMap",STACKED_COLUMN_CHART:"StackedColumnChart",SCATTERPLOT_CHART:"ScatterPlotChart",PERCENTAGE_STACKED_COLUMN_CHART:"PercentageStackedColumnChart",BUBBLE_CHART:"BubbleChart",BAR_CHART:"BarChart",STACKED_BAR_CHART:"StackedBarChart",PERCENTAGE_STACKED_BAR_CHART:"PercentageStackedBarChart",HEATMAP_CHART:"HeatmapChart",LINE_CHART_WITH_TWO_VERTICAL_AXES:"LineChartWithTwoVerticalAxes",LINE_CHART_WITH_TIME_AXIS:"LineChartWithTimeAxis"},vizChartTypes:{COLUMN:"Column",LINE:"Line",PIE:"Pie",STACKED_COLUMN:"StackedColumn",PERCENTAGE_STACKED_COLUMN:"StackedColumn100",SCATTERPLOT:"Scatter",BUBBLE:"Bubble"},vizFrameChartTypes:{COLUMN:"column",LINE:"line",PIE:"pie",STACKED_COLUMN:"stacked_column",PERCENTAGE_STACKED_COLUMN:"100_stacked_column",SCATTERPLOT:"scatter",BUBBLE:"bubble",BAR:"bar",STACKED_BAR:"stacked_bar",PERCENTAGE_STACKED_BAR:"100_stacked_bar",HEATMAP:"heatmap",LINE_CHART_WITH_TWO_VERTICAL_AXES:"dual_line",LINE_CHART_WITH_TIME_AXIS:"timeseries_line"},axisTypes:{AXIS:"axis",GROUP:"group"},thumbnailDimensions:{HEIGHT:"75px",WIDTH:"180px",STEP_WIDTH:"202px",STEP_HEIGHT:"170px",STEP_MARGIN:"20px",SEPARATOR_HEIGHT:"25px",REMOVE_ICON_HEIGHT:"20px",TOTAL_STEP_HEIGHT:215},printChartDimensions:{WIDTH:"0.89",POTRAITWIDTH:"793.700787402",LANDSCAPEWIDTH:"1122.519685039"},analysisPathArea:{HEADERHEIGHT:140},chartArea:{CHARTHEADERHEIGHT:120},carousel:{SCROLLCONTAINER:275,DNDBOX:280},landingPage:"landingPage"};};if(!jQuery.sap.isDeclared('sap.apf.ui.utils.facetFilterListConverter')){
/*!
 * SAP APF Analysis Path Framework
 *
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
jQuery.sap.declare('sap.apf.ui.utils.facetFilterListConverter');sap.apf.ui.utils.FacetFilterListConverter=function(){"use strict";this.getFFListDataFromFilterValues=function(f,p){var m=[];f.forEach(function(F){var o={};o.key=F[p];o.text=F.formattedValue;o.selected=false;m.push(o);});return m;};};};if(!jQuery.sap.isDeclared('sap.apf.ui.utils.facetFilterListHandler')){jQuery.sap.declare('sap.apf.ui.utils.facetFilterListHandler');sap.apf.ui.utils.FacetFilterListHandler=function(c,u,C,f){"use strict";function _(){var m=c.createMessageObject({code:"6010",aParameters:[c.getTextNotHtmlEncoded(C.getLabel())]});c.putMessage(m);}this.getFacetFilterListData=function(){var s,F;var o=jQuery.Deferred();var a=C.getValues();a.then(function(b,n){if(b===null||b.length===0){_();o.reject([]);}else{s=C.getAliasNameIfExistsElsePropertyName()||C.getPropertyName();C.getMetadata().then(function(p){F={oCoreApi:c,oUiApi:u,oPropertyMetadata:p,sSelectProperty:s};o.resolve({aFilterValues:b,oFilterRestrictionPropagationPromiseForValues:n,oFormatterArgs:F});});}},function(e){_();o.reject([]);});return o.promise();};this.getSelectedFFValues=function(){var F=jQuery.Deferred();var a=C.getSelectedValues();a.then(function(s,n){F.resolve({aSelectedFilterValues:s,oFilterRestrictionPropagationPromiseForSelectedValues:n});},function(e){_();F.resolve([]);});return F.promise();};this.setSelectedFFValues=function(F){C.setSelectedValues(F);};};};if(!jQuery.sap.isDeclared('sap.apf.ui.utils.formatter')){
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP SE. All rights reserved
 */
jQuery.sap.declare("sap.apf.ui.utils.formatter");sap.apf.ui.utils.formatter=function(f,m,d){var s=this;this.metadata=m;this.dataResponse=d;this.getPropertyMetadata=function(a){if(this.metadata&&this.metadata.getPropertyMetadata){return this.metadata.getPropertyMetadata(a);}return this.metadata;};this.getFormattedValue=function(a,o){var b,y,q,c,e,w,g;var M=this.getPropertyMetadata(a);if(M.isCalendarYearMonth){if(o!==null){b=this.doYearMonthFormat(o);}else{b="";}}else if(M.dataType&&M.dataType.type==="Edm.DateTime"){if(o!==null){g=new Date(parseInt(o.slice(6,o.length-2),10));g=g.toLocaleDateString();if(g==="Invalid Date"){b="-";}else{b=g;}}else{b="-";}}else if(M.unit){if(o!==null){var h=s.getPropertyMetadata(M.unit);if(h.semantics==="currency-code"){var p=isNaN(M.scale)?this.dataResponse[0][M.scale]:M.scale;o=parseFloat(o).toFixed(p).toString();var i=o.split(".");var j=parseFloat(i[0]).toLocaleString();var k=0.1;k=k.toLocaleString();if(j.split(k.substring(1,2)).length>1){j=j.split(k.substring(1,2))[0];}j=j.concat(k.substring(1,2),i[1]);b=j;}else{b=o;}}else{b="-";}}else if(M.isCalendarDate){if(o!==null){y=o.substr(0,4);var l=parseInt(o.substr(4,2),10)-1;var n=o.substr(6,2);g=new Date(y,l,n);g=g.toLocaleDateString();if(g==="Invalid Date"){b="-";}else{b=g;}}else{b="-";}}else if(M.isCalendarYearQuarter){if(o!==null){y=o.substr(0,4);q=o.substr(4,1);c=new Date(y);e=c.getFullYear();var r;r="Q"+q;var t=r+" "+e;b=t;}else{b="";}}else if(M.isCalendarYearWeek){if(o!==null){y=o.substr(0,4);w=o.substr(4,2);c=new Date(y);e=c.getFullYear();var u;u="CW"+w;var v=u+" "+e;b=v;}else{b="";}}else{if(o===null){b="null";}else{b=o;}}var x=jQuery.extend({},this.getPropertyMetadata(a));b=this._applyCustomFormatting(x,a,o,b);return b;};this.doYearMonthFormat=function(a){var j=f.getTextNotHtmlEncoded("month-1-shortName");var b=f.getTextNotHtmlEncoded("month-2-shortName");var c=f.getTextNotHtmlEncoded("month-3-shortName");var e=f.getTextNotHtmlEncoded("month-4-shortName");var g=f.getTextNotHtmlEncoded("month-5-shortName");var h=f.getTextNotHtmlEncoded("month-6-shortName");var i=f.getTextNotHtmlEncoded("month-7-shortName");var k=f.getTextNotHtmlEncoded("month-8-shortName");var l=f.getTextNotHtmlEncoded("month-9-shortName");var o=f.getTextNotHtmlEncoded("month-10-shortName");var n=f.getTextNotHtmlEncoded("month-11-shortName");var p=f.getTextNotHtmlEncoded("month-12-shortName");var q=[j,b,c,e,g,h,i,k,l,o,n,p];var y=a.substr(0,4);var r=q[a.substr(4,6)-1];return r+" "+y;};this.isAmountField=function(a){var i=false;if(this.metadata&&this.dataResponse){var M=this.getPropertyMetadata(a);if(M!==undefined&&M.unit){var c=this.getPropertyMetadata(M.unit);if(c!==undefined&&c.semantics==="currency-code"){i=true;}}}return i;};this.getPrecision=function(a){var M=this.getPropertyMetadata(a);if(M!==undefined&&this.dataResponse!==undefined&&this.dataResponse[0]!==undefined){return isNaN(M.scale)?this.dataResponse[0][M.scale]:M.scale;}};this.getFormatString=function(a){var z="";var F;var b=a.fieldName;var c=this.isAmountField(b);if(c===true){var p=this.getPrecision(b);if(p!==undefined){for(var i=0;i<p;i++){z=z+"0";}F="#,#0"+"."+z;}else{F="";}}else{F="";}return F;};this.getFormattedValueForTextProperty=function(a,t){var F;if(t.key){F=t.text+" ("+t.key+")";}else{F=t.text;}var b=jQuery.extend({},this.getPropertyMetadata(a));F=this._applyCustomFormatting(b,a,t.text,F);return F;};this._applyCustomFormatting=function(a,b,o,c){var e=f.getEventCallback(sap.apf.core.constants.eventTypes.format);if(typeof e==="function"){var g=e.apply(f,[a,b,o,c]);if(g!==undefined){c=g;}if(g===null){c="";}}return c;};this.destroy=function(){s.metadata=null;s.dataResponse=null;};};};if(!jQuery.sap.isDeclared('sap.apf.ui.utils.helper')){jQuery.sap.declare('sap.apf.ui.utils.helper');sap.apf.ui.utils.Helper=function(c){"use strict";this.oCoreApi=c;this.getRepresentationSortInfo=function(r){var s=this;var C=r.parameter.dimensions.concat(r.parameter.measures);var S=r.parameter.orderby;var a=S.map(function(o){var b;C.forEach(function(d){if(o.property===d.fieldName&&d.fieldDesc&&s.oCoreApi.getTextNotHtmlEncoded(d.fieldDesc)){b=s.oCoreApi.getTextNotHtmlEncoded(d.fieldDesc);return;}});if(!b){s.oCoreApi.getMetadataFacade().getProperty(o.property,function(m){if(m.label||m.name){if(m.label){b=m.label;}else if(m.name){b=m.name;}else{b="";}}});}return b;});return a.join(", ");};};};if(!jQuery.sap.isDeclared('sap.apf.ui.utils.print')){
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
jQuery.sap.declare("sap.apf.ui.utils.print");sap.apf.ui.utils.PrintHelper=function(I){"use strict";var c=I.oCoreApi;var u=I.uiApi;var f=I.oFilterIdHandler;var n,C,a;this.oPrintLayout={};function _(){++n;if(a===n){C.resolve();}}function b(o){if(!jQuery.isEmptyObject(o.oPrintLayout)){o.oPrintLayout.removeContent();}jQuery('#apfPrintArea').remove();jQuery("body").append('<div id="apfPrintArea"></div>');u.createApplicationLayout(false).setBusy(true);}function d(){var i=new Date();var A=c.getApplicationConfigProperties().appName;var s=u.getAnalysisPath().oSavedPathName.getTitle();var j=new sap.ui.core.HTML({id:'idAPFHeaderForFirstPage',content:['<div class="subHeaderPrintWrapper"><p class="printHeaderTitle"> '+c.getTextHtmlEncoded(A)+' : '+jQuery.sap.encodeHTML(s)+'</p>','<p class="printHeaderDate"> '+i.toTimeString()+' </p></div><div class="clear"></div>'].join(""),sanitizeContent:true});return j;}function e(){var i,j,l,F,A,m,o,p,q,r,s,S,t;var v=[],w=[],x="",y="",z=[],B=[],D=[],E=[],G={};var H=u.getEventCallback(sap.apf.core.constants.eventTypes.printTriggered);var J={getTextNotHtmlEncoded:c.getTextNotHtmlEncoded};var K=f.getAllInternalIds();if(K.length>0){for(i=0;i<K.length;i++){A=f.get(K[i]).getExpressions();v.push(A[0]);}}function L(){function N(P){y="";B=[];r=new sap.apf.ui.utils.formatter({getEventCallback:u.getEventCallback.bind(u),getTextNotHtmlEncoded:c.getTextNotHtmlEncoded},P);y=P.label;B.push(r.getFormattedValue(P.name,v[i][j].value));}for(i=0;i<v.length;i++){for(j=0;j<v[i].length;j++){q=v[i][j];c.getMetadataFacade().getProperty(v[i][j].name,N);q["sName"]=y;q["value"]=B;w.push(q);}}return w;}if(H!==undefined){D=H.apply(J,v)||[];D=(D.length>0)?D:L();}else{D=L();}s=u.getFacetFilterForPrint();function M(S){z=[];S.forEach(function(N){z.push(N.getText());});}if(s){F=s.getLists();for(l=0;l<F.length;l++){S=[];G={};G.sName=F[l].getTitle();if(!F[l].getSelectedItems().length){S=F[l].getItems();}else{S=F[l].getSelectedItems();}M(S);G.value=z;E.push(G);}}p=D.length>0?D.concat(E):E;t=new sap.ui.layout.VerticalLayout({id:'idAPFFacetAndFooterLayout'});for(i=0;i<p.length;i++){y=p[i].sName;for(j=0;j<p[i].value.length;j++){if(j!==p[i].value.length-1){x+=p[i].value[j]+", ";}else{x+=p[i].value[j];}}m=new sap.m.Text({text:y}).addStyleClass("printFilterName");o=new sap.m.Text({text:x}).addStyleClass("printFilterValue");t.addContent(m);t.addContent(o);x="";}return t;}function g(i,j){var m;var l=new Date();var A=c.getApplicationConfigProperties().appName;var s=u.getAnalysisPath().oSavedPathName.getTitle();if(!A){m=c.createMessageObject({code:"6003",aParameters:["sAppName"]});c.putMessage(m);}var o=new sap.ui.core.HTML({id:'idAPFHeaderForEachStep'+i,content:['<div class="subHeaderPrintWrapper"><p class="printHeaderTitle"> '+c.getTextHtmlEncoded(A)+' : '+jQuery.sap.encodeHTML(s)+'</p>','<p class="printHeaderDate"> '+l.toTimeString()+' </p></div><div class="clear"></div>','<div class="printChipName"><p>'+c.getTextHtmlEncoded("print-step-number",[i,j])+'</p></div>'].join(""),sanitizeContent:true});return o;}function h(s){var i,m,p,j=false,r={};var S=c.getTextNotHtmlEncoded(s.title);var o=s.getSelectedRepresentation();var l=o.bIsAlternateView?o.toggleInstance:o;if(o.bIsAlternateView){i=s.getSelectedRepresentation().getData();m=s.getSelectedRepresentation().getMetaData();l.setData(i,m);}if(l.type===sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION){p=l.getPrintContent(S);r=p.oTableForPrint.getContent()[0];var q=p.aSelectedListItems;r.attachUpdateFinished(function(){q.forEach(function(t){r.setSelectedItem(t);});_();});r.setWidth("1000px");}else{p=l.getPrintContent(S);r=p.oChartForPrinting;if(r.vizSelection){r.attachRenderComplete(function(){r.vizSelection(p.aSelectionOnChart);_();});}else{r.attachInitialized(function(){r.selection(p.aSelectionOnChart);_();});}}if(l.bIsLegendVisible===undefined||l.bIsLegendVisible===true){j=true;}if(r.setVizProperties){r.setVizProperties({legend:{visible:j},sizeLegend:{visible:j}});}else{if(r.setLegend!==undefined){r.setLegend(new sap.viz.ui5.types.legend.Common({visible:j}));}if(r.setSizeLegend!==undefined){r.setSizeLegend(new sap.viz.ui5.types.legend.Common({visible:j}));}}return r;}function k(s,i,j){var S;var o=new sap.ui.layout.VerticalLayout({id:'idAPFChartLayout'+i});o.addContent(h(s));S=new sap.ui.layout.VerticalLayout({id:'idAPFStepLayout'+i,content:[g(i,j),o]}).addStyleClass("representationContent");return S;}this.doPrint=function(){var i,j,l,o,m,t,s,S,p;var q="",r=2000,v=this;n=0;var A=c.getSteps();a=A.length;this.oPrintLayout=new sap.ui.layout.VerticalLayout({id:"idAPFPrintLayout"});b(this);C=jQuery.Deferred();if(a===0){C.resolve();}p=new sap.ui.layout.VerticalLayout({id:'idAPFPrintFirstPageLayout',content:[d(),e()]}).addStyleClass("representationContent");this.oPrintLayout.addContent(p);for(j=0;j<A.length;j++){l=parseInt(j,10)+1;this.oPrintLayout.addContent(k(A[j],l,A.length));}this.oPrintLayout.placeAt("apfPrintArea");if(jQuery(".v-geo-container").length){r=4000;}window.setTimeout(function(){u.createApplicationLayout(false).setBusy(false);},r-150);window.setTimeout(function(){jQuery("#"+v.oPrintLayout.sId+" > div:not(:last-child)").after("<div class='page-break'> </div>");q=v.oPrintLayout.getDomRef();t=jQuery('#apfPrintArea .sapUiTable');if(t.length){m=jQuery('#apfPrintArea .printTable .sapMListTblHeader .sapMListTblCell').length;if(m>11){jQuery("#setPrintMode").remove();jQuery("<style id='setPrintMode' > @media print and (min-resolution: 300dpi) { @page {size : landscape;}}</style>").appendTo("head");}else{jQuery("#setPrintMode").remove();jQuery("<style id='setPrintMode'>@media print and (min-resolution: 300dpi) { @page {size : portrait;}}</style>").appendTo("head");}}jQuery("#apfPrintArea").empty();jQuery("#sap-ui-static > div").hide();jQuery("#apfPrintArea").append(jQuery(q).html());for(i=0;i<jQuery("#apfPrintArea").siblings().length;i++){jQuery("#apfPrintArea").siblings()[i].hidden=true;}C.then(function(){window.print();});window.setTimeout(function(){for(i=0;i<jQuery("#apfPrintArea").siblings().length;i++){jQuery("#apfPrintArea").siblings()[i].hidden=false;}for(s=0;s<A.length;s++){S=A[s].getSelectedRepresentation();S=S.bIsAlternateView?S.toggleInstance:S;if(S.type!==sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION){o=v.oPrintLayout.getContent()[s+1].getContent()[1].getContent()[0];o.destroy();o=null;}}v.oPrintLayout.destroy();v.oPrintLayout=null;},10);},r);};};};if(!jQuery.sap.isDeclared('sap.apf.utils.filterIdHandler')){jQuery.sap.declare('sap.apf.utils.filterIdHandler');(function(){'use strict';sap.apf.utils.FilterIdHandler=function(i){var m=i.instance.messageHandler;var u=1;var a=[];var f={};this.add=function(d){if(!c(d)){m.putMessage(m.createMessageObject({code:'5301'}));}f[u]=g(d);a.push(u);i.functions.setRestrictionByProperty(d);return u++;};this.update=function(d,e){if(d&&typeof d=='number'){m.check((d>0&&d<u),'Passed unknown numeric identifier during update of path context handler');if(!(d>0&&d<u)){return;}}else if(!d||typeof d!='string'){m.check(false,'Passed false identifier during update of path context handler');return;}if(!c(e)){m.putMessage(m.createMessageObject({code:'5301'}));}i.functions.setRestrictionByProperty(e);f[d]=g(e);};this.get=function(d){switch(typeof d){case'number':m.check((d>0&&d<u),'Passed unknown numeric identifier during get from path context handler');break;case'string':m.check(f[d],'Passed unknown string identifier during get from path context handler');break;default:m.check(false,"Filter Id handler - wrong type of the id parameter in get");}return i.functions.getRestrictionByProperty(f[d]);};this.getAllInternalIds=function(d){return jQuery.sap.extend(true,[],a);};this.serialize=function(){return jQuery.extend(true,{},f);};this.deserialize=function(d){u=1;var p;for(p in d){if(typeof b(p)==='number'){u++;}}f=jQuery.extend(true,{},d);};function g(d){return d.getInternalFilter().getProperties()[0];}function b(p){if(isNaN(Number(p))){return p;}return Number(p);}function c(d){var e=d.getInternalFilter();var h=e.getProperties();if(h.length>1){return false;}var v=new V();e.traverse(v);return v.isAccepted();function V(){var j=this;var k=false;var l=false;var n=true;this.isAccepted=function(){return n;};this.processEmptyFilter=function(){return;};this.processTerm=function(t){var o=t.getOp();if(!l&&!k){if(o==='GE'||o==='LE'||o==='EQ'){return;}}if(l&&(o==='GE'||o==='LE')){return;}if(k&&o==='EQ'){return;}n=false;};this.processAnd=function(o,F){if(F&&F.length>0){l=true;}this.process(o);F.forEach(function(d){j.process(d);});};this.processOr=function(o,F){if(F&&F.length>0){k=true;}this.process(o);F.forEach(function(d){j.process(d);});};this.process=function(d){if(k&&l){n=false;}if(!n){return;}d.traverse(this);};}}};}());};if(!jQuery.sap.isDeclared('sap.apf.utils.hashtable')){
/*!
 * SAP APF Analysis Path Framework
 *
 * (c) Copyright 2012-2014 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.apf.utils.hashtable');(function(){'use strict';sap.apf.utils.Hashtable=function(m){var n=0;var i={};var o=[];this.type="hashTable";this.setItem=function(k,v){var p;m.check((k!==undefined&&k!==null),"sap.apf.utils.HashTable.setItem: key undefined");m.check((v!==undefined&&v!==null),"sap.apf.utils.HashTable.setItem: value undefined");if(this.hasItem(k)){p=i[k];}else{n++;o.push(k);}i[k]=v;return p;};this.getNumberOfItems=function(){return n;};this.getItem=function(k){m.check((k!==undefined&&k!==null),"sap.apf.utils.HashTable.getItem key undefined");return this.hasItem(k)?i[k]:undefined;};this.hasItem=function(k){m.check((k!==undefined&&k!==null),"sap.apf.utils.HashTable.hasItem key undefined");return i.hasOwnProperty(k);};this.removeItem=function(k){m.check((k!==undefined&&k!==null),"sap.apf.utils.HashTable.removeItem key undefined");var I;if(this.hasItem(k)){I=i[k];n--;o.splice(o.indexOf(k),1);delete i[k];return I;}return undefined;};this.getKeys=function(){var K=[];var k;for(k in i){if(this.hasItem(k)){K.push(k);}}return K;};this.each=function(f){var k;for(k in i){if(this.hasItem(k)){f(k,i[k]);}}};this.forEachOrdered=function(f){var t=this;o.forEach(function(k){if(!t.hasItem(k)){m.check(false,"sap.apf.utils.HashTable.forEachOrdered: key not contained");}else{f(k,i[k]);}});};this.getKeysOrdered=function(){var l=[];this.forEachOrdered(function(k){l.push(k);});return l;};this.moveUpOrDown=function(a,d){m.check((a!==undefined&&a!==null),"sap.apf.utils.HashTable.moveItemUpOrDown movedKey undefined");var b=o.indexOf(a);var c=b+d;if(b<0){return null;}if(d<0){o.splice(b,1);if(c<0){o.splice(0,0,a);return 0;}o.splice(b+d,0,a);return b+d;}else if(d===0){return b;}else if(d>0){o.splice(b,1);if(c>=o.length){o.splice(o.length,0,a);return o.length;}o.splice(c,0,a);return c;}};this.moveBefore=function(b,a){if(o.indexOf(b)<0||o.indexOf(a)<0){return null;}if(b===a){return o.indexOf(a);}o.splice(o.indexOf(a),1);o.splice(o.indexOf(b),0,a);return o.indexOf(a);};this.moveToEnd=function(a){if(o.indexOf(a)<0){return null;}o.splice(o.indexOf(a),1);o.push(a);return o.indexOf(a);};this.reset=function(){i={};o=[];n=0;};};}());};if(!jQuery.sap.isDeclared('sap.apf.utils.parseTextPropertyFile')){jQuery.sap.declare("sap.apf.utils.parseTextPropertyFile");jQuery.sap.require('sap.ui.core.format.DateFormat');(function(){'use strict';sap.apf.utils.parseTextPropertyFile=function(t,a){var m=a.instance.messageHandler;var d=sap.ui.core.format.DateFormat.getDateTimeInstance({pattern:"yyyy/MM/dd HH:mm:ss"});var D;var l=t.split(/\r?\n/);var b=l.length;var i;var c=-1;var e=-1;var f;var g,h,j;var A=false;var p={Application:undefined,TextElements:[],Messages:[]};function k(v,w){var x=m.createMessageObject({code:v,aParameters:[w]});p.Messages.push(x);}function n(v){k(11013,v);}function o(v){k(11011,v);}function q(v,w){var x=sap.apf.utils.isValidGuid(v);if(!x){k(11012,w);return false;}return true;}function r(v){k(11015,v);}function s(v){k(11012,v);}for(i=0;i<b;i++){if(!A){var u=/^\#\s*ApfApplicationId=[0-9A-F]+\s*$/.exec(l[i]);if(u!==null){p.Application=l[i].split('=')[1];if(!sap.apf.utils.isValidGuid(p.Application)){p.Application="";n(i);}A=true;continue;}}if(l[i]===""){continue;}if(e===i&&/^\#\s*LastChangeDate/.exec(l[i])){j=l[i].split('=');if(j.length===2){D=d.parse(j[1]);if(!D){r(i);f.LastChangeUTCDateTime="";}else{f.LastChangeUTCDateTime='/Date('+D.getTime()+')/';}p.TextElements.push(f);}else{r(i);}f=null;continue;}if(c===i){j=l[i].split('=');if(j.length===2){if(q(j[0],i)){f.TextElement=j[0];f.TextElementDescription=j[1];}else{s(i);}}else{o(i);}continue;}g=/^\#(X|Y)[A-Z]{3},[0-9]+:/.exec(l[i]);if(g){if(c===i){o(i);}f={};f.Language=sap.apf.core.constants.developmentLanguage;f.Application=p.Application;f.TextElementType=l[i].match(/(X|Y)[A-Z]{3}/)[0];f.MaximumLength=l[i].match(/,[0-9]+/);f.MaximumLength=parseInt(f.MaximumLength[0].substring(1),10);f.TranslationHint=l[i].match(/:\s*[0-9a-zA-Z\s]+$/);f.TranslationHint=f.TranslationHint[0].substring(1);c=i+1;e=i+2;}else{h=/^\#(X|Y)[A-Z]{3},[0-9]+/.exec(l[i]);if(h){if(c===i){o(i);}f={};f.Language=sap.apf.core.constants.developmentLanguage;f.Application=p.Application;f.TextElementType=l[i].match(/(X|Y)[A-Z]{3}/)[0];f.MaximumLength=l[i].match(/,[0-9]+/);f.MaximumLength=parseInt(f.MaximumLength[0].substring(1),10);f.TranslationHint="";c=i+1;e=i+2;}}}if(!A){k(11010,0);}return p;};}());};if(!jQuery.sap.isDeclared('sap.apf.utils.serializationMediator')){
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
jQuery.sap.declare("sap.apf.utils.serializationMediator");(function(){'use strict';sap.apf.utils.SerializationMediator=function(i){this.savePath=function(a,b,c){var e;i.startFilterHandler.serialize().done(d);function d(s){e={filterIdHandler:i.filterIdHandler.serialize(),startFilterHandler:s};if(typeof a==='string'&&typeof b==='function'){i.coreApi.savePath(a,b,e);}else if(typeof a==='string'&&typeof b==='string'&&typeof c==='function'){i.coreApi.savePath(a,b,c,e);}}};this.openPath=function(p,c,n){var C=function(r,e,m){if(r&&r.path&&r.path.SerializedAnalysisPath&&r.path.SerializedAnalysisPath.filterIdHandler){i.filterIdHandler.deserialize(r.path.SerializedAnalysisPath.filterIdHandler);delete r.path.SerializedAnalysisPath.filterIdHandler;}if(r&&r.path&&r.path.SerializedAnalysisPath&&r.path.SerializedAnalysisPath.startFilterHandler){i.startFilterHandler.deserialize(r.path.SerializedAnalysisPath.startFilterHandler);delete r.path.SerializedAnalysisPath.startFilterHandler;}c(r,e,m);};i.coreApi.openPath(p,C,n);};this.deletePath=function(p,c){i.coreApi.deletePath(p,c);};this.readPaths=function(c){i.coreApi.readPaths(c);};};}());};if(!jQuery.sap.isDeclared('sap.apf.utils.startFilter')){jQuery.sap.declare('sap.apf.utils.startFilter');sap.apf.utils.StartFilter=function(a,c,b){'use strict';var d;var e;var r=new sap.apf.core.utils.Filter(a.instance.messageHandler);var f;var g;var h=0;var j=0;var k=jQuery.extend(true,[],b);var p;if(c.preselectionDefaults&&c.preselectionDefaults.length>0){p=jQuery.extend(true,[],c.preselectionDefaults);}else if(jQuery.isFunction(c.preselectionFunction)){p=jQuery.extend(true,[],c.preselectionFunction());}var v=false;if(c.valueHelpRequest||(jQuery.isArray(c.valueList)&&c.valueList.length>0)){v=true;}var l=false;var m={};var n={};z=z.bind(this);A=A.bind(this);w=w.bind(this);u=u.bind(this);s=s.bind(this);this.setContext=function(i){if(c.notConfigured===true){b=i;}else{a.instance.messageHandler.putMessage(a.instance.messageHandler.createMessageObject({code:'5100',aParameters:['Context of configured Startfilter cannot be changed']}));}};this.getPropertyName=function(){return c.property;};this.getLabel=function(){return c.label;};this.getAliasNameIfExistsElsePropertyName=function(){return c.alias||c.property;};this.isMultiSelection=function(){if(c.multiSelection==='true'||c.multiSelection===true){return true;}return false;};this.isVisible=function(){if(b&&b.type==='internalFilter'&&!c.filterResolutionRequest){return false;}return!c.invisible;};this.setRestriction=function(i){r=i.copy();if(!g){g=jQuery.Deferred();}if(!f){f=jQuery.Deferred();}o(++h);q(++j);};this.setSelectedValues=function(i){if(!g){g=jQuery.Deferred();}if(!d){d=jQuery.Deferred();u().done(function(B){if(d){d.resolve(B);}});}if(i.type==='internalFilter'){e=i;}else{e=jQuery.extend(true,[],i);}q(++j);};this.getSelectedValues=function(){var i;if(!g){g=jQuery.Deferred();i=g;q(++j);}else if(g.state()==='pending'){i=g;if(d){d.done(function(){q(++j);});}else{q(++j);}}return i.promise();};this.getValues=function(){var i;if(!f){f=jQuery.Deferred();i=f;o(++h);}else if(f.state()==='pending'){i=f;o(++h);}return i.promise();};this.getMetadata=function(){if(c.valueHelpRequest){return y().then(function(i){return i.metadata.getPropertyMetadata(this.getAliasNameIfExistsElsePropertyName());}.bind(this));}else if(c.filterResolutionRequest){return w().then(function(i){return i.metadata.getPropertyMetadata(this.getAliasNameIfExistsElsePropertyName());}.bind(this));}return jQuery.Deferred().resolve({});};this.serialize=function(){var i=jQuery.Deferred();var B={propertyName:this.getPropertyName()};u().done(function(C){if(C&&C.type==='internalFilter'){C=C.mapToSapUI5FilterExpression();}B.selectedValues=C;i.resolve(B);});return i;};this.deserialize=function(i){if(i.selectedValues&&(i.selectedValues.filters||i.selectedValues.path)){i.selectedValues=sap.apf.core.utils.Filter.transformUI5FilterToInternal(a.instance.messageHandler,i.selectedValues);}e=null;d=null;if(jQuery.isArray(i.selectedValues)){k=jQuery.extend(true,[],i.selectedValues);b=jQuery.extend(true,[],i.selectedValues);}else{k=i.selectedValues;b=i.selectedValues;}l=false;};this.reset=function(){if(d){d.done(function(i){e=i;});}};function o(i){s(i,h).done(function(B){if(i===h){var C=f;f=jQuery.Deferred();C.resolve(B,f.promise());}});}function q(i){u(i).done(function(B){if(i===j){var C=g;g=jQuery.Deferred();C.resolve(B,g.promise());}});}function s(B,C){var D=jQuery.Deferred();var E=[];t=t.bind(this);G=G.bind(this);if(v&&jQuery.isArray(b)){x(B,C).then(function(i){var E=i.data;var F=t(k,E);D.resolve(F);});}else if(b&&b.type==='internalFilter'&&v&&c.filterResolutionRequest){jQuery.when(x(B,C),w(B,C)).then(function(i,H){var E=i.data;G(H.data,E);D.resolve(E);});}else if(v&&((c.preselectionDefaults&&c.preselectionDefaults.length>0)||jQuery.isFunction(c.preselectionFunction))){x(B,C).then(function(i){var E=i.data;var F=t(p,E);D.resolve(F);});}else if(v){x(B,C).then(function(i){D.resolve(i.data);});}else if(b&&b.type==='internalFilter'&&c.filterResolutionRequest){w(B,C).then(function(i){D.resolve(i.data);});}else if(jQuery.isArray(b)&&c.filterResolutionRequest&&!v){w(B,C).then(function(i){D.resolve(i.data);});}else if(jQuery.isArray(b)){E=t(k,E);D.resolve(E);}else if(((c.preselectionDefaults&&c.preselectionDefaults.length>0)||jQuery.isFunction(c.preselectionFunction))&&!v&&!c.filterResolutionRequest&&!b){if(this.isMultiSelection()){var F=t(p,E);}else if(p.length>0){var F=t([p[0]],E);}D.resolve(F);}else if(((c.preselectionDefaults&&c.preselectionDefaults.length>0)||jQuery.isFunction(c.preselectionFunction))&&c.filterResolutionRequest&&!b){if(this.isMultiSelection()){var F=t(p,E);}else if(p.length>0){var F=t([p[0]],E);}D.resolve(F);}else if(b&&b.type==='internalFilter'||!b){D.resolve(null);}return D.promise();function G(H,I){var J=A(I);for(var i=H.length-1;i>=0;i--){if(!J[H[i][this.getAliasNameIfExistsElsePropertyName()]]){I.unshift(H[i]);}}}}function t(B,C){var D=jQuery.extend(true,[],C);var E=A(C);var F;for(var i=B.length-1;i>=0;i--){if(!E[B[i]]){F={};F[this.getAliasNameIfExistsElsePropertyName()]=B[i];D.unshift(F);}else if(!l){B.splice(i,1);}}l=true;return D;}function u(i){var B=jQuery.Deferred();var C;var D;var E;var F=this;if(e){if(!c.invisible){H(jQuery.extend(true,[],e),i);}else{C=e;G();}}else if(jQuery.isFunction(c.preselectionFunction)&&!v){C=c.preselectionFunction();G();}else if(b&&b.type==='internalFilter'&&!c.filterResolutionRequest){B.resolve(b);}else if(c.filterResolutionRequest&&!b&&!v&&!(c.preselectionDefaults&&c.preselectionDefaults.length>0)){B.resolve(null);}else if(b&&b.type==='internalFilter'&&c.filterResolutionRequest){w(i,j).then(function(I){var J=z(I);H(jQuery.extend(true,[],J),i);});}else if(v&&!jQuery.isArray(b)&&!(c.preselectionDefaults&&c.preselectionDefaults.length>0)&&!c.preselectionFunction){x(i,j).then(function(I){var J=z(I);if(this.isMultiSelection()){C=J;}else{C=[J[0]];}G();}.bind(this));}else if(v&&!jQuery.isArray(b)&&((c.preselectionDefaults&&c.preselectionDefaults.length>0)||c.preselectionFunction)){if(jQuery.isFunction(c.preselectionFunction)){D=c.preselectionFunction();}else{D=c.preselectionDefaults;}H(jQuery.extend(true,[],D),i);}else if(jQuery.isArray(b)){H(b,i);}else if(c.preselectionDefaults&&c.preselectionDefaults.length>0){C=c.preselectionDefaults;H(C,i);}else{B.resolve(null);}return B.promise();function G(){if(C&&C.type==='internalFilter'){B.resolve(C);}else{B.resolve(jQuery.extend(true,[],C));}}function H(I,i){s(i,j).done(function(J){if(J!==null){C=[];E=A(J);I.forEach(function(K){if(E[K]){C.push(K);}});if(C.length===0){C=z({data:J});}if(!F.isMultiSelection()){C=[C[0]];}if(e!==null){e=C;}}else{C=null;}G();});}}function w(i,B){var C;var D=jQuery.Deferred();if(i&&i!==B){return D.promise();}var E;if(jQuery.isArray(b)){E=new sap.apf.core.utils.Filter(a.instance.messageHandler);b.forEach(function(G){E.addOr(this.getAliasNameIfExistsElsePropertyName(),'eq',G);}.bind(this));}else if(b instanceof sap.apf.core.utils.Filter){E=b;}else{E=new sap.apf.core.utils.Filter(a.instance.messageHandler);}if(!r.isEmpty()){C=new sap.apf.core.utils.Filter(a.instance.messageHandler);C.addAnd(r).addAnd(E);}else{C=E;}if(m.lastMergedFilter&&m.lastMergedFilter.isEqual(C)){m.lastFilterResolutionPromise.done(function(G){D.resolve(G);});}else{m.lastMergedFilter=C.copy();m.lastFilterResolutionPromise=D;a.functions.createRequest(c.filterResolutionRequest).sendGetInBatch(C,F,undefined);}return D.promise();function F(G){D.resolve(G);}}function x(i,B){var C;if(c.valueHelpRequest){return y(i,B);}else if(c.valueList){C={data:t(c.valueList,[])};return jQuery.Deferred().resolve(C);}}function y(i,B){var C=jQuery.Deferred();if(i&&B!==i){return C.promise();}if(n.lastRestriction&&n.lastRestriction.isEqual(r)){n.lastValueHelpPromise.done(function(E){C.resolve(E);});}else{n.lastRestriction=r.copy();n.lastValueHelpPromise=C;a.functions.createRequest(c.valueHelpRequest).sendGetInBatch(r,D,undefined);}return C.promise();function D(E){C.resolve(E);}}function z(i){var B=[];i.data.forEach(function(C){B.push(C[this.getAliasNameIfExistsElsePropertyName()]);}.bind(this));return B;}function A(i){var B={};i.forEach(function(C){B[C[this.getAliasNameIfExistsElsePropertyName()]]=true;}.bind(this));return B;}};};if(!jQuery.sap.isDeclared('sap.apf.utils.startParameter')){(function(){'use strict';jQuery.sap.declare('sap.apf.utils.startParameter');sap.apf.utils.StartParameter=function(c,m){var a=null;var s=null;var r=null;var b;var e;var d;var f;if(c&&c.getComponentData&&c.getComponentData()&&c.getComponentData().startupParameters){d=c.getComponentData().startupParameters;if(d['sap-apf-configuration-id']){a=d['sap-apf-configuration-id'][0];}if(d['sap-apf-step-id']){s=d['sap-apf-step-id'][0];}if(d['sap-apf-representation-id']){r=d['sap-apf-representation-id'][0];}if(d['sap-apf-app-config-path']){b=d['sap-apf-app-config-path'][0];}if(d['evaluationId']){e=d['evaluationId'][0];}if(d['sap-client']){f=d['sap-client'][0];}}this.getAnalyticalConfigurationId=function(){var p,g;if(!a){a=jQuery.sap.getUriParameters().get('sap-apf-configuration-id');}if(a){g={};p=a.split(".");if(p.length===2){g.applicationId=p[0];g.configurationId=p[1];}else{g.configurationId=a;}}return g;};this.getSteps=function(){if(!s){s=jQuery.sap.getUriParameters().get('sap-apf-step-id');}if(!r){r=jQuery.sap.getUriParameters().get('sap-apf-representation-id');}if(!s){return null;}return[{stepId:s,representationId:r}];};this.getXappStateId=function(){var x=/(?:sap-xapp-state=)([^&=]+)/;var g=x.exec(window.location.hash);if(g){return g[1];}return null;};this.getApplicationConfigurationPath=function(){return b;};this.getEvaluationId=function(){return e;};this.isLrepActive=function(){if(m&&m.manifest&&m.manifest["sap.apf"]&&m.manifest["sap.apf"].activateLrep){return m.manifest["sap.apf"].activateLrep;}return false;};this.getSapClient=function(){return f;};this.isFilterReductionActive=function(){if(d&&d['sap-apf-filter-reduction']){return d['sap-apf-filter-reduction'][0];}if(m&&m.manifest&&m.manifest["sap.apf"]&&m.manifest["sap.apf"].activateFilterReduction){return m.manifest["sap.apf"].activateFilterReduction;}return false;};this.getParameter=function(p){if(d&&d[p]){return d[p][0];}return jQuery.sap.getUriParameters().get(p);};};}());};if(!jQuery.sap.isDeclared('sap.apf.utils.utils')){jQuery.sap.declare('sap.apf.utils.utils');jQuery.sap.require('sap.ui.core.format.DateFormat');(function(){'use strict';var f;sap.apf.utils.renderHeaderOfTextPropertyFile=function(a,m){var t=a.toLowerCase();var c=/^[0-9a-f]+$/;var i=c.test(t);if(!i||a.length!==32){m.putMessage(m.createMessageObject({code:"11009",aParameters:[a]}));t="<please enter valid translation uuid, if you want to upload into a SAP translation system>";}else{t=t.substring(0,8)+'-'+t.substring(8,12)+'-'+t.substring(12,16)+'-'+t.substring(16,20)+'-'+t.substring(20);}return"#FIORI: insert Fiori-Id\n"+"# __ldi.translation.uuid="+t+"\n"+"#ApfApplicationId="+a+"\n\n";};sap.apf.utils.getUriParameters=function(){return jQuery.sap.getUriParameters().mParams;};sap.apf.utils.renderTextEntries=function(h,m){f=false;var k=h.getKeys();k.sort(function(a,b){var v=h.getItem(a);var c=h.getItem(b);if(v.LastChangeUTCDateTime<c.LastChangeUTCDateTime){return-1;}if(v.LastChangeUTCDateTime>c.LastChangeUTCDateTime){return 1;}return 0;});var l=k.length;var r='';var i;for(i=0;i<l;i++){r=r+sap.apf.utils.renderEntryOfTextPropertyFile(h.getItem(k[i]),m);}return r;};sap.apf.utils.renderEntryOfTextPropertyFile=function(t,m){var d,D;if(!f&&(!t.TextElementType||!t.MaximumLength)){f=true;m.putMessage(m.createMessageObject({code:"11008",aParameters:[t.TextElement]}));}var e="#"+(t.TextElementType||"<Add text type>")+","+(t.MaximumLength||"<Add maximum length>");if(t.TranslationHint&&t.TranslationHint!==""){e=e+':'+t.TranslationHint;}e=e+"\n"+t.TextElement+"="+t.TextElementDescription+"\n";var o=sap.ui.core.format.DateFormat.getDateTimeInstance({pattern:"yyyy/MM/dd HH:mm:ss"});if(t.LastChangeUTCDateTime&&t.LastChangeUTCDateTime!==""){d=t.LastChangeUTCDateTime.replace(/\/Date\(/,'').replace(/\)\//,'');D=new Date(parseInt(d,10));}else{D=new Date();}e=e+"# LastChangeDate="+o.format(D)+'\n\n';return e;};sap.apf.utils.eliminateDuplicatesInArray=function(m,w){m.check((w!==undefined&&typeof w==='object'&&w.hasOwnProperty('length')===true),'Error - aArray is undefined');var r=[];var i,j;for(i=0;i<w.length;i++){for(j=i+1;j<w.length;j++){if(w[i]===w[j]){j=++i;}}r.push(w[i]);}return r;};sap.apf.utils.hashCode=function(v){var n=0;var i;var a=0;v=v.toString();var l=v.length;for(i=0;i<l;i++){a=v.charCodeAt(i);n=(17*n+a)<<0;}return n;};sap.apf.utils.escapeOdata=function(v){if(typeof v==="string"){return v.replace("'","''");}return v;};sap.apf.utils.json2javascriptFormat=function(v,t){var i;switch(t){case"Edm.Boolean":if(typeof v==="boolean"){return v;}if(typeof v==="string"){return v.toLowerCase()==="true";}return false;case"Edm.Decimal":case"Edm.Guid":case"Edm.Int64":case"Edm.String":return v;case"Edm.Int16":case"Edm.Int32":return parseInt(v,10);case"Edm.Single":case"Edm.Float":return parseFloat(v);case"Edm.Time":return v;case"Edm.DateTime":i=v.replace('/Date(','').replace(')/','');i=parseFloat(i);return new Date(i);case"Edm.DateTimeOffset":i=v.replace('/Date(','');i=i.replace(')/','');i=parseFloat(i);return new Date(i);default:return v;}return v;};sap.apf.utils.formatValue=function(a,t){function c(v){var b;if(v instanceof Date){return v;}if(typeof v==='string'){if(v.substring(0,6)==='/Date('){b=v.replace('/Date(','');b=b.replace(')/','');b=parseInt(b,10);return new Date(b);}return new Date(v);}}var d;var F="";if(a===null||a===undefined){return"null";}switch(t){case"Edm.String":F="'"+String(a).replace(/'/g,"''")+"'";break;case"Edm.Time":if(typeof a==='number'){d=new Date();d.setTime(a);var h=d.getUTCHours();if(h<10){h='0'+h;}var m=d.getUTCMinutes();if(m<10){m='0'+m;}var s=d.getUTCSeconds();if(s<10){s='0'+s;}F="time'"+h+':'+m+':'+s+"'";}else{F="time'"+a+"'";}break;case"Edm.DateTime":if(!sap.apf.utils.formatValue.oDateTimeFormat){sap.apf.utils.formatValue.oDateTimeFormat=sap.ui.core.format.DateFormat.getDateInstance({pattern:"'datetime'''yyyy-MM-dd'T'HH:mm:ss''"});}d=c(a);F=sap.apf.utils.formatValue.oDateTimeFormat.format(d,true);break;case"Edm.DateTimeOffset":if(!sap.apf.utils.formatValue.oDateTimeOffsetFormat){sap.apf.utils.formatValue.oDateTimeOffsetFormat=sap.ui.core.format.DateFormat.getDateInstance({pattern:"'datetimeoffset'''yyyy-MM-dd'T'HH:mm:ss'Z'''"});}d=c(a);F=sap.apf.utils.formatValue.oDateTimeOffsetFormat.format(d,true);break;case"Edm.Guid":F="guid'"+a+"'";break;case"Edm.Decimal":F=a+"M";break;case"Edm.Int64":F=String(a)+"L";break;case"Edm.Single":F=a+"f";break;case"Edm.Binary":F="binary'"+a+"'";break;default:F=a;break;}return F;};sap.apf.utils.extractFunctionFromModulePathString=function(F){if(jQuery.isFunction(F)){return F;}var d,n,s;n=F.split('.');d=window;var i;for(i=0;i<n.length-1;i++){d=d[n[i]];if(!d){return undefined;}}s=n[n.length-1];return d[s];};sap.apf.utils.isValidGuid=function(a){return/^[0-9A-F]{32}$/.test(a);};sap.apf.utils.isValidPseudoGuid=function(a){return/^[0-9A-F]{32}$/.test(a);};sap.apf.utils.createPseudoGuid=function(l){if(!l){l=32;}var a=Date.now().toString();var d=l-a.length;a+=g(d);return a;};function g(l){var r="";var a,m;while(r.length<l){a=Math.min(10,l-r.length);m=Math.pow(10,a);r+=Math.floor((Math.random()*m));}return r;}sap.apf.utils.migrateConfigToCategoryStepAssignment=function(a,i){var H=i.constructor.hashtable;var c=new H(i.instance.messageHandler);if(a.steps){a.steps.forEach(function(s){if(s.categories){s.categories.forEach(function(b){var d=c.getItem(b.id);if(!d){d={category:b.id,steps:[{type:"step",id:s.id}]};c.setItem(b.id,d);}else{d.steps.push({type:"step",id:s.id});}});delete s.categories;}});}if(a.categories){a.categories.forEach(function(b){if(!b.steps){var d=c.getItem(b.id);if(d){b.steps=d.steps;}else{b.steps=[];}}});}};sap.apf.utils.executeFilterMapping=function(i,m,t,c,M){m.sendGetInBatch(i,a);function a(r){var F;if(r&&r.type&&r.type==="messageObject"){M.putMessage(r);c(undefined,r);}else{F=new sap.apf.core.utils.Filter(M);r.data.forEach(function(d){var o=new sap.apf.core.utils.Filter(M);t.forEach(function(T){o.addAnd(new sap.apf.core.utils.Filter(M,T,sap.apf.core.constants.FilterOperators.EQ,d[T]));});F.addOr(o);});c(F,undefined);}}};}());};if(!jQuery.sap.isDeclared('sap.apf.core.ajax')){jQuery.sap.declare("sap.apf.core.ajax");(function(){'use strict';sap.apf.core.ajax=function(s){var a=jQuery.extend(true,{},s);var b=a.beforeSend;var S=a.success;var e=a.error;a.beforeSend=function(j,c){if(b){b(j,c);}};a.success=function(d,t,j){var m=sap.apf.core.utils.checkForTimeout(j);if(m){e(d,"error",undefined,m);}else{S(d,t,j);}};a.error=function(j,t,c){var m=sap.apf.core.utils.checkForTimeout(j);if(m){e(j,t,c,m);}else{e(j,t,c);}};return jQuery.ajax(a);};}());};if(!jQuery.sap.isDeclared('sap.apf.core.layeredRepositoryProxy')){jQuery.sap.declare("sap.apf.core.layeredRepositoryProxy");jQuery.sap.require('sap.ui.thirdparty.datajs');jQuery.sap.require('sap.ui.fl.LrepConnector');(function(){'use strict';sap.apf.core.LayeredRepositoryProxy=function(s,a){var c=a.instance.coreApi;var b;var m=a.instance.messageHandler;var n='sap/apf/dt';var t='text.properties';var d=new sap.apf.utils.Hashtable(a.instance.messageHandler);var e=new sap.apf.utils.Hashtable(a.instance.messageHandler);this.getConnector=function(){return b;};this.readEntity=function(L,M,N,O,P,Q,R){var S=N[0].value;var T=r(Q);var U=[];var V=false;var W=1;var X=0;var Y;var Z;var $;var i;var _;var a1;var b1;var c1;var d1=o(R);a.instance.messageHandler.check(L==='configuration',"layered repository proxy - only read entity of configuration supported");if(P!==undefined&&P===false){return K(M,S,Q,O,R);}if(O===undefined||O.indexOf("SerializedAnalyticalConfiguration")>=0){V=true;var e1=b.getStaticResource(T,S,'apfconfiguration');U.push(e1);}else{W=0;}Y=k(Q,S);if(Y===undefined){var f1=b.getFileAttributes(T,S,'apfconfiguration',d1);U.push(f1);}Z=Promise.all(U);Z.then(function(g1){Y=k(Q,S);if(Y===undefined){Y=g1[W].response;}l(Q,S,Y);$=E(Q,Y);if(V){c1=g1[X].response;if(c1 instanceof String){$.SerializedAnalyticalConfiguration=c1;}else{$.SerializedAnalyticalConfiguration=JSON.stringify(c1);}}$.AnalyticalConfiguration=S;if(O&&O.length!==0){_=O.length;a1={};for(i=0;i<_;i++){b1=O[i];a1[b1]=$[b1];}$=a1;}M($,q());},function(g1){M(undefined,q(),p('5201'));});};this.doChangeOperationsInBatch=function(L,M,N){function O(R,S){M(S);}var i,P;function Q(){}w(N).then(function(){for(i=0;i<L.length;i++){P=L[i];P.application=N;if(P.method==='DELETE'&&P.entitySetName==='texts'){u(P,Q);}else if(P.method==='POST'&&sap.apf.utils.isValidPseudoGuid(P.data.TextElement)){x(P.data,Q);}else{x(P.data,Q);}}y(N,O,true);}).fail(function(R){M(R);});};this.readCollectionsInBatch=function(L,M,N){var O=L.length;var P=[];var Q=0;function R(T){function U(V,W,X){if(X){M(undefined,X);}else{Q++;P[T]=V;if(Q===O){M(P);}}}return U;}for(var i=0;i<O;i++){var S=L[i];this.readCollection(S.entitySetName,R(i),S.inputParameters,S.selectList,S.filter,N);}};this.readCollection=function(i,L,M,N,O,P,Q){var R=this;var T,S,U;var V;var W;if(Q&&Q.layer){W=Q.layer;}else{W="CUSTOMER";}var X=function(U){var Z=new sap.apf.utils.Hashtable(a.instance.messageHandler);var $=[];var _=(U&&U.response)||(U&&U.responseText)||"";var a1=sap.apf.utils.parseTextPropertyFile(_,{instance:{messageHandler:m}});Z=new sap.apf.utils.Hashtable(a.instance.messageHandler);a1.TextElements.forEach(function(b1){Z.setItem(b1.TextElement,b1);$.push(b1);});d.setItem(S,Z);L($,q());};if(i==='application'){m.check(!M&&!N&&!O,"unsupported parameters when calling readCollection for application");m.check(P===undefined||P===true,'no async readCollection of application supported');J(L,W);}else if(i==='texts'){T=O.getFilterTermsForProperty('Application');S=T[0].getValue();if(P!==undefined&&P===false){v(S,X,true,Q);}else{V=v(S,undefined,false,Q);V.then(function(U){X(U);},function(Z){var $=I(Error);L(undefined,q(),$);});}}else if(i==='configuration'){T=O.getFilterTermsForProperty('Application');S=T[0].getValue();U=[];var Y=function(Z,$){function _(a1,b1,$){U.push(a1);if(U.length===Z.length){L(U,q(),$);}}if(Z.length===0){L(U,q(),$);}Z.forEach(function(a1){R.readEntity('configuration',_,[{value:a1}],N,P,S);});};z(S,Y);}};this.remove=function(i,L,M,N,O,P){if(!P){P="CUSTOMER";}if(i==='application'){H(L,M,P);}else if(i==='configuration'){D(L,M,O,P);}else{m.check(false,'the remove operation on entity set '+i+' is currently not supported by the lrep proxy');}};this.create=function(i,L,M,N,O){if(i==='application'){m.check(N===undefined||N===true,'no async creation of application supported');F(L,M,O);}else if(i==='configuration'){m.check(N===undefined||N===true,'no async creation of configuration supported');C(L,M,O);}else if(i==='texts'&&N===false){x(L,M,false);}else{m.check(false,'the create operation on entity set '+i+' is currently not supported by the lrep proxy');}};this.update=function(i,L,M,N){if(i==='configuration'){B(L,M);}else if(i==='application'){G(L,M);}else{m.check(false,'the update operation on entity set '+i+' is currently not supported by the lrep proxy');}};function f(i){var O={async:true,contentType:'application/json'};var P=[];P.push({name:"layer",value:i});P.push({name:"deep-read",value:true});P.push({name:"metadata",value:true});var R="/sap/bc/lrep/content/"+n+"/";R+=b._buildParams(P);return b.send(R,'GET',{},O);}function g(i){var n=i.ns.split('/');return n[n.length-2];}function h(i,L){var M;i.metadata.forEach(function(N){if(N.name===L){M=N.value;}});return M;}this.readAllConfigurationsFromVendorLayer=function(){var i=jQuery.Deferred();var L=[];f('VENDOR').then(function(M){var N={};M.response.forEach(function(O){if(O.fileType&&O.fileType==='apfapplication'){N[g(O)]=h(O,'apfdt-applname');}});M.response.forEach(function(O){var P;var Q;var R;if(O.fileType&&O.fileType==="apfconfiguration"){P=g(O);Q=O.name;if(!(sap.apf.utils.isValidPseudoGuid(P)&&sap.apf.utils.isValidPseudoGuid(Q))){return;}R=h(O,'apfdt-configname');L.push({configurationText:R,applicationText:N[P],value:P+'.'+Q});}});i.resolve(L);},function(){i.reject(m.createMessageObject({code:'5201'}));});return i.promise();};j();function j(){if(a.constructor&&a.constructor.LrepConnector){b=a.constructor.LrepConnector.createConnector();}else{b=sap.ui.fl.LrepConnector.createConnector();}if(!b._sClient){b._sClient=c.getStartParameterFacade().getSapClient();}}function k(i,L){var M=e.getItem(i);if(M===undefined){return;}L=M.getItem(L);return L;}function l(i,L,M){var N=e.getItem(i);if(N===undefined){N=new sap.apf.utils.Hashtable(a.instance.messageHandler);}N.setItem(L,M);e.setItem(i,N);}function o(i){var L=(i&&i.layer)||"CUSTOMER";if(L==="ALL"){return undefined;}return L;}function p(i,L){return m.createMessageObject({code:i,aParameters:L});}function q(){return{};}function r(i){return n+'/'+i;}function u(i,L){var M=i.application;var N=i.inputParameters[0].value;var O;w(M).done(function(){O=d.getItem(M);O.removeItem(N);L(i,q());}).fail(function(){L(undefined,q(),p('5201'));});}function v(i,L,M,N){var O;var P=[];var R="/sap/bc/lrep/content/";var Q=o(N);R+=n+"/"+i+'/'+t;if(Q){P.push({name:"layer",value:Q});}O={contentType:'text/plain'};if(M){O.complete=L;O.async=false;}R+=b._buildParams(P);return b.send(R,'GET',undefined,O);}function w(i,L){var M=jQuery.Deferred();var N;var O=d.getItem(i);var P=function(Q){var R=(Q&&Q.response)||(Q&&Q.responseText)||"";var S=sap.apf.utils.parseTextPropertyFile(R,{instance:{messageHandler:m}});O=new sap.apf.utils.Hashtable(a.instance.messageHandler);S.TextElements.forEach(function(T){O.setItem(T.TextElement,T);});d.setItem(i,O);M.resolve({});};if(O===undefined){if(L!==undefined&&L===false){v(i,P,true);}else{N=v(i,undefined,false);N.then(function(Q){P(Q);},function(Q){M.reject(p('5201'));});}}else{M.resolve({});}return M.promise();}function x(i,L,M){var N=i.Application;if(i.TextElement===undefined||!sap.apf.utils.isValidGuid(i.TextElement)){i.TextElement=sap.apf.utils.createPseudoGuid();}w(N,M).done(function(){var O=d.getItem(N);O.setItem(i.TextElement,i);L(i,q());}).fail(function(){L(undefined,q(),p('5201'));});}function y(i,L,M){var N=r(i);var O;function P(){var R=sap.apf.utils.renderHeaderOfTextPropertyFile(i,m);R=R+sap.apf.utils.renderTextEntries(O,m);var S=b.upsert(N,'text','properties',"CUSTOMER",R,'text/plain');S.then(function(T){L(q());},function(T){L(q(),p('5201'));});}O=d.getItem(i);if(!O){L(q());return;}if(M){P();}else{var Q=v(i,undefined,false);Q.then(function(R){var S=(R&&R.response)||"";var T=sap.apf.utils.parseTextPropertyFile(S,{instance:{messageHandler:m}});T.TextElements.forEach(function(U){O.setItem(U.TextElement,U);});P();},function(R){L(q(),p('5201'));});}}function z(L,M){var i,N;var O=r(L);var P=b.listContent(O,'CUSTOMER');P.then(function(Q){var R=Q.response;N=[];for(i=0;i<R.length;i++){if(R[i].fileType==="apfconfiguration"){N.push(R[i].name);}}M(N);},function(Q){M([]);});}function A(i,L,M,N){var O=N||'CUSTOMER';var P=r(i);var Q=b.getFileAttributes(P,L,'apfconfiguration',O);Q.then(function(R){var S=R.response;if(O==='CUSTOMER'){l(i,L,S);y(i,M);}else{M(q());}},function(R){M(q(),p('5201'));});}function B(i,L,M){if(!M){M="CUSTOMER";}var N=i.Application;var O=i.AnalyticalConfiguration;var P=JSON.parse(i.SerializedAnalyticalConfiguration);var Q=r(N);var R=b.getStaticResource(Q,"metadata","apfapplication");R.then(function(S){var T={Application:N,ApplicationName:S.response.ApplicationName,SemanticObject:S.response.SemanticObject,AnalyticalConfiguration:O,AnalyticalConfigurationName:i.AnalyticalConfigurationName,CreationUTCDateTime:i.CreationUTCDateTime,LastChangeUTCDateTime:i.LastChangeUTCDateTime};P=jQuery.extend(true,P,{configHeader:T});P=JSON.stringify(P);var U=b.upsert(Q,O,'apfconfiguration',M,P,'application/json');return U;},function(S){L(q(),p('5201'));}).then(function(S){A(N,O,L,M);},function(S){L(q(),p('5201'));});}function C(i,L,M){var N=o(M);var O=i.Application;var P=i.AnalyticalConfiguration;if(P===undefined||!sap.apf.utils.isValidGuid(P)){P=sap.apf.utils.createPseudoGuid(32);}var Q=JSON.parse(i.SerializedAnalyticalConfiguration);var R=r(O);var S=b.getStaticResource(R,"metadata","apfapplication");S.then(function(U){var V={Application:O,ApplicationName:U.response.ApplicationName,SemanticObject:U.response.SemanticObject,AnalyticalConfiguration:P,AnalyticalConfigurationName:Q.analyticalConfigurationName,CreationUTCDateTime:i.CreationUTCDateTime,LastChangeUTCDateTime:i.LastChangeUTCDateTime};Q=jQuery.extend(true,Q,{configHeader:V});Q=JSON.stringify(Q);T(O,P,i.AnalyticalConfigurationName,Q,L);},function(U){L(undefined,q(),p('5201'));});function T(O,P,U,Q,L){var R=r(O);var V=b.upsert(R,P,'apfconfiguration',N,Q,'application/json');V.then(function(W){A(O,P,function(X,Y,Z){if(!Z){L({AnalyticalConfiguration:P,AnalyticalConfigurationName:i.AnalyticalConfigurationName},q());}else{L(undefined,q(),p('5201'));}},N);},function(W){L(undefined,q(),p('5201'));});}}function D(i,L,M,N){var O=i[0].value;m.check(O!==undefined,"configuration may not be undefined");m.check(M!==undefined,"application of configuration not found");var P=r(M);var Q=b.deleteFile(P,O,'apfconfiguration',N);Q.then(function(R){L(q());},function(R){L(q(),p('5201'));});}function E(L,M){var i=0;var N={Application:L};var O,P;for(i=0;i<M.length;i++){O=M[i].name;P=M[i].value;if(O==="apfdt-applname"){O="ApplicationName";}else if(O==='createdAt'){O="CreationUTCDateTime";}else if(O==='createdBy'){O="CreatedByUser";}else if(O==='lastChangedAt'){O="LastChangeUTCDateTime";}else if(O==='lastChangedBy'){O="LastChangedByUser";}else if(O==="apfdt-configname"){O='AnalyticalConfigurationName';}else if(O==='size'||O==='layer'){continue;}N[O]=P;}return N;}function F(i,L,M){m.check(i.ApplicationName!==undefined&&i.ApplicationName!=="","Valid application name is required");var N=i.Application;if(N===undefined||!sap.apf.utils.isValidGuid(N)){N=sap.apf.utils.createPseudoGuid(32);}var O=JSON.stringify({ApplicationName:i.ApplicationName,SemanticObject:i.SemanticObject,Application:N});var P=sap.apf.utils.renderHeaderOfTextPropertyFile(N,m);var Q=o(M);function R(){L(undefined,q(),p('5201'));}var S=r(N);var T=b.upsert(S,'metadata','apfapplication',Q,O,'application/json');T.then(function(U){var V=b.upsert(S,'text','properties',Q,P,'text/plain');V.then(function(W){d.setItem(N,new sap.apf.utils.Hashtable(a.instance.messageHandler));L({Application:N,ApplicationName:i.ApplicationName,SemanticObject:i.SemanticObject},q());},R);},R);}function G(i,L){m.check(i.ApplicationName!==undefined&&i.ApplicationName!=="","Valid application name is required");var M=i.Application;var N=JSON.stringify({ApplicationName:i.ApplicationName,SemanticObject:i.SemanticObject,Application:M});function O(){L(undefined,p('5201'));}var P=r(M);var Q=b.upsert(P,'metadata','apfapplication','CUSTOMER',N,'application/json');Q.then(function(R){L({Application:M,ApplicationName:i.ApplicationName,SemanticObject:i.SemanticObject});},O);}function H(i,L,M){var N=i[0].value;function O(R){var S=I(R);L(q(),S);}var P=r(N);var Q=b.listContent(P,M);Q.then(function(R){var S=R.response;var T=[];S.forEach(function(V){T.push(b.deleteFile(P,V.name,V.fileType,V.layer));});var U=Promise.all(T);return U;},O).then(function(R){L(q());},O);}function I(i){var L;if(i.messageObject&&i.messageObject.getCode){L=i.messageObject;}else if(i.response&&i.response.statusCode&&i.response.statusCode>=400){L=m.createMessageObject({code:'11005',aParameters:[i.response.statusCode.toString(),i.response.statusText]});}else{L=m.createMessageObject({code:'5201'});}m.putMessage(L);return L;}function J(i,L){var M=[];f(L).then(function(O){var P=O.response;P.forEach(function(P){var Q;var R;if(P.fileType&&P.fileType==="apfapplication"){Q=g(P);if(!sap.apf.utils.isValidPseudoGuid(Q)){return;}R="";var S="";R=h(P,'apfdt-applname');M.push({Application:Q,ApplicationName:R,SemanticObject:S});}});i(M,q());},N);function N(O){i(undefined,q(),m.createMessageObject({code:'5201'}));}}function K(i,L,M,N,O){var P=o(O);var Q={async:false,complete:function(U){var V={};V.SerializedAnalyticalConfiguration=U.responseText;i(V,q());}};var R=[];var S;var T="/sap/bc/lrep/content/";a.instance.messageHandler.check(N===undefined||N.indexOf("SerializedAnalyticalConfiguration")>=0,"layered repository proxy - read configuration async without analytical configuration - not supported call");T+=n+"/"+M+'/'+L+'.apfconfiguration';if(P){R.push({name:"layer",value:P});}T+=b._buildParams(R);S=b.send(T,'GET',{},Q);S.then(function(U){},function(U){i(undefined,q(),p('5201'));});}};}());};if(!jQuery.sap.isDeclared('sap.apf.core.messageHandler')){jQuery.sap.declare("sap.apf.core.messageHandler");(function(){'use strict';sap.apf.core.MessageHandler=function(l){var t=this;var T;var L=[];var n=0;var a;var m;var A=function(){};var o=false;var d=false;var D=false;var h=false;var u="";var b={code:sap.apf.core.constants.message.code.errorUnknown,severity:sap.apf.core.constants.message.severity.error,rawText:"Unknown Error occurred"};this.createMessageObject=function(C){if(l){var M=new sap.apf.core.MessageObject(C);if(M.getCode()===undefined){M.setCode(sap.apf.core.constants.message.code.errorUnknown);}p.bind(this)(M);q(M,1);}return new sap.apf.core.MessageObject(C);};this.activateOnErrorHandling=function(O){o=O;if(o===true){jQuery(window).on("error",v);}else{jQuery(window).off("error");}};this.setTextResourceHandler=function(i){T=i;};this.loadConfig=function(M,R){if(a===undefined||R){a=new sap.apf.utils.Hashtable(t);}for(var i=0;i<M.length;i++){r(M[i]);}};this.setMessageCallback=function(C){if(C!==undefined&&typeof C==="function"){m=C;}else{m=undefined;}};this.setApplicationMessageCallback=function(C){if(C!==undefined&&typeof C==="function"){A=C;}else{A=function(){};this.putMessage(this.createMessageObject({code:"5031"}));}};this.putMessage=function(M){var P;var i=0;var x;if(M.getCode()===undefined){M.setCode(sap.apf.core.constants.message.code.errorUnknown);}p.bind(this)(M);if(M.getSeverity()===sap.apf.core.constants.message.severity.fatal){x=t.createMessageObject({code:sap.apf.core.constants.message.code.errorExitTriggered});p.bind(this)(x);x.setSeverity(sap.apf.core.constants.message.severity.fatal);if(x.getMessage()===""){x.setMessage("You must log out of the application due to a critical error");}}P=M.getPrevious();while(P!==undefined&&P.type&&P.type==="messageObject"&&i<10){if(P.getCode()===undefined){P.setCode(sap.apf.core.constants.message.code.errorUnknown);}p.bind(this)(P);P=P.getPrevious();i++;}if(x!==undefined){x.setPrevious(M);M=x;}if(!l){q(M,10);}if(d){return;}if(m!==undefined){d=true;m(M,A);d=false;}if(M.getSeverity()===sap.apf.core.constants.message.severity.fatal){if(sap.ui.Device.browser.firefox){h=true;}throw new Error(u);}};this.check=function(i,M,C){var E=C||sap.apf.core.constants.message.code.errorCheck;if(!i){var x=this.createMessageObject({code:E,aParameters:[M]});t.putMessage(x);}};this.getConfigurationByCode=function(E){if(a===undefined){return undefined;}return a.getItem(E);};this.getLogMessages=function(){return jQuery.extend(true,[],L);};this.reset=function(){a=undefined;m=undefined;A=undefined;L=[];};function c(E){if(sap.ui.Device.browser.firefox){return h;}return(E.originalEvent&&E.originalEvent.message&&E.originalEvent.message.search(u)>-1);}function e(E){return(E.originalEvent&&E.originalEvent.message&&E.originalEvent.message.search(u)===-1&&E.originalEvent.message.search(sap.apf.core.constants.message.code.suppressFurtherException)>-1);}function g(){var i=new Date();var x=Math.random()*i.getTime();return sap.apf.core.constants.message.code.suppressFurtherException+x;}function f(C){var N=parseInt(C,10);if(N==sap.apf.core.constants.message.code.errorExitTriggered){return true;}else if(N>=sap.apf.core.constants.message.code.errorUnknown&&N<=sap.apf.core.constants.message.code.warningAnalyticalConfig){return true;}return false;}function j(C){var N=parseInt(C,10);if(N>sap.apf.core.constants.message.code.errorUnknown&&N<=sap.apf.core.constants.message.code.errorInAnalyticalConfig){return true;}return false;}function k(C){var N=parseInt(C,10);if(N===sap.apf.core.constants.message.code.warningAnalyticalConfig){return true;}return false;}function p(M){var C=M.getCode();var i=t.getConfigurationByCode(C);if(i===undefined){i=jQuery.extend(true,{},b);if(f(C)){if(M.hasRawText()){i.rawText=M.getRawText();}i.rawText+=' '+M.getParameters();if(j(C)){i.severity=sap.apf.core.constants.message.severity.fatal;}else if(k(C)){i.severity=sap.apf.core.constants.message.severity.warning;}}else{i.rawText="Message "+C+"  "+M.getParameters()+" (Message Code has no Configuration)";}if(!f(C)){M.setCode(i.code);}}if(i.severity!==undefined){M.setSeverity(i.severity);}else{M.setSeverity(sap.apf.core.constants.message.severity.technError);}if(i.rawText){M.setMessage(i.rawText);}else{var P=M.getParameters();if(M.getSeverity()===sap.apf.core.constants.message.severity.technError){var x=t.getConfigurationByCode(i.code).text;if(!x){x=t.getConfigurationByCode(i.code).description;}var y=0;while(x.indexOf("{"+y+"}")>-1){if(typeof P[y]==="string"){x=x.replace("{"+y+"}",P[y]);}else{x=x.replace("{"+y+"}","undefined");}y++;}M.setMessage(x);}else{try{if(T){M.setMessage(T.getMessageText(i.key,M.getParameters()));}else{M.setMessage("Message Code: "+C+" "+P.toString());}}catch(E){M.setMessage("Message Code: "+C+" "+P.toString());}}}}function q(M,i){var x="APF message ";var P="";var y=i-1;if(i===0){return;}var z=M.getPrevious();if(z!==undefined){q(z,y);P=" - (see previous message for more information)";}n++;var B=x+'('+n+'): '+M.getCode()+" - "+M.getMessage()+P;if(D){alert("Fatal Error during Log Writing "+B);return;}D=true;if(M.getSeverity()===sap.apf.core.constants.message.severity.fatal){if(L.length<2){L.unshift(B);}}switch(M.getSeverity()){case sap.apf.core.constants.message.severity.warning:jQuery.sap.log.warning(B);break;case sap.apf.core.constants.message.severity.error:jQuery.sap.log.error(B);break;case sap.apf.core.constants.message.severity.fatal:jQuery.sap.log.error(B);break;case sap.apf.core.constants.message.severity.technError:jQuery.sap.log.error(B);break;default:jQuery.sap.log.info(B);}D=false;}function s(i){t.check(i!==undefined&&i.hasOwnProperty("code")!==false,"MessageHandler setItem: oItem is undefined or property 'code' is missing",sap.apf.core.constants.message.code.errorStartUp);var x=a.setItem(i.code,i);t.check((x===undefined),"MessageHandler setItem: Configuration includes duplicated codes",sap.apf.core.constants.message.code.errorStartUp);}function r(M){if(M.type===undefined){M.type="message";}s(M);}function v(E){var M;var i="";var x="";var U="";var y="";var B=true;if(sap.ui.Device.browser.firefox){B=false;}if(B&&E&&E.originalEvent){i=E.originalEvent.message;U=E.originalEvent.filename;x=E.originalEvent.lineno;}if(c(E)){E.stopImmediatePropagation();E.preventDefault();}else if(e(E)){return;}else if(d){M=new sap.apf.core.MessageObject({code:sap.apf.core.constants.message.code.errorStopProcessing});M.setSeverity(sap.apf.core.constants.message.severity.error);y="Unknown exception happened during processing of error by callback function ";if(B){y=y+i+" (source: "+U+":"+x+")";}M.setMessage(y);q(M,1);}else{M=new sap.apf.core.MessageObject({code:sap.apf.core.constants.message.code.errorUnknown});M.setSeverity(sap.apf.core.constants.message.severity.error);y="Unknown exception ";if(B){y=y+i+" (source: "+U+":"+x+")";}M.setMessage(y);q(M,1);}}function w(){u=g();}w();};}());};if(!jQuery.sap.isDeclared('sap.apf.core.metadata')){jQuery.sap.declare("sap.apf.core.metadata");(function(){'use strict';sap.apf.core.Metadata=function(I,a){this.type="metadata";var t=this;var c=I.coreApi;var A=[];var H=I.hashtable;var h=new H(I.messageHandler);var o=new H(I.messageHandler);var b=new H(I.messageHandler);var d=new H(I.messageHandler);var e=new H(I.messageHandler);var f=new H(I.messageHandler);var g=new H(I.messageHandler);var j=new H(I.messageHandler);var k=new H(I.messageHandler);var l=new H(I.messageHandler);var m=new H(I.messageHandler);var O=I.ODataModel||sap.ui.model.odata.ODataModel;var D=false;if(I.deactivateFatalError){D=true;}var M;var E;var s;function n(){return A;}function p(i){var L;function N(Q){if(!L.dataType){L.dataType={};}L.dataType[Q]=L[Q];delete L[Q];}function P(Q,R){if(jQuery.isArray(L[R])===true){(L[R]).forEach(function(S){L[S.name]=S.value;});delete L[R];}else if(R!=="dataType"&&typeof(L[R])==="object"){if(Object.keys(L[R]).length===0){L[Q]="true";}jQuery.each(L[R],function(S,T){L[Q]=T;});delete L[R];}else{L[Q]=L[R];}}if(i===null){return{};}L=jQuery.extend(true,{},i);jQuery.each(L,function(Q){switch(Q){case'type':N(Q);break;case'maxLength':N(Q);break;case'precision':N(Q);break;default:var R=Q.split(".").pop();if(R.search("ISO")===0){P(R,Q);}else{P(R.replace(/^./,R[0].toLowerCase()),Q);}break;}});r(L);return L;}function r(L){for(var i in L){if(/^sap:/.test(i)){delete L[i];}}}function q(i,L){if(d.hasItem(i)!==true){var N;var P={};var R={allParameters:[],keyParameters:[]};if(z(i)){N=J(i);if(N.key&&N.key.propertyRef){N.key.propertyRef.forEach(function(Q){P[Q.name]=null;});}N.property.forEach(function(Q){var S=p(Q);S.isKey=P.hasOwnProperty(S.name);R.allParameters.push(S);if(S.isKey){R.keyParameters.push(S);}});}d.setItem(i,R);}if(!L){return d.getItem(i).allParameters;}return d.getItem(i).keyParameters;}function u(i){var P=[];var L;if(z(i)){i=G(i);}L=J(i);L.property.forEach(function(N){P.push(N.name);});return P;}function v(L){var i;if(b.hasItem(L)===true){return b.getItem(L);}var N;var P=[];var Q=[];var R=G(L);if(R&&B(R)){var S=J(R);S.property.forEach(function(U){P.push(U.name);});}var T=q(L,false);for(i=0;i<T.length;i++){Q.push(T[i].name);}N=P.concat(Q);b.setItem(L,N);return N;}function w(i){return f.getItem(i);}function x(i){var L;if(J(i)){L=i;}else{L=w(i);L=L||w(i+"Results");}return L;}function y(i){if(o.hasItem(i)===false){var R=[];if(B(i)){var L=J(i);L.property.forEach(function(N){if(!(N["sap:filterable"]==="false"||N.filterable&&N.filterable==="true")){R.push(N.name);}});}o.setItem(i,R);}return o.getItem(i);}function z(i){return C(i)==="parameters";}function B(i){return C(i)==="aggregate";}function C(i){if(!g.hasItem(i)){var L=J(i);var N=L&&L["sap:semantics"]||"undefined";g.setItem(i,N);}return g.getItem(i);}function F(i,P){if(h.hasItem(i+P)===false){var L=z(i);var N=J(i);var Q=M.getODataProperty(N,P);if(!Q&&L){var R=G(i);N=J(R);Q=M.getODataProperty(N,P);}h.setItem(i+P,p(Q));}return h.getItem(i+P);}function G(i){var R=k.getItem(i);if(R){return w(R.toAggregateEntitySet);}return i;}function J(i){if(!i){return undefined;}if(!m.hasItem(i)){var L=M.getODataEntityType(E+i);if(!L){return L;}m.setItem(i,L);}return m.getItem(i);}function K(){var i=S();var L;if(!i.getServiceMetadata()){L="5018";if(D){L="11013";}I.messageHandler.putMessage(I.messageHandler.createMessageObject({code:L,aParameters:[a],oCallingObject:t}));t.failed=true;return;}M=i.getMetaModel();N();P();Q(i);R();function N(){var T={};M.getODataEntityContainer().entitySet.forEach(function(U){var V=U.entityType.split(/[. ]+/).pop();f.setItem(U.name,V);if(!T.hasOwnProperty(V)){T[V]=true;A.push(V);}});}function P(){var T=M.getODataEntityContainer().entitySet[0].entityType.split(".");T.pop();E=T.join(".")+".";}function Q(T){var U=T.getServiceAnnotations();if(U&&U.aliasDefinitions&&U.aliasDefinitions.Capabilities){s=U.aliasDefinitions.Capabilities+".";}}function R(){var T=M.getODataEntityContainer();if(!T.associationSet){return;}T.associationSet.forEach(function(U){var V=U.end[0].entitySet,W=U.end[1].entitySet,X,Y;if(z(w(V))){X=V;}else if(B(w(V))){Y=V;}if(z(w(W))){X=W;}else if(B(w(W))){Y=W;}if(!X||!Y){return;}var Z;var $=J(w(X));var _;$.navigationProperty.forEach(function(b1){if(_){return;}if(b1.relationship===U.association){Z=b1.name;_=true;}});if(!Z){return;}var a1={navigationProperty:Z,fromParameterEntitySet:X,toAggregateEntitySet:Y,fromIsUnique:undefined,toIsUnique:undefined};if(j.hasItem(X)){a1.fromIsUnique=false;j.getItem(X).fromIsUnique=false;}else{a1.fromIsUnique=true;j.setItem(X,a1);k.setItem(w(X),a1);}if(l.hasItem(Y)){l.getItem(Y).toIsUnique=false;}else{a1.toIsUnique=true;l.setItem(Y,a1);}});}function S(){var T;var U=c.getUriGenerator().getODataPath(a)+"annotation.xml";var V=I.fileExists.check(U);if(V){T={loadMetadataAsync:false,annotationURI:U,json:true};}else{T={loadMetadataAsync:false,json:true};}return new O(a,T);}}this.getPropertyMetadata=function(i,P){I.messageHandler.check(i!==undefined&&typeof i==="string","sap.apf.core.Metadata:getPropertyMetadata incorrect EntityType name or type");I.messageHandler.check(P!==undefined&&typeof P==="string","sap.apf.core.Metadata:getPropertyMetadata incorrect sPropertyName name or type");var L=x(i);if(!L){return{};}return F(L,P);};this.getUriComponents=function(i){if(!w(i)){if(w(i+"Results")){return{entitySet:i+"Results",navigationProperty:""};}return null;}var R;switch(C(w(i))){case"undefined":return{entitySet:i,navigationProperty:""};case"parameters":R=j.getItem(i);if(!R||R.fromIsUnique===false){return{entitySet:i,navigationProperty:undefined};}return{entitySet:i,navigationProperty:R.navigationProperty};case"aggregate":R=l.getItem(i);if(!R){return{entitySet:i,navigationProperty:""};}if(R.toIsUnique===false){return{entitySet:undefined,navigationProperty:undefined};}return{entitySet:R.fromParameterEntitySet,navigationProperty:R.navigationProperty};default:I.messageHandler.check(false,"metadata : getUriComponents - not handled return value for sap semantics");}};this.getFilterableProperties=function(i){I.messageHandler.check(i!==undefined&&typeof i==="string","sap.apf.core.Metadata:getFilterableProperties incorrect EntityType name or type");var L=x(i);if(!L){return[];}L=G(L);return y(L);};this.getAllPropertiesOfEntitySet=function(i){I.messageHandler.check(i!==undefined&&typeof i==="string","sap.apf.core.Metadata:getAllPropertiesOfEntitySet incorrect EntitySet name or type");var L=x(i);return u(L);};this.getAllProperties=function(){var i=[];var L;n().forEach(function(N){L=v(N);if(L.length===0){L=u(N);}i=i.concat(L);});i=sap.apf.utils.eliminateDuplicatesInArray(I.messageHandler,i);return i;};this.getParameterEntitySetKeyPropertiesForService=function(){var i=[];n().forEach(function(L){q(L,true).forEach(function(N){i.push(N.name);});});i=sap.apf.utils.eliminateDuplicatesInArray(I.messageHandler,i);return i;};this.getAllKeys=function(){var i=[];var L=[];n().forEach(function(N){if(!z(N)&&!B(N)){return;}var P=J(N);L=[];if(P.key&&P.key.propertyRef){P.key.propertyRef.forEach(function(Q){L.push(Q.name);});}i=i.concat(L);});i=sap.apf.utils.eliminateDuplicatesInArray(I.messageHandler,i);return i;};this.getAttributes=function(P){var i=false;var L;n().forEach(function(N){if(i){return;}L=F(N,P);if(L.name){i=true;}});return L;};this.getParameterEntitySetKeyProperties=function(i){I.messageHandler.check(i!==undefined&&typeof i==="string","sap.apf.core.Metadata:getParameterEntitySetKeyProperties incorrect EntityType name or type");var L=x(i);if(!L){return[];}return q(L,true);};this.getEntityTypeAnnotations=function(i){var L=x(i);I.messageHandler.check(i!==undefined&&typeof i==="string","sap.apf.core.Metadata:getEntityTypeAnnotations incorrect EntityType name or type");if(e.hasItem(L)===true){return e.getItem(L);}var N={};Q(L,N);var P=G(L);if(P!==L){Q(P,N);}e.setItem(L,N);return e.getItem(L);function Q(L,R){var S;var T;var U;var V=J(L);for(S in V){if(S.indexOf(s)!==0){continue;}T=S.split(".").pop();T=T.replace(/^./,T[0].toLowerCase());for(U in V[S]){R[T]=V[S][U];}}}};this.getEntitySets=function(){var i={};var L=[];var N=M.getODataEntityContainer();if(N.associationSet){N.associationSet.forEach(function(P){var Q,R,S;Q=x(P.end[0].entitySet);if(!z(Q)){return;}S=P.end[1].entitySet;R=x(S);if(!z(R)){i[S]=true;}});}if(N.entitySet){N.entitySet.forEach(function(P){if(!i[P.name]){L.push(P.name);}});}return L;};K();};}());};if(!jQuery.sap.isDeclared('sap.apf.core.metadataFacade')){jQuery.sap.declare("sap.apf.core.metadataFacade");(function(){'use strict';sap.apf.core.MetadataFacade=function(I,a){this.type="metadataFacade";var M=I.metadataProperty;var m=I.messageHandler;var o=I.metadataFactory;var p;var P;var b={};this.getAllProperties=function(c){if(p){c(p);}else{var d=g();var e;p=[];for(var i=0;i<d.length;i++){e=o.getMetadata(d[i]);p=p.concat(e.getAllProperties());}p=sap.apf.utils.eliminateDuplicatesInArray(m,p);c(p);}};this.getAllParameterEntitySetKeyProperties=function(c){if(P){c(P);}else{var d=g();var e;P=[];for(var i=0;i<d.length;i++){e=o.getMetadata(d[i]);P=P.concat(e.getParameterEntitySetKeyPropertiesForService());}P=sap.apf.utils.eliminateDuplicatesInArray(m,P);c(P);}};this.getProperty=function(n,c){if(b[n]){c(b[n]);}else{var d=g();var e;var f;for(var i=0;i<d.length;i++){f=o.getMetadata(d[i]);e=f.getAttributes(n);if(e.name){if(f.getParameterEntitySetKeyPropertiesForService().indexOf(n)>-1){e.isParameterEntitySetKeyProperty=true;}if(f.getAllKeys().indexOf(n)>-1){e.isKey=true;}break;}}for(var h in e){if(h==="dataType"){for(var j in e.dataType){e[j]=e.dataType[j];}}}var k=new M(e);b[n]=k;c(b[n]);}};function g(){if(typeof a==="string"){return[a];}return o.getServiceDocuments();}};}());};if(!jQuery.sap.isDeclared('sap.apf.core.odataProxy')){
/*!
 * SAP APF Analysis Path Framework
 *
 * (c) Copyright 2012-2014 SAP SE. All rights reserved
 */
jQuery.sap.declare("sap.apf.core.odataProxy");jQuery.sap.require('sap.ui.thirdparty.datajs');(function(){'use strict';sap.apf.core.OdataProxy=function(s,a){var c=a.instance.coreApi;var m=a.instance.messageHandler;var b=s.serviceRoot;var e="";function d(i){if(i===undefined){return true;}return i;}function g(b,i){return c.getEntityTypeMetadata(b,i);}function f(j){var i,u,v;if(!j){return"";}u=j.length;if(u===1){return"('"+j[0].value+"')";}v="(";for(i=0;i<u;i++){if(i>0){v=v+",";}v=v+j[i].name+"='"+j[i].value+"'";}return v+")";}function h(E){var i;if(E.messageObject&&E.messageObject.getCode){i=E.messageObject;}else if(E.response&&E.response.statusCode&&E.response.statusCode>=400){i=m.createMessageObject({code:'11005',aParameters:[E.response.statusCode.toString(),E.response.statusText]});}else{i=m.createMessageObject({code:'5201'});}m.putMessage(i);return i;}function k(E,i){var j=h(E);i(undefined,undefined,j);}function l(D,b,i,j){var u;var v;if(D&&D.results){u=D.results;}else if(D){u=D;}else{v=m.createMessageObject({code:'5201'});}j(u,g(b,i),v);}this.readEntity=function(i,j,u,v,w,x){var A=d(w);var y=sap.apf.core.constants.entitySets[i];var z=c.getXsrfToken(b);var B=b+'/'+y;B=B+f(u);if(v&&v.length>0){B=B+"?$select="+v.join();}var C={requestUri:B,async:A,method:"GET",headers:{"x-csrf-token":z}};c.odataRequest(C,function(D){l(D,b,y,j);},function(E){k(E,j);});};function n(P,v){var i="'";var E=g(b,e).getPropertyMetadata(P);if(E&&E.dataType){return sap.apf.utils.formatValue(v,E.dataType.type);}if(typeof v==='number'){return v;}return i+sap.apf.utils.escapeOdata(v)+i;}function o(j){var x=c.getXsrfToken(b);var u=[];var i,v=j.length;var w,y,S,z,A;for(i=0;i<v;i++){S=false;y=sap.apf.core.constants.entitySets[j[i].entitySetName];w=y;w=w+f(j[i].inputParameters);if(j[i].selectList&&j[i].selectList.length>0){w=w+"?$select="+j[i].selectList.join();S=true;}if(j[i].filter){if(S){w=w+'&';}else{w=w+'?';}e=y;w=w+'$filter='+j[i].filter.toUrlParam({formatValue:n});}z=j[i].method||'GET';A={requestUri:w,method:z,headers:{"Accept-Language":sap.ui.getCore().getConfiguration().getLanguage(),"x-csrf-token":x}};if(z!=="GET"){A.data=j[i].data;}u.push(A);}return u;}function p(i,j,u,v){var Q='';var w=i+f(j);if(u&&u.length>0){Q="$select="+u.join();}if(v){if(Q){Q=Q+'&';}e=i;Q=Q+'$filter='+v.toUrlParam({formatValue:n});}if(i===sap.apf.core.constants.entitySets.application){if(Q){Q=Q+'&';}Q=Q+'$orderby=ApplicationName';}if(Q){w=w+'?'+Q;}return w;}function q(i,j){var u="unknown error";var v="unknown error";var w="";if(i.message!==undefined){u=i.message;}var x="unknown";if(i.response&&i.response.statusCode){x=i.response.statusCode;v=i.response.statusText||"";w=i.response.requestUri;}if(i.messageObject&&i.messageObject.type==="messageObject"){j([],i.messageObject);}else{j([],m.createMessageObject({code:"5001",aParameters:[x,u,v,w]}));}}this.doChangeOperationsInBatch=function(u,v){var x=c.getXsrfToken(b);var w=o(u);var y={requestUri:b+'/'+'$batch',method:"POST",headers:{"x-csrf-token":x},data:{__batchRequests:[{__changeRequests:w}]}};var S=function(z,A){var B;var C;var D,F,G;var H="";var i,j;if(z&&z.__batchResponses){for(i=0;i<z.__batchResponses.length;i++){if(z.__batchResponses[i].message){D=z.__batchResponses[i].message;F="";H=A.requestUri;B=m.createMessageObject({code:"5001",aParameters:[F,D,"",H]});break;}for(j=0;j<z.__batchResponses[i].__changeResponses.length;j++){C=z.__batchResponses[i].__changeResponses[j];if(C.message){D=C.message;G=C.data;F=C.statusCode;H=A.requestUri;B=m.createMessageObject({code:"5001",aParameters:[F,D,G,H]});break;}}}v(B);}};var E=function(i){q(i,v);};c.odataRequest(y,S,E,OData.batchHandler);};this.readCollectionsInBatch=function(j,u,v){var x=c.getXsrfToken(b);var w=o(j);var A=d(v);var y={requestUri:b+'/'+'$batch',async:A,method:"POST",headers:{"x-csrf-token":x},data:{__batchRequests:w}};var S=function(z){var B=[];var C,D,F,G,H;var i;if(z&&z.__batchResponses){for(i=0;i<z.__batchResponses.length;i++){if(z.__batchResponses[i].data&&z.__batchResponses[i].data.results){B.push(z.__batchResponses[i].data.results);}else if(z.__batchResponses[i].message){D=z.__batchResponses[i].message;F=z.__batchResponses[i].response.body;G=z.__batchResponses[i].response.statusCode;H=B.requestUri;C=m.createMessageObject({code:"5001",aParameters:[G,D,F,H]});break;}else{H=B.requestUri;C=m.createMessageObject({code:"5001",aParameters:["unknown","unknown error","unknown error",H]});break;}}u(B,C);}};var E=function(i){q(i,u);};c.odataRequest(y,S,E,OData.batchHandler);};this.readCollection=function(i,j,u,v,w,x){var A=d(x);if(A){t(i,j,u,v,w);}else{r(i,j,u,v,w);}};function r(i,j,u,v,w){var x=sap.apf.core.constants.entitySets[i];var y=c.getXsrfToken(b);var z=b+'/'+p(x,u,v,w);var A={requestUri:z,async:false,method:"GET",headers:{"x-csrf-token":y}};c.odataRequest(A,function(D){l(D,b,x,j);},function(E){k(E,j);});}function t(i,j,u,v,w){var x=sap.apf.core.constants.entitySets[i];var y=function(B,C){var D;var E;var F="";if(B&&B.__batchResponses){if(B.__batchResponses[0].data&&B.__batchResponses[0].data.results){D=B.__batchResponses[0].data.results;}else if(B.__batchResponses[0].message){var G=B.__batchResponses[0].message;var H=B.__batchResponses[0].response.body;var I=B.__batchResponses[0].response.statusCode;F=C.requestUri;E=m.createMessageObject({code:"5001",aParameters:[I,G,H,F]});}else{F=C.requestUri;E=m.createMessageObject({code:"5001",aParameters:["unknown","unknown error","unknown error",F]});}j(D,g(b,x),E);}};var z=c.getXsrfToken(b);var A={requestUri:b+'/'+'$batch',async:true,method:"POST",headers:{"x-csrf-token":z},data:{__batchRequests:[{requestUri:p(x,u,v,w),method:"GET",headers:{"x-csrf-token":z,"Accept-Language":sap.ui.getCore().getConfiguration().getLanguage()}}]}};c.odataRequest(A,y,function(E){k(E,j);},OData.batchHandler);}this.create=function(i,j,u,v){var A=d(v);var w=sap.apf.core.constants.entitySets[i];var x=c.getXsrfToken(b);var y=b+'/'+w;var z={requestUri:y,async:A,method:"POST",headers:{"x-csrf-token":x},data:j};function B(D,R){var E;var F;if(D&&R.statusText==="Created"){E=D;}else{F=m.createMessageObject({code:'5201'});}u(E,g(b,w),F);}function C(E){var D=h(E);u(undefined,undefined,D);}c.odataRequest(z,B,C);};this.update=function(i,j,u,v){var w=sap.apf.core.constants.entitySets[i];var x=c.getXsrfToken(b);var y=b+'/'+w+f(v);var z={requestUri:y,method:"PUT",headers:{"x-csrf-token":x},data:j};function A(D,R){var C;if(R.statusCode!==204){C=m.createMessageObject({code:'5201'});}u(g(b,w),C);}function B(E){var C=h(E);u(undefined,C);}c.odataRequest(z,A,B);};this.remove=function(i,j,u,v){var w=sap.apf.core.constants.entitySets[i];var x=c.getXsrfToken(b);var y=b+'/'+w+f(j);if(v){e=w;y=y+'$filter='+v.toUrlParam({formatValue:n});}var z={requestUri:y,method:"DELETE",headers:{"x-csrf-token":x}};function A(D,R){var C;var E;if(R.statusText==="No Content"){E=g(b,w);}else{C=m.createMessageObject({code:'5201'});}u(E,C);}function B(E){var C=h(E);u(undefined,C);}c.odataRequest(z,A,B);};};}());};if(!jQuery.sap.isDeclared('sap.apf.core.odataRequest')){
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
jQuery.sap.declare("sap.apf.core.odataRequest");jQuery.sap.require('sap.ui.thirdparty.datajs');(function(){'use strict';sap.apf.core.odataRequestWrapper=function(m,r,s,e,b){function a(d,f){var M=sap.apf.core.utils.checkForTimeout(f);var E={};if(M){E.messageObject=M;e(E);}else{s(d,f);}}function c(E){var M=sap.apf.core.utils.checkForTimeout(E);if(M){E.messageObject=M;}e(E);}OData.request(r,a,c,b);};}());};if(!jQuery.sap.isDeclared('sap.apf.core.textResourceHandler')){jQuery.sap.declare("sap.apf.core.textResourceHandler");jQuery.sap.require('jquery.sap.resources');(function(){'use strict';sap.apf.core.TextResourceHandler=function(I){var t=this;var m=I.messageHandler;var c=I.coreApi;var h=new sap.apf.utils.Hashtable(m);var H=new sap.apf.utils.Hashtable(m);this.getTextNotHtmlEncoded=function(L,p){if(typeof L==="string"){return b(L,p);}m.check((L!==undefined&&L.kind!==undefined),"Error - oLabel is not compatible");if(L.kind==="text"){m.check((L.key!==undefined),"Error - oLabel is not compatible");return a(L,p);}return"";};this.getTextHtmlEncoded=function(L,p){return jQuery.sap.encodeHTML(this.getTextNotHtmlEncoded(L,p));};this.getMessageText=function(r,p){var T;l(sap.apf.core.constants.resourceLocation.apfUiTextBundle,sap.apf.core.constants.resourceLocation.applicationMessageTextBundle);if(h.hasItem(sap.apf.core.constants.resourceLocation.applicationMessageTextBundle)){T=h.getItem(sap.apf.core.constants.resourceLocation.applicationMessageTextBundle).getText(r,p);if(T!==r){return T;}}return h.getItem(sap.apf.core.constants.resourceLocation.apfUiTextBundle).getText(r,p);};this.loadTextElements=function(e){var i,f;f=e.length;for(i=0;i<f;i++){H.setItem(e[i].TextElement,e[i].TextElementDescription);}};function l(A,o){var u;if(h.hasItem(A)===false){u=c.getResourceLocation(A);d(A,u);}u=c.getResourceLocation(o);if(u!==""&&h.hasItem(o)===false){d(o,u);}}function a(L,p){if(L.key===sap.apf.core.constants.textKeyForInitialText){return"";}l(sap.apf.core.constants.resourceLocation.apfUiTextBundle,sap.apf.core.constants.resourceLocation.applicationUiTextBundle);if(k(L.key,sap.apf.core.constants.resourceLocation.applicationUiTextBundle)){return h.getItem(sap.apf.core.constants.resourceLocation.applicationUiTextBundle).getText(L.key,p);}else if(k(L.key,sap.apf.core.constants.resourceLocation.apfUiTextBundle)){return h.getItem(sap.apf.core.constants.resourceLocation.apfUiTextBundle).getText(L.key,p);}else if(H.hasItem(L.key)){return H.getItem(L.key);}m.putMessage(m.createMessageObject({code:"3001",aParameters:[L.key],oCallingObject:t}));return"# text not available: "+L.key;}function b(e,p){if(e===sap.apf.core.constants.textKeyForInitialText){return"";}l(sap.apf.core.constants.resourceLocation.apfUiTextBundle,sap.apf.core.constants.resourceLocation.applicationUiTextBundle);if(k(e,sap.apf.core.constants.resourceLocation.applicationUiTextBundle)){return h.getItem(sap.apf.core.constants.resourceLocation.applicationUiTextBundle).getText(e,p);}else if(k(e,sap.apf.core.constants.resourceLocation.apfUiTextBundle)){return h.getItem(sap.apf.core.constants.resourceLocation.apfUiTextBundle).getText(e,p);}else if(H.hasItem(e)){return H.getItem(e);}m.putMessage(m.createMessageObject({code:"3001",aParameters:[e],oCallingObject:this}));return"# text not available: "+e;}function k(e,T){var o=h.getItem(T);var i;if(o){o.getText(e);}if(o&&o.aPropertyFiles&&o.aPropertyFiles.length>0&&o.aPropertyFiles[0].aKeys instanceof Array){for(i=0;i<o.aPropertyFiles.length;i++){if(jQuery.inArray(e,o.aPropertyFiles[i].aKeys)>=0){return true;}}}return false;}function d(K,u){var B=jQuery.sap.resources({url:u,includeInfo:sap.ui.getCore().getConfiguration().getOriginInfo()});h.setItem(K,B);}};}());};if(!jQuery.sap.isDeclared('sap.apf.core.utils.filterTerm')){
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2015 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.apf.core.utils.filterTerm');(function(){'use strict';sap.apf.core.utils.FilterTerm=function(m,p,o,v,h){this.type="filterTerm";this.propertyName=p;this.operator=o;this.value=v;this.highValue=h;this.messageHandler=m;if(this.operator.length==2){this.operator=this.operator.toUpperCase();}m.check(this.operator!==undefined,"sap.apf.utils.FilterTerm.constructor operator undefined");m.check(jQuery.inArray(this.operator,sap.apf.core.constants.aSelectOpt)>-1,"sap.apf.core.utils.FilterTerm operator "+this.operator+" not supported");m.check(this.propertyName!==undefined,"sap.apf.utils.core.FilterTerm propertyName undefined");m.check(this.value!==undefined,"sap.apf.utils.FilterTerm value undefined");};sap.apf.core.utils.FilterTerm.prototype.isConsistentWithFilter=function(p,v){var a;var i;if(p!==this.propertyName){return true;}if(this.operator===sap.apf.core.constants.FilterOperators.EQ){if(this.value instanceof Date&&v instanceof Date){return(this.value.valueOf()===v.valueOf());}return(this.value===v);}else if(this.operator===sap.apf.core.constants.FilterOperators.LT){if(this.value instanceof Date&&v instanceof Date){return(this.value.valueOf()>v.valueOf());}return(this.value>v);}else if(this.operator===sap.apf.core.constants.FilterOperators.LE){if(this.value instanceof Date&&v instanceof Date){return(this.value.valueOf()>=v.valueOf());}return(this.value>=v);}else if(this.operator===sap.apf.core.constants.FilterOperators.GT){if(this.value instanceof Date&&v instanceof Date){return(this.value.valueOf()<v.valueOf());}return(this.value<v);}else if(this.operator===sap.apf.core.constants.FilterOperators.BT){if(this.value instanceof Date&&v instanceof Date){return(this.value.valueOf()<=v.valueOf()&&v.valueOf()<=this.highValue.valueOf());}return(this.value<=v&&v<=this.highValue);}else if(this.operator===sap.apf.core.constants.FilterOperators.GE){if(this.value instanceof Date&&v instanceof Date){return(this.value.valueOf()<=v.valueOf());}return(this.value<=v);}else if(this.operator===sap.apf.core.constants.FilterOperators.NE){if(this.value instanceof Date&&v instanceof Date){return!(this.value.valueOf()===v.valueOf());}return!(this.value===v);}else if(this.operator===sap.apf.core.constants.FilterOperators.StartsWith){if(this.value.length>v.length){return false;}a=v.slice(0,this.value.length);return(a===this.value);}else if(this.operator===sap.apf.core.constants.FilterOperators.EndsWith){if(this.value.length>v.length){return false;}a=v.slice(-this.value.length);return(a===this.value);}else if(this.operator===sap.apf.core.constants.FilterOperators.Contains){i=v.indexOf(this.value);return(i>-1);}};sap.apf.core.utils.FilterTerm.prototype.toUrlParam=function(c){var s="'";var a=" ";var p="";var v,h;if(c&&c.formatValue){v=c.formatValue(this.propertyName,this.value);if(this.highValue){h=c.formatValue(this.propertyName,this.highValue);}}else{if(typeof this.value==='number'){v=this.value;}else{v=s+sap.apf.utils.escapeOdata(this.value)+s;}if(this.highValue){if(typeof this.value==='number'){h=this.highValue;}else{h=s+sap.apf.utils.escapeOdata(this.highValue)+s;}}}if(this.operator===sap.apf.core.constants.FilterOperators.StartsWith){p='startswith('+sap.apf.utils.escapeOdata(this.propertyName)+','+v+')';p=jQuery.sap.encodeURL(p);}else if(this.operator===sap.apf.core.constants.FilterOperators.EndsWith){p='endswith('+sap.apf.utils.escapeOdata(this.propertyName)+','+v+')';p=jQuery.sap.encodeURL(p);}else if(this.operator===sap.apf.core.constants.FilterOperators.Contains){p='substringof('+v+','+sap.apf.utils.escapeOdata(this.propertyName)+')';p=jQuery.sap.encodeURL(p);}else if(this.operator===sap.apf.core.constants.FilterOperators.BT){p='(('+jQuery.sap.encodeURL(sap.apf.utils.escapeOdata(this.propertyName)+a+"ge"+a+v)+')'+jQuery.sap.encodeURL(a+'and'+a)+'('+jQuery.sap.encodeURL(sap.apf.utils.escapeOdata(this.propertyName)+a+"le"+a+h)+'))';}else{p='('+jQuery.sap.encodeURL(sap.apf.utils.escapeOdata(this.propertyName)+a+this.operator.toLowerCase()+a+v)+')';}return p;};sap.apf.core.utils.FilterTerm.prototype.getProperty=function(){return this.propertyName;};sap.apf.core.utils.FilterTerm.prototype.getOp=function(){return this.operator;};sap.apf.core.utils.FilterTerm.prototype.getValue=function(){return this.value;};sap.apf.core.utils.FilterTerm.prototype.getHighValue=function(){return this.highValue;};sap.apf.core.utils.FilterTerm.prototype.getHash=function(){var s=this.propertyName+this.operator+this.value;return sap.apf.utils.hashCode(s);};sap.apf.core.utils.FilterTerm.prototype.copy=function(){return new sap.apf.core.utils.FilterTerm(this.messageHandler,this.propertyName,this.operator,this.value,this.highValue);};sap.apf.core.utils.FilterTerm.prototype.removeTermsByProperty=function(p){var i=0;var l=0;if(p instanceof Array){l=p.length;for(i=0;i<l;i++){if(this.propertyName===p[i]){return undefined;}}return this.copy();}if(this.propertyName===p){return undefined;}return this.copy();};sap.apf.core.utils.FilterTerm.prototype.removeTerms=function(p,o,v){var i=0;var l=0;if(p instanceof Array){l=p.length;for(i=0;i<l;i++){if(this.propertyName===p[i]&&this.operator===o&&this.value===v){return undefined;}}return this.copy();}if(this.propertyName===p&&this.operator===o&&this.value===v){return undefined;}return this.copy();};sap.apf.core.utils.FilterTerm.prototype.mapToSapUI5FilterExpression=function(){if(this.operator===sap.apf.core.constants.FilterOperators.BT){return{path:this.propertyName,operator:this.operator,value1:this.value,value2:this.highValue};}return{path:this.propertyName,operator:this.operator,value1:this.value};};sap.apf.core.utils.FilterTerm.prototype.traverse=function(v){return v.processTerm(this);};}());};if(!jQuery.sap.isDeclared('sap.apf.modeler.core.applicationHandler')){
/*!
 * SAP APF Analysis Path Framework
 *
 * (c) Copyright 2012-2014 SAP SE. All rights reserved
 */
jQuery.sap.declare("sap.apf.modeler.core.applicationHandler");(function(){'use strict';sap.apf.modeler.core.ApplicationHandler=function(i,a){var t=this;var p=i.instance.persistenceProxy;var m=i.instance.messageHandler;var H=i.constructor.hashtable;var b;this.type="application";this.setAndSave=function(d,e,f,g){if(typeof d==="object"&&typeof e==="function"&&typeof f==="string"&&!g){var h=function(k,l){if(l){e(undefined,k,l);}else{b.setItem(d.Application,d);e(d.Application,k,l);}};if(!d.SemanticObject){d.SemanticObject="";}d.Application=f;p.update(this.type,d,h,[{name:"Application",value:f}]);}else if(typeof d==="object"&&typeof e==="function"){var j=function(r,k,l){if(l){e(r,k,l);}else{b.setItem(r.Application,{Application:r.Application,ApplicationName:r.ApplicationName,SemanticObject:r.SemanticObject});e(r.Application,k,l);}};if(!d.SemanticObject){d.SemanticObject="";}if(g&&f){d.Application=f;}else{d.Application="";}p.create(this.type,d,j);}};this.removeApplication=function(d,e){var f=function(g,h){if(!h){b.removeItem(d);}i.functions.resetConfigurationHandler(d);e(d,g,h);};p.remove(this.type,[{name:"Application",value:d}],f);};this.getList=function(){var d=[];var e=function(k,f){d.push(f);};b.forEachOrdered(e);return d;};this.getApplication=function(d){return b.getItem(d);};function c(){b=new H(m);var d=function(r,e,f){if(r instanceof Array&&f===undefined){r.forEach(function(o){b.setItem(o.Application,{Application:o.Application,ApplicationName:o.ApplicationName,SemanticObject:o.SemanticObject});});}a(t,f);};p.readCollection(t.type,d);}c();};}());};if(!jQuery.sap.isDeclared('sap.apf.modeler.core.configurationEditor')){jQuery.sap.declare("sap.apf.modeler.core.configurationEditor");(function(){'use strict';sap.apf.modeler.core.ConfigurationEditor=function(c,a,b,d){var t=this;var e;var f=a.instance.configurationHandler;var p=a.instance.persistenceProxy;var m=a.instance.messageHandler;var g=a.instance.metadataFactory;var h=true;var s,j,k,n,l,o;var q=new a.constructor.configurationObjects(a);var r=new a.constructor.configurationFactory({messageHandler:m,constructor:{registryProbe:a.constructor.registryProbe}});if(!d){s=new a.constructor.elementContainer("Step",a.constructor.step,a);j=new a.constructor.elementContainer("Category",undefined,a);k=new a.constructor.elementContainer("FacetFilter",a.constructor.facetFilter,a);n=new a.constructor.elementContainer("NavigationTarget",a.constructor.navigationTarget,a);l=new a.constructor.elementContainer("CategoryStepAssignment",a.constructor.elementContainer,a);o=[];}else{s=d.stepContainer;j=d.categoryContainer;k=d.facetFilterContainer;n=d.navigationTargetContainer;l=d.categoryStepAssignmentContainer;o=d.serviceList;e=d.applicationTitle;}this.registerService=function(i){var x=false;if(o.indexOf(i)===-1){if(g.getMetadata(i)){o.push(i);x=true;}}else{x=true;}return x;};this.getAllServices=function(){return o;};this.getAllEntitySetsOfService=function(i){var x=[];if(o.indexOf(i)>-1){x=g.getEntitySets(i);}return x;};this.getAllEntitySetsOfServiceWithGivenProperties=function(x,y){var z=[],A;var B=this.getAllEntitySetsOfService(x);if(!y||y.length===0){return B;}A=g.getMetadata(x);B.forEach(function(C){var D=A.getFilterableProperties(C);var E=true;for(var i=0;i<y.length;i++){if(D.indexOf(y[i])<=-1){E=false;break;}}if(E){z.push(C);}});return z;};this.getAllPropertiesOfEntitySet=function(i,x){var y=[];if(o.indexOf(i)>-1){y=g.getMetadata(i).getAllPropertiesOfEntitySet(x);}return y;};this.getAllKnownProperties=function(){var i=[];var x;o.forEach(function(y){x=g.getMetadata(y);i=i.concat(x.getAllProperties());});i=sap.apf.utils.eliminateDuplicatesInArray(m,i);return i;};this.setApplicationTitle=function(i){h=false;e=i;};this.getApplicationTitle=function(){return e;};this.getConfigurationName=function(){return f.getConfiguration(c.id||c).AnalyticalConfigurationName;};this.getCategoryStepAssignments=function(i){var x=[];if(!this.getCategory(i)){return false;}var y=l.getElement(i);if(y){y.getElements().forEach(function(z){x.push(z.stepId);});}return x;};this.addCategoryStepAssignment=function(i,x){if(!this.getCategory(i)||!this.getStep(x)){return false;}var y=l.getElement(i);if(!y){l.createElementWithProposedId({},i);y=l.getElement(i);}if(!y.getElement(x)){y.createElementWithProposedId({stepId:x},x);return true;}return false;};this.removeCategoryStepAssignment=function(i,x){var y;if(!x){var z=this.getCategoryStepAssignments(i);y=l.removeElement(i);if(y){_(z);}return!!y;}var A=l.getElement(i);if(!A){return false;}y=A.removeElement(x);if(A.getElements().length===0){l.removeElement(i);}if(y){_([x]);}return!!y;};function _(i){if(!i){return;}i.forEach(function(x){if(t.getCategoriesForStep(x).length===0){u(x);}});}this.moveCategoryStepAssignmentBefore=function(i,x,y){var z=l.getElement(i);if(!z){return null;}return z.moveBefore(x,y);};this.moveCategoryStepAssignmentToEnd=function(i,x){var y=l.getElement(i);if(!y){return null;}return y.moveToEnd(x);};this.moveCategoryStepAssignmentUpOrDown=function(i,x,y){var z=l.getElement(i);if(!z){return null;}return z.moveUpOrDown(x,y);};this.getCategory=j.getElement;this.setCategory=function(i,x){h=false;return j.setElement(i,x);};this.createCategoryWithId=function(i,x){h=false;return j.createElementWithProposedId(i,x).getId();};this.removeCategory=function(i){var x=t.getCategoryStepAssignments(i);if(x){x.forEach(function(y){var z=t.getCategoriesForStep(y);if(!z||z.length<2){u(y);}});}j.removeElement(i);};this.getCategories=j.getElements;this.copyCategory=function(i){var x=j.copyElement(i);if(!x){return;}t.getCategoryStepAssignments(i).forEach(function(y){v(y,x);});return x;};this.moveCategoryBefore=function(i,x){return j.moveBefore(i,x);};this.moveCategoryToEnd=function(i){return j.moveToEnd(i);};this.moveCategoryUpOrDown=function(i,x){return j.moveUpOrDown(i,x);};this.serialize=function(){return q.serializeConfiguration(t);};this.isSaved=function(){return h;};this.setIsUnsaved=function(){h=false;};this.save=function(i){function x(A,B,C){if(!C){h=true;f.replaceConfigurationId(c.id||c,A.AnalyticalConfiguration);c=A.AnalyticalConfiguration;}i(c,B,C);}function y(A,B){if(!B){h=true;}i(c.id||c,A,B);}var z={AnalyticalConfiguration:"",AnalyticalConfigurationName:f.getConfiguration(c.id||c).AnalyticalConfigurationName,Application:f.getApplicationId(),SerializedAnalyticalConfiguration:JSON.stringify(this.serialize()),CreatedByUser:"",CreationUTCDateTime:null,LastChangeUTCDateTime:null,LastChangedByUser:""};if(typeof c==='string'){if(c.indexOf("apf1972-")===0){p.create("configuration",z,x);}else{z.AnalyticalConfiguration=c;p.update("configuration",z,y,[{name:"AnalyticalConfiguration",value:c}]);}}else{if(c.id.indexOf("apf1972-")===0){z.AnalyticalConfiguration="";z.CreationUTCDateTime=null;z.LastChangeUTCDateTime=null;}else{z.AnalyticalConfiguration=c.id;z.CreationUTCDateTime=c.creationDate;z.LastChangeUTCDateTime=c.lastChangeDate;}if(c.updateExisting){p.update("configuration",z,y,[{name:"AnalyticalConfiguration",value:c.id}]);}else{p.create("configuration",z,x);}}};this.createFacetFilterWithId=function(i){return k.createElementWithProposedId(undefined,i).getId();};this.createFacetFilter=function(){return k.createElement().getId();};this.removeFacetFilter=k.removeElement;this.getFacetFilter=k.getElement;this.getFacetFilters=k.getElements;this.copyFacetFilter=k.copyElement;this.moveFacetFilterBefore=function(i,x){return k.moveBefore(i,x);};this.moveFacetFilterToEnd=function(i){return k.moveToEnd(i);};this.moveFacetFilterUpOrDown=function(i,x){return k.moveUpOrDown(i,x);};this.createNavigationTargetWithId=function(i){return n.createElementWithProposedId(undefined,i).getId();};this.createNavigationTarget=function(){return n.createElement().getId();};this.removeNavigationTarget=n.removeElement;this.getNavigationTarget=n.getElement;this.getNavigationTargets=n.getElements;this.copyNavigationTarget=n.copyElement;this.moveNavigationTargetBefore=function(i,x){return n.moveBefore(i,x);};this.moveNavigationTargetToEnd=function(i){return n.moveToEnd(i);};this.moveNavigationTargetUpOrDown=function(i,x){return n.moveUpOrDown(i,x);};this.createStepWithId=function(i){return s.createElementWithProposedId(undefined,i).getId();};this.createStep=function(i){if(!this.getCategory(i)){return;}var x=s.createElement().getId();this.addCategoryStepAssignment(i,x);return x;};var u=s.removeElement;this.getStep=s.getElement;this.getSteps=s.getElements;this.getStepsNotAssignedToCategory=function(i){var x=this.getCategoryStepAssignments(i);var y=[];t.getSteps().forEach(function(z){var A=z.getId();if(x.indexOf(A)===-1){y.push(A);}});return y;};this.copyStep=function(i){var x=v(i);var y=this.getCategoriesForStep(i);if(!x){return false;}if(y){y.forEach(function(z){t.addCategoryStepAssignment(z,x);});}return x;};function v(i,x){if(x&&!t.getCategory(x)){return false;}var y=s.copyElement(i);if(!y){return false;}if(x){t.addCategoryStepAssignment(x,y);}return y;}this.getCategoriesForStep=function getCategoriesForStep(i){var x=[];var y=t.getCategories();if(y){y.forEach(function(z){var A=z.getId();var B=t.getCategoryStepAssignments(A);if(B&&B.indexOf(i)>-1){x.push(A);}});}return x;};this.getAssignableStepsForNavigationTarget=function(i){var x=[];t.getSteps().forEach(function(y){var z=false;y.getNavigationTargets().forEach(function(A){if(i===A){z=true;}});if(!z){x.push(y.getId());}});return x;};this.getStepsAssignedToNavigationTarget=function(i){var x=[];t.getSteps().forEach(function(y){var z=false;y.getNavigationTargets().forEach(function(A){if(i===A){z=true;}});if(z){x.push(y.getId());}});return x;};this.copy=function(i){var x={stepContainer:s,categoryContainer:j,facetFilterContainer:k,navigationTargetContainer:n,categoryStepAssignmentContainer:l,applicationTitle:e,serviceList:o};var d=sap.apf.modeler.core.ConfigurationObjects.deepDataCopy(x);return new sap.apf.modeler.core.ConfigurationEditor(i,a,undefined,d);};if(typeof c==='string'){if(c.indexOf("apf1972-")===0){h=false;if(b){b(t,undefined);}}else{if(!d){w(c,p,function(i,x){if(!x){var y=JSON.parse(i.SerializedAnalyticalConfiguration);t.setApplicationTitle(y.applicationTitle);r.loadConfig(y);q.mapToDesignTime(r.getRegistry(),t);h=true;b(t,undefined);}else{b(undefined,x);}});}}}else{r.loadConfig(c.content);q.mapToDesignTime(r.getRegistry(),this);if(b){b(t,undefined);}}function w(i,x,b){x.readEntity("configuration",function(y,z,A){b(y,A);},[{name:"AnalyticalConfiguration",value:i}],undefined,true,f.getApplicationId());}};}());};if(!jQuery.sap.isDeclared('sap.apf.modeler.core.configurationHandler')){jQuery.sap.declare("sap.apf.modeler.core.configurationHandler");(function(){'use strict';sap.apf.modeler.core.ConfigurationHandler=function(a){var t=this;var m=a.instance.messageHandler;var p=a.instance.persistenceProxy;var C=a.constructor.configurationEditor;var H=a.constructor.hashtable;var L=a.constructor.lazyLoader;var c=new H(m);var b=new H(m);var l=new H(m);var d=new H(m);var e,f;var g={constructor:{hashtable:H},instance:{messageHandler:m}};this.exportTexts=function(){return f.exportTexts();};this.getTextPool=function(){return f;};this.setApplicationIdAndContext=function(j,k,T){f=T||f;c=new H(m);var i,n=k.length;for(i=0;i<n;i++){c.setItem(k[i].AnalyticalConfiguration,k[i]);b.setItem(k[i].AnalyticalConfiguration,k[i].AnalyticalConfigurationName);}e=j;};this.getApplicationId=function(){return e;};this.setConfiguration=function(i,j){i.AnalyticalConfiguration=j||h();i.Application=e;c.setItem(i.AnalyticalConfiguration,i);return i.AnalyticalConfiguration;};this.getList=function(){var i=[];var j=function(k,n){i.push(n);};c.each(j);return i;};this.getConfiguration=function(i){return c.getItem(i);};this.loadConfiguration=function(i,j){var k,n=i.id||i;if(!i.updateExisting){k=l.getItem(n);}if(!k){k=new L(g,q);l.setItem(n,k);}k.asyncGetInstance(n,o);function o(r,s,u){j(r,s);}function q(n,r,s){var u={instance:{coreApi:a.instance.coreApi,messageHandler:m,datajs:a.instance.datajs,configurationHandler:t,persistenceProxy:p,textPool:f,metadataFactory:a.instance.metadataFactory},constructor:{hashtable:H,step:a.constructor.step,facetFilter:a.constructor.facetFilter,navigationTarget:a.constructor.navigationTarget,representation:a.constructor.representation,configurationObjects:a.constructor.configurationObjects,elementContainer:a.constructor.elementContainer,configurationFactory:a.constructor.configurationFactory,registryProbe:a.constructor.registryProbe}};new C(i,u,function(v,w){r(n,v,w);});}};this.resetConfiguration=function(i){var j;if(l.hasItem(i)){j=c.getItem(i);j.AnalyticalConfigurationName=b.getItem(i);l.removeItem(i);return i;}};this.copyConfiguration=function(i,j){var k=this.getConfiguration(i);if(!k){j(null);return;}t.loadConfiguration(i,n);function n(o){var q,r,s,u;u=sap.apf.modeler.core.ConfigurationObjects.deepDataCopy(k);q=h();u.AnalyticalConfiguration=q;t.setConfiguration(u,q);r=o.copy(q);s=new L(g,undefined,{id:q,instance:r});l.setItem(q,s);j(q);}};this.replaceConfigurationId=function(i,s){if(i.indexOf("apf1972-")===0){var j=c.getItem(i);var k=l.getItem(i).getInstance();var n=new L(g,undefined,{id:s,instance:k});j.AnalyticalConfiguration=s;c.setItem(s,j);b.setItem(s,j.AnalyticalConfigurationName);c.removeItem(i);l.setItem(s,n);l.removeItem(i);}};this.exportConfiguration=function(i,j){var o;this.loadConfiguration(i,k);function k(n){if(!n.isSaved()){m.putMessage(m.createMessageObject({code:"11007",aParameters:[i]}));j(null);}else{var q=a.functions.getApplication(e);o=n.serialize();o.configHeader={Application:e,ApplicationName:q.ApplicationName,SemanticObject:q.SemanticObject,AnalyticalConfiguration:i,AnalyticalConfigurationName:t.getConfiguration(i).AnalyticalConfigurationName,UI5Version:sap.ui.version};p.readEntity("configuration",function(r,s,u){if(u){m.putMessage(m.createMessageObject({code:"5022",aParameters:[i]}));j(null);}else{o.configHeader.CreationUTCDateTime=r.CreationUTCDateTime;o.configHeader.LastChangeUTCDateTime=r.LastChangeUTCDateTime;j(JSON.stringify(o));}},[{name:"AnalyticalConfiguration",value:i}],["CreationUTCDateTime","LastChangeUTCDateTime"],true,e);}}};this.memorizeConfiguration=function(i){var j,k;k=l.getItem(i);if(!k){return null;}j=k.getInstance();if(j){d.setItem(i,j.copy(i));return i;}return null;};this.restoreMemorizedConfiguration=function(i){var n,j;j=d.removeItem(i);if(j){n=new L(g,undefined,{id:i,instance:j});l.setItem(i,n);return j;}return null;};this.removeConfiguration=function(i,r){function j(k,n){if(!n){c.removeItem(i);l.removeItem(i);}r(i,k,n);}if(i.indexOf("apf1972-")!==0){p.remove("configuration",[{name:"AnalyticalConfiguration",value:i}],j,undefined,e);}else{c.removeItem(i);l.removeItem(i);r(i,undefined,undefined);}};this.removeAllConfigurations=function(){c=new H(m);};function h(){return"apf1972-"+(Math.random()*new Date().getTime());}};}());};if(!jQuery.sap.isDeclared('sap.apf.modeler.ui.controller.applicationList.controller')){jQuery.sap.declare('sap.apf.modeler.ui.controller.applicationList.controller');sap.ui.controller("sap.apf.modeler.ui.controller.applicationList",{onInit:function(){var v=this.getView();v.addStyleClass("sapUiSizeCompact");this._addApplicationStyleClass();var c=this.getOwnerComponent();if(c!==undefined){this.oCoreApi=c.oCoreApi;this._setDisplayText();var s=this;this.oCoreApi.getApplicationHandler(function(A){s.applicationHandler=A;s._updateAppList();});}this.oModel=new sap.ui.model.json.JSONModel({});this.oModel.setSizeLimit(1000);this.bIsEditMode=false;this.byId("idAppDescription").attachBrowserEvent("click",this.navToConfigList().fn);this.byId("idSemanticObject").attachBrowserEvent("click",this.navToConfigList().fn);var a=v.byId("idApplicationTable");var b=v.byId("idAppListScrollContainer");b.addEventDelegate({onAfterRendering:function(){var w=jQuery(v.byId("idAppPage").getDomRef()).width();var h=jQuery(window).height();var d=jQuery(v.byId("idAppTitle").getDomRef()).height();var e=jQuery(v.byId("idApplicationToolbar").getDomRef()).height();var f=jQuery(v.byId("idAppPage").getDomRef()).find("header").height();var g=jQuery(v.byId("idAppPage").getDomRef()).find("footer").height();var o;if(d>0){d=d+80;o=d+e+f+g+25;}else{o=232;}b.setHeight(h-o+"px");b.setWidth("100%");sap.apf.modeler.ui.utils.helper.onResize(function(){if(jQuery(s.getView().getDomRef()).css("display")==="block"){w=jQuery(v.byId("idAppPage").getDomRef()).width();h=jQuery(v.byId("idAppPage").getDomRef()).height();b.setHeight(h-o+"px");b.setWidth("100%");}});sap.ui.core.UIComponent.getRouterFor(s).attachRoutePatternMatched(function(E){if(E.getParameter("name")==="applicationList"){w=jQuery(v.getDomRef()).width();h=jQuery(v.getDomRef()).height();b.setHeight(h-o+"px");b.setWidth("100%");}});}});},_setDisplayText:function(){this.byId("idAppPage").setTitle(this.oCoreApi.getText("configModelerTitle"));this.byId("idAppTitle").setText(this.oCoreApi.getText("applicationOverview"));this.byId("idAppNumberTitle").setText(this.oCoreApi.getText("applications"));this.byId("idDescriptionLabel").setText(this.oCoreApi.getText("description"));this.byId("idSemanticObjectLabel").setText(this.oCoreApi.getText("semanticObject"));this.byId("idEditButton").setText(this.oCoreApi.getText("edit"));this.byId("idSaveButton").setText(this.oCoreApi.getText("save"));this.byId("idCancelButton").setText(this.oCoreApi.getText("cancel"));this.byId("idTextCleanupButton").setText(this.oCoreApi.getText("textCleanUp"));this.byId("idImportButton").setText(this.oCoreApi.getText("import"));this.byId("idNewButton").setTooltip(this.oCoreApi.getText("newApplication"));},_addImportConfigStyleClass:function(){sap.ui.core.Fragment.byId("idImportConfigurationFragment","idJsonFileLabel").addStyleClass("importFileUploaderDialogLabels");sap.ui.core.Fragment.byId("idImportConfigurationFragment","idTextFileLabel").addStyleClass("importFileUploaderDialogLabels");},_setOverwriteConfirmationDialogText:function(){sap.ui.core.Fragment.byId("idOverwriteConfirmationFragment","idOverwriteConfirmationDialog").setTitle(this.oCoreApi.getText("warning"));sap.ui.core.Fragment.byId("idOverwriteConfirmationFragment","idConfirmationMessage").setText(this.oCoreApi.getText("overwriteConfirmationMsg"));sap.ui.core.Fragment.byId("idOverwriteConfirmationFragment","idConfirmationMessage").addStyleClass("dialogText");sap.ui.core.Fragment.byId("idOverwriteConfirmationFragment","idYesButton").setText(this.oCoreApi.getText("yes"));sap.ui.core.Fragment.byId("idOverwriteConfirmationFragment","idNoButton").setText(this.oCoreApi.getText("no"));},_setImportConfigDialogText:function(){sap.ui.core.Fragment.byId("idImportConfigurationFragment","idImportConfigDialog").setTitle(this.oCoreApi.getText("importConfig"));sap.ui.core.Fragment.byId("idImportConfigurationFragment","idJsonFileLabel").setText(this.oCoreApi.getText("jsonFile"));sap.ui.core.Fragment.byId("idImportConfigurationFragment","idJsonFileUploader").setPlaceholder(this.oCoreApi.getText("jsonFileInputPlaceHolder"));sap.ui.core.Fragment.byId("idImportConfigurationFragment","idTextFileLabel").setText(this.oCoreApi.getText("textFile"));sap.ui.core.Fragment.byId("idImportConfigurationFragment","idTextFileUploader").setPlaceholder(this.oCoreApi.getText("textFileInputPlaceHolder"));sap.ui.core.Fragment.byId("idImportConfigurationFragment","idUploadOfConfig").setText(this.oCoreApi.getText("upload"));sap.ui.core.Fragment.byId("idImportConfigurationFragment","idCancelImportOfConfig").setText(this.oCoreApi.getText("cancel"));},_setImportDeliveredContentDialogText:function(){sap.ui.core.Fragment.byId("idImportDeliveredContentFragment","idImportDeliveredContentDialog").setTitle(this.oCoreApi.getText("importDeliveredContent"));sap.ui.core.Fragment.byId("idImportDeliveredContentFragment","idConfigLabel").setText(this.oCoreApi.getText("configuration"));sap.ui.core.Fragment.byId("idImportDeliveredContentFragment","idAppConfigCombobox").setPlaceholder(this.oCoreApi.getText("configFileInputPlaceHolder"));sap.ui.core.Fragment.byId("idImportDeliveredContentFragment","idImportOfConfig").setText(this.oCoreApi.getText("import"));sap.ui.core.Fragment.byId("idImportDeliveredContentFragment","idCancelImportOfConfig").setText(this.oCoreApi.getText("cancel"));},_setConfirmationDialogText:function(){sap.ui.core.Fragment.byId("idConfirmationDialogFragment","idDeleteConfirmation").setTitle(this.oCoreApi.getText("confirmation"));sap.ui.core.Fragment.byId("idConfirmationDialogFragment","idDeleteButton").setText(this.oCoreApi.getText("deleteButton"));sap.ui.core.Fragment.byId("idConfirmationDialogFragment","idCancelButtonDialog").setText(this.oCoreApi.getText("cancel"));},_setNewApplicationText:function(){sap.ui.core.Fragment.byId("idAddNewApplicationFragment","idNewApp").setTitle(this.oCoreApi.getText("newApplication"));sap.ui.core.Fragment.byId("idAddNewApplicationFragment","idDescriptionLabelApp").setText("*"+this.oCoreApi.getText("description"));sap.ui.core.Fragment.byId("idAddNewApplicationFragment","idSemanticObjectLabelApp").setText(this.oCoreApi.getText("semanticObject"));sap.ui.core.Fragment.byId("idAddNewApplicationFragment","idSaveButtonApp").setText(this.oCoreApi.getText("save"));sap.ui.core.Fragment.byId("idAddNewApplicationFragment","idCancelButtonApp").setText(this.oCoreApi.getText("cancel"));},_addApplicationStyleClass:function(){this.byId("idAppNumberTitle").addStyleClass("appCountLabel");this.byId("idAppDescription").addStyleClass("cursor");this.byId("idSemanticObject").addStyleClass("cursor");this.byId("idNewButton").addStyleClass("newButton");this.byId("idAppListScrollContainer").addStyleClass("applicationListScroll");this.byId("idNoOfConfig").addStyleClass("applicationCount");this.byId("idAppTitle").addStyleClass("applicationTitle");this.byId("idApplicationToolbar").addStyleClass("applicationTitleLayout");},_updateAppList:function(){var a=this.applicationHandler.getList();var b=a.length;var A=[];a.forEach(function(c){var o={};o.id=c.Application;o.description=c.ApplicationName;o.semanticObject=c.SemanticObject;A.push(o);});var j={appCount:"("+b+")",tableData:A};if(this.oModel!==undefined){this.oModel.setSizeLimit(1000);this.oModel.setData(j);this.getView().setModel(this.oModel);}},_enableDisplayMode:function(){this.bIsEditMode=false;this.byId("idEditButton").setVisible(true);this.byId("idSaveButton").setVisible(false);this.byId("idSaveButton").setEnabled(false);this.byId("idTextCleanupButton").setEnabled(false);this.byId("idCancelButton").setVisible(false);this.byId("idTextCleanupButton").setVisible(false);this.byId("idApplicationTable").setMode("None");this.byId("idImportButton").setVisible(true);var i=this.byId("idApplicationTable").getItems();i.forEach(function(a){a.setType("Navigation");a.getCells()[0].setEditable(false);a.getCells()[1].setEditable(false);a.getCells()[2].setVisible(false);});this._updateAppList();},enableEditMode:function(){this.bIsEditMode=true;this.byId("idEditButton").setVisible(false);this.byId("idSaveButton").setVisible(true);this.byId("idCancelButton").setVisible(true);this.byId("idTextCleanupButton").setVisible(true);this.byId("idImportButton").setVisible(false);this.byId("idApplicationTable").setMode("SingleSelectMaster");var i=this.byId("idApplicationTable").getItems();if(i.length!==0){i.forEach(function(a){a.getCells()[0].setEditable(true);a.getCells()[1].setEditable(true);a.getCells()[2].setVisible(true);a.setType("Inactive");});}},handleDeletePress:function(e){var p=e.getSource().getBindingContext().getPath().split("/")[2];var r=this.getView().getModel().getData().tableData[p].id;var c=new sap.ui.core.CustomData({value:{removeId:r,sPath:p}});if(!this.confirmationDialog){this.confirmationDialog=sap.ui.xmlfragment("idConfirmationDialogFragment","sap.apf.modeler.ui.fragment.confirmationDialog",this);this.getView().addDependent(this.confirmationDialog);this._setConfirmationDialogText();}var a=new sap.m.Label();a.addStyleClass("dialogText");a.setText(this.oCoreApi.getText("deleteApp"));this.confirmationDialog.removeAllContent();this.confirmationDialog.addContent(a);this.confirmationDialog.removeAllCustomData();this.confirmationDialog.addCustomData(c);jQuery.sap.syncStyleClass("sapUiSizeCompact",this.getView(),this.confirmationDialog);this.confirmationDialog.open();},handleConfirmDeletion:function(){var r=this.confirmationDialog.getCustomData()[0].getValue().removeId;if(r!==undefined){var s=this;this.applicationHandler.removeApplication(r,function(R,m,a){if(a===undefined&&(typeof R==="string")){s.confirmationDialog.close();s._updateAppList();s.enableEditMode();}else{var M=s.oCoreApi.createMessageObject({code:"11501"});M.setPrevious(a);s.oCoreApi.putMessage(M);}});}},closeDialog:function(){if(this.confirmationDialog.isOpen()){this.confirmationDialog.close();}},handleSavePress:function(){var s=this;var j;var u=[];var a=this.applicationHandler.getList();var t=this.getView().getModel().getData().tableData;for(j=0;j<a.length;j++){if(t[j].description!==a[j].ApplicationName||t[j].semanticObject!==a[j].SemanticObject){u.push(t[j]);}}u.forEach(function(b){var c={ApplicationName:b.description,SemanticObject:b.semanticObject};s.applicationHandler.setAndSave(c,function(r,m,d){if(d===undefined&&(typeof r==="string")){s._enableDisplayMode();}else{var M=s.oCoreApi.createMessageObject({code:"11500"});M.setPrevious(d);s.oCoreApi.putMessage(M);}},b.id);});},handleCancelPress:function(){var j;var u=[];var a=this.applicationHandler.getList();var t=this.getView().getModel().getData().tableData;for(j=0;j<a.length;j++){if(t[j].description!==a[j].ApplicationName||t[j].semanticObject!==a[j].SemanticObject){u.push(t[j]);}}if(u.length!==0){this.unsavedDataConfirmationDialog=sap.ui.xmlfragment("idMessageDialogFragment","sap.apf.modeler.ui.fragment.messageDialog",this);this.getView().addDependent(this.unsavedDataConfirmationDialog);this._setUnsavedDataConfirmationDialogText();jQuery.sap.syncStyleClass("sapUiSizeCompact",this.getView(),this.unsavedDataConfirmationDialog);this.unsavedDataConfirmationDialog.open();}else{this._enableDisplayMode();}},_handleNavigationWithSave:function(){this.handleSavePress();if(this.unsavedDataConfirmationDialog.isOpen()){this.unsavedDataConfirmationDialog.close();this.unsavedDataConfirmationDialog.destroy();}},_handleNavigateWithoutSave:function(){if(this.unsavedDataConfirmationDialog.isOpen()){this.unsavedDataConfirmationDialog.close();this.unsavedDataConfirmationDialog.destroy();}this._enableDisplayMode();},_handlePreventNavigation:function(){if(this.unsavedDataConfirmationDialog.isOpen()){this.unsavedDataConfirmationDialog.close();this.unsavedDataConfirmationDialog.destroy();}},_setUnsavedDataConfirmationDialogText:function(){sap.ui.core.Fragment.byId("idMessageDialogFragment","idMessageDialog").setTitle(this.oCoreApi.getText("confirmation"));sap.ui.core.Fragment.byId("idMessageDialogFragment","idYesButton").setText(this.oCoreApi.getText("yes"));sap.ui.core.Fragment.byId("idMessageDialogFragment","idNoButton").setText(this.oCoreApi.getText("no"));sap.ui.core.Fragment.byId("idMessageDialogFragment","idCancelButton").setText(this.oCoreApi.getText("cancel"));var c=new sap.m.Label();c.addStyleClass("dialogText");c.setText(this.oCoreApi.getText("unsavedConfiguration"));this.unsavedDataConfirmationDialog.removeAllContent();this.unsavedDataConfirmationDialog.addContent(c);},handleListItemSelect:function(e){var b=e.getParameter("listItem").getBindingContext().getPath().split("/")[2];this.appId=this.getView().getModel().getData().tableData[b].id;this.byId("idTextCleanupButton").setEnabled(true);},handleListItemPress:function(e){var b=e.getParameter("listItem").getBindingContext().getPath().split("/")[2];var a=this.getView().getModel().getData().tableData[b].id;sap.ui.core.UIComponent.getRouterFor(this).navTo("configurationList",{appId:a});},onLiveChange:function(){this.byId("idSaveButton").setEnabled(true);},addNewApplication:function(){if(!this.addNewItemDialog){this.addNewItemDialog=sap.ui.xmlfragment("idAddNewApplicationFragment","sap.apf.modeler.ui.fragment.newApplication",this);this.getView().addDependent(this.addNewItemDialog);this._setNewApplicationText();}this.addNewItemDialog.getContent()[0].getContent()[1].setValue("");this.addNewItemDialog.getContent()[0].getContent()[3].setValue("FioriApplication");this.addNewItemDialog.getBeginButton().setEnabled(false);jQuery.sap.syncStyleClass("sapUiSizeCompact",this.getView(),this.addNewItemDialog);this.addNewItemDialog.open();},applicationDescChange:function(e){this.isAppDesc=e.getParameters().value.trim().length!==0?true:false;if(this.isAppDesc){this.addNewItemDialog.getBeginButton().setEnabled(true);}else{this.addNewItemDialog.getBeginButton().setEnabled(false);}},closeNewAppDialog:function(){if(this.addNewItemDialog.isOpen()){this.addNewItemDialog.close();}},handleSaveDialogPress:function(){var s=this;var d=this.getView().getDependents();var a={};d.forEach(function(D){if(D.sId==="idAddNewApplicationFragment--idNewApp"){a.ApplicationName=D.getContent()[0].getContent()[1].getValue()!==""?D.getContent()[0].getContent()[1].getValue():undefined;a.SemanticObject=D.getContent()[0].getContent()[3].getValue()!==""?D.getContent()[0].getContent()[3].getValue():undefined;}});this.applicationHandler.setAndSave(a,function(r,m,b){if(b===undefined&&(typeof r==="string")){s._enableDisplayMode();s.byId('idApplicationTable').rerender();var c=s.byId('idApplicationTable').getItems()[s.byId('idApplicationTable').getItems().length-1].$();if(c.length!==0){c[0].scrollIntoView();}s.addNewItemDialog.close();}else{var M=s.oCoreApi.createMessageObject({code:"12000"});M.setPrevious(b);s.oCoreApi.putMessage(M);}});},_openImportMenu:function(e){var s=this;var i=new sap.m.StandardListItem({title:s.oCoreApi.getText("importDeliveredContent"),type:sap.m.ListType.Active,press:function(){s._openImportDeliveredContentDialog();}});var a=new sap.m.StandardListItem({title:s.oCoreApi.getText("importFiles"),type:sap.m.ListType.Active,press:function(){s._openImportFilesDialog();}});var p=new sap.m.Popover({placement:sap.m.PlacementType.Top,showHeader:false});var A=new sap.m.List({items:[i,a]});p.addContent(A);p.openBy(e.getSource());},handleImportButtonPress:function(e){var s=this;var i=this.oCoreApi.getStartParameterFacade().isLrepActive();if(i){s._openImportMenu(e);}else{s._openImportFilesDialog();}},handleUploadOfConfig:function(){this.oJSONFileUploader=sap.ui.core.Fragment.byId("idImportConfigurationFragment","idJsonFileUploader");this.oTextPropertyFileUploader=sap.ui.core.Fragment.byId("idImportConfigurationFragment","idTextFileUploader");if((this.oJSONFileUploader.getValue()&&this.oTextPropertyFileUploader.getValue())||this.oJSONFileUploader.getValue()){this.oJSONFileUploader.upload();}else{this.oTextPropertyFileUploader.upload();}},addAcceptAttribute:function(){var j=jQuery("#idImportConfigurationFragment--idJsonFileUploader-fu");var p=jQuery("#idImportConfigurationFragment--idTextFileUploader-fu");j.attr('accept','.json');p.attr('accept','.properties');},closeImportConfigDialog:function(){if(this.importConfigurationDialog&&this.importConfigurationDialog.isOpen()){this.importConfigurationDialog.destroy();}if(this.importDeliveredContentDialog&&this.importDeliveredContentDialog.isOpen()){this.importDeliveredContentDialog.destroy();}if(this.overwriteConfirmationDialog&&this.overwriteConfirmationDialog.isOpen()){this.overwriteConfirmationDialog.destroy();}},handleJSONFileUploadComplete:function(e){var s=this;var m=this.oCoreApi.getText("errorReadingJSONFile");var f=e.getSource().oFileUpload.files[0];if(f){var r=new FileReader();r.readAsText(f,"UTF-8");r.onload=function(a){s.parsedConfigString=JSON.parse(a.target.result);s.appIdFromConfigFile=s.parsedConfigString.configHeader.Application;s._importConfigurationFile(s.parsedConfigString);};r.onerror=function(){sap.m.MessageToast.show(m);};}},handleTextFileUploadComplete:function(e){var s=this;var m=this.oCoreApi.getText("errorReadingPropertiesFile");var a=this.oCoreApi.getText("asyncMsg");var f=e.getSource().oFileUpload.files[0];if(f){var r=new FileReader();r.readAsText(f,"UTF-8");r.onload=function(b){var l=b.target.result.split(/\r?\n/);var c=l.length;var d,i;for(i=0;i<c;i++){d=/^\#\s*ApfApplicationId=[0-9A-F]+\s*$/.exec(l[i]);if(d!==null){s.appIdFromTextFile=l[i].split('=')[1];}}var E;for(i=0;i<s.applicationHandler.getList().length;i++){if(s.appIdFromTextFile===s.applicationHandler.getList()[i].Application){E=true;break;}else{E=false;}}if(!E&&s.oJSONFileUploader&&!s.oJSONFileUploader.getValue()){sap.m.MessageToast.show("chooseJsonFile");}else if(s.oJSONFileUploader&&s.oJSONFileUploader.getValue()){if(s.appIdFromConfigFile&&s.appIdFromTextFile&&s.appIdFromTextFile!==s.appIdFromConfigFile){sap.m.MessageToast.show(a);s.closeImportConfigDialog();}else{s._importPropertiesFile(b.target.result);}}else if(E&&s.oJSONFileUploader&&!s.oJSONFileUploader.getValue()){s._importPropertiesFile(b.target.result);}};r.onerror=function(){sap.m.MessageToast.show(m);};}},_importConfigurationFile:function(p){var s=this;var a=this.oCoreApi.getText("successsMsgForConfigFileImport");function c(b,m,d){if(s.oTextPropertyFileUploader&&!s.oTextPropertyFileUploader.getValue()){s.closeImportConfigDialog();}if(d===undefined){s._updateAppList();sap.m.MessageToast.show(a);if(s.oTextPropertyFileUploader&&s.oTextPropertyFileUploader.getValue()){s.oTextPropertyFileUploader.upload();}}else{s._logErrorInImport(d);}}this.oCoreApi.importConfiguration(JSON.stringify(p),function(b,d){s.callbackOverwrite=b;s.callbackCreateNew=d;s._openConfirmationDialog();},c);},_logErrorInImport:function(m){var M=this.oCoreApi.createMessageObject({code:"11502"});M.setPrevious(m);this.oCoreApi.putMessage(M);},_importPropertiesFile:function(p){var s=this;var a=this.oCoreApi.getText("successsMsgForPropertyFileImport");this.oCoreApi.importTexts(p,function(m){if(m===undefined){sap.m.MessageToast.show(a);}else{var M=s.oCoreApi.createMessageObject({code:"11503"});M.setPrevious(m);s.oCoreApi.putMessage(M);}});this.closeImportConfigDialog();},handleTypeMissmatchForJSONFile:function(){var m=this.oCoreApi.getText("jsonFileMissmatch");sap.m.MessageToast.show(m);},handleTypeMissmatchForPropertiesFile:function(){var m=this.oCoreApi.getText("propertiesFileMissmatch");sap.m.MessageToast.show(m);},_openConfirmationDialog:function(){this.overwriteConfirmationDialog=sap.ui.xmlfragment("idOverwriteConfirmationFragment","sap.apf.modeler.ui.fragment.overwriteConfirmation",this);this.getView().addDependent(this.overwriteConfirmationDialog);this._setOverwriteConfirmationDialogText();jQuery.sap.syncStyleClass("sapUiSizeCompact",this.getView(),this.overwriteConfirmationDialog);this.overwriteConfirmationDialog.open();},handleConfirmOverwriting:function(){this.callbackOverwrite();},handleNoButtonPress:function(){this.callbackCreateNew();},handleTextCleanUpPress:function(){var s=this;this.oCoreApi.getConfigurationHandler(this.appId,function(c){s.oTextPool=c.getTextPool();s.oCoreApi.getUnusedTextKeys(s.appId,function(u,m){if(m===undefined){s.oTextPool.removeTexts(u,s.appId,function(m){if(m===undefined){var a=s.oCoreApi.getText("successtextCleanup");sap.m.MessageToast.show(a,{width:"20em"});}});}else{var M=s.oCoreApi.createMessageObject({code:"12000"});M.setPrevious(m);s.oCoreApi.putMessage(M);}});});},navToConfigList:function(){var s=this;return{fn:function(){if(!s.bIsEditMode){var b=this.getBindingContext().getPath().split("/")[2];var a=s.getView().getModel().getData().tableData[b].id;sap.ui.core.UIComponent.getRouterFor(s).navTo("configurationList",{appId:a});}}};},handleNavBack:function(){window.history.go(-1);},_openImportFilesDialog:function(){this.importConfigurationDialog=sap.ui.xmlfragment("idImportConfigurationFragment","sap.apf.modeler.ui.fragment.importConfiguration",this);this.getView().addDependent(this.importConfigurationDialog);this._setImportConfigDialogText();this._addImportConfigStyleClass();jQuery.sap.syncStyleClass("sapUiSizeCompact",this.getView(),this.importConfigurationDialog);this.importConfigurationDialog.open();},_handleImportOfDeliveredContent:function(){var s=this;var a=this.oCoreApi.getText("successsMsgForConfigFileImport");function c(e,m,f){s.closeImportConfigDialog();if(f===undefined){s._updateAppList();sap.m.MessageToast.show(a);}else{s._logErrorInImport(f);}}this.handleChangeOfAppConfigTextField();var A=sap.ui.core.Fragment.byId("idImportDeliveredContentFragment","idAppConfigCombobox");if(A.getSelectedItem()!==null){var v=A.getSelectedItem().data("value").split(".");var b=v[0];var d=v[1];this.oCoreApi.importConfigurationFromLrep(b,d,function(e,f){s.callbackOverwrite=e;s.callbackCreateNew=f;s._openConfirmationDialog();},c);}},_setAppConfigDataFromVendorLayer:function(){var s=this;var p=this.oCoreApi.readAllConfigurationsFromVendorLayer();p.then(function(c){var m=new sap.ui.model.json.JSONModel();var h={applicationText:s.oCoreApi.getText("application"),configurationText:s.oCoreApi.getText("configuration")};c.splice(0,0,h);var a={aAllAppConfig:c};m.setSizeLimit(c.length);m.setData(a);var A=sap.ui.core.Fragment.byId("idImportDeliveredContentFragment","idAppConfigCombobox");A.setModel(m);A.getItems()[0].setEnabled(false);s.importDeliveredContentDialog.open();});},_openImportDeliveredContentDialog:function(){this.importDeliveredContentDialog=sap.ui.xmlfragment("idImportDeliveredContentFragment","sap.apf.modeler.ui.fragment.importDeliveredContent",this);this.getView().addDependent(this.importDeliveredContentDialog);this._setImportDeliveredContentDialogText();this._setAppConfigDataFromVendorLayer();},handleChangeOfAppConfigTextField:function(){var m,a;a=sap.ui.core.Fragment.byId("idImportDeliveredContentFragment","idAppConfigCombobox");m=a.getItems().filter(function(i){return i.getText()===a.getValue();});if(!m.length){jQuery(a).focus();jQuery(".appCofigCombo").find('input').focus();a.setValueState(sap.ui.core.ValueState.Error);}},handleSelectionChangeOfAppConfigTextField:function(){sap.ui.core.Fragment.byId("idImportDeliveredContentFragment","idAppConfigCombobox").setValueState(sap.ui.core.ValueState.None);}});};if(!jQuery.sap.isDeclared('sap.apf.modeler.ui.controller.category.controller')){jQuery.sap.declare('sap.apf.modeler.ui.controller.category.controller');(function(){"use strict";var p,t,c,C,T,o,v;var n=new sap.apf.modeler.ui.utils.NullObjectChecker();function _(h){var i=h.byId("idCategoryTitle");var j=new sap.apf.modeler.ui.utils.TextPoolHelper(T);var D={oTranslationFormat:sap.apf.modeler.ui.utils.TranslationFormatMap.CATEGORY_TITLE,type:"text"};j.setAutoCompleteOn(i,D);}function a(h){h.byId("idCategoryBasicData").setTitle(t("categoryData"));h.byId("idCategoryTitleLabel").setText(t("categoryTitle"));h.byId("idCategoryTitle").setPlaceholder(t("newCategory"));h.byId("idTotalStepsLabel").setText(t("totalSteps"));}function b(h){var s;if(p&&p.arguments&&p.arguments.categoryId){o=C.getCategory(p.arguments.categoryId);}if(!n.checkIsNotUndefined(o)){s=C.setCategory();o=C.getCategory(s);d(h);}}function d(h,i){var j={id:o.getId(),icon:"sap-icon://open-folder"};if(i){delete j.icon;j.name=i;}h.getView().getViewData().updateSelectedNode(j);}function e(h,i){var s=t("category")+": "+i;h.getView().getViewData().updateTitleAndBreadCrumb(s);}function f(h){if(!n.checkIsNotNullOrUndefinedOrBlank(C.getCategory(p.arguments.categoryId))){return;}if(n.checkIsNotNullOrUndefinedOrBlank(o.labelKey)&&T.get(o.labelKey)){h.byId("idCategoryTitle").setValue(T.get(o.labelKey).TextElementDescription);}else{h.byId("idCategoryTitle").setValue(o.getId());}}function g(h){var i=C.getCategoryStepAssignments(o.getId()).length;h.byId("idTotalSteps").setValue(i);}sap.ui.controller("sap.apf.modeler.ui.controller.category",{onInit:function(){var h=this;var V=h.getView().getViewData();t=V.getText;p=V.oParams;c=V.oConfigurationHandler;T=c.getTextPool();C=V.oConfigurationEditor;if(!C){c.loadConfiguration(p.arguments.configId,function(i){C=i;});}v=new sap.apf.modeler.ui.utils.ViewValidator(h.getView());a(h);_(h);b(h);h.setDetailData();v.addField("idCategoryTitle");},setDetailData:function(){var h=this;f(h);g(h);},handleChangeDetailValue:function(E){var h=this,s,i;var j=h.byId("idCategoryTitle").getValue().trim();var k=sap.apf.modeler.ui.utils.TranslationFormatMap.CATEGORY_TITLE;if(n.checkIsNotNullOrUndefinedOrBlank(j)){s=T.setText(j,k);i={labelKey:s};C.setCategory(i,o.getId());d(h,j);e(h,j);}C.setIsUnsaved();},updateSubViewInstancesOnReset:function(h){C=h;o=C.getCategory(o.getId());},getValidationState:function(){return v.getValidationState();},onExit:function(){v=null;}});})();};if(!jQuery.sap.isDeclared('sap.apf.modeler.ui.controller.configuration.controller')){jQuery.sap.declare('sap.apf.modeler.ui.controller.configuration.controller');sap.ui.controller("sap.apf.modeler.ui.controller.configuration",{onInit:function(){this.getView().addStyleClass("sapUiSizeCompact");this.oViewData=this.getView().getViewData();this.oApplicationHandler=this.oViewData.oApplicationHandler;this.oConfigurationHandler=this.oViewData.oConfigurationHandler;this.oTextPool=this.oConfigurationHandler.getTextPool();this.oConfigurationEditor=this.oViewData.oConfigurationEditor;this.getText=this.oViewData.getText;this.params=this.oViewData.oParams;this._setDisplayText();this.setDetailData();var m=[];m.push(this.byId("idConfigTitle"));this._setMandatoryFields(m);},_setDisplayText:function(){this.byId("idConfigurationBasicData").setTitle(this.getText("configurationData"));this.byId("idConfigTitleLabel").setText(this.getText("configTitle"));this.byId("idConfigTitleLabel").setRequired(true);this.byId("idConfigTitle").setPlaceholder(this.getText("newConfiguration"));this.byId("idConfigurationIdLabel").setText(this.getText("configurationId"));this.byId("idSemanticObjectLabel").setText(this.getText("semanticObject"));this.byId("idNoOfCategoriesLabel").setText(this.getText("noOfCategories"));this.byId("idNoOfStepsLabel").setText(this.getText("noOfSteps"));},setDetailData:function(){if(this.params&&this.params.arguments&&this.params.arguments.configId){var e=this.oConfigurationHandler.getConfiguration(this.params.arguments.configId);}if(e){this.byId("idConfigTitle").setValue(e.AnalyticalConfigurationName);if(e.AnalyticalConfiguration.indexOf(sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.ISNEWCONFIG)===-1){this.byId("idConfigurationId").setValue(e.AnalyticalConfiguration);}var n=this.oConfigurationEditor.getCategories().length;var a=this.oConfigurationEditor.getSteps().length;this.byId("idNoOfCategories").setValue(n);this.byId("idNoOfSteps").setValue(a);var b=this.oApplicationHandler.getApplication(this.params.arguments.appId);if(b!==undefined){this.byId("idSemanticObject").setValue(b.SemanticObject);}}else{var c=this.oApplicationHandler.getApplication(this.params.arguments.appId);if(c){this.byId("idSemanticObject").setValue(c.SemanticObject);}}},handleChangeDetailValue:function(){var s=this;var c={};var C=this.byId("idConfigTitle").getValue().trim();var a={AnalyticalConfigurationName:C};if(this.oConfigurationEditor){this.oConfigurationEditor.setIsUnsaved();}var t;var o=this.oConfigurationHandler.getConfiguration(this.params.arguments.configId);if(C!==""&&C!==undefined){if(o!==undefined){this.oConfigurationHandler.setConfiguration(a,this.params.arguments.configId);this.oConfigurationHandler.loadConfiguration(this.params.arguments.configId,function(b){var T=sap.apf.modeler.ui.utils.TranslationFormatMap.APPLICATION_TITLE;var A=s.oTextPool.setText(C,T);b.setApplicationTitle(A);c.name=C;var d=s.getText("configuration")+": "+C;if(C){s.oViewData.updateSelectedNode(c);s.oViewData.updateTitleAndBreadCrumb(d);}});}else{t=this.oConfigurationHandler.setConfiguration(a);this.oConfigurationHandler.loadConfiguration(t,function(b){var T=sap.apf.modeler.ui.utils.TranslationFormatMap.APPLICATION_TITLE;var A=s.oTextPool.setText(C,T);b.setApplicationTitle(A);var d={appId:s.params.arguments.appId,configId:t};c.name=C;var e=s.getText("configuration")+": "+C;c.id=o===undefined?a.AnalyticalConfiguration:undefined;if(C){s.oViewData.updateSelectedNode(c,d);s.oViewData.updateTitleAndBreadCrumb(e);}});}}},_setMandatoryFields:function(f){this.mandatoryFields=this.mandatoryFields||[];for(var i=0;i<f.length;i++){f[i].isMandatory=true;this.mandatoryFields.push(f[i]);}},_getMandatoryFields:function(){return this.mandatoryFields;},_setValidationState:function(){var m=this._getMandatoryFields();for(var i=0;i<m.length;i++){if(m[i].isMandatory===true){this.isValidState=(m[i].getValue().trim()!=="")?true:false;if(this.isValidState===false){break;}}}},getValidationState:function(){this._setValidationState();var i=(this.isValidState!==undefined)?this.isValidState:true;return i;}});};if(!jQuery.sap.isDeclared('sap.apf.modeler.ui.controller.facetFilter.controller')){jQuery.sap.declare('sap.apf.modeler.ui.controller.facetFilter.controller');
/*!
 * SAP APF Analysis Path Framework
 *
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
(function(){"use strict";var p,t,c,C,T,f,v;var n=new sap.apf.modeler.ui.utils.NullObjectChecker();var o=new sap.apf.modeler.ui.utils.OptionsValueModelBuilder();function _(i){var I=new sap.apf.modeler.ui.utils.TextPoolHelper(T);var J=sap.apf.modeler.ui.utils.TranslationFormatMap.FACETFILTER_LABEL;var K={oTranslationFormat:J,type:"text"};var L=i.byId("idLabel");I.setAutoCompleteOn(L,K);}function a(i){i.byId("idFacetFilterBasicData").setTitle(t("basicData"));i.byId("idFFLabel").setText(t("ffLabel"));i.byId("idLabel").setPlaceholder(t("New Filter"));i.byId("idFFPropertyLabel").setText(t("ffProperty"));i.byId("idDoNotShowAtRuntimeLabel").setText(t("doNotShowAtRuntime"));i.byId("idSelectionModeLabel").setText(t("ffSelectionMode"));i.byId("idValueHelpLabel").setText(t("valueHelpMode"));i.byId("idVHNone").setText(t("none"));i.byId("idValueHelpRequest").setText(t("valueHelpRequest"));i.byId("idConfigListOfValues").setText(t("configListOfValues"));i.byId("idConfigListOfValuesLabel").setText(t("configListOfValuesLabel"));i.byId("idSingleSelectionMode").setText(t("singleSelection"));i.byId("idMultiSelectionMode").setText(t("multipleSelection"));i.byId("idDefaultValuesTitle").setTitle(t("vhDefaultValues"));i.byId("idPreselectionModeLabel").setText(t("vhDefaultValueMode"));i.byId("idAutomaticSelection").setText(t("automaticValue"));i.byId("idFixedValue").setText(t("fixedValues"));i.byId("idFunction").setText(t("function"));i.byId("idPreselectionDefaultsLabel").setText(t("vhDefaultValues"));i.byId("idPreselectionFunctionLabel").setText(t("function"));i.byId("idValueHelpTitle").setTitle(t("valueHelp"));i.byId("idFFAliasLabel").setText(t("ffAlias"));i.byId("idFilterResolutionTitle").setTitle(t("filterResolution"));i.byId("idUseVHRAsFRRCheckBoxLabel").setText(t("vhCheckBoxLabel"));}function b(i,I){var J={id:f.getId(),icon:"sap-icon://filter"};if(I){delete J.icon;J.name=I;}i.getView().getViewData().updateSelectedNode(J);}function d(i,I){var J=t("facetFilter")+": "+I;i.getView().getViewData().updateTitleAndBreadCrumb(J);}function e(i){var I;if(p&&p.arguments&&p.arguments.facetFilterId){f=C.getFacetFilter(p.arguments.facetFilterId);}if(!n.checkIsNotUndefined(f)){I=C.createFacetFilter();f=C.getFacetFilter(I);b(i);}}function g(i){var I,J,V,K;var L={oTextReader:t,oConfigurationHandler:c,oConfigurationEditor:C,oParentObject:f,getCalatogServiceUri:i.getView().getViewData().getCalatogServiceUri};I=new sap.ui.controller("sap.apf.modeler.ui.controller.facetFilterVHR");V=new sap.ui.view({viewName:"sap.apf.modeler.ui.view.requestOptions",type:sap.ui.core.mvc.ViewType.XML,id:i.createId("idVHRView"),viewData:L,controller:I});J=new sap.ui.controller("sap.apf.modeler.ui.controller.facetFilterFRR");K=new sap.ui.view({viewName:"sap.apf.modeler.ui.view.requestOptions",type:sap.ui.core.mvc.ViewType.XML,id:i.createId("idFRRView"),viewData:L,controller:J});i.getView().attachEvent("useSameAsVHREvent",K.getController().handleCopy.bind(K.getController()));i.getView().attachEvent("enableDisableFRRFieldsEvent",K.getController().enableOrDisableView.bind(K.getController()));V.attachEvent("useSameAsVHREvent",K.getController().handleCopy.bind(K.getController()));i.getView().attachEvent("updateSubViewInstancesOnResetEvent",V.getController().updateSubViewInstancesOnReset.bind(V.getController()));i.getView().attachEvent("updateSubViewInstancesOnResetEvent",K.getController().updateSubViewInstancesOnReset.bind(K.getController()));i.getView().attachEvent("doNotShowAtRuntimeEvent",V.getController().clearVHRFields.bind(V.getController()));i.getView().attachEvent("clearVHRFieldsIfValueListEvent",V.getController().clearVHRFields.bind(V.getController()));i.getView().attachEvent("doNotShowAtRuntimeEvent",K.getController().clearFRRFields.bind(K.getController()));V.addStyleClass("formTopPadding");V.addStyleClass("formBottomPadding");K.addStyleClass("formTopPadding");}function h(i,V){i.byId("idSelectionMode").setVisible(V);i.byId("idSelectionModeLabel").setVisible(V);i.byId("idSelectionModeRadioGroup").setSelectedButton(i.byId("idMultiSelectionMode"));i.byId("idValueHelp").setVisible(V);i.byId("idValueHelpLabel").setVisible(V);i.byId("idValueHelpRadioGroup").setSelectedButton(i.byId("idVHNone"));i.byId("idValueHelpTitle").setVisible(V);i.byId("idFFForm1").setVisible(V);if(V){i.byId("idFRRVBox").insertItem(i.byId("idFRRView"));i.byId("idDoNotShowAtRuntimeCheckBox").setSelected(false);}else{A(i,V);z(i,V);i.byId("idFRRVBox").removeItem(i.byId("idFRRView"));i.byId("idUseVHRAsFRRCheckBox").setSelected(V);}}function j(i){if(!f.isVisible()){i.byId("idDoNotShowAtRuntimeCheckBox").setSelected(true);}h(i,f.isVisible());}function k(i){var M=o.convert(C.getAllKnownProperties());i.byId("idFFProperty").setModel(M);if(n.checkIsNotNullOrUndefinedOrBlank(f.getProperty())){i.byId("idFFProperty").setValue(f.getProperty());}}function l(i){if(!n.checkIsNotNullOrUndefinedOrBlank(C.getFacetFilter(p.arguments.facetFilterId))){return;}if(n.checkIsNotNullOrUndefinedOrBlank(f.getLabelKey())&&T.get(f.getLabelKey())){i.byId("idLabel").setValue(T.get(f.getLabelKey()).TextElementDescription);}else{i.byId("idLabel").setValue(f.getId());}}function m(i){var M=o.convert(C.getAllKnownProperties());i.byId("idFFAlias").setModel(M);if(n.checkIsNotNullOrUndefinedOrBlank(f.getAlias())){i.byId("idFFAlias").setValue(f.getAlias());}}function q(i){if(!n.checkIsNotNullOrUndefinedOrBlank(C.getFacetFilter(p.arguments.facetFilterId))){f.setMultiSelection(true);}if(f.isMultiSelection()){i.byId("idSelectionModeRadioGroup").setSelectedButton(i.byId("idMultiSelectionMode"));}else{i.byId("idSelectionModeRadioGroup").setSelectedButton(i.byId("idSingleSelectionMode"));}}function r(i){i.byId("idPreselectionFunction").setValue("");if(n.checkIsNotNullOrUndefinedOrBlank(f.getPreselectionFunction())){i.byId("idPreselectionFunction").setValue(f.getPreselectionFunction());}}function s(i){var I=false,J=false;if(f.getAutomaticSelection()){i.byId("idPreselectionModeRadioGroup").setSelectedButton(i.byId("idAutomaticSelection"));}else{if(n.checkIsNotNullOrUndefinedOrBlank(f.getPreselectionFunction())){i.byId("idPreselectionModeRadioGroup").setSelectedButton(i.byId("idFunction"));r(i);I=true;}else{i.byId("idPreselectionModeRadioGroup").setSelectedButton(i.byId("idFixedValue"));x(i);J=true;}}u(i,I);w(i,J);}function u(i,V){i.byId("idPreselectionFunctionLabel").setVisible(V);i.byId("idPreselectionFunction").setVisible(V);if(V){v.addField("idPreselectionFunction");}else{i.byId("idPreselectionFunction").setValue("");v.removeField("idPreselectionFunction");}}function w(i,V){i.byId("idPreselectionDefaultsLabel").setVisible(V);i.byId("idPreselectionDefaults").setVisible(V);if(V){v.addField("idPreselectionDefaults");}else{v.removeField("idPreselectionDefaults");}}function x(i){i.byId("idPreselectionDefaults").setTokens([]);var I=f.getPreselectionDefaults();if(n.checkIsNotNullOrUndefinedOrBlank(I)){I.forEach(function(J){i.byId("idPreselectionDefaults").addToken(new sap.m.Token({text:J}));});}}function y(i){i.byId("idConfigListOfValuesMultiInput").setTokens([]);var I=f.getValueList();if(n.checkIsNotNullOrUndefinedOrBlank(I)){I.forEach(function(J){i.byId("idConfigListOfValuesMultiInput").addToken(new sap.m.Token({text:J}));});}}function z(i,I){i.byId("idConfigListOfValuesLabel").setVisible(I);i.byId("idConfigListOfValuesMultiInput").setVisible(I);if(I){v.addField("idConfigListOfValuesMultiInput");}else{v.removeField("idConfigListOfValuesMultiInput");}}function A(i,I){i.byId("idFFAliasLabel").setVisible(I);i.byId("idFFAlias").setVisible(I);if(I){i.byId("idVHRVBox").insertItem(i.byId("idVHRView"));}else{i.getView().fireEvent("clearVHRFieldsIfValueListEvent");i.byId("idFFAlias").setValue("");i.byId("idVHRVBox").removeItem(i.byId("idVHRView"));}}function B(i){if(f.getUseSameRequestForValueHelpAndFilterResolution()){i.byId("idUseVHRAsFRRCheckBox").setSelected(true);i.getView().fireEvent("enableDisableFRRFieldsEvent");}}function D(i){var I=false,J=false;if(n.checkIsNotNullOrUndefinedOrBlank(f.getServiceOfValueHelp())){I=true;E(i,true);i.byId("idValueHelpRadioGroup").setSelectedButton(i.byId("idValueHelpRequest"));}else if(n.checkIsNotNullOrUndefinedOrBlank(f.getValueList())){y(i);J=true;i.byId("idValueHelpRadioGroup").setSelectedButton(i.byId("idConfigListOfValues"));}else{i.byId("idValueHelpRadioGroup").setSelectedButton(i.byId("idVHNone"));}A(i,I);z(i,J);}function E(i,I){i.byId("idUseVHRAsFRRCheckBox").setVisible(I);i.byId("idUseVHRAsFRRCheckBoxLabel").setVisible(I);}function F(i,I){I.byId("idPreselectionDefaults").setValueState(sap.ui.core.ValueState.Warning);I.byId("idPreselectionDefaults").setValueStateText(t(i));I.byId('idPreselectionDefaults').focus();}function G(i,M){var P=new sap.m.Token({text:i});M.addToken(P);C.setIsUnsaved();}function H(M,i){if(M.mEventRegistry.tokenChange===undefined){M.attachTokenChange(i);}}sap.ui.controller("sap.apf.modeler.ui.controller.facetFilter",{onInit:function(){var i=this;var V=i.getView().getViewData();t=V.getText;p=V.oParams;c=V.oConfigurationHandler;T=c.getTextPool();C=V.oConfigurationEditor;if(!C){c.loadConfiguration(p.arguments.configId,function(I){C=I;});}v=new sap.apf.modeler.ui.utils.ViewValidator(i.getView());a(i);_(i);e(i);g(i);i.setDetailData();v.addFields(["idFFProperty","idLabel"]);},onAfterRendering:function(){var i=this;H(i.byId("idConfigListOfValuesMultiInput"),i.handleTokenChangeForConfigListOfValues.bind(i));H(i.byId("idPreselectionDefaults"),i.handleTokenChangeForPreselectionDefaults.bind(i));},setDetailData:function(){var i=this;j(i);k(i);l(i);m(i);q(i);s(i);D(i);B(i);},updateSubViewInstancesOnReset:function(i){var I=this;C=i;f=C.getFacetFilter(f.getId());I.getView().fireEvent("updateSubViewInstancesOnResetEvent",[C,f]);},handleChangeForVisibilityAtRuntime:function(){var i=this,V=true;if(i.byId("idDoNotShowAtRuntimeCheckBox").getSelected()){V=false;f.setInvisible();f.setUseSameRequestForValueHelpAndFilterResolution(false);i.getView().fireEvent("enableDisableFRRFieldsEvent");i.getView().fireEvent("doNotShowAtRuntimeEvent");f.setValueList([]);y(i);}else{f.setVisible();}f.setMultiSelection(true);C.setIsUnsaved();h(i,V);},handleChangeForProperty:function(){var i=this;var I=i.byId("idFFProperty").getValue().trim();if(n.checkIsNotNullOrUndefinedOrBlank(I)){f.setProperty(I);}C.setIsUnsaved();},handleChangeForLabel:function(){var i=this;var I;var J=i.byId("idLabel").getValue().trim();var K=sap.apf.modeler.ui.utils.TranslationFormatMap.FACETFILTER_LABEL;if(n.checkIsNotNullOrUndefinedOrBlank(J)){I=T.setText(J,K);f.setLabelKey(I);b(i,J);d(i,J);}C.setIsUnsaved();},handleChangeForAlias:function(){var i=this;var I=i.byId("idFFAlias").getValue().trim();f.setAlias(undefined);if(n.checkIsNotNullOrUndefinedOrBlank(I)){f.setAlias(I);}C.setIsUnsaved();},handleChangeForSelectionMode:function(){var i=this,P,I;var S=i.byId("idSelectionModeRadioGroup").getSelectedButton();if(S===i.byId("idSingleSelectionMode")){f.setMultiSelection(false);if(i.byId("idPreselectionDefaultsLabel").getVisible()){P=f.getPreselectionDefaults();if(P&&P.length>1){f.setPreselectionDefaults([P[0]]);I=new sap.m.Token({text:P[0]});i.byId("idPreselectionDefaults").setTokens([I]);F("singleToMultipleSelectionWarningMessage",i);}}}else{i.byId("idPreselectionDefaults").setValueState(sap.ui.core.ValueState.None);f.setMultiSelection(true);}C.setIsUnsaved();},handleChangeForPreselectionMode:function(){var i=this,I=false,P=false,J=false;switch(i.byId("idPreselectionModeRadioGroup").getSelectedButton()){case i.byId("idFunction"):P=true;f.removePreselectionDefaults();break;case i.byId("idFixedValue"):J=true;f.removePreselectionFunction();break;default:I=true;}f.setAutomaticSelection(I);x(i);r(i);w(i,J);u(i,P);C.setIsUnsaved();},handleChangeForPreselectionDefaults:function(i){var I=this;I.byId("idPreselectionDefaults").setValue("");I.byId("idPreselectionDefaults").setValueState(sap.ui.core.ValueState.None);if(!f.isMultiSelection()){if(I.byId("idPreselectionDefaults").getTokens().length<1){I.byId("idPreselectionDefaults").setValueState(sap.ui.core.ValueState.None);G(i.getParameter("value"),I.byId("idPreselectionDefaults"));}else{F("singleSelectionWarningMessage",I);}}else{G(i.getParameter("value"),I.byId("idPreselectionDefaults"));}},handleTokenChangeForPreselectionDefaults:function(I){var J=this;var i,K=[];var L=J.byId("idPreselectionDefaults").getTokens();J.byId("idPreselectionDefaults").setValueState(sap.ui.core.ValueState.None);if(I.getParameters().type==="removed"||I.getParameters().type==="added"){for(i=0;i<L.length;i++){K[i]=L[i].getText();}if(f.isMultiSelection()){f.setPreselectionDefaults(K);}else{f.setPreselectionDefaults([K[0]]);}if(I.getParameters().type==="removed"){C.setIsUnsaved();}}},handleChangeForPreselectionFunction:function(){var i=this;var P=i.byId("idPreselectionFunction").getValue().trim();f.removePreselectionFunction();if(n.checkIsNotNullOrUndefinedOrBlank(P)){f.setPreselectionFunction(P);}C.setIsUnsaved();},handleChangeForUseVHRAsFRRCheckBox:function(){var i=this;if(i.byId("idUseVHRAsFRRCheckBox").getSelected()){f.setUseSameRequestForValueHelpAndFilterResolution(true);}else{f.setUseSameRequestForValueHelpAndFilterResolution(false);}i.getView().fireEvent("enableDisableFRRFieldsEvent");i.getView().fireEvent("useSameAsVHREvent");C.setIsUnsaved();},handleChangeForValueHelpOption:function(){var i=this,V=false,I=false;switch(i.byId("idValueHelpRadioGroup").getSelectedButton()){case i.byId("idValueHelpRequest"):V=true;f.setValueList([]);break;case i.byId("idConfigListOfValues"):I=true;f.setAlias(undefined);break;default:f.setAlias(undefined);f.setValueList([]);}if(f.getUseSameRequestForValueHelpAndFilterResolution()===true){f.setUseSameRequestForValueHelpAndFilterResolution(false);i.byId("idUseVHRAsFRRCheckBox").setSelected(false);}i.getView().fireEvent("enableDisableFRRFieldsEvent");E(i,V);y(i);A(i,V);z(i,I);C.setIsUnsaved();},handleChangeForConfigListOfValues:function(i){var I=this;I.byId("idConfigListOfValuesMultiInput").setValue("");G(i.getParameter("value"),I.byId("idConfigListOfValuesMultiInput"));},handleTokenChangeForConfigListOfValues:function(I){var J=this;var i,K=[];var L=J.byId("idConfigListOfValuesMultiInput").getTokens();if(I.getParameters().type==="removed"||I.getParameters().type==="added"){for(i=0;i<L.length;i++){K[i]=L[i].getText();}f.setValueList(K);if(I.getParameters().type==="removed"){C.setIsUnsaved();}}},getValidationState:function(){var i=this;return v.getValidationState()&&i.byId("idVHRView").getController().getValidationState()&&i.byId("idFRRView").getController().getValidationState();},onExit:function(){var i=this;i.byId("idVHRView").destroy();i.byId("idFRRView").destroy();}});}());};if(!jQuery.sap.isDeclared('sap.apf.modeler.ui.controller.navigationTarget.controller')){jQuery.sap.declare('sap.apf.modeler.ui.controller.navigationTarget.controller');(function(){"use strict";var p,t,T,c,C,n,v,N;var a=new sap.apf.modeler.ui.utils.NullObjectChecker();var o=new sap.apf.modeler.ui.utils.OptionsValueModelBuilder();function _(i){i.byId("idNavigationTargetHeaderLabel").setTitle(t("basicData"));i.byId("idSemanticObjectLabel").setText(t("semanticObject"));i.byId("idActionLabel").setText(t("action"));i.byId("idDescriptionLabel").setText(t("navigationTargetTitle"));i.byId("idNavigationTargetTypeHeaderLabel").setTitle(t("navigationTargetType"));i.byId("idNavigationTargetTypeLabel").setText(t("assignmentType"));i.byId("idAssignedStepsLabel").setText(t("assignedSteps"));i.byId("idContextMapping").setTitle(t("contextMapping"));}function b(i){var w;if(p&&p.arguments&&p.arguments.navTargetId){n=C.getNavigationTarget(p.arguments.navTargetId);}if(!a.checkIsNotUndefined(n)){w=C.createNavigationTarget();n=C.getNavigationTarget(w);l(i);}}function d(i){var w,x;var V={oTextReader:t,oConfigurationHandler:c,oConfigurationEditor:C,oParentObject:n,getCalatogServiceUri:i.getView().getViewData().getCalatogServiceUri};w=new sap.ui.controller("sap.apf.modeler.ui.controller.navTargetContextMapping");x=new sap.ui.view({viewName:"sap.apf.modeler.ui.view.requestOptions",type:sap.ui.core.mvc.ViewType.XML,id:i.createId("idContextMappingView"),viewData:V,controller:w});i.getView().attachEvent("updateSubViewInstancesOnResetEvent",x.getController().updateSubViewInstancesOnReset.bind(x.getController()));x.addStyleClass("requestFFForm");i.byId("idContextMappingVBox").insertItem(x);}function e(i){var P=jQuery.Deferred();N.getAllAvailableSemanticObjects(function(w,x){if(x===undefined){var M=o.prepareModel(w,w.length);i.byId("idSemanticObjectField").setModel(M);if(a.checkIsNotNullOrUndefinedOrBlank(n.getSemanticObject())){i.byId("idSemanticObjectField").setValue(n.getSemanticObject());}P.resolve();}else{s(i,x,"11504");}});return P.promise();}function f(i){var M,P;P=jQuery.Deferred();M=o.prepareModel([],0);i.byId("idActionField").setModel(M);h(undefined,i);g(i).then(function(S){P.resolve(S);});i.byId("idActionField").setValue(n.getAction());return P.promise();}function g(i){var M,S,P,w;w=new jQuery.Deferred();S=n.getSemanticObject();if(a.checkIsNotUndefined(S)){P=N.getSemanticActions(S);P.then(function(x){M=o.prepareModel(x.semanticActions,x.semanticActions.length);i.byId("idActionField").setModel(M);w.resolve(x);},function(x){s(i,x,"11505");});}return w.promise();}function h(S,w){var x,y,i;var A=S?S:w.byId("idActionField").getModel().getData().Objects;if(a.checkIsNotNullOrBlank(w.byId("idActionField").getValue())){for(i=0;i<A.length;i++){if(A[i].id===n.getAction()){x=A[i].text;break;}}}y=x?x:n.getSemanticObject();w.byId("idDescription").setValue(y);}function j(i){var w=new sap.apf.modeler.ui.utils.staticValuesBuilder(t);var x=w.getNavTargetTypeData();var M=o.convert(x,x.length);i.byId("idNavigationTargetTypeField").setModel(M);var y=n.isStepSpecific()?t("stepSpecific"):t("globalNavTargets");i.byId("idNavigationTargetTypeField").setSelectedKey(y);}function k(w){var x=n.isStepSpecific()?t("stepSpecific"):t("globalNavTargets");if(x===t("stepSpecific")){r(w,true);var A=[];var S=C.getSteps();for(var i=0;i<S.length;i++){var y={};y.stepKey=S[i].getId();y.stepName=T.get(S[i].getTitleId()).TextElementDescription;A.push(y);}var M=o.prepareModel(A,A.length);w.byId("idAssignedStepsCombo").setModel(M);var z=C.getStepsAssignedToNavigationTarget(n.getId());w.byId("idAssignedStepsCombo").setSelectedKeys(z);}}function l(i){var w={id:n.getId(),icon:n.isGlobal()?"sap-icon://BusinessSuiteInAppSymbols/icon-where-used":"sap-icon://pushpin-off"};if(i.byId("idDescription").getValue()){w.name=i.byId("idDescription").getValue();}N.updateSelectedNode(w);}function m(i){var F=t("navigationTarget")+": "+i.byId("idDescription").getValue();N.updateTitleAndBreadCrumb(F);}function q(i){var w={key:n.getId(),value:i.byId("idDescription").getValue()};N.setNavigationTargetName(w);}function r(i,I){i.byId("idAssignedStepsLabel").setVisible(I);i.byId("idAssignedStepsCombo").setVisible(I);}function s(i,M,w){var x=N.createMessageObject({code:w});x.setPrevious(M);N.putMessage(x);}function u(){var i=C.getStepsAssignedToNavigationTarget(n.getId());for(var w=0;w<i.length;w++){var S=C.getStep(i[w]);S.removeNavigationTarget(n.getId());}}sap.ui.controller("sap.apf.modeler.ui.controller.navigationTarget",{onInit:function(){var i=this;N=i.getView().getViewData();c=N.oConfigurationHandler;C=N.oConfigurationEditor;T=c.getTextPool();t=N.getText;p=N.oParams;if(!C){c.loadConfiguration(p.arguments.configId,function(w){C=w;});}_(i);v=new sap.apf.modeler.ui.utils.ViewValidator(i.getView());v.addFields(["idSemanticObjectField","idActionField"]);b(i);d(i);i.setDetailData();},setDetailData:function(){var i=this;e(i).then(function(){f(i).then(function(S){h(S.semanticActions,i);});});j(i);k(i);},updateSubViewInstancesOnReset:function(i){var w=this;C=i;n=C.getNavigationTarget(n.getId());w.getView().fireEvent("updateSubViewInstancesOnResetEvent",[C,n]);},handleChangeSemanticObjectValue:function(E){var S,i=this;S=E.getParameter("value").trim();if(a.checkIsNotNullOrBlank(S)){n.setSemanticObject(S);g(i).then(function(w){if(w.semanticActions.length>0){n.setAction(i.byId("idActionField").getModel().getData().Objects[0].id);i.byId("idActionField").setSelectedKey(w.semanticActions[0].id);}else{i.byId("idActionField").setValue("");}h(w.semanticActions,i);l(i);m(i);q(i);});}C.setIsUnsaved();},handleChangeofAction:function(E){var A,i=this;A=E.getParameter("value");if(a.checkIsNotNullOrBlank(A)){n.setAction(A);}h(undefined,i);l(i);m(i);q(i);C.setIsUnsaved();},handleChangeOfNavigationTargetType:function(){var i=this;C.setIsUnsaved();var w=i.byId("idNavigationTargetTypeField").getSelectedKey();if(w===t("stepSpecific")){n.setStepSpecific();k(i);}else{n.setGlobal();r(i,false);i.byId("idAssignedStepsCombo").setSelectedKeys([]);u();}l(i,this.byId("idDescription").getValue());},handleChangeForAssignedSteps:function(){var i=this;C.setIsUnsaved();var w=i.byId("idAssignedStepsCombo").getSelectedKeys();var x=C.getStepsAssignedToNavigationTarget(n.getId());x.forEach(function(S){if(w.indexOf(S)===-1){var y=C.getStep(S);y.removeNavigationTarget(n.getId());}});w.forEach(function(S){if(x.indexOf(S)===-1){var y=C.getStep(S);y.addNavigationTarget(n.getId());}});},getValidationState:function(){var i=this;return v.getValidationState()&&i.byId("idContextMappingView").getController().getValidationState();},onExit:function(){var i=this;i.byId("idContextMappingView").destroy();}});}());};if(!jQuery.sap.isDeclared('sap.apf.modeler.ui.controller.previewContent.controller')){jQuery.sap.declare('sap.apf.modeler.ui.controller.previewContent.controller');
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP SE. All rights reserved
 */
sap.ui.getCore().loadLibrary("sap.viz");sap.ui.controller("sap.apf.modeler.ui.controller.previewContent",{onInit:function(){this.oView=this.getView();this.oView.addStyleClass("sapUiSizeCompact");this.oMainChartHolder=this.oView.byId("idMainChart");this.oThumbnailChartHolder=this.oView.byId("idThumbnailChartLayout");this.mParam=this.oView.getViewData();this._prepareRepresentationInstance();this._drawContent();if(this.mParam.sChartType===sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION){this.oView.byId("idMainChart").getItems()[0].getContent()[0].getContent()[0].addEventDelegate({onAfterRendering:function(){document.querySelector('.tableWithoutHeaders').style.cssText+="height : "+"400px";}});}},_drawContent:function(){this._drawMainChart();this._drawThumbnailContent();this._addStyleClasses();},_drawMainChart:function(){var m=this.oRepresentationInstance.getMainContent(this.mParam.sStepLongTitle,480,330);this.oMainChartHolder.addItem(m);},_drawThumbnailContent:function(){this._drawThumbnailChart();this.oView.byId("idStepTitleText").setText(this.mParam.sStepTitle);this._drawCornerTexts();},_drawThumbnailChart:function(){var t=this.oRepresentationInstance.getThumbnailContent();this.oThumbnailChartHolder.addItem(t);},_drawCornerTexts:function(){this.oView.byId("idLeftUpperCornerText").setText(this.mParam.aCornerTexts.sLeftUpper);this.oView.byId("idRightUpperCornerText").setText(this.mParam.aCornerTexts.sRightUpper);this.oView.byId("idLeftLowerCornerText").setText(this.mParam.aCornerTexts.sLeftLower);this.oView.byId("idRightLowerCornerText").setText(this.mParam.aCornerTexts.sRightLower);},_addStyleClasses:function(){this.oView.byId("idChartHolder").addStyleClass("supressDialogPadding");this.oView.byId("idMainChart").addStyleClass("previewMainChartHolder");this.oView.byId("idThumbnail").addStyleClass("previewThumbnailHolder");this.oView.byId("idThumbnailLayout").addStyleClass("previewThumbnailLayout");this.oView.byId("idThumbnailChartLayout").addStyleClass("previewThumbnailChartLayout");this.oView.byId("idTopLayout").addStyleClass("previewThumbnailTopLayout");this.oView.byId("idBottomLayout").addStyleClass("previewThumbnailBottomLayout");this.oView.byId("idLeftUpperCornerText").addStyleClass("previewThumbnailText");this.oView.byId("idRightUpperCornerText").addStyleClass("previewThumbnailText");this.oView.byId("idLeftLowerCornerText").addStyleClass("previewThumbnailText");this.oView.byId("idRightLowerCornerText").addStyleClass("previewThumbnailText");},_generateSampleData:function(){var s=[];var n=3;var i=0;var d=this.mParam.aDimensions;var m=this.mParam.aMeasures;var p=this.mParam.aProperties;var S=this.mParam.oChartParameter.dimensions;var a=this.mParam.oChartParameter.measures;var b=this.mParam.oChartParameter.properties;var c=this.mParam.sChartType;var I=function(e,f,v,r){var C=e.filter(function(o){return o.fieldName===f;});C.forEach(function(o){if(!o.fieldDesc||!o.fieldDesc.length){o.fieldDesc=o.fieldName;}r[o.fieldDesc]=v;});};var l=c!==sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION?Math.pow(n,this.mParam.aDimensions.length):Math.pow(n,this.mParam.aProperties.length);for(i=0;i<l;i++){var r={};d.forEach(function(D,e){var f=D+" - "+(Math.floor(i/Math.pow(n,e))%n+1);r[D]=f;I(S,D,f,r);});m.forEach(function(M){var e=Math.round(Math.random()*500);r[M]=e;I(a,M,e,r);});p.forEach(function(P){var e=Math.round(Math.random()*500);r[P]=e;I(b,P,e,r);});s.push(r);}if(this.mParam.aSort&&this.mParam.aSort.length){s=this._sortData(s,this.mParam.aSort);}return s;},_sortData:function(d,p){return d.sort(function(r,R){var n,i;for(i=0;i<p.length;i++){n=0;if(r[p[i].sSortField]<R[p[i].sSortField]){n=-1;}else if(r[p[i].sSortField]>R[p[i].sSortField]){n=1;}n=n*[1,-1][+!!p[i].bDescending];if(n!==0){return n;}}});},_getRepresentationConstructor:function(c){var r=sap.apf.core.representationTypes();var R=r.filter(function(R){return R.id===c;})[0];var C=R.constructor;return C;},_prepareRepresentationInstance:function(){var r=this._getRepresentationConstructor(this.mParam.sChartType);jQuery.sap.require(r);var F=sap.apf.utils.extractFunctionFromModulePathString(r);var e=function(){};var a={getTextNotHtmlEncoded:function(t){return t;},getTextHtmlEncoded:function(t){return t;},getEventCallback:e,createFilter:function(){return{getOperators:function(){return{EQ:true};},getTopAnd:function(){return{addOr:e};},getInternalFilter:function(){return{getProperties:function(){return[];}};}};},createMessageObject:e,putMessage:e,updatePath:e,selectionChanged:e,getActiveStep:function(){return{getSelectedRepresentation:function(){return{bIsAlternateView:true};}};}};this.oRepresentationInstance=new F(a,this.mParam.oChartParameter);var m={getPropertyMetadata:function(){return{label:undefined};}};var s=this._generateSampleData();this.oRepresentationInstance.setData(s,m);}});};if(!jQuery.sap.isDeclared('sap.apf.modeler.ui.controller.representation.controller')){jQuery.sap.declare('sap.apf.modeler.ui.controller.representation.controller');sap.ui.controller("sap.apf.modeler.ui.controller.representation",{onInit:function(){this.getView().addStyleClass("sapUiSizeCompact");this.oViewData=this.getView().getViewData();this.oConfigurationHandler=this.oViewData.oConfigurationHandler;this.oConfigurationEditor=this.oViewData.oConfigurationEditor;this.oTextPool=this.oConfigurationHandler.getTextPool();this.getText=this.oViewData.getText;this.getEntityTypeMetadata=this.oViewData.getEntityTypeMetadata;this.getRepresentationTypes=this.oViewData.getRepresentationTypes;this.mParam=this.oViewData.oParams;var s=this;if(!this.oConfigurationEditor){this.oConfigurationHandler.loadConfiguration(this.mParam.arguments.configId,function(c){s.oConfigurationEditor=c;});}this._setDisplayText();this.setDetailData();this._oPreviewButton=new sap.m.Button({text:this.getText("preview"),press:s._handlePreviewButtonPress.bind(this)});this._insertPreviewButtonInFooter();},onAfterRendering:function(){this._enableDisableItemsInDisplayOptionOrDisplayOptionBox();},_setDisplayText:function(){this.byId("idVisualization").setTitle(this.getText("visualization"));this.byId("idChartTypeLabel").setText(this.getText("chartType"));this.byId("idChartTypeLabel").setTooltip(this.getText("chartType"));this.byId("idBasicData").setTitle(this.getText("basicData"));this.byId("idSorting").setTitle(this.getText("sorting"));this.byId("idThumbnailTexts").setTitle(this.getText("cornerTextLabel"));this.byId("idLeftUpper").setPlaceholder(this.getText("leftTop"));this.byId("idRightUpper").setPlaceholder(this.getText("rightTop"));this.byId("idLeftLower").setPlaceholder(this.getText("leftBottom"));this.byId("idRightLower").setPlaceholder(this.getText("rightBottom"));},handleChangeForChartType:function(e){var n=e.getParameter("selectedItem").getKey();var p=this.sCurrentChartType;this.sCurrentChartType=n;this._updateAndSetDatasetsByChartType(n);var r=sap.apf.ui.utils.CONSTANTS.representationTypes;var b=r.BAR_CHART;var c=[r.COLUMN_CHART,r.STACKED_COLUMN_CHART,r.PERCENTAGE_STACKED_COLUMN_CHART,r.LINE_CHART];var i=(b===n);this.bIsBarClassType=i;var I=c.indexOf(n)!==-1;var a=(c.indexOf(n)!==-1&&c.indexOf(p)!==-1);if(i||(I&&!a)){this._switchLabelForCharts();}this.oRepresentation.setRepresentationType(n);var A;if(n!==sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION){A=sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION;}var s=this._getChartPictureDataset().sSelectedChartPicture;this.oRepresentation.setAlternateRepresentationType(A);var R=this.getText(this.oRepresentation.getRepresentationType());var S=this.oConfigurationEditor.getCategoriesForStep(this.oParentStep.getId());if(S.length===1){this.oViewData.updateSelectedNode({name:R,icon:s});}else{this.oViewData.updateTree();}var t=this.getText("representation")+": "+R;this.oViewData.updateTitleAndBreadCrumb(t);this.oConfigurationEditor.setIsUnsaved();},_switchLabelForCharts:function(){var s=this;var b=this.byId("idBasicDataLayout").getItems();var a,k;b.forEach(function(d){a=d.getContent()[0].getBindingContext().getProperty("sAggregationRole");k=d.getContent()[0].getBindingContext().getProperty("sKind");if(a&&k){var t=s._createDimMeasForCharts(a,k);if(a==="dimension"){t=s.getText("display",[t]);}d.getContent()[0].setText(t);}});},_createDimMeasForCharts:function(a,k){var h=sap.apf.core.constants.representationMetadata.kind.XAXIS;var v=sap.apf.core.constants.representationMetadata.kind.YAXIS;if(a==="dimension"&&k===h){k=h;if(this.bIsBarClassType){k=v;}}else if(a==="measure"&&k===v){k=v;if(this.bIsBarClassType){k=h;}}var u=this.getText(a);var U=this.getText(k);var t=this.getText("dim-measure-label",[u,U]);if(this.bIsDualLineChart&&k===v&&a==="measure"){var s=this.getText("leftVerticalAxis");t=this.getText("dim-measure-label",[u,s]);}return t;},handleChangeForCornerText:function(e){var c=e.getSource();var C=c.getValue();var t=sap.apf.modeler.ui.utils.TranslationFormatMap.REPRESENTATION_CORNER_TEXT;var s=this.oTextPool.setText(C,t);var a=c.getBindingPath('value').replace("/","");var S=["set",a,"CornerTextKey"].join("");this.oRepresentation[S](s);this.oConfigurationEditor.setIsUnsaved();this.mDataset.oCornerTextsDataset[a]=this._getCornerTextsDataset()[a];this.mModel.oCornerTextsModel.updateBindings();},_addAutoCompleteFeatureOnInputs:function(){var s=this;var t=new sap.apf.modeler.ui.utils.TextPoolHelper(this.oTextPool);var d={oTranslationFormat:sap.apf.modeler.ui.utils.TranslationFormatMap.REPRESENTATION_CORNER_TEXT,type:"text"};var c=["idLeftUpper","idRightUpper","idLeftLower","idRightLower"];c.forEach(function(i){var I=s.getView().byId(i);t.setAutoCompleteOn(I,d);});},_bindBasicRepresentationData:function(){var s=this;var n,p,c,l;var b=this.byId("idBasicDataLayout");var P=new sap.ui.layout.Grid({width:"100%"});var a=new sap.m.Label({width:"100%",textAlign:"End",layoutData:new sap.ui.layout.GridData({span:"L2 M2 S2"}),text:{path:"/",formatter:function(){var d=this,e,f;var g=this.getBindingContext().getProperty("sAggregationRole");var k=this.getBindingContext().getProperty("sKind");var C=s.sCurrentChartType;var R=sap.apf.ui.utils.CONSTANTS.representationTypes;var B=[R.BAR_CHART,R.STACKED_BAR_CHART,R.PERCENTAGE_STACKED_BAR_CHART];s.bIsBarClassType=(B.indexOf(C)!==-1);s.bIsDualLineChart=(R.LINE_CHART_WITH_TWO_VERTICAL_AXES.indexOf(C)!==-1);if(g&&k){if(s.bIsBarClassType||s.bIsDualLineChart){e=s._createDimMeasForCharts(g,k);}else{f=s.getText(g);k=s.getText(k);e=s.getText("dim-measure-label",[f,k]);}if(g==="dimension"){e=s.getText("display",[e]);}d.setTooltip(e);return e;}}}});P.addContent(a);var o=new sap.m.Select({width:"100%",layoutData:new sap.ui.layout.GridData(),items:{path:"aAllProperties",template:new sap.ui.core.ListItem({key:"{sName}",text:"{sName}"}),templateShareable:true},selectedKey:"{sSelectedProperty}",change:s._handleChangeForBasicDataSelectProperty.bind(this)});P.addContent(o);var L=new sap.m.Label({textAlign:"End",width:"100%",layoutData:new sap.ui.layout.GridData({span:"L2 M2 S2"}),text:{path:"/",formatter:function(){var t;var d,S;var e=this.getBindingContext().getProperty("sLabel");var f=this;if(this.getParent().getContent()[1].getSelectedItem()){S=this.getParent().getContent()[1].getSelectedItem().getText();}else{S=this.getBindingContext().getProperty("sSelectedProperty");}t=s.getText("label");if(S&&S!==s.getText("none")){var g=s.oEntityMetadata.getPropertyMetadata(S);d=g.label?g.label:g.name;if(!e||(e&&d&&(e===d))){t=s.getText("label")+"("+s.getText("default")+")";}}f.setTooltip(t);return t;}}}).addStyleClass("repFormRightLabel");P.addContent(L);var i=new sap.m.Input({width:"100%",layoutData:new sap.ui.layout.GridData({span:"L3 M2 S2"}),value:{path:"sLabel",formatter:function(){var d,S;if(!this.mEventRegistry.suggest&&this.getShowSuggestion()===false){var t=new sap.apf.modeler.ui.utils.TextPoolHelper(s.oTextPool);var D={oTranslationFormat:sap.apf.modeler.ui.utils.TranslationFormatMap.REPRESENTATION_LABEL,type:"text"};t.setAutoCompleteOn(this,D);}if(this.getParent().getContent()[1].getSelectedItem()){S=this.getParent().getContent()[1].getSelectedItem().getText();}else{S=this.getBindingContext().getProperty("sSelectedProperty");}if(S&&S!==s.getText("none")){var e=s.oEntityMetadata.getPropertyMetadata(S);d=e.label?e.label:e.name;}var f=this.getBindingContext().getProperty("sLabel");if((S&&S!==s.getText("none")&&!f)||(f&&d&&(f===d))){return d;}return f;}},change:s._handleChangeForBasicDataPropertyRowLabelInput.bind(this)});P.addContent(i);var A=new sap.ui.core.Icon({width:"100%",src:"sap-icon://add",tooltip:s.getText("addButton"),visible:{path:"nMax",formatter:function(d){return(d==="*");}},press:s._handlerForBasicDataAddPropertyRow.bind(this)}).addStyleClass("addIconRepresentation");var r=new sap.ui.core.Icon({width:"100%",src:"sap-icon://less",tooltip:s.getText("deleteButton"),visible:{path:"/",formatter:function(){var d=true;var B=this.getBindingContext();var e=parseInt(B.getPath().split("/").pop(),10);if(e){var f=s.mDataset.oPropertyDataset.aPropertyRows;var C=f[e].sKind;var g=f[e].sAggregationRole;var h=e-1;var j=f[h].sKind;var k=f[h].sAggregationRole;d=!(C===j&&g===k);}return!d;}},press:s._handlerForBasicDataDeletePropertyRow.bind(this)}).addStyleClass("lessIconRepresentation");var I=new sap.m.HBox({layoutData:new sap.ui.layout.GridData({span:"L1 M2 S2"}),items:[A,r]});P.addContent(I);b.bindAggregation("items","/aPropertyRows",function(d,m){c=jQuery.extend(true,{},P);p=m.sPath.split("/");n=p[p.indexOf("aPropertyRows")+1];c.getContent()[1].getLayoutData().setSpan("L4 M4 S4");if(s.mModel.oPropertyModel.getData().aPropertyRows[n].sAggregationRole==="dimension"){l=new sap.m.Select({width:"100%",layoutData:new sap.ui.layout.GridData({span:"L2 M2 S2"}),items:{path:"aLabelDisplayOptionTypes",template:new sap.ui.core.ListItem({key:"{key}",text:"{value}"}),templateShareable:true},selectedKey:"{sLabelDisplayOptionProperty}",change:s._handleChangeForLabelDisplayOption.bind(s)});c.insertContent(l,2);c.getContent()[1].getLayoutData().setSpan("L2 M2 S2");}return c.clone(d);});},_handleChangeForBasicDataSelectProperty:function(s){var l;var S=s.getSource().getSelectedKey();var p=s.getSource().getParent().getContent();var L=s.getSource().getBindingContext().getProperty("sAggregationRole")==="dimension"?p[3]:p[2];var o=s.getSource().getBindingContext().getProperty("sAggregationRole")==="dimension"?p[4]:p[3];if(S&&(S!==this.getText("none"))){this._setDefaultLabelForSelectedProperty(S,L);}else{L.setText(this.getText("label"));o.setValue("");}this._setPropertiesFromCurrentDataset();if(s.getSource().getBindingContext().getProperty("sAggregationRole")==="dimension"){this._setDefaultLabelDisplayOption(S);l=s.getSource().getParent().getContent()[2];l.setSelectedKey(this.oRepresentation.getLabelDisplayOption(S));this._enableDisableItemsInDisplayOptionOrDisplayOptionBox();}this.oConfigurationEditor.setIsUnsaved();},_handleChangeForBasicDataPropertyRowLabelInput:function(i){var p=i.getSource().getBindingContext().getProperty("sSelectedProperty");var P=i.getSource().getParent().getContent();var l=i.getSource().getBindingContext().getProperty("sAggregationRole")==="dimension"?P[3]:P[2];if(p&&p!==this.getText("none")){this._updatLabelInPropertyRow(p,i.getSource().getValue(),l);}this._setPropertiesFromCurrentDataset();this.oConfigurationEditor.setIsUnsaved();},_handleChangeForLabelDisplayOption:function(e){var s=e.getSource().getSelectedKey();var p=e.getSource().getBindingContext().getProperty("sSelectedProperty");this.oRepresentation.setLabelDisplayOption(p,s);this.oConfigurationEditor.setIsUnsaved();},_handlerForBasicDataAddPropertyRow:function(a){var b=a.getSource().getBindingContext();var c=jQuery.extend(true,{},b.getObject());delete c.sSelectedProperty;delete c.sLabel;delete c.sLabelDisplayOptionProperty;var n=parseInt(b.getPath().split("/").pop(),10);var p=this.mDataset.oPropertyDataset.aPropertyRows;p.splice(n+1,0,c);this._setPropertiesFromCurrentDataset();this.mModel.oPropertyModel.updateBindings();this._enableDisableItemsInDisplayOptionOrDisplayOptionBox();this.oConfigurationEditor.setIsUnsaved();},_handlerForBasicDataDeletePropertyRow:function(d){var b=d.getSource().getBindingContext();var n=parseInt(b.getPath().split("/").pop(),10);var p=this.mDataset.oPropertyDataset.aPropertyRows;p.splice(n,1);this.mModel.oPropertyModel.updateBindings();this._setPropertiesFromCurrentDataset();this.oConfigurationEditor.setIsUnsaved();},_updatLabelInPropertyRow:function(s,l,L){var p=this.oEntityMetadata.getPropertyMetadata(s);var d=p.label?p.label:p.name;var a,b;if(d!==l&&l.length!==0){a=this.getText("label");b=l;}else{a=this.getText("label")+"("+this.getText("default")+")";b=d;}this.mDataset.oPropertyDataset.aPropertyRows.forEach(function(P){if(P.sSelectedProperty===s){P.sLabel=b;}});this.mModel.oPropertyModel.updateBindings();L.setText(a);},_setDefaultLabelForSelectedProperty:function(s,l){var p=this.oEntityMetadata.getPropertyMetadata(s);var d=p.label?p.label:p.name;var L=this.getText("label")+"("+this.getText("default")+")";this.mDataset.oPropertyDataset.aPropertyRows.forEach(function(P){if(P.sSelectedProperty===s){P.sLabel=d;}});this.mModel.oPropertyModel.updateBindings();l.setText(L);},_bindSortLayoutData:function(){var s=this;var S=this.byId("idSortLayout");var o=new sap.ui.layout.Grid({width:"100%"});var a=new sap.m.Label({width:"100%",textAlign:"End",layoutData:new sap.ui.layout.GridData({span:"L2 M2 S2"}),text:this.getText("sortingField"),tooltip:this.getText("sortingField")});o.addContent(a);var b=new sap.m.Select({width:"100%",layoutData:new sap.ui.layout.GridData({span:"L4 M4 S4"}),items:{path:"aAllProperties",template:new sap.ui.core.ListItem({key:"{sName}",text:"{sName}"}),templateShareable:true},selectedKey:"{sSortProperty}",change:s._handleChangeForSortDataProperty.bind(this)});o.addContent(b);var d=new sap.m.Label({layoutData:new sap.ui.layout.GridData({span:"L2 M2 S2"}),width:"100%",textAlign:"End",text:this.getText("direction"),tooltip:this.getText("direction")});o.addContent(d);var D=new sap.m.Select({width:"100%",layoutData:new sap.ui.layout.GridData({span:"L3 M2 S2"}),items:[{key:this.getText("ascending"),text:this.getText("ascending")},{key:this.getText("descending"),text:this.getText("descending")}],selectedKey:"{sDirection}",change:s._handleChangeForSortDirection.bind(this)});o.addContent(D);var A=new sap.ui.core.Icon({width:"100%",src:"sap-icon://add",tooltip:this.getText("addButton"),visible:true,press:s._handleChangeForAddSortRow.bind(this)}).addStyleClass("addIconRepresentation");var r=new sap.ui.core.Icon({width:"100%",src:"sap-icon://less",tooltip:this.getText("deleteButton"),visible:{path:"/",formatter:function(){var B=this.getBindingContext();var n=parseInt(B.getPath().split("/").pop(),10);return!!n;}},press:s._handleChangeForDeleteSortRow.bind(this)}).addStyleClass("lessIconRepresentation");var i=new sap.m.HBox({layoutData:new sap.ui.layout.GridData({span:"L1 M2 S2"}),items:[A,r]});o.addContent(i);S.bindAggregation("items","/aSortRows",o);},_handleChangeForSortDataProperty:function(){this._setSortFieldsFromCurrentDataset();this.oConfigurationEditor.setIsUnsaved();},_handleChangeForSortDirection:function(s){var S=s.getSource().getBindingContext().getProperty("sSortProperty");if(S!==this.getText("none")){this._setSortFieldsFromCurrentDataset();this.oConfigurationEditor.setIsUnsaved();}},_handleChangeForAddSortRow:function(a){var b=a.getSource().getBindingContext();var c=jQuery.extend(true,{},b.getObject());delete c.sSortProperty;delete c.sDirection;var n=parseInt(b.getPath().split("/").pop(),10);var s=this.mDataset.oSortDataset.aSortRows;s.splice(n+1,0,c);this.mModel.oSortModel.updateBindings();this._setSortFieldsFromCurrentDataset();this.oConfigurationEditor.setIsUnsaved();},_handleChangeForDeleteSortRow:function(d){var b=d.getSource().getBindingContext();var n=parseInt(b.getPath().split("/").pop(),10);var s=this.mDataset.oSortDataset.aSortRows;s.splice(n,1);this.mModel.oSortModel.updateBindings();this._setSortFieldsFromCurrentDataset();this.oConfigurationEditor.setIsUnsaved();},_setPropertiesForTable:function(){var s=this;var d=this.oRepresentation.getDimensions();var m=this.oRepresentation.getMeasures();d.forEach(function(p){s.oRepresentation.addProperty(p);s.oRepresentation.setPropertyTextLabelKey(p,s.oRepresentation.getDimensionTextLabelKey(p));s.oRepresentation.setPropertyKind(p,sap.apf.core.constants.representationMetadata.kind.COLUMN);});m.forEach(function(p){s.oRepresentation.addProperty(p);s.oRepresentation.setPropertyTextLabelKey(p,s.oRepresentation.getMeasureTextLabelKey(p));s.oRepresentation.setPropertyKind(p,sap.apf.core.constants.representationMetadata.kind.COLUMN);});d.forEach(function(D){s.oRepresentation.removeDimension(D);});m.forEach(function(M){s.oRepresentation.removeMeasure(M);});},_validateRepresentationData:function(){var s=this;var d=this.oRepresentation.getDimensions().map(function(a){return{sType:"Dimension",sName:a};});var m=this.oRepresentation.getMeasures().map(function(a){return{sType:"Measure",sName:a};});var p=this.oRepresentation.getProperties().map(function(a){return{sType:"Property",sName:a};});var r=d.concat(m).length?d.concat(m):p;r.forEach(function(a){var P=false;s.aSelectProperties.forEach(function(b){if(a.sName===b.sName){P=true;}});if(P===false){var R=["remove",a.sType].join("");s.oRepresentation[R](a.sName);s.oConfigurationEditor.setIsUnsaved();}});},_enableDisableItemsInDisplayOptionOrDisplayOptionBox:function(){var i,a,d,I,p;if(this.byId('idBasicDataLayout').getModel()){p=this.byId("idBasicDataLayout").getModel().getData().aPropertyRows;var b=this.byId("idBasicDataLayout");for(i=0;i<p.length;i++){if(p[i].sAggregationRole==="dimension"){d=b.getItems()[i].getContent()[2];if(p[i].sSelectedProperty===this.getText("none")){b.getItems()[i].getContent()[2].setEnabled(false);continue;}else{b.getItems()[i].getContent()[2].setEnabled(true);}I=this._checkIfTextPropertyOfDimensionIsPresent(p[i].sSelectedProperty);for(a=0;a<d.getItems().length;a++){if(a>0){d.getItems()[a].setEnabled(I);}}}}}},_checkIfTextPropertyOfDimensionIsPresent:function(d){var i=false;var D=this.oEntityMetadata.getPropertyMetadata(d);if(D.text){var s=this.oParentStep.getSelectProperties();i=s.indexOf(D.text)===-1?false:true;}return i;},_setDefaultLabelDisplayOption:function(d){var i=this._checkIfTextPropertyOfDimensionIsPresent(d);if(i){this.oRepresentation.setLabelDisplayOption(d,sap.apf.core.constants.representationMetadata.labelDisplayOptions.KEY_AND_TEXT);}else{this.oRepresentation.setLabelDisplayOption(d,sap.apf.core.constants.representationMetadata.labelDisplayOptions.KEY);}this.oConfigurationEditor.setIsUnsaved();},_setDefaultLabelDisplayOptionToDimensions:function(){var s=this;this.oRepresentation.getDimensions().forEach(function(d){if(s.oRepresentation.getLabelDisplayOption(d)===undefined){s._setDefaultLabelDisplayOption(d);}});},setDetailData:function(){var c=this.mParam.arguments;this.oParentStep=this.oConfigurationEditor.getStep(c.stepId);this.oEntityMetadata=this.getEntityTypeMetadata(this.oParentStep.getService(),this.oParentStep.getEntitySet());this.aSelectProperties=this._getSelectPropertiesFromParentStep();this.oRepresentation=this.oParentStep.getRepresentation(c.representationId);if(!this.oRepresentation){this.oRepresentation=this.oParentStep.createRepresentation();this._setDefaultRepresentationType();this._setDefaultProperties();this.oConfigurationEditor.setIsUnsaved();}if(this.oRepresentation.getRepresentationType()===sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION){this._setPropertiesForTable();}this._validateRepresentationData();this._setDefaultLabelDisplayOptionToDimensions();var C=this._getChartTypeDataset();var p=this._getPropertyDataset();var s=this._getSortDataset();var o=this._getCornerTextsDataset();var a=this._getChartPictureDataset();this.mDataset={oChartTypeDataset:C,oPropertyDataset:p,oSortDataset:s,oCornerTextsDataset:o,oChartPictureDataset:a};var b=new sap.ui.model.json.JSONModel(this.mDataset.oChartTypeDataset);var P=new sap.ui.model.json.JSONModel(this.mDataset.oPropertyDataset);var S=new sap.ui.model.json.JSONModel(this.mDataset.oSortDataset);var d=new sap.ui.model.json.JSONModel(this.mDataset.oCornerTextsDataset);var e=new sap.ui.model.json.JSONModel(this.mDataset.oChartPictureDataset);this.mModel={oChartTypeModel:b,oPropertyModel:P,oSortModel:S,oCornerTextsModel:d,oChartPictureModel:e};this.byId("idChartType").setModel(this.mModel.oChartTypeModel);var f=this.sCurrentChartType;this._updateAndSetDatasetsByChartType(f);this.byId("idBasicDataLayout").setModel(this.mModel.oPropertyModel);this._bindBasicRepresentationData();this.byId("idSortLayout").setModel(this.mModel.oSortModel);this._bindSortLayoutData();this.byId("idLeftLower").setModel(this.mModel.oCornerTextsModel);this.byId("idRightLower").setModel(this.mModel.oCornerTextsModel);this.byId("idLeftUpper").setModel(this.mModel.oCornerTextsModel);this.byId("idRightUpper").setModel(this.mModel.oCornerTextsModel);this.byId("idChartIcon").setModel(this.mModel.oChartPictureModel);this._addAutoCompleteFeatureOnInputs();var i;if(this.oParentStep.getTopN()){i=false;}else{i=true;}this._changeEditableOfSortProperty(i);},_changeEditableOfSortProperty:function(i){var s=this.byId("idSortLayout").getItems();s.forEach(function(S,n){S.getContent().forEach(function(c){if(c instanceof sap.m.Select){c.setEnabled(i);}if(c instanceof sap.m.HBox){c.getItems().forEach(function(a,b){if(a instanceof sap.ui.core.Icon){a.setVisible(i);if(n===0&&b===1){a.setVisible(false);}}});}});});},_insertPreviewButtonInFooter:function(){var f=this.oViewData.oFooter;f.addContentRight(this._oPreviewButton);},_removePreviewButtonFromFooter:function(){var f=this.oViewData.oFooter;f.removeContentRight(this._oPreviewButton);},_handlePreviewButtonPress:function(){var p=this._getPreviewDetails();var P=new sap.ui.view({type:sap.ui.core.mvc.ViewType.XML,viewName:"sap.apf.modeler.ui.view.previewContent",viewData:p});var o=new sap.m.Dialog({title:this.getText("preview"),content:P,endButton:new sap.m.Button({text:this.getText("close"),press:function(){o.close();}})});o.open();},onExit:function(){this._removePreviewButtonFromFooter();},_getPreviewDetails:function(){var s=this;var c=this.mDataset.oChartTypeDataset.sSelectedChartType;var S=this._getParentStepTitle();var a=this._getParentStepLongTitle()||S;var d=[],m=[],p=[];this.aSelectProperties.forEach(function(o){if(c===sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION){p.push(o.sName);}else{if(o.sAggregationRole==="dimension"){d.push(o.sName);}else if(o.sAggregationRole==="measure"){m.push(o.sName);}}});var C={dimensions:[],measures:[],properties:[],requiredFilters:[]};this.mDataset.oPropertyDataset.aPropertyRows.forEach(function(P){if(P.sSelectedProperty!==s.getText("none")){var A=(P.sAggregationRole!=="property")?P.sAggregationRole+"s":[P.sAggregationRole.slice(0,-1),"ies"].join("");C[A].push({fieldDesc:P.sLabel,fieldName:P.sSelectedProperty,kind:P.sKind});}});var b=[];this.mDataset.oSortDataset.aSortRows.forEach(function(o){var f=o.sSortProperty||(o.aAllProperties.length&&o.aAllProperties[0].sName);if(f&&f!==s.getText("none")){var A=!o.sDirection||(o.sDirection===s.getText("ascending"));b.push({sSortField:f,bDescending:!A});}});var e={sLeftUpper:this.mDataset.oCornerTextsDataset.LeftUpper,sRightUpper:this.mDataset.oCornerTextsDataset.RightUpper,sLeftLower:this.mDataset.oCornerTextsDataset.LeftLower,sRightLower:this.mDataset.oCornerTextsDataset.RightLower};return{sChartType:c,sStepTitle:S,sStepLongTitle:a,aDimensions:d,aMeasures:m,aProperties:p,oChartParameter:C,aSort:b,aCornerTexts:e};},_getParentStepLongTitle:function(){var s=this.oParentStep.getLongTitleId();s=!this.oTextPool.isInitialTextKey(s)?s:undefined;var S=s&&this.oTextPool.get(s);var a=S&&S.TextElementDescription;return a;},_getParentStepTitle:function(){var s=this.oParentStep.getTitleId();var S=s&&this.oTextPool.get(s);var a=S&&S.TextElementDescription;return a;},_getSelectPropertiesFromParentStep:function(){var a=this.oParentStep.getService();var e=this.oParentStep.getEntitySet();var E=this.getEntityTypeMetadata(a,e);var s=this.oParentStep.getSelectProperties();var r=s.map(function(p){var m=E.getPropertyMetadata(p);return{sName:p,sAggregationRole:m["aggregation-role"],sLabel:m["label"]};});return r;},_getCornerTextsFromConfigObject:function(c){var s=this;var C=["LeftUpper","RightUpper","LeftLower","RightLower"];var d={};C.forEach(function(a){var m=["get",a,"CornerTextKey"].join("");var b=c[m]();var o=b&&s.oTextPool.get(b);var e=o&&o.TextElementDescription;d[a]=e;});return d;},_getChartTypeDataset:function(){var s=this;var k=Object.keys(this._getRepresentationMetadata());var c=k.map(function(K){return{sId:K,sText:s.getText(K)};});var d={aChartTypes:c,sSelectedChartType:this.oRepresentation.getRepresentationType()};this.sCurrentChartType=d.sSelectedChartType;return d;},_getChartPictureDataset:function(){var r=this.getRepresentationTypes();var d={};r.forEach(function(o){var i=o.id;d[i]=o.picture;});d.sSelectedChartPicture=d[this.oRepresentation.getRepresentationType()];return d;},_updatePictureDataset:function(c){var d=this.mModel.oChartPictureModel.getData();d.sSelectedChartPicture=d[c];},_getPropertyDataset:function(){var s=this;var p=[];var a=function(t){var c=s.oRepresentation.getRepresentationType();var g=t!=="Property"?["get",t,"s"].join(""):["get",t.slice(0,-1),"ies"].join("");var P=s.oRepresentation[g]();P.forEach(function(b){var l=["get",t,"TextLabelKey"].join("");var L=s.oRepresentation[l](b);var o=L&&s.oTextPool.get(L);var d=o&&o.TextElementDescription;if(d===undefined||d.length===0){d=s.oEntityMetadata.getPropertyMetadata(b).label||s.oEntityMetadata.getPropertyMetadata(b).name;}var k=["get",t,"Kind"].join("");var K=s.oRepresentation[k](b);var r=s._getRepresentationMetadata()[c];var S=(c===sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION)?r[t.slice(0,-1).toLowerCase()+"ies"].supportedKinds:r[t.toLowerCase()+"s"].supportedKinds;var n,e;S.forEach(function(f){if(f.kind===K){n=f.min;e=f.max;}});p.push({sSelectedProperty:b,sAggregationRole:t.toLowerCase(),sLabel:d,sKind:K,nMin:n,nMax:e,sLabelDisplayOptionProperty:t.toLowerCase()==="dimension"?s.oRepresentation.getLabelDisplayOption(b):undefined});});};a("Dimension");a("Measure");a("Property");return{aPropertyRows:p};},_getSortDataset:function(){var s=this;var o=this.oRepresentation.getOrderbySpecifications();var a=this.aSelectProperties.slice();a.unshift({sName:this.getText("none")});if(!o.length){o.push({});}var S=o.map(function(O){var b=O.property;var c=O.ascending!==undefined&&!O.ascending?s.getText("descending"):s.getText("ascending");return{sSortProperty:b,sDirection:c,aAllProperties:a};});return{aSortRows:S};},_getCornerTextsDataset:function(){var r=this._getCornerTextsFromConfigObject(this.oRepresentation);var p=this._getCornerTextsFromConfigObject(this.oParentStep);var d=jQuery.extend({},p,r);return d;},_setDefaultRepresentationType:function(){var d;if(this.getRepresentationTypes()[0].metadata){d=this.getRepresentationTypes()[0].id;}this.oRepresentation.setRepresentationType(d);this.oRepresentation.setAlternateRepresentationType(sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION);var s=this._getChartPictureDataset().sSelectedChartPicture;var S=this.oConfigurationEditor.getCategoriesForStep(this.oParentStep.getId());if(S.length===1){this.oViewData.updateSelectedNode({id:this.oRepresentation.getId(),icon:s});}else{this.oViewData.updateTree();}},_setDefaultProperties:function(){var f,F;this.aSelectProperties.forEach(function(s){if(!f){if(s.sAggregationRole==="dimension"){f=s.sName;}}if(!F){if(s.sAggregationRole==="measure"){F=s.sName;}}});if(f){this.oRepresentation.addDimension(f);this.oRepresentation.setDimensionKind(f,sap.apf.core.constants.representationMetadata.kind.XAXIS);}if(F){this.oRepresentation.addMeasure(F);this.oRepresentation.setMeasureKind(F,sap.apf.core.constants.representationMetadata.kind.YAXIS);}},_updateAndSetDatasetsByChartType:function(c){this._updatePropertyDatasetByChartType(c);this.mModel.oPropertyModel.updateBindings();this._setPropertiesFromCurrentDataset();this._enableDisableItemsInDisplayOptionOrDisplayOptionBox();this._updateSortDatasetByChartType(c);this.mModel.oSortModel.updateBindings();this._setSortFieldsFromCurrentDataset();this._updatePictureDataset(c);this.mModel.oChartPictureModel.updateBindings();},_updatePropertyDatasetByChartType:function(c){var s=this;var d={aPropertyRows:[]};var r=this._getRepresentationMetadata()[c];var a=["dimensions","measures","properties"];a.forEach(function(A){if(r.hasOwnProperty(A)){var S=r[A].supportedKinds;var b;S.forEach(function(o){var e=(A!=="properties")?A.slice(0,-1):[A.slice(0,-3),"y"].join("");var f=(A!=="properties")?s.aSelectProperties.filter(function(P){return(P.sAggregationRole===e);}):s.aSelectProperties;var p={sAggregationRole:e,sKind:o.kind,nMin:o.min,nMax:o.max,aAllProperties:f};if(p.sAggregationRole==="dimension"){p.aLabelDisplayOptionTypes=[{key:"key",value:s.getText("key")},{key:"text",value:s.getText("text")},{key:"keyAndText",value:s.getText("keyAndText")}];}if(!parseInt(o.min,10)){p.aAllProperties.unshift({sName:s.getText("none"),sAggregationRole:e});}p.aAllProperties.forEach(function(g){b=g.sName;if(b){var t=e;var h=[t.charAt(0).toUpperCase(),t.substring(1)].join("");var l=["get",h,"TextLabelKey"].join("");var L=s.oRepresentation[l](b);var i=L&&s.oTextPool.get(L);var j=i&&i.TextElementDescription;if(j){g.sLabel=j;}else{if(b!==s.getText("none")){var P=s.oEntityMetadata.getPropertyMetadata(b);var D=P.label?P.label:P.name;if(D){g.sLabel=D;}}}}});d.aPropertyRows.push(p);});}});var R={aPropertyRows:[]};d.aPropertyRows.forEach(function(D){var e=false;s.mDataset.oPropertyDataset.aPropertyRows.forEach(function(E){var h=E.sAggregationRole===D.sAggregationRole;var H=E.sKind===D.sKind;var b=E.nMin===D.nMin;var f=E.nMax===D.nMax;if(h&&H&&b&&f){e=true;var C=jQuery.extend(E,D);R.aPropertyRows.push(C);}});if(!e){R.aPropertyRows.push(D);}});this.mDataset.oPropertyDataset.aPropertyRows=R.aPropertyRows;},_updateSortDatasetByChartType:function(c){var r=this._getRepresentationMetadata()[c];if(r.sortable!==undefined&&!r.sortable){var a=this.aSelectProperties.slice();a.unshift({sName:this.getText("none")});this.mDataset.oSortDataset.aSortRows=[{aAllProperties:a,sDirection:this.getText("ascending")}];this.byId("idSortLayout").setVisible(false);this.byId("idSorting").setVisible(false);}else{this.byId("idSortLayout").setVisible(true);this.byId("idSorting").setVisible(true);this.mModel.oSortModel.updateBindings();var s=this.byId("idSortLayout");jQuery.sap.delayedCall(10,s,s.rerender);}},_setPropertiesFromCurrentDataset:function(){var s=this;var d=this.oRepresentation.getDimensions();d.forEach(function(D){s.oRepresentation.removeDimension(D);});var m=this.oRepresentation.getMeasures();m.forEach(function(M){s.oRepresentation.removeMeasure(M);});var p=this.oRepresentation.getProperties();p.forEach(function(P){s.oRepresentation.removeProperty(P);});this.mDataset.oPropertyDataset.aPropertyRows.forEach(function(P){var S=P.sSelectedProperty||(P.aAllProperties.length&&P.aAllProperties[0].sName);if(S&&S!==s.getText("none")){var a=P.sAggregationRole;var A=[a.charAt(0).toUpperCase(),a.substring(1)].join("");var o=s.oEntityMetadata.getPropertyMetadata(S);var D=o.label?o.label:o.name;var l=P.sLabel;var L;if(l&&l!==D){var t=sap.apf.modeler.ui.utils.TranslationFormatMap.REPRESENTATION_LABEL;L=s.oTextPool.setText(l,t);}var b=["add",A].join("");var c=["set",A,"Kind"].join("");var e=["set",A,"TextLabelKey"].join("");s.oRepresentation[b](S);s.oRepresentation[c](S,P.sKind);s.oRepresentation[e](S,L);if(a==="dimension"){var f=P.sLabelDisplayOptionProperty;if(!f){s._setDefaultLabelDisplayOption(S);P.sLabelDisplayOptionProperty=s.oRepresentation.getLabelDisplayOption(S);}else{s.oRepresentation.setLabelDisplayOption(S,f);}}P.sSelectedProperty=S;}else{P.sLabel="";P.sSelectedProperty=s.getText("none");P.sLabelDisplayOptionProperty=undefined;}});},_setSortFieldsFromCurrentDataset:function(){var s=this;this.oRepresentation.getOrderbySpecifications().forEach(function(o){s.oRepresentation.removeOrderbySpec(o.property);});this.mDataset.oSortDataset.aSortRows.forEach(function(S){var a=S.sSortProperty||(S.aAllProperties.length&&S.aAllProperties[0].sName);if(a&&a!==s.getText("none")){var A=!S.sDirection||(S.sDirection===s.getText("ascending"));s.oRepresentation.addOrderbySpec(a,A);}});},_getRepresentationMetadata:function(){var r={};this.getRepresentationTypes().forEach(function(a){if(a.metadata){r[a.id]=a.metadata;}});return r;}});};if(!jQuery.sap.isDeclared('sap.apf.modeler.ui.controller.requestOptions')){
/*!
 * SAP APF Analysis Path Framework
 *
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
jQuery.sap.declare('sap.apf.modeler.ui.controller.requestOptions');jQuery.sap.require('sap.ui.core.mvc.Controller');sap.ui.define("sap/apf/modeler/ui/controller/requestOptions",["sap/ui/core/mvc/Controller"],function(C){"use strict";var n=new sap.apf.modeler.ui.utils.NullObjectChecker();var o=new sap.apf.modeler.ui.utils.OptionsValueModelBuilder();function _(f){var t=new sap.apf.modeler.ui.utils.TextPoolHelper(f.getView().getViewData().oConfigurationHandler.getTextPool());var D={oConfigurationEditor:f.oConfigurationEditor,type:"service"};t.setAutoCompleteOn(f.byId("idSource"),D);}function a(f){var s=f.getSource();f.byId("idSource").setValue("");if(!n.checkIsNotNullOrUndefinedOrBlank(s)){f.addOrRemoveMandatoryFieldsAndRequiredFlag(false);return;}f.byId("idSource").setValue(s);f.addOrRemoveMandatoryFieldsAndRequiredFlag(true);}function b(f){var m,s,E,A;s=f.byId("idSource").getValue();f.byId("idEntity").setModel(null);f.byId("idEntity").clearSelection();if(!n.checkIsNotNullOrUndefinedOrBlank(s)){return;}if(!f.oConfigurationEditor.registerService(s)){return;}A=f.getAllEntities(s);m=o.convert(A);f.byId("idEntity").setModel(m);E=f.getEntity();if(!n.checkIsNotNullOrUndefinedOrBlank(E)||A.indexOf(E)===-1){if(n.checkIsNotNullOrUndefinedOrBlank(A)){E=f.getAllEntities(s)[0];}}f.byId("idEntity").setSelectedKey(E);}function c(f){var s,E,S,p,m,g;s=f.byId("idSource").getValue();f.byId("idSelectProperties").setModel(null);f.byId("idSelectProperties").setSelectedKeys([]);if(!n.checkIsNotNullOrUndefinedOrBlank(s)){return;}E=f.byId("idEntity").getSelectedKey();if(!n.checkIsNotNullOrUndefinedOrBlank(E)){return;}p=f.getAllEntitySetProperties(s,E);m=o.convert(p);f.byId("idSelectProperties").setModel(m);S=f.getSelectProperties();if(n.checkIsNotNullOrUndefinedOrBlank(S)){g=e(S,p);S=g;}f.byId("idSelectProperties").setSelectedKeys(S);}function d(f){f.byId("idSource").attachEvent("selectService",f.handleSelectionOfService.bind(f));}function e(E,t){var r=[];if(!n.checkIsNotNullOrUndefinedOrBlank(E)||!n.checkIsNotNullOrUndefinedOrBlank(t)){return r;}E.forEach(function(p){if(t.indexOf(p)!==-1){r.push(p);}});return r;}return C.extend("sap.apf.modeler.ui.controller.requestOptions",{viewValidator:{},oConfigurationEditor:{},oParentObject:{},onInit:function(){var f=this;f.viewValidator=new sap.apf.modeler.ui.utils.ViewValidator(f.getView());f.oConfigurationEditor=f.getView().getViewData().oConfigurationEditor;f.oParentObject=f.getView().getViewData().oParentObject;_(f);f.setDetailData();f.setDisplayText();d(f);},setDetailData:function(){var f=this;a(f);b(f);c(f);},updateSubViewInstancesOnReset:function(E){var f=this;f.oConfigurationEditor=E.mParameters[0];f.oParentObject=E.mParameters[1];f.setDetailData();},setDisplayText:function(){},handleChangeForSource:function(){var f=this,E,s;var S=f.byId("idSource").getValue().trim();if(n.checkIsNotNullOrUndefinedOrBlank(S)&&f.oConfigurationEditor.registerService(S)){f.addOrRemoveMandatoryFieldsAndRequiredFlag(true);f.updateSource(S);}else{f.clearSource();f.addOrRemoveMandatoryFieldsAndRequiredFlag(false);}b(f);E=f.byId("idEntity").getSelectedKey();f.updateEntity(E);c(f);s=f.byId("idSelectProperties").getSelectedKeys();f.updateSelectProperties(s);f.oConfigurationEditor.setIsUnsaved();f.fireRelevantEvents();},handleChangeForEntity:function(){var f=this,E,s;E=f.byId("idEntity").getSelectedKey();f.updateEntity(E);c(f);s=f.byId("idSelectProperties").getSelectedKeys();f.updateSelectProperties(s);f.oConfigurationEditor.setIsUnsaved();f.fireRelevantEvents();},handleChangeForSelectProperty:function(){var f=this;var s=f.byId("idSelectProperties").getSelectedKeys();f.updateSelectProperties(s);f.oConfigurationEditor.setIsUnsaved();f.fireRelevantEvents();},fireRelevantEvents:function(){},addOrRemoveMandatoryFieldsAndRequiredFlag:function(r){var f=this;f.byId("idEntityLabel").setRequired(r);f.byId("idSelectPropertiesLabel").setRequired(r);if(r){f.viewValidator.addFields(["idEntity","idSelectProperties"]);}else{f.viewValidator.removeFields(["idEntity","idSelectProperties"]);}},handleSelectionOfService:function(E){var s=E.getParameters()[0];E.getSource().setValue(s);E.getSource().fireEvent("change");},handleShowValueHelpRequest:function(E){var f=this;var v={oTextReader:f.getView().getViewData().oTextReader,parentControl:E.getSource(),getCalatogServiceUri:f.getView().getViewData().getCalatogServiceUri};sap.ui.view({id:f.createId("idCatalogServiceView"),viewName:"sap.apf.modeler.ui.view.catalogService",type:sap.ui.core.mvc.ViewType.XML,viewData:v});},getSource:function(){},getAllEntities:function(s){},getAllEntitySetProperties:function(s,E){},getEntity:function(){},clearSource:function(){},clearEntity:function(){},clearSelectProperties:function(){},updateSource:function(s){},updateEntity:function(E){},updateSelectProperties:function(s){},getSelectProperties:function(){}});});};if(!jQuery.sap.isDeclared('sap.apf.modeler.ui.controller.step.controller')){jQuery.sap.declare('sap.apf.modeler.ui.controller.step.controller');sap.ui.controller("sap.apf.modeler.ui.controller.step",{onInit:function(){this.getView().addStyleClass("sapUiSizeCompact");this.oViewData=this.getView().getViewData();this.getText=this.oViewData.getText;this.params=this.oViewData.oParams;this.oConfigurationHandler=this.oViewData.oConfigurationHandler;this.oConfigurationEditor=this.oViewData.oConfigurationEditor;this.oTextPool=this.oConfigurationHandler.getTextPool();this.getNavigationTargetName=this.oViewData.getNavigationTargetName;var s=this;if(!this.oConfigurationEditor){this.oConfigurationHandler.loadConfiguration(this.params.arguments.configId,function(c){s.oConfigurationEditor=c;});}this.oTextPool=this.oConfigurationHandler.getTextPool();this._setDisplayText();this.setDetailData();var m=[];m.push(this.byId("idstepTitle"));m.push(this.byId("idSourceSelect"));m.push(this.byId("idSelectPropCombo"));m.push(this.byId("idCategorySelect"));m.push(this.byId("idFilterMapEntitySelect"));m.push(this.byId("idFilterMapTargetFilterCombo"));m.push(this.byId("idCustomRecordValue"));this._setMandatoryFields(m);this._attachEvents();if(this.step.getFilterMappingService()===undefined||this.step.getFilterMappingService()===""){this._removeMandatoryFromFilterMap();}if(!this.step.getTopN()){this.byId("idCustomRecordValue").isMandatory=false;}},_setDisplayText:function(){this.byId("idStepBasicData").setTitle(this.getText("stepBasicData"));this.byId("idStepTitleLabel").setText(this.getText("stepTitle"));this.byId("idStepTitleLabel").setRequired(true);this.byId("idstepTitle").setPlaceholder(this.getText("newStep"));this.byId("idStepLongTitleLabel").setText(this.getText("stepLongTitle"));this.byId("idstepLongTitle").setPlaceholder(this.getText("stepLongTitle"));this.byId("idCategoryTitleLabel").setText(this.getText("categoryAssignments"));this.byId("idCategoryTitleLabel").setRequired(true);this.byId("idGlobalLabel").setText(this.getText("globalNavTargets"));this.byId("idStepSpecificLabel").setText(this.getText("stepSpecificNavTargets"));this.byId("idSourceSelectLabel").setText(this.getText("source"));this.byId("idSourceSelectLabel").setRequired(true);this.byId("idEntitySelectLabel").setText(this.getText("entity"));this.byId("idEntitySelectLabel").setRequired(true);this.byId("idSelectPropComboLabel").setText(this.getText("selectProperties"));this.byId("idSelectPropComboLabel").setRequired(true);this.byId("idReqFilterSelectLabel").setText(this.getText("requiredFilters"));this.byId("idDataRequest").setTitle(this.getText("dataRequest"));this.byId("idNavigationTarget").setTitle(this.getText("navigationTargetAssignment"));this.byId("idCornerTextLabel").setTitle(this.getText("cornerTextLabel"));this.byId("idLeftTop").setPlaceholder(this.getText("leftTop"));this.byId("idRightTop").setPlaceholder(this.getText("rightTop"));this.byId("idLeftBottom").setPlaceholder(this.getText("leftBottom"));this.byId("idRightBottom").setPlaceholder(this.getText("rightBottom"));this.byId("idDataReduction").setTitle(this.getText("dataReduction"));this.byId("idDataReductionLabel").setText(this.getText("dataReductionType"));this.byId("idNoDataReduction").setText(this.getText("noDataReduction"));this.byId("idTopN").setText(this.getText("topN"));this.byId("idDataRecordsLabel").setText(this.getText("recordNumber"));},_addAutoCompleteFeatureOnInputs:function(){if(this.oConfigurationHandler){var t=new sap.apf.modeler.ui.utils.TextPoolHelper(this.oTextPool);var s=this.byId("idstepTitle");var T=sap.apf.modeler.ui.utils.TranslationFormatMap.STEP_TITLE;var d={oTranslationFormat:T,type:"text"};t.setAutoCompleteOn(s,d);var S=this.byId("idstepLongTitle");var o=sap.apf.modeler.ui.utils.TranslationFormatMap.STEP_LONG_TITLE;var D={oTranslationFormat:o,type:"text"};t.setAutoCompleteOn(S,D);var a=this.byId("idLeftTop");var b=this.byId("idRightTop");var c=this.byId("idLeftBottom");var e=this.byId("idRightBottom");var f=sap.apf.modeler.ui.utils.TranslationFormatMap.STEP_CORNER_TEXT;var g={oTranslationFormat:f,type:"text"};t.setAutoCompleteOn(a,g);t.setAutoCompleteOn(b,g);t.setAutoCompleteOn(c,g);t.setAutoCompleteOn(e,g);var h={oConfigurationEditor:this.oConfigurationEditor,type:"service"};var i=this.byId("idSourceSelect");t.setAutoCompleteOn(i,h);var j=this.byId("idFilterMapSourceSelect");t.setAutoCompleteOn(j,h);}},_prepareStepSpecificList:function(){var s=this;var m=[];var a=this.oConfigurationEditor.getNavigationTargets();var S=this.step.getNavigationTargets();var A=a.filter(function(n){return n.isStepSpecific();});if(A.length!==0){this.byId("idStepSpecificCombo").setBusy(true);}A.forEach(function(o){var n={};n.navTargetKey=o.getId();s.getNavigationTargetName(o.getId()).then(function(v){n.navTargetName=v;m.push(n);if(m.length===A.length){var b=new sap.ui.model.json.JSONModel();var c={stepSpecific:m};b.setData(c);s.byId("idStepSpecificCombo").setModel(b);s.byId("idStepSpecificCombo").setSelectedKeys(S);s.byId("idStepSpecificCombo").setBusy(false);}});});},_prepareGlobalList:function(){var s=this;var m=[];var a=this.oConfigurationEditor.getNavigationTargets();var g=a.filter(function(n){return n.isGlobal();});if(g.length!==0){this.byId("idGlobalCombo").setBusy(true);}g=g.map(function(G){return G.getId();});g.forEach(function(G){var o={};o.navTargetKey=G;s.getNavigationTargetName(G).then(function(v){o.navTargetName=v;m.push(o);if(m.length===g.length){var b=new sap.ui.model.json.JSONModel();var c={global:m};b.setData(c);s.byId("idGlobalCombo").setModel(b);s.byId("idGlobalCombo").setSelectedKeys(g);s.byId("idGlobalCombo").setBusy(false);}});});},setDetailData:function(){var s=this;if(this.params&&this.params.arguments&&this.params.arguments.stepId){this.step=this.oConfigurationEditor.getStep(this.params.arguments.stepId);}var C=[];this.oTextPool=this.oConfigurationHandler.getTextPool();var a=this.oConfigurationEditor.getCategories();a.forEach(function(L){var N={};N.CategoryId=L.getId();N.CategoryTitle=s.oTextPool.get(L.labelKey)?s.oTextPool.get(L.labelKey).TextElementDescription:L.labelKey;C.push(N);});var d={Categories:C};var m=new sap.ui.model.json.JSONModel();m.setData(d);this.byId("idCategorySelect").setModel(m);var p={propertyKey:this.getText("none"),propertyName:this.getText("none")};var D={Properties:[p]};var M=new sap.ui.model.json.JSONModel();M.setSizeLimit(500);M.setData(D);this.byId("idReqFilterSelect").setModel(M);var S=[];var o=this.byId("idFilterMapTargetFilterCombo")?this.byId("idFilterMapTargetFilterCombo").getSelectedKeys():[];o.forEach(function(L){var p={};p.propertyKey=L;p.propertyName=L;S.push(p);});var b=new sap.ui.model.json.JSONModel();b.setSizeLimit(500);b.setData(S);this.byId("idFilterMapTargetFilterCombo").setModel(b);if(this.step){var n=this.getText("none");var c=[n];if(this.step.getTitleId&&this.step.getTitleId()!==undefined&&this.step.getTitleId()!==null&&s.oTextPool.get(this.step.getTitleId())){this.byId("idstepTitle").setValue(s.oTextPool.get(this.step.getTitleId()).TextElementDescription);}else{this.byId("idstepTitle").setValue(this.params.arguments.stepId);}if(this.step.getLongTitleId&&this.step.getLongTitleId()!==undefined&&this.step.getLongTitleId()!==null&&s.oTextPool.get(this.step.getLongTitleId())){this.byId("idstepLongTitle").setValue(s.oTextPool.get(this.step.getLongTitleId()).TextElementDescription);}else{this.byId("idstepLongTitle").setValue("");}if(this.step.getService&&this.step.getService()!==undefined&&this.step.getService()!==null){this.byId("idSourceSelect").setValue(this.step.getService());var e=this.step.getService();var A=[];var f=[];A=this.oConfigurationEditor.getAllEntitySetsOfService(e);A.forEach(function(L){var N={};N.entityKey=L;N.entityName=L;f.push(N);});var g={Entities:f};var h=new sap.ui.model.json.JSONModel();h.setSizeLimit(500);h.setData(g);this.byId("idEntitySelect").setModel(h);}if(this.step.getEntitySet&&this.step.getEntitySet()!==undefined&&this.step.getEntitySet()!==null){this.byId("idEntitySelect").setSelectedKey(this.step.getEntitySet());var E=this.step.getEntitySet();var i=this.step.getService();var P=[],j=[];if(i&&i!==null&&i!==""){P=this.oConfigurationEditor.getAllPropertiesOfEntitySet(i,E);P.forEach(function(L){var p={};p.propertyKey=L;p.propertyName=L;j.push(p);});var k={Properties:j};var l=new sap.ui.model.json.JSONModel();l.setSizeLimit(500);l.setData(k);this.byId("idSelectPropCombo").setModel(l);}}if(this.step.getSelectProperties&&this.step.getSelectProperties()!==undefined&&this.step.getSelectProperties().length!==0){this.byId("idSelectPropCombo").setSelectedKeys(this.step.getSelectProperties());P=c.concat(this.step.getSelectProperties());j=[];P.forEach(function(L){var p={};p.propertyKey=L;p.propertyName=L;j.push(p);});D={Properties:j};M=new sap.ui.model.json.JSONModel();M.setSizeLimit(500);M.setData(D);this.byId("idReqFilterSelect").setModel(M);}if(this.step.getFilterProperties&&this.step.getFilterProperties()!==undefined&&this.step.getFilterProperties().length!==0){this.byId("idReqFilterSelect").setSelectedKey(this.step.getFilterProperties()[0]);this._showFilterMappingField();}else{this.byId("idReqFilterSelect").setSelectedKey(this.getText("none"));this._hideFilterMapField();this._resetFilterMappingFields();}this._setTopNValue();if(this.step.getFilterMappingService&&this.step.getFilterMappingService()!==undefined&&this.step.getFilterMappingService().length!==0){this.byId("idFilterMapSourceSelect").setValue(this.step.getFilterMappingService());var F=this.step.getFilterMappingService();var q=[];var r=[];var R=this.step.getFilterProperties();q=this.oConfigurationEditor.getAllEntitySetsOfServiceWithGivenProperties(F,R);q.forEach(function(L){var N={};N.entityKey=L;N.entityName=L;r.push(N);});var t={Entities:r};var u=new sap.ui.model.json.JSONModel();u.setSizeLimit(500);u.setData(t);this.byId("idFilterMapEntitySelect").setModel(u);this._addMandatoryfromFilterMap();}else{this._removeMandatoryFromFilterMap();this._resetFilterMappingFields();}if(this.step.getFilterMappingEntitySet&&this.step.getFilterMappingEntitySet()!==undefined&&this.step.getFilterMappingEntitySet().length!==0){this.byId("idFilterMapEntitySelect").setSelectedKey(this.step.getFilterMappingEntitySet());var v=this.step.getFilterMappingEntitySet();var w=this.step.getFilterMappingService();var x=[],y=[];if(w&&w!==null&&w!==""){x=this.oConfigurationEditor.getAllPropertiesOfEntitySet(w,v);x.forEach(function(L){var p={};p.propertyKey=L;p.propertyName=L;y.push(p);});var z={Properties:y};var B=new sap.ui.model.json.JSONModel();B.setSizeLimit(500);B.setData(z);this.byId("idFilterMapTargetFilterCombo").setModel(B);}}if(this.step.getFilterMappingTargetProperties&&this.step.getFilterMappingTargetProperties()!==undefined&&this.step.getFilterMappingTargetProperties().length!==0){this.byId("idFilterMapTargetFilterCombo").setSelectedKeys(this.step.getFilterMappingTargetProperties());}if(this.step.getFilterMappingKeepSource&&this.step.getFilterMappingKeepSource()!==undefined){this.byId("idFilterKeepSourceCheckBox").setSelected(this.step.getFilterMappingKeepSource());}var G=s.oConfigurationEditor.getCategoriesForStep(this.step.getId());if(G&&G.length!==0){this.byId("idCategorySelect").setSelectedKeys(G);}if(this.step.getLeftLowerCornerTextKey()&&s.oTextPool.get(this.step.getLeftLowerCornerTextKey())){this.byId("idLeftBottom").setValue(s.oTextPool.get(this.step.getLeftLowerCornerTextKey()).TextElementDescription);}else{this.byId("idLeftBottom").setValue(this.step.getLeftLowerCornerTextKey());}if(this.step.getLeftUpperCornerTextKey()&&s.oTextPool.get(this.step.getLeftUpperCornerTextKey())){this.byId("idLeftTop").setValue(s.oTextPool.get(this.step.getLeftUpperCornerTextKey()).TextElementDescription);}else{this.byId("idLeftTop").setValue(this.step.getLeftUpperCornerTextKey());}if(this.step.getRightUpperCornerTextKey()&&s.oTextPool.get(this.step.getRightUpperCornerTextKey())){this.byId("idRightTop").setValue(s.oTextPool.get(this.step.getRightUpperCornerTextKey()).TextElementDescription);}else{this.byId("idRightTop").setValue(this.step.getRightUpperCornerTextKey());}if(this.step.getRightLowerCornerTextKey()&&s.oTextPool.get(this.step.getRightLowerCornerTextKey())){this.byId("idRightBottom").setValue(s.oTextPool.get(this.step.getRightLowerCornerTextKey()).TextElementDescription);}else{this.byId("idRightBottom").setValue(this.step.getRightLowerCornerTextKey());}}else{this._changeVisibilityDataReductionField(false);this._changeVisibilityOfTopN(false);this._hideFilterMapField();var H=this.params.arguments.categoryId;var I=s.oConfigurationEditor.createStep(H);this.step=s.oConfigurationEditor.getStep(I);var J=[H];this.byId("idCategorySelect").setSelectedKeys(J);var K={id:I,icon:"sap-icon://BusinessSuiteInAppSymbols/icon-phase"};this.oViewData.updateSelectedNode(K);}this._addAutoCompleteFeatureOnInputs();this._prepareGlobalList();this._prepareStepSpecificList();},_setTopNValue:function(){this._setSortDataForStep();var h;if(this.step.getTopN()){h=true;var n=this.step.getTopN().top;this.byId("idDataReductionRadioGroup").setSelectedButton(this.byId("idDataReductionRadioGroup").getButtons()[1]);this.byId("idCustomRecordValue").setValue(n);}else{this.byId("idDataReductionRadioGroup").setSelectedButton(this.byId("idDataReductionRadioGroup").getButtons()[0]);h=false;}this._changeVisibilityOfTopN(h);},handleChangeDetailValueForTree:function(e){this.oConfigurationEditor.setIsUnsaved();var s=this;var S=this.oConfigurationEditor.getCategoriesForStep(this.step.getId());var t=sap.apf.modeler.ui.utils.TranslationFormatMap.STEP_TITLE;var a=this.byId("idstepTitle").getValue().trim();var b=s.oTextPool.setText(a,t);if(a!==""&&a!==null){this.step.setTitleId(b);}var c={};c.name=a;c.id=this.step.getId();if(a!==""&&a!==null){if(S.length>1){this.oViewData.updateTree();}else{this.oViewData.updateSelectedNode(c);}var T=this.getText("step")+": "+a;this.oViewData.updateTitleAndBreadCrumb(T);}},handleChangeForLongTitle:function(){this.oConfigurationEditor.setIsUnsaved();var s=this.byId("idstepLongTitle").getValue().trim();var t=sap.apf.modeler.ui.utils.TranslationFormatMap.STEP_LONG_TITLE;var S=this.oTextPool.setText(s,t);this.step.setLongTitleId(S);},handleChangeForStepSpecific:function(){var s=this;this.oConfigurationEditor.setIsUnsaved();var a=this.byId("idStepSpecificCombo").getSelectedKeys();var p=this.step.getNavigationTargets();p.forEach(function(n){if(a.indexOf(n)===-1){s.step.removeNavigationTarget(n);}});a.forEach(function(n){if(p.indexOf(n)===-1){s.step.addNavigationTarget(n);}});},_attachEvents:function(){var c=this;c.byId("idSourceSelect").attachEvent("selectService",c.handleSelectionOfService.bind(c));c.byId("idFilterMapSourceSelect").attachEvent("selectService",c.handleSelectionOfService.bind(c));},handleShowValueHelpRequest:function(e){var c=this;var v={oTextReader:c.getView().getViewData().getText,parentView:c.getView(),parentControl:e.getSource(),getCalatogServiceUri:c.getView().getViewData().getCalatogServiceUri};sap.ui.view({id:c.createId("idCatalogServiceView"),viewName:"sap.apf.modeler.ui.view.catalogService",type:sap.ui.core.mvc.ViewType.XML,viewData:v});},handleSelectionOfService:function(e){var s=e.getParameters()[0];e.getSource().setValue(s);e.getSource().fireEvent("change");},handleChangeForService:function(e){this.oConfigurationEditor.setIsUnsaved();var s,a=[],A=[],p=[],S=[],r;var b=this.byId("idReqFilterSelect").getSelectedKey();if(b!==this.getText("none")){r=[b];}else{r=this.step.getFilterProperties();}var c=e?e.getParameter("id"):"";var i=c.search("FilterMap")!==-1?true:false;var d;if(i){s=this.byId("idFilterMapSourceSelect").getValue().trim();d=this.oConfigurationEditor.registerService(s);if(d){this._addMandatoryfromFilterMap();a=this.oConfigurationEditor.getAllEntitySetsOfServiceWithGivenProperties(s,r);}else{this._removeMandatoryFromFilterMap();}}else{this._resetStepRequestProperties();if(b===this.getText("none")||b===""){this._hideFilterMapField();}else{this._removeMandatoryFromFilterMap();}this._resetFilterMappingFields();s=this.byId("idSourceSelect").getValue().trim();d=this.oConfigurationEditor.registerService(s);a=this.oConfigurationEditor.getAllEntitySetsOfService(s);}a.forEach(function(q){var t={};t.entityKey=q;t.entityName=q;A.push(t);});var E={Entities:A};var o=new sap.ui.model.json.JSONModel();o.setSizeLimit(500);o.setData(E);var f;if(a.length>=1){if(i){if(this.step.getFilterMappingEntitySet()){f=this.step.getFilterMappingEntitySet();p=this.oConfigurationEditor.getAllPropertiesOfEntitySet(s,f);}else{p=this.oConfigurationEditor.getAllPropertiesOfEntitySet(s,a[0]);}this.step.setFilterMappingEntitySet(a[0]);this.byId("idFilterMapEntitySelect").setSelectedKey(a[0]);}else{if(this.step.getEntitySet()){f=this.step.getEntitySet();p=this.oConfigurationEditor.getAllPropertiesOfEntitySet(s,f);}else{p=this.oConfigurationEditor.getAllPropertiesOfEntitySet(s,a[0]);}this.step.setEntitySet(a[0]);this.byId("idEntitySelect").setSelectedKey(a[0]);}p.forEach(function(q){var P={};P.propertyKey=q;P.propertyName=q;S.push(P);});}var g={Properties:S};var h=new sap.ui.model.json.JSONModel();h.setSizeLimit(500);h.setData(g);var j=[],k=[];var l=this.byId("idSelectPropCombo").getSelectedKeys();l.forEach(function(q){var P={};P.propertyKey=q;P.propertyName=q;j.push(P);});var n={propertyKey:this.getText("none"),propertyName:this.getText("none")};var N=[n];N=N.concat(j);var R=new sap.ui.model.json.JSONModel();R.setSizeLimit(500);var D={Properties:N};R.setData(D);var m=this.byId("idFilterMapTargetFilterCombo")?this.byId("idFilterMapTargetFilterCombo").getSelectedKeys():[];m.forEach(function(q){var P={};P.propertyKey=q;P.propertyName=q;k.push(P);});if(i){this.byId("idFilterMapEntitySelect").setModel(o);this.byId("idFilterMapTargetFilterCombo").setModel(h);}else{this.byId("idEntitySelect").setModel(o);this.byId("idSelectPropCombo").setModel(h);this.byId("idReqFilterSelect").setModel(R);}this._checkValidationStateForService("source",c);},_addMandatoryfromFilterMap:function(){this.byId("idFilterMapEntitySelect").isMandatory=true;this.byId("idFilterMapTargetFilterCombo").isMandatory=true;this.byId("idFilterMapEntityLabel").setText(this.getText("entity"));this.byId("idFilterMapEntityLabel").setRequired(true);this.byId("idFilterMapTargetFilterLabel").setText(this.getText("filterMapTarget"));this.byId("idFilterMapTargetFilterLabel").setRequired(true);this.byId("idFilterMapKeepSourceLabel").setText(this.getText("filterMapKeepSource"));this.byId("idFilterMapKeepSourceLabel").setRequired(true);},_removeMandatoryFromFilterMap:function(){this.byId("idFilterMapEntitySelect").isMandatory=false;this.byId("idFilterMapTargetFilterCombo").isMandatory=false;this.byId("idFilterMapEntityLabel").setText(this.getText("entity"));this.byId("idFilterMapEntityLabel").setRequired(false);this.byId("idFilterMapTargetFilterLabel").setText(this.getText("filterMapTarget"));this.byId("idFilterMapTargetFilterLabel").setRequired(false);this.byId("idFilterMapKeepSourceLabel").setText(this.getText("filterMapKeepSource"));this.byId("idFilterMapKeepSourceLabel").setRequired(false);},_resetFilterMappingFields:function(){var s=this;this.step.setFilterMappingService("");this.step.setFilterMappingEntitySet(undefined);this.step.setFilterMappingKeepSource(undefined);var o=this.step.getFilterMappingTargetProperties();o.forEach(function(p){s.step.removeFilterMappingTargetProperty(p);});var e=new sap.ui.model.json.JSONModel();var E={NoData:[]};e.setData(E);this.byId("idFilterMapSourceSelect").setValue("");this.byId("idFilterMapEntitySelect").setModel(e);this.byId("idFilterMapEntitySelect").setSelectedKey();this.byId("idFilterMapTargetFilterCombo").setModel(e);var S=this.byId("idFilterMapTargetFilterCombo").getSelectedKeys();this.byId("idFilterMapTargetFilterCombo").removeSelectedKeys(S);},handleChangeForEntity:function(e){this.oConfigurationEditor.setIsUnsaved();var E,s,p=[],P=[];var a=e.getParameter("id");var i=a.search("FilterMap")!==-1?true:false;if(i){E=this.byId("idFilterMapEntitySelect").getSelectedKey();s=this.byId("idFilterMapSourceSelect").getValue().trim();p=this.oConfigurationEditor.getAllPropertiesOfEntitySet(s,E);}else{E=this.byId("idEntitySelect").getSelectedKey();s=this.byId("idSourceSelect").getValue().trim();p=this.oConfigurationEditor.getAllPropertiesOfEntitySet(s,E);}p.forEach(function(c){var f={};f.propertyKey=c;f.propertyName=c;P.push(f);});var S={Properties:P};var o=new sap.ui.model.json.JSONModel();o.setSizeLimit(500);o.setData(S);var n={propertyKey:this.getText("none"),propertyName:this.getText("none")};var r=[n];r=r.concat(P);var R=new sap.ui.model.json.JSONModel();R.setSizeLimit(500);var d={Properties:r};R.setData(d);var t=new sap.ui.model.json.JSONModel();t.setSizeLimit(500);t.setData(P);if(i){this.byId("idFilterMapTargetFilterCombo").setModel(o);}else{this.byId("idSelectPropCombo").setModel(o);this.byId("idReqFilterSelect").setModel(R);}this._checkValidationStateForService("entitySet",a);var b=this.byId("idReqFilterSelect").getSelectedKey();if(b===this.getText("none")){this._hideFilterMapField();this._resetFilterMappingFields();}},handleChangeForSelectProperty:function(e){var s=this;var h;this.oConfigurationEditor.setIsUnsaved();var S,a=[];var b=e.getParameter("id");var o=this.step.getSelectProperties();o.forEach(function(p){s.step.removeSelectProperty(p);});S=this.byId("idSelectPropCombo").getSelectedKeys();if(S.length>0){S.forEach(function(p){s.step.addSelectProperty(p);var P={};P.propertyKey=p;P.propertyName=p;a.push(P);});var n={propertyKey:this.getText("none"),propertyName:this.getText("none")};var r=[n];r=r.concat(a);var R=new sap.ui.model.json.JSONModel();R.setSizeLimit(500);var d={Properties:r};R.setData(d);var t=new sap.ui.model.json.JSONModel();t.setSizeLimit(500);t.setData(a);this.byId("idReqFilterSelect").setModel(R);this._checkValidationStateForService("selectProperties",b);var c=this.step.getFilterProperties()?this.step.getFilterProperties()[0]:undefined;if(c){var f=this.step.getSelectProperties().indexOf(c)===-1?false:true;if(f){this.byId("idReqFilterSelect").setSelectedKey(c);}else{this.byId("idReqFilterSelect").setSelectedKey(this.getText("none"));}}if(this.byId("idReqFilterSelect").getSelectedKey()===this.getText("none")){this._hideFilterMapField();this._resetFilterMappingFields();}this._setSortDataForStep();h=true;}else{h=false;this._changeVisibilityOfTopN(h);this.byId("idDataReductionRadioGroup").setSelectedButton(this.byId("idDataReductionRadioGroup").getButtons()[0]);this._resetTopNFields();}this._changeVisibilityDataReductionField(h);},_changeVisibilityDataReductionField:function(h){this.byId("idDataReduction").setVisible(h);this.byId("idDataReductionLabel").setVisible(h);this.byId("idDataReductionRadioButton").setVisible(h);this.byId("idDataReductionRadioGroup").setVisible(h);},handleChangeForRequiredFilter:function(e){var s=this;var a=e.getParameter("id");this.oConfigurationEditor.setIsUnsaved();var o=this.step.getFilterProperties();o.forEach(function(p){s.step.removeFilterProperty(p);});var r=this.byId("idReqFilterSelect").getSelectedKey();if(r!==this.getText("none")){this.step.addFilterProperty(r);this._showFilterMappingField();}else{this._hideFilterMapField();this._resetFilterMappingFields();}this._checkValidationStateForService("requiredFilter",a);},_showFilterMappingField:function(){this.byId("idFilterMapping").setVisible(true);this.byId("idFilterMapSourceLabel").setVisible(true);this.byId("idFilterMapSourceSelect").setVisible(true);this.byId("idFilterMapEntityLabel").setVisible(true);this.byId("idFilterMapEntitySelect").setVisible(true);this.byId("idFilterMapTargetFilterLabel").setVisible(true);this.byId("idFilterMapTargetFilterCombo").setVisible(true);this.byId("idFilterMapKeepSourceLabel").setVisible(true);this.byId("idFilterKeepSourceCheckBox").setVisible(true);this.byId("idFilterMapping").setTitle(this.getText("filterMap"));this.byId("idFilterMapSourceLabel").setText(this.getText("source"));this.byId("idFilterMapSourceLabel").setRequired(false);this.byId("idFilterMapEntityLabel").setText(this.getText("entity"));this.byId("idFilterMapEntityLabel").setRequired(false);this.byId("idFilterMapTargetFilterLabel").setText(this.getText("filterMapTarget"));this.byId("idFilterMapTargetFilterLabel").setRequired(false);this.byId("idFilterMapKeepSourceLabel").setText(this.getText("filterMapKeepSource"));this.byId("idFilterMapKeepSourceLabel").setRequired(false);},_hideFilterMapField:function(){this.byId("idFilterMapping").setVisible(false);this.byId("idFilterMapSourceLabel").setVisible(false);this.byId("idFilterMapSourceSelect").setVisible(false);this.byId("idFilterMapEntityLabel").setVisible(false);this.byId("idFilterMapEntitySelect").setVisible(false);this.byId("idFilterMapTargetFilterLabel").setVisible(false);this.byId("idFilterMapTargetFilterCombo").setVisible(false);this.byId("idFilterMapKeepSourceLabel").setVisible(false);this.byId("idFilterKeepSourceCheckBox").setVisible(false);this._removeMandatoryFromFilterMap();},handleChangeForTargetFilter:function(e){var s=this;var a=e.getParameter("id");this.oConfigurationEditor.setIsUnsaved();var t=this.byId("idFilterMapTargetFilterCombo").getSelectedKeys();if(t.length>0){var o=this.step.getFilterMappingTargetProperties();o.forEach(function(p){s.step.removeFilterMappingTargetProperty(p);});t.forEach(function(p){s.step.addFilterMappingTargetProperty(p);});}this._checkValidationStateForService("targetProperties",a);},handleFilterMapKeepSource:function(){var i=this.byId("idFilterKeepSourceCheckBox").getSelected();this.oConfigurationEditor.setIsUnsaved();this.step.setFilterMappingKeepSource(i);},_checkValidationStateForService:function(p,s){var a=this;var v={source:undefined,entitySet:undefined,selectProperty:undefined,requiredFilter:undefined,targetFilter:undefined};var S,r,A=[],b=[];var i=s.search("FilterMap")!==-1?true:false;S=i?this.byId("idFilterMapSourceSelect").getValue().trim():this.byId("idSourceSelect").getValue().trim();var c=this.oConfigurationEditor.registerService(S);if(c){v.source=S;var d=this.byId("idReqFilterSelect").getSelectedKey();if(d!==this.getText("none")){r=[d];}else{r=this.step.getFilterProperties();}A=i?this.oConfigurationEditor.getAllEntitySetsOfServiceWithGivenProperties(S,r):this.oConfigurationEditor.getAllEntitySetsOfService(S);var e;if(p==="entitySet"||p==="selectProperties"||p==="targetProperties"||p==="requiredFilter"){e=i?this.byId("idFilterMapEntitySelect").getSelectedKey():this.byId("idEntitySelect").getSelectedKey();}else{e=i?this.step.getFilterMappingEntitySet():this.step.getEntitySet();}if(e){A.forEach(function(u){if(e===u){v.entitySet=e;if(p==="source"){if(i){a.byId("idFilterMapEntitySelect").setSelectedKey(e);}else{a.byId("idEntitySelect").setSelectedKey(e);}}}});var f,C=[];if(p==="selectProperties"){f=this.byId("idSelectPropCombo").getSelectedKeys();}else{f=this.step.getSelectProperties();}var P=this.oConfigurationEditor.getAllPropertiesOfEntitySet(S,e);var g=[];P.forEach(function(u){var w={};w.propertyKey=u;w.propertyName=u;g.push(w);});var D={Properties:g};var m=new sap.ui.model.json.JSONModel();m.setSizeLimit(500);m.setData(D);if(!i){this.byId("idSelectPropCombo").setModel(m);}else{this.byId("idFilterMapTargetFilterCombo").setModel(m);}P.forEach(function(u){f.forEach(function(w){if(w===u){C.push(w);}});});var h=[];var o=[{propertyKey:this.getText("none"),propertyName:this.getText("none")}];if(this.step.getFilterMappingTargetProperties().length===0){this.byId("idFilterMapTargetFilterCombo").setSelectedKeys([]);}if(C.length>0){v.selectProperty=C;if(p!=="selectProperties"&&!i){this.byId("idSelectPropCombo").setSelectedKeys(C);}C.forEach(function(u){var w={};w.propertyKey=u;w.propertyName=u;h.push(w);});}else{var j;if(!i){j=this.byId("idSelectPropCombo").getSelectedKeys();this.byId("idSelectPropCombo").removeSelectedKeys(j);this.byId("idReqFilterSelect").setSelectedKey(this.getText("none"));}}o=o.concat(h);var R={Properties:o};var k=new sap.ui.model.json.JSONModel();k.setData(R);var t=[],l=[];if(p==="targetProperties"){t=this.byId("idFilterMapTargetFilterCombo").getSelectedKeys();}else{t=this.step.getFilterMappingTargetProperties();}if(t.length>0){v.targetFilter=t;this.byId("idFilterMapTargetFilterCombo").setSelectedKeys(t);}if(p==="requiredFilter"){l.push(this.byId("idReqFilterSelect").getSelectedKey());}else{l=this.step.getFilterProperties();}var n=[];l.forEach(function(u){if(u!==a.getText("none")){h.forEach(function(w){if(w.propertyKey===u){n.push(u);}});}});if(n.length!==0){v.requiredFilter=n;}else{if(!i){this.byId("idReqFilterSelect").setSelectedKey(this.getText("none"));}}var T={Properties:h};var q=new sap.ui.model.json.JSONModel();q.setSizeLimit(500);q.setData(T);if(!i){this.byId("idReqFilterSelect").setModel(k);}}if(i){this._validateStepServiceForFilterMapping(v);}else{this._validateStepServiceForDataSource(v);}}else{if(i){this._resetFilterMappingFields();}else{this._resetStepRequestProperties();}}},_resetStepRequestProperties:function(){var s=this;this.step.setEntitySet(undefined);var o=this.step.getSelectProperties();o.forEach(function(p){s.step.removeSelectProperty(p);});var O=this.step.getFilterProperties();O.forEach(function(p){s.step.removeFilterProperty(p);});this.byId("idEntitySelect").setSelectedKey();this.byId("idReqFilterSelect").setSelectedKey();},_validateStepServiceForDataSource:function(v){var s=this;if(v.selectProperty&&v.entitySet&&v.source){this.step.setService(v.source);this.step.setEntitySet(v.entitySet);var o=this.step.getSelectProperties();o.forEach(function(p){s.step.removeSelectProperty(p);});v.selectProperty.forEach(function(p){s.step.addSelectProperty(p);});var O=this.step.getFilterProperties();O.forEach(function(p){s.step.removeFilterProperty(p);});if(v.requiredFilter){v.requiredFilter.forEach(function(p){s.step.addFilterProperty(p);});}}},_validateStepServiceForFilterMapping:function(v){var s=this;if(v.entitySet&&v.source&&v.targetFilter){this.step.setFilterMappingService(v.source);this.step.setFilterMappingEntitySet(v.entitySet);var o=this.step.getFilterMappingTargetProperties();o.forEach(function(p){s.step.removeFilterMappingTargetProperty(p);});v.targetFilter.forEach(function(p){s.step.addFilterMappingTargetProperty(p);});}},handleChangeForCategory:function(){this.oConfigurationEditor.setIsUnsaved();var s=this;var a=s.step.getId();var c=this.params.arguments.categoryId;var p=this.oConfigurationEditor.getCategoriesForStep(this.step.getId());var S=this.byId("idCategorySelect").getSelectedKeys();var b=S.indexOf(c);var d=[];var u=[];var i,j;for(i=0;i<p.length;i++){var m=false;for(j=0;j<S.length;j++){if(p[i]===S[j]){m=true;break;}}if(!m){u.push(p[i]);}}if(S.length!==0){S.forEach(function(e){s.oConfigurationEditor.addCategoryStepAssignment(e,a);var o={oldContext:{name:s.params.name,arguments:{configId:s.params.arguments.configId,categoryId:c,stepId:a}},newContext:{arguments:{configId:s.params.arguments.configId,categoryId:e}}};if(e!==c){d.push(o);}});p.forEach(function(C){if(S.indexOf(C)===-1){s.oConfigurationEditor.removeCategoryStepAssignment(C,s.step.getId());}});if(u.length!==0){var n=jQuery.extend(true,{},s.params);u.forEach(function(e){var o={oldContext:{name:s.params.name,arguments:{configId:s.params.arguments.configId,categoryId:c,stepId:a}},newContext:{arguments:{configId:s.params.arguments.configId,categoryId:e}},removeStep:true};if(b===-1&&e===c){var f={arguments:{appId:s.params.arguments.appId,configId:s.params.arguments.configId,categoryId:S[0],stepId:a}};o.categoryChangeContext=f;o.changeCategory=true;}d.push(o);});}}if(d.length!==0){this.oViewData.updateConfigTree(d);}},handleChangeForLeftTop:function(){this.oConfigurationEditor.setIsUnsaved();var s=this.byId("idLeftTop").getValue().trim();var t=sap.apf.modeler.ui.utils.TranslationFormatMap.STEP_CORNER_TEXT;var S=this.oTextPool.setText(s,t);this.step.setLeftUpperCornerTextKey(S);},handleChangeForRightTop:function(){this.oConfigurationEditor.setIsUnsaved();var s=this.byId("idRightTop").getValue().trim();var t=sap.apf.modeler.ui.utils.TranslationFormatMap.STEP_CORNER_TEXT;var S=this.oTextPool.setText(s,t);this.step.setRightUpperCornerTextKey(S);},handleChangeForLeftBottom:function(){this.oConfigurationEditor.setIsUnsaved();var s=this.byId("idLeftBottom").getValue().trim();var t=sap.apf.modeler.ui.utils.TranslationFormatMap.STEP_CORNER_TEXT;var S=this.oTextPool.setText(s,t);this.step.setLeftLowerCornerTextKey(S);},handleChangeForRightBottom:function(){this.oConfigurationEditor.setIsUnsaved();var s=this.byId("idRightBottom").getValue().trim();var t=sap.apf.modeler.ui.utils.TranslationFormatMap.STEP_CORNER_TEXT;var S=this.oTextPool.setText(s,t);this.step.setRightLowerCornerTextKey(S);},_setSortDataForStep:function(){var s=this;var S=this.step.getSelectProperties().map(function(p){return{property:p};});var a;var t=this.step.getTopN();if(t&&t.orderby){var b=t.orderby.map(function(c){var O=c.property;var d=c.ascending!==undefined&&!c.ascending?s.getText("descending"):s.getText("ascending");return{property:O,ascending:d,aAllProperties:S};});a=b;}else{a=[{property:S[0].property,ascending:true,aAllProperties:S}];}var o=new sap.ui.model.json.JSONModel({aSortRows:a});this.byId("idStepSortLayout").setModel(o);this._bindSortLayoutDataForStep();},_bindSortLayoutDataForStep:function(){var s=this;var S=this.byId("idStepSortLayout");var o=new sap.ui.layout.Grid({width:"100%"});var a=new sap.m.Label({width:"100%",textAlign:"End",layoutData:new sap.ui.layout.GridData({span:"L3 M3 S3"}),text:this.getText("sortingField")}).addStyleClass("sortFieldLabel");o.addContent(a);var b=new sap.m.Select({width:"100%",layoutData:new sap.ui.layout.GridData({span:"L2 M3 S3"}),items:{path:"aAllProperties",template:new sap.ui.core.ListItem({key:"{property}",text:"{property}"})},selectedKey:"{property}",change:s._handleChangeForSortData.bind(this)});o.addContent(b);var d=new sap.m.Label({layoutData:new sap.ui.layout.GridData({span:"L2 M2 S2"}),width:"100%",textAlign:"End",text:this.getText("direction")}).addStyleClass("directionLabel");o.addContent(d);var D=new sap.m.Select({width:"100%",layoutData:new sap.ui.layout.GridData({span:"L2 M2 S2"}),items:[{key:this.getText("ascending"),text:this.getText("ascending")},{key:this.getText("descending"),text:this.getText("descending")}],selectedKey:"{ascending}",change:s._handleChangeForSortData.bind(this)});o.addContent(D);var A=new sap.ui.core.Icon({width:"100%",src:"sap-icon://add",tooltip:this.getText("addButton"),visible:true,press:s._handleChangeForAddSortRow.bind(this)}).addStyleClass("addIconRepresentation");var r=new sap.ui.core.Icon({width:"100%",src:"sap-icon://less",tooltip:this.getText("deleteButton"),visible:{path:"/",formatter:function(){var B=this.getBindingContext();var n=parseInt(B.getPath().split("/").pop(),10);return!!n;}},press:s._handleChangeForDeleteSortRow.bind(this)}).addStyleClass("lessIconRepresentation");var i=new sap.m.HBox({layoutData:new sap.ui.layout.GridData({span:"L2 M2 S2"}),items:[A,r]});o.addContent(i);S.bindAggregation("items","/aSortRows",function(I){return o.clone(I);});},_handleChangeForSortData:function(){this._setSortFieldsFromCurrentDataset();this.oConfigurationEditor.setIsUnsaved();},_handleChangeForAddSortRow:function(a){var u=this._getUpdatedSortRow(a);var b=a.getSource().getBindingContext();var c=jQuery.extend(true,{},b.getObject());delete c.property;delete c.ascending;u.aSortRows.splice(u.nCurrentIndex+1,0,c);this._updateModelForSortData();},_handleChangeForDeleteSortRow:function(d){var u=this._getUpdatedSortRow(d);u.aSortRows.splice(u.nCurrentIndex,1);this._updateModelForSortData();},_getUpdatedSortRow:function(s){var b=s.getSource().getBindingContext();var n=parseInt(b.getPath().split("/").pop(),10);var S=this.byId("idStepSortLayout").getModel().getData().aSortRows;return{nCurrentIndex:n,aSortRows:S};},_updateModelForSortData:function(){this.byId("idStepSortLayout").getModel().updateBindings();this._setSortFieldsFromCurrentDataset();this.oConfigurationEditor.setIsUnsaved();},_setSortFieldsFromCurrentDataset:function(){var s=this;var S=[];this.byId("idStepSortLayout").getModel().getData().aSortRows.forEach(function(o){var a={};a.property=o.property||(o.aAllProperties.length&&o.aAllProperties[0].property);a.ascending=!o.ascending||(o.ascending===s.getText("ascending"));S.push(a);});this.step.setTopNSortProperties(S);},handleChangeForDataReduction:function(e){var i;if(e.getSource().getSelectedButton().getText()===this.getText("noDataReduction")){i=false;this._resetTopNFields();}else{this._setSortDataForStep();i=true;}this._changeVisibilityOfTopN(i);},_resetTopNFields:function(){this.step.resetTopN();var s=new sap.ui.model.json.JSONModel({aSortRows:[]});this.byId("idStepSortLayout").setModel(s);this.byId("idCustomRecordValue").setValue();},handleChangeForDataRecordInputValue:function(e){var i;if(e.getSource().getValue().trim().indexOf(".")!==-1||e.getSource().getValue().trim()<=0||e.getSource().getValue().trim()>10000){i="Error";}else{i="None";}e.getSource().setValueState(i);var s=[];this.byId("idStepSortLayout").getModel().getData().aSortRows.forEach(function(a){s.push({property:a.property,ascending:a.ascending});});if(s){this.step.setTopNValue(e.getSource().getValue());this.step.setTopNSortProperties(s);}this.oConfigurationEditor.setIsUnsaved();},_changeVisibilityOfTopN:function(i){this.byId("idCustomRecordValue").isMandatory=i;this.byId("idDataRecordsLabel").setVisible(i);this.byId("idDataRecordsLabel").setRequired(i);this.byId("idCustomRecordValue").setVisible(i);this.byId("idStepSortLayout").setVisible(i);},_setMandatoryFields:function(f){this.mandatoryFields=this.mandatoryFields||[];for(var i=0;i<f.length;i++){f[i].isMandatory=true;this.mandatoryFields.push(f[i]);}},_getMandatoryFields:function(){return this.mandatoryFields;},_setValidationState:function(){var m=this._getMandatoryFields();for(var i=0;i<m.length;i++){if(m[i].isMandatory===true){if(typeof m[i].getSelectedKeys==="function"){this.isValidState=(m[i].getSelectedKeys().length>=1)?true:false;}else if(typeof m[i].getValue==="function"){this.isValidState=(m[i].getValue().trim()!=="")?true:false;}else{this.isValidState=(m[i].getSelectedKey().length>=1)?true:false;}if(this.isValidState===false){break;}}}},getValidationState:function(){this._setValidationState();var i=(this.isValidState!==undefined)?this.isValidState:true;return i;}});};if(!jQuery.sap.isDeclared('sap.apf.modeler.ui.utils.APFTree')){
/*!
* SAP APF Analysis Path Framework
*
* (c) Copyright 2012-2014 SAP SE. All rights reserved
*/
jQuery.sap.declare('sap.apf.modeler.ui.utils.APFTree');sap.ui.getCore().loadLibrary("sap.ui.commons");sap.ui.commons.Tree.extend("sap.apf.modeler.ui.utils.APFTree",{metadata:{events:{},properties:{translationFunction:{},defaultRepresentationType:{},applicationId:{}}},renderer:function(c,r){sap.ui.commons.TreeRenderer.render(c,r);},setTranslationFunction:function(t){this.fnTranslationFunction=t;},setDefaultRepresentationType:function(d){this.defaultRepresentationType=d;},setApplicationId:function(a){this.applicationId=a;},getAPFTreeNodeContext:function(n){if(n){var N=n?n.getBindingContext():undefined;var o=N.getObject()?N.getObject().type:undefined;var O;if(N.getObject()&&N.getObject().id){O=N.getObject().id;}else if(N.getObject()&&N.getObject().AnalyticalConfiguration){O=N.getObject().AnalyticalConfiguration;}return{oNode:n,nodeContext:N.sPath,nodeObjectType:o,nodeTitle:n.getText(),nodeAPFId:O};}return null;},getParentNodeContext:function(s){var m=this.getModel();if(s!==null){var c=s.nodeContext.split('/')[2];var a=m.getData().aConfigDetails[c]?m.getData().aConfigDetails[c].AnalyticalConfiguration:undefined;var r;var b=s.nodeContext.split('/')[6];var f=s.nodeContext.split('/')[6];var n=s.nodeContext.split('/')[6];var d=s.nodeContext.split('/')[8];var S={};if(s!==null){switch(s.nodeObjectType){case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.FACETFILTER:S.facetFilterId=m.getData().aConfigDetails[c].configData[0].filters[f].id;S.configId=a;S.configurationName=m.getData().aConfigDetails[c].name;S.facetFilterName=m.getData().aConfigDetails[c].configData[0].filters[f].name;break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY:S.categoryId=m.getData().aConfigDetails[c].configData[1].categories[b].id;S.configId=a;S.configurationName=m.getData().aConfigDetails[c].name;S.categoryName=m.getData().aConfigDetails[c].configData[1].categories[b].name;break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP:S.configId=a;S.categoryId=m.getData().aConfigDetails[c].configData[1].categories[b].id;S.stepId=m.getData().aConfigDetails[c].configData[1].categories[b].steps[d].id;S.configurationName=m.getData().aConfigDetails[c].name;S.categoryName=m.getData().aConfigDetails[c].configData[1].categories[b].name;S.stepName=m.getData().aConfigDetails[c].configData[1].categories[b].steps[d].name;break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.REPRESENTATION:r=s.oNode;S.configId=a;S.categoryId=m.getData().aConfigDetails[c].configData[1].categories[b].id;S.stepId=m.getData().aConfigDetails[c].configData[1].categories[b].steps[d].id;S.representationId=r.getBindingContext().getObject().id;S.configurationName=m.getData().aConfigDetails[c].name;S.categoryName=m.getData().aConfigDetails[c].configData[1].categories[b].name;S.stepName=m.getData().aConfigDetails[c].configData[1].categories[b].steps[d].name;S.representationName=r.getBindingContext().getObject().name;break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION:S.configId=s.oNode.getBindingContext().getObject().AnalyticalConfiguration;S.configurationName=s.oNode.getBindingContext().getObject().name;break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.NAVIGATIONTARGET:S.navTargetId=m.getData().aConfigDetails[c].configData[2].navTargets[n].id;S.configId=a;S.configurationName=m.getData().aConfigDetails[c].name;S.navTargetName=m.getData().aConfigDetails[c].configData[2].navTargets[n].name;break;default:break;}if(m.getData().aConfigDetails&&m.getData().aConfigDetails[c]){S.appId=m.getData().aConfigDetails[c].Application;}}return S;}},isConfigurationSwitched:function(p,c){var i=false,P,a;var o=this.getParentNodeContext(this.getAPFTreeNodeContext(p));var C=this.getParentNodeContext(this.getAPFTreeNodeContext(c));P=o?o.configId:undefined;if(o&&!jQuery.isEmptyObject(o)&&o.configId===undefined){a=this.getAPFTreeNodeContext(p).nodeContext.split("/")[2];P=this.getModel().getData().aConfigDetails[a].AnalyticalConfiguration;}if(P!==undefined&&P!==C.configId){i=true;}return i;},removeSelectionOnTree:function(s){var S=this.getSelection();if(s){s.getBindingContext().getObject().isSelected=false;s.setIsSelected(false);}else if(S){S.getBindingContext().getObject().isSelected=false;S.setIsSelected(false);}this.getModel().updateBindings();},setSelectionOnTree:function(b){var c=this.getModel().getContext(b);this.selectedNode=this.getNodeByContext(c);var s=this.getSelection();if(s!==this.selectedNode){if(s&&s.getBindingContext().getObject()){s.getBindingContext().getObject().isSelected=false;s.setIsSelected(false);}this.selectedNode.setIsSelected(true);}},_scrollTreeToNewNode:function(n){if(n&&n.$().length!==0){jQuery(n.$())[0].scrollIntoView();}},setSelectedNode:function(n){var c=this.getModel().getContext(n.getBindingContext().sPath);this.setSelection(this.getNodeByContext(c));this._scrollTreeToNewNode(n);},_getObjectNodesArray:function(o,c,a,s){var O;switch(o){case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION:O=this.getNodes();break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.FACETFILTER:O=this.getNodes()[c].getNodes()[0].getNodes();break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY:O=this.getNodes()[c].getNodes()[1].getNodes();break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP:O=this.getNodes()[c].getNodes()[1].getNodes()[a].getNodes();break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.REPRESENTATION:O=this.getNodes()[c].getNodes()[1].getNodes()[a].getNodes()[s].getNodes();break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.NAVIGATIONTARGET:O=this.getNodes()[c].getNodes()[2].getNodes();break;default:break;}return O;},addNodeInTree:function(o,p){var m;var s=this.getAPFTreeNodeContext(this.getSelection());var c=s?s.nodeContext.split('/')[2]:undefined;var a=s?s.nodeContext.split('/')[6]:undefined;var b=s?s.nodeContext.split('/')[8]:undefined;m=["_add",o].join("");this[m](c,a,b,p);var O=this._getObjectNodesArray(o,c,a,b);var n=O[O.length-1];if(o!==sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION){if(n.getParent()){n.getParent().setExpanded(true);}}this.setSelectedNode(n);},_addconfiguration:function(){var s=this;this.configNewIndex=this.configNewIndex||1;var m=this.getModel();var i;i="I"+this.configNewIndex;this.configNewIndex++;var a=[],f=[],c=[],n=[];a.push({filters:f,name:s.fnTranslationFunction("facetFilters"),isSelected:false,expanded:false,selectable:false});a.push({categories:c,name:s.fnTranslationFunction("categories"),isSelected:false,expanded:false,selectable:false});a.push({navTargets:n,name:s.fnTranslationFunction("navigationTargets"),isSelected:false,expanded:false,selectable:false});var C={};C.configData=a;var b=this.fnTranslationFunction("newConfiguration");var d={name:"< "+b+" >",type:sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION,AnalyticalConfiguration:"newConfig"+i,Application:this.applicationId,configData:a,bIsLoaded:true,isSelected:false,expanded:false,selectable:true};m.getData().aConfigDetails.push(d);m.updateBindings();},_addfacetFilter:function(c){var m=this.getModel();var n=this.fnTranslationFunction("newFacetFilter");var i=m.getData().aConfigDetails[c].configData[0].filters.length;var a={name:"< "+n+" >",type:sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.FACETFILTER,id:"newFilter"+i,isSelected:false,selectable:true};m.getData().aConfigDetails[c].expanded=true;m.getData().aConfigDetails[c].configData[0].expanded=true;m.getData().aConfigDetails[c].configData[0].filters.push(a);m.updateBindings();},_addnavigationTarget:function(c){var m=this.getModel();var n=this.fnTranslationFunction("newNavigationTarget");var i=m.getData().aConfigDetails[c].configData[2].navTargets.length;var a={name:"< "+n+" >",type:sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.NAVIGATIONTARGET,id:"newNavTarget"+i,isSelected:false,selectable:true};m.getData().aConfigDetails[c].expanded=true;m.getData().aConfigDetails[c].configData[2].expanded=true;m.getData().aConfigDetails[c].configData[2].navTargets.push(a);m.updateBindings();},_addcategory:function(c){var m=this.getModel();var n=this.fnTranslationFunction("newCategory");var i=m.getData().aConfigDetails[c].configData[1].categories.length;var a={name:"< "+n+" >",type:sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY,id:"newCategory"+i,isSelected:false,expanded:false,selectable:true};m.getData().aConfigDetails[c].expanded=true;m.getData().aConfigDetails[c].configData[1].expanded=true;m.getData().aConfigDetails[c].configData[1].categories.push(a);m.updateBindings();},_addstep:function(c,a,s,p){var m=this.getModel();var n;if(m.getData().aConfigDetails[c].configData[1].categories[a].steps===undefined){m.getData().aConfigDetails[c].configData[1].categories[a].steps=[];}if(!p){var b=m.getData().aConfigDetails[c].configData[1].categories[a].steps.length;var d=this.fnTranslationFunction("newStep");n={name:"< "+d+" >",type:sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP,id:"newStep"+b,isSelected:false,expanded:false,selectable:true};m.getData().aConfigDetails[c].expanded=true;m.getData().aConfigDetails[c].configData[1].expanded=true;m.getData().aConfigDetails[c].configData[1].categories[a].expanded=true;m.getData().aConfigDetails[c].configData[1].categories[a].steps.push(n);}else{var e,i,j;for(i=0;i<p.noOfSteps;i++){e={name:p.aExistingStepsToBeAdded[i].step.name,type:sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP,id:p.aExistingStepsToBeAdded[i].step.id,isSelected:false,expanded:false,selectable:true};m.getData().aConfigDetails[c].configData[1].categories[a].steps.push(e);if(p.aExistingStepsToBeAdded[i].noOfReps!==0){s=m.getData().aConfigDetails[c].configData[1].categories[a].steps.length-1;for(j=0;j<p.aExistingStepsToBeAdded[i].noOfReps;j++){var r={id:p.aExistingStepsToBeAdded[i].representations[j].id,name:p.aExistingStepsToBeAdded[i].representations[j].name,icon:p.aExistingStepsToBeAdded[i].representations[j].icon};this._addrepresentation(c,a,s,r);}}}}m.updateBindings();},_addrepresentation:function(c,a,s,p){var m=this.getModel();var b=this;var d;if(p===undefined){var e=this.getAPFTreeNodeContext(this.getSelection());if(e.nodeObjectType===sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.REPRESENTATION){d=this.getParentNodeContext(e,m).stepId;}else if(e.nodeObjectType===sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP){d=e.nodeAPFId;}var S=[];m.getData().aConfigDetails[c].configData[1].categories.forEach(function(f,g){if(m.getData().aConfigDetails[c].configData[1].categories[g].steps){m.getData().aConfigDetails[c].configData[1].categories[g].steps.forEach(function(h,i){var j={};if(h.id===d){j.stepIndex=i;j.categoryIndex=g;S.push(j);}});}});S.forEach(function(f){if(m.getData().aConfigDetails[c].configData[1].categories[f.categoryIndex].steps[f.stepIndex].representations===undefined){m.getData().aConfigDetails[c].configData[1].categories[f.categoryIndex].steps[f.stepIndex].representations=[];}var i=m.getData().aConfigDetails[c].configData[1].categories[f.categoryIndex].steps[f.stepIndex].representations.length;var n={name:b.fnTranslationFunction(b.defaultRepresentationType),type:sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.REPRESENTATION,id:"newRepresentation"+i,isSelected:false,selectable:true};m.getData().aConfigDetails[c].expanded=true;m.getData().aConfigDetails[c].configData[1].expanded=true;m.getData().aConfigDetails[c].configData[1].categories[f.categoryIndex].expanded=true;m.getData().aConfigDetails[c].configData[1].categories[f.categoryIndex].steps[f.stepIndex].expanded=true;m.getData().aConfigDetails[c].configData[1].categories[f.categoryIndex].steps[f.stepIndex].representations.push(n);});}else{if(m.getData().aConfigDetails[c].configData[1].categories[a].steps[s].representations===undefined){m.getData().aConfigDetails[c].configData[1].categories[a].steps[s].representations=[];}var r={name:p.name,type:sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.REPRESENTATION,id:p.id,isSelected:false,selectable:true,icon:p.icon};m.getData().aConfigDetails[c].configData[1].categories[a].steps[s].representations.push(r);}m.updateBindings();}});};if(!jQuery.sap.isDeclared('sap.apf.ui.representations.BaseUI5ChartRepresentation')){jQuery.sap.declare("sap.apf.ui.representations.BaseUI5ChartRepresentation");sap.apf.ui.representations.BaseUI5ChartRepresentation=function(a,p){this.oMessageObject="";this.legendBoolean=true;this.aDataResponse=undefined;this.dataset={};this.oModel=new sap.ui.model.json.JSONModel();this.bDataHasBeenSelected=false;this.parameter=p;this.orderby=p.orderby;this.dimension=p.dimensions;this.measure=p.measures;this.alternateRepresentation=p.alternateRepresentationType;this.requiredFilters=p.requiredFilters;this.UI5ChartHelper=new sap.apf.ui.representations.utils.UI5ChartHelper(a,this.parameter);this.chartInstance={};this.chartParam="";this.thumbnailChartParam="";this.disableSelectEvent=false;this.oApi=a;this.showXaxisLabel=true;this.axisType=sap.apf.ui.utils.CONSTANTS.axisTypes.AXIS;this.topN=p.top;};sap.apf.ui.representations.BaseUI5ChartRepresentation.prototype={getParameter:function(){return this.parameter;},setData:function(d,m){this.bIsGroupTypeChart=this.getIsGroupTypeChart();this.oDataSetHelper=this.getDataSetHelper();this.formatter=new sap.apf.ui.utils.formatter({getEventCallback:this.oApi.getEventCallback.bind(this.oApi),getTextNotHtmlEncoded:this.oApi.getTextNotHtmlEncoded},m,d);this.UI5ChartHelper.init(d,m,this.bIsGroupTypeChart,this.oDataSetHelper,this.formatter);this.aDataResponse=d||[];this.metadata=m;if(!this.metadata){this.oMessageObject=this.oApi.createMessageObject({code:"6004",aParameters:[this.oApi.getTextNotHtmlEncoded("step")]});this.oApi.putMessage(this.oMessageObject);}},attachSelectionAndFormatValue:function(s){var a=this;if(!s){this.oMessageObject=this.oApi.createMessageObject({code:"6002",aParameters:["title",this.oApi.getTextNotHtmlEncoded("step")]});this.oApi.putMessage(this.oMessageObject);}if(this.dimension.length===0){this.oMessageObject=this.oApi.createMessageObject({code:"6002",aParameters:["dimensions",s]});this.oApi.putMessage(this.oMessageObject);}if(this.measure.length===0){this.oMessageObject=this.oApi.createMessageObject({code:"6002",aParameters:["measures",s]});this.oApi.putMessage(this.oMessageObject);}if(!this.aDataResponse||this.aDataResponse.length===0){this.oMessageObject=this.oApi.createMessageObject({code:"6000",aParameters:[s]});this.oApi.putMessage(this.oMessageObject);}this.fnHandleSelection=this.handleSelection.bind(a);this.chart.attachSelectData(this.fnHandleSelection);this.fnHandleDeselection=this.handleDeselection.bind(a);this.chart.attachDeselectData(this.fnHandleDeselection);},getFormatStringForMeasure:function(m){var f=this.formatter.getFormatString(m);return f;},getIsAllMeasureSameUnit:function(){var a=true;var s=this;var f=this.metadata.getPropertyMetadata(this.measure[0].fieldName).unit?this.metadata.getPropertyMetadata(this.metadata.getPropertyMetadata(this.measure[0].fieldName).unit).semantics:undefined;var m;this.measure.forEach(function(b,i){m=s.metadata.getPropertyMetadata(s.measure[i].fieldName).unit?s.metadata.getPropertyMetadata(s.metadata.getPropertyMetadata(b.fieldName).unit).semantics:undefined;if(a&&f!==undefined&&m&&(f!==m)){a=false;}});return a;},createThumbnailLayout:function(){this.thumbnailLayout=new sap.ui.layout.HorizontalLayout().addStyleClass('thumbnailLayout');this.thumbnailLayout.removeAllContent();if(this.aDataResponse!==undefined&&this.aDataResponse.length!==0){this.thumbnailChart.setModel(this.oModel);this.thumbnailLayout.addContent(this.thumbnailChart);this.thumbnailChart.removeStyleClass('thumbnailNoData');}else{var n=new sap.m.Text({text:this.oApi.getTextNotHtmlEncoded("noDataText")}).addStyleClass('noDataText');this.thumbnailLayout.addContent(n);this.thumbnailLayout.addContent(this.thumbnailChart);this.thumbnailChart.addStyleClass('thumbnailNoData');}},getAlternateRepresentation:function(){return this.alternateRepresentation;},getMetaData:function(){return this.metadata;},getData:function(){return this.aDataResponse;},getRequestOptions:function(){var o={};if(this.orderby&&this.orderby.length){var O=this.orderby.map(function(a){return{property:a.property,descending:!a.ascending};});o.orderby=O}if(this.topN&&this.topN>0){o.paging={};o.paging.top=this.topN;}return o;},createDataset:function(){this.dataset=this.UI5ChartHelper.getDataset();this.oModel=this.UI5ChartHelper.getModel();},drawSelectionOnMainChart:function(){var s=this.UI5ChartHelper.getSelectionFromFilter(this.filter);if(s.length>0){this.disableSelectEvent=true;this.setSelectionOnMainChart(s);}},drawSelectionOnThumbnailChart:function(){var s=this.UI5ChartHelper.getSelectionFromFilter(this.filter);if(s.length>0){this.clearSelectionFromThumbnailChart();this.setSelectionOnThumbnailChart(s);}},handleSelection:function(e){if(!this.disableSelectEvent){var s=this.getSelectionFromChart();var c=this.UI5ChartHelper.getHighlightPointsFromSelectionEvent(s);this.setSelectionOnThumbnailChart(c);this.setSelectionOnMainChart(c);this.bDataHasBeenSelected=true;this.oApi.selectionChanged();}else{this.disableSelectEvent=false;}},handleDeselection:function(e){if(!this.disableSelectEvent){this.disableSelectEvent=true;var s=this.getSelectionFromChart();var n=this.UI5ChartHelper.getHighlightPointsFromDeselectionEvent(s);this.removeAllSelection();this.setSelectionOnThumbnailChart(n);this.setSelectionOnMainChart(n);if(!n.length){this.disableSelectEvent=false;}this.bDataHasBeenSelected=true;this.oApi.selectionChanged();}else{this.disableSelectEvent=false;}},getSelections:function(){return this.UI5ChartHelper.getFilters();},getSelectionCount:function(){return this.UI5ChartHelper.getFilterCount();},hasSelection:function(){return this.bDataHasBeenSelected;},removeAllSelection:function(){this.clearSelectionFromThumbnailChart();this.clearSelectionFromMainChart();},getFilterMethodType:function(){return sap.apf.core.constants.filterMethodTypes.filter;},getFilter:function(){this.filter=this.UI5ChartHelper.getFilterFromSelection();return this.filter;},setFilter:function(f){this.filter=f;this.bDataHasBeenSelected=false;},adoptSelection:function(s){if(s&&s.getFilter){this.UI5ChartHelper.filterValues=s.getFilter().getInternalFilter().getFilterTerms().map(function(t){return[t.getValue()];});}},serialize:function(){return{oFilter:this.UI5ChartHelper.filterValues,bIsAlternateView:this.bIsAlternateView};},deserialize:function(s){this.UI5ChartHelper.filterValues=s.oFilter;this.bIsAlternateView=s.bIsAlternateView;},getPrintContent:function(s){var c,v=this.chartType,a={};var o=this.getMainContent(s);if(o.setVizProperties){a=o.getVizProperties();c=o.clone();c.setVizType(v);c.setVizProperties(a);}else{a=jQuery.extend(true,{},this.chartParam);delete a.dataset;c=new sap.viz.ui5[v](a);}c.setWidth("1000px");c.setHeight("600px");this.createDataset();c.setDataset(this.dataset);c.setModel(this.oModel);return{oChartForPrinting:c,aSelectionOnChart:this.aStoredSelection};},destroy:function(){this.dataset=null;this.oModel.destroy();this.oDataSetHelper=null;if(this.formatter){this.formatter.destroy();this.formatter=null;}this.UI5ChartHelper.destroy();this.UI5ChartHelper=null;if(this.chart){this.chart.detachSelectData(this.fnHandleSelection);this.fnHandleSelection=null;this.chart.detachDeselectData(this.fnHandleDeselection);this.fnHandleDeselection=null;this.chart.destroy();this.chart=null;}if(this.thumbnailChart){this.thumbnailChart.destroy();this.thumbnailChart=null;}if(this.thumbnailLayout){this.thumbnailLayout.removeAllContent();}}};};if(!jQuery.sap.isDeclared('sap.apf.ui.representations.BaseVizChartRepresentation')){jQuery.sap.declare("sap.apf.ui.representations.BaseVizChartRepresentation");(function(){'use strict';sap.apf.ui.representations.BaseVizChartRepresentation=function(a,p){sap.apf.ui.representations.BaseUI5ChartRepresentation.apply(this,[a,p]);};sap.apf.ui.representations.BaseVizChartRepresentation.prototype=Object.create(sap.apf.ui.representations.BaseUI5ChartRepresentation.prototype);sap.apf.ui.representations.BaseVizChartRepresentation.prototype.constructor=sap.apf.ui.representations.BaseVizChartRepresentation;sap.apf.ui.representations.BaseVizChartRepresentation.prototype.destroy=function(){if(this.chart){if(this.chart.getTitle&&this.chart.getTitle()){this.chart.destroyTitle();}if(this.chart.getXAxis&&this.chart.getXAxis()){this.chart.destroyXAxis();}if(this.chart.getYAxis&&this.chart.getYAxis()){this.chart.destroyYAxis();}if(this.chart.getLegend&&this.chart.getLegend()){this.chart.destroyLegend();}if(this.chart.getPlotArea&&this.chart.getPlotArea()){this.chart.destroyPlotArea();}this.chart.detachInitialized(this.fnDrawSelectionOnMainChart);this.fnDrawSelectionOnMainChart=null;}if(this.thumbnailChart){if(this.thumbnailChart.getTitle&&this.thumbnailChart.getTitle()){this.thumbnailChart.destroyTitle();}if(this.thumbnailChart.getXAxis&&this.thumbnailChart.getXAxis()){this.thumbnailChart.destroyXAxis();}if(this.thumbnailChart.getYAxis&&this.thumbnailChart.getYAxis()){this.thumbnailChart.destroyYAxis();}if(this.thumbnailChart.getLegend&&this.thumbnailChart.getLegend()){this.thumbnailChart.destroyLegend();}if(this.thumbnailChart.getToolTip&&this.thumbnailChart.getToolTip()){this.thumbnailChart.destroyToolTip();}if(this.thumbnailChart.getInteraction&&this.thumbnailChart.getInteraction()){this.thumbnailChart.destroyInteraction();}if(this.thumbnailChart.getBackground&&this.thumbnailChart.getBackground()){this.thumbnailChart.destroyBackground();}if(this.thumbnailChart.getGeneral&&this.thumbnailChart.getGeneral()){this.thumbnailChart.destroyGeneral();}if(this.thumbnailChart.getPlotArea&&this.thumbnailChart.getPlotArea()){this.thumbnailChart.destroyPlotArea();}this.thumbnailChart.detachInitialized(this.fnDrawSelectionOnThumbnailChart);this.fnDrawSelectionOnThumbnailChart=null;}sap.apf.ui.representations.BaseUI5ChartRepresentation.prototype.destroy.call(this);};sap.apf.ui.representations.BaseVizChartRepresentation.prototype.getMeasures=function(){return this.measure;};sap.apf.ui.representations.BaseVizChartRepresentation.prototype.getMainContent=function(s,w,h){var a=this;var b=this;var c=h||600;c=c+"px";var d=w||1000;d=d+"px";this.title=s;if(!this.chartType){this.chartType=this.getChartTypeFromRepresentationType(this.type);}this.createDataset();if(!this.chart){this.chartParam={width:d,height:c,title:{visible:true,text:this.title},xAxis:{title:{visible:true},label:{visible:this.showXaxisLabel}},yAxis:{title:{visible:true}},legend:{visible:this.legendBoolean,title:{visible:this.legendBoolean}},plotArea:{animation:{dataLoading:false,dataUpdating:false}},dataset:this.dataset};this.chart=new sap.viz.ui5[this.chartType](this.chartParam);this.validateSelectionModes();if(this.metadata){var t=[];this.measure.forEach(function(m){var f=b.getFormatStringForMeasure(m);t.push([f]);a.setFormatStringOnChart(f);});this.setFormatString("tooltip",t);if(this.handleCustomFormattingOnChart){this.handleCustomFormattingOnChart();}}this.fnDrawSelectionOnMainChart=this.drawSelectionOnMainChart.bind(a);this.chart.attachInitialized(this.fnDrawSelectionOnMainChart);b.attachSelectionAndFormatValue.call(this,s);}else{if(w){this.chart.setWidth(d);}if(h){this.chart.setHeight(c);}this.chart.destroyDataset();this.chart.setDataset(this.dataset);}this.chart.setModel(this.oModel);return this.chart;};sap.apf.ui.representations.BaseVizChartRepresentation.prototype.validateSelectionModes=function(){var s=new sap.viz.ui5.types.controller.Interaction_selectability();var i=new sap.viz.ui5.types.controller.Interaction();i.setSelectability(s);this.chart.setInteraction(i);if(this.parameter.requiredFilters===undefined||this.parameter.requiredFilters.length===0){s.setMode("none");}else{s.setMode("multiple");if(this.parameter.dimensions.length>1){if(this.parameter.requiredFilters[0]===this.parameter.dimensions[1].fieldName){s.setAxisLabelSelection(false);}else if(this.parameter.requiredFilters[0]===this.parameter.dimensions[0].fieldName){s.setLegendSelection(false);}}}};sap.apf.ui.representations.BaseVizChartRepresentation.prototype.getThumbnailContent=function(){var s=this;var a=this;var h=sap.apf.ui.utils.CONSTANTS.thumbnailDimensions.HEIGHT;var w=sap.apf.ui.utils.CONSTANTS.thumbnailDimensions.WIDTH;if(!this.chartType){this.chartType=this.getChartTypeFromRepresentationType(this.type);}this.createDataset();if(!this.thumbnailChart){this.thumbnailChartParam={width:w,height:h,title:{visible:false},xAxis:{visible:false,title:{visible:false}},yAxis:{visible:false,title:{visible:false}},legend:{visible:false,title:{visible:false}},sizeLegend:{visible:false,title:{visible:false}},toolTip:{visible:false},interaction:{selectability:{axisLabelSelection:false,legendSelection:false,plotLassoSelection:false,plotStdSelection:false},enableHover:false},background:{visible:false},general:{layout:{padding:0}},plotArea:{animation:{dataLoading:false,dataUpdating:false},markerSize:4,marker:{visible:true,size:4}},dataset:this.dataset};this.thumbnailChart=new sap.viz.ui5[this.chartType](this.thumbnailChartParam);this.fnDrawSelectionOnThumbnailChart=this.drawSelectionOnThumbnailChart.bind(s);this.thumbnailChart.attachInitialized(this.fnDrawSelectionOnThumbnailChart);}else{this.thumbnailChart.destroyDataset();this.thumbnailChart.setDataset(this.dataset);}a.createThumbnailLayout.call(this);return this.thumbnailLayout;};sap.apf.ui.representations.BaseVizChartRepresentation.prototype.setSelectionOnMainChart=function(s){this.chart.selection(s);};sap.apf.ui.representations.BaseVizChartRepresentation.prototype.setSelectionOnThumbnailChart=function(s){this.aStoredSelection=s;this.clearSelectionFromThumbnailChart();this.thumbnailChart.selection(s);};sap.apf.ui.representations.BaseVizChartRepresentation.prototype.clearSelectionFromMainChart=function(){this.chart.selection([],{clearSelection:true});};sap.apf.ui.representations.BaseVizChartRepresentation.prototype.clearSelectionFromThumbnailChart=function(){this.thumbnailChart.selection([],{clearSelection:true});};sap.apf.ui.representations.BaseVizChartRepresentation.prototype.getSelectionFromChart=function(){var s=this.chart.selection();return s;};sap.apf.ui.representations.BaseVizChartRepresentation.prototype.setFormatStringOnChart=function(f){var s=this;var a=s.getIsAllMeasureSameUnit();if(this.chart.getYAxis!==undefined&&f!==""&&a){this.setFormatString("yAxis",f);}};sap.apf.ui.representations.BaseVizChartRepresentation.prototype.setFormatString=function(c,f){var C;switch(c){case"xAxis":C=this.chart.getYAxis().getLabel();break;case"yAxis":C=this.chart.getXAxis().getLabel();break;case"tooltip":C=this.chart.getToolTip();break;case"sizeLegend":C=this.chart.getSizeLegend().getLabel();break;default:break;}C.setFormatString(f);};sap.apf.ui.representations.BaseVizChartRepresentation.prototype.getFormatString=function(m){var f=this.getFormatStringForMeasures(m);return f.labelFormatString;};sap.apf.ui.representations.BaseVizChartRepresentation.prototype.getChartTypeFromRepresentationType=function(r){var R=sap.apf.ui.utils.CONSTANTS.representationTypes;var v=sap.apf.ui.utils.CONSTANTS.vizChartTypes;var V;switch(r){case R.COLUMN_CHART:V=v.COLUMN;break;case R.LINE_CHART:V=v.LINE;break;case R.PIE_CHART:V=v.PIE;break;case R.STACKED_COLUMN_CHART:V=v.STACKED_COLUMN;break;case R.PERCENTAGE_STACKED_COLUMN_CHART:V=v.PERCENTAGE_STACKED_COLUMN;break;case R.SCATTERPLOT_CHART:V=v.SCATTERPLOT;break;case R.BUBBLE_CHART:V=v.BUBBLE;break;default:this.oMessageObject=this.oApi.createMessageObject({code:"6000",aParameters:[r]});this.oApi.putMessage(this.oMessageObject);break;}return V;};sap.apf.ui.representations.BaseVizChartRepresentation.prototype.getIsGroupTypeChart=function(){var i;if(this.axisType===sap.apf.ui.utils.CONSTANTS.axisTypes.AXIS){i=false;}else{i=true;}return i;};sap.apf.ui.representations.BaseVizChartRepresentation.prototype.getDataSetHelper=function(){var i=this.getIsGroupTypeChart();var d=new sap.apf.ui.representations.utils.VizDatasetHelper(i);return d;};}());};if(!jQuery.sap.isDeclared('sap.apf.ui.representations.BaseVizFrameChartRepresentation')){jQuery.sap.declare("sap.apf.ui.representations.BaseVizFrameChartRepresentation");(function(){'use strict';sap.apf.ui.representations.BaseVizFrameChartRepresentation=function(a,p){sap.apf.ui.representations.BaseUI5ChartRepresentation.apply(this,[a,p]);};sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype=Object.create(sap.apf.ui.representations.BaseUI5ChartRepresentation.prototype);sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype.constructor=sap.apf.ui.representations.BaseVizFrameChartRepresentation;sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype.destroy=function(){if(this.chart){this.chart.destroyDataset();this.chart.destroyFeeds();this.chart.detachRenderComplete(this.fnDrawSelectionOnMainChart);this.fnDrawSelectionOnMainChart=null;}if(this.thumbnailChart){this.thumbnailChart.destroyDataset();this.thumbnailChart.destroyFeeds();this.thumbnailChart.detachRenderComplete(this.fnDrawSelectionOnThumbnailChart);this.fnDrawSelectionOnThumbnailChart=null;}sap.apf.ui.representations.BaseUI5ChartRepresentation.prototype.destroy.call(this);};sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype.getMeasures=function(){return this.measure;};sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype.getMainContent=function(s,w,h){var a=this;var b=this;var c=h||600;c=c+"px";var d=w||1000;d=d+"px";this.title=s;this.createDataset();if(!this.chart){this.chart=new sap.viz.ui5.controls.VizFrame({vizType:this.chartType,dataset:this.dataset,width:d,height:c,uiConfig:{applicationSet:"fiori"}});this.setVizPropertiesOnChart();this.fnDrawSelectionOnMainChart=this.drawSelectionOnMainChart.bind(a);this.chart.attachRenderComplete(this.fnDrawSelectionOnMainChart);if(this.metadata){var m={};var f;this.measure.forEach(function(e){var F=b.getFormatStringForMeasure(e);f=F;m.measure=e;m.formatString=F;a.setFormatStringOnChart(m);});this.setFormatString("tooltip",f);if(this.handleCustomFormattingOnChart){this.handleCustomFormattingOnChart();}}b.attachSelectionAndFormatValue.call(this,s);}else{if(w){this.chart.setWidth(d);}if(h){this.chart.setHeight(c);}this.chart.destroyDataset();this.chart.removeAllFeeds();this.chart.destroyFeeds();this.chart.vizUpdate({'data':this.dataset});}this._createAndAddFeedItemBasedOnId(this.chart);this.chart.setModel(this.oModel);return this.chart;};sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype.setVizPropertiesOnChart=function(){this.chart.setVizProperties({title:{visible:true,text:this.title},categoryAxis:{visible:true,title:{visible:true},label:{visible:true}},valueAxis:{visible:true,title:{visible:true},label:{visible:true}},legend:{visible:this.legendBoolean,title:{visible:this.legendBoolean},isScrollable:true},plotArea:{isFixedDataPointSize:false},tooltip:{visible:true,label:{visible:true}},interaction:{behaviorType:null},general:{groupData:false}});this.validateSelectionModes();this.setVizPropsForSpecificRepresentation();};sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype.setVizPropsForSpecificRepresentation=function(){};sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype.setFormatStringOnChart=function(m){var f=m.formatString;var c=m.measure.axisfeedItemId;this.setFormatString(c,f);};sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype.setFormatString=function(c,f){var s=this;var i=s.getIsAllMeasureSameUnit();switch(c){case sap.apf.core.constants.vizFrame.feedItemTypes.VALUEAXIS:if(i){this.chart.setVizProperties({valueAxis:{label:{formatString:f}}});}break;case sap.apf.core.constants.vizFrame.feedItemTypes.VALUEAXIS2:if(i){this.chart.setVizProperties({valueAxis2:{label:{formatString:f}}});}break;case sap.apf.core.constants.vizFrame.feedItemTypes.CATEGORYAXIS:this.chart.setVizProperties({categoryAxis:{label:{formatString:f}}});break;case sap.apf.core.constants.vizFrame.feedItemTypes.BUBBLEWIDTH:this.chart.setVizProperties({sizeLegend:{formatString:f}});break;case"tooltip":this.chart.setVizProperties({tooltip:{formatString:f}});break;default:break;}};sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype._createAndAddFeedItemBasedOnId=function(c){var s=this._createFeedItemGroup(this.parameter.measures);this._addFeedItemsToChart(c,s,"Measure");var a=this._createFeedItemGroup(this.parameter.dimensions);this._addFeedItemsToChart(c,a,"Dimension");};sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype._createFeedItemGroup=function(d){var s=this;var a={};d.forEach(function(b){b.axisfeedItemId=s.getAxisFeedItemId(b.kind);var f=a[b.axisfeedItemId];if(f){var F=f.some(function(D){return D.name===b.name;});if(!F){f.push(b);}}else{a[b.axisfeedItemId]=[b];}});return a;};sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype._addFeedItemsToChart=function(c,g,f){for(var k in g){var F={};var a=[];var i=0;for(i in g[k]){a.push(g[k][i].name);F.feedItemId=g[k][0].axisfeedItemId;}F.value=a;var b=new sap.viz.ui5.controls.common.feeds.FeedItem({uid:F.feedItemId,type:f,values:F.value});c.addFeed(b);}};sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype.validateSelectionModes=function(){if(this.parameter.requiredFilters===undefined||this.parameter.requiredFilters.length===0){this.chart.setVizProperties({interaction:{selectability:{mode:'none'},behaviorType:null}});}else{this.chart.setVizProperties({interaction:{selectability:{mode:'multiple'},behaviorType:null}});if(this.parameter.dimensions.length>1){if(this.parameter.requiredFilters[0]===this.parameter.dimensions[1].fieldName){this.chart.setVizProperties({interaction:{selectability:{axisLabelSelection:false}}});}else if(this.parameter.requiredFilters[0]===this.parameter.dimensions[0].fieldName){this.chart.setVizProperties({interaction:{selectability:{legendSelection:false}}});}}}};sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype.getThumbnailContent=function(){var s=this;var a=this;var h=sap.apf.ui.utils.CONSTANTS.thumbnailDimensions.HEIGHT;var w=sap.apf.ui.utils.CONSTANTS.thumbnailDimensions.WIDTH;this.createDataset();if(!this.thumbnailChart){this.thumbnailChart=new sap.viz.ui5.controls.VizFrame({vizType:this.chartType,width:w,height:h,dataset:this.dataset,uiConfig:{applicationSet:"fiori"}});this.setVizPropertiesOnThumbnailChart();this.fnDrawSelectionOnThumbnailChart=this.drawSelectionOnThumbnailChart.bind(s);this.thumbnailChart.attachRenderComplete(this.fnDrawSelectionOnThumbnailChart);}else{this.thumbnailChart.destroyDataset();this.thumbnailChart.removeAllFeeds();this.thumbnailChart.destroyFeeds();this.thumbnailChart.vizUpdate({'data':this.dataset});}this._createAndAddFeedItemBasedOnId(this.thumbnailChart);a.createThumbnailLayout.call(this);return this.thumbnailLayout;};sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype.setVizPropertiesOnThumbnailChart=function(){this.thumbnailChart.setVizProperties({title:{visible:false},categoryAxis:{visible:false,title:{visible:false}},valueAxis:{visible:false,title:{visible:false}},legend:{visible:false,title:{visible:false}},tooltip:{visible:false},interaction:{selectability:{axisLabelSelection:false,legendSelection:false,plotLassoSelection:false,plotStdSelection:false},enableHover:false},background:{visible:false},general:{layout:{padding:0},groupData:false},plotArea:{isFixedDataPointSize:false,gridline:{visible:false},dataLabel:{visible:false},lineStyle:{rules:[{properties:{width:1}}]}}});this.setVizPropsOfThumbnailForSpecificRepresentation();};sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype.setVizPropsOfThumbnailForSpecificRepresentation=function(){};sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype.setSelectionOnMainChart=function(s){this.chart.vizSelection(s);};sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype.setSelectionOnThumbnailChart=function(s){this.aStoredSelection=s;this.clearSelectionFromThumbnailChart();this.thumbnailChart.vizSelection(s);};sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype.clearSelectionFromMainChart=function(){this.chart.vizSelection([],{clearSelection:true});};sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype.clearSelectionFromThumbnailChart=function(){this.thumbnailChart.vizSelection([],{clearSelection:true});};sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype.getSelectionFromChart=function(){var s=this.chart.vizSelection();return s;};sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype.getIsGroupTypeChart=function(){return this.bIsGroupTypeChart?this.bIsGroupTypeChart:false;};sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype.getDataSetHelper=function(){return new sap.apf.ui.representations.utils.vizFrameDatasetHelper();};sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype.getAxisFeedItemId=function(k){};}());};if(!jQuery.sap.isDeclared('sap.apf.ui.representations.barChart')){jQuery.sap.declare("sap.apf.ui.representations.barChart");sap.apf.ui.representations.barChart=function(a,p){sap.apf.ui.representations.BaseVizFrameChartRepresentation.apply(this,[a,p]);this.type=sap.apf.ui.utils.CONSTANTS.representationTypes.BAR_CHART;this.chartType=sap.apf.ui.utils.CONSTANTS.vizFrameChartTypes.BAR;this._addDefaultKind();};sap.apf.ui.representations.barChart.prototype=Object.create(sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype);sap.apf.ui.representations.barChart.prototype.constructor=sap.apf.ui.representations.barChart;sap.apf.ui.representations.barChart.prototype._addDefaultKind=function(){this.parameter.measures.forEach(function(m){if(m.kind===undefined){m.kind=sap.apf.core.constants.representationMetadata.kind.YAXIS;}});this.parameter.dimensions.forEach(function(d,i){if(d.kind===undefined){d.kind=i===0?sap.apf.core.constants.representationMetadata.kind.XAXIS:sap.apf.core.constants.representationMetadata.kind.LEGEND;}});};sap.apf.ui.representations.barChart.prototype.getAxisFeedItemId=function(k){var s=sap.apf.core.constants.representationMetadata.kind;var a;switch(k){case s.XAXIS:a=sap.apf.core.constants.vizFrame.feedItemTypes.CATEGORYAXIS;break;case s.YAXIS:a=sap.apf.core.constants.vizFrame.feedItemTypes.VALUEAXIS;break;case s.LEGEND:a=sap.apf.core.constants.vizFrame.feedItemTypes.COLOR;break;default:break;}return a;};};if(!jQuery.sap.isDeclared('sap.apf.ui.representations.bubbleChart')){jQuery.sap.declare("sap.apf.ui.representations.bubbleChart");sap.apf.ui.representations.bubbleChart=function(a,p){sap.apf.ui.representations.BaseVizFrameChartRepresentation.apply(this,[a,p]);this.type=sap.apf.ui.utils.CONSTANTS.representationTypes.BUBBLE_CHART;this.chartType=sap.apf.ui.utils.CONSTANTS.vizFrameChartTypes.BUBBLE;this.bIsGroupTypeChart=true;this._addDefaultKind();};sap.apf.ui.representations.bubbleChart.prototype=Object.create(sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype);sap.apf.ui.representations.bubbleChart.prototype.constructor=sap.apf.ui.representations.bubbleChart;sap.apf.ui.representations.bubbleChart.prototype._addDefaultKind=function(){this.parameter.measures.forEach(function(m,i){if(m.kind===undefined){if(i===0){m.kind=sap.apf.core.constants.representationMetadata.kind.XAXIS;}else if(i===1){m.kind=sap.apf.core.constants.representationMetadata.kind.YAXIS;}else if(i===2){m.kind=sap.apf.core.constants.vizFrame.feedItemTypes.BUBBLEWIDTH;}else{m.kind=sap.apf.core.constants.vizFrame.feedItemTypes.BUBBLEHEIGTH;}}});this.parameter.dimensions.forEach(function(d,i){if(d.kind===undefined){d.kind=i===0?sap.apf.core.constants.representationMetadata.kind.REGIONCOLOR:sap.apf.core.constants.representationMetadata.kind.REGIONSHAPE;}});};sap.apf.ui.representations.bubbleChart.prototype.setVizPropsForSpecificRepresentation=function(){this.chart.setVizProperties({valueAxis2:{visible:true,title:{visible:true},label:{visible:true}},sizeLegend:{visible:true},plotArea:{adjustScale:true}});};sap.apf.ui.representations.bubbleChart.prototype.setVizPropsOfThumbnailForSpecificRepresentation=function(){this.thumbnailChart.setVizProperties({sizeLegend:{visible:false},valueAxis2:{visible:false,title:{visible:false}},plotArea:{markerSize:4,marker:{visible:true,size:4},adjustScale:true}});};sap.apf.ui.representations.bubbleChart.prototype.getAxisFeedItemId=function(k){var s=sap.apf.core.constants.representationMetadata.kind;var a;switch(k){case s.REGIONCOLOR:a=sap.apf.core.constants.vizFrame.feedItemTypes.COLOR;break;case s.REGIONSHAPE:a=sap.apf.core.constants.vizFrame.feedItemTypes.SHAPE;break;case s.XAXIS:a=sap.apf.core.constants.vizFrame.feedItemTypes.VALUEAXIS;break;case s.YAXIS:a=sap.apf.core.constants.vizFrame.feedItemTypes.VALUEAXIS2;break;case s.BUBBLEWIDTH:a=sap.apf.core.constants.vizFrame.feedItemTypes.BUBBLEWIDTH;break;case s.BUBBLEHEIGHT:a=sap.apf.core.constants.vizFrame.feedItemTypes.BUBBLEHEIGHT;break;default:break;}return a;};};if(!jQuery.sap.isDeclared('sap.apf.ui.representations.columnChart')){jQuery.sap.declare("sap.apf.ui.representations.columnChart");sap.apf.ui.representations.columnChart=function(a,p){sap.apf.ui.representations.BaseVizFrameChartRepresentation.apply(this,[a,p]);this.type=sap.apf.ui.utils.CONSTANTS.representationTypes.COLUMN_CHART;this.chartType=sap.apf.ui.utils.CONSTANTS.vizFrameChartTypes.COLUMN;this._addDefaultKind();};sap.apf.ui.representations.columnChart.prototype=Object.create(sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype);sap.apf.ui.representations.columnChart.prototype.constructor=sap.apf.ui.representations.columnChart;sap.apf.ui.representations.columnChart.prototype._addDefaultKind=function(){this.parameter.measures.forEach(function(m){if(m.kind===undefined){m.kind=sap.apf.core.constants.representationMetadata.kind.YAXIS;}});this.parameter.dimensions.forEach(function(d,i){if(d.kind===undefined){d.kind=i===0?sap.apf.core.constants.representationMetadata.kind.XAXIS:sap.apf.core.constants.representationMetadata.kind.LEGEND;}});};sap.apf.ui.representations.columnChart.prototype.getAxisFeedItemId=function(k){var s=sap.apf.core.constants.representationMetadata.kind;var a;switch(k){case s.XAXIS:a=sap.apf.core.constants.vizFrame.feedItemTypes.CATEGORYAXIS;break;case s.YAXIS:a=sap.apf.core.constants.vizFrame.feedItemTypes.VALUEAXIS;break;case s.LEGEND:a=sap.apf.core.constants.vizFrame.feedItemTypes.COLOR;break;default:break;}return a;};};if(!jQuery.sap.isDeclared('sap.apf.ui.representations.heatmapChart')){jQuery.sap.declare("sap.apf.ui.representations.heatmapChart");sap.apf.ui.representations.heatmapChart=function(a,p){sap.apf.ui.representations.BaseVizFrameChartRepresentation.apply(this,[a,p]);this.type=sap.apf.ui.utils.CONSTANTS.representationTypes.HEATMAP_CHART;this.chartType=sap.apf.ui.utils.CONSTANTS.vizFrameChartTypes.HEATMAP;this._addDefaultKind();};sap.apf.ui.representations.heatmapChart.prototype=Object.create(sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype);sap.apf.ui.representations.heatmapChart.prototype.constructor=sap.apf.ui.representations.heatmapChart;sap.apf.ui.representations.heatmapChart.prototype._addDefaultKind=function(){this.parameter.measures.forEach(function(m){if(m.kind===undefined){m.kind=sap.apf.core.constants.representationMetadata.kind.SECTORCOLOR;}});this.parameter.dimensions.forEach(function(d,i){if(d.kind===undefined){d.kind=i===0?sap.apf.core.constants.representationMetadata.kind.XAXIS:sap.apf.core.constants.representationMetadata.kind.XAXIS2;}});};sap.apf.ui.representations.heatmapChart.prototype.setVizPropsForSpecificRepresentation=function(){this.chart.setVizProperties({categoryAxis2:{visible:true,title:{visible:true},label:{visible:true}}});};sap.apf.ui.representations.heatmapChart.prototype.setVizPropsOfThumbnailForSpecificRepresentation=function(){this.thumbnailChart.setVizProperties({categoryAxis2:{visible:false,title:{visible:false}}});};sap.apf.ui.representations.heatmapChart.prototype.getAxisFeedItemId=function(k){var s=sap.apf.core.constants.representationMetadata.kind;var a;switch(k){case s.XAXIS:a=sap.apf.core.constants.vizFrame.feedItemTypes.CATEGORYAXIS;break;case s.XAXIS2:a=sap.apf.core.constants.vizFrame.feedItemTypes.CATEGORYAXIS2;break;case s.SECTORCOLOR:a=sap.apf.core.constants.vizFrame.feedItemTypes.COLOR;break;default:break;}return a;};};if(!jQuery.sap.isDeclared('sap.apf.ui.representations.lineChart')){jQuery.sap.declare("sap.apf.ui.representations.lineChart");sap.apf.ui.representations.lineChart=function(a,p){sap.apf.ui.representations.BaseVizFrameChartRepresentation.apply(this,[a,p]);this.type=sap.apf.ui.utils.CONSTANTS.representationTypes.LINE_CHART;this.chartType=sap.apf.ui.utils.CONSTANTS.vizFrameChartTypes.LINE;this._addDefaultKind();};sap.apf.ui.representations.lineChart.prototype=Object.create(sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype);sap.apf.ui.representations.lineChart.prototype.constructor=sap.apf.ui.representations.lineChart;sap.apf.ui.representations.lineChart.prototype._addDefaultKind=function(){this.parameter.measures.forEach(function(m){if(m.kind===undefined){m.kind=sap.apf.core.constants.representationMetadata.kind.YAXIS;}});this.parameter.dimensions.forEach(function(d,i){if(d.kind===undefined){d.kind=i===0?sap.apf.core.constants.representationMetadata.kind.XAXIS:sap.apf.core.constants.representationMetadata.kind.LEGEND;}});};sap.apf.ui.representations.lineChart.prototype.getAxisFeedItemId=function(k){var s=sap.apf.core.constants.representationMetadata.kind;var a;switch(k){case s.XAXIS:a=sap.apf.core.constants.vizFrame.feedItemTypes.CATEGORYAXIS;break;case s.YAXIS:a=sap.apf.core.constants.vizFrame.feedItemTypes.VALUEAXIS;break;case s.LEGEND:a=sap.apf.core.constants.vizFrame.feedItemTypes.COLOR;break;default:break;}return a;};};if(!jQuery.sap.isDeclared('sap.apf.ui.representations.lineChartWithTimeAxis')){jQuery.sap.declare("sap.apf.ui.representations.lineChartWithTimeAxis");sap.apf.ui.representations.lineChartWithTimeAxis=function(a,p){sap.apf.ui.representations.BaseVizFrameChartRepresentation.apply(this,[a,p]);this.type=sap.apf.ui.utils.CONSTANTS.representationTypes.LINE_CHART_WITH_TIME_AXIS;this.chartType=sap.apf.ui.utils.CONSTANTS.vizFrameChartTypes.LINE_CHART_WITH_TIME_AXIS;this.setDateType();this._addDefaultKind();};sap.apf.ui.representations.lineChartWithTimeAxis.prototype=Object.create(sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype);sap.apf.ui.representations.lineChartWithTimeAxis.prototype.constructor=sap.apf.ui.representations.lineChartWithTimeAxis;sap.apf.ui.representations.lineChartWithTimeAxis.prototype.setDateType=function(){this.parameter.dimensions[0].dataType="date";};sap.apf.ui.representations.lineChartWithTimeAxis.prototype._addDefaultKind=function(){this.parameter.measures.forEach(function(m){if(m.kind===undefined){m.kind=sap.apf.core.constants.representationMetadata.kind.YAXIS;}});this.parameter.dimensions.forEach(function(d,i){if(d.kind===undefined){d.kind=i===0?sap.apf.core.constants.representationMetadata.kind.XAXIS:sap.apf.core.constants.representationMetadata.kind.LEGEND;}});};sap.apf.ui.representations.lineChartWithTimeAxis.prototype.setVizPropsForSpecificRepresentation=function(){this.chart.setVizProperties({timeAxis:{visible:true,title:{visible:true},label:{visible:true}}});};sap.apf.ui.representations.lineChartWithTimeAxis.prototype.setVizPropsOfThumbnailForSpecificRepresentation=function(){this.thumbnailChart.setVizProperties({timeAxis:{visible:false,title:{visible:false}}});};sap.apf.ui.representations.lineChartWithTimeAxis.prototype.getAxisFeedItemId=function(k){var s=sap.apf.core.constants.representationMetadata.kind;var a;switch(k){case s.XAXIS:a=sap.apf.core.constants.vizFrame.feedItemTypes.TIMEAXIS;break;case s.YAXIS:a=sap.apf.core.constants.vizFrame.feedItemTypes.VALUEAXIS;break;case s.LEGEND:a=sap.apf.core.constants.vizFrame.feedItemTypes.COLOR;break;default:break;}return a;};};if(!jQuery.sap.isDeclared('sap.apf.ui.representations.lineChartWithTwoVerticalAxes')){jQuery.sap.declare("sap.apf.ui.representations.lineChartWithTwoVerticalAxes");sap.apf.ui.representations.lineChartWithTwoVerticalAxes=function(a,p){sap.apf.ui.representations.BaseVizFrameChartRepresentation.apply(this,[a,p]);this.type=sap.apf.ui.utils.CONSTANTS.representationTypes.LINE_CHART_WITH_TWO_VERTICAL_AXES;this.chartType=sap.apf.ui.utils.CONSTANTS.vizFrameChartTypes.LINE_CHART_WITH_TWO_VERTICAL_AXES;this._addDefaultKind();};sap.apf.ui.representations.lineChartWithTwoVerticalAxes.prototype=Object.create(sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype);sap.apf.ui.representations.lineChartWithTwoVerticalAxes.prototype.constructor=sap.apf.ui.representations.lineChartWithTwoVerticalAxes;sap.apf.ui.representations.lineChartWithTwoVerticalAxes.prototype._addDefaultKind=function(){this.parameter.measures.forEach(function(m,i){if(m.kind===undefined){m.kind=i===0?sap.apf.core.constants.representationMetadata.kind.YAXIS:sap.apf.core.constants.representationMetadata.kind.YAXIS2;}});this.parameter.dimensions.forEach(function(d,i){if(d.kind===undefined){d.kind=i===0?sap.apf.core.constants.representationMetadata.kind.XAXIS:sap.apf.core.constants.representationMetadata.kind.LEGEND;}});};sap.apf.ui.representations.lineChartWithTwoVerticalAxes.prototype.setVizPropsForSpecificRepresentation=function(){this.chart.setVizProperties({plotArea:{primaryValuesColorPalette:["#FF0000","#9400D3"],secondaryValuesColorPalette:["#0000FF","#008000"]},valueAxis:{title:{style:{color:"#000000"}}},valueAxis2:{visible:true,title:{visible:true,style:{color:"#000000"}},label:{visible:true}}});};sap.apf.ui.representations.lineChartWithTwoVerticalAxes.prototype.setVizPropsOfThumbnailForSpecificRepresentation=function(){this.thumbnailChart.setVizProperties({valueAxis2:{visible:false,title:{visible:false}},plotArea:{primaryValuesColorPalette:["#FF0000","#9400D3"],secondaryValuesColorPalette:["#0000FF","#008000"]}});};sap.apf.ui.representations.lineChartWithTwoVerticalAxes.prototype.getAxisFeedItemId=function(k){var s=sap.apf.core.constants.representationMetadata.kind;var a;switch(k){case s.XAXIS:a=sap.apf.core.constants.vizFrame.feedItemTypes.CATEGORYAXIS;break;case s.YAXIS:a=sap.apf.core.constants.vizFrame.feedItemTypes.VALUEAXIS;break;case s.YAXIS2:a=sap.apf.core.constants.vizFrame.feedItemTypes.VALUEAXIS2;break;case s.LEGEND:a=sap.apf.core.constants.vizFrame.feedItemTypes.COLOR;break;default:break;}return a;};};if(!jQuery.sap.isDeclared('sap.apf.ui.representations.percentageStackedBarChart')){jQuery.sap.declare("sap.apf.ui.representations.percentageStackedBarChart");sap.apf.ui.representations.percentageStackedBarChart=function(a,p){sap.apf.ui.representations.BaseVizFrameChartRepresentation.apply(this,[a,p]);this.type=sap.apf.ui.utils.CONSTANTS.representationTypes.PERCENTAGE_STACKED_BAR_CHART;this.chartType=sap.apf.ui.utils.CONSTANTS.vizFrameChartTypes.PERCENTAGE_STACKED_BAR;this._addDefaultKind();};sap.apf.ui.representations.percentageStackedBarChart.prototype=Object.create(sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype);sap.apf.ui.representations.percentageStackedBarChart.prototype.constructor=sap.apf.ui.representations.percentageStackedBarChart;sap.apf.ui.representations.percentageStackedBarChart.prototype._addDefaultKind=function(){this.parameter.measures.forEach(function(m){if(m.kind===undefined){m.kind=sap.apf.core.constants.representationMetadata.kind.YAXIS;}});this.parameter.dimensions.forEach(function(d,i){if(d.kind===undefined){d.kind=i===0?sap.apf.core.constants.representationMetadata.kind.XAXIS:sap.apf.core.constants.representationMetadata.kind.LEGEND;}});};sap.apf.ui.representations.percentageStackedBarChart.prototype.setFormatString=function(){return;};function _setVizPropsCommonToMainAndThumbnailCharts(c){c.setVizProperties({plotArea:{animation:{dataLoading:false,dataUpdating:false}}});};sap.apf.ui.representations.percentageStackedBarChart.prototype.setVizPropsForSpecificRepresentation=function(){_setVizPropsCommonToMainAndThumbnailCharts(this.chart);};sap.apf.ui.representations.percentageStackedBarChart.prototype.setVizPropsOfThumbnailForSpecificRepresentation=function(){_setVizPropsCommonToMainAndThumbnailCharts(this.thumbnailChart);};sap.apf.ui.representations.percentageStackedBarChart.prototype.getAxisFeedItemId=function(k){var s=sap.apf.core.constants.representationMetadata.kind;var a;switch(k){case s.XAXIS:a=sap.apf.core.constants.vizFrame.feedItemTypes.CATEGORYAXIS;break;case s.YAXIS:a=sap.apf.core.constants.vizFrame.feedItemTypes.VALUEAXIS;break;case s.LEGEND:a=sap.apf.core.constants.vizFrame.feedItemTypes.COLOR;break;default:break;}return a;};};if(!jQuery.sap.isDeclared('sap.apf.ui.representations.percentageStackedColumnChart')){jQuery.sap.declare("sap.apf.ui.representations.percentageStackedColumnChart");sap.apf.ui.representations.percentageStackedColumnChart=function(a,p){sap.apf.ui.representations.BaseVizFrameChartRepresentation.apply(this,[a,p]);this.type=sap.apf.ui.utils.CONSTANTS.representationTypes.PERCENTAGE_STACKED_COLUMN_CHART;this.chartType=sap.apf.ui.utils.CONSTANTS.vizFrameChartTypes.PERCENTAGE_STACKED_COLUMN;this._addDefaultKind();};sap.apf.ui.representations.percentageStackedColumnChart.prototype=Object.create(sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype);sap.apf.ui.representations.percentageStackedColumnChart.prototype.constructor=sap.apf.ui.representations.percentageStackedColumnChart;sap.apf.ui.representations.percentageStackedColumnChart.prototype._addDefaultKind=function(){this.parameter.measures.forEach(function(m){if(m.kind===undefined){m.kind=sap.apf.core.constants.representationMetadata.kind.YAXIS;}});this.parameter.dimensions.forEach(function(d,i){if(d.kind===undefined){d.kind=i===0?sap.apf.core.constants.representationMetadata.kind.XAXIS:sap.apf.core.constants.representationMetadata.kind.LEGEND;}});};sap.apf.ui.representations.percentageStackedColumnChart.prototype.setFormatString=function(){return;};function _setVizPropsCommonToMainAndThumbnailCharts(c){c.setVizProperties({plotArea:{animation:{dataLoading:false,dataUpdating:false}}});};sap.apf.ui.representations.percentageStackedColumnChart.prototype.setVizPropsForSpecificRepresentation=function(){_setVizPropsCommonToMainAndThumbnailCharts(this.chart);};sap.apf.ui.representations.percentageStackedColumnChart.prototype.setVizPropsOfThumbnailForSpecificRepresentation=function(){_setVizPropsCommonToMainAndThumbnailCharts(this.thumbnailChart);};sap.apf.ui.representations.percentageStackedColumnChart.prototype.getAxisFeedItemId=function(k){var s=sap.apf.core.constants.representationMetadata.kind;var a;switch(k){case s.XAXIS:a=sap.apf.core.constants.vizFrame.feedItemTypes.CATEGORYAXIS;break;case s.YAXIS:a=sap.apf.core.constants.vizFrame.feedItemTypes.VALUEAXIS;break;case s.LEGEND:a=sap.apf.core.constants.vizFrame.feedItemTypes.COLOR;break;default:break;}return a;};};if(!jQuery.sap.isDeclared('sap.apf.ui.representations.pieChart')){jQuery.sap.declare("sap.apf.ui.representations.pieChart");sap.apf.ui.representations.pieChart=function(a,p){sap.apf.ui.representations.BaseVizFrameChartRepresentation.apply(this,[a,p]);this.type=sap.apf.ui.utils.CONSTANTS.representationTypes.PIE_CHART;this.chartType=sap.apf.ui.utils.CONSTANTS.vizFrameChartTypes.PIE;this._addDefaultKind();};sap.apf.ui.representations.pieChart.prototype=Object.create(sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype);sap.apf.ui.representations.pieChart.prototype.constructor=sap.apf.ui.representations.pieChart;sap.apf.ui.representations.pieChart.prototype._addDefaultKind=function(){this.parameter.measures.forEach(function(m){if(m.kind===undefined){m.kind=sap.apf.core.constants.representationMetadata.kind.SECTORSIZE;}});this.parameter.dimensions.forEach(function(d){if(d.kind===undefined){d.kind=sap.apf.core.constants.representationMetadata.kind.SECTORCOLOR;}});};sap.apf.ui.representations.pieChart.prototype.getAxisFeedItemId=function(k){var s=sap.apf.core.constants.representationMetadata.kind;var a;switch(k){case s.SECTORCOLOR:a=sap.apf.core.constants.vizFrame.feedItemTypes.COLOR;break;case s.SECTORSIZE:a=sap.apf.core.constants.vizFrame.feedItemTypes.SIZE;break;default:break;}return a;};};if(!jQuery.sap.isDeclared('sap.apf.ui.representations.scatterPlotChart')){jQuery.sap.declare("sap.apf.ui.representations.scatterPlotChart");sap.apf.ui.representations.scatterPlotChart=function(a,p){sap.apf.ui.representations.BaseVizFrameChartRepresentation.apply(this,[a,p]);this.type=sap.apf.ui.utils.CONSTANTS.representationTypes.SCATTERPLOT_CHART;this.chartType=sap.apf.ui.utils.CONSTANTS.vizFrameChartTypes.SCATTERPLOT;this.bIsGroupTypeChart=true;this._addDefaultKind();};sap.apf.ui.representations.scatterPlotChart.prototype=Object.create(sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype);sap.apf.ui.representations.scatterPlotChart.prototype.constructor=sap.apf.ui.representations.scatterPlotChart;sap.apf.ui.representations.scatterPlotChart.prototype._addDefaultKind=function(){this.parameter.measures.forEach(function(m,i){if(m.kind===undefined){m.kind=i===0?sap.apf.core.constants.representationMetadata.kind.XAXIS:sap.apf.core.constants.representationMetadata.kind.YAXIS;}});this.parameter.dimensions.forEach(function(d,i){if(d.kind===undefined){d.kind=i===0?sap.apf.core.constants.representationMetadata.kind.REGIONCOLOR:sap.apf.core.constants.representationMetadata.kind.REGIONSHAPE;}});};sap.apf.ui.representations.scatterPlotChart.prototype.setVizPropsForSpecificRepresentation=function(){this.chart.setVizProperties({sizeLegend:{visible:true},plotArea:{adjustScale:true}});};sap.apf.ui.representations.scatterPlotChart.prototype.setVizPropsOfThumbnailForSpecificRepresentation=function(){this.thumbnailChart.setVizProperties({sizeLegend:{visible:false},valueAxis2:{visible:false,title:{visible:false}},valueAxis:{visible:false,title:{visible:false}},categoryAxis2:{visible:false,title:{visible:false}},categoryAxis:{visible:false,title:{visible:false}},plotArea:{markerSize:4,marker:{visible:true,size:4},adjustScale:true}});};sap.apf.ui.representations.scatterPlotChart.prototype.getAxisFeedItemId=function(k){var s=sap.apf.core.constants.representationMetadata.kind;var a;switch(k){case s.XAXIS:a=sap.apf.core.constants.vizFrame.feedItemTypes.VALUEAXIS;break;case s.YAXIS:a=sap.apf.core.constants.vizFrame.feedItemTypes.VALUEAXIS2;break;case s.REGIONCOLOR:a=sap.apf.core.constants.vizFrame.feedItemTypes.COLOR;break;case s.REGIONSHAPE:a=sap.apf.core.constants.vizFrame.feedItemTypes.SHAPE;break;default:break;}return a;};};if(!jQuery.sap.isDeclared('sap.apf.ui.representations.stackedBarChart')){jQuery.sap.declare("sap.apf.ui.representations.stackedBarChart");sap.apf.ui.representations.stackedBarChart=function(a,p){sap.apf.ui.representations.BaseVizFrameChartRepresentation.apply(this,[a,p]);this.type=sap.apf.ui.utils.CONSTANTS.representationTypes.STACKED_BAR_CHART;this.chartType=sap.apf.ui.utils.CONSTANTS.vizFrameChartTypes.STACKED_BAR;this._addDefaultKind();};sap.apf.ui.representations.stackedBarChart.prototype=Object.create(sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype);sap.apf.ui.representations.stackedBarChart.prototype.constructor=sap.apf.ui.representations.stackedBarChart;sap.apf.ui.representations.stackedBarChart.prototype._addDefaultKind=function(){this.parameter.measures.forEach(function(m){if(m.kind===undefined){m.kind=sap.apf.core.constants.representationMetadata.kind.YAXIS;}});this.parameter.dimensions.forEach(function(d,i){if(d.kind===undefined){d.kind=i===0?sap.apf.core.constants.representationMetadata.kind.XAXIS:sap.apf.core.constants.representationMetadata.kind.LEGEND;}});};function _setVizPropsCommonToMainAndThumbnailCharts(c){c.setVizProperties({plotArea:{animation:{dataLoading:false,dataUpdating:false}}});};sap.apf.ui.representations.stackedBarChart.prototype.setVizPropsForSpecificRepresentation=function(){_setVizPropsCommonToMainAndThumbnailCharts(this.chart);};sap.apf.ui.representations.stackedBarChart.prototype.setVizPropsOfThumbnailForSpecificRepresentation=function(){_setVizPropsCommonToMainAndThumbnailCharts(this.thumbnailChart);};sap.apf.ui.representations.stackedBarChart.prototype.getAxisFeedItemId=function(k){var s=sap.apf.core.constants.representationMetadata.kind;var a;switch(k){case s.XAXIS:a=sap.apf.core.constants.vizFrame.feedItemTypes.CATEGORYAXIS;break;case s.YAXIS:a=sap.apf.core.constants.vizFrame.feedItemTypes.VALUEAXIS;break;case s.LEGEND:a=sap.apf.core.constants.vizFrame.feedItemTypes.COLOR;break;default:break;}return a;};};if(!jQuery.sap.isDeclared('sap.apf.ui.representations.stackedColumnChart')){jQuery.sap.declare("sap.apf.ui.representations.stackedColumnChart");sap.apf.ui.representations.stackedColumnChart=function(a,p){sap.apf.ui.representations.BaseVizFrameChartRepresentation.apply(this,[a,p]);this.type=sap.apf.ui.utils.CONSTANTS.representationTypes.STACKED_COLUMN_CHART;this.chartType=sap.apf.ui.utils.CONSTANTS.vizFrameChartTypes.STACKED_COLUMN;this._addDefaultKind();};sap.apf.ui.representations.stackedColumnChart.prototype=Object.create(sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype);sap.apf.ui.representations.stackedColumnChart.prototype.constructor=sap.apf.ui.representations.stackedColumnChart;sap.apf.ui.representations.stackedColumnChart.prototype._addDefaultKind=function(){this.parameter.measures.forEach(function(m){if(m.kind===undefined){m.kind=sap.apf.core.constants.representationMetadata.kind.YAXIS;}});this.parameter.dimensions.forEach(function(d,i){if(d.kind===undefined){d.kind=i===0?sap.apf.core.constants.representationMetadata.kind.XAXIS:sap.apf.core.constants.representationMetadata.kind.LEGEND;}});};function _setVizPropsCommonToMainAndThumbnailCharts(c){c.setVizProperties({plotArea:{animation:{dataLoading:false,dataUpdating:false}}});};sap.apf.ui.representations.stackedColumnChart.prototype.setVizPropsForSpecificRepresentation=function(){_setVizPropsCommonToMainAndThumbnailCharts(this.chart);};sap.apf.ui.representations.stackedColumnChart.prototype.setVizPropsOfThumbnailForSpecificRepresentation=function(){_setVizPropsCommonToMainAndThumbnailCharts(this.thumbnailChart);};sap.apf.ui.representations.stackedColumnChart.prototype.getAxisFeedItemId=function(k){var s=sap.apf.core.constants.representationMetadata.kind;var a;switch(k){case s.XAXIS:a=sap.apf.core.constants.vizFrame.feedItemTypes.CATEGORYAXIS;break;case s.YAXIS:a=sap.apf.core.constants.vizFrame.feedItemTypes.VALUEAXIS;break;case s.LEGEND:a=sap.apf.core.constants.vizFrame.feedItemTypes.COLOR;break;default:break;}return a;};};if(!jQuery.sap.isDeclared('sap.apf.ui.representations.table')){jQuery.sap.declare("sap.apf.ui.representations.table");(function(){'use strict';function _(S){T.removeSelections();S.forEach(function(i){T.setSelectedItem(i);});}function a(i){i.UI5ChartHelper.filterValues=[];i.setFilter(i.oApi.createFilter());}function b(i){var r=i.getFilter().getInternalFilter().getProperties()[0];var q=i.getFilter().getInternalFilter().getFilterTermsForProperty(r);var u=q.map(function(v){return v.getValue();});return u;}function c(E){var i=[],r;var C=E.getParameters("listItems").listItems;if(this.UI5ChartHelper){var I=this.getFilter().getInternalFilter().getProperties();i=I.length>0?b(this):[];r=I[0];F=i;}var q=this.oParameter.requiredFilters.length>0?"MultiSelect":"None";T.setMode(q);if(E.getId()==="selectionChange"){var u=true;var v=[];r=I[0]||this.parameter.requiredFilters[0];var w=C[0].getBindingContext().getProperty(this.parameter.requiredFilters[0]);if(C[0].isSelected()){v.push(w);}else{var x=i.indexOf(w);if(x!==-1){i.splice(x,1);}}i=i.concat(v.filter(function(y){return i.indexOf(y)<0;}));F=i;if(u){a(this);this.filter=this.UI5ChartHelper.getFilterFromSelection(i);this.oApi.getActiveStep().getSelectedRepresentation().UI5ChartHelper.filterValues=this.UI5ChartHelper.filterValues;this.oApi.selectionChanged();}else{u=true;}}var A=E.getSource().getItems().filter(function(y){var z=y.getBindingContext().getProperty(r);return i.indexOf(z)!==-1;});_(A);}function d(i){var q=b(i);var r=i.getFilter().getInternalFilter().getProperties()[0];var S=p.getItems().filter(function(v){var w=v.getBindingContext().getProperty(r);return q.indexOf(w)!==-1;});var u=i.oParameter.requiredFilters.length>0?"MultiSelect":"None";p.setMode(u);return S;}var f,F,t,e,g,T,o,p,h=[];var j,s,k,l,m;var n=new sap.ui.model.json.JSONModel();n.setSizeLimit(10000);sap.apf.ui.representations.table=function(A,P){this.oParameter=P;sap.apf.ui.representations.BaseUI5ChartRepresentation.apply(this,[A,P]);g=P.isAlternateRepresentation;this.alternateRepresentation=P.defaultListConfigurationTypeID;this.type=sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION;m=false;j=0;s=0;k=0;l=10;F=[];this.aDataResponse=[];};sap.apf.ui.representations.table.prototype=Object.create(sap.apf.ui.representations.BaseUI5ChartRepresentation.prototype);sap.apf.ui.representations.table.prototype.constructor=sap.apf.ui.representations.table;sap.apf.ui.representations.table.prototype.setData=function(D,i){var q=this;if(s===0){if(m){D.map(function(r){q.aDataResponse.push(r);});s++;}else{k=0;l=100;h=[];q.aDataResponse=D;}}h=q.aDataResponse||[];if(!i){this.oMessageObject=this.oApi.createMessageObject({code:"6004",aParameters:[this.oApi.getTextNotHtmlEncoded("step")]});this.oApi.putMessage(this.oMessageObject);}else{this.metadata=i;f=new sap.apf.ui.utils.formatter({getEventCallback:this.oApi.getEventCallback.bind(this.oApi),getTextNotHtmlEncoded:this.oApi.getTextNotHtmlEncoded},i,D);this.UI5ChartHelper.metadata=i;}};sap.apf.ui.representations.table.prototype.createDataset=function(){t=[];e={name:[],value:[]};t=this.oParameter.dimensions.concat(this.oParameter.measures).length?this.oParameter.dimensions.concat(this.oParameter.measures):this.oParameter.properties;h=this.getData();if(h.length!==0){for(var i=0;i<t.length;i++){e.value[i]=t[i].fieldName;var q="";var r=this.metadata.getPropertyMetadata(t[i].fieldName).label||this.metadata.getPropertyMetadata(t[i].fieldName).name;var u="";if(this.metadata!==undefined&&this.metadata.getPropertyMetadata(t[i].fieldName).unit!==undefined){var U=this.metadata.getPropertyMetadata(t[i].fieldName).unit;u=this.getData()[0][U];q=t[i].fieldDesc===undefined||!this.oApi.getTextNotHtmlEncoded(t[i].fieldDesc).length?r+" ("+u+")":this.oApi.getTextNotHtmlEncoded(t[i].fieldDesc)+" ("+u+")";e.name[i]=q;}else{e.name[i]=t[i].fieldDesc===undefined||!this.oApi.getTextNotHtmlEncoded(t[i].fieldDesc).length?r:this.oApi.getTextNotHtmlEncoded(t[i].fieldDesc);}}}};sap.apf.ui.representations.table.prototype.getSelectionFromChart=function(){var S=T.getSelectedItems();return S;};sap.apf.ui.representations.table.prototype.getSelections=function(){var S=[];if(F){F.forEach(function(i){S.push({id:i,text:i});});}return S;};sap.apf.ui.representations.table.prototype.getRequestOptions=function(){if(!m){l=100;k=0;s=0;}var r={paging:{top:l,skip:k,inlineCount:true}};var i;if(this.sortProperty!==undefined){i=[{property:this.sortProperty,descending:this.sortOrderIsDescending}];r.orderby=i;}else{if(this.getParameter().orderby&&this.getParameter().orderby.length){var O=this.getParameter().orderby.map(function(q){return{property:q.property,descending:!q.ascending};});r.orderby=O;}}return r;};sap.apf.ui.representations.table.prototype.getMainContent=function(S,i,w){var q=this;this.createDataset();var M;if(!S){M=this.oApi.createMessageObject({code:"6002",aParameters:["title",this.oApi.getTextNotHtmlEncoded("step")]});this.oApi.putMessage(M);}if(t.length===0){M=this.oApi.createMessageObject({code:"6002",aParameters:["dimensions",S]});this.oApi.putMessage(M);}if(!h||h.length===0){M=this.oApi.createMessageObject({code:"6000",aParameters:[S]});this.oApi.putMessage(M);}var r=(w||1000)+"px";var u=[];var v;var C=function(U){return function(V){if(q.metadata===undefined){return V;}else{var W;if(e.value[U]&&V){W=f.getFormattedValue(e.value[U],V);}if(W!==undefined){return W;}else{return V;}}};};var x;for(v=0;v<e.name.length;v++){x=new sap.m.Text().bindText(e.value[v],C(v),sap.ui.model.BindingMode.OneWay);u.push(x);}var y=[],z=[];var A,B;var D;for(D=0;D<e.name.length;D++){A=new sap.m.Column({header:new sap.m.Text({text:e.name[D]})});y.push(A);B=new sap.m.Column();z.push(B);}o=new sap.m.Table({headerText:S,showNoData:false,columns:y}).addStyleClass("tableWithHeaders");T=new sap.m.Table({columns:z,items:{path:"/tableData",template:new sap.m.ColumnListItem({cells:u})},selectionChange:c.bind(q)});n.setData({tableData:h});o.setModel(n);T.setModel(n);T.attachUpdateFinished(c.bind(q));var E=function(U){var V=U.getParameters();T.setBusy(true);s=0;q.sortProperty=V.sortItem.getKey();q.orderby=q.sortOrderIsDescending=V.sortDescending;l=100;k=0;var J=[];if(V.sortItem){if(g){var K=T.getBinding("items");J.push(new sap.ui.model.Sorter(q.sortProperty,q.sortOrderIsDescending));K.sort(J);T.setBusy(false);return;}q.oApi.updatePath(function(W,X){if(W===q.oApi.getActiveStep()){n.setData({tableData:h});T.rerender();T.setBusy(false);}});}};this.viewSettingsDialog=new sap.m.ViewSettingsDialog({confirm:E});var G;for(G=0;G<o.getColumns().length;G++){var I=new sap.m.ViewSettingsItem({text:e.name[G],key:e.value[G]});this.viewSettingsDialog.addSortItem(I);}var H;if(this.sortProperty===undefined&&this.sortOrderIsDescending===undefined){if(this.getParameter().orderby&&this.getParameter().orderby.length){for(H=0;H<this.viewSettingsDialog.getSortItems().length;H++){if(this.getParameter().orderby[0].property===this.viewSettingsDialog.getSortItems()[H].getKey()){this.viewSettingsDialog.setSelectedSortItem(this.viewSettingsDialog.getSortItems()[H]);this.viewSettingsDialog.setSortDescending(!this.getParameter().orderby[0].ascending);}}}else{this.viewSettingsDialog.setSelectedSortItem(this.viewSettingsDialog.getSortItems()[0]);this.viewSettingsDialog.setSortDescending(false);}}else{for(H=0;H<this.viewSettingsDialog.getSortItems().length;H++){if(this.sortProperty===this.viewSettingsDialog.getSortItems()[H].getKey()){this.viewSettingsDialog.setSelectedSortItem(this.viewSettingsDialog.getSortItems()[H]);}}this.viewSettingsDialog.setSortDescending(this.sortOrderIsDescending);var J=[];if(g){var K=T.getBinding("items");J.push(new sap.ui.model.Sorter(this.sortProperty,this.sortOrderIsDescending));K.sort(J);}}var L;if(this.metadata!==undefined){for(L=0;L<e.name.length;L++){var N=this.metadata.getPropertyMetadata(e.value[L]);if(N.unit){var O=T.getColumns()[L];O.setHAlign(sap.ui.core.TextAlign.Right);}}}var P=new sap.m.ScrollContainer({content:T,height:"480px",horizontal:false,vertical:true}).addStyleClass("tableWithoutHeaders");var Q=new sap.m.Link({text:"More"}).addStyleClass("loadMoreLink");var R=new sap.m.ScrollContainer({content:[o,P],width:r,horizontal:true,vertical:false}).addStyleClass("scrollContainer");n.setSizeLimit(10000);o.addEventDelegate({onAfterRendering:function(){jQuery(".scrollContainer > div:first-child").css({"display":"table","width":"inherit"});var U;if(this.offsetTop===undefined){this.offsetTop=jQuery(".tableWithoutHeaders").offset().top;}if(jQuery(".tableWithoutHeaders").offset().top!==this.offsetTop){U=((window.innerHeight-jQuery('.tableWithoutHeaders').offset().top))+"px";}else{U=((window.innerHeight-jQuery('.tableWithoutHeaders').offset().top)-(jQuery(".applicationFooter").height())-20)+"px";}document.querySelector('.tableWithoutHeaders').style.cssText+="height : "+U;var V=sap.ui.getCore().getRenderManager().getHTML(Q);sap.ui.Device.orientation.attachHandler(function(){R.rerender();});var W=q.oApi.getActiveStep();if(W.getSelectedRepresentation().bIsAlternateView===undefined||W.getSelectedRepresentation().bIsAlternateView===false){if(sap.ui.Device.browser.mobile){if(h.length>0){jQuery(jQuery(".tableWithoutHeaders > div:first-child")).append(V);}Q.attachPress(function(){if(!jQuery(".openToggleImage").length&&(h.length>0)){if(j===0){X();s=0;j++;jQuery(".loadMoreLink").remove();jQuery(jQuery(".tableWithoutHeaders > div:first-child")).append(V);}}else{jQuery(".loadMoreLink").remove();}});}else{jQuery('.tableWithoutHeaders').on("scroll",function(){var q=jQuery(this);var Y=q.prop("scrollTop");var Z=q.prop("scrollHeight");var $=q.prop("offsetHeight");var a1=Z-$-5;if((a1<=Y)&&!jQuery(".openToggleImage").length&&(h.length>0)){if(j===0){X();s=0;j++;}}});}}var X=function(){T.setBusy(true);sap.ui.getCore().applyChanges();var Y=n.getData();k=Y.tableData.length;l=10;m=true;q.oApi.updatePath(function(Z,$){if(Z===q.oApi.getActiveStep()){n.setData(Y);T.rerender();T.setBusy(false);j=0;}});};}});return new sap.ui.layout.VerticalLayout({content:[R]});};sap.apf.ui.representations.table.prototype.getThumbnailContent=function(){var i;if(this.aDataResponse!==undefined&&this.aDataResponse.length!==0){var q=new sap.ui.core.Icon({src:"sap-icon://table-chart",size:"70px"}).addStyleClass('thumbnailTableImage');i=q;}else{var r=new sap.m.Text({text:this.oApi.getTextNotHtmlEncoded("noDataText")}).addStyleClass('noDataText');i=new sap.ui.layout.VerticalLayout({content:r});}return i;};sap.apf.ui.representations.table.prototype.removeAllSelection=function(){a(this);F=[];T.removeSelections();this.oApi.getActiveStep().getSelectedRepresentation().UI5ChartHelper.filterValues=[];this.oApi.selectionChanged();};sap.apf.ui.representations.table.prototype.getPrintContent=function(S){var q=this;this.createDataset();var P=new sap.ui.model.json.JSONModel();P.setData({tableData:h});var i;var r=[];for(i=0;i<e.name.length;i++){this.columnName=new sap.m.Column({width:"75px",header:new sap.m.Label({text:e.name[i]})});r.push(this.columnName);}var u=[];var C=function(y){return function(z){if(q.metadata===undefined){return z;}else{var M=q.metadata.getPropertyMetadata(e.value[y]);if(M.dataType.type==="Edm.DateTime"){if(z===null){return"-";}var A=new Date(parseInt(z.slice(6,z.length-2),10));A=A.toLocaleDateString();if(A==="Invalid Date"){return"-";}return A;}if(M.unit){if(z===null){return"-";}var B=q.metadata.getPropertyMetadata(M.unit);if(B.semantics==="currency-code"){var D=h[0][M.scale];z=parseFloat(z,10).toFixed(D).toString();var E=z.split(".");var G=parseFloat(E[0]).toLocaleString();var H=0.1;H=H.toLocaleString();if(G.split(H.substring(1,2)).length>1){G=G.split(H.substring(1,2))[0];}G=G.concat(H.substring(1,2),E[1]);return G;}}else{return z;}}};};var v;for(i=0;i<e.name.length;i++){v=new sap.m.Text().bindText(e.value[i],C(i),sap.ui.model.BindingMode.OneWay);u.push(v);}p=new sap.m.Table({headerText:S,headerDesign:sap.m.ListHeaderDesign.Standard,columns:r,items:{path:"/tableData",template:new sap.m.ColumnListItem({cells:u})}});if(this.metadata!==undefined){for(i=0;i<e.name.length;i++){var M=this.metadata.getPropertyMetadata(e.value[i]);if(M.unit){var w=p.getColumns()[i];w.setHAlign(sap.ui.core.TextAlign.Right);}}}p.setModel(P);var x=d(this);return{oTableForPrint:new sap.ui.layout.VerticalLayout({content:[p]}),aSelectedListItems:x};};}());};if(!jQuery.sap.isDeclared('sap.apf.ui.reuse.controller.stepGallery.controller')){jQuery.sap.declare('sap.apf.ui.reuse.controller.stepGallery.controller');
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
sap.ui.controller("sap.apf.ui.reuse.controller.stepGallery",{getGalleryElementsData:function(){var s=this;var g=[];var c=this.oCoreApi.getCategories();var l=this.oCoreApi.getTextNotHtmlEncoded("label");var a=this.oCoreApi.getTextNotHtmlEncoded("steps");var b=this.oCoreApi.getTextNotHtmlEncoded("category");var m;if(c.length===0){m=this.oCoreApi.createMessageObject({code:"6001",aParameters:["Categories"]});this.oCoreApi.putMessage(m);}var i;for(i=0;i<c.length;i++){var G={};var C=c[i];var d;if(!C.label){m=this.oCoreApi.createMessageObject({code:"6002",aParameters:[l,b+": "+d]});this.oCoreApi.putMessage(m);}else{d=this.oCoreApi.getTextNotHtmlEncoded(C.label);G.title=this.oCoreApi.getTextNotHtmlEncoded(C.label);}G.id=C.id;G.stepTemplates=[];C.stepTemplates.forEach(function(o){var e={};if(!o.title){m=s.oCoreApi.createMessageObject({code:"6003",aParameters:["Title"]});s.oCoreApi.putMessage(m);}else{e.title=s.oCoreApi.getTextNotHtmlEncoded(o.title);}e.id=o.id;e.representationtypes=o.getRepresentationInfo();e.representationtypes.forEach(function(r){r.title=s.oCoreApi.getTextNotHtmlEncoded(r.label);if(r.parameter&&r.parameter.orderby){var f=new sap.apf.ui.utils.Helper(s.oCoreApi).getRepresentationSortInfo(r);r.sortDescription=f;}});e.defaultRepresentationType=e.representationtypes[0];G.stepTemplates.push(e);});g.push(G);}var S=this.oCoreApi.getStepTemplates();if(S.length===0){m=this.oCoreApi.createMessageObject({code:"6002",aParameters:[a,b]});this.oCoreApi.putMessage(m);}var j={GalleryElements:g};return j;},onInit:function(){if(sap.ui.Device.system.desktop){this.getView().addStyleClass("sapUiSizeCompact");}this.oCoreApi=this.getView().getViewData().oCoreApi;this.oUiApi=this.getView().getViewData().uiApi;var g=this.getGalleryElementsData().GalleryElements;var m=new sap.ui.model.json.JSONModel({"GalleryElements":g});this.getView().setModel(m);},getStepDetails:function(c,s){var g=this.getGalleryElementsData().GalleryElements;var a=g[c].stepTemplates[s];return a;},openHierarchicalSelectDialog:function(){if(this.oHierchicalSelectDialog){this.oHierchicalSelectDialog.destroy();}this.oHierchicalSelectDialog=new sap.ui.jsfragment("sap.apf.ui.reuse.fragment.stepGallery",this);this.oHierchicalSelectDialog.setModel(this.getView().getModel());if(sap.ui.Device.system.desktop){this.oHierchicalSelectDialog.addStyleClass("sapUiSizeCompact");}this.oHierchicalSelectDialog.open();},onStepPress:function(i,r){this.oHierchicalSelectDialog.close();this.oUiApi.getLayoutView().setBusy(true);this.oCoreApi.createStep(i,this.oUiApi.getAnalysisPath().getController().callBackForUpdatePathAndSetLastStepAsActive.bind(this.oUiApi.getAnalysisPath().getController()),r);this.oUiApi.getLayoutView().setBusy(true);this.oUiApi.getAnalysisPath().getController().refresh(-1);}});};if(!jQuery.sap.isDeclared('sap.apf.ui.reuse.controller.stepToolbar.controller')){jQuery.sap.declare('sap.apf.ui.reuse.controller.stepToolbar.controller');sap.ui.controller("sap.apf.ui.reuse.controller.stepToolbar",{chartIconInserted:false,alternateRepresentationIcon:false,alternateRepresentationBool:false,selectedRepresentation:null,alternateRepresentationBtn:{},selectedNumber:null,selectedNumberLink:null,isSwitchRepresentation:false,viewSettingsIcon:null,onInit:function(){this.oCoreApi=this.getView().getViewData().oCoreApi;this.oUiApi=this.getView().getViewData().uiApi;if(sap.ui.Device.system.desktop){this.getView().addStyleClass("sapUiSizeCompact");}},addCompactStyleClassForDialog:function(d){if(sap.ui.Device.system.desktop){d.addStyleClass("sapUiSizeCompact");}},drawAlternateRepresentation:function(){var t=this;this.alternateRepresentationBtn=new sap.m.Button({icon:this.oCoreApi.getActiveStep().getSelectedRepresentation().getAlternateRepresentation().picture,tooltip:this.oCoreApi.getTextNotHtmlEncoded("TableRepresentation"),press:function(){var s=t.oCoreApi.getActiveStep();var c=s.getSelectedRepresentation();var a=t.oCoreApi.getSteps().indexOf(s);t.selectedRepresentation="table";c.bIsAlternateView=true;if(c.toggleInstance===undefined){c.toggleInstance=t.oUiApi.getStepContainer().getController().createAlternateRepresentation(a);}else{var d=c.getData(),m=c.getMetaData();if(d!==undefined&&m!==undefined){c.toggleInstance.setData(d,m);}c.toggleInstance.adoptSelection(c);}t.oUiApi.getAnalysisPath().getController().refresh(-1);t.oUiApi.getStepContainer().getController().drawStepContent();t.oUiApi.getAnalysisPath().getCarousel().getStepView(a).getController().drawThumbnailContent(true);}}).addStyleClass("alternateButton");this.insertViewSettingsIcon();this.getView().chartToolbar.getToolBar().insertContentRight(this.alternateRepresentationBtn);},insertViewSettingsIcon:function(){var t=this;var v;this.sortButton=new sap.m.Button({icon:"sap-icon://drop-down-list",tooltip:this.oCoreApi.getTextNotHtmlEncoded("view-Settings"),press:function(){if(t.oCoreApi.getActiveStep().getSelectedRepresentation().type!==sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION){v=t.oCoreApi.getActiveStep().getSelectedRepresentation().toggleInstance.viewSettingsDialog;t.addCompactStyleClassForDialog(v);v.open();}else{v=t.oCoreApi.getActiveStep().getSelectedRepresentation().viewSettingsDialog;t.addCompactStyleClassForDialog(v);v.open();}}}).addStyleClass("sortButton");this.getView().chartToolbar.getToolBar().insertContentRight(this.sortButton);},showSelectionCount:function(){var a=this.oCoreApi.getActiveStep();var s=a.getSelectedRepresentation();var b=s.getSelections().length||s.getSelectionCount();var r=s.getParameter().requiredFilters!==undefined&&s.getParameter().requiredFilters.length!==0;var m=s.getMetaData!==undefined&&s.getMetaData()!==undefined&&s.getMetaData().hasOwnProperty("getPropertyMetadata");var c=r&&m?s.getMetaData().getPropertyMetadata(s.getParameter().requiredFilters[0]).label:null;if(c===null||b===0){jQuery(".showSelection").hide();jQuery(".resetSelection").hide();}else if(b>0){this.selectedNumber.setText("("+this.oCoreApi.getTextNotHtmlEncoded("selected-objects",[c]));this.selectedNumberLink.setText(b);this.selectedNumberEndText.setText(')');jQuery(".showSelection").show();jQuery(".resetSelection").show();}},insertContentLeft:function(){var t=this;this.currentStepText=new sap.m.Label({wrapping:true,text:this.oCoreApi.getTextNotHtmlEncoded("currentStep")}).addStyleClass("currentStep");this.selectedNumber=new sap.m.Label({wrapping:true}).addStyleClass("showSelection");this.selectedNumberEndText=new sap.m.Label({wrapping:true}).addStyleClass("showSelection");this.selectedNumberEndText.addStyleClass("selectedNumberEndText");this.selectedNumberLink=new sap.m.Link({press:function(){if(t.selectionDisplayDialog){t.selectionDisplayDialog.destroy();}t.selectionDisplayDialog=new sap.ui.jsfragment("sap.apf.ui.reuse.fragment.selectionDisplay",t);t.addCompactStyleClassForDialog(t.selectionDisplayDialog);t.selectionDisplayDialog.open();}}).addStyleClass("showSelection");this.selectedNumberLink.addStyleClass("selectedNumberLink");this.resetSelection=new sap.m.Link({text:this.oCoreApi.getTextNotHtmlEncoded("resetSelection")}).attachPress(function(){jQuery(".showSelection").hide();jQuery(".resetSelection").hide();if(t.oCoreApi.getActiveStep().getSelectedRepresentation().bIsAlternateView){t.oCoreApi.getActiveStep().getSelectedRepresentation().toggleInstance.removeAllSelection();}t.oCoreApi.getActiveStep().getSelectedRepresentation().removeAllSelection();}).addStyleClass("resetSelection");this.getView().chartToolbar.getToolBar().insertContentRight(this.resetSelection);this.getView().chartToolbar.getToolBar().insertContentLeft(this.selectedNumberEndText);this.getView().chartToolbar.getToolBar().insertContentLeft(this.selectedNumberLink);this.getView().chartToolbar.getToolBar().insertContentLeft(this.selectedNumber);this.getView().chartToolbar.getToolBar().insertContentLeft(this.currentStepText);},drawSingleRepresentation:function(){var t=this;var a=this.oCoreApi.getActiveStep();a.selectedRepresentaionType=a.getSelectedRepresentationInfo();if(a.selectedRepresentaionType.parameter&&a.selectedRepresentaionType.parameter.orderby){var r=new sap.apf.ui.utils.Helper(t.oCoreApi).getRepresentationSortInfo(a.selectedRepresentaionType);a.selectedRepresentaionType.sortDescription=r;}var s=new sap.m.Button({icon:a.selectedRepresentaionType.picture,tooltip:this.oCoreApi.getTextNotHtmlEncoded(a.selectedRepresentaionType.label)+"\n"+((a.selectedRepresentaionType.sortDescription!==undefined)?this.oCoreApi.getTextNotHtmlEncoded("sortBy")+": "+a.selectedRepresentaionType.sortDescription:""),press:function(){var S=t.oCoreApi.getActiveStep();var c=S.getSelectedRepresentation();c.bIsAlternateView=false;t.oUiApi.getStepContainer().getController().drawStepContent();var b=t.oCoreApi.getSteps().indexOf(S);t.oUiApi.getAnalysisPath().getCarousel().getStepView(b).getController().drawThumbnailContent(true);}});this.getView().chartToolbar.getToolBar().insertContentRight(s,0);this.insertContentLeft();},drawMultipleRepresentation:function(){var t=this;var a=this.oCoreApi.getActiveStep();a.representationtypes=a.getRepresentationInfo();a.representationtypes.forEach(function(R){if(R.parameter&&R.parameter.orderby){var r=new sap.apf.ui.utils.Helper(t.oCoreApi).getRepresentationSortInfo(R);R.sortDescription=r;}});a.selectedRepresentaionType=a.getSelectedRepresentationInfo();if(a.selectedRepresentaionType.parameter&&a.selectedRepresentaionType.parameter.orderby){var r=new sap.apf.ui.utils.Helper(this.oCoreApi).getRepresentationSortInfo(a.selectedRepresentaionType);a.selectedRepresentaionType.sortDescription=r;}var b=a.representationtypes.length;var s;var d=function(f){var a=t.oCoreApi.getSteps()[f.nActiveStepIndex];a.getSelectedRepresentation().bIsAlternateView=false;a.setSelectedRepresentation(f.oRepresentationType.representationId);t.oUiApi.getAnalysisPath().getController().refresh(f.nActiveStepIndex);t.oCoreApi.updatePath(t.oUiApi.getAnalysisPath().getController().callBackForUpdatePath.bind(t.oUiApi.getAnalysisPath().getController()));};this.openList=function(E){var f=E.getParameter("listItem").getCustomData()[0].getValue();d(f);s.setIcon(f.icon);s.setTooltip(t.oCoreApi.getTextNotHtmlEncoded(f.oRepresentationType.label)+"\n"+(f.oRepresentationType.sortDescription!==undefined?t.oCoreApi.getTextNotHtmlEncoded("sortBy")+": "+f.oRepresentationType.sortDescription:""));};var A=new sap.m.List({mode:sap.m.ListMode.SingleSelectMaster,showSeparators:sap.m.ListSeparators.None,includeItemInSelection:true,select:jQuery.proxy(function(E){this.openList(E);},this)});var c=sap.ui.Device.system.desktop?false:true;for(var j=0;j<b;j++){var i=new sap.m.StandardListItem({description:a.representationtypes[j].sortDescription&&this.oCoreApi.getTextNotHtmlEncoded("sortBy")+": "+a.representationtypes[j].sortDescription,icon:a.representationtypes[j].picture,title:t.oCoreApi.getTextNotHtmlEncoded(a.representationtypes[j].label),adaptTitleSize:c,customData:[new sap.ui.core.CustomData({key:'data',value:{oRepresentationType:a.representationtypes[j],nActiveStepIndex:t.oCoreApi.getSteps().indexOf(t.oCoreApi.getActiveStep()),icon:a.representationtypes[j].picture}})]});if(sap.ui.Device.system.desktop){i.addStyleClass("repItem");}A.addItem(i);}var S=new sap.m.Popover({placement:sap.m.PlacementType.Bottom,showHeader:false,content:[A]}).addStyleClass("sapCaUiChartToolBarShowAllChartListPopover");function p(E){var f=E.getSource().getCustomData()[0].getValue();d(f);}for(var k=0;k<b;k++){var e=new sap.m.Button({tooltip:t.oCoreApi.getTextNotHtmlEncoded(a.representationtypes[k].label)+"\n"+((a.representationtypes[k].sortDescription!==undefined)?this.oCoreApi.getTextNotHtmlEncoded("sortBy")+": "+a.representationtypes[k].sortDescription:""),icon:a.representationtypes[k].picture,customData:[new sap.ui.core.CustomData({key:'data',value:{oRepresentationType:a.representationtypes[k],nActiveStepIndex:t.oCoreApi.getSteps().indexOf(t.oCoreApi.getActiveStep()),icon:a.representationtypes[k].picture}})],press:p});e.addStyleClass("iconLeft");this.getView().chartToolbar.getToolBar().insertContentRight(e);}s=new sap.m.Button({icon:a.selectedRepresentaionType.picture,tooltip:this.oCoreApi.getTextNotHtmlEncoded(a.selectedRepresentaionType.label)+"\n"+((a.selectedRepresentaionType.sortDescription!==undefined)?this.oCoreApi.getTextNotHtmlEncoded("sortBy")+": "+a.selectedRepresentaionType.sortDescription:""),press:function(){S.openBy(this);}}).addStyleClass("iconList");this.getView().chartToolbar.getToolBar().insertContentRight(s,0);this.insertContentLeft();},drawToolBar:function(){var t=this;this.showAndHideIcons=function(){var t=this;t.isSwitchRepresentation=false;if(t.getView().chartToolbar.getFullScreen()===true){jQuery(".iconList").hide();jQuery(".iconLeft").show();}else{jQuery(".iconList").show();jQuery(".iconLeft").hide();}if((t.oCoreApi.getActiveStep().getSelectedRepresentation().bIsAlternateView&&t.oCoreApi.getActiveStep().getSelectedRepresentation().getAlternateRepresentation().id===sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION)||t.oCoreApi.getActiveStep().getSelectedRepresentation().type===sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION){jQuery(".sortButton").show();}else{jQuery(".sortButton").hide();}if(t.oCoreApi.getSteps().length>=1){t.showSelectionCount();}var a=t.getView().chartToolbar.getId();if(t.oCoreApi.getActiveStep().getSelectedRepresentation().getAlternateRepresentation()!==undefined){if((!t.oCoreApi.getActiveStep().getSelectedRepresentation().bIsAlternateView&&t.oCoreApi.getActiveStep().getSelectedRepresentation().getAlternateRepresentation().id!==sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION)||t.oCoreApi.getActiveStep().getSelectedRepresentation().type!==sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION){if((window.innerWidth===jQuery("#"+a+" > div:first-child > div:nth-child(2)").width())){jQuery(t.getView().chartToolbar._oShowLegendButton.getDomRef()).show();}}}};this.renderIcons=function(){var t=this;var a=t.oCoreApi.getActiveStep();if(a!==undefined){t.getView().chartToolbar._oFullScreenButton.setTooltip(t.oCoreApi.getTextNotHtmlEncoded("toggle-fullscreen"));t.getView().chartToolbar._oFullScreenExitButton.setTooltip(t.oCoreApi.getTextNotHtmlEncoded("toggle-fullscreen"));if(t.alternateRepresentationIcon===false&&t.oCoreApi.getActiveStep().getSelectedRepresentation().type!==sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION){t.drawAlternateRepresentation();t.alternateRepresentationIcon=true;}if(t.oCoreApi.getActiveStep().getSelectedRepresentation().type===sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION){if(t.viewSettingsIcon===false){t.insertViewSettingsIcon();}t.viewSettingsIcon=true;}if(t.oCoreApi.getActiveStep().getRepresentationInfo().length>1){if(t.chartIconInserted===false){t.drawMultipleRepresentation();}t.chartIconInserted=true;}else if(t.oCoreApi.getActiveStep().getRepresentationInfo().length===1){if(t.chartIconInserted===false){t.drawSingleRepresentation();}t.chartIconInserted=true;}if((t.oCoreApi.getActiveStep().getSelectedRepresentation().bIsAlternateView&&t.oCoreApi.getActiveStep().getSelectedRepresentation().getAlternateRepresentation().id===sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION)||t.oCoreApi.getActiveStep().getSelectedRepresentation().type===(sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION||sap.apf.ui.utils.CONSTANTS.representationTypes.GEO_MAP)){t.getView().chartToolbar._oShowLegendButton.setVisible(false);}else{t.getView().chartToolbar._oShowLegendButton.setVisible(true);t.getView().chartToolbar._oShowLegendButton.setTooltip(t.oCoreApi.getTextNotHtmlEncoded("legend"));}if(t.isSwitchRepresentation===true){t.getView().chartToolbar.setShowLegend(true);}}};this.getView().chartToolbar.addEventDelegate({onAfterRendering:function(){if(t.oCoreApi.getSteps().length>0){t.showAndHideIcons();}var s=t.oCoreApi.getActiveStep();if(s){var c=s.getSelectedRepresentation();var f;var a=s.getSelectedRepresentation().chart||{};if(c.bIsLegendVisible===true||c.bIsLegendVisible===undefined){if(a.setVizProperties){a.setVizProperties({legend:{visible:true},sizeLegend:{visible:true}});}else{if(a.setLegend!==undefined){a.setLegend(new sap.viz.ui5.types.legend.Common({visible:true,title:new sap.viz.ui5.types.legend.Common_title({visible:true})}));}if(a.setSizeLegend!==undefined){f=a.getSizeLegend().getFormatString();a.setSizeLegend(new sap.viz.ui5.types.legend.Common({visible:true,title:new sap.viz.ui5.types.legend.Common_title({visible:true})}));if(f!==null){a.getSizeLegend().setFormatString(f);}}}}else{if(a.setVizProperties){a.setVizProperties({legend:{visible:false},sizeLegend:{visible:false}});}else{if(a.setLegend!==undefined){a.setLegend(new sap.viz.ui5.types.legend.Common({visible:false,title:new sap.viz.ui5.types.legend.Common_title({visible:false})}));}if(a.setSizeLegend!==undefined){f=a.getSizeLegend().getFormatString();a.setSizeLegend(new sap.viz.ui5.types.legend.Common({visible:false,title:new sap.viz.ui5.types.legend.Common_title({visible:false})}));if(f!==null){a.getSizeLegend().setFormatString(f);}}}}}},onBeforeRendering:function(){if(t.oCoreApi.getSteps().length>0){t.renderIcons();}}});},drawRepresentation:function(c){var t=this;this.isSwitchRepresentation=true;this.getView().chartToolbar.getToolBar().removeAllContentLeft();this.getView().chartToolbar.getToolBar().removeAllContentRight();this.chartIconInserted=false;this.alternateRepresentationIcon=false;this.viewSettingsIcon=false;this.getView().chartToolbar.removeAllCharts();this.getView().chartToolbar.insertChart(c);if(this.getView().chartToolbar.getFullScreen()===true){this.getView().chartToolbar.rerender();if(this.oCoreApi.getActiveStep().getSelectedRepresentation().bIsAlternateView||this.oCoreApi.getActiveStep().getSelectedRepresentation().type===sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION){var s=this.oCoreApi.getActiveStep().getSelectedRepresentation().getParameter().requiredFilters.length>0?"MultiSelect":"None";this.getView().chartToolbar.getCharts()[0].getContent()[0].getContent()[1].getContent()[0].setMode(s);this.getView().chartToolbar.getCharts()[0].getContent()[0].getContent()[1].getContent()[0].rerender();}}this.drawToolBar();this.getView().chartToolbar.onAfterRendering=function(){var l=this._oShowLegendButton.getDomRef();var e=sap.ui.Device.browser.mobile?"tap":"click";jQuery(l).on(e,function(){var S=t.oCoreApi.getActiveStep();var a=S.getSelectedRepresentation();if(a.bIsLegendVisible===true||a.bIsLegendVisible===undefined){a.bIsLegendVisible=false;}else{a.bIsLegendVisible=true;}});};}});};if(!jQuery.sap.isDeclared('sap.apf.ui.utils.facetFilterValueFormatter')){jQuery.sap.declare('sap.apf.ui.utils.facetFilterValueFormatter');sap.apf.ui.utils.FacetFilterValueFormatter=function(){"use strict";this.getFormattedFFData=function(f){var F,t,s;var p=f.oPropertyMetadata;var S=f.sSelectProperty;var a=f.aFilterValues;var o=new sap.apf.ui.utils.formatter({getEventCallback:f.oUiApi.getEventCallback.bind(f.oUiApi),getTextNotHtmlEncoded:f.oCoreApi.getTextNotHtmlEncoded},p,a);var T=p.text;a.forEach(function(b){F=o.getFormattedValue(S,b[S]);t=F;if(T){s=o.getFormattedValue(T,b[T]);if(s){t=F+" - "+s;}}b.formattedValue=t;});return a;};};};if(!jQuery.sap.isDeclared('sap.apf.core.utils.filter')){jQuery.sap.declare('sap.apf.core.utils.filter');(function(){'use strict';var c="%20and%20";var a="%20or%20";sap.apf.core.utils.Filter=function(m,b,d,e,f){this.type="internalFilter";this.messageHandler=m;if(b&&(b instanceof sap.apf.core.utils.FilterTerm||b instanceof sap.apf.core.utils.Filter)){this.leftExpr=b;}else if(b!==undefined&&d!==undefined&&e!==undefined){this.leftExpr=new sap.apf.core.utils.FilterTerm(m,b,d,e,f);}else if(b!==undefined||d!==undefined||e!==undefined){m.check(false,"wrong arguments in construction of sap.apf.core.utils.Filter");}this.restExpr=[];};sap.apf.core.utils.Filter.prototype.getProperties=function(){var i;var p=[];var P=[];var b="";if(this.leftExpr===undefined){return p;}if(this.leftExpr instanceof sap.apf.core.utils.FilterTerm){b=this.leftExpr.getProperty();p.push(b);}else if(this.leftExpr instanceof sap.apf.core.utils.Filter){p=this.leftExpr.getProperties();}for(i=0;i<this.restExpr.length;i++){if(this.restExpr[i]instanceof sap.apf.core.utils.FilterTerm){p.push(this.restExpr[i].getProperty());}else{P=this.restExpr[i].getProperties();p=p.concat(P);}}return sap.apf.utils.eliminateDuplicatesInArray(this.messageHandler,p);};sap.apf.core.utils.Filter.prototype.copy=function(){var f;var i;if(this.leftExpr===undefined){return new sap.apf.core.utils.Filter(this.messageHandler);}f=new sap.apf.core.utils.Filter(this.messageHandler,this.leftExpr);if(this.levelOperator===undefined){return f;}for(i=0;i<this.restExpr.length;i++){if(this.levelOperator===sap.apf.core.constants.BooleFilterOperators.AND){f.addAnd(this.restExpr[i].copy());}else{f.addOr(this.restExpr[i].copy());}}return f;};sap.apf.core.utils.Filter.prototype.isEmpty=function(){if(this.leftExpr===undefined){return true;}if(this.leftExpr instanceof sap.apf.core.utils.FilterTerm){return false;}if(!this.leftExpr.isEmpty()){return false;}if(this.restExpr.length===0){return true;}var i;for(i=0;i<this.restExpr.length;++i){if(!this.restExpr[i].isEmpty()){return false;}}return true;};sap.apf.core.utils.Filter.prototype.isOr=function(){if(this.levelOperator===sap.apf.core.constants.BooleFilterOperators.OR){return true;}else if(this.levelOperator===sap.apf.core.constants.BooleFilterOperators.AND){return false;}if(this.leftExpr){if(this.leftExpr instanceof sap.apf.core.utils.Filter){return this.leftExpr.isOr();}}return false;};sap.apf.core.utils.Filter.prototype.isEqual=function(f){if(this===f){return true;}if(f===undefined){return false;}return this.getHash()===f.getHash();};sap.apf.core.utils.Filter.prototype.getHash=function(l){var n=l||1;var b=0;if(this.restExpr.length===0){b=n;}else{b=n+1;}if(this.leftExpr===undefined){return 0;}var h=this.leftExpr.getHash(b);var i;if(this.levelOperator===undefined){return h;}if(this.levelOperator===sap.apf.core.constants.BooleFilterOperators.AND){h=h+Math.pow(2,n);}else if(this.levelOperator===sap.apf.core.constants.BooleFilterOperators.OR){h=h+Math.pow(3,n);}for(i=0;i<this.restExpr.length;i++){h=h+this.restExpr[i].getHash(b);}return h;};sap.apf.core.utils.Filter.prototype.getFilterTermsForProperty=function(p){var t=[];var i;if(this.leftExpr===undefined){return t;}if(this.leftExpr instanceof sap.apf.core.utils.Filter){t=this.leftExpr.getFilterTermsForProperty(p);}else if(p===this.leftExpr.getProperty()){t.push(this.leftExpr);}for(i=0;i<this.restExpr.length;i++){if(this.restExpr[i]instanceof sap.apf.core.utils.FilterTerm){if(p===this.restExpr[i].getProperty()){t.push(this.restExpr[i]);}}else{t=t.concat(this.restExpr[i].getFilterTermsForProperty(p));}}return t;};sap.apf.core.utils.Filter.prototype.getFilterTerms=function(){var t=[];var i;if(this.leftExpr===undefined){return t;}if(this.leftExpr instanceof sap.apf.core.utils.Filter){t=this.leftExpr.getFilterTerms();}else{t.push(this.leftExpr);}for(i=0;i<this.restExpr.length;i++){if(this.restExpr[i]instanceof sap.apf.core.utils.FilterTerm){t.push(this.restExpr[i]);}else{t=t.concat(this.restExpr[i].getFilterTerms());}}return t;};sap.apf.core.utils.Filter.prototype.isConsistentWithFilter=function(p,v){var i;var b=false;if(this.leftExpr===undefined){return true;}if(this.levelOperator===undefined){return this.leftExpr.isConsistentWithFilter(p,v);}if(this.levelOperator===sap.apf.core.constants.BooleFilterOperators.AND){if(!this.leftExpr.isConsistentWithFilter(p,v)){return false;}for(i=0;i<this.restExpr.length;i++){if(!this.restExpr[i].isConsistentWithFilter(p,v)){return false;}}return true;}if(this.levelOperator===sap.apf.core.constants.BooleFilterOperators.OR){if(d(this.leftExpr,p)){b=true;if(this.leftExpr.isConsistentWithFilter(p,v)){return true;}}for(i=0;i<this.restExpr.length;i++){if(d(this.restExpr[i],p)){b=true;if(this.restExpr[i].isConsistentWithFilter(p,v)){return true;}}}return!b;}function d(f,p){if(f instanceof sap.apf.core.utils.FilterTerm){return f.getProperty()===p;}return f.getProperties().indexOf(p)>=0;}};sap.apf.core.utils.Filter.prototype.removeTermsByProperty=function(p){var i,r,R;if(this.leftExpr===undefined){return this.copy();}r=this.leftExpr.removeTermsByProperty(p);if(r instanceof sap.apf.core.utils.FilterTerm){r=new sap.apf.core.utils.Filter(this.messageHandler,r.getProperty(),r.getOp(),r.getValue(),r.getHighValue());}if(this.levelOperator===undefined){return r;}for(i=0;i<this.restExpr.length;i++){R=this.restExpr[i].removeTermsByProperty(p);if(r===undefined){if(R instanceof sap.apf.core.utils.FilterTerm){r=new sap.apf.core.utils.Filter(this.messageHandler,R);}else{r=R;}}else if(R!==undefined){if(this.levelOperator===sap.apf.core.constants.BooleFilterOperators.AND){r.addAnd(R);}else{r.addOr(R);}}}if(r){return new sap.apf.core.utils.Filter(this.messageHandler,r);}};sap.apf.core.utils.Filter.prototype.removeTerms=function(p,o,v){var i;if(this.leftExpr===undefined){return this.copy();}var f=this.leftExpr.removeTerms(p,o,v);var F;if(f instanceof sap.apf.core.utils.FilterTerm){f=new sap.apf.core.utils.Filter(this.messageHandler,f.getProperty(),f.getOp(),f.getValue(),f.getHighValue());}if(this.levelOperator===undefined){return f;}for(i=0;i<this.restExpr.length;i++){F=this.restExpr[i].removeTerms(p,o,v);if(f===undefined){if(F instanceof sap.apf.core.utils.FilterTerm){f=new sap.apf.core.utils.Filter(this.messageHandler,F);}else{f=F;}}else if(F!==undefined){if(this.levelOperator===sap.apf.core.constants.BooleFilterOperators.AND){f.addAnd(F);}else{f.addOr(F);}}}return f;};sap.apf.core.utils.Filter.prototype.addOr=function(b,d,e,f){var F;if(b instanceof sap.apf.core.utils.Filter||b instanceof sap.apf.core.utils.FilterTerm){F=b;}else if(b!==undefined&&d!==undefined&&e!==undefined){F=new sap.apf.core.utils.FilterTerm(this.messageHandler,b,d,e,f);}else{this.messageHandler.check(false,"sap.apf.core.utils.Filter.addOr: wrong arguments in construction of  Filter");}if(this.leftExpr===undefined){this.leftExpr=F;return this;}if(this.levelOperator===undefined){this.levelOperator=sap.apf.core.constants.BooleFilterOperators.OR;}this.restExpr.push(F);this.messageHandler.check(this.levelOperator===sap.apf.core.constants.BooleFilterOperators.OR,"sap.apf.core.utils.Filter - addOr wrong operation");return this;};sap.apf.core.utils.Filter.prototype.addAnd=function(b,d,e,f){var F;if(b instanceof sap.apf.core.utils.Filter||b instanceof sap.apf.core.utils.FilterTerm){F=b;}else if(b!==undefined&&d!==undefined&&e!==undefined){F=new sap.apf.core.utils.FilterTerm(this.messageHandler,b,d,e,f);}else{this.messageHandler.check(false,"sap.apf.core.utils.Filter.addAnd: wrong arguments in construction of  Filter");}if(this.leftExpr===undefined){this.leftExpr=F;return this;}if(this.levelOperator===undefined){this.levelOperator=sap.apf.core.constants.BooleFilterOperators.AND;}this.messageHandler.check(this.levelOperator===sap.apf.core.constants.BooleFilterOperators.AND,"sap.apf.core.utils.Filter - addAnd wrong operation");this.restExpr.push(F);return this;};sap.apf.core.utils.Filter.prototype.toUrlParam=function(b){var e="";if(this.leftExpr===undefined){return"";}e=this.leftExpr.toUrlParam(b);var i=0;var l=this.restExpr.length;var C="";if(l===0){return e;}if(this.levelOperator===sap.apf.core.constants.BooleFilterOperators.AND){C=c;}else{C=a;}var r="";for(i=0;i<l;i++){r=this.restExpr[i].toUrlParam(b);if(e===""){e=r;}else if(r!==""){e=e+C+r;}}return'('+e+')';};sap.apf.core.utils.Filter.prototype.mapToSapUI5FilterExpression=function(){var i,e,f=[];if(this.leftExpr===undefined){return{};}if(this.restExpr.length===0){return this.leftExpr.mapToSapUI5FilterExpression();}f.push(this.leftExpr.mapToSapUI5FilterExpression());for(i=0;i<this.restExpr.length;i++){f.push(this.restExpr[i].mapToSapUI5FilterExpression());}e={filters:f,and:this.levelOperator===sap.apf.core.constants.BooleFilterOperators.AND};return e;};sap.apf.core.utils.Filter.prototype.overwriteWith=function(f){var p=f.getProperties();var r;if(p.length!==0){r=this.removeTermsByProperty(p);if(r===undefined){return f.copy();}r.addAnd(f);return r;}return this.copy();};sap.apf.core.utils.Filter.prototype.reduceToProperty=function(){var p=[];var P;switch(arguments.length){case 1:P=arguments[0];if(P instanceof Array){p=P;}else{p.push(P);}break;default:p=Array.prototype.slice.call(arguments,0);}var f=s(this.getProperties(),p);return this.copy().removeTermsByProperty(f)||new sap.apf.core.utils.Filter(this.messageHandler);function s(S,b){var i;var r=[];var h={};var l=S?S.length:0;var d=b?b.length:0;for(i=0;i<d;i++){h[b[i]]=undefined;}for(i=0;i<l;i++){if(!(S[i]in h)){r.push(S[i]);}}return r;}};sap.apf.core.utils.Filter.prototype.isFilterTerm=function(){if(this.restExpr.length>0){return false;}if(!this.leftExpr){return false;}if(this.leftExpr instanceof sap.apf.core.utils.FilterTerm){return true;}return this.leftExpr.isFilterTerm();};sap.apf.core.utils.Filter.prototype.traverse=function(v){if(!this.leftExpr){return v.processEmptyFilter();}if(this.leftExpr&&this.restExpr.length===0){if(this.leftExpr instanceof sap.apf.core.utils.FilterTerm){return v.processTerm(this.leftExpr);}return this.leftExpr.traverse(v);}if(this.levelOperator===sap.apf.core.constants.BooleFilterOperators.AND){return v.processAnd(this.leftExpr,this.restExpr,this);}if(this.levelOperator===sap.apf.core.constants.BooleFilterOperators.OR){return v.processOr(this.leftExpr,this.restExpr,this);}this.messageHandler.check(false,'undefined case in traverse()');return false;};sap.apf.core.utils.Filter.prototype.isDisjunctionOverEqualities=function(){var i=true;if(this.levelOperator===sap.apf.core.constants.BooleFilterOperators.AND){return false;}if(this.getProperties().length>1){return false;}if(this.leftExpr instanceof sap.apf.core.utils.Filter){if(this.leftExpr.getFilterTerms().length>1&&!this.leftExpr.isOr()){return false;}}this.getFilterTerms().forEach(function(f){if(f.getOp()!==sap.apf.core.constants.FilterOperators.EQ){i=false;}});this.restExpr.forEach(function(r){if(r instanceof sap.apf.core.utils.Filter){if(r.getFilterTerms().length>1){i=false;}}});return i;};sap.apf.core.utils.Filter.prototype.mapToSelectOptions=function(g){var d=jQuery.Deferred();var p;var t=this;g(b);function b(e){p=e;var v=new V();v.process(t);d.resolve(v.getSelectionVariant());}function V(){var s={};s.SelectOptions=[];s.Parameters=[];function e(i){var j;s.SelectOptions.forEach(function(k){if(k.PropertyName===i){j=k;}});if(!j){j={PropertyName:i,Ranges:[]};s.SelectOptions.push(j);}return j.Ranges;}function f(i){var r=e(i.getProperty());if(i.getHighValue()!==undefined&&i.getHighValue()!==null){r.push({Sign:'I',Option:i.getOp(),Low:i.getValue(),High:i.getHighValue()});}else{r.push({Sign:'I',Option:i.getOp(),Low:i.getValue()});}}function h(i){s.Parameters.push({PropertyName:i.getProperty(),PropertyValue:i.getValue()});}this.getSelectionVariant=function(){if(s.SelectOptions.length>0||s.Parameters.length>0){return s;}return{};};this.processEmptyFilter=function(){return;};this.processTerm=function(i){if(jQuery.inArray(i.getProperty(),p)===-1){f(i);}else{h(i);}};this.processAnd=function(i,F){this.process(i);F.forEach(function(j){this.process(j);}.bind(this));};this.processOr=function(i,F){this.process(i);F.forEach(function(j){this.process(j);}.bind(this));};this.process=function(i){i.traverse(this);};}return d.promise();};sap.apf.core.utils.Filter.createFromArray=function(m,p,d,I){var l=p.length;var i;var n;var j;var f;var F;var o;m.check(p instanceof Array&&p.length>0,"sap.apf.core.utils.Filter.createFromArray incorrect argument aProperties");m.check(d instanceof Array,"sap.apf.core.utils.Filter.createFromArray incorrect argument aData");if(I.length>0){for(i=0;i<I.length;++i){F=undefined;n=I[i];if(!d[n]){continue;}for(j=0;j<l;j++){o=new sap.apf.core.utils.Filter(m,p[j],sap.apf.core.constants.FilterOperators.EQ,d[n][p[j]]);if(F===undefined){F=new sap.apf.core.utils.Filter(m,o);}else{F.addAnd(o);}}if(f===undefined){f=new sap.apf.core.utils.Filter(m,F);}else{f.addOr(F);}}return f;}return new sap.apf.core.utils.Filter(m);};sap.apf.core.utils.Filter.createEmptyFilter=function(m,p){m.check(jQuery.isArray(p)&&p.length>0,"sap.apf.core.utils.Filter.createEmptyFilter - array with property names expected");return new sap.apf.core.utils.Filter(m,p[0],sap.apf.core.constants.FilterOperators.EQ,'').addAnd(p[0],sap.apf.core.constants.FilterOperators.NE,'');};sap.apf.core.utils.Filter.transformUI5FilterToInternal=function(m,u){return t(u,u.and);function t(u,A){var r=new sap.apf.core.utils.Filter(m);var s;if(u.filters){u.filters.forEach(function(f){if(f.filters){s=t(f,f.and);if(A){r.addAnd(s);}else{r.addOr(s);}}else if(f.path){if(A){r.addAnd(f.path,f.operator,f.value1,f.value2);}else{r.addOr(f.path,f.operator,f.value1,f.value2);}}});}else{r=new sap.apf.core.utils.Filter(m,u.path,u.operator,u.value1,u.value2);}return r;}};}());};if(!jQuery.sap.isDeclared('sap.apf.core.utils.filterSimplify')){
/*
 * Created by d025375 on 24.05.2015.
 * Copyright(c) 2015 SAP SE
 */
jQuery.sap.declare('sap.apf.core.utils.filterSimplify');(function(){'use strict';sap.apf.core.utils.CollectPropertiesAndValuesVisitor=function(){var t=this;var p=[];var v=[];var a=true;var b=true;var n=0;var c=0;var d=0;var e=0;function f(g){var i,l=p.length;for(i=0;i<l;i++){if(p[i]===g){return;}}p.push(g);}this.getProperties=function(){return p.slice(0);};this.getValues=function(){return v.slice(0);};this.isWellFormed=function(){return a&&b&&p.length<=1;};this.isEmptyFilter=function(){return n===0&&c===0&&d>0&&e===0;};this.processEmptyFilter=function(){d++;};this.processAnd=function(g,F){n++;b=false;this.process(g);this.processAndArray(F);};this.processAndArray=function(F){F.forEach(function(g){t.process(g);});};this.processOr=function(g,F){c++;this.process(g);this.processOrArray(F);};this.processOrArray=function(F){F.forEach(function(g){t.process(g);});};this.processTerm=function(g){e++;var h=g.getProperty();f(h);switch(g.getOp()){case sap.apf.core.constants.FilterOperators.EQ:v.push(g.getValue());return;default:a=false;return;}};this.process=function(g){if(g instanceof sap.apf.core.utils.FilterTerm){this.processTerm(g);}else{g.traverse(this);}};};sap.apf.core.utils.CollectChildrenOfAndNodeVisitor=function(){this.processEmptyFilter=function(){return null;};this.processTerm=function(t){return[t];};this.processAnd=function(f,F){var r=[];r.push(f);F.forEach(function(a){r.push(a);});return r;};this.processOr=function(){return null;};this.process=function(f){if(f instanceof sap.apf.core.utils.FilterTerm){this.processTerm(f);}else{return f.traverse(this);}};};sap.apf.core.utils.FilterReduction=function(){var t=this;this.transformFilter=function(f){var T=[];var p;var c;if(f){f.forEach(function(a){if(a instanceof sap.apf.core.utils.FilterTerm){T.push({property:a.getProperty(),values:[a.getValue()]});}else if(a instanceof sap.apf.core.utils.Filter){p=a.getProperties();c=new sap.apf.core.utils.CollectPropertiesAndValuesVisitor();c.process(a);T.push({property:p[0],values:c.getValues()});}});}return T;};this.intersection=function(a,b){var r={};var l=a.values;var c=b.values;var d=[];var e={};var i,f=l.length;var j,g=c.length;for(i=0;i<f;i++){e[l[i]]=l[i];}for(j=0;j<g;j++){if(e[c[j]]!==undefined&&d.indexOf(c[j])<0){d.push(c[j]);}}r.property=a.property;r.values=d;return r;};function F(m){this.reducers=[];this.disjunctions=[];this.processTerm=function(a){var w=new sap.apf.core.utils.Filter(m,a);if(a.getOp()===sap.apf.core.constants.FilterOperators.EQ){this.disjunctions.push(w);}else{this.reducers.push(w);}};this.processOr=function(l,f,o){var i=new sap.apf.core.utils.CollectPropertiesAndValuesVisitor();i.process(o);if(i.isWellFormed()){this.disjunctions.push(o);}else{this.reducers.push(o);}};this.processAnd=function(l,f,a){var s=t.filterSeparation(a,m);this.disjunctions=this.disjunctions.concat(s.disjunctions);this.reducers=this.reducers.concat(s.reducers);};this.processEmptyFilter=function(){};this.process=function(a){a.traverse(this);};}this.filterSeparation=function(f,m){var c=new sap.apf.core.utils.CollectChildrenOfAndNodeVisitor();var a=c.process(f);var v;if(!a){return{reducers:[],disjunctions:[]};}v=new F(m);a.forEach(function(e){e.traverse(v);});return{reducers:v.reducers,disjunctions:v.disjunctions};};this.simplifyTransforms=function(T){var s=[];var r;var p=[];var l=T.length;var n;T.forEach(function(a,i){var j;n=a.property;if(p.indexOf(n)===-1){p.push(n);r=a;for(j=i+1;j<l;++j){if(n===T[j].property){r=t.intersection(r,T[j]);}}s.push(r);}});return s;};this.applyStartFilter=function(s,T){var r=[];var p=s.getProperties();T.forEach(function(a){var R=[];var j;var l=a.values.length;var v;if(p.indexOf(a.property)>-1){for(j=0;j<l;j++){v=a.values[j];if(s.isConsistentWithFilter(a.property,v)){R.push(v);}}r.push({property:a.property,values:R});}else{r.push(a);}});return r;};this.simplifyInStartFilter=function(s,T){var r=s;T.forEach(function(a){if(r){r=r.removeTermsByProperty(a.property);}});return r;};this.containsContradiction=function(m,T){var i=false;T.forEach(function(a){if(a.values.length===0){i=true;}});if(i){return i;}return i;};this.rebuildDisjunction=function(m,a){var r=new sap.apf.core.utils.Filter(m);var p=a.property;var v=a.values;v.forEach(function(b){var f=new sap.apf.core.utils.FilterTerm(m,p,sap.apf.core.constants.FilterOperators.EQ,b);r.addOr(f);});return r;};this.filterReduction=function(m,f){var c=this;function a(R){var g=[];R.forEach(function(h){g.push(t.rebuildDisjunction(m,h));});return g;}function b(g,h){h.forEach(function(i){g.addAnd(i);});}function d(g,h){var i;var R=h;var j=[];var k;for(i=0;i<g.length;++i){R=c.applyStartFilter(g[i],h);if(c.containsContradiction(m,R)){return{contradiction:f};}k=c.simplifyInStartFilter(g[i],h);if(k){j.push(k);}}return{reducedTransforms:R,simplifiedReducers:j};}var s;var D;var T;var S;var r;var e;if(f.isFilterTerm()||f.isOr()||f.isEmpty()){return f;}s=this.filterSeparation(f,m);D=s.disjunctions;T=this.transformFilter(D);S=this.simplifyTransforms(T);if(this.containsContradiction(m,S)){return f;}e=d(s.reducers,S);if(e.contradiction){return e.contradiction;}r=new sap.apf.core.utils.Filter(m);b(r,e.simplifiedReducers);b(r,a(e.reducedTransforms));return r;};};}());};if(!jQuery.sap.isDeclared('sap.apf.modeler.core.textPool')){
/*!
 * SAP APF Analysis Path Framework
 *
 * (c) Copyright 2012-2014 SAP SE. All rights reserved
 */
jQuery.sap.declare("sap.apf.modeler.core.textPool");jQuery.sap.require('sap.ui.core.format.DateFormat');(function(){'use strict';sap.apf.modeler.core.TextPool=function(a,b,e){var m=a.instance.messageHandler;var p=a.instance.persistenceProxy;var H=a.constructor.hashtable;var h=new H(m);var k=new H(m);var g=new H(m);var c=0;var d={TextElement:sap.apf.core.constants.textKeyForInitialText,Language:sap.apf.core.constants.developmentLanguage,TextElementType:"XFLD",TextElementDescription:"",MaximumLength:10,Application:b,TranslationHint:""};function f(t,j){var n=h.getKeys();var i,o=n.length;var q=j.MaximumLength||10;var r=j.TranslationHint||"";var s;for(i=0;i<o;i++){s=h.getItem(n[i]);if((s.TextElementDescription===t)&&(s.MaximumLength===q)&&(s.TranslationHint===r)){return n[i];}}return undefined;}this.removeTexts=function(t,n,o){var q=[];var i,r;function s(u){var j;if(!u){for(j=0;j<r;j++){h.removeItem(t[j]);}}o(u);}r=t.length;if(r===0){o(undefined);return;}for(i=0;i<r;i++){if(t[i]===sap.apf.core.constants.textKeyForInitialText){continue;}q.push({method:"DELETE",entitySetName:"texts",inputParameters:[{name:'TextElement',value:t[i]},{name:'Language',value:sap.apf.core.constants.developmentLanguage}]});}p.doChangeOperationsInBatch(q,s,n);};this.isInitialTextKey=function(t){return(t===sap.apf.core.constants.textKeyForInitialText);};this.addTextsAndSave=function(t,j,n){function o(x,y){return(x.TextElement===y.TextElement&&x.TextElementDescription===y.TextElementDescription&&x.MaximumLength===y.MaximumLength&&x.Language===y.Language&&x.TranslationHint===y.TranslationHint);}var i;var q=t.length;var r;var s=[];var u=[];var v=[];var w;for(i=0;i<q;i++){if(t[i]===sap.apf.core.constants.textKeyForInitialText){continue;}r=h.getItem(t[i].TextElement);if(r){if(!o(r,t[i])){s.push(t[i]);h.setItem(t[i].TextElement,t[i]);}}else{u.push(t[i]);h.setItem(t[i].TextElement,t[i]);}}q=s.length;for(i=0;i<q;i++){w=[{name:'TextElement',value:s[i].TextElement},{name:'Language',value:s[i].Language}];s[i].MaximumLength=parseInt(s[i].MaximumLength,10);v.push({method:"PUT",entitySetName:"texts",data:s[i],inputParameters:w});}q=u.length;for(i=0;i<q;i++){u[i].MaximumLength=parseInt(u[i].MaximumLength,10);v.push({method:"POST",entitySetName:"texts",data:u[i]});}if(v.length>0){p.doChangeOperationsInBatch(v,j,n);}else{j(undefined);}};this.exportTexts=function(){var t=sap.apf.utils.renderHeaderOfTextPropertyFile(b,m);return t+sap.apf.utils.renderTextEntries(h,m);};this.get=function(i){var j,n;if(i===sap.apf.core.constants.textKeyForInitialText){return d;}if(h.hasItem(i)){return h.getItem(i);}if(k.hasItem(i)){j=k.getItem(i);if(j.TextElementDescription){return j;}return h.getItem(j);}n=jQuery.extend({},true,d);n.TextElement=i;n.TextElementDescription=i;return n;};this.getPersistentKey=function(i){return i;};this.setText=function(t,i){var j;var u=function(o,q,r){if(r){m.putMessage(r);}if(o){h.setItem(o.TextElement,o);j=o.TextElement;}};var n={TextElement:"",Language:sap.apf.core.constants.developmentLanguage,TextElementType:i.TextElementType,TextElementDescription:t,MaximumLength:i.MaximumLength||10,Application:b,TranslationHint:i.TranslationHint||""};if(!t){return sap.apf.core.constants.textKeyForInitialText;}j=f(t,i);if(j){return j;}c++;p.create('texts',n,u,false);return j;};this.getTextKeys=function(t){var j=h.getKeys();var i,n,o=j.length;var q=[];for(i=0;i<o;i++){n=h.getItem(j[i]);if(t&&n.TextElementType!==t){continue;}if(g.hasItem(j[i])){q.push(g.getItem(j[i]));}else{q.push(j[i]);}}return q;};this.getTextsByTypeAndLength=function(t,j){var n=h.getKeys();var i,o,q=n.length;var r=[];for(i=0;i<q;i++){o=h.getItem(n[i]);if(o.TextElementType===t&&o.MaximumLength===j){if(g.hasItem(n[i])){r.push({TextElement:g.getItem(n[i]),TextElementDescription:o.TextElementDescription});}else{r.push({TextElement:n[i],TextElementDescription:o.TextElementDescription});}}}return r;};function l(){var i,j;j=e.length;for(i=0;i<j;i++){if(e[i].TextElement){h.setItem(e[i].TextElement,e[i]);}}}l();};}());};if(!jQuery.sap.isDeclared('sap.apf.modeler.ui.controller.configurationList.controller')){jQuery.sap.declare('sap.apf.modeler.ui.controller.configurationList.controller');sap.ui.controller("sap.apf.modeler.ui.controller.configurationList",{onInit:function(){var c=this.getOwnerComponent();if(c!==undefined){this.oCoreApi=c.oCoreApi;this._setDisplayText();}this._instantiateToolbarView();this._instantiateAPFTree();this._instantiateTitleAndBreadCrumbView();this._addConfigStyleClass();this.oModel=new sap.ui.model.json.JSONModel({aConfigDetails:[]});this.getView().setModel(this.oModel);this.bProgramaticSelection=false;this.modelUpdateDeferred={};sap.apf.modeler.ui.utils.APFRouter.patternMatch(this);},_instantiateToolbarView:function(){var t=new sap.ui.view({viewName:"sap.apf.modeler.ui.view.toolbar",type:"XML",viewData:{oConfigListInstance:this}});this.toolbarController=t.getController();this.byId("idConfigMasterData").insertItem(t,0);},_instantiateAPFTree:function(){this.oTreeInstance=this.byId("idConfigTree");this.oTreeInstance.setTranslationFunction(this.oCoreApi.getText);var d;if(this.oCoreApi.getRepresentationTypes()[0].metadata){d=this.oCoreApi.getRepresentationTypes()[0].id;}this.oTreeInstance.setDefaultRepresentationType(d);},_instantiateTitleAndBreadCrumbView:function(){this.oTitleBreadCrumbView=new sap.ui.view({viewName:"sap.apf.modeler.ui.view.titleBreadCrumb",type:"XML",viewData:{getText:this.oCoreApi.getText}});this.oTitleBreadCrumbController=this.oTitleBreadCrumbView.getController();this.byId("idConfigDetail").insertItem(this.oTitleBreadCrumbView,0);this.oBreadCrumb=this.oTitleBreadCrumbView.byId("IdBreadCrumb");},setConfigListMasterTitle:function(t){this.byId("idConfigTitleMaster").setText(this.oCoreApi.getText("configurationObjectTitle")+" : "+t);},onAfterRendering:function(){var s=this;this.oTreeInstance.onAfterRendering=function(){s._setHeightForTree();};},_setHeightForTree:function(){var v=this;var t=this.oTreeInstance;var w=jQuery(v.byId("idConfigMasterData").getDomRef()).width();var h=jQuery(window).height();var a=100;var b=jQuery(v.byId("idConfigMasterData").getItems()[0].getDomRef()).height();var c=jQuery(v.byId("configPage").getDomRef()).find("header").height();var f=jQuery(v.byId("configPage").getDomRef()).find("footer").height();var o;if(b>0){o=a+b+c+f;}else{o=205;}t.setHeight(h-o+"px");t.setWidth(w+"px");sap.apf.modeler.ui.utils.helper.onResize(function(){w=jQuery(v.byId("idConfigMasterData").getDomRef()).width();h=jQuery(v.byId("configPage").getDomRef()).height();t.setHeight(h-o+"px");t.setWidth(w+"px");});},_setDisplayText:function(){this.byId("configPage").setTitle(this.oCoreApi.getText("configModelerTitle"));this.byId("idSavebutton").setText(this.oCoreApi.getText("save"));this.byId("idCancelbutton").setText(this.oCoreApi.getText("cancel"));this.byId("idExportbutton").setText(this.oCoreApi.getText("export"));this.byId("idExecuteButton").setText(this.oCoreApi.getText("execute"));},_addConfigStyleClass:function(){this.getView().addStyleClass("sapUiSizeCompact");this.byId("idConfigTree").addStyleClass("configTree");this.byId("idConfigTitleMaster").addStyleClass("configTitle");this.byId("idConfigMasterData").addStyleClass("configMasterData");this.byId("idConfigDetailData").addStyleClass("configDetailData");},_setSubViewContainerHeight:function(s){var S=this;var a=s.getContent()[0].getItems()[0];var h=jQuery(window).height();var t=jQuery(this.byId("idConfigTitleMaster").getDomRef()).outerHeight()+jQuery(this.byId("idConfigTitleMaster").getDomRef()).offset().top+25;var b=jQuery(this.byId("idConfigMasterData").getItems()[0].getDomRef()).height();var c=jQuery(this.byId("configPage").getDomRef()).find("header").height();var f=jQuery(this.byId("configPage").getDomRef()).find("footer").height();var o,d;if(b>0){o=t+b+c+f;}else{o=265;}var e=h-o+"px";a.setHeight(e);var g=jQuery(this.byId("idConfigDetailData").getDomRef()).width();if(g>0){d=jQuery(this.byId("idConfigMasterData").getDomRef()).offset().left;}else{g=1015;d=15;}var i=g-d;var j=i+"px";a.setWidth(j);sap.apf.modeler.ui.utils.helper.onResize(function(){h=jQuery(S.byId("configPage").getDomRef()).height();e=h-o+"px";a.setHeight(e);g=jQuery(S.byId("idConfigDetailData").getDomRef()).width();i=g-d;j=i+"px";a.setWidth(j);});},_setSubView:function(s){this.oSubView=s;},_getSubView:function(){return this.oSubView;},updateSubView:function(p){var s=this;var P=this._getSubView();var d=this.byId("idConfigDetailData");var v=this.getSPathFromURL(p);this.configurationHandler.memorizeConfiguration(p.arguments.configId);if(P){P.destroy();}if(p.arguments.configId.indexOf("newConfig")===0){this.modelUpdateDeferred[this.byId("idConfigTree").getModel().getData().aConfigDetails.length-1]=new jQuery.Deferred();}var S=new sap.ui.view({viewName:"sap.apf.modeler.ui.view."+v.objectType,type:"XML",viewData:{oParams:p,updateConfigTree:s.updateConfigTree.bind(s),updateSelectedNode:s.updateSelectedNode.bind(s),updateTitleAndBreadCrumb:s.updateTitleAndBreadCrumb.bind(s),updateTree:s.updateTree.bind(s),oConfigurationHandler:s.configurationHandler,oApplicationHandler:s.applicationHandler,oConfigurationEditor:s.configEditor,getText:s.oCoreApi.getText,getEntityTypeMetadata:s.oCoreApi.getEntityTypeMetadata,getRepresentationTypes:s.oCoreApi.getRepresentationTypes,oFooter:s.byId("idFooterBarMain"),createMessageObject:s.oCoreApi.createMessageObject,putMessage:s.oCoreApi.putMessage,getAllAvailableSemanticObjects:s.oCoreApi.getAllAvailableSemanticObjects,getSemanticActions:s.oCoreApi.getSemanticActions,getNavigationTargetName:s._getNavigationTargetName.bind(s),setNavigationTargetName:s._setNavigationTargetName.bind(s),getCalatogServiceUri:s.oCoreApi.getCatalogServiceUri}});if(p.name!=="applicationList"){d.removeAllContent();S.placeAt(d);this._setSubViewContainerHeight(S);this._setSubView(S);}},clearTitleAndBreadCrumb:function(){this.oTitleBreadCrumbView.byId("IdFormTitle").setText("");this.oTitleBreadCrumbView.byId("IdBreadCrumb").removeAllContent();},_createLinkForBreadCrumb:function(n,p){var s=this;var l=new sap.m.Link({text:n,press:function(){s._navigateToNode(p);}});return l;},_createTextForBreadCrumb:function(v){var l=new sap.m.Label();l.addStyleClass("dialogText");l.setText(v);return l;},_createIconForBreadCrumb:function(){var b=new sap.ui.core.Icon({src:"sap-icon://open-command-field"});b.addStyleClass("breadCrumbIcon");return b;},_navigateToNode:function(p){var c=this.oTreeInstance.getModel().getContext(p);var n=this.oTreeInstance.getNodeByContext(c);this.oTreeInstance.setSelection(n);},_getAllPossibleNodes:function(p){var n=[];if(p.configId){n.push({id:p.configId,name:p.configurationName,oParams:{arguments:{configId:p.configId}}});}if(p.facetFilterId){n.push({id:p.facetFilterId,name:p.facetFilterName,oParams:{arguments:{configId:p.configId,facetFilterId:p.facetFilterId}}});}if(p.categoryId){n.push({id:p.categoryId,name:p.categoryName,oParams:{arguments:{configId:p.configId,categoryId:p.categoryId}}});}if(p.stepId){n.push({id:p.stepId,name:p.stepName,oParams:{arguments:{configId:p.configId,categoryId:p.categoryId,stepId:p.stepId}}});}if(p.representationId){n.push({id:p.representationId,name:p.representationName,oParams:{arguments:{configId:p.configId,categoryId:p.categoryId,stepId:p.stepId,representationId:p.representationId}}});}if(p.navTargetId){n.push({id:p.navTargetId,name:p.navTargetName,oParams:{arguments:{configId:p.configId,navTargetId:p.navTargetId}}});}return n;},_breadCrumbCreation:function(s,t){for(var i=0;i<s.length;i++){var p=this.getSPathFromURL(s[i].oParams).sPath;var l;if(i===1){l=this._createTextForBreadCrumb(t);this.oBreadCrumb.addContent(l);var I=this._createIconForBreadCrumb();this.oBreadCrumb.addContent(I);}if(i!==s.length-1){var L=this._createLinkForBreadCrumb(s[i].name,p);this.oBreadCrumb.addContent(L);var o=this._createIconForBreadCrumb();this.oBreadCrumb.addContent(o);}else{l=this._createTextForBreadCrumb(s[i].name);this.oBreadCrumb.addContent(l);}}},updateTitleAndBreadCrumb:function(t){var f;var s=this.oTreeInstance.getSelection();var S=s?this.oTreeInstance.getAPFTreeNodeContext(s):undefined;var n=S?S.nodeObjectType:undefined;var p=S?this.oTreeInstance.getParentNodeContext(S):undefined;if(t){f=t;}else{if(n){var a=s.getText();f=this.oCoreApi.getText(n)+": "+a;}}if(p){if(this.oBreadCrumb){this.oBreadCrumb.removeAllContent();}var o=this._getAllPossibleNodes(p);var T;switch(n){case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION:this._breadCrumbCreation(o);break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.FACETFILTER:T=this.oCoreApi.getText("facetFilter");this._breadCrumbCreation(o,T);break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY:T=this.oCoreApi.getText("category");this._breadCrumbCreation(o,T);break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP:T=this.oCoreApi.getText("category");this._breadCrumbCreation(o,T);break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.REPRESENTATION:T=this.oCoreApi.getText("category");this._breadCrumbCreation(o,T);break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.NAVIGATIONTARGET:T=this.oCoreApi.getText("navigationTarget");this._breadCrumbCreation(o,T);break;default:break;}}this.oTitleBreadCrumbController.setTitleForDetailPage(f);},setSelectionOnTree:function(b){this.toolbarController.enableCopyDeleteButton();this._enableDisableExportAndExecuteButton(true);this.oTreeInstance.setSelectionOnTree(b);},removeSelectionOnTree:function(){this.oTreeInstance.removeSelectionOnTree(this.selectedNode);},updateConfigTree:function(o){var a,n,O,i,b,c,d,e,f;var s=this;o.forEach(function(S){var h;a=s.getSPathFromURL(S.oldContext).sPath;O=a.split("/");i=O[2];b=O[6];d=O[8];e=jQuery.extend(true,{},s.oModel.getData().aConfigDetails[i].configData[1].categories[b].steps[d]);f=e.id;e.isSelected=false;n=s.getSPathFromURL(S.newContext).sPath;c=n.split("/")[6];if(S.removeStep===undefined){if(s.oModel.getData().aConfigDetails[i].configData[1].categories[c].steps){s.oModel.getData().aConfigDetails[i].configData[1].categories[c].steps.forEach(function(p){if(p.id===f){h=true;}});if(h===undefined){s.oModel.getData().aConfigDetails[i].configData[1].categories[c].steps.push(e);}}else{s.oModel.getData().aConfigDetails[i].configData[1].categories[c].steps=[];s.oModel.getData().aConfigDetails[i].configData[1].categories[c].steps.push(e);}}else if(S.removeStep===true){if(s.oModel.getData().aConfigDetails[i].configData[1].categories[c].steps){s.oModel.getData().aConfigDetails[i].configData[1].categories[c].steps.forEach(function(p,q){if(p.id===f){var r=s.oModel.getData().aConfigDetails[i].configData[1].categories[c].steps;r.splice(q,1);s.oModel.getData().aConfigDetails[i].configData[1].categories[c].steps=r;}});if(S.changeCategory===true){var j=s.getSPathFromURL(S.categoryChangeContext).sPath;var k=j.split("/");i=k[2];var l=k[6];var m=k[8];s.oModel.getData().aConfigDetails[i].configData[1].categories[l].steps[m].isSelected=true;s.oModel.getData().aConfigDetails[i].configData[1].categories[l].expanded=true;}}}});this.oModel.updateBindings();var g=o.length;if(o[g-1].changeCategory){sap.ui.core.UIComponent.getRouterFor(this).navTo(o[g-1].oldContext.name,o[g-1].categoryChangeContext.arguments,true);}this.configEditor.setIsUnsaved();},updateSelectedNode:function(p,c){if(p){if(this.oTreeInstance.getSelection()){this.selectedNode=this.oTreeInstance.getSelection();}if(this.selectedNode){if(p.name&&this.selectedNode.getBindingContext()&&this.selectedNode.getBindingContext().getObject()){this.selectedNode.getBindingContext().getObject().name=p.name;this.selectedNode.getBindingContext().getObject().isSelected=true;if(this.selectedNode.getBindingContext().getObject().type===sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.REPRESENTATION||this.selectedNode.getBindingContext().getObject().type===sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.NAVIGATIONTARGET){this.selectedNode.getBindingContext().getObject().icon=p.icon;}this.oModel.updateBindings();}if(p.id&&this.selectedNode.getBindingContext().getObject().id){this.selectedNode.getBindingContext().getObject().id=p.id;if(p.icon){this.selectedNode.getBindingContext().getObject().icon=p.icon;}this.oModel.updateBindings();}else if(p.id&&this.selectedNode.getBindingContext().getObject().AnalyticalConfiguration){this.selectedNode.getBindingContext().getObject().AnalyticalConfiguration=p.id;this.selectedNode.getBindingContext().getObject().expanded=true;}}if((this.selectedNode.getBindingContext().getObject().type===sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION)&&c){sap.ui.core.UIComponent.getRouterFor(this).navTo(this.selectedNode.getBindingContext().getObject().type,c,true);}}},createConfigList:function(){var s=this;this.configList=this.configurationHandler.getList();this.configList.forEach(function(c,i){var C={};C.AnalyticalConfiguration=c.AnalyticalConfiguration;C.name=c.AnalyticalConfigurationName;C.Application=c.Application;C.type=sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION;C.bIsLoaded=false;C.bToggleState=false;C.isSelected=false;C.expanded=false;C.selectable=true;C.hasExpander=true;s.oModel.getData().aConfigDetails.push(C);s.modelUpdateDeferred[i]=new jQuery.Deferred();});this.oModel.updateBindings();},showNoConfigSelectedText:function(){this.byId("idConfigDetailData").removeAllContent();this.clearTitleAndBreadCrumb();var n=new sap.m.Label().addStyleClass("noConfigSelected");n.setText(this.oCoreApi.getText("noConfigSelected"));n.placeAt(this.byId("idConfigDetailData"));this.toolbarController.disableCopyDeleteButton();this._enableDisableExportAndExecuteButton(false);},updateConfigListView:function(){this.selectedNode=this.oTreeInstance.getSelection();if(this.selectedNode===null){if(this.configList.length>1){this.showNoConfigSelectedText();}else{this.oModel.getData().aConfigDetails[0].isSelected=true;this.oModel.getData().aConfigDetails[0].expanded=true;this.configId=this.oModel.getData().aConfigDetails[0].AnalyticalConfiguration;this.oModel.updateBindings();var c={appId:this.appId,configId:this.oModel.getData().aConfigDetails[0].AnalyticalConfiguration};this.selectedNode=this.oTreeInstance.getNodes()[0];this.toolbarController.enableCopyDeleteButton();this._enableDisableExportAndExecuteButton(true);sap.ui.core.UIComponent.getRouterFor(this).navTo(this.oModel.getData().aConfigDetails[0].type,c,true);}}},_getNodeData:function(p,t){var c=this.oModel.getData().aConfigDetails;var n={};var g=function(h){var j={};var k=h||this.configId;for(var i=0;i<c.length;i++){if(c[i].AnalyticalConfiguration===k){j.index=i;j.data=c[i];j.id=c[i].AnalyticalConfiguration;break;}}return j;};var a=function(h){var k=g.call(this,p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION]).index;var l={};for(var i=0;i<c[k].configData.length;i++){if(c[k].configData[i].filters instanceof Array){l.indexConfigData=i;for(var j=0;j<c[k].configData[i].filters.length;j++){if(c[k].configData[i].filters[j].id===h){l.index=j;l.data=c[k].configData[i].filters[j];l.id=c[k].configData[i].filters[j].id;l.ffExpansion=c[k].configData[i].expanded;}}}}return l;};var b=function(h){var k=g.call(this,p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION]).index;var l={};for(var i=0;i<c[k].configData.length;i++){if(c[k].configData[i].categories instanceof Array){l.indexConfigData=i;for(var j=0;j<c[k].configData[i].categories.length;j++){if(c[k].configData[i].categories[j].id===h){l.index=j;l.data=c[k].configData[i].categories[j];l.id=c[k].configData[i].categories[j].id;l.categoryExpansion=c[k].configData[i].expanded;}}}}return l;};var d=function(h){var j=g.call(this,p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION]).index;var k=b.call(this,p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY]).indexConfigData;var l=b.call(this,p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY]).index;var m={};for(var i=0;i<c[j].configData[k].categories[l].steps.length;i++){if(c[j].configData[k].categories[l].steps[i].id===h){m.index=i;m.data=c[j].configData[k].categories[l].steps[i];m.id=c[j].configData[k].categories[l].steps[i].id;}}return m;};var e=function(h){var j=g.call(this,p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION]).index;var k=b.call(this,p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY]).indexConfigData;var l=b.call(this,p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY]).index;var m=d.call(this,p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP]).index;var o={};for(var i=0;i<c[j].configData[k].categories[l].steps[m].representations.length;i++){if(c[j].configData[k].categories[l].steps[m].representations[i].id===h){o.index=i;o.data=c[j].configData[k].categories[l].steps[m].representations[i];o.id=c[j].configData[k].categories[l].steps[m].representations[i].id;}}return o;};var f=function(h){var k=g.call(this,p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION]).index;var l={};for(var i=0;i<c[k].configData.length;i++){if(c[k].configData[i].navTargets instanceof Array){l.indexConfigData=i;for(var j=0;j<c[k].configData[i].navTargets.length;j++){if(c[k].configData[i].navTargets[j].id===h){l.index=j;l.data=c[k].configData[i].navTargets[j];l.id=c[k].configData[i].navTargets[j].id;l.nTExpansion=c[k].configData[i].expanded;}}}}return l;};switch(t){case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION:n=g.call(this,p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION]);break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.FACETFILTER:n=a.call(this,p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.FACETFILTER]);break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY:n=b.call(this,p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY]);break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP:n=d.call(this,p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP]);break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.REPRESENTATION:n=e.call(this,p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.REPRESENTATION]);break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.NAVIGATIONTARGET:n=f.call(this,p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.NAVIGATIONTARGET]);break;default:break;}return n;},_retainNodeState:function(p,t){var c=this._getNodeData(p,sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION).index;if(!this.oModel.getData().aConfigDetails[c].bIsLoaded){return{};}var n=this._getNodeData(p,t);if(!n.data){return{};}return{expanded:n.data.expanded,isSelected:n.data.isSelected};},updateTree:function(){var s=this;var c=[],f=[],n=[],C=[],a=[],b=[];this.oTextPool=this.configurationHandler.getTextPool();var p={};p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION]=this.configId;var d=s._getNodeData(p,sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION).index;var e=this.configId;var F=false;var g=false;var h=false;c=this.configEditor.getCategories();f=this.configEditor.getFacetFilters();n=this.configEditor.getNavigationTargets();var r=this.oCoreApi.getRepresentationTypes();var R={};r.forEach(function(o){var i=o.id;R[i]=o.picture;});c.forEach(function(i){p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY]=i.getId();var o=i;var j=o.getId();b=[];s.configEditor.getCategoryStepAssignments(j).forEach(function(S){var v=s.configEditor.getStep(S);p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY]=j;p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP]=v.getId();var w=s._retainNodeState(p,sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP);var x=v.getRepresentations();var y=x.map(function(z){p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.REPRESENTATION]=z.getId();var A=s._retainNodeState(p,sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.REPRESENTATION);return{id:z.getId(),name:s.oCoreApi.getText(z.getRepresentationType()),type:"representation",isSelected:A.isSelected||false,expanded:A.expanded||false,selectable:true,icon:R[z.getRepresentationType()]};});b.push({id:v.getId(),name:s.oTextPool.get(v.getTitleId())?s.oTextPool.get(v.getTitleId()).TextElementDescription:v.getTitleId(),type:"step",representations:y,isSelected:w.isSelected||false,expanded:w.expanded||false,selectable:true,icon:"sap-icon://BusinessSuiteInAppSymbols/icon-phase"});});var q=s._retainNodeState(p,sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY);if(s.oModel.getData().aConfigDetails[d].bIsLoaded){var t=s._getNodeData(p,sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY);if(t.categoryExpansion){h=true;}}C.push({id:i.getId(),name:s.oTextPool.get(i.labelKey)?s.oTextPool.get(i.labelKey).TextElementDescription:i.labelKey,type:"category",steps:b,isSelected:q.isSelected||false,expanded:q.expanded||false,selectable:true,icon:"sap-icon://open-folder"});});var k=[];f.forEach(function(o){p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.FACETFILTER]=o.getId();var i=s._retainNodeState(p,sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.FACETFILTER);if(s.oModel.getData().aConfigDetails[d].bIsLoaded){var j=s._getNodeData(p,sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.FACETFILTER);if(j.ffExpansion){F=true;}}k.push({id:o.getId(),name:s.oTextPool.get(o.getLabelKey())?s.oTextPool.get(o.getLabelKey()).TextElementDescription:o.getLabelKey(),type:"facetFilter",isSelected:i.isSelected||false,expanded:i.expanded||false,selectable:true,icon:"sap-icon://filter"});});a.push({filters:k,name:s.oCoreApi.getText("facetFilters"),expanded:F,selectable:false});a.push({categories:C,name:s.oCoreApi.getText("categories"),expanded:h,selectable:false});var N=[];var l=function(S,o){p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.NAVIGATIONTARGET]=o.getId();var j=s._retainNodeState(p,sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.NAVIGATIONTARGET);if(s.oModel.getData().aConfigDetails[d].bIsLoaded){var q=s._getNodeData(p,sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.NAVIGATIONTARGET);if(q.nTExpansion){g=true;}}var i,t;for(i=0;i<S.length;i++){if(S[i].id===o.getAction()){t=S[i].text;break;}}N.push({id:o.getId(),name:t||o.getSemanticObject(),type:"navigationTarget",isSelected:j.isSelected||false,expanded:j.expanded||false,selectable:true,icon:o.isStepSpecific()?"sap-icon://pushpin-off":"sap-icon://BusinessSuiteInAppSymbols/icon-where-used"});};var m=function(){var o=n.map(function(q){return q.getId();});var t=[];for(var i=0;i<o.length;i++){for(var j=0;j<N.length;j++){if(o[i]===N[j].id){t[i]=N[j];break;}}}N=t;};var u=function(){var o={};o.configData=a;s.oModel.getData().aConfigDetails[d].bIsLoaded=true;var t=s.oModel.getData().aConfigDetails[d];jQuery.extend(t,o);s.oModel.getData().aConfigDetails[d]=t;s.oModel.getData().aConfigDetails[d].name=s.configurationHandler.getConfiguration(e).AnalyticalConfigurationName;for(var i=0;i<s.oModel.getData().aConfigDetails.length;i++){if(s.modelUpdateDeferred[i]&&s.modelUpdateDeferred[i].state()==="pending"&&n.length===0){s.modelUpdateDeferred[i].resolve(s.oModel.getData());}}if(t.configData[2].navTargets.length>0){s._setNavigationTargetName({configIndexInTree:d});s.modelUpdateDeferred[d].resolve(s.oModel.getData());}s.oModel.updateBindings();};n.forEach(function(o){var P=s.oCoreApi.getSemanticActions(o.getSemanticObject());P.then(function(S){l(S.semanticActions,o);if(N.length===n.length){m();if(a[2]){a.splice(2,2);a.push({navTargets:N,name:s.oCoreApi.getText("navigationTargets"),expanded:g,selectable:false});u();var i=sap.apf.modeler.ui.utils.APFRouter.params;if(i.name==="navigationTarget"){sap.apf.modeler.ui.utils.APFRouter.setCurrentSelectionState(i,s);}}}});});a.push({navTargets:N,name:s.oCoreApi.getText("navigationTargets"),expanded:g,selectable:false});u();},_checkIfKeyExists:function(k,c){var i;if(this.navTargetTextsTable[c]){this.navTargetTextsTable[c].texts.forEach(function(n,a){if(n.key===k){i=a;}});}return i;},_getNavigationTargetName:function(k){var s=this;var v;var n=new jQuery.Deferred();var c=s.getSPathForConfig(s.configId).split('/')[2];if(this.modelUpdateDeferred[c]===undefined){this.modelUpdateDeferred[c]=new jQuery.Deferred();this.modelUpdateDeferred[c].resolve(this.oModel.getData());}jQuery.when(this.modelUpdateDeferred[c]).done(function(m){var i=s._checkIfKeyExists(k,c);if(i!==undefined){v=s.navTargetTextsTable[c].texts[i].value;n.resolve(v);}});return n.promise();},_setNavigationTargetName:function(p){var c=p.configIndexInTree!==undefined?p.configIndexInTree:this.getSPathForConfig(this.configId).split('/')[2];if(jQuery.isEmptyObject(this.navTargetTextsTable)){this.navTargetTextsTable={};}if(!this.navTargetTextsTable[c]){this.navTargetTextsTable[c]={texts:[]};}if(p.key&&p.value){var i=this._checkIfKeyExists(p.key,c);if(i===undefined){var n={};n.key=p.key;n.value=p.value;this.navTargetTextsTable[c].texts.push(n);}else{this.navTargetTextsTable[c].texts[i].value=p.value;}}else{var a=this.oModel.getData().aConfigDetails[c].configData[2].navTargets;for(var b=0;b<a.length;b++){var d={};d.key=a[b].id;d.value=a[b].name;this.navTargetTextsTable[p.configIndexInTree].texts.push(d);}}},_handleToggleTreeNode:function(e){var s=this;var c=e.getSource();var p=c.getBindingContext().sPath;var a=c.getBindingContext().getObject().type;if(a===sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION){var b=p.split('/')[2];if(s.oModel.getData().aConfigDetails[b].bIsLoaded===true){this.oModel.updateBindings();}else{this.configurationHandler.loadConfiguration(this.oModel.getData().aConfigDetails[b].AnalyticalConfiguration,function(d,m){if(m===undefined){s.configEditor=d;s.configId=s.oModel.getData().aConfigDetails[b].AnalyticalConfiguration;s.updateTree();}});}}},getSPathForConfig:function(c){var p;this.oModel.getData().aConfigDetails.forEach(function(a,i){if(a.AnalyticalConfiguration===c){p="/aConfigDetails/"+i;}});return p;},getSPathFromURL:function(p){var v={sPath:undefined,objectType:undefined};var s=this;this.oModel.getData().aConfigDetails.forEach(function(c,i){if(c.AnalyticalConfiguration===p.arguments.configId){v.sPath="/aConfigDetails/"+i;v.objectType=sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION;s.oModel.getData().aConfigDetails[i].expanded=true;if(p.arguments.categoryId!==undefined){s.oModel.getData().aConfigDetails[i].configData[1].categories.forEach(function(a,b){if(a.id===p.arguments.categoryId){v.sPath=v.sPath.concat("/configData/1/categories/"+b);v.objectType=sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY;s.oModel.getData().aConfigDetails[i].configData[1].expanded=true;if(p.arguments.stepId!==undefined){s.oModel.getData().aConfigDetails[i].configData[1].categories[b].steps.forEach(function(d,e){if(d.id===p.arguments.stepId){v.sPath=v.sPath.concat("/steps/"+e);v.objectType=sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP;s.oModel.getData().aConfigDetails[i].configData[1].categories[b].expanded=true;if(p.arguments.representationId!==undefined){s.oModel.getData().aConfigDetails[i].configData[1].categories[b].steps[e].representations.forEach(function(r,f){if(r.id===p.arguments.representationId){s.oModel.getData().aConfigDetails[i].configData[1].categories[b].steps[e].expanded=true;v.sPath=v.sPath.concat("/representations/"+f);v.objectType=sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.REPRESENTATION;}});}}});}}});}if(p.arguments.facetFilterId!==undefined){s.oModel.getData().aConfigDetails[i].configData[0].filters.forEach(function(f,a){if(f.id===p.arguments.facetFilterId){v.sPath=v.sPath.concat("/configData/0/filters/"+a);v.objectType=sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.FACETFILTER;s.oModel.getData().aConfigDetails[i].configData[0].expanded=true;}});}if(p.arguments.navTargetId!==undefined){s.oModel.getData().aConfigDetails[i].configData[2].navTargets.forEach(function(n,a){if(n.id===p.arguments.navTargetId){v.sPath=v.sPath.concat("/configData/2/navTargets/"+a);v.objectType=sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.NAVIGATIONTARGET;s.oModel.getData().aConfigDetails[i].configData[2].expanded=true;}});}}});return v;},_navHandleExpandDelete:function(n,p,a){var s=this;this.selectedNode=this.oTreeInstance.getSelection();var c=this.oModel.getData().aConfigDetails;var I=a||this.oTreeInstance.isConfigurationSwitched(this.oPreviousSelectedNode,this.selectedNode);var g=function(j){var r;for(var i=0;i<c.length;i++){if(c[i].AnalyticalConfiguration===j){r=i;break;}}return r;};var b=function(r){var h=g.call(this,p.configId);var t,u;for(var i=0;i<c[h].configData.length;i++){if(c[h].configData[i].filters instanceof Array){t=i;for(var j=0;j<c[h].configData[i].filters.length;j++){if(c[h].configData[i].filters[j].id===r){u=j;break;}else{u=j;}}}}return{indexConfig:t,indexFilter:u};};var d=function(r){var h=g.call(this,p.configId);var t,u;for(var i=0;i<c[h].configData.length;i++){if(c[h].configData[i].navTargets instanceof Array){t=i;for(var j=0;j<c[h].configData[i].navTargets.length;j++){if(c[h].configData[i].navTargets[j].id===r){u=j;break;}else{u=j;}}}}return{indexConfig:t,indexNavTarget:u};};var e=function(r){var h=g.call(this,p.configId);var t,u;for(var i=0;i<c[h].configData.length;i++){if(c[h].configData[i].categories instanceof Array){t=i;for(var j=0;j<c[h].configData[i].categories.length;j++){if(c[h].configData[i].categories[j].id===r){u=j;break;}else{u=j;}}}}return{indexConfig:t,indexCategory:u};};var f=function(j){var h=g.call(this,p.configId);var k=e.call(this,p.categoryId).indexConfig;var m=e.call(this,p.categoryId).indexCategory;var r;for(var i=0;i<c[h].configData[k].categories[m].steps.length;i++){if(c[h].configData[k].categories[m].steps[i].id===j){r=i;break;}else{r=i;}}return r;};if(p.configId.indexOf(sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.ISNEWCONFIG)===0&&I){this.configurationHandler.removeConfiguration(p.configId,function(i){var C=s.oModel.getData().aConfigDetails;var h=g.call(s,p.configId);s._deleteConfigNavTargetTexts(h,C.length);C.splice(h,1);s.oModel.getData().aConfigDetails=C;});}else{var h,k,l,m,o,q;switch(n.nodeObjectType){case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION:h=g.call(this,p.configId);this.oModel.getData().aConfigDetails[h].isSelected=true;this.oModel.getData().aConfigDetails[h].expanded=true;break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.FACETFILTER:h=g.call(this,p.configId);k=b.call(this,p.facetFilterId).indexConfig;l=b.call(this,p.facetFilterId).indexFilter;this.oModel.getData().aConfigDetails[h].expanded=true;this.oModel.getData().aConfigDetails[h].configData[k].expanded=true;this.oModel.getData().aConfigDetails[h].configData[k].filters[l].expanded=true;break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY:h=g.call(this,p.configId);k=e.call(this,p.categoryId).indexConfig;m=e.call(this,p.categoryId).indexCategory;this.oModel.getData().aConfigDetails[h].expanded=true;this.oModel.getData().aConfigDetails[h].configData[k].expanded=true;break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP:h=g.call(this,p.configId);k=e.call(this,p.categoryId).indexConfig;m=e.call(this,p.categoryId).indexCategory;o=f.call(this,p.stepId);this.oModel.getData().aConfigDetails[h].expanded=true;this.oModel.getData().aConfigDetails[h].configData[k].expanded=true;this.oModel.getData().aConfigDetails[h].configData[k].categories[m].expanded=true;break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.REPRESENTATION:h=g.call(this,p.configId);k=e.call(this,p.categoryId).indexConfig;m=e.call(this,p.categoryId).indexCategory;o=f.call(this,p.stepId);this.oModel.getData().aConfigDetails[h].expanded=true;this.oModel.getData().aConfigDetails[h].configData[k].expanded=true;this.oModel.getData().aConfigDetails[h].configData[k].categories[m].expanded=true;this.oModel.getData().aConfigDetails[h].configData[k].categories[m].steps[o].expanded=true;break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.NAVIGATIONTARGET:h=g.call(this,p.configId);k=d.call(this,p.navTargetId).indexConfig;q=d.call(this,p.navTargetId).indexNavTarget;this.oModel.getData().aConfigDetails[h].expanded=true;this.oModel.getData().aConfigDetails[h].configData[k].expanded=true;this.oModel.getData().aConfigDetails[h].configData[k].navTargets[q].expanded=true;break;default:break;}}this.oModel.updateBindings();},_isNewSubView:function(p){var i=false;if(p.arguments.configId.indexOf(sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.ISNEWCONFIG)===0){i=true;}else{if(p.name===sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION){i=(this.configurationHandler.getConfiguration(p.arguments.configId)!==undefined)?false:true;}else if(p.name===sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY){i=(this.configEditor.getCategory(p.arguments.categoryId)!==undefined)?false:true;}else if(p.name===sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.FACETFILTER){i=(this.configEditor.getFacetFilter(p.arguments.facetFilterId)!==undefined)?false:true;}else if(p.name===sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP){i=(this.configEditor.getStep(p.arguments.stepId)!==undefined)?false:true;}else if(p.name===sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.REPRESENTATION){i=(this.configEditor.getStep(p.arguments.stepId).getRepresentation(p.arguments.representationId)!==undefined)?false:true;}else if(p.name===sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.NAVIGATIONTARGET){i=(this.configEditor.getNavigationTarget(p.arguments.navTargetId)!==undefined)?false:true;}}return i;},_getCurrentConfigurationNode:function(){var p=this.oTreeInstance.getNodes();var c=this.configId;for(var i=0;i<p.length;i++){if(c===p[i].getBindingContext().getObject().AnalyticalConfiguration){return p[i];}}return undefined;},_navMandatoryResetState:function(c,a){var s=c;c.selectedNode=c.oTreeInstance.getSelection();s.bIsSaved=s.configEditor?s.configEditor.isSaved():undefined;var b=(typeof s.byId("idConfigDetailData").getContent()[0].getController==="function")?s.byId("idConfigDetailData").getContent()[0].getController():undefined;c.configurationHandler.memorizeConfiguration(b.getView().getViewData().oParams.arguments.configId);var i=this._isNewSubView(b.getView().getViewData().oParams);if(!i){s.updateTree();var d=s.selectedNode.getBindingContext().getObject();if(d){d.isSelected=true;var e=b.getView().getViewData().oParams.name;var f=sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes;if(e===f.FACETFILTER||e===f.CATEGORY||e===f.NAVIGATIONTARGET){b.updateSubViewInstancesOnReset(s.configEditor);}else{b.oConfigurationEditor=s.configEditor;}b.setDetailData.call(b);s.updateTitleAndBreadCrumb();}else{s.oTreeInstance.setSelection(s._getCurrentConfigurationNode());}if(typeof a==="function"){a();}}else{s.handleConfirmDeletion();}return{bIsSaved:s.bIsSaved,isNewView:i};},_navSaveState:function(s){s();},_navConfigResetState:function(c,a){var s=c;var b=(typeof s.byId("idConfigDetailData").getContent()[0].getController==="function")?s.byId("idConfigDetailData").getContent()[0].getController():undefined;var i=this._isNewSubView(b.getView().getViewData().oParams);if(!i){s.configurationHandler.loadConfiguration(s.configId,function(d,m){if(m===undefined){var b=(typeof s.byId("idConfigDetailData").getContent()[0].getController==="function")?s.byId("idConfigDetailData").getContent()[0].getController():undefined;s.configEditor=d;s.updateTree();var e=s.selectedNode.getBindingContext().getObject();if(e){e.isSelected=true;var f=b.getView().getViewData().oParams.name;var g=sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes;if(f===g.FACETFILTER||f===g.CATEGORY||f===g.NAVIGATIONTARGET){b.updateSubViewInstancesOnReset(s.configEditor);}else{b.oConfigurationEditor=s.configEditor;}b.setDetailData.call(b);s.updateTitleAndBreadCrumb();}else{s.oTreeInstance.setSelection(s._getCurrentConfigurationNode());}if(typeof a==="function"){a();}}});}else{s.handleConfirmDeletion();}},_onTreeNodeSelection:function(e){this.selectedNode=e.getParameter("node");var s=this;var p,P,r;if(!this.bProgramaticSelection){this.oPreviousSelectedNode=this.oTreeInstance.getSelection();this.bIsDifferntConfig=this.oTreeInstance.isConfigurationSwitched(this.oPreviousSelectedNode,this.selectedNode);this.oSelectedNodeDetails=this.oTreeInstance.getAPFTreeNodeContext(this.selectedNode);this.oParentNodeDetails=this.oTreeInstance.getParentNodeContext(this.oSelectedNodeDetails);this.toolbarController.enableCopyDeleteButton();this._enableDisableExportAndExecuteButton(true);var a;if(this.byId("idConfigDetailData").getContent().length>=1){a=(typeof this.byId("idConfigDetailData").getContent()[0].getController==="function")?this.byId("idConfigDetailData").getContent()[0].getController():undefined;}var c=this.selectedNode?this.selectedNode.getId():null;var b=this.oPreviousSelectedNode?this.oPreviousSelectedNode.getId():null;var d=function(){var k=s.oPreviousSelectedNode.getBindingContext().getObject();var l=s.selectedNode.getBindingContext().getObject();k.isSelected=true;l.isSelected=false;s.oModel.updateBindings();};if(c!==b||this.bNavDeletionMode){var n=sap.apf.modeler.ui.utils.navigationHandler.getInstance();var i;if(a!==undefined){i=typeof a.getValidationState==="function"?a.getValidationState.call(a):true;}else{i=true;}var f=this.configEditor?jQuery.extend(true,{},this.configEditor):undefined;this.bIsSaved=f?f.isSaved():undefined;var o;var g=false;var h=this.configurationHandler.getList();if(!i&&(h.length>0)){n.throwMandatoryPopup(this,{yes:function(){var a=(typeof s.byId("idConfigDetailData").getContent()[0].getController==="function")?s.byId("idConfigDetailData").getContent()[0].getController():undefined;var k=s._isNewSubView(a.getView().getViewData().oParams);if(!k){var y=function(q){s.configEditor=s.configurationHandler.restoreMemorizedConfiguration(s.oParentNodeDetails.configId);if(s.bIsSaved===false&&s.configEditor){s.configEditor.setIsUnsaved();}if(typeof q==="function"){q();}s.updateTree();var t=s.selectedNode.getBindingContext().getObject();s.navigateToDifferntView(s.oParentNodeDetails,s.oSelectedNodeDetails);t.isSelected=true;s.oModel.updateBindings();};if(s.bIsSaved===false&&s.bIsDifferntConfig){o(false,function(){y.call(s);});}else{y.call(s);}}else{if(s.bIsSaved===false&&s.bIsDifferntConfig){o(false,function(){var l=s.selectedNode.getBindingContext().sPath;var m=s.oPreviousSelectedNode;s.handleConfirmDeletion(m,l);});}else{var l=s.selectedNode.getBindingContext().sPath;var m=s.oPreviousSelectedNode;s.handleConfirmDeletion(m,l);}}s._navHandleExpandDelete.call(s,s.oSelectedNodeDetails,s.oParentNodeDetails);},no:function(){d();}});g=true;}o=function(k){n.throwLossOfDataPopup(s,{yes:function(l){if(typeof k==="function"){k(function(){l(function(){if(s.oPreviousSelectedNode){var B=s.oPreviousSelectedNode.getBindingContext().sPath;var C=B.split("/");var m=C[2];}s.oModel.getData().aConfigDetails[m].AnalyticalConfiguration=s.configId;});});}else{if(s.oPreviousSelectedNode){p=s.oTreeInstance.getAPFTreeNodeContext(s.oPreviousSelectedNode);P=s.oTreeInstance.getParentNodeContext(p);r=s.configurationHandler.restoreMemorizedConfiguration(P.configId);if(r){s.configEditor=r;}}l(function(){if(s.oPreviousSelectedNode){var B=s.oPreviousSelectedNode.getBindingContext().sPath;var C=B.split("/");var m=C[2];}s.oModel.getData().aConfigDetails[m].AnalyticalConfiguration=s.configId;var q=s.selectedNode.getBindingContext().getObject();s.navigateToDifferntView(s.oParentNodeDetails,s.oSelectedNodeDetails);q.isSelected=true;s.oModel.updateBindings();});}},no:function(){s.configurationHandler.loadConfiguration(s.configId,function(l,m){if(m===undefined){s.configEditor=l;if(s.configId.indexOf(sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.ISNEWCONFIG)===0){s._navHandleExpandDelete.call(s,{},{configId:s.configId},s.oParentNodeDetails);}else{s.updateTree();}s.navigateToDifferntView(s.oParentNodeDetails,s.oSelectedNodeDetails);s._navHandleExpandDelete.call(s,s.oSelectedNodeDetails,s.oParentNodeDetails);}});},cancel:function(){d();}});};if(s.bIsSaved===false&&s.bIsDifferntConfig&&i){o();g=true;}if(!g){if(this.oPreviousSelectedNode&&this.oPreviousSelectedNode.getId()!==this.selectedNode.getId()){var j=this.oPreviousSelectedNode.getBindingContext().getObject();if(j){this.oPreviousSelectedNode.getBindingContext().getObject().isSelected=false;this.oPreviousSelectedNode.setIsSelected(false);}}else{this.selectedNode.getBindingContext().getObject().isSelected=true;}this.navigateToDifferntView(this.oParentNodeDetails,this.oSelectedNodeDetails,this.bIsSaved,this.bIsDifferntConfig);}}}this.bProgramaticSelection=false;this.bNavDeletionMode=false;},navigateToDifferntView:function(p,s,i,I){if((!jQuery.isEmptyObject(p)&&(i===undefined||i))||(!I)){sap.ui.core.UIComponent.getRouterFor(this).navTo(s.nodeObjectType,p,true);}},_deleteConfigNavTargetTexts:function(a,n){var s=this;var b;for(var i=a;i<n-1;i++){this.modelUpdateDeferred[i]=this.modelUpdateDeferred[i+1];}delete this.modelUpdateDeferred[n-1];if(this.navTargetTextsTable){if(this.navTargetTextsTable[a]){delete this.navTargetTextsTable[a];}if(a!==(n-1)){Object.keys(this.navTargetTextsTable).forEach(function(k){k=parseInt(k,10);if(k>a){s.navTargetTextsTable[k-1]=s.navTargetTextsTable[k];b=k;}});if(b!==undefined){delete this.navTargetTextsTable[b];}}}},handleConfirmDeletion:function(s,a){var b=((s===undefined)||(typeof s.preventDefault==="function"))?this.oTreeInstance.getAPFTreeNodeContext(this.oTreeInstance.getSelection()):this.oTreeInstance.getAPFTreeNodeContext(s);var c=this;this.selectedNode=this.oTreeInstance.getSelection();var C,n,N,o,d,i,e,f,g,h;d=b.nodeContext;o=d.split("/");i=o[2];switch(b.nodeObjectType){case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.FACETFILTER:this.configEditor.removeFacetFilter(b.nodeAPFId);e=o[6];var F=this.oModel.getData().aConfigDetails[i].configData[0].filters;F.splice(e,1);this.oModel.getData().aConfigDetails[i].configData[0].filters=F;N=o.slice(0,3);n=N.join("/");break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY:this.configEditor.removeCategory(b.nodeAPFId);f=o[6];var j=this.oModel.getData().aConfigDetails[i].configData[1].categories;j.splice(f,1);this.oModel.getData().aConfigDetails[i].configData[1].categories=j;N=o.slice(0,3);n=N.join("/");break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.NAVIGATIONTARGET:this.configEditor.removeNavigationTarget(b.nodeAPFId);g=o[6];var k=this.oModel.getData().aConfigDetails[i].configData[2].navTargets;k.splice(g,1);this.oModel.getData().aConfigDetails[i].configData[2].navTargets=k;N=o.slice(0,3);n=N.join("/");break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP:var S=this.configEditor.getCategoriesForStep(b.nodeAPFId);var l=b.nodeContext.split("/");i=l[2];S.forEach(function(x){c.configEditor.removeCategoryStepAssignment(x,b.nodeAPFId);c.oModel.getData().aConfigDetails[i].configData[1].categories.forEach(function(y,z){if(y.id===x){c.oModel.getData().aConfigDetails[i].configData[1].categories[z].steps.forEach(function(A,B){if(A.id===b.nodeAPFId){var D=c.oModel.getData().aConfigDetails[i].configData[1].categories[z].steps;D.splice(B,1);c.oModel.getData().aConfigDetails[i].configData[1].categories[z].steps=D;}});}});});N=o.slice(0,7);n=N.join("/");break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.REPRESENTATION:f=o[6];h=o[8];var p=this.oModel.getData().aConfigDetails[i].configData[1].categories[f].steps[h].id;var P=this.configEditor.getStep(p);var m=this.configEditor.getCategoriesForStep(p);P.removeRepresentation(b.nodeAPFId);m.forEach(function(x){c.oModel.getData().aConfigDetails[i].configData[1].categories.forEach(function(y,z){if(y.id===x){c.oModel.getData().aConfigDetails[i].configData[1].categories[z].steps.forEach(function(A,B){if(A.id===p){c.oModel.getData().aConfigDetails[i].configData[1].categories[z].steps[B].representations.forEach(function(D,E){if(D.id===b.nodeAPFId){var R=c.oModel.getData().aConfigDetails[i].configData[1].categories[z].steps[B].representations;R.splice(E,1);c.oModel.getData().aConfigDetails[i].configData[1].categories[z].steps[B].representations=R;}});}});}});});N=o.slice(0,9);n=N.join("/");break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION:var q=false;if(b.nodeAPFId.indexOf("newConfig")===0){q=true;}if(!q){this.configurationHandler.removeConfiguration(b.nodeAPFId,function(x){var r;var t=c.oModel.getData().aConfigDetails;c._deleteConfigNavTargetTexts(parseInt(i,10),t.length);var v=(c.configurationHandler.getList().length>0)?true:false;t.splice(i,1);c.oModel.getData().aConfigDetails=t;c.oModel.updateBindings();if(a){var u=c.oTreeInstance.getParentNodeContext(c.oTreeInstance.getAPFTreeNodeContext(c.selectedNode));sap.ui.core.UIComponent.getRouterFor(c).navTo(c.selectedNode.getBindingContext().getObject().type,u,true);}else{c.clearTitleAndBreadCrumb();c.byId("idConfigDetailData").removeAllContent();if(v){r=new sap.m.Label().addStyleClass("noConfigSelected");r.setText(c.oCoreApi.getText("noConfigSelected"));r.placeAt(c.byId("idConfigDetailData"));c.toolbarController.disableCopyDeleteButton();c._enableDisableExportAndExecuteButton(false);}else{r=new sap.m.Label().addStyleClass("addNewConfig");r.setText(c.oCoreApi.getText("addNewConfig"));r.placeAt(c.byId("idConfigDetailData"));c.toolbarController.disableCopyDeleteButton();c._enableDisableExportAndExecuteButton(false);}}});}else{var r;var t=c.oModel.getData().aConfigDetails;t.splice(i,1);c.oModel.getData().aConfigDetails=t;c.oModel.updateBindings();if(a){var u=c.oTreeInstance.getParentNodeContext(c.oTreeInstance.getAPFTreeNodeContext(c.selectedNode));sap.ui.core.UIComponent.getRouterFor(c).navTo(c.selectedNode.getBindingContext().getObject().type,u,true);}else{c.clearTitleAndBreadCrumb();c.byId("idConfigDetailData").removeAllContent();var v=(this.configurationHandler.getList().length>0)?true:false;if(v){r=new sap.m.Label().addStyleClass("noConfigSelected");r.setText(c.oCoreApi.getText("noConfigSelected"));r.placeAt(c.byId("idConfigDetailData"));c.toolbarController.disableCopyDeleteButton();c._enableDisableExportAndExecuteButton(false);}else{r=new sap.m.Label().addStyleClass("addNewConfig");r.setText(c.oCoreApi.getText("addNewConfig"));r.placeAt(c.byId("idConfigDetailData"));c.toolbarController.disableCopyDeleteButton();c._enableDisableExportAndExecuteButton(false);}}}break;default:break;}if(a){this.bNavDeletionMode=true;}if(b.nodeObjectType!==sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION){this.configEditor.setIsUnsaved();this.clearTitleAndBreadCrumb();this.byId("idConfigDetailData").removeAllContent();n=a||n;C=this.oTreeInstance.getModel().getContext(n);this.oModel.updateBindings();this.selectedNode=this.oTreeInstance.getNodeByContext(C);this.bProgramaticSelection=false;this.oTreeInstance.setSelection(this.selectedNode);if(a){this.selectedNode.getBindingContext().getObject().isSelected=true;this.oModel.updateBindings();}}var w=(this.toolbarController.confirmationDialog===undefined)?false:this.toolbarController.confirmationDialog.isOpen;if(w&&!a){this.toolbarController.confirmationDialog.close();}},handleNavBack:function(){var s;var a=this;if(this.byId("idConfigDetailData").getContent().length>=1){s=(typeof this.byId("idConfigDetailData").getContent()[0].getController==="function")?this.byId("idConfigDetailData").getContent()[0].getController():undefined;}this.selectedNode=this.oTreeInstance.getSelection();this.oSelectedNodeDetails=this.oTreeInstance.getAPFTreeNodeContext(this.selectedNode);this.oParentNodeDetails=this.oTreeInstance.getParentNodeContext(this.oSelectedNodeDetails);var n=sap.apf.modeler.ui.utils.navigationHandler.getInstance();var i;if(s!==undefined){i=typeof s.getValidationState==="function"?s.getValidationState.call(s):true;}else{i=true;}var c=this.configEditor?jQuery.extend(true,{},this.configEditor):undefined;this.bIsSaved=c?c.isSaved():undefined;var b=(a.configurationHandler.getList().length>0)?true:false;var d=false;var e=function(f){if(this.selectedNode){this.selectedNode=null;}this.oModel=new sap.ui.model.json.JSONModel({aConfigDetails:[]});this.getView().setModel(this.oModel);this.navTargetTextsTable={};window.history.go(-1);};if(b){if(!i){n.throwMandatoryPopup(a,{yes:function(){a.configEditor=a.configurationHandler.restoreMemorizedConfiguration(s.getView().getViewData().oParams.arguments.configId);if(a.bIsSaved===false&&a.configEditor){a.configEditor.setIsUnsaved();}var f=a._navMandatoryResetState(a);var g=a.configurationHandler.getList();if(f.bIsSaved===false&&g.length>0){n.throwLossOfDataPopup(a,{yes:function(h){h();e.call(a);},no:function(){a.configurationHandler.resetConfiguration(a.configId);if(a.configId.indexOf(sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.ISNEWCONFIG)===0){a._navHandleExpandDelete.call(a,{},{configId:a.configId},a.oParentNodeDetails);}e.call(a);}});}else{e.call(a);}}});d=true;}var S=(a.bIsSaved===undefined)?true:a.bIsSaved;if(!S&&i){n.throwLossOfDataPopup(a,{yes:function(f){f();e.call(a);},no:function(){a.configurationHandler.resetConfiguration(a.configId);if(a.configId.indexOf(sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.ISNEWCONFIG)===0){a._navHandleExpandDelete.call(a,{},{configId:a.configId},a.oParentNodeDetails);}e.call(a);}});d=true;}}if(!d){e.call(a);}},handleSavePress:function(){var s;var a=this;this.selectedNode=this.oTreeInstance.getSelection();if(this.selectedNode){var b=this.selectedNode.getBindingContext().sPath;var c=b.split("/");var i=c[2];}if(this.byId("idConfigDetailData").getContent().length>=1){s=(typeof this.byId("idConfigDetailData").getContent()[0].getController==="function")?this.byId("idConfigDetailData").getContent()[0].getController():undefined;}var d=function(){var a=this;a.configEditor.save(function(h,m,j){if(j===undefined){a.configurationHandler.memorizeConfiguration(s.getView().getViewData().oParams.arguments.configId);a.oModel.getData().aConfigDetails[i].AnalyticalConfiguration=h;a.oModel.updateBindings();a.oSelectedNodeDetails=a.oTreeInstance.getAPFTreeNodeContext(a.selectedNode);a.oParentNodeDetails=a.oTreeInstance.getParentNodeContext(a.oSelectedNodeDetails);a.navigateToDifferntView(a.oParentNodeDetails,a.oSelectedNodeDetails,true,false);var k=a.oCoreApi.getText("successOnSave");sap.m.MessageToast.show(k,{width:"20em"});}else{var M=a.oCoreApi.createMessageObject({code:"12000"});M.setPrevious(j);a.oCoreApi.putMessage(M);var l=a.oCoreApi.getText("errorOnSave");sap.m.MessageToast.show(l,{width:"20em"});}});};var n=sap.apf.modeler.ui.utils.navigationHandler.getInstance();var e;if(s!==undefined){e=typeof s.getValidationState==="function"?s.getValidationState.call(s):true;}else{e=true;}var f=this.configEditor?jQuery.extend(true,{},this.configEditor):undefined;this.bIsSaved=f?f.isSaved():undefined;var g=false;if(!e){n.throwMandatoryPopup(a,{yes:function(){a.configEditor=a.configurationHandler.restoreMemorizedConfiguration(s.getView().getViewData().oParams.arguments.configId);if(a.bIsSaved===false&&a.configEditor){a.configEditor.setIsUnsaved();}a._navMandatoryResetState(a);d.call(a);}});g=true;}if(!g){d.call(this);this.toolbarController.closeDialog();}},_handleExportButtonPress:function(){if(this.byId("idConfigDetailData").getContent().length>=1){var s=(typeof this.byId("idConfigDetailData").getContent()[0].getController==="function")?this.byId("idConfigDetailData").getContent()[0].getController():undefined;}var e=function(){if(!this.exportConfigurationDialog){this.exportConfigurationDialog=sap.ui.xmlfragment("idExportConfigurationFragment","sap.apf.modeler.ui.fragment.exportConfiguration",this);this.getView().addDependent(this.exportConfigurationDialog);this._setExportConfigDialogText();this._addStyleClassForExportDialog();this.configurationHandler.memorizeConfiguration(s.getView().getViewData().oParams.arguments.configId);}jQuery.sap.syncStyleClass("sapUiSizeCompact",this.getView(),this.exportConfigurationDialog);this.exportConfigurationDialog.open();};this._performExportOrExecute(e.bind(this));},_enableDisableExportAndExecuteButton:function(e){this.byId("idExportbutton").setEnabled(e);this.byId("idExecuteButton").setEnabled(e);},_setExportConfigDialogText:function(){sap.ui.core.Fragment.byId("idExportConfigurationFragment","idExportConfigDialog").setTitle(this.oCoreApi.getText("exportConfig"));sap.ui.core.Fragment.byId("idExportConfigurationFragment","idOpenConfig").setText(this.oCoreApi.getText("openConfig"));sap.ui.core.Fragment.byId("idExportConfigurationFragment","idOpenTextProperty").setText(this.oCoreApi.getText("openTextProperty"));sap.ui.core.Fragment.byId("idExportConfigurationFragment","idCloseButton").setText(this.oCoreApi.getText("close"));},_addStyleClassForExportDialog:function(){sap.ui.core.Fragment.byId("idExportConfigurationFragment","idOpenConfig").addStyleClass("configLink");sap.ui.core.Fragment.byId("idExportConfigurationFragment","idOpenTextProperty").addStyleClass("textPropertyLink");},_handleCloseOfExportDialog:function(){if(this.exportConfigurationDialog.isOpen()){this.exportConfigurationDialog.close();}},_handleOpenConfigLinkPress:function(){var s=this;this.configurationHandler.exportConfiguration(this.configId,function(c){s._openFile(c);});},_handleOpenTextsLinkPress:function(){var s=this;this.configurationHandler.exportConfiguration(this.configId,function(c){var e=s.configurationHandler.exportTexts();s._openFile(e);});},_openFile:function(f){var e=encodeURIComponent(f);var n;n=window.open("about:blank","","_blank");n.document.write("<textarea rows='50' cols='160'readonly>"+decodeURIComponent(e)+"</textarea>");},_performExportOrExecute:function(r){var s,o,n,c,b,i,a,C;var d=false;var e=true;var f=this;f.selectedNode=f.oTreeInstance.getSelection();f.oSelectedNodeDetails=f.oTreeInstance.getAPFTreeNodeContext(f.selectedNode);f.oParentNodeDetails=f.oTreeInstance.getParentNodeContext(f.oSelectedNodeDetails);var g=sap.apf.modeler.ui.utils.navigationHandler.getInstance();if(this.byId("idConfigDetailData").getContent().length>=1){s=(typeof this.byId("idConfigDetailData").getContent()[0].getController==="function")?this.byId("idConfigDetailData").getContent()[0].getController():undefined;}if(s!==undefined){e=typeof s.getValidationState==="function"?s.getValidationState.call(s):true;}var h=this.configEditor?jQuery.extend(true,{},this.configEditor):undefined;this.bIsSaved=h?h.isSaved():undefined;var j=function(c){f.byId("idConfigDetailData").removeAllContent();if(c){a=new sap.m.Label().addStyleClass("noConfigSelected");a.setText(f.oCoreApi.getText("noConfigSelected"));}else{a=new sap.m.Label().addStyleClass("addNewConfig");a.setText(f.oCoreApi.getText("addNewConfig"));}a.placeAt(f.byId("idConfigDetailData"));f.toolbarController.disableCopyDeleteButton();f._enableDisableExportAndExecuteButton(false);};var o;if(!e){g.throwMandatoryPopup(f,{yes:function(){f.configEditor=f.configurationHandler.restoreMemorizedConfiguration(s.getView().getViewData().oParams.arguments.configId);if(f.bIsSaved===false&&f.configEditor){f.configEditor.setIsUnsaved();}n=f._navMandatoryResetState(f);c=(f.configurationHandler.getList().length>0)?true:false;if(c){if(n.bIsSaved===false){o();}else{if(f.oParentNodeDetails.configId.indexOf("newConfig")!==0){r();}}}else{j(c);}}});d=true;}o=function(){g.throwLossOfDataPopup(f,{yes:function(k){f._navSaveState(function(){k(function(l){if(f.selectedNode){b=f.selectedNode.getBindingContext().sPath;C=b.split("/");i=C[2];}f.oModel.getData().aConfigDetails[i].AnalyticalConfiguration=f.configId;f.oModel.updateBindings();r();});});},no:function(){if(f.configId.indexOf(sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.ISNEWCONFIG)===0){f._navHandleExpandDelete.call(f,{},{configId:f.configId},f.oParentNodeDetails);f.clearTitleAndBreadCrumb();f.byId("idConfigDetailData").removeAllContent();c=(f.configurationHandler.getList().length>0)?true:false;j(c);}else{f._navConfigResetState(f,function(){f._navHandleExpandDelete.call(f,f.oSelectedNodeDetails,f.oParentNodeDetails);r();});}}});};if(f.bIsSaved===false&&e){o();d=true;}if(!d){r();}},handleExecuteButtonPress:function(){var s=this.oTreeInstance.getSelection();var e=function(){var S=this.oTreeInstance.getAPFTreeNodeContext(s);var p=this.oTreeInstance.getParentNodeContext(S);this.oCoreApi.navigateToGenericRuntime(p.appId,p.configId,window.open);this.configurationHandler.memorizeConfiguration(p.configId);};this._performExportOrExecute(e.bind(this));}});};if(!jQuery.sap.isDeclared('sap.apf.modeler.ui.controller.facetFilterFRR.controller')){
/*!
 * SAP APF Analysis Path Framework
 *
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
jQuery.sap.declare('sap.apf.modeler.ui.controller.facetFilterFRR.controller');sap.ui.define("sap/apf/modeler/ui/controller/facetFilterFRR.controller",["sap/apf/modeler/ui/controller/requestOptions"],function(B){"use strict";return B.extend("sap.apf.modeler.ui.controller.facetFilterFRR",{setDisplayText:function(){var c=this;var t=c.getView().getViewData().oTextReader;c.byId("idSourceLabel").setText(t("vhSource"));c.byId("idEntityLabel").setText(t("vhEntity"));c.byId("idSelectPropertiesLabel").setText(t("vhSelectProperties"));},handleCopy:function(){var c=this;c.setDetailData();},clearFRRFields:function(){var c=this;c.clearSource();c.setDetailData();},enableOrDisableView:function(){var e=true,c=this;if(c.oParentObject.getUseSameRequestForValueHelpAndFilterResolution()===true){e=false;}c.byId("idSource").setEnabled(e);c.byId("idEntity").setEnabled(e);c.byId("idSelectProperties").setEnabled(e);},getSource:function(){var c=this;return c.oParentObject.getServiceOfFilterResolution();},getAllEntities:function(s){var c=this;return c.oConfigurationEditor.getAllEntitySetsOfService(s);},getEntity:function(){var c=this;return c.oParentObject.getEntitySetOfFilterResolution();},getAllEntitySetProperties:function(s,e){var c=this;return c.oConfigurationEditor.getAllPropertiesOfEntitySet(s,e);},clearSource:function(){var c=this;c.oParentObject.setServiceOfFilterResolution(undefined);c.clearEntity();},clearEntity:function(){var c=this;c.oParentObject.setEntitySetOfFilterResolution(undefined);c.clearSelectProperties();},clearSelectProperties:function(){var c=this;var o=c.oParentObject.getSelectPropertiesOfFilterResolution();o.forEach(function(p){c.oParentObject.removeSelectPropertyOfFilterResolution(p);});},updateSource:function(s){var c=this;c.oParentObject.setServiceOfFilterResolution(s);},updateEntity:function(e){var c=this;c.oParentObject.setEntitySetOfFilterResolution(e);},updateSelectProperties:function(s){var c=this;c.clearSelectProperties();s.forEach(function(p){c.oParentObject.addSelectPropertyOfFilterResolution(p);});},getSelectProperties:function(){var c=this;return c.oParentObject.getSelectPropertiesOfFilterResolution();},getValidationState:function(){var c=this;return c.viewValidator.getValidationState();}});});};if(!jQuery.sap.isDeclared('sap.apf.modeler.ui.controller.facetFilterVHR.controller')){jQuery.sap.declare('sap.apf.modeler.ui.controller.facetFilterVHR.controller');sap.ui.define("sap/apf/modeler/ui/controller/facetFilterVHR.controller",["sap/apf/modeler/ui/controller/requestOptions"],function(B){"use strict";return B.extend("sap.apf.modeler.ui.controller.facetFilterVHR",{setDisplayText:function(){var c=this;var t=c.getView().getViewData().oTextReader;c.byId("idSourceLabel").setText(t("vhSource"));c.byId("idEntityLabel").setText(t("vhEntity"));c.byId("idSelectPropertiesLabel").setText(t("vhSelectProperties"));},clearVHRFields:function(e){var c=this;c.clearSource();c.addOrRemoveMandatoryFieldsAndRequiredFlag(false,e);c.setDetailData();},onAfterRendering:function(){var c=this;c.addOrRemoveMandatoryFieldsAndRequiredFlag(true);},fireRelevantEvents:function(){var c=this;if(c.oParentObject.getUseSameRequestForValueHelpAndFilterResolution()){c.getView().fireEvent("useSameAsVHREvent");}},addOrRemoveMandatoryFieldsAndRequiredFlag:function(r,e){var c=this;if(r===false&&e===undefined){return;}c.byId("idSourceLabel").setRequired(r);c.byId("idEntityLabel").setRequired(r);c.byId("idSelectPropertiesLabel").setRequired(r);if(r){c.viewValidator.addFields(["idSource","idEntity","idSelectProperties"]);}else{c.viewValidator.removeFields(["idSource","idEntity","idSelectProperties"]);}},getSource:function(){var c=this;return c.oParentObject.getServiceOfValueHelp();},getAllEntities:function(s){var c=this;return c.oConfigurationEditor.getAllEntitySetsOfService(s);},getEntity:function(){var c=this;return c.oParentObject.getEntitySetOfValueHelp();},getAllEntitySetProperties:function(s,e){var c=this;return c.oConfigurationEditor.getAllPropertiesOfEntitySet(s,e);},clearSource:function(){var c=this;c.oParentObject.setServiceOfValueHelp(undefined);c.clearEntity();},clearEntity:function(){var c=this;c.oParentObject.setEntitySetOfValueHelp(undefined);c.clearSelectProperties();},clearSelectProperties:function(){var c=this;var o=c.oParentObject.getSelectPropertiesOfValueHelp();o.forEach(function(p){c.oParentObject.removeSelectPropertyOfValueHelp(p);});},updateSource:function(s){var c=this;c.oParentObject.setServiceOfValueHelp(s);},updateEntity:function(e){var c=this;c.oParentObject.setEntitySetOfValueHelp(e);},updateSelectProperties:function(s){var c=this;c.clearSelectProperties();s.forEach(function(p){c.oParentObject.addSelectPropertyOfValueHelp(p);});},getSelectProperties:function(){var c=this;return c.oParentObject.getSelectPropertiesOfValueHelp();},getValidationState:function(){var c=this;return c.viewValidator.getValidationState();}});});};if(!jQuery.sap.isDeclared('sap.apf.modeler.ui.controller.navTargetContextMapping.controller')){jQuery.sap.declare('sap.apf.modeler.ui.controller.navTargetContextMapping.controller');sap.ui.define("sap/apf/modeler/ui/controller/navTargetContextMapping.controller",["sap/apf/modeler/ui/controller/requestOptions"],function(B){"use strict";return B.extend("sap.apf.modeler.ui.controller.navTargetContextMapping",{setDisplayText:function(){var c=this;var t=c.getView().getViewData().oTextReader;c.byId("idSourceLabel").setText(t("source"));c.byId("idEntityLabel").setText(t("entity"));c.byId("idSelectPropertiesLabel").setText(t("mappedProperties"));},getSource:function(){var c=this;return c.oParentObject.getFilterMappingService();},getAllEntities:function(s){var c=this;return c.oConfigurationEditor.getAllEntitySetsOfService(s);},getEntity:function(){var c=this;return c.oParentObject.getFilterMappingEntitySet();},getAllEntitySetProperties:function(s,e){var c=this;return c.oConfigurationEditor.getAllPropertiesOfEntitySet(s,e);},clearSource:function(){var c=this;c.oParentObject.setFilterMappingService(undefined);c.clearEntity();},clearEntity:function(){var c=this;c.oParentObject.setFilterMappingEntitySet(undefined);c.clearSelectProperties();},clearSelectProperties:function(){var c=this;var o=c.oParentObject.getFilterMappingTargetProperties();o.forEach(function(p){c.oParentObject.removeFilterMappingTargetProperty(p);});},updateSource:function(s){var c=this;c.oParentObject.setFilterMappingService(s);},updateEntity:function(e){var c=this;c.oParentObject.setFilterMappingEntitySet(e);},updateSelectProperties:function(s){var c=this;c.clearSelectProperties();s.forEach(function(p){c.oParentObject.addFilterMappingTargetProperty(p);});},getSelectProperties:function(){var c=this;return c.oParentObject.getFilterMappingTargetProperties();},getValidationState:function(){var c=this;return c.viewValidator.getValidationState();}});});};if(!jQuery.sap.isDeclared('sap.apf.ui.instance')){jQuery.sap.declare("sap.apf.ui.instance");sap.apf.ui.Instance=function(i){'use strict';i.uiApi=this;var c=i.oCoreApi;var s=i.oStartFilterHandler;var a;var b;var m;var f;var d=c.getUriGenerator().getApfLocation();this.oEventCallbacks={};jQuery.sap.includeStyleSheet(d+"resources/css/apfUi.css","apfCss");jQuery.sap.includeStyleSheet(d+"resources/css/apfPrint.css","printCss");jQuery("#printCss").attr("media","print");this.getAnalysisPath=function(){if(b===undefined){b=sap.ui.view({viewName:"sap.apf.ui.reuse.view.analysisPath",type:sap.ui.core.mvc.ViewType.JS,viewData:i});}return b;};this.getNotificationBar=function(){if(m===undefined){m=sap.ui.view({viewName:"sap.apf.ui.reuse.view.messageHandler",type:sap.ui.core.mvc.ViewType.JS,viewData:i});}return m;};this.getStepContainer=function(){if(a===undefined){a=sap.ui.view({viewName:"sap.apf.ui.reuse.view.stepContainer",type:sap.ui.core.mvc.ViewType.JS,viewData:i});}return a;};this.selectionChanged=function(r){if(r){this.getAnalysisPath().getController().refresh(0);}else{var n=c.getSteps().indexOf(c.getActiveStep());this.getAnalysisPath().getController().refresh(n+1);}c.updatePath(this.getAnalysisPath().getController().callBackForUpdatePath.bind(this.getAnalysisPath().getController()));};var e;var g=new sap.m.App().addStyleClass("sapApf");var I=false;this.createApplicationLayout=function(){if(!I){g.addPage(this.getLayoutView());I=true;}return g;};this.getLayoutView=function(){if(e===undefined){e=sap.ui.view({viewName:"sap.apf.ui.reuse.view.layout",type:sap.ui.core.mvc.ViewType.XML,viewData:i});}return e;};this.addDetailFooterContent=function(C){this.getLayoutView().getController().addDetailFooterContentLeft(C);};this.addMasterFooterContentRight=function(C){this.getLayoutView().getController().addMasterFooterContentRight(C);};this.setEventCallback=function(E,C){this.oEventCallbacks[E]=C;};this.getEventCallback=function(E){return this.oEventCallbacks[E];};this.drawFacetFilter=function(C){if(C&&C.length){f=sap.ui.view({viewName:"sap.apf.ui.reuse.view.facetFilter",type:sap.ui.core.mvc.ViewType.JS,viewData:{oCoreApi:c,oUiApi:this,aConfiguredFilters:C,oStartFilterHandler:s}});var k=this.getLayoutView().byId("subHeader");k.addItem(f.byId("idAPFFacetFilter"));}};this.contextChanged=function(r){var C=this.getEventCallback(sap.apf.core.constants.eventTypes.contextChanged);if(typeof C==="function"){C();}};this.getFacetFilterForPrint=function(){if(f){return f.byId("idAPFFacetFilter");}};this.handleStartup=function(k){var t=this;var p=jQuery.Deferred();k.done(function(l){var n=s.getStartFilters();n.done(function(C){t.contextChanged();t.drawFacetFilter(C);if(l.navigationMode==="backward"){t.getAnalysisPath().getController().bIsBackNavigation=true;c.updatePath(t.getAnalysisPath().getController().callBackForUpdatePath.bind(t.getAnalysisPath().getController()));t.getAnalysisPath().getController().setPathTitle();}if(l.navigationMode==="forward"){if(c.getStartParameterFacade().getSteps()){var o=c.getStartParameterFacade().getSteps()[0].stepId;var r=c.getStartParameterFacade().getSteps()[0].representationId;var q=t.getAnalysisPath().getController().callBackForUpdatePathAndSetLastStepAsActive.bind(t.getAnalysisPath().getController());c.createFirstStep(o,r,q);}}p.resolve();});});return p.promise();};this.destroy=function(){f=undefined;this.getAnalysisPath().getToolbar().getController().oPrintHelper=undefined;this.getAnalysisPath().getCarousel().dndBox=undefined;h(this);};function h(k){var t=k.getAnalysisPath().getToolbar().getController();var l=k.getAnalysisPath().getCarousel().getStepGallery().getController();var n=k.getStepContainer().getController().getView().getStepToolbar().getController();j(t.saveDialog);j(t.newOpenDilog);j(t.newDialog);j(t.delConfirmDialog);j(t.confirmDialog);j(t.confrimLogoffDialog);j(t.errorMsgDialog);j(t.noPathAddedDialog);j(l.oHierchicalSelectDialog);j(n.selectionDisplayDialog);if(t.deleteAnalysisPath!==undefined){j(t.deleteAnalysisPath.getController().oDialog);}if(t.pathGallery!==undefined){j(t.pathGallery.getController().oDialog);}v(k);}function j(k){if(k!==undefined){if(k instanceof sap.m.ViewSettingsDialog){k.destroy();}else{if(k.isOpen()){k.close();}}}}function v(k){var l=false;var n=false;var o;if(k.getStepContainer().getController().oCoreApi.getActiveStep()!==undefined){l=true;}if(l){o=k.getStepContainer().getController().oCoreApi.getActiveStep().getSelectedRepresentation();if(o!==undefined){n=true;}}if(n){if(o.type!==sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION){if(o.toggleInstance!==undefined){j(o.toggleInstance.viewSettingsDialog);}}else{j(o.viewSettingsDialog);}}}};};if(!jQuery.sap.isDeclared('sap.apf.ui.reuse.controller.facetFilter.controller')){jQuery.sap.declare('sap.apf.ui.reuse.controller.facetFilter.controller');
/*!
* SAP APF Analysis Path Framework
* 
 * (c) Copyright 2012-2014 SAP SE. All rights reserved
*/
(function(){'use strict';var c={};var f={};var s;var F=new sap.apf.ui.utils.FacetFilterListConverter();function _(o,g){var h=o.getModel();var i=new sap.apf.ui.utils.FacetFilterValueFormatter();g.oFormatterArgs.aFilterValues=g.aFilterValues;var j=i.getFormattedFFData(g.oFormatterArgs);var m=F.getFFListDataFromFilterValues(j,g.oFormatterArgs.sSelectProperty);g.oFilterRestrictionPropagationPromiseForValues.done(function(n,N){_(o,{aFilterValues:n,oFilterRestrictionPropagationPromiseForValues:N,oFormatterArgs:g.oFormatterArgs});});h.setSizeLimit(m.length);h.setData(m);h.updateBindings();}function a(o){var C=this;C.getView().byId("idAPFFacetFilter").removeList(o);}function b(g,o){var i;g.forEach(function(h){h.selected=false;});o.forEach(function(h){for(i=0;i<g.length;i++){if(h===g[i].key){g[i].selected=true;break;}}});return g;}function d(o,g){var h=o.getId();var i=o.getModel();var j=i.getData();g.oFilterRestrictionPropagationPromiseForSelectedValues.done(function(n,N){o.removeSelectedKeys();d(o,{aSelectedFilterValues:n,oFilterRestrictionPropagationPromiseForSelectedValues:N});});c[h]=g.aSelectedFilterValues;j=b(j,g.aSelectedFilterValues);i.setData(j);i.updateBindings();o.getParent().rerender();}function e(C){var g=C.getView().byId("idAPFFacetFilter").getLists();g.forEach(function(o){(f[o.getId()].getFacetFilterListData().then(_.bind(null,o),a.bind(C,o))).then(function(){f[o.getId()].getSelectedFFValues().then(d.bind(null,o));});});}sap.ui.controller("sap.apf.ui.reuse.controller.facetFilter",{onInit:function(){var C=this,g;if(sap.ui.Device.system.desktop){C.getView().addStyleClass("sapUiSizeCompact");}s=false;var v=C.getView().getViewData();v.aConfiguredFilters.forEach(function(o,n){g=C.getView().byId("idAPFFacetFilter").getLists()[n].getId();f[g]=new sap.apf.ui.utils.FacetFilterListHandler(v.oCoreApi,v.oUiApi,o,F);});e(C);},onListClose:function(E){var C=this;var o=E.getSource();var S=[],g,h,i,j,k,l;g=o.getSelectedItems();S=g.map(function(I){return I.getKey();});h=o.getId();i=c[h];if(i!==undefined){j=JSON.stringify(S.sort());k=JSON.stringify(i.sort());l=(j===k);if(!l){c[h]=S;s=true;f[h].setSelectedFFValues(S);C.getView().getViewData().oUiApi.selectionChanged(true);}}},onResetPress:function(){var C=this;if(s){C.getView().getViewData().oStartFilterHandler.resetVisibleStartFilters();C.getView().getViewData().oUiApi.selectionChanged(true);s=false;}}});}());};if(!jQuery.sap.isDeclared('sap.apf.utils.externalContext')){
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2015 SAP AG. All rights reserved
 */
jQuery.sap.declare('sap.apf.utils.externalContext');sap.apf.utils.ExternalContext=function(a){'use strict';var d=jQuery.Deferred();var s=a.instance.startParameter.getEvaluationId();var x=a.instance.startParameter.getXappStateId();var m=a.instance.messageHandler;var r;var c;var b;var e=this;this.getCombinedContext=function(){if(x){sap.ushell.Container.getService("CrossApplicationNavigation").getAppState(a.instance.component,x).done(function(f){var g=f.getData();if(g&&g.sapApfCumulativeFilter){d.resolve(sap.apf.core.utils.Filter.transformUI5FilterToInternal(m,g.sapApfCumulativeFilter));}else if(g&&g.selectionVariant){d.resolve(e.convertSelectionVariantToFilter(g.selectionVariant));}else{d.resolve(new sap.apf.core.utils.Filter(m));}});}else if(s){c=a.functions.getConfigurationProperties();b=c&&c.smartBusiness&&c.smartBusiness.runtime;if(b&&b.service){r=b.service+"/EVALUATIONS('"+s+"')/FILTERS?$format=json";jQuery.ajax({url:r,success:function(f){var p;var m=a.instance.messageHandler;var o;var g=new sap.apf.core.utils.Filter(m);var h=[];var t={};f.d.results.forEach(i);for(p in t){if(t.hasOwnProperty(p)){o=new sap.apf.core.utils.Filter(m);t[p].forEach(j);h.push(o);}}h.forEach(k);d.resolve(g);function i(l){if(!t[l.NAME]){t[l.NAME]=[];}t[l.NAME].push(new sap.apf.core.utils.Filter(m,l.NAME,l.OPERATOR,l.VALUE_1,l.VALUE_2));}function j(l){o.addOr(l);}function k(l){g.addAnd(l);}},error:function(j,t,f){}});}else{d.resolve(new sap.apf.core.utils.Filter(m));}}else{d.resolve(new sap.apf.core.utils.Filter(m));}return d.promise();};this.convertParameterObject=function(p){if(!p.PropertyName||p.PropertyValue===undefined||p.PropertyValue===null){return null;}return new sap.apf.core.utils.FilterTerm(m,p.PropertyName,sap.apf.core.constants.FilterOperators.EQ,p.PropertyValue);};this.convertSelectOption=function(f){var e=this;var g=null;var i;if(!f.PropertyName||!f.Ranges||!(jQuery.isArray(f.Ranges))){return null;}g=new sap.apf.core.utils.Filter(m);for(i=0;i<f.Ranges.length;i++){var h=e.convertRange(f.Ranges[i],f.PropertyName);if(!h){return null;}g.addOr(h);}return g;};this.convertRange=function(f,p){if(f.Sign!='I'){return null;}if(f.Option==='BT'&&(f.High===undefined||f.High===null)){return null;}return new sap.apf.core.utils.FilterTerm(m,p,f.Option,f.Low,f.High);};this.convertSelectionVariantToFilter=function(f){var e=this;var g=new sap.apf.core.utils.Filter(m);var i;if(!f){return g;}if(f.Parameters&&!(jQuery.isArray(f.Parameters))){return g;}if(f.SelectOptions&&!(jQuery.isArray(f.SelectOptions))){return g;}if(f.Parameters){for(i=0;i<f.Parameters.length;i++){var h=e.convertParameterObject(f.Parameters[i]);if(!h){return new sap.apf.core.utils.Filter(m);}g.addAnd(h);}}if(f.SelectOptions){for(i=0;i<f.SelectOptions.length;i++){var j=e.convertSelectOption(f.SelectOptions[i]);if(!j){return new sap.apf.core.utils.Filter(m);}g.addAnd(j);}}return g;};};};if(!jQuery.sap.isDeclared('sap.apf.utils.filter')){
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
(function(){'use strict';jQuery.sap.declare('sap.apf.utils.filter');sap.apf.utils.Filter=function(m){var t;var a=this;var b=function(){t=new sap.apf.utils.FilterAnd(m,sap.apf.utils.Filter.topAndId);};this.getById=function(i){if(t){if(i===sap.apf.utils.Filter.topAndId){return t;}return t.getById(i);}return undefined;};this.type="filter";this.getExpressions=function(){if(t){return t.getExpressions();}return[];};this.getInternalFilter=function(){return t.getInternalFilter();};this.getTopAnd=function(){return t;};this.updateExpression=function(i,e){m.check(i===e.id,"sId differs from oExpression.id");var E=this.getById(i);E.update(e);};this.updateValue=function(i,v,h){m.check(i!==undefined,"Filter updateValue: parameter id required");m.check(v!==undefined,"Filter updateValue: parameter value is required");var e=this.getById(i);m.check(e!==undefined,"Filter updateValue: id for expression not valid");e.updateValue(v,h);};this.serialize=function(){function g(c,T){var s={id:T.getId(),type:T.type,expressions:[],terms:[]};c.forEach(function(d,i){if(d instanceof Array){if(T.type==="filterAnd"){s.terms.push(g(d,T.getAndTerms()[i]));}else if(T.type==="filterOr"){s.terms.push(g(d,T.getOrTerms()[i]));}}else{s.expressions.push(d);}});return s;}return g(this.getTopAnd().getExpression(),this.getTopAnd());};this.deserialize=function(s){t=undefined;b();function g(s,T){if(s.type==="filterAnd"&&s.id!==sap.apf.utils.Filter.topAndId){T=T.addAnd(s.id);}else if(s.type==="filterOr"&&s.id!==sap.apf.utils.Filter.topAndId){T=T.addOr(s.id);}s.expressions.forEach(function(e){T.addExpression(e);});s.terms.forEach(function(c){g(c,T);});}g(s,this.getTopAnd());return this;};this.addAnd=function(i){jQuery.sap.log.error("Method 'addAnd' is deprecated since 1.23.0","Will be discarded with 1.26.0.");};this.intersectWith=function(c){var i=0;var f=[];var F;var r=new sap.apf.utils.Filter(m);var R=a.serialize();s(R);switch(arguments.length){case 1:F=arguments[0];if(F instanceof Array){f=F;}else{f.push(F);}break;default:f=Array.prototype.slice.call(arguments,0);}f.forEach(function(o){m.check((o instanceof sap.apf.utils.Filter),"Parameter value is not of type sap.apf.utils.Filter");var I=o.serialize();s(I);Array.prototype.push.apply(R.expressions,I.expressions);Array.prototype.push.apply(R.terms,I.terms);});r.deserialize(R);return r;function s(S){if(S.id!==sap.apf.utils.Filter.topAndId){S.id='#'+i++ +'#';}S.terms.forEach(s);}};b();return this;};sap.apf.utils.Filter.createFilterFromSapUi5FilterJSON=function(m,s){var r=new sap.apf.utils.Filter(m);function a(f,l,b){var c;l++;if(b.filters){if(b.and){if(l!==1){c=f.addAnd();}else{c=f;}}else{c=f.addOr();}b.filters.forEach(function(e){a(c,l,e);});}else if(b.operator){f.addExpression({name:b.path,operator:b.operator,value:b.value1,high:b.value2});}}a(r.getTopAnd(),0,s);return r;};sap.apf.utils.Filter.getOperators=function(){return sap.apf.core.constants.FilterOperators;};sap.apf.utils.Filter.prototype.getOperators=sap.apf.utils.Filter.getOperators;sap.apf.utils.Filter.topAndId='filterTopAnd';sap.apf.utils.FilterAnd=function(m,I){var a=I;var A=[];var t=this;this.type="filterAnd";this.getById=function(I){if(I===a){return this;}var T;var i;for(i=0;i<A.length;i++){T=A[i].getById(I);if(T!==undefined){return T;}}return undefined;};this.getExpressions=function(){var e=[];var T;var i;for(i=0;i<A.length;i++){T=A[i].getExpression();if(T instanceof Array&&T.length===0){continue;}if(T instanceof Array){e.push(T);}else{e.push([T]);}}return e;};this.getExpression=function(){var e=[];var T;var i;for(i=0;i<A.length;i++){T=A[i].getExpression();if(T instanceof Array&&T.length===0){continue;}e.push(T);}return e;};this.getCompoundExpressions=function(){jQuery.sap.log.error("Method 'getExpressions' is deprecated since 1.23.0","Will be discarded with 1.26.0.");};this.getId=function(){return I;};this.getInternalFilter=function(){var f=new sap.apf.core.utils.Filter(m);var l=A.length;var i;for(i=0;i<l;i++){f.addAnd(A[i].getInternalFilter());}return f;};this.addAndTerm=function(T){jQuery.sap.log.error("Method 'addAndTerm' is deprecated since 1.23.0","Will be discarded with 1.26.0.");};this.getAndTerms=function(){return A;};this.addOr=function(I){m.check((I===undefined||this.getById(I)===undefined),"Filter includes duplicated identifiers (IDs)");var o=new sap.apf.utils.FilterOr(m,I,t);A.push(o);return o;};this.addExpression=function(e){if(e.operator.length==2){e.operator=e.operator.toUpperCase();}m.check((e.id===undefined||this.getById(e.id)===undefined),"Filter includes duplicated identifiers (IDs)");m.check((e.operator!==undefined),"sap.apf.utils.Filter oExpression.operator undefined");m.check((jQuery.inArray(e.operator,sap.apf.core.constants.aSelectOpt)>-1),"sap.apf.core.utils.Filter oExpression.operator "+e.operator+" not supported");A.push(new sap.apf.utils.FilterExpression(m,e));return this;};};sap.apf.utils.FilterOr=function(m,I,a){var b=I;var o=[];var A=a;this.type="filterOr";this.getById=function(I){if(I===b){return this;}var t;for(var i=0;i<o.length;i++){t=o[i].getById(I);if(t!==undefined){return t;}}return undefined;};this.getExpression=function(){var e=[];var t;for(var i=0;i<o.length;i++){t=o[i].getExpression();if(t instanceof Array&&t.length===0){continue;}e.push(t);}return e;};this.getId=function(){return I;};this.getInternalFilter=function(){var f=new sap.apf.core.utils.Filter(m);for(var i=0;i<o.length;i++){f.addOr(o[i].getInternalFilter());}return f;};this.getAndObject=function(){return A;};this.addOrTerm=function(t){jQuery.sap.log.error("Method 'addOr' is deprecated since 1.23.0","Will be discarded with 1.26.0.");};this.getOrTerms=function(){return o;};this.addExpression=function(e){if(e.operator.length==2){e.operator=e.operator.toUpperCase();}m.check((e.id===undefined||this.getAndObject().getById(e.id)===undefined),"Filter includes duplicated identifiers (IDs)");m.check((e.operator!==undefined),"sap.apf.utils.Filter oExpression.operator undefined");m.check((jQuery.inArray(e.operator,sap.apf.core.constants.aSelectOpt)>-1),"sap.apf.core.utils.Filter oExpression.operator "+e.operator+" not supported");o.push(new sap.apf.utils.FilterExpression(m,e));return this;};this.addAnd=function(I){m.check((I===undefined||this.getById(I)===undefined),"Filter includes duplicated identifiers (IDs)");var c=new sap.apf.utils.FilterAnd(m,I);o.push(c);return c;};};sap.apf.utils.FilterExpression=function(m,e){c(e.high,e.operator);var i=e.id;var n=e.name;var o=e.operator;var v=e.value;var h=e.high;this.getById=function(a){if(i===a){return this;}return undefined;};this.getExpression=function(){if(!o||o!==sap.apf.core.constants.FilterOperators.BT){return{name:n,operator:o,value:v};}return{name:n,operator:o,value:v,high:h};};this.getInternalFilter=function(){return new sap.apf.core.utils.Filter(m,n,o,v,h);};this.update=function(e){c(e.high,e.operator);n=e.name;o=e.operator;v=e.value;h=e.high;};this.updateValue=function(a,b){v=a;if(b!==undefined){h=b;}c(h,o);};function c(a,b){if(!b){return;}if(b===sap.apf.core.constants.FilterOperators.BT&&(a===null||a===undefined)){m.check(false,"sap.apf.utils.FilterExpression: High value needed for 'between' selection");}else if(b!==sap.apf.core.constants.FilterOperators.BT&&(a!==null&&a!==undefined)){m.check(false,"sap.apf.utils.FilterExpression: High value only needed for 'between' selection");}}};}());};if(!jQuery.sap.isDeclared('sap.apf.utils.navigationHandler')){(function(){'use strict';jQuery.sap.declare("sap.apf.utils.navigationHandler");jQuery.sap.require('sap.ui.core.routing.HashChanger');sap.apf.utils.NavigationHandler=function(I){var c;var e;var m=I.instances.messageHandler;var n=this;this.getNavigationTargets=function(){var d;var f=sap.ushell&&sap.ushell.Container&&sap.ushell.Container.getService("CrossApplicationNavigation");var s=[];if(e){d=jQuery.Deferred();d.resolve(b(e));return d.promise();}if(!c){a();}c.forEach(function(j){if(jQuery.inArray(j.semanticObject,s)===-1){s.push(j.semanticObject);}});e=jQuery.extend(true,[],c);e.forEach(function(j){j.text="";});d=jQuery.Deferred();i(0).done(function(){d.resolve(b(e));}).fail(function(){d.resolve(b(e));});return d.promise();function h(j,k,t){e.forEach(function(l){if(j===l.semanticObject&&k===l.action){l.text=t;}});}function i(j){var d=jQuery.Deferred();var k=[];if(j===s.length){d=jQuery.Deferred();e.forEach(function(o){if(o.text!==""){k.push(o);}});e=k;d.resolve(e);return d.promise();}var l=s[j];f.getSemanticObjectLinks(l,undefined,false,I.instances.component,undefined).done(function(o){o.forEach(function(p){var q=p.intent.split("-");var r=q[1].split("?");r=r[0].split("~");h(l,r[0],p.text);});i(j+1).done(function(){d.resolve(e);});}).fail(function(){return i(j+1);});return d.promise();}};this.navigateToApp=function(d){if(!c){a();}var N=g(d);if(!N){return;}var h=sap.ui.core.routing.HashChanger&&sap.ui.core.routing.HashChanger.getInstance();I.functions.getCumulativeFilterUpToActiveStep().done(function(C){var f;if(I.functions.isFilterReductionActive&&I.functions.isFilterReductionActive()){f=new sap.apf.core.utils.FilterReduction();C=f.filterReduction(m,C);}if(!N.filterMapping||!N.filterMapping.requestForMappedFilter){i(null,null);}else{var M=I.functions.createRequest(N.filterMapping.requestForMappedFilter);sap.apf.utils.executeFilterMapping(C,M,N.filterMapping.target,i,m);}function i(F,o){var j;if(o){return;}if(F){C=C.addAnd(F);}var k=sap.ushell&&sap.ushell.Container&&sap.ushell.Container.getService("CrossApplicationNavigation");if(k){var s={sapApfState:I.functions.serializePath()};I.instances.startFilterHandler.serialize().done(function(l){n.generateSelectionVariant(C).done(function(p){s.sapApfState.filterIdHandler=I.functions.serializeFilterIds();s.sapApfState.startFilterHandler=l;s.sapApfCumulativeFilter=C.mapToSapUI5FilterExpression();s.sapApfState.dirtyState=I.functions.isDirty();s.sapApfState.pathName=I.functions.getPathName();s.selectionVariant=p;j=k.createEmptyAppState(I.instances.component);j.setData(s);j.save();if(h){h.replaceHash("sap-iapp-state="+j.getKey());}k.toExternal({target:{semanticObject:N.semanticObject,action:N.action},appStateKey:j.getKey()});});});}}});};this.checkMode=function(){var d=jQuery.Deferred();var h=sap.ui.core.routing.HashChanger&&sap.ui.core.routing.HashChanger.getInstance&&sap.ui.core.routing.HashChanger.getInstance();var i=/(?:sap-iapp-state=)([^&=]+)/;var f,j,k,l;if(h){k=i.exec(h.getHash());if(k){f=k[1];}}j=I.functions.getXappStateId();if(f){sap.ushell.Container.getService("CrossApplicationNavigation").getAppState(I.instances.component,f).done(function(o){l=o.getData();if(l.sapApfState){I.functions.deserializeFilterIds(l.sapApfState.filterIdHandler);I.functions.deserializePath(l.sapApfState);I.functions.setDirtyState(l.sapApfState.dirtyState);I.functions.setPathName(l.sapApfState.pathName);I.instances.startFilterHandler.getStartFilters().done(function(){I.instances.startFilterHandler.deserialize(l.sapApfState.startFilterHandler);d.resolve({navigationMode:"backward"});});}});}else if(j){sap.ushell.Container.getService("CrossApplicationNavigation").getAppState(I.instances.component,j).done(function(o){l=o.getData();if(l&&l.sapApfCumulativeFilter){d.resolve({navigationMode:"forward",sapApfCumulativeFilter:l.sapApfCumulativeFilter});}else{d.resolve({navigationMode:"forward"});}});}else{d.resolve({navigationMode:"forward"});}if(h){h.replaceHash("");}return d.promise();};this.generateSelectionVariant=function(f){var d=jQuery.Deferred();if(I.functions.isFilterReductionActive&&I.functions.isFilterReductionActive()){var s=f.mapToSelectOptions(I.functions.getAllParameterEntitySetKeyProperties);s.done(function(h){h.SelectionVariantID=jQuery.sap.uid();d.resolve(h);});}else{var h={};h={SelectionVariantID:jQuery.sap.uid(),Text:'selectionVariant is only available if filterReduction in APF is active'};d.resolve(h);}return d.promise();};function a(){c=I.functions.getNavigationTargets();}function g(d){for(var i=0,l=c.length;i<l;i++){if(c[i].id===d){return c[i];}}}function b(t){var d=jQuery.extend(true,[],t);var r={global:[],stepSpecific:[]};d.forEach(function(f){if(f.isStepSpecific&&i(f.id)){delete f.isStepSpecific;r.stepSpecific.push(f);}else if(!f.isStepSpecific){delete f.isStepSpecific;r.global.push(f);}});return r;function i(f){var h=false;var j;var k=I.functions.getActiveStep();if(k&&k.getAssignedNavigationTargets){j=k.getAssignedNavigationTargets();if(j&&jQuery.isArray(j)){j.forEach(function(l){if(f===l.id){h=true;}});}}return h;}}};}());};if(!jQuery.sap.isDeclared('sap.apf.utils.startFilterHandler')){jQuery.sap.declare('sap.apf.utils.startFilterHandler');sap.apf.utils.StartFilterHandler=function(a){'use strict';var s=[{isLevel:true}];var S=(a&&a.constructor&&a.constructor.StartFilter)||sap.apf.utils.StartFilter;var r={};var b={};var c={};var d={};var m=a.instance.messageHandler;var e=jQuery.Deferred();var f=jQuery.Deferred();var g=false;var p=jQuery.Deferred();this.getStartFilters=function(){h().done(function(){e.resolve(n());});return e.promise();};this.setRestrictionByProperty=function(i){var w=i.getInternalFilter();var x=w.getProperties()[0];r[x]=i;h().done(function(){var y=true;o().forEach(function(z){if(z.getPropertyName()===x){if(w.isDisjunctionOverEqualities()){z.setSelectedValues(k(w));}else{z.setContext(w);}y=false;}});if(y){s.unshift(new S(a,{multiSelection:true,property:x,invisible:true,notConfigured:true},w));}if(p.state()==='resolved'){p=jQuery.Deferred();}if(a.functions.getFacetFilterConfigurations().length===0){p.resolve(u(q()));}b[x]=i;delete r[x];if(!c[x]){c[x]=i.serialize();}v();});};this.getRestrictionByProperty=function(i){if(b[i]){return b[i];}else if(r[i]){return r[i];}return new sap.apf.utils.Filter(m);};this.getCumulativeFilter=function(){var i=jQuery.Deferred();var w=new sap.apf.core.utils.Filter(m);var x;h().done(function(){x=o().length;if(x===0){i.resolve(new sap.apf.core.utils.Filter(m));}p.done(function(y,z,A){var B;B=new sap.apf.core.utils.Filter(m);if(y&&y.type==='internalFilter'){B=y;}if(jQuery.isArray(y)){y.forEach(function(C){B.addOr(new sap.apf.core.utils.Filter(m,A,'eq',C));});}if(z){w.addAnd(z).addAnd(B);}else{w=B;}i.resolve(w);});});return i.promise();};this.serialize=function(){var i=jQuery.Deferred();var w;var x;var y={};y.startFilters=[];y.restrictionsSetByApplication={};for(x in b){y.restrictionsSetByApplication[x]=b[x].serialize();}w=o().length;if(o().length>0){o().forEach(function(z){z.serialize().done(function(A){y.startFilters.push(A);w--;if(w===0){i.resolve(y);}});});}else{i.resolve(y);}return i.promise();};this.deserialize=function(w){var s=o();var x;var y;b={};w.startFilters.forEach(function(z){for(var i=0,A=s.length;i<A;i++){if(z.propertyName===s[i].getPropertyName()){s[i].deserialize(z);}}});for(x in w.restrictionsSetByApplication){y=new sap.apf.utils.Filter(m);y.deserialize(w.restrictionsSetByApplication[x]);b[x]=y;}v();};this.resetAll=function(){var i;o().forEach(function(w){w.reset();});b={};for(i in c){b[i]=new sap.apf.utils.Filter(m).deserialize(c[i]);}v();};this.resetVisibleStartFilters=function(){n().forEach(function(y){y.reset();});var w=0;var x=s.length;for(var i=0;i<x;i++){if(s[i].isLevel){w=i+1;break;}}if(s[w]){s[w].setRestriction(d[s[w].getPropertyName()]);}};function h(){if(!g){g=true;a.functions.getCombinedContext().done(function(w){var x=a.functions.getFacetFilterConfigurations();var y=w.getProperties();var z=y.length;var A=null;x.forEach(function(B){for(var i=0;i<z;i++){if(B.property===y[i]){A=y[i];break;}}if(A){s.push(new S(a,B,l(w,A)));y.splice(y.indexOf(A),1);A=null;}else{s.push(new S(a,B));}});y.forEach(function(i){s.unshift(new S(a,{property:i,invisible:true,multiSelection:true},l(w,i)));});t().done(function(){j();f.resolve();});});}return f;}function j(){var s=o();s.forEach(function(w){w.getSelectedValues().done(x);function x(y,z){var A;var B=new sap.apf.core.utils.Filter(m);var C;z.done(x);for(var i=0;i<s.length;i++){if(s[i]===w){A=i;break;}}if(A===s.length-1){if(p.state()==='resolved'){p=jQuery.Deferred();}p.resolve(y,d[w.getPropertyName()],w.getPropertyName());return;}else if(p.state()==='resolved'){p=jQuery.Deferred();}if(y&&y.type==='internalFilter'){B=y;}else if(jQuery.isArray(y)){y.forEach(function(D){B.addOr(w.getPropertyName(),'eq',D);});}if(d[w.getPropertyName()]){if(d[w.getPropertyName()].isOr()){C=new sap.apf.core.utils.Filter(m);C.addAnd(d[w.getPropertyName()]).addAnd(B);}else{C=d[w.getPropertyName()].copy().addAnd(B);}}else{C=B;}d[s[A+1].getPropertyName()]=C;s[A+1].setRestriction(C);}});}function k(i){var w=[];i.getFilterTerms().forEach(function(x){w.push(x.getValue());});return w;}function l(w,x){var y=[];var z=w.getFilterTermsForProperty(x);var A=w.reduceToProperty(x);if(A.toUrlParam().indexOf('%20and%20')>-1){return A;}for(var i=0,B=z.length;i<B;i++){if(z[i].getOp()!=='EQ'){return A;}y.push(z[i].getValue());}return y;}function n(){var i=[];o().forEach(function(w){if(w.isVisible()){i.push(w);}});return i;}function o(){var i=[];s.forEach(function(w){if(!w.isLevel){i.push(w);}});return i;}function q(){var w=[];for(var i=0,x=s.length;i<x;i++){if(!s[i].isLevel){w.push(s[i]);}else{break;}}return w;}function t(){var w=jQuery.Deferred();x(u(q()));return w;function x(y){var i;var z=s.length;var A=y;var B=0;for(i=0;i<z;i++){if(s[i].isLevel){B=i+1;break;}}if(s[B]){s[B].setRestriction(A);d[s[B].getPropertyName()]=A.copy();C(B);}else{w.resolve();}function C(D){if(s[D+1]){s[D].getSelectedValues().done(function(E){var F=new sap.apf.core.utils.Filter(m);if(E&&E.type==='internalFilter'){F.addOr(E);}else if(jQuery.isArray(E)){E.forEach(function(G){F.addOr(s[D].getPropertyName(),'eq',G);});}if(!F.isEmpty()){A.addAnd(F);}s[D+1].setRestriction(A);d[s[D+1].getPropertyName()]=A.copy();C(D+1);});}else{w.resolve();}}}}function u(i){var w=new sap.apf.core.utils.Filter(m);i.forEach(function(x){var y=new sap.apf.core.utils.Filter(m);x.getSelectedValues().done(function(z){if(z.type==='internalFilter'){y.addOr(z);}else{z.forEach(function(A){y.addOr(x.getPropertyName(),'eq',A);});}});w.addAnd(y);});return w;}function v(){var w=0;var x=s.length;for(var i=0;i<x;i++){if(s[i].isLevel){w=i+1;break;}}if(s[w]){var y=u(q());d[s[w].getPropertyName()]=y;s[w].setRestriction(y);}}};};if(!jQuery.sap.isDeclared('sap.apf.core.binding')){jQuery.sap.declare("sap.apf.core.binding");(function(){'use strict';sap.apf.core.Binding=function(I,b,f,r){var t=this;this.type="binding";var n=0;var R=[];var a=[];var c=[];var C;var s;this.oTitle=b.oTitle;this.oLongTitle=b.oLongTitle;var d=b.requiredFilters;this.destroy=function(){R.forEach(function(o){if(o&&o.destroy){o.destroy();}});R=[];a=[];c=[];C=undefined;s=undefined;};this.getFilter=function(){var S=this.getSelectedRepresentation();var m=sap.apf.core.constants.filterMethodTypes;var i=[];if(S.getFilterMethodType()===m.filter){var F=S.getFilter().getInternalFilter();if(s){return s.getInternalFilter().overwriteWith(F);}return F;}if(S.getSelectionAsArray){i=S.getSelectionAsArray();}else{return new sap.apf.core.utils.Filter(I.messageHandler);}if(i===undefined){return sap.apf.core.utils.Filter.createEmptyFilter(I.messageHandler,d);}if(i.length===c.length||i.length===0){return new sap.apf.core.utils.Filter(I.messageHandler);}return sap.apf.core.utils.Filter.createFromArray(I.messageHandler,d,c,i);};this.getRequestOptions=function(){if(jQuery.isFunction(this.getSelectedRepresentation().getRequestOptions)){return this.getSelectedRepresentation().getRequestOptions();}return{};};function e(o){return o.getFilterMethodType()===sap.apf.core.constants.filterMethodTypes.startFilter;}this.setFilter=function(F){var o=this.getSelectedRepresentation();s=F;if(e(o)){o.setFilter(s);}};this.setData=function(D){I.messageHandler.check(D!==undefined,"aDataResponse is undefined (binding function setData)");c=D.data;C=D.metadata;this.getSelectedRepresentation().setData(D.data,D.metadata);};this.getRepresentationInfo=function(){var k=jQuery.extend(true,[],a);for(var i=0;i<k.length;i++){delete k[i].id;delete k[i].type;delete k[i].constructor;}return k;};this.getSelectedRepresentationInfo=function(){I.messageHandler.check(n>=0&&n<a.length,"index in array boundaries");var o=jQuery.extend(true,{},a[n]);delete o.id;delete o.type;delete o.constructor;return o;};this.getSelectedRepresentation=function(){I.messageHandler.check(n>=0&&n<R.length,"selectedRepresentation in array boundaries");return R[n];};this.setSelectedRepresentation=function(r){I.messageHandler.check(typeof r==="string","setSelectedRepresentation() - sRepresentationId missing");var t=this;var o=this.getSelectedRepresentation();var S=k(r,b.representations);var N=l(S);n=S.index;if(c!==undefined&&C!==undefined){N.setData(c,C);}if(N.adoptSelection){N.adoptSelection(o);}function k(r,m){for(var i=0;i<m.length;i++){if(r===m[i].id){return{config:m[i],constructor:f.getConfigurationById(m[i].representationTypeId).constructor,index:i};}}I.messageHandler.check(false,"Representation config not found");}function l(i){var m;if(R[i.index]===undefined){if(i.config.parameter&&i.config.parameter.alternateRepresentationTypeId){i.config.parameter.alternateRepresentationType=f.getConfigurationById(i.config.parameter.alternateRepresentationTypeId);}i.config.parameter.requiredFilters=b.requiredFilters;m=t.convertSortToOrderBy(i.config.parameter);R[i.index]=I.coreApi.createRepresentation(i.constructor,m);return R[i.index];}return R[i.index];}};this.serialize=function(){return{selectedRepresentation:t.getSelectedRepresentation().serialize(),selectedRepresentationId:t.getSelectedRepresentationInfo().representationId};};this.deserialize=function(S){t.setSelectedRepresentation(S.selectedRepresentationId);t.getSelectedRepresentation().deserialize(S.selectedRepresentation);return t;};this.convertSortToOrderBy=function(p){var i;if(p.sort&&!p.orderby){i=jQuery.extend(true,{},p);if(p.alternateRepresentationType){i.alternateRepresentationType=p.alternateRepresentationType;}i.orderby=[{property:p.sort.sortField,ascending:!p.sort.descending}];delete i.sort;return i;}i=p;return i;};R[0]=undefined;var g,h=false;for(g in b.representations){var j=b.representations[g].representationTypeId;a[g]=jQuery.extend(true,{},f.getConfigurationById(j));a[g].representationId=b.representations[g].id;if(r===a[g].representationId){h=true;}a[g].representationLabel=b.representations[g].label;a[g].thumbnail=b.representations[g].thumbnail;a[g].parameter=jQuery.extend(true,{},b.representations[g].parameter);}if(h){this.setSelectedRepresentation(r);}else if(a.length>0){this.setSelectedRepresentation(a[0].representationId);}if(!h&&r){I.messageHandler.putMessage(I.messageHandler.createMessageObject({code:'5037',aParameters:[r]}));}};}());};if(!jQuery.sap.isDeclared('sap.apf.core.request')){jQuery.sap.declare('sap.apf.core.request');jQuery.sap.require('sap.ui.thirdparty.datajs');(function(){'use strict';sap.apf.core.Request=function(I,c){var m=I.messageHandler;var C=I.coreApi;var s=c.service;var a=c.selectProperties;var u=C.getUriGenerator();var M;if(s===undefined){M=m.createMessageObject({code:'5015',aParameters:[c.id]});m.putMessage(M);}var o=C.getMetadata(s);var U=o.getUriComponents(c.entityType);var e,b;if(U){e=U.entitySet;b=U.navigationProperty;}m.check(e!==undefined,'Invalid request configuration: An entityset does not exist under the service '+c.entityType);m.check(b!==undefined,'Invalid request configuration: A usable navigation does not exist for the service '+c.entityType);this.type=c.type;this.sendGetInBatch=function(F,h,R){var p=r(F);var i;var j;g(F);if(F&&F.getProperties){i=F.reduceToProperty(o.getFilterableProperties(e));if(C.getStartParameterFacade().isFilterReductionActive()){j=new sap.apf.core.utils.FilterReduction();i=j.filterReduction(m,i);}}d(R);var P=R&&R.paging;var S=R&&R.orderby;var k=u.buildUri(m,e,a,i,p,S,P,undefined,f,b);var l={method:'POST',headers:{'x-csrf-token':C.getXsrfToken(s)},requestUri:u.getAbsolutePath(s)+'$batch',data:{__batchRequests:[{requestUri:k,method:'GET',headers:{'Accept-Language':sap.ui.getCore().getConfiguration().getLanguage(),'x-csrf-token':C.getXsrfToken(s)}}]}};var n=function(q,t){var v={};var w='';if(q&&q.__batchResponses&&q.__batchResponses[0].data){v.data=q.__batchResponses[0].data.results;v.metadata=C.getEntityTypeMetadata(c.service,c.entityType);if(q.__batchResponses[0].data.__count){v.count=parseInt(q.__batchResponses[0].data.__count,10);}}else if(q&&q.__batchResponses[0]&&q.__batchResponses[0].response&&q.__batchResponses[0].message){w=t.requestUri;var x=q.__batchResponses[0].message;var y=q.__batchResponses[0].response.body;var H=q.__batchResponses[0].response.statusCode;v=m.createMessageObject({code:'5001',aParameters:[H,x,y,w]});}else{w=t.requestUri||k;v=m.createMessageObject({code:'5001',aParameters:['unknown','unknown error','unknown error',w]});}h(v,false);};var E=function(q){var t='unknown error';var v='unknown error';var w=k;if(q.message!==undefined){t=q.message;}var H='unknown';if(q.response&&q.response.statusCode){H=q.response.statusCode;v=q.response.statusText||'';w=q.response.requestUri||k;}if(q.messageObject&&q.messageObject.type==='messageObject'){h(q.messageObject);}else{h(m.createMessageObject({code:'5001',aParameters:[H,t,v,w]}));}};C.odataRequest(l,n,E,OData.batchHandler);};function f(p,v){var h="'";var E=o.getPropertyMetadata(e,p);if(E&&E.dataType){return sap.apf.utils.formatValue(v,E.dataType.type);}if(typeof v==='number'){return v;}return h+sap.apf.utils.escapeOdata(v)+h;}function d(R){var p,i;if(!R){return;}p=Object.getOwnPropertyNames(R);for(i=0;i<p.length;i++){if(p[i]!=='orderby'&&p[i]!=='paging'){m.putMessage(m.createMessageObject({code:'5032',aParameters:[e,p[i]]}));}}}function g(F){var h=o.getFilterableProperties(e);var R='';var E=o.getEntityTypeAnnotations(e);var i;if(E.requiresFilter!==undefined&&E.requiresFilter==='true'){if(E.requiredProperties!==undefined){R=E.requiredProperties;}}if(R===''){return;}if(jQuery.inArray(R,h)===-1){i=m.createMessageObject({code:'5006',aParameters:[e,R]});m.putMessage(i);}var p=F.getProperties();if(jQuery.inArray(R,p)===-1){i=m.createMessageObject({code:'5005',aParameters:[e,R]});m.putMessage(i);}}function r(F){var p={};var P;var n;var t;var i;var h;P=o.getParameterEntitySetKeyProperties(e);if(P!==undefined){n=P.length;}else{n=0;}if(n>0){for(i=0;i<n;i++){if(F&&F instanceof sap.apf.core.utils.Filter){t=F.getFilterTermsForProperty(P[i].name);h=t[t.length-1];}if(h instanceof sap.apf.core.utils.FilterTerm){j(i,h.getValue());}else if(P[i].defaultValue){j(i,P[i].defaultValue);}else{m.putMessage(m.createMessageObject({code:'5016',aParameters:[P[i].name]}));}}}return p;function j(k,v){var l;if(P[k].dataType.type==='Edm.String'){p[P[k].name]=(jQuery.sap.encodeURL("'"+sap.apf.utils.escapeOdata(v)+"'"));}else if(P[k].dataType.type){l=sap.apf.utils.formatValue(v,P[k].dataType.type);if(typeof l==='string'){p[P[k].name]=jQuery.sap.encodeURL(l);}else{p[P[k].name]=l;}}else if(typeof v==='string'){p[P[k].name]=jQuery.sap.encodeURL(sap.apf.utils.escapeOdata(v));}else{p[P[k].name]=v;}}}};}());};if(!jQuery.sap.isDeclared('sap.apf.core.resourcePathHandler')){(function(){'use strict';jQuery.sap.declare("sap.apf.core.resourcePathHandler");sap.apf.core.ResourcePathHandler=function(i){var t=this;var c=i.coreApi;var m=i.messageHandler;var h=new sap.apf.utils.Hashtable(m);var C;var p;var s=null;var a="";var b=false;var I=false;var P=sap.apf.core.OdataProxy;o();this.getApplicationConfigurationURL=function(){return a;};this.loadConfigFromFilePath=function(F){if(b){return;}if(c.getStartParameterFacade().getAnalyticalConfigurationId()){I=true;}var U=F;a=F;jQuery.ajax({url:U,dataType:"json",success:r,error:function(J,S,E){var M=m.createMessageObject({code:sap.apf.core.constants.message.code.errorLoadingRessource,rawText:"Error "+E+" when loading the configuration of the resource location: "+U});m.putMessage(M);},async:false});f();if(I){l();}else{e();}b=true;function r(D,S,J){var M=sap.apf.core.utils.checkForTimeout(J);if(M){m.putMessage(m.createMessageObject({code:sap.apf.core.constants.message.code.errorStartUp,rawText:"Timeout when loading application configuration from "+F+"."}));}if(!D||!D.applicationConfiguration){m.putMessage(m.createMessageObject({code:sap.apf.core.constants.message.code.errorStartUp,rawText:"The application configuration from "+F+" has no valid format."}));return;}if(D.applicationConfiguration.textResourceLocations===undefined){m.putMessage(m.createMessageObject({code:sap.apf.core.constants.message.code.errorStartUp,rawText:"The textResourceLocations is missing in the application configuration from "+F+"."}));return;}q(D);}};function u(){return c.getStartParameterFacade().isLrepActive();}function l(){var r=c.getStartParameterFacade().getAnalyticalConfigurationId();var v=r.applicationId;var w=r.configurationId;if(u()&&!v){m.putMessage(m.createMessageObject({code:"5024"}));}var x=new P({serviceRoot:p.path.service,entityTypes:{configuration:sap.apf.core.constants.entitySets.configuration,texts:sap.apf.core.constants.entitySets.texts}},{instance:{coreApi:c,messageHandler:m}});x.readEntity("configuration",function(y,z,A){if(A){m.putMessage(m.createMessageObject({code:"5022",aParameters:[w]}));}else{var B=JSON.parse(y.SerializedAnalyticalConfiguration);c.loadAnalyticalConfiguration(JSON.parse(y.SerializedAnalyticalConfiguration));v=v||y.Application;d(v,x);if(B.applicationTitle){C.appName=B.applicationTitle.key;C.appTitle=B.applicationTitle.key;}}},[{name:"AnalyticalConfiguration",value:w}],undefined,false,v,{layer:'ALL'});}function d(r,v){var w=new sap.apf.core.utils.Filter(m,'Application','eq',r);var x=new sap.apf.core.utils.Filter(m,'Language','eq',sap.apf.core.constants.developmentLanguage);x.addAnd(w);var y=["TextElement","TextElementDescription"];v.readCollection('texts',function(z,A,B){if(B){m.putMessage(m.createMessageObject({code:"5023",aParameters:[sap.apf.utils.uriParameter.getConfigurationId()]}));}else{c.loadTextElements(z);}},undefined,y,x,false,{layer:'ALL'});}function e(){var U=t.getResourceLocation(sap.apf.core.constants.resourceLocation.analyticalConfigurationLocation);var M;if(U!==""){jQuery.ajax({url:U,dataType:"json",success:function(D,S,J){if(D){c.loadAnalyticalConfiguration(D);if(D.applicationTitle){C.appName=D.applicationTitle.key;C.appTitle=D.applicationTitle.key;}}else{M=m.createMessageObject({code:sap.apf.core.constants.message.code.errorLoadingAnalyticalConfig,rawText:"No data received when loading analytical configuration file"+U});m.putMessage(M);}},error:function(J,S,E){M=m.createMessageObject({code:sap.apf.core.constants.message.code.errorLoadingAnalyticalConfig,rawText:"Error "+E+" when loading analytical configuration file"+U});m.putMessage(M);},async:false});}else{M=m.createMessageObject({code:sap.apf.core.constants.message.code.missingAnalyticalConfig,rawText:"No analytical configuration defined in the application configuration"});m.putMessage(M);}}function f(){c.loadMessageConfiguration(sap.apf.core.messageDefinition,true);g(sap.apf.core.constants.resourceLocation.applicationMessageDefinitionLocation,false);}function g(r,R){var U=t.getResourceLocation(r);if(U!==""){jQuery.ajax({url:U,dataType:"json",success:v,error:function(J,S,E){var M=m.createMessageObject({code:sap.apf.core.constants.message.code.errorLoadingAnalyticalConfig,rawText:"Error "+E+" when loading message configuration file"+U});m.putMessage(M);},async:false});}function v(D,S,J){var M;var w=sap.apf.core.utils.checkForTimeout(J);if(!w){if(D.messageConfiguration){c.loadMessageConfiguration(D.messageConfiguration.definitions,R);}}else{M=m.createMessageObject({code:sap.apf.core.constants.message.code.errorLoadingAnalyticalConfig,rawText:"Timeout error when loading message configuration file"+U});m.putMessage(M);}}}function j(r){var M;if(!r||!r.path){M=m.createMessageObject({code:sap.apf.core.constants.message.code.errorInAnalyticalConfig,rawText:"persistence path configuration is missing in the application configuration"});m.putMessage(M);}if(!r.path.service){M=m.createMessageObject({code:sap.apf.core.constants.message.code.errorInAnalyticalConfig,rawText:"service in persistence path configuration is missing"});m.putMessage(M);}if(!r.logicalSystem){M=m.createMessageObject({code:sap.apf.core.constants.message.code.warningAnalyticalConfig,rawText:"logical system configuration is missing in the application configuration"});m.putMessage(M);}else if(!r.logicalSystem.service&&r.logicalSystem.service!==null){M=m.createMessageObject({code:sap.apf.core.constants.message.code.errorInAnalyticalConfig,rawText:"service is missing in logical system configuration  in the application configuration"});m.putMessage(M);}if(r.analyticalConfiguration){if(!r.analyticalConfiguration.service){M=m.createMessageObject({code:sap.apf.core.constants.message.code.errorInAnalyticalConfig,rawText:"service or entity set are missing in analytical configuration in the application configuration"});m.putMessage(M);}}}function k(r){var M;if(r.evaluations&&!r.evaluations.service){M=m.createMessageObject({code:sap.apf.core.constants.message.code.errorInAnalyticalConfig,rawText:"service in Smart Business service root configuration is missing"});m.putMessage(M);}if(r.evaluations&&(!r.evaluations.type||r.evaluations.type!=="smartBusinessRequest")){M=m.createMessageObject({code:sap.apf.core.constants.message.code.errorInAnalyticalConfig,rawText:"type in Smart Business configuration is not smartBusinessRequest"});m.putMessage(M);}if(r.evaluations&&!r.evaluations.entityType){M=m.createMessageObject({code:sap.apf.core.constants.message.code.errorInAnalyticalConfig,rawText:"entityType in Smart Business service root configuration is missing"});m.putMessage(M);}}this.getResourceLocation=function(r){return h.getItem(r);};this.getPersistenceConfiguration=function(){m.check(b,"RessourcePathHandler: configuration must be loaded before access to ressources");return p;};this.getConfigurationProperties=function(){m.check(b,"RessourcePathHandler: configuration must be loaded before access to ressources");return C;};function n(){var r=sap.apf.core.utils.uriGenerator;var v,w,x;var y=i.manifests.manifest;var z=i.manifests.baseManifest;if(b){return;}if(c.getStartParameterFacade().getAnalyticalConfigurationId()){I=true;}var A=r.getBaseURLOfComponent(i.manifests.baseManifest.name);var B=r.getBaseURLOfComponent(i.manifests.manifest.name);a=y["sap.app"].id;if(y["sap.app"].dataSources&&y["sap.app"].dataSources.PathPersistenceServiceRoot){x=y["sap.app"].dataSources.PathPersistenceServiceRoot.uri;}var D=z["sap.app"].i18n;D=r.addRelativeToAbsoluteURL(A,D);var E=y["sap.app"].i18n;E=r.addRelativeToAbsoluteURL(B,E);var F=y["sap.app"].title;F=F.replace(/[{}]/g,"");var G="";if(y["sap.app"].dataSources&&y["sap.app"].dataSources.AnalyticalConfigurationLocation){G=y["sap.app"].dataSources.AnalyticalConfigurationLocation.uri;G=r.addRelativeToAbsoluteURL(B,G);}var H={"appName":F,"appTitle":F,"analyticalConfigurationLocation":G,"textResourceLocations":{"apfUiTextBundle":D,"applicationUiTextBundle":E},"persistence":{"path":{"service":x}}};if(y["sap.apf"]&&y["sap.apf"].appSpecificParameters){for(v in y["sap.apf"].appSpecificParameters){H[v]=y["sap.apf"].appSpecificParameters[v];}}if(u()){P=sap.apf.core.LayeredRepositoryProxy;}if(y["sap.app"].dataSources&&y["sap.app"].dataSources.SmartBusiness){w=y["sap.app"].dataSources.SmartBusiness.uri;H.smartBusiness={runtime:{service:w}};}if(y["sap.app"].dataSources&&y["sap.app"].dataSources.LogicalSystem){H.persistence.logicalSystem={service:y["sap.app"].dataSources.LogicalSystem.uri};}q({applicationConfiguration:H});f();if(I){l();}else{e();}b=true;}function o(){var A=c.getUriGenerator().getApfLocation();h.setItem(sap.apf.core.constants.resourceLocation.apfUiTextBundle,A+"resources/i18n/apfUi.properties");h.setItem(sap.apf.core.constants.resourceLocation.applicationMessageDefinitionLocation,"");h.setItem(sap.apf.core.constants.resourceLocation.applicationMessageTextBundle,"");h.setItem(sap.apf.core.constants.resourceLocation.applicationUiTextBundle,"");h.setItem(sap.apf.core.constants.resourceLocation.analyticalConfigurationLocation,"");}function q(r){function v(A){C=jQuery.extend(true,{},A);delete C.type;delete C.analyticalConfigurationLocation;delete C.applicationMessageDefinitionLocation;delete C.textResourceLocations;delete C.persistence;}var A=r.applicationConfiguration;v(A);var T=r.applicationConfiguration.textResourceLocations;p=r.applicationConfiguration.persistence;j(p);if(!p.path.entitySet){p.path.entitySet=sap.apf.core.constants.entitySets.analysisPath;}if(r.applicationConfiguration.smartBusiness){s=r.applicationConfiguration.smartBusiness;k(s);}var M;var U;var w;for(w in sap.apf.core.constants.resourceLocation){if(!sap.apf.core.constants.resourceLocation.hasOwnProperty(w)){continue;}if(A[w]!==undefined){U=A[w];}else if(T[w]!==undefined){U=T[w];}else{continue;}if(i.fileExists.check(U)){h.setItem(w,U);}else if(!I){M=m.createMessageObject({code:sap.apf.core.constants.message.code.wrongRessourcePath,rawText:"The path "+U+" for resource location "+w+"is not valid."});m.putMessage(M);}}}if(i.manifests&&i.manifests.manifest){n();}};}());};if(!jQuery.sap.isDeclared('sap.apf.core.sessionHandler')){jQuery.sap.declare("sap.apf.core.sessionHandler");(function(){'use strict';sap.apf.core.SessionHandler=function(i){var t=this;var d=false;var p='';var x="";var s="";var h=new sap.apf.utils.Hashtable(i.messageHandler);var n=0;var c=i.coreApi;var m=i.messageHandler;var o=function(j,S,e){if((x.length===0||x==="unsafe")&&n<2){setTimeout(t.fetchXcsrfToken,500+Math.random()*1500);}else{m.check(false,"No XSRF Token available!",5101);}};var a=function(D,S,X){x=X.getResponseHeader("x-csrf-token");if(x===null){x="";}else if((x.length===0||x==="unsafe")&&n<2){setTimeout(t.fetchXcsrfToken,500+Math.random()*1500);}};this.type="sessionHandler";this.ajax=function(S){sap.apf.core.ajax(S);};this.getXsrfToken=function(b){s=b;if(h.hasItem(s)){return h.getItem(s);}t.fetchXcsrfToken();h.setItem(s,x);return x;};this.fetchXcsrfToken=function(){t.ajax({url:c.getUriGenerator().getAbsolutePath(s),type:"GET",beforeSend:function(b){b.setRequestHeader("x-csrf-token","Fetch");},success:a,error:o,async:false});n=n+1;};this.setDirtyState=function(b){d=b;};this.isDirty=function(){return d;};this.setPathName=function(b){if(typeof b!='string'){p='';return;}p=b;};this.getPathName=function(){return p;};};}());};if(!jQuery.sap.isDeclared('sap.apf.core.step')){jQuery.sap.declare("sap.apf.core.step");(function(){'use strict';sap.apf.core.Step=function(m,s,f,r){m.check(s!==undefined,"Step: step configuration is missing");m.check(s.binding!==undefined,"No binding assigned to step "+s.id+" in analytical configuration",sap.apf.core.constants.message.code.errorCheckConfiguration);var t=this;var b,R,c,C;var a=jQuery.extend(true,{},s);delete a.id;delete a.picture;delete a.hoverPicture;delete a.title;delete a.longTitle;delete a.type;delete a.thumbnail;delete a.categories;this.type=s.type;this.title=jQuery.extend(true,{},s.title);this.longTitle=undefined;if(s.longTitle){this.longTitle=jQuery.extend(true,{},s.longTitle);}this.thumbnail=jQuery.extend(true,{},s.thumbnail);this.categories=s.categories;this.destroy=function(){if(b){b.destroy();}R=undefined;c=undefined;C=undefined;b=undefined;t=undefined;};this.getAdditionalConfigurationProperties=function(){return a;};this.update=function(F,g){var o=b.getRequestOptions();var h=!F.isEqual(c);var j=!d(C,o);if(R&&(h||j)){R.sendGetInBatch(F,g,o);}else{g({},true);}};this.determineFilter=function(o,g){if(e()&&this.getFilter().toUrlParam()){var h=f.getConfigurationById(s.filterMapping.requestForMappedFilter);h.selectProperties=s.filterMapping.target;var M=f.createRequest(h);var j=o.addAnd(this.getFilter());sap.apf.utils.executeFilterMapping(j,M,s.filterMapping.target,l,m);}else{g(this.getFilter());}function l(k,n){if(!n){if(s.filterMapping.keepSource==='true'){k=t.getFilter().addAnd(k);}g(k);}}};this.setFilter=function(F){return b.setFilter(F);};this.getFilter=function(){return b.getFilter();};this.setData=function(D,F){c=F.copy();C=jQuery.extend({},b.getRequestOptions());b.setData(D);};this.getRepresentationInfo=function(){return b.getRepresentationInfo();};this.getSelectedRepresentationInfo=function(){return b.getSelectedRepresentationInfo();};this.getSelectedRepresentation=function(){return b.getSelectedRepresentation();};this.setSelectedRepresentation=function(r){b.setSelectedRepresentation(r);};this.serialize=function(){return{stepId:s.id,binding:b.serialize()};};this.deserialize=function(S){b.deserialize(S.binding);m.check(s.id,S.stepId,"sap.apf.core.step.deserialize inconsistent serialization data - id "+S.stepId);return this;};this.getAssignedNavigationTargets=function(){return s.navigationTargets;};i();function i(){b=f.createBinding(s.binding,undefined,undefined,r);delete a.binding;if(s.request!==undefined&&s.request!==""){R=f.createRequest(s.request);delete a.request;}}function d(o,O){var n=0;var g=0;var p;for(p in o){n++;}for(p in O){g++;}if(n!==g){return false;}for(p in o){if(!o.hasOwnProperty(p)){continue;}if(typeof o[p]==='object'){if(!d(o[p],O[p])){return false;}}else if(o[p]!==O[p]){return false;}}return true;}function e(){if(s.filterMapping){if(s.filterMapping.requestForMappedFilter&&s.filterMapping.target instanceof Array&&s.filterMapping.keepSource){return true;}m.putMessage(m.createMessageObject({code:"5104"}));}return false;}};}());};if(!jQuery.sap.isDeclared('sap.apf.core.configurationFactory')){(function(){'use strict';jQuery.sap.declare("sap.apf.core.configurationFactory");sap.apf.core.ConfigurationFactory=function(i){var t=this;var a=new sap.apf.utils.Hashtable(i.messageHandler);var s=function(I){i.messageHandler.check(I!==undefined&&I.hasOwnProperty("id")!==false,"oItem is undefined or property 'id' is missing",sap.apf.core.constants.message.code.errorCheckConfiguration);if(!a){a=new sap.apf.utils.Hashtable(i.messageHandler);}var v=a.setItem(I.id,I);i.messageHandler.check((v===undefined),"Configuration includes duplicated identifiers (IDs): "+I.id+"",sap.apf.core.constants.message.code.errorCheckConfigurationWarning);};var g=function(v){var R=[];if(a.getNumberOfItems()!==0){a.each(function(w,x){if(x.type===v){R.push(x);}});return R;}i.messageHandler.putMessage(i.messageHandler.createMessageObject({code:"5020"}));return R;};function l(v){if(v.type===undefined){v.type="step";}s(v);}function b(v){i.messageHandler.check(v!==undefined&&v instanceof Array!==false,"aSteps is missing or not an Array",sap.apf.core.constants.message.code.errorCheckConfiguration);v.forEach(function(w){l(w);});}function c(R){if(R.type===undefined){R.type="request";}if(R.entitySet){R.entityType=R.entitySet;delete R.entitySet;}s(R);}function d(v){if(v.type===undefined){v.type="navigationTarget";}s(v);}function e(R){i.messageHandler.check(R!==undefined&&R instanceof Array!==false,"aRequests is missing or not an Array",sap.apf.core.constants.message.code.errorCheckConfiguration);R.forEach(function(v){c(v);});}function f(B){function v(){var w=new sap.apf.utils.Hashtable(i.messageHandler);B.representations.forEach(function(x){if(!(x.id&&typeof x.id==="string")){i.messageHandler.putMessage(i.messageHandler.createMessageObject({code:"5028",aParameters:[B.id]}));}if(w.setItem(x.id,x.id)){i.messageHandler.putMessage(i.messageHandler.createMessageObject({code:"5029",aParameters:[B.id]}));}});}if(B.type===undefined){B.type="binding";}i.messageHandler.check(B.id!==undefined,"binding has no id");i.messageHandler.check(B.representations!==undefined&&B.representations instanceof Array!==false,"representations for binding "+B.id+" not defined",sap.apf.core.constants.message.code.errorCheckConfiguration);v();s(B);}function h(B){i.messageHandler.check(B!==undefined&&B instanceof Array!==false,"aBindings is missing or not an Array",sap.apf.core.constants.message.code.errorCheckConfiguration);B.forEach(function(v){f(v);});}function j(v){i.messageHandler.check(v!==undefined&&v instanceof Array!==false,"navigationTarget is missing or not an Array",sap.apf.core.constants.message.code.errorCheckConfiguration);v.forEach(function(w){d(w);});}function k(v){if(v.type===undefined){v.type="category";}s(v);}function m(v){i.messageHandler.check(v!==undefined&&v instanceof Array!==false,"aCategories is missing or not an Array",sap.apf.core.constants.message.code.errorCheckConfiguration);v.forEach(function(w){var x=w.steps;i.messageHandler.check(x!==undefined&&x instanceof Array!==false,"steps for category "+w.id+" are missing or not an Array",sap.apf.core.constants.message.code.errorCheckConfiguration);x.forEach(function(y){i.messageHandler.check(y.type&&y.type==="step"&&y.id,"step with wrong format assigned to category '"+w.id+"'");i.messageHandler.check(t.existsConfiguration(y.id),"step with id '"+y.id+"' which is assigned to category '"+w.id+"' does not exist");});k(w);});}function n(v){var w=false;var R=sap.apf.core.representationTypes();R.forEach(function(x){if(v===x.id){w=true;}});return w;}function o(R){var v;if(R.type===undefined){R.type="representationType";}if(!n(R.id)){v=sap.apf.utils.extractFunctionFromModulePathString(R.constructor);if(!jQuery.isFunction(v)){i.messageHandler.putMessage(i.messageHandler.createMessageObject({code:'5030',parameters:[R.id]}));}}s(R);}function p(R){i.messageHandler.check(R!==undefined&&R instanceof Array!==false,"aRepresentationInfo is missing or not an Array",sap.apf.core.constants.message.code.errorCheckConfiguration);R.forEach(function(v){o(v);});}function q(F){if(F.type===undefined){F.type="facetFilter";}t.addObject(F);}function r(F){i.messageHandler.check(F!==undefined&&F instanceof Array!==false,"Facet filter configuration is missing or not an Array",sap.apf.core.constants.message.code.errorCheckConfiguration);F.forEach(function(v){q.call(t,v);});}var u=function(R){p(R);};function S(v,F){function w(v,z){var A=z.getConfigurationById(v.binding).representations;if(A){return A;}i.messageHandler.check(false,'Binding of step with ID "'+v.id+'" does not contain any representations.',sap.apf.core.constants.message.code.errorCheckConfigurationWarning);}function x(v,z){var A;var B=[];if(v.binding){A=w(v,z);A.forEach(function(D){var E=jQuery.extend(true,{},z.getConfigurationById(D.representationTypeId));E.representationId=D.id;E.representationLabel=D.label;E.parameter=jQuery.extend(true,{},D.parameter);B.push(E);});return B;}i.messageHandler.check(false,'Step with ID "'+v.id+'" does not contain any binding references.',sap.apf.core.constants.message.code.errorCheckConfigurationWarning);}var y=jQuery.extend(true,{},v);var R=x(v,F);delete y.request;delete y.binding;delete y.thumbnail;delete y.longTitle;y.type="stepTemplate";y.getRepresentationInfo=function(){var z=jQuery.extend(true,[],R);z.forEach(function(A){delete A.id;delete A.type;delete A.constructor;});return z;};return y;}var C=function(v,w){var t=this;this.type=v.type;this.id=v.id;this.label=v.label;this.stepTemplates=[];v.steps.forEach(function(x){var y=w.getConfigurationById(x.id);t.stepTemplates.push(new S(y,w));});return this;};var T=function(v,F){this.type="thumbnail";if(v===undefined){return this;}this.leftUpper=F.createLabel(v.leftUpper);this.rightUpper=F.createLabel(v.rightUpper);this.leftLower=F.createLabel(v.leftLower);this.rightLower=F.createLabel(v.rightLower);this.altTitle=F.createLabel(v.altTitle);return this;};this.createThumbnail=function(v){return new T(v,this);};function L(v){this.type="label";this.kind=v.kind;if(this.kind==="text"){this.file=v.file;this.key=v.key;}else if(this.kind==="property"){this.property=v.property;}else if(this.kind==="sapLabel"){this.labelOf=v.labelOf;}}this.createLabel=function(v){return new L(v,this);};this.loadConfig=function(v){a=new sap.apf.utils.Hashtable(i.messageHandler);if(v.applicationTitle){a.setItem('applicationTitle',v.applicationTitle);}var w={constructor:{hashtable:sap.apf.utils.Hashtable},instance:{messageHandler:i.messageHandler}};sap.apf.utils.migrateConfigToCategoryStepAssignment(v,w);var R=sap.apf.core.representationTypes();u(R);b(v.steps);m(v.categories);e(v.requests);h(v.bindings);if(v.representationTypes){p(v.representationTypes);}if(v.facetFilters){r.call(this,v.facetFilters);}if(v.navigationTargets){j(v.navigationTargets);}};this.addObject=function(v){if(!sap.apf.core.constants.configurationObjectTypes.hasOwnProperty(v.type)){i.messageHandler.putMessage(i.messageHandler.createMessageObject({code:"5033",aParams:[v.type]}));}if(!(v.property)){i.messageHandler.putMessage(i.messageHandler.createMessageObject({code:"5034"}));}a.setItem(v.id,v);};this.getConfigurationById=function(I){return a.getItem(I);};this.existsConfiguration=function(I){return a.hasItem(I);};this.getServiceDocuments=function(){var R=g("request");var v=[];R.forEach(function(w){v.push(w.service);});return sap.apf.utils.eliminateDuplicatesInArray(i.messageHandler,v);};this.getNavigationTargets=function(){var v=g("navigationTarget");return jQuery.extend(true,[],v);};this.getStepTemplates=function(){var I=g("step");var v=[];I.forEach(function(w,x){v[x]=new S(w,t);});return v;};this.getFacetFilterConfigurations=function(){var v=g("facetFilter");var w;v=jQuery.extend(true,[],v);v.forEach(function(x){if(x.preselectionFunction){w=sap.apf.utils.extractFunctionFromModulePathString(x.preselectionFunction);if(!jQuery.isFunction(w)){i.messageHandler.putMessage(i.messageHandler.createMessageObject({code:'5035',parameters:[x.id]}));x.preselectionFunction=undefined;}else{x.preselectionFunction=w;}}});return v;};this.getCategories=function(){var I=g("category");var v=[];I.forEach(function(w,x){v[x]=new C(w,t);});return v;};this.createStep=function(v,R){var w=this.getConfigurationById(v);i.messageHandler.check((w!==undefined&&w.type==="step"),"Error - referenced object is undefined or has not type step",sap.apf.core.constants.message.code.errorCheckConfiguration);i.messageHandler.check(sap.apf.core.Step!==undefined,"Step must be defined ",sap.apf.core.constants.message.code.errorCheckConfiguration);i.messageHandler.check(typeof sap.apf.core.Step==="function","Step must be Ctor function");return new sap.apf.core.Step(i.messageHandler,w,this,R);};this.createBinding=function(B,v,w,R){var x=this.getConfigurationById(B);i.messageHandler.check((x!==undefined&&x.type==="binding"),"Error - oBindingConfig is undefined or has not type binding",sap.apf.core.constants.message.code.errorCheckConfiguration);x.oTitle=v;x.oLongTitle=w;return new sap.apf.core.Binding(i,x,this,R);};this.createRequest=function(v){if(v.entitySet){v.entityType=v.entitySet;delete v.entitySet;}var M;var R;function w(){var x=new Date();return Math.random()*x.getTime();}if(typeof v==="string"){R=t.getConfigurationById(v);if(!(R!==undefined&&R.type==="request")){M=i.messageHandler.createMessageObject({code:"5004",aParameters:[v]});i.messageHandler.putMessage(M);return undefined;}}else{R=v;i.messageHandler.check(R.type&&R.type==="request"&&R.service&&R.entityType,'Wrong request configuration when creating a new request');if(!R.id){R.id=w();s(R);}}return new sap.apf.core.Request(i,R);};if(i.constructor.registryProbe){this.getRegistry=function(){var P=i.constructor.registryProbe;return new P(a);};}};}());};if(!jQuery.sap.isDeclared('sap.apf.core.readRequest')){jQuery.sap.declare("sap.apf.core.readRequest");(function(){'use strict';sap.apf.core.ReadRequest=function(i,r,s,e){var c=i.coreApi;var m=i.messageHandler;this.type="readRequest";this.send=function(f,C,R){var a;var b=function(o,n){var M;var E;var d=[];if(o&&o.type&&o.type==="messageObject"){m.putMessage(o);M=o;}else{d=o.data;E=o.metadata;}C(d,E,M);};if(f){a=f.getInternalFilter();}else{a=new sap.apf.core.utils.Filter(m);}r.sendGetInBatch(a,b,R);};this.getMetadata=function(){return c.getEntityTypeMetadata(s,e);};this.getMetadataFacade=function(){return c.getMetadataFacade(s);};};}());};if(!jQuery.sap.isDeclared('sap.apf.core.readRequestByRequiredFilter')){jQuery.sap.declare("sap.apf.core.readRequestByRequiredFilter");(function(){'use strict';sap.apf.core.ReadRequestByRequiredFilter=function(i,r,s,e){var c=i.coreApi;var m=i.messageHandler;var M;this.type="readRequestByRequiredFilter";this.send=function(f,C,R){var o;var p;var a=function(g,n){var h;var E;var D=[];if(g&&g.type&&g.type==="messageObject"){m.putMessage(g);h=g;}else{D=g.data;E=g.metadata;}C(D,E,h);};if(!M){M=c.getMetadata(s);}var P=M.getParameterEntitySetKeyProperties(e);var b="";var E=M.getEntityTypeAnnotations(e);if(E.requiresFilter!==undefined&&E.requiresFilter==="true"){if(E.requiredProperties!==undefined){b=E.requiredProperties;}}var d=b.split(',');P.forEach(function(g){d.push(g.name);});c.getCumulativeFilter().done(function(g){p=g.reduceToProperty(d);if(f){o=f.getInternalFilter();o.addAnd(p);}else{o=p;}r.sendGetInBatch(o,a,R);});};this.getMetadataFacade=function(){return c.getMetadataFacade(s);};};}());};if(!jQuery.sap.isDeclared('sap.apf.modeler.core.instance')){
/*!
 * SAP APF Analysis Path Framework
 *
 * (c) Copyright 2012-2014 SAP SE. All rights reserved
 */
jQuery.sap.declare("sap.apf.modeler.core.instance");(function(){'use strict';jQuery.sap.require('sap.ui.thirdparty.datajs');sap.apf.modeler.core.Instance=function(p,a){var t=this;var A,C,b,c,d,S,F,N,R,E,H,e,M,f,g,h,j,L,k,l,m,s,n,o,q,r,u,v,O,w,x,y,z,B,D,G;A=(a&&a.constructor&&a.constructor.applicationHandler)||sap.apf.modeler.core.ApplicationHandler;C=(a&&a.constructor&&a.constructor.configurationHandler)||sap.apf.modeler.core.ConfigurationHandler;b=(a&&a.constructor&&a.constructor.configurationEditor)||sap.apf.modeler.core.ConfigurationEditor;c=(a&&a.constructor&&a.constructor.configurationObjects)||sap.apf.modeler.core.ConfigurationObjects;d=(a&&a.constructor&&a.constructor.configurationFactory)||sap.apf.core.ConfigurationFactory;E=(a&&a.constructor&&a.constructor.elementContainer)||sap.apf.modeler.core.ElementContainer;S=(a&&a.constructor&&a.constructor.step)||sap.apf.modeler.core.Step;F=(a&&a.constructor&&a.constructor.facetFilter)||sap.apf.modeler.core.FacetFilter;N=(a&&a.constructor&&a.constructor.navigationTarget)||sap.apf.modeler.core.NavigationTarget;R=(a&&a.constructor&&a.constructor.representation)||sap.apf.modeler.core.Representation;H=(a&&a.constructor&&a.constructor.hashtable)||sap.apf.utils.Hashtable;e=(a&&a.constructor&&a.constructor.registryProbe)||sap.apf.modeler.core.RegistryWrapper;L=(a&&a.constructor&&a.constructor.LazyLoader)||sap.apf.modeler.core.LazyLoader;M=(a&&a.constructor&&a.constructor.metadata)||sap.apf.core.Metadata;f=(a&&a.constructor&&a.constructor.entityTypeMetadata)||sap.apf.core.EntityTypeMetadata;g=(a&&a.constructor&&a.constructor.metadataFacade)||sap.apf.core.MetadataFacade;h=(a&&a.constructor&&a.constructor.metadataProperty)||sap.apf.core.MetadataProperty;j=(a&&a.constructor&&a.constructor.metadataFactory)||sap.apf.core.MetadataFactory;k=(a&&a.constructor&&a.constructor.startParameter)||sap.apf.utils.StartParameter;if(a&&a.constructor&&a.constructor.textHandler){l=new a.constructor.textHandler();}else{l=new sap.apf.modeler.core.TextHandler();}if(a&&a.constructor&&a.constructor.messageHandler){m=new a.constructor.messageHandler(true);}else{m=new sap.apf.core.MessageHandler(true);}m.setTextResourceHandler(l);m.loadConfig(sap.apf.core.messageDefinition);m.loadConfig(sap.apf.modeler.core.messageDefinition);m.activateOnErrorHandling(true);if(a&&a.instances&&a.instances.component){G={};G.baseManifest=sap.apf.modeler.Component.prototype.getMetadata().getManifest();G.manifest=jQuery.extend({},true,a.instances.component.getMetadata().getManifest());}n=new k(a&&a.instances&&a.instances.component,G);this.getStartParameterFacade=function(){return n;};r={instance:{messageHandler:m,coreApi:t}};if(a&&a.constructor&&a.constructor.persistenceProxy){o=new a.constructor.persistenceProxy(p,r);}else{o=new sap.apf.core.OdataProxy(p,r);}if(a&&a.constructor&&a.constructor.sessionHandler){s=new a.constructors.sessionHandler(r.instance);}else{s=new sap.apf.core.SessionHandler(r.instance);}u={entityTypeMetadata:sap.apf.core.EntityTypeMetadata,hashtable:H,metadata:sap.apf.core.Metadata,metadataFacade:sap.apf.core.MetadataFacade,metadataProperty:sap.apf.core.MetadataProperty,messageHandler:m,coreApi:t,datajs:OData,configurationFactory:{getServiceDocuments:function(){return[p.serviceRoot];}},deactivateFatalError:true,fileExists:new sap.apf.core.utils.FileExists()};q=new sap.apf.core.MetadataFactory(u);v={constructor:{hashtable:H},instance:{messageHandler:m}};this.getCatalogServiceUri=a&&a.functions&&a.functions.getCatalogServiceUri;O=(a&&a.functions&&a.functions.odataRequestWrapper)||sap.apf.core.odataRequestWrapper;w=(a&&a.functions&&a.functions.ajax)||sap.apf.core.ajax;this.ajax=function(i){return w(i);};this.odataRequest=function(i,K,P,Q){O(m,i,K,P,Q);};this.checkForTimeout=function(i){var K=sap.apf.core.utils.checkForTimeout(i);if(K){m.putMessage(K);}return K;};this.getEntityTypeMetadata=function(i,K){return q.getEntityTypeMetadata(i,K);};this.getXsrfToken=function(i){return s.getXsrfToken(i);};this.getUriGenerator=function(){return sap.apf.core.utils.uriGenerator;};this.getText=function(i,P){return l.getText(i,P);};this.putMessage=function(i){return m.putMessage(i);};this.check=function(i,K,P){return m.check(i,K,P);};this.createMessageObject=function(i){return m.createMessageObject(i);};this.setCallbackForMessageHandling=function(i){m.setMessageCallback(i);};this.importConfigurationFromLrep=function(K,P,Q,T){var U;o.readAllConfigurationsFromVendorLayer().then(function(_){var a1=K+'.'+P;var i;for(i=0;i<_.length;i++){if(_[i].value===a1){U=_[i].applicationText;break;}}t.getApplicationHandler(V);});function V(i,_){if(_){T(undefined,undefined,_);return;}var a1=false;var b1=i.getApplication(K);if(!b1){a1=true;}var c1={ApplicationName:U};i.setAndSave(c1,W,K,a1);}function W(i,_,a1){if(a1){T(P,undefined,a1);return;}X();}function X(){var i=new sap.apf.core.utils.Filter(m,'Language','eq',sap.apf.core.constants.developmentLanguage);var _=new sap.apf.core.utils.Filter(m,'Application','eq',K);_.addAnd(i);o.readCollection("texts",Y,undefined,undefined,_,true,{layer:"VENDOR"});}function Y(i,_,a1){if(a1){T(P,undefined,a1);return;}I(i,K,Z);}function Z(i){if(i){T(P,undefined,i);return;}o.readEntity("configuration",$,[{value:P}],undefined,true,K,{layer:"VENDOR"});}function $(i,_,a1){if(a1){T(undefined,_,a1);return;}var b1=JSON.parse(i.SerializedAnalyticalConfiguration);J(b1,Q,T);}};function I(i,K,P){t.getApplicationHandler(T);function Q(U,V,W){var X;var Y;if(W){P(W);}else{X={instance:{messageHandler:m,persistenceProxy:o},constructor:{hashtable:H}};Y=new sap.apf.modeler.core.TextPool(X,K,U);Y.addTextsAndSave(i,P,K);}}function T(U,V){if(V){P(V);return;}var W;var X=U.getApplication(K);if(!X){W=m.createMessageObject({code:11021});P(W);return;}if(z&&z.getId()===K){z.getInstance().getTextPool().addTextsAndSave(i,P,K);}else{var Y=new sap.apf.core.utils.Filter(m,'Application','eq',K);var Z=new sap.apf.core.utils.Filter(m,'Language','eq',sap.apf.core.constants.developmentLanguage);Z.addAnd(Y);o.readCollection("texts",Q,undefined,undefined,Z,true);}}}this.importTexts=function(K,P){var Q;var T;var i;var U=sap.apf.utils.parseTextPropertyFile(K,{instance:{messageHandler:m}});if(U.Messages.length>0){Q=m.createMessageObject({code:11020});T=U.Messages.length;for(i=0;i<T-1;i++){U.Messages[i+1].setPrevious(U.Messages[i]);}Q.setPrevious(U.Messages[T-1]);P(Q);}else{I(U.TextElements,U.Application,P);}};function J(i,K,P){var Q=i.configHeader;t.getApplicationHandler(T);function T(X,Y){if(Y){P(undefined,undefined,Y);return;}var Z=false;var $=X.getList();$.forEach(function(a1){if(a1.Application===Q.Application){Z=true;}});if(Z){t.getConfigurationHandler(Q.Application,V);}else{var _={ApplicationName:Q.ApplicationName,SemanticObject:Q.SemanticObject};X.setAndSave(_,U,Q.Application,true);}}function U(X,Y,Z){if(Z){P(undefined,undefined,Z);return;}t.getConfigurationHandler(Q.Application,V);}function V(X,Y){if(Y){P(undefined,undefined,Y);return;}var Z=jQuery.extend({},i,true);delete Z.configHeader;var $=false;var _=X.getList();_.forEach(function(d1){if(d1.AnalyticalConfiguration===Q.AnalyticalConfiguration){$=true;}});if($){K(b1,c1);}else{X.setConfiguration({AnalyticalConfigurationName:Q.AnalyticalConfigurationName},Q.AnalyticalConfiguration);var a1={id:Q.AnalyticalConfiguration,creationDate:Q.CreationUTCDateTime,lastChangeDate:Q.LastChangeUTCDateTime,content:Z};X.loadConfiguration(a1,W);}function b1(){X.setConfiguration({AnalyticalConfigurationName:Q.AnalyticalConfigurationName},Q.AnalyticalConfiguration);var a1={updateExisting:true,id:Q.AnalyticalConfiguration,creationDate:Q.CreationUTCDateTime,lastChangeDate:Q.LastChangeUTCDateTime,content:Z};X.loadConfiguration(a1,W);}function c1(){var d1=X.setConfiguration({AnalyticalConfigurationName:Q.AnalyticalConfigurationName});var e1={id:d1,content:Z};X.loadConfiguration(e1,W);}}function W(X,Y){if(Y){P(undefined,undefined,Y);return;}X.save(P);}}this.importConfiguration=function(i,K,P){var Q=JSON.parse(i);if(!T(Q,P)){return;}J(Q,K,P);function T(Q,P){var U=[],V=true,W;if(!sap.apf.utils.isValidGuid(Q.configHeader.Application)){U.push(m.createMessageObject({code:11037,aParameters:[Q.configHeader.Application]}));V=false;}if(!sap.apf.utils.isValidGuid(Q.configHeader.AnalyticalConfiguration)){U.push(m.createMessageObject({code:11038,aParameters:[Q.configHeader.AnalyticalConfiguration]}));V=false;}W=sap.apf.modeler.core.ConfigurationObjects.getTextKeysFromConfiguration(Q);W.forEach(function(X){var Y=new H(m);if(!Y.hasItem(X)){Y.setItem(X,X);if(!sap.apf.utils.isValidGuid(X)){U.push(m.createMessageObject({code:11039,aParameters:[X]}));V=false;}}});if(V){return V;}U.forEach(function(X,Y,U){if(Y){X.setPrevious(U[Y-1]);}});P(i,undefined,U[U.length-1]);return V;}};this.getApplicationHandler=function(i){if(!y){var K=(a&&a.functions&&a.functions.loadApplicationHandler)||P;y=new L(v,K);}y.asyncGetInstance("ApplicationHandlerId",i);function P(Q,T){new A({instance:{messageHandler:m,persistenceProxy:o},constructor:{hashtable:H},functions:{resetConfigurationHandler:V}},U);function U(W,X){T(Q,W,X);}function V(W){if(z&&z.getId()===W){z.getInstance().removeAllConfigurations();z.reset();}}}};this.getConfigurationHandler=function(i,K){if(!z){x=(a&&a.functions&&a.functions.loadConfigurationHandler)||P;z=new L(v,x);}z.asyncGetInstance(i,K);function P(i,Q,T){var U=new sap.apf.core.utils.Filter(m,'Application','eq',i);var V=new sap.apf.core.utils.Filter(m,'Language','eq',sap.apf.core.constants.developmentLanguage);V.addAnd(U);var W=[];var X=["AnalyticalConfiguration","AnalyticalConfigurationName","Application","CreatedByUser","CreationUTCDateTime","LastChangeUTCDateTime","LastChangedByUser"];W.push({entitySetName:"configuration",filter:U,selectList:X});W.push({entitySetName:'texts',filter:V});o.readCollectionsInBatch(W,Y,true);function Y(Z,$){var _,a1;var b1;var c1;var d1=T;if($){Q(i,undefined,$);}else{b1=Z[0];c1=Z[1];a1={instance:{messageHandler:m,persistenceProxy:o},constructor:{hashtable:H}};_=new sap.apf.modeler.core.TextPool(a1,i,c1);if(!d1){d1=new C({instance:{messageHandler:m,persistenceProxy:o,datajs:OData,coreApi:t,metadataFactory:q},constructor:{configurationEditor:b,configurationFactory:d,configurationObjects:c,elementContainer:E,entityTypeMetadata:f,facetFilter:F,navigationTarget:N,hashtable:H,representation:R,registryProbe:e,step:S,lazyLoader:L},functions:{getApplication:y.getInstance().getApplication}});}d1.setApplicationIdAndContext(i,b1,_);Q(i,d1,$);}}}};this.getUnusedTextKeys=function(i,K){var P={instance:{messageHandler:m,persistenceProxy:o},constructor:{hashtable:H}};var Q=new c(P);var T=null,U=null,V=null;Q.getTextKeysFromAllConfigurations(i,function(X,Y){if(U){return;}T=X;U=Y;if(Y||V){W();}});this.getConfigurationHandler(i,function(X,Y){if(U){return;}V=X;U=Y;if(Y||T){W();}});function W(){var X=[];if(U){K(undefined,U);return;}V.getTextPool().getTextKeys().forEach(function(Y){if(!T.hasItem(Y)){X.push(Y);}});K(X,undefined);}};this.resetConfigurationHandler=function(){if(z){z.reset();}};this.getRepresentationTypes=function(){var i=sap.apf.core.representationTypes();var K=[];jQuery.extend(true,K,i);return K;};this.getAllAvailableSemanticObjects=function(i){function K(T,U){D=T.results;i(T.results,undefined);}function P(T){var U;if(T.messageObject){U=T.messageObject;}else{U=m.createMessageObject({code:"11041"});}i([],U);}if(D){i(D,undefined);return;}var Q={requestUri:"/sap/opu/odata/UI2/INTEROP/SemanticObjects?$format=json&$select=id,text",method:"GET",headers:{"x-csrf-token":s.getXsrfToken("/sap/opu/odata/UI2/INTEROP/SemanticObjects")}};t.odataRequest(Q,K,P);};this.getSemanticActions=function(K){var P;var Q=jQuery.Deferred();if(!B){B=new H(m);}P=B.getItem(K);if(P){Q.resolve(P);return Q.promise();}t.getAllAvailableSemanticObjects(T);return Q.promise();function T(U,V){if(V){Q.reject(V);return;}var W=sap.ushell&&sap.ushell.Container&&sap.ushell.Container.getService("CrossApplicationNavigation");var X;var i;if(!W){Q.reject(m.createMessageObject({code:"5038"}));return;}for(i=0;i<U.length;i++){if(U[i].id===K){X=U[i];break;}}W.getSemanticObjectLinks(K,undefined,true,a.instances.component,undefined).done(function(Y){var Z=[];Y.forEach(function($){var _=$.intent.split("-");var a1=_[1].split("?");a1=a1[0].split("~");Z.push({id:a1[0],text:$.text});});B.setItem(K,{semanticObject:X,semanticActions:Z});Q.resolve({semanticObject:X,semanticActions:Z});}).fail(function(){Q.reject(m.createMessageObject({code:"11042"}));});}};this.navigateToGenericRuntime=function(i,K,P){var Q=sap.ushell&&sap.ushell.Container&&sap.ushell.Container.getService("CrossApplicationNavigation");var T={};if(t.getStartParameterFacade().isLrepActive()){T['sap-apf-configuration-id']=i+'.'+K;}else{T['sap-apf-configuration-id']=K;}var U=Q.hrefForExternal({target:a.functions.getNavigationTargetForGenericRuntime(),params:T});var V=jQuery(location).attr('href');var W=V.split('#')[0];P(W+U);};this.readAllConfigurationsFromVendorLayer=function(){return o.readAllConfigurationsFromVendorLayer();};if(a&&a.probe){new a.probe({constructor:{applicationHandler:A,configurationHandler:C,configurationEditor:b,configurationObjects:c,configurationFactory:d,metadataFactory:j,metadata:M,entityTypeMetadata:f,metadataFacade:g,metadataProperty:h,step:S,facetFilter:F,navigationTarget:N,representation:R,elementContainer:E,hashtable:H,lazyLoader:L,registryProbe:e},textHandler:l,messageHandler:m,sessionHandler:s,persistenceProxy:o,metadataFactory:q,injectForFollowUp:r,injectMetadataFactory:u,fnOdataRequestWrapper:O,ajax:w,odataRequestWrapper:O});}};}());};if(!jQuery.sap.isDeclared('sap.apf.core.instance')){
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
jQuery.sap.declare("sap.apf.core.instance");(function(){'use strict';sap.apf.core.Instance=function(a){var t=this;var m=a.messageHandler;var s=a.startParameter;var r;var I={messageHandler:m,coreApi:t};var R;var M;var T;var c;var p;var S;var P;var f;this.destroy=function(){p.destroy();};this.ajax=function(d){return sap.apf.core.ajax(d);};this.odataRequest=function(d,e,E,B){sap.apf.core.odataRequestWrapper(m,d,e,E,B);};this.getStartParameterFacade=function(){return s;};this.getMessageHandler=function(){return m;};this.putMessage=function(d){return m.putMessage(d);};this.check=function(e,d,C){return m.check(e,d,C);};this.createMessageObject=function(C){return m.createMessageObject(C);};this.activateOnErrorHandling=function(O){m.activateOnErrorHandling(O);};this.setCallbackForMessageHandling=function(C){m.setMessageCallback(C);};this.setApplicationCallbackForMessageHandling=function(C){m.setApplicationMessageCallback(C);};this.getLogMessages=function(){return m.getLogMessages();};this.checkForTimeout=function(d){var e=sap.apf.core.utils.checkForTimeout(d);if(e){m.putMessage(e);}return e;};this.getUriGenerator=function(){return sap.apf.core.utils.uriGenerator;};this.getMetadata=function(A){return M.getMetadata(A);};this.getMetadataFacade=function(){return M.getMetadataFacade();};this.getEntityTypeMetadata=function(A,e){return M.getEntityTypeMetadata(A,e);};this.loadApplicationConfig=function(F){R.loadConfigFromFilePath(F);};this.loadTextElements=function(d){T.loadTextElements(d);};this.getApplicationConfigProperties=function(){return R.getConfigurationProperties();};this.getResourceLocation=function(d){return R.getResourceLocation(d);};this.getPersistenceConfiguration=function(){return R.getPersistenceConfiguration();};this.getApplicationConfigurationURL=function(){return R.getApplicationConfigurationURL();};this.getCategories=function(){return c.getCategories();};this.existsConfiguration=function(i){return c.existsConfiguration(i);};this.getStepTemplates=function(){return c.getStepTemplates();};this.getFacetFilterConfigurations=function(){return c.getFacetFilterConfigurations();};this.getNavigationTargets=function(){return c.getNavigationTargets();};this.createStep=function(d,e,g){var h;m.check(d!==undefined&&typeof d==="string"&&d.length!==0,"sStepID is  unknown or undefined");h=c.createStep(d,g);p.addStep(h,e);return h;};this.getSteps=function(){return p.getSteps();};this.moveStepToPosition=function(d,n,e){p.moveStepToPosition(d,n,e);};this.updatePath=function(d,C){p.update(d,C);};this.removeStep=function(d,e){p.removeStep(d,e);};this.resetPath=function(d){if(d){r=p.serialize();}if(p){p.destroy();}p=new sap.apf.core.Path(I);};this.restoreOriginalPath=function(){if(r){p.destroy();p=new sap.apf.core.Path(I);p.deserialize(r);}};this.stepIsActive=function(d){return p.stepIsActive(d);};this.serializePath=function(){return p.serialize();};this.deserializePath=function(d){p.deserialize(d);};this.getTextNotHtmlEncoded=function(l,d){return T.getTextNotHtmlEncoded(l,d);};this.getTextHtmlEncoded=function(l,d){return T.getTextHtmlEncoded(l,d);};this.isInitialTextKey=function(d){return(d===sap.apf.core.constants.textKeyForInitialText);};this.getMessageText=function(C,d){return T.getMessageText(C,d);};this.getXsrfToken=function(d){return S.getXsrfToken(d);};this.setDirtyState=function(d){S.setDirtyState(d);};this.isDirty=function(){return S.isDirty();};this.setPathName=function(n){S.setPathName(n);};this.getPathName=function(){return S.getPathName();};this.getCumulativeFilter=function(){return a.getCumulativeFilter();};this.createReadRequest=function(d){var e=c.createRequest(d);var g;if(typeof d==='string'){g=c.getConfigurationById(d);}else{g=d;}return new sap.apf.core.ReadRequest(I,e,g.service,g.entityType);};this.createReadRequestByRequiredFilter=function(d){var e=c.createRequest(d);var g;if(typeof d==='string'){g=c.getConfigurationById(d);}else{g=d;}return new sap.apf.core.ReadRequestByRequiredFilter(I,e,g.service,g.entityType);};this.loadMessageConfiguration=function(d,e){m.loadConfig(d,e);};this.loadAnalyticalConfiguration=function(C){c.loadConfig(C);};this.savePath=function(d,e,g,h){var i;var n;var C;var E;if(typeof d==='string'&&typeof e==='string'&&typeof g==='function'){i=d;n=e;C=g;E=h;this.setPathName(n);P.modifyPath(i,n,C,E);}else if(typeof d==='string'&&typeof e==='function'){n=d;C=e;E=g;this.setPathName(n);P.createPath(n,C,E);}else{m.putMessage(sap.apf.core.createMessageObject({code:"5027",aParameters:[d,e,g]}));}};this.readPaths=function(C){P.readPaths(C);};this.openPath=function(d,C,n){function l(e,E,g){if(!g&&r){r=undefined;}if(!g){t.setPathName(e.path.AnalysisPathName);}C(e,E,g);}return P.openPath(d,l,n);};this.deletePath=function(d,C){P.deletePath(d,C);};this.createFilter=function(d){return new sap.apf.utils.Filter(m,d);};this.getActiveStep=function(){return p.getActiveSteps()[0];};this.getCumulativeFilterUpToActiveStep=function(){return p.getCumulativeFilterUpToActiveStep();};this.setActiveStep=function(d){p.makeStepActive(d);var A=p.getActiveSteps();var i;for(i=0;i<A.length;++i){p.makeStepInactive(A[i]);}return p.makeStepActive(d);};this.createFirstStep=function(d,e,g){var i=false;var h;h=t.getStepTemplates();h.forEach(function(j){i=j.id===d?true:i;});if(!i){m.putMessage(m.createMessageObject({code:'5036',aParameters:[d]}));}else{t.createStep(d,g,e);}};this.getFunctionCreateRequest=function(){return c.createRequest;};T=new sap.apf.core.TextResourceHandler(I);m.setTextResourceHandler(T);if(a.manifests){I.manifests=a.manifests;}f=new sap.apf.core.utils.FileExists();c=new sap.apf.core.ConfigurationFactory(I);var o={entityTypeMetadata:sap.apf.core.EntityTypeMetadata,hashtable:sap.apf.utils.Hashtable,metadata:sap.apf.core.Metadata,metadataFacade:sap.apf.core.MetadataFacade,metadataProperty:sap.apf.core.MetadataProperty,messageHandler:I.messageHandler,coreApi:t,datajs:OData,configurationFactory:c,fileExists:f};M=new sap.apf.core.MetadataFactory(o);p=new sap.apf.core.Path(I);S=new sap.apf.core.SessionHandler(I);P=new sap.apf.core.Persistence(I);var b={coreApi:t,messageHandler:I.messageHandler,fileExists:f,manifests:a.manifests};R=new sap.apf.core.ResourcePathHandler(b);};}());};if(!jQuery.sap.isDeclared('sap.apf.modeler.Component')){
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP SE. All rights reserved
 */
(function(){'use strict';jQuery.sap.declare("sap.apf.modeler.Component");jQuery.sap.require('sap.ui.core.UIComponent');jQuery.sap.require('sap.m.routing.RouteMatchedHandler');sap.ui.core.UIComponent.extend("sap.apf.modeler.Component",{oCoreApi:null,metadata:{manifest:"json"},init:function(){var p,c;var u=false;var t;if(this.initHasAlreadyBeenCalled){return;}this.initHasAlreadyBeenCalled=true;var m=jQuery.extend({},true,this.getMetadata().getManifest());var b=sap.apf.modeler.Component.prototype.getMetadata().getManifest();if(m["sap.apf"]&&m["sap.apf"].activateLrep){u=m["sap.apf"].activateLrep;}if(m["crossNavigation"]&&m["crossNavigation"].outbounds&&m["crossNavigation"].outbounds.navigateToGenericRuntime){t=m["crossNavigation"].outbounds.navigateToGenericRuntime;}if(m["sap.app"].dataSources&&m["sap.app"].dataSources.AnalyticalConfigurationServiceRoot){p=m["sap.app"].dataSources.AnalyticalConfigurationServiceRoot.uri;}else{p=sap.apf.core.constants.modelerPersistenceServiceRoot;}var a={serviceRoot:p};var i={instances:{component:this}};if(u){i.constructor={persistenceProxy:sap.apf.core.LayeredRepositoryProxy};}if(t){i.functions={getNavigationTargetForGenericRuntime:function(){return t;}};}else{i.functions={getNavigationTargetForGenericRuntime:function(){if(m['sap.app']&&m['sap.app'].id==='fnd.apf.dts1'){return{semanticObject:"FioriApplication",action:'executeAPFConfigurationS4HANA'};}else{return{semanticObject:"FioriApplication",action:'executeAPFConfiguration'};}}};}if(m["sap.app"].dataSources&&m["sap.app"].dataSources.GatewayCatalogService){c=m["sap.app"].dataSources.GatewayCatalogService.uri;}else if(b["sap.app"].dataSources&&b["sap.app"].dataSources.GatewayCatalogService){c=b["sap.app"].dataSources.GatewayCatalogService.uri;}i.functions.getCatalogServiceUri=function(){return c;};this.oCoreApi=new sap.apf.modeler.core.Instance(a,i);var d=this.oCoreApi.getUriGenerator().getApfLocation();jQuery.sap.includeStyleSheet(d+"modeler/resources/css/configModeler.css","configModelerCss");sap.ui.core.UIComponent.prototype.init.apply(this,arguments);var r=this.getRouter();this.oRouteHandler=new sap.m.routing.RouteMatchedHandler(r);r.initialize();},createContent:function(){var a=sap.ui.view({viewName:"sap.apf.modeler.ui.view.applicationList",type:"XML",viewData:this.oCoreApi});this.oCoreApi.getUriGenerator().getApfLocation();return a;}});}());};if(!jQuery.sap.isDeclared('sap.apf.api')){
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
(function(){'use strict';jQuery.sap.declare('sap.apf.api');sap.apf.Api=function(c,i,m){var M;var C;var s;var n;var S;var e;var f;var a;var b;var d;this.type='api';this.constants={};this.constants.eventTypes=sap.apf.core.constants.eventTypes;s=new sap.apf.utils.StartParameter(c,m);M=new sap.apf.core.MessageHandler();M.activateOnErrorHandling(true);C=new sap.apf.core.Instance({startParameter:s,messageHandler:M,manifests:m,getCumulativeFilter:function(){return S.getCumulativeFilter();}});this.destroy=function(){if(u&&u.destroy){u.destroy();}if(C){C.destroy();}u=undefined;M.activateOnErrorHandling(false);M=undefined;C=undefined;s=undefined;n=undefined;};this.activateOnErrorHandling=function(h){return C.activateOnErrorHandling(h);};this.getStartParameterFacade=function(){return C.getStartParameterFacade();};this.setCallbackForMessageHandling=function(h){return C.setCallbackForMessageHandling(h);};this.setApplicationCallbackForMessageHandling=function(h){return C.setApplicationCallbackForMessageHandling(h);};this.getLogMessages=function(){return C.getLogMessages();};this.createStep=function(h,j,r){return C.createStep(h,j,r);};this.getActiveStep=function(){return C.getActiveStep();};this.getCategories=function(){return C.getCategories();};this.getSteps=function(){return C.getSteps();};this.getStepTemplates=function(){return C.getStepTemplates();};this.getFacetFilterConfigurations=function(){return C.getFacetFilterConfigurations();};this.getApplicationConfigProperties=function(){return C.getApplicationConfigProperties();};this.moveStepToPosition=function(h,j,k){return C.moveStepToPosition(h,j,k);};this.removeStep=function(h,j){return C.removeStep(h,j);};this.resetPath=function(){return C.resetPath();};this.setActiveStep=function(h){return C.setActiveStep(h);};this.stepIsActive=function(h){return C.stepIsActive(h);};this.updatePath=function(h){return C.updatePath(h);};this.getApfLocation=function(){return C.getUriGenerator().getApfLocation();};this.readPaths=function(h){return C.readPaths(h);};this.savePath=function(p,N,h){C.savePath(p,N,h);};this.openPath=function(p,h,j){return C.openPath(p,h,j);};this.deletePath=function(p,h){return C.deletePath(p,h);};this.addFacetFilter=function(h){u.getLayoutView().getController().addFacetFilter(h);};this.getEventCallback=function(E){return u.getEventCallback(E);};this.putMessage=function(h){return C.putMessage(h);};this.createMessageObject=function(h){return C.createMessageObject(h);};this.getTextHtmlEncoded=function(l,p){return C.getTextHtmlEncoded(l,p);};this.getTextNotHtmlEncoded=function(l,p){return C.getTextNotHtmlEncoded(l,p);};if(!m){this.loadApplicationConfig=function(F){C.loadApplicationConfig(F);};}else{this.loadApplicationConfig=function(F){};}this.createFilter=function(){return C.createFilter();};this.addPathFilter=function(h){return f.add(h);};this.updatePathFilter=function(h,j){f.update(h,j);};this.getPathFilter=function(h){return f.get(h);};this.createReadRequest=function(r){return C.createReadRequest(r);};this.createReadRequestByRequiredFilter=function(r){return C.createReadRequestByRequiredFilter(r);};b={instance:{startParameter:s,component:c,messageHandler:M},functions:{getConfigurationProperties:C.getApplicationConfigProperties}};e=new sap.apf.utils.ExternalContext(b);a={functions:{getFacetFilterConfigurations:this.getFacetFilterConfigurations,getCombinedContext:e.getCombinedContext,createRequest:C.getFunctionCreateRequest()},instance:{messageHandler:M},constructor:{StartFilter:sap.apf.utils.StartFilter}};S=new sap.apf.utils.StartFilterHandler(a);d={functions:{setRestrictionByProperty:S.setRestrictionByProperty,getRestrictionByProperty:S.getRestrictionByProperty},instance:{messageHandler:M}};f=new sap.apf.utils.FilterIdHandler(d);var g={functions:{getCumulativeFilterUpToActiveStep:C.getCumulativeFilterUpToActiveStep,getNavigationTargets:C.getNavigationTargets,getActiveStep:C.getActiveStep,serializePath:C.serializePath,serializeFilterIds:f.serialize,isDirty:C.isDirty,getPathName:C.getPathName,deserializePath:C.deserializePath,deserializeFilterIds:f.deserialize,setDirtyState:C.setDirtyState,setPathName:C.setPathName,createRequest:C.getFunctionCreateRequest(),getXappStateId:C.getStartParameterFacade().getXappStateId,isFilterReductionActive:C.getStartParameterFacade().isFilterReductionActive,getAllParameterEntitySetKeyProperties:C.getMetadataFacade().getAllParameterEntitySetKeyProperties},instances:{messageHandler:M,component:c,startFilterHandler:S}};n=new sap.apf.utils.NavigationHandler(g);var o=new sap.apf.utils.SerializationMediator({coreApi:C,filterIdHandler:f,startFilterHandler:S});var u=new sap.apf.ui.Instance({oCoreApi:C,oFilterIdHandler:f,oSerializationMediator:o,oNavigationHandler:n,oComponent:c,oStartParameter:s,oStartFilterHandler:S});C.createRepresentation=function(r,h){var j=new sap.apf.ui.representations.RepresentationInterfaceProxy(C,u);var R=sap.apf.utils.extractFunctionFromModulePathString(r);return new R(j,h);};this.selectionChanged=function(r){u.selectionChanged(r);};this.createApplicationLayout=function(){return u.createApplicationLayout();};this.startApf=function(){var t=this;if(this.fnBeforeApfStartupCallback&&typeof this.fnBeforeApfStartupCallback==="function"){this.fnBeforeApfStartupCallback.apply(c,[this]);}var A=this.createApplicationLayout();var h=n.checkMode();var p=u.handleStartup(h);p.done(function(){if(t.fnAfterApfStartupCallback&&typeof t.fnAfterApfStartupCallback==="function"){t.fnAfterApfStartupCallback.apply(c,[t]);}});return A;};this.addMasterFooterContent=function(h){return u.addMasterFooterContentRight(h);};this.setEventCallback=function(E,h){switch(E){case sap.apf.core.constants.eventTypes.contextChanged:u.setEventCallback(E,h);return true;case sap.apf.core.constants.eventTypes.printTriggered:u.setEventCallback(E,h);return true;case sap.apf.core.constants.eventTypes.format:u.setEventCallback(E,h);return true;default:return false;}};this.setCallbackBeforeApfStartup=function(h){this.fnBeforeApfStartupCallback=h;};this.setCallbackAfterApfStartup=function(h){this.fnAfterApfStartupCallback=h;};this.getPropertyValuesOfExternalContext=function(p){var h=jQuery.Deferred();e.getCombinedContext().then(function(j){var t=j.getFilterTermsForProperty(p);var k=[];t.forEach(function(l){var q={Low:l.getValue(),Option:l.getOp(),High:l.getHighValue()};k.push(q);});h.resolve(k);});return h.promise();};if(i){if(i.probe){new i.probe({coreApi:C,component:c,uiApi:u,serializationMediator:o,navigationHandler:n,startParameter:s,injectedFunctionsNavigationHandler:g.functions,startFilterHandler:S});}}};}());};if(!jQuery.sap.isDeclared('sap.apf.base.Component')){
/*!
 * SAP APF Analysis Path Framework
 *
 * (c) Copyright 2012-2015 SAP SE. All rights reserved
 */
(function(){'use strict';jQuery.sap.declare("sap.apf.base.Component");jQuery.sap.require('sap.ui.core.UIComponent');sap.ui.core.UIComponent.extend("sap.apf.base.Component",{metadata:{"manifest":"json","publicMethods":["getApi"]},oApi:null,init:function(){var b;var m;if(!this.oApi){b=sap.apf.base.Component.prototype.getMetadata().getManifest();m=jQuery.extend({},true,this.getMetadata().getManifest());this.oApi=new sap.apf.Api(this,undefined,{manifest:m,baseManifest:b});}else{return;}sap.ui.core.UIComponent.prototype.init.apply(this,arguments);},createContent:function(){sap.ui.core.UIComponent.prototype.createContent.apply(this,arguments);return this.oApi.startApf();},exit:function(){this.oApi.destroy();},getApi:function(){return this.oApi;}});}());};if(!jQuery.sap.isDeclared('sap.apf.Component')){
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
(function(){'use strict';jQuery.sap.declare("sap.apf.Component");jQuery.sap.require('sap.ui.core.UIComponent');sap.ui.core.UIComponent.extend("sap.apf.Component",{oApi:null,metadata:{"config":{"fullWidth":true},"name":"CoreComponent","version":"0.0.1","publicMethods":["getApi"],"dependencies":{"libs":["sap.m","sap.ui.layout","sap.ca.ui","sap.viz"]}},init:function(){if(!this.oApi){this.oApi=new sap.apf.Api(this);}var a=this.oApi.getStartParameterFacade().getApplicationConfigurationPath();if(a){this.oApi.loadApplicationConfig(a);}sap.ui.core.UIComponent.prototype.init.apply(this,arguments);},createContent:function(){sap.ui.core.UIComponent.prototype.createContent.apply(this,arguments);return this.oApi.startApf();},exit:function(){this.oApi.destroy();},getApi:function(){return this.oApi;}});}());};
