/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

		(c) Copyright 2009-2016 SAP SE. All rights reserved
	
 */
sap.ui.define(['jquery.sap.global','./library','sap/ui/core/Control'],function(q,l,C){"use strict";var H=C.extend("sap.suite.ui.microchart.HarveyBallMicroChart",{metadata:{library:"sap.suite.ui.microchart",properties:{total:{group:"Misc",type:"float",defaultValue:null},totalLabel:{group:"Misc",type:"string"},totalScale:{group:"Misc",type:"string"},formattedLabel:{group:"Misc",type:"boolean",defaultValue:false},showTotal:{group:"Misc",type:"boolean",defaultValue:true},showFractions:{group:"Misc",type:"boolean",defaultValue:true},size:{group:"Misc",type:"sap.m.Size",defaultValue:"Auto"},colorPalette:{type:"string[]",group:"Appearance",defaultValue:[]},width:{group:"Misc",type:"sap.ui.core.CSSSize"}},events:{press:{}},aggregations:{"items":{multiple:true,type:"sap.suite.ui.microchart.HarveyBallMicroChartItem"}}}});H.prototype.getAltText=function(){var a="";var I=true;var b=this.getItems();for(var i=0;i<b.length;i++){var o=b[i];var c=(this.getColorPalette().length===0)?this._rb.getText(("SEMANTIC_COLOR_"+o.getColor()).toUpperCase()):"";var L=o.getFractionLabel();var s=o.getFractionScale();if(!L&&s){L=o.getFormattedLabel()?o.getFraction():o.getFraction()+o.getFractionScale().substring(0,3);}else if(!o.getFormattedLabel()&&o.getFractionLabel()){L+=o.getFractionScale().substring(0,3);}a+=(I?"":"\n")+L+" "+c;I=false;}if(this.getTotal()){var t=this.getTotalLabel();if(!t){t=this.getFormattedLabel()?this.getTotal():this.getTotal()+this.getTotalScale().substring(0,3);}else if(!this.getFormattedLabel()){t+=this.getTotalScale().substring(0,3);}a+=(I?"":"\n")+this._rb.getText("HARVEYBALLMICROCHART_TOTAL_TOOLTIP")+" "+t;}return a;};H.prototype.getTooltip_AsString=function(){var t=this.getTooltip();var T=this.getAltText();if(typeof t==="string"||t instanceof String){T=t.split("{AltText}").join(T).split("((AltText))").join(T);return T;}return t?t:"";};H.prototype.init=function(){this._rb=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.microchart");this.setTooltip("{AltText}");sap.ui.Device.media.attachHandler(this.rerender,this,sap.ui.Device.media.RANGESETS.SAP_STANDARD);};H.prototype._calculatePath=function(){var s=this.getSize();var t=this.getTotal();var f=0;if(this.getItems().length){f=this.getItems()[0].getFraction();}var i=false;if(s=="Auto"){i=q("html").hasClass("sapUiMedia-Std-Phone");}if(s=="S"||s=="XS"){i=true;}var m=i?56:72;var c=m/2;var b=4;this._oPath={initial:{x:c,y:c,x1:c,y1:c},lineTo:{x:c,y:b},arc:{x1:c-b,y1:c-b,xArc:0,largeArc:0,sweep:1,x2:"",y2:""},size:m,border:b,center:c};var a=f/t*360;if(a<10){this._oPath.initial.x-=1.5;this._oPath.initial.x1+=1.5;this._oPath.arc.x2=this._oPath.initial.x1;this._oPath.arc.y2=this._oPath.lineTo.y;}else if(a>350&&a<360){this._oPath.initial.x+=1.5;this._oPath.initial.x1-=1.5;this._oPath.arc.x2=this._oPath.initial.x1;this._oPath.arc.y2=this._oPath.lineTo.y;}else{var r=Math.PI/180.0;var R=this._oPath.center-this._oPath.border;var d=R*Math.cos((a-90)*r)+this._oPath.center;var e=this._oPath.size-(R*Math.sin((a+90)*r)+this._oPath.center);this._oPath.arc.x2=d.toFixed(2);this._oPath.arc.y2=e.toFixed(2);}var L=t/f<2?1:0;this._oPath.arc.largeArc=L;};H.prototype.onBeforeRendering=function(){this._calculatePath();};H.prototype.serializePieChart=function(){var p=this._oPath;return["M",p.initial.x,",",p.initial.y," L",p.initial.x,",",p.lineTo.y," A",p.arc.x1,",",p.arc.y1," ",p.arc.xArc," ",p.arc.largeArc,",",p.arc.sweep," ",p.arc.x2,",",p.arc.y2," L",p.initial.x1,",",p.initial.y1," z"].join("");};H.prototype._parseFormattedValue=function(v){return{scale:v.replace(/.*?([^+-.,\d]*)$/g,"$1").trim(),value:v.replace(/(.*?)[^+-.,\d]*$/g,"$1").trim()};};H.prototype.ontap=function(e){if(sap.ui.Device.browser.internet_explorer){this.$().focus();}this.firePress();};H.prototype.onkeydown=function(e){if(e.which==q.sap.KeyCodes.SPACE){e.preventDefault();}};H.prototype.onkeyup=function(e){if(e.which==q.sap.KeyCodes.ENTER||e.which==q.sap.KeyCodes.SPACE){this.firePress();e.preventDefault();}};H.prototype.attachEvent=function(e,d,f,L){sap.ui.core.Control.prototype.attachEvent.call(this,e,d,f,L);if(this.hasListeners("press")){this.$().attr("tabindex",0).addClass("sapSuiteUiMicroChartPointer");}return this;};H.prototype.detachEvent=function(e,f,L){sap.ui.core.Control.prototype.detachEvent.call(this,e,f,L);if(!this.hasListeners("press")){this.$().removeAttr("tabindex").removeClass("sapSuiteUiMicroChartPointer");}return this;};H.prototype.exit=function(e){sap.ui.Device.media.detachHandler(this.rerender,this,sap.ui.Device.media.RANGESETS.SAP_STANDARD);};return H;});
